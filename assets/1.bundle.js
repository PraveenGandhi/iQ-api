webpackJsonp([1],[
/* 0 */,
/* 1 */,
/* 2 */,
/* 3 */,
/* 4 */,
/* 5 */,
/* 6 */,
/* 7 */,
/* 8 */,
/* 9 */,
/* 10 */
/***/ function(module, exports, __webpack_require__) {

	var map = {
		"./BaseCrudOperations/BaseCreateVM": 11,
		"./BaseCrudOperations/BaseCreateVM.js": 11,
		"./BaseCrudOperations/BaseListVM": 12,
		"./BaseCrudOperations/BaseListVM.js": 12,
		"./BaseCrudOperations/BaseViewVM": 16,
		"./BaseCrudOperations/BaseViewVM.js": 16,
		"./app": 17,
		"./app.html": 28,
		"./app.js": 17,
		"./aurelia-animator-css": 29,
		"./aurelia-bootstrapper-webpack": 2,
		"./aurelia-event-aggregator": 25,
		"./aurelia-framework": 18,
		"./aurelia-history-browser": 30,
		"./aurelia-logging-console": 32,
		"./aurelia-pal-browser": 5,
		"./aurelia-polyfills": 3,
		"./aurelia-router": 33,
		"./aurelia-sails-socket-client": 26,
		"./aurelia-templating-binding": 35,
		"./aurelia-templating-resources": 36,
		"./aurelia-templating-resources/abstract-repeater": 49,
		"./aurelia-templating-resources/abstract-repeater.js": 49,
		"./aurelia-templating-resources/analyze-view-factory": 48,
		"./aurelia-templating-resources/analyze-view-factory.js": 48,
		"./aurelia-templating-resources/array-repeat-strategy": 43,
		"./aurelia-templating-resources/array-repeat-strategy.js": 43,
		"./aurelia-templating-resources/binding-mode-behaviors": 59,
		"./aurelia-templating-resources/binding-mode-behaviors.js": 59,
		"./aurelia-templating-resources/binding-signaler": 63,
		"./aurelia-templating-resources/binding-signaler.js": 63,
		"./aurelia-templating-resources/compile-spy": 56,
		"./aurelia-templating-resources/compile-spy.js": 56,
		"./aurelia-templating-resources/compose": 37,
		"./aurelia-templating-resources/compose.js": 37,
		"./aurelia-templating-resources/css-resource": 58,
		"./aurelia-templating-resources/css-resource.js": 58,
		"./aurelia-templating-resources/debounce-binding-behavior": 61,
		"./aurelia-templating-resources/debounce-binding-behavior.js": 61,
		"./aurelia-templating-resources/dynamic-element": 66,
		"./aurelia-templating-resources/dynamic-element.js": 66,
		"./aurelia-templating-resources/focus": 55,
		"./aurelia-templating-resources/focus.js": 55,
		"./aurelia-templating-resources/hide": 51,
		"./aurelia-templating-resources/hide.js": 51,
		"./aurelia-templating-resources/html-resource-plugin": 65,
		"./aurelia-templating-resources/html-resource-plugin.js": 65,
		"./aurelia-templating-resources/html-sanitizer": 53,
		"./aurelia-templating-resources/html-sanitizer.js": 53,
		"./aurelia-templating-resources/if": 38,
		"./aurelia-templating-resources/if.js": 38,
		"./aurelia-templating-resources/map-repeat-strategy": 45,
		"./aurelia-templating-resources/map-repeat-strategy.js": 45,
		"./aurelia-templating-resources/null-repeat-strategy": 42,
		"./aurelia-templating-resources/null-repeat-strategy.js": 42,
		"./aurelia-templating-resources/number-repeat-strategy": 47,
		"./aurelia-templating-resources/number-repeat-strategy.js": 47,
		"./aurelia-templating-resources/repeat": 40,
		"./aurelia-templating-resources/repeat-strategy-locator": 41,
		"./aurelia-templating-resources/repeat-strategy-locator.js": 41,
		"./aurelia-templating-resources/repeat-utilities": 44,
		"./aurelia-templating-resources/repeat-utilities.js": 44,
		"./aurelia-templating-resources/repeat.js": 40,
		"./aurelia-templating-resources/replaceable": 54,
		"./aurelia-templating-resources/replaceable.js": 54,
		"./aurelia-templating-resources/sanitize-html": 52,
		"./aurelia-templating-resources/sanitize-html.js": 52,
		"./aurelia-templating-resources/set-repeat-strategy": 46,
		"./aurelia-templating-resources/set-repeat-strategy.js": 46,
		"./aurelia-templating-resources/show": 50,
		"./aurelia-templating-resources/show.js": 50,
		"./aurelia-templating-resources/signal-binding-behavior": 62,
		"./aurelia-templating-resources/signal-binding-behavior.js": 62,
		"./aurelia-templating-resources/throttle-binding-behavior": 60,
		"./aurelia-templating-resources/throttle-binding-behavior.js": 60,
		"./aurelia-templating-resources/update-trigger-binding-behavior": 64,
		"./aurelia-templating-resources/update-trigger-binding-behavior.js": 64,
		"./aurelia-templating-resources/view-spy": 57,
		"./aurelia-templating-resources/view-spy.js": 57,
		"./aurelia-templating-resources/with": 39,
		"./aurelia-templating-resources/with.js": 39,
		"./aurelia-templating-router": 67,
		"./aurelia-templating-router/route-href": 70,
		"./aurelia-templating-router/route-href.js": 70,
		"./aurelia-templating-router/route-loader": 68,
		"./aurelia-templating-router/route-loader.js": 68,
		"./aurelia-templating-router/router-view": 69,
		"./aurelia-templating-router/router-view.js": 69,
		"./auth/index": 71,
		"./auth/index.html": 72,
		"./auth/index.js": 71,
		"./authConfig": 73,
		"./authConfig.js": 73,
		"./components/aurelia-semantic-ui/collections/ui-breadcrumb": 74,
		"./components/aurelia-semantic-ui/collections/ui-breadcrumb.js": 74,
		"./components/aurelia-semantic-ui/collections/ui-form": 77,
		"./components/aurelia-semantic-ui/collections/ui-form.js": 77,
		"./components/aurelia-semantic-ui/collections/ui-grid": 78,
		"./components/aurelia-semantic-ui/collections/ui-grid.js": 78,
		"./components/aurelia-semantic-ui/collections/ui-menu": 79,
		"./components/aurelia-semantic-ui/collections/ui-menu.js": 79,
		"./components/aurelia-semantic-ui/collections/ui-message": 80,
		"./components/aurelia-semantic-ui/collections/ui-message.js": 80,
		"./components/aurelia-semantic-ui/collections/ui-table": 81,
		"./components/aurelia-semantic-ui/collections/ui-table.js": 81,
		"./components/aurelia-semantic-ui/constants": 75,
		"./components/aurelia-semantic-ui/constants.js": 75,
		"./components/aurelia-semantic-ui/elements/ui-button": 82,
		"./components/aurelia-semantic-ui/elements/ui-button.js": 82,
		"./components/aurelia-semantic-ui/elements/ui-container": 83,
		"./components/aurelia-semantic-ui/elements/ui-container.js": 83,
		"./components/aurelia-semantic-ui/elements/ui-divider": 84,
		"./components/aurelia-semantic-ui/elements/ui-divider.js": 84,
		"./components/aurelia-semantic-ui/elements/ui-flag": 85,
		"./components/aurelia-semantic-ui/elements/ui-flag.js": 85,
		"./components/aurelia-semantic-ui/elements/ui-header": 86,
		"./components/aurelia-semantic-ui/elements/ui-header.js": 86,
		"./components/aurelia-semantic-ui/elements/ui-icon": 87,
		"./components/aurelia-semantic-ui/elements/ui-icon.js": 87,
		"./components/aurelia-semantic-ui/elements/ui-image": 88,
		"./components/aurelia-semantic-ui/elements/ui-image.js": 88,
		"./components/aurelia-semantic-ui/elements/ui-input": 89,
		"./components/aurelia-semantic-ui/elements/ui-input.js": 89,
		"./components/aurelia-semantic-ui/elements/ui-label": 90,
		"./components/aurelia-semantic-ui/elements/ui-label.js": 90,
		"./components/aurelia-semantic-ui/elements/ui-list": 91,
		"./components/aurelia-semantic-ui/elements/ui-list.js": 91,
		"./components/aurelia-semantic-ui/elements/ui-loader": 92,
		"./components/aurelia-semantic-ui/elements/ui-loader.js": 92,
		"./components/aurelia-semantic-ui/elements/ui-rail": 93,
		"./components/aurelia-semantic-ui/elements/ui-rail.js": 93,
		"./components/aurelia-semantic-ui/elements/ui-reveal": 94,
		"./components/aurelia-semantic-ui/elements/ui-reveal.js": 94,
		"./components/aurelia-semantic-ui/elements/ui-segment": 95,
		"./components/aurelia-semantic-ui/elements/ui-segment.js": 95,
		"./components/aurelia-semantic-ui/elements/ui-step": 96,
		"./components/aurelia-semantic-ui/elements/ui-step.js": 96,
		"./components/aurelia-semantic-ui/index": 97,
		"./components/aurelia-semantic-ui/index.js": 97,
		"./components/aurelia-semantic-ui/modules/ui-accordion": 98,
		"./components/aurelia-semantic-ui/modules/ui-accordion.js": 98,
		"./components/aurelia-semantic-ui/modules/ui-dropdown": 99,
		"./components/aurelia-semantic-ui/modules/ui-dropdown.js": 99,
		"./components/aurelia-semantic-ui/modules/ui-modal": 100,
		"./components/aurelia-semantic-ui/modules/ui-modal.js": 100,
		"./components/aurelia-semantic-ui/modules/ui-search": 101,
		"./components/aurelia-semantic-ui/modules/ui-search.js": 101,
		"./components/aurelia-semantic-ui/modules/ui-sidebar": 102,
		"./components/aurelia-semantic-ui/modules/ui-sidebar.js": 102,
		"./components/aurelia-semantic-ui/ui-attribute": 76,
		"./components/aurelia-semantic-ui/ui-attribute.js": 76,
		"./components/aurelia-semantic-ui/views/ui-card": 103,
		"./components/aurelia-semantic-ui/views/ui-card.js": 103,
		"./components/aurelia-semantic-ui/views/ui-statistic": 104,
		"./components/aurelia-semantic-ui/views/ui-statistic.js": 104,
		"./components/form-control": 105,
		"./components/form-control.html": 106,
		"./components/form-control.js": 105,
		"./components/form-submit": 107,
		"./components/form-submit.html": 108,
		"./components/form-submit.js": 107,
		"./components/index": 109,
		"./components/index.js": 109,
		"./home/welcome": 110,
		"./home/welcome.html": 111,
		"./home/welcome.js": 110,
		"./jquery": 13,
		"./main": 1,
		"./main.js": 1,
		"./mousetrap": 15,
		"./question/answers/base": 125,
		"./question/answers/base.js": 125,
		"./question/answers/create": 126,
		"./question/answers/create.html": 127,
		"./question/answers/create.js": 126,
		"./question/answers/list": 128,
		"./question/answers/list.html": 129,
		"./question/answers/list.js": 128,
		"./question/answers/view": 130,
		"./question/answers/view.html": 131,
		"./question/answers/view.js": 130,
		"./question/base": 132,
		"./question/base.js": 132,
		"./question/child-router": 133,
		"./question/child-router.html": 134,
		"./question/child-router.js": 133,
		"./question/create": 135,
		"./question/create.html": 136,
		"./question/create.js": 135,
		"./question/details/addAnswer": 137,
		"./question/details/addAnswer.html": 138,
		"./question/details/addAnswer.js": 137,
		"./question/details/child-router": 139,
		"./question/details/child-router.html": 140,
		"./question/details/child-router.js": 139,
		"./question/details/view": 141,
		"./question/details/view.html": 142,
		"./question/details/view.js": 141,
		"./question/list": 143,
		"./question/list.html": 144,
		"./question/list.js": 143,
		"./question/view": 145,
		"./question/view.html": 146,
		"./question/view.js": 145,
		"./questionCategory/base": 147,
		"./questionCategory/base.js": 147,
		"./questionCategory/child-router": 148,
		"./questionCategory/child-router.html": 149,
		"./questionCategory/child-router.js": 148,
		"./questionCategory/create": 150,
		"./questionCategory/create.html": 151,
		"./questionCategory/create.js": 150,
		"./questionCategory/list": 152,
		"./questionCategory/list.html": 153,
		"./questionCategory/list.js": 152,
		"./questionCategory/view": 154,
		"./questionCategory/view.html": 155,
		"./questionCategory/view.js": 154,
		"./questionKind/base": 156,
		"./questionKind/base.js": 156,
		"./questionKind/child-router": 157,
		"./questionKind/child-router.html": 158,
		"./questionKind/child-router.js": 157,
		"./questionKind/create": 159,
		"./questionKind/create.html": 160,
		"./questionKind/create.js": 159,
		"./questionKind/list": 161,
		"./questionKind/list.html": 162,
		"./questionKind/list.js": 161,
		"./questionKind/view": 163,
		"./questionKind/view.html": 164,
		"./questionKind/view.js": 163,
		"./questionType/base": 165,
		"./questionType/base.js": 165,
		"./questionType/child-router": 166,
		"./questionType/child-router.html": 167,
		"./questionType/child-router.js": 166,
		"./questionType/create": 168,
		"./questionType/create.html": 169,
		"./questionType/create.js": 168,
		"./questionType/list": 170,
		"./questionType/list.html": 171,
		"./questionType/list.js": 170,
		"./questionType/view": 172,
		"./questionType/view.html": 173,
		"./questionType/view.js": 172,
		"./test/welcome": 174,
		"./test/welcome.html": 175,
		"./test/welcome.js": 174,
		"./users/base": 176,
		"./users/base.js": 176,
		"./users/child-router": 177,
		"./users/child-router.html": 178,
		"./users/child-router.js": 177,
		"./users/create": 179,
		"./users/create.html": 180,
		"./users/create.js": 179,
		"./users/list": 181,
		"./users/list.html": 182,
		"./users/list.js": 181,
		"./users/view": 183,
		"./users/view.html": 184,
		"./users/view.js": 183
	};
	function webpackContext(req) {
		return __webpack_require__(webpackContextResolve(req));
	};
	function webpackContextResolve(req) {
		return map[req] || (function() { throw new Error("Cannot find module '" + req + "'.") }());
	};
	webpackContext.keys = function webpackContextKeys() {
		return Object.keys(map);
	};
	webpackContext.resolve = webpackContextResolve;
	module.exports = webpackContext;
	webpackContext.id = 10;


/***/ },
/* 11 */
/***/ function(module, exports) {

	'use strict';
	
	exports.__esModule = true;
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var BaseCreateVM = exports.BaseCreateVM = function () {
	  function BaseCreateVM(sails, router, config) {
	    _classCallCheck(this, BaseCreateVM);
	
	    this.sails = sails;
	    this.router = router;
	    this.baseCtrlUrl = config.baseCtrlUrl;
	  }
	
	  BaseCreateVM.prototype.submit = function submit() {
	    var _this = this;
	
	    this.sails.post(this.baseCtrlUrl, this.entity).then(function (data) {
	      return _this.router.navigate('');
	    });
	  };
	
	  return BaseCreateVM;
	}();

/***/ },
/* 12 */
/***/ function(module, exports, __webpack_require__) {

	/* WEBPACK VAR INJECTION */(function($) {'use strict';
	
	exports.__esModule = true;
	exports.BaseListVM = undefined;
	
	var _aureliaLogging = __webpack_require__(14);
	
	var LogManager = _interopRequireWildcard(_aureliaLogging);
	
	__webpack_require__(15);
	
	__webpack_require__(13);
	
	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var logger = LogManager.getLogger('BaseListVM');
	
	var BaseListVM = exports.BaseListVM = function () {
	  function BaseListVM(sails, router, config) {
	    var _this = this;
	
	    _classCallCheck(this, BaseListVM);
	
	    this.entities = [];
	
	    this.sails = sails;
	    this.router = router;
	    this.baseCtrlUrl = config.baseCtrlUrl;
	    this.entityToSubscribe = config.entityToSubscribe;
	
	    Mousetrap.bind('a', function () {
	      return window.location = '#' + _this.baseCtrlUrl + 'Create';
	    });
	    Mousetrap.bind('l', function () {
	      return window.location = '#' + _this.baseCtrlUrl;
	    });
	  }
	
	  BaseListVM.prototype.activate = function activate() {
	    var _this2 = this;
	
	    return this.sails.get(this.baseCtrlUrl).then(function (res) {
	      _this2.entities = res.body;
	      _this2.subscribe();
	    }).catch(function (res) {
	      res.statusCode === 403 ? _this2.router.navigate('/login') : logger.error(res);
	    });
	  };
	
	  BaseListVM.prototype.attached = function attached() {
	    $('table a .icon').popup({ variation: 'mini inverted', inline: true });
	  };
	
	  BaseListVM.prototype.deactivate = function deactivate() {
	    this.unsubscribe();
	  };
	
	  BaseListVM.prototype.subscribe = function subscribe() {
	    this.sails.on(this.entityToSubscribe, this.serverUpdate.bind(this));
	  };
	
	  BaseListVM.prototype.unsubscribe = function unsubscribe() {
	    this.sails.off(this.entityToSubscribe);
	  };
	
	  BaseListVM.prototype.serverUpdate = function serverUpdate(message) {
	    if (message.verb === 'created') {
	      this.entities.push(message.data);
	    } else if (message.verb === 'updated') {
	      var i = void 0;
	      for (i = 0; i < this.entities.length; i++) {
	        var entity = this.entities[i];
	        if ('' + entity.id === message.id) {
	          this.entities[i] = message.data;
	          break;
	        }
	      }
	    } else if (message.verb === 'destroyed') {
	      var _i = void 0;
	      for (_i = 0; _i < this.entities.length; _i++) {
	        var _entity = this.entities[_i];
	        if ('' + _entity.id === message.id) {
	          this.entities.splice(_i, 1);
	          break;
	        }
	      }
	    }
	  };
	
	  return BaseListVM;
	}();
	/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(13)))

/***/ },
/* 13 */,
/* 14 */
/***/ function(module, exports) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.getLogger = getLogger;
	exports.addAppender = addAppender;
	exports.setLevel = setLevel;
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var logLevel = exports.logLevel = {
	  none: 0,
	  error: 1,
	  warn: 2,
	  info: 3,
	  debug: 4
	};
	
	var loggers = {};
	var currentLevel = logLevel.none;
	var appenders = [];
	var slice = Array.prototype.slice;
	var loggerConstructionKey = {};
	
	function log(logger, level, args) {
	  var i = appenders.length;
	  var current = void 0;
	
	  args = slice.call(args);
	  args.unshift(logger);
	
	  while (i--) {
	    current = appenders[i];
	    current[level].apply(current, args);
	  }
	}
	
	function debug() {
	  if (currentLevel < 4) {
	    return;
	  }
	
	  log(this, 'debug', arguments);
	}
	
	function info() {
	  if (currentLevel < 3) {
	    return;
	  }
	
	  log(this, 'info', arguments);
	}
	
	function warn() {
	  if (currentLevel < 2) {
	    return;
	  }
	
	  log(this, 'warn', arguments);
	}
	
	function error() {
	  if (currentLevel < 1) {
	    return;
	  }
	
	  log(this, 'error', arguments);
	}
	
	function connectLogger(logger) {
	  logger.debug = debug;
	  logger.info = info;
	  logger.warn = warn;
	  logger.error = error;
	}
	
	function createLogger(id) {
	  var logger = new Logger(id, loggerConstructionKey);
	
	  if (appenders.length) {
	    connectLogger(logger);
	  }
	
	  return logger;
	}
	
	function getLogger(id) {
	  return loggers[id] || (loggers[id] = createLogger(id));
	}
	
	function addAppender(appender) {
	  appenders.push(appender);
	
	  if (appenders.length === 1) {
	    for (var key in loggers) {
	      connectLogger(loggers[key]);
	    }
	  }
	}
	
	function setLevel(level) {
	  currentLevel = level;
	}
	
	var Logger = exports.Logger = function () {
	  function Logger(id, key) {
	    _classCallCheck(this, Logger);
	
	    if (key !== loggerConstructionKey) {
	      throw new Error('Cannot instantiate "Logger". Use "getLogger" instead.');
	    }
	
	    this.id = id;
	  }
	
	  Logger.prototype.debug = function debug(message) {};
	
	  Logger.prototype.info = function info(message) {};
	
	  Logger.prototype.warn = function warn(message) {};
	
	  Logger.prototype.error = function error(message) {};
	
	  return Logger;
	}();

/***/ },
/* 15 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_RESULT__;/*global define:false */
	/**
	 * Copyright 2016 Craig Campbell
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License.
	 * You may obtain a copy of the License at
	 *
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software
	 * distributed under the License is distributed on an "AS IS" BASIS,
	 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	 * See the License for the specific language governing permissions and
	 * limitations under the License.
	 *
	 * Mousetrap is a simple keyboard shortcut library for Javascript with
	 * no external dependencies
	 *
	 * @version 1.6.0
	 * @url craig.is/killing/mice
	 */
	(function(window, document, undefined) {
	
	    // Check if mousetrap is used inside browser, if not, return
	    if (!window) {
	        return;
	    }
	
	    /**
	     * mapping of special keycodes to their corresponding keys
	     *
	     * everything in this dictionary cannot use keypress events
	     * so it has to be here to map to the correct keycodes for
	     * keyup/keydown events
	     *
	     * @type {Object}
	     */
	    var _MAP = {
	        8: 'backspace',
	        9: 'tab',
	        13: 'enter',
	        16: 'shift',
	        17: 'ctrl',
	        18: 'alt',
	        20: 'capslock',
	        27: 'esc',
	        32: 'space',
	        33: 'pageup',
	        34: 'pagedown',
	        35: 'end',
	        36: 'home',
	        37: 'left',
	        38: 'up',
	        39: 'right',
	        40: 'down',
	        45: 'ins',
	        46: 'del',
	        91: 'meta',
	        93: 'meta',
	        224: 'meta'
	    };
	
	    /**
	     * mapping for special characters so they can support
	     *
	     * this dictionary is only used incase you want to bind a
	     * keyup or keydown event to one of these keys
	     *
	     * @type {Object}
	     */
	    var _KEYCODE_MAP = {
	        106: '*',
	        107: '+',
	        109: '-',
	        110: '.',
	        111 : '/',
	        186: ';',
	        187: '=',
	        188: ',',
	        189: '-',
	        190: '.',
	        191: '/',
	        192: '`',
	        219: '[',
	        220: '\\',
	        221: ']',
	        222: '\''
	    };
	
	    /**
	     * this is a mapping of keys that require shift on a US keypad
	     * back to the non shift equivelents
	     *
	     * this is so you can use keyup events with these keys
	     *
	     * note that this will only work reliably on US keyboards
	     *
	     * @type {Object}
	     */
	    var _SHIFT_MAP = {
	        '~': '`',
	        '!': '1',
	        '@': '2',
	        '#': '3',
	        '$': '4',
	        '%': '5',
	        '^': '6',
	        '&': '7',
	        '*': '8',
	        '(': '9',
	        ')': '0',
	        '_': '-',
	        '+': '=',
	        ':': ';',
	        '\"': '\'',
	        '<': ',',
	        '>': '.',
	        '?': '/',
	        '|': '\\'
	    };
	
	    /**
	     * this is a list of special strings you can use to map
	     * to modifier keys when you specify your keyboard shortcuts
	     *
	     * @type {Object}
	     */
	    var _SPECIAL_ALIASES = {
	        'option': 'alt',
	        'command': 'meta',
	        'return': 'enter',
	        'escape': 'esc',
	        'plus': '+',
	        'mod': /Mac|iPod|iPhone|iPad/.test(navigator.platform) ? 'meta' : 'ctrl'
	    };
	
	    /**
	     * variable to store the flipped version of _MAP from above
	     * needed to check if we should use keypress or not when no action
	     * is specified
	     *
	     * @type {Object|undefined}
	     */
	    var _REVERSE_MAP;
	
	    /**
	     * loop through the f keys, f1 to f19 and add them to the map
	     * programatically
	     */
	    for (var i = 1; i < 20; ++i) {
	        _MAP[111 + i] = 'f' + i;
	    }
	
	    /**
	     * loop through to map numbers on the numeric keypad
	     */
	    for (i = 0; i <= 9; ++i) {
	        _MAP[i + 96] = i;
	    }
	
	    /**
	     * cross browser add event method
	     *
	     * @param {Element|HTMLDocument} object
	     * @param {string} type
	     * @param {Function} callback
	     * @returns void
	     */
	    function _addEvent(object, type, callback) {
	        if (object.addEventListener) {
	            object.addEventListener(type, callback, false);
	            return;
	        }
	
	        object.attachEvent('on' + type, callback);
	    }
	
	    /**
	     * takes the event and returns the key character
	     *
	     * @param {Event} e
	     * @return {string}
	     */
	    function _characterFromEvent(e) {
	
	        // for keypress events we should return the character as is
	        if (e.type == 'keypress') {
	            var character = String.fromCharCode(e.which);
	
	            // if the shift key is not pressed then it is safe to assume
	            // that we want the character to be lowercase.  this means if
	            // you accidentally have caps lock on then your key bindings
	            // will continue to work
	            //
	            // the only side effect that might not be desired is if you
	            // bind something like 'A' cause you want to trigger an
	            // event when capital A is pressed caps lock will no longer
	            // trigger the event.  shift+a will though.
	            if (!e.shiftKey) {
	                character = character.toLowerCase();
	            }
	
	            return character;
	        }
	
	        // for non keypress events the special maps are needed
	        if (_MAP[e.which]) {
	            return _MAP[e.which];
	        }
	
	        if (_KEYCODE_MAP[e.which]) {
	            return _KEYCODE_MAP[e.which];
	        }
	
	        // if it is not in the special map
	
	        // with keydown and keyup events the character seems to always
	        // come in as an uppercase character whether you are pressing shift
	        // or not.  we should make sure it is always lowercase for comparisons
	        return String.fromCharCode(e.which).toLowerCase();
	    }
	
	    /**
	     * checks if two arrays are equal
	     *
	     * @param {Array} modifiers1
	     * @param {Array} modifiers2
	     * @returns {boolean}
	     */
	    function _modifiersMatch(modifiers1, modifiers2) {
	        return modifiers1.sort().join(',') === modifiers2.sort().join(',');
	    }
	
	    /**
	     * takes a key event and figures out what the modifiers are
	     *
	     * @param {Event} e
	     * @returns {Array}
	     */
	    function _eventModifiers(e) {
	        var modifiers = [];
	
	        if (e.shiftKey) {
	            modifiers.push('shift');
	        }
	
	        if (e.altKey) {
	            modifiers.push('alt');
	        }
	
	        if (e.ctrlKey) {
	            modifiers.push('ctrl');
	        }
	
	        if (e.metaKey) {
	            modifiers.push('meta');
	        }
	
	        return modifiers;
	    }
	
	    /**
	     * prevents default for this event
	     *
	     * @param {Event} e
	     * @returns void
	     */
	    function _preventDefault(e) {
	        if (e.preventDefault) {
	            e.preventDefault();
	            return;
	        }
	
	        e.returnValue = false;
	    }
	
	    /**
	     * stops propogation for this event
	     *
	     * @param {Event} e
	     * @returns void
	     */
	    function _stopPropagation(e) {
	        if (e.stopPropagation) {
	            e.stopPropagation();
	            return;
	        }
	
	        e.cancelBubble = true;
	    }
	
	    /**
	     * determines if the keycode specified is a modifier key or not
	     *
	     * @param {string} key
	     * @returns {boolean}
	     */
	    function _isModifier(key) {
	        return key == 'shift' || key == 'ctrl' || key == 'alt' || key == 'meta';
	    }
	
	    /**
	     * reverses the map lookup so that we can look for specific keys
	     * to see what can and can't use keypress
	     *
	     * @return {Object}
	     */
	    function _getReverseMap() {
	        if (!_REVERSE_MAP) {
	            _REVERSE_MAP = {};
	            for (var key in _MAP) {
	
	                // pull out the numeric keypad from here cause keypress should
	                // be able to detect the keys from the character
	                if (key > 95 && key < 112) {
	                    continue;
	                }
	
	                if (_MAP.hasOwnProperty(key)) {
	                    _REVERSE_MAP[_MAP[key]] = key;
	                }
	            }
	        }
	        return _REVERSE_MAP;
	    }
	
	    /**
	     * picks the best action based on the key combination
	     *
	     * @param {string} key - character for key
	     * @param {Array} modifiers
	     * @param {string=} action passed in
	     */
	    function _pickBestAction(key, modifiers, action) {
	
	        // if no action was picked in we should try to pick the one
	        // that we think would work best for this key
	        if (!action) {
	            action = _getReverseMap()[key] ? 'keydown' : 'keypress';
	        }
	
	        // modifier keys don't work as expected with keypress,
	        // switch to keydown
	        if (action == 'keypress' && modifiers.length) {
	            action = 'keydown';
	        }
	
	        return action;
	    }
	
	    /**
	     * Converts from a string key combination to an array
	     *
	     * @param  {string} combination like "command+shift+l"
	     * @return {Array}
	     */
	    function _keysFromString(combination) {
	        if (combination === '+') {
	            return ['+'];
	        }
	
	        combination = combination.replace(/\+{2}/g, '+plus');
	        return combination.split('+');
	    }
	
	    /**
	     * Gets info for a specific key combination
	     *
	     * @param  {string} combination key combination ("command+s" or "a" or "*")
	     * @param  {string=} action
	     * @returns {Object}
	     */
	    function _getKeyInfo(combination, action) {
	        var keys;
	        var key;
	        var i;
	        var modifiers = [];
	
	        // take the keys from this pattern and figure out what the actual
	        // pattern is all about
	        keys = _keysFromString(combination);
	
	        for (i = 0; i < keys.length; ++i) {
	            key = keys[i];
	
	            // normalize key names
	            if (_SPECIAL_ALIASES[key]) {
	                key = _SPECIAL_ALIASES[key];
	            }
	
	            // if this is not a keypress event then we should
	            // be smart about using shift keys
	            // this will only work for US keyboards however
	            if (action && action != 'keypress' && _SHIFT_MAP[key]) {
	                key = _SHIFT_MAP[key];
	                modifiers.push('shift');
	            }
	
	            // if this key is a modifier then add it to the list of modifiers
	            if (_isModifier(key)) {
	                modifiers.push(key);
	            }
	        }
	
	        // depending on what the key combination is
	        // we will try to pick the best event for it
	        action = _pickBestAction(key, modifiers, action);
	
	        return {
	            key: key,
	            modifiers: modifiers,
	            action: action
	        };
	    }
	
	    function _belongsTo(element, ancestor) {
	        if (element === null || element === document) {
	            return false;
	        }
	
	        if (element === ancestor) {
	            return true;
	        }
	
	        return _belongsTo(element.parentNode, ancestor);
	    }
	
	    function Mousetrap(targetElement) {
	        var self = this;
	
	        targetElement = targetElement || document;
	
	        if (!(self instanceof Mousetrap)) {
	            return new Mousetrap(targetElement);
	        }
	
	        /**
	         * element to attach key events to
	         *
	         * @type {Element}
	         */
	        self.target = targetElement;
	
	        /**
	         * a list of all the callbacks setup via Mousetrap.bind()
	         *
	         * @type {Object}
	         */
	        self._callbacks = {};
	
	        /**
	         * direct map of string combinations to callbacks used for trigger()
	         *
	         * @type {Object}
	         */
	        self._directMap = {};
	
	        /**
	         * keeps track of what level each sequence is at since multiple
	         * sequences can start out with the same sequence
	         *
	         * @type {Object}
	         */
	        var _sequenceLevels = {};
	
	        /**
	         * variable to store the setTimeout call
	         *
	         * @type {null|number}
	         */
	        var _resetTimer;
	
	        /**
	         * temporary state where we will ignore the next keyup
	         *
	         * @type {boolean|string}
	         */
	        var _ignoreNextKeyup = false;
	
	        /**
	         * temporary state where we will ignore the next keypress
	         *
	         * @type {boolean}
	         */
	        var _ignoreNextKeypress = false;
	
	        /**
	         * are we currently inside of a sequence?
	         * type of action ("keyup" or "keydown" or "keypress") or false
	         *
	         * @type {boolean|string}
	         */
	        var _nextExpectedAction = false;
	
	        /**
	         * resets all sequence counters except for the ones passed in
	         *
	         * @param {Object} doNotReset
	         * @returns void
	         */
	        function _resetSequences(doNotReset) {
	            doNotReset = doNotReset || {};
	
	            var activeSequences = false,
	                key;
	
	            for (key in _sequenceLevels) {
	                if (doNotReset[key]) {
	                    activeSequences = true;
	                    continue;
	                }
	                _sequenceLevels[key] = 0;
	            }
	
	            if (!activeSequences) {
	                _nextExpectedAction = false;
	            }
	        }
	
	        /**
	         * finds all callbacks that match based on the keycode, modifiers,
	         * and action
	         *
	         * @param {string} character
	         * @param {Array} modifiers
	         * @param {Event|Object} e
	         * @param {string=} sequenceName - name of the sequence we are looking for
	         * @param {string=} combination
	         * @param {number=} level
	         * @returns {Array}
	         */
	        function _getMatches(character, modifiers, e, sequenceName, combination, level) {
	            var i;
	            var callback;
	            var matches = [];
	            var action = e.type;
	
	            // if there are no events related to this keycode
	            if (!self._callbacks[character]) {
	                return [];
	            }
	
	            // if a modifier key is coming up on its own we should allow it
	            if (action == 'keyup' && _isModifier(character)) {
	                modifiers = [character];
	            }
	
	            // loop through all callbacks for the key that was pressed
	            // and see if any of them match
	            for (i = 0; i < self._callbacks[character].length; ++i) {
	                callback = self._callbacks[character][i];
	
	                // if a sequence name is not specified, but this is a sequence at
	                // the wrong level then move onto the next match
	                if (!sequenceName && callback.seq && _sequenceLevels[callback.seq] != callback.level) {
	                    continue;
	                }
	
	                // if the action we are looking for doesn't match the action we got
	                // then we should keep going
	                if (action != callback.action) {
	                    continue;
	                }
	
	                // if this is a keypress event and the meta key and control key
	                // are not pressed that means that we need to only look at the
	                // character, otherwise check the modifiers as well
	                //
	                // chrome will not fire a keypress if meta or control is down
	                // safari will fire a keypress if meta or meta+shift is down
	                // firefox will fire a keypress if meta or control is down
	                if ((action == 'keypress' && !e.metaKey && !e.ctrlKey) || _modifiersMatch(modifiers, callback.modifiers)) {
	
	                    // when you bind a combination or sequence a second time it
	                    // should overwrite the first one.  if a sequenceName or
	                    // combination is specified in this call it does just that
	                    //
	                    // @todo make deleting its own method?
	                    var deleteCombo = !sequenceName && callback.combo == combination;
	                    var deleteSequence = sequenceName && callback.seq == sequenceName && callback.level == level;
	                    if (deleteCombo || deleteSequence) {
	                        self._callbacks[character].splice(i, 1);
	                    }
	
	                    matches.push(callback);
	                }
	            }
	
	            return matches;
	        }
	
	        /**
	         * actually calls the callback function
	         *
	         * if your callback function returns false this will use the jquery
	         * convention - prevent default and stop propogation on the event
	         *
	         * @param {Function} callback
	         * @param {Event} e
	         * @returns void
	         */
	        function _fireCallback(callback, e, combo, sequence) {
	
	            // if this event should not happen stop here
	            if (self.stopCallback(e, e.target || e.srcElement, combo, sequence)) {
	                return;
	            }
	
	            if (callback(e, combo) === false) {
	                _preventDefault(e);
	                _stopPropagation(e);
	            }
	        }
	
	        /**
	         * handles a character key event
	         *
	         * @param {string} character
	         * @param {Array} modifiers
	         * @param {Event} e
	         * @returns void
	         */
	        self._handleKey = function(character, modifiers, e) {
	            var callbacks = _getMatches(character, modifiers, e);
	            var i;
	            var doNotReset = {};
	            var maxLevel = 0;
	            var processedSequenceCallback = false;
	
	            // Calculate the maxLevel for sequences so we can only execute the longest callback sequence
	            for (i = 0; i < callbacks.length; ++i) {
	                if (callbacks[i].seq) {
	                    maxLevel = Math.max(maxLevel, callbacks[i].level);
	                }
	            }
	
	            // loop through matching callbacks for this key event
	            for (i = 0; i < callbacks.length; ++i) {
	
	                // fire for all sequence callbacks
	                // this is because if for example you have multiple sequences
	                // bound such as "g i" and "g t" they both need to fire the
	                // callback for matching g cause otherwise you can only ever
	                // match the first one
	                if (callbacks[i].seq) {
	
	                    // only fire callbacks for the maxLevel to prevent
	                    // subsequences from also firing
	                    //
	                    // for example 'a option b' should not cause 'option b' to fire
	                    // even though 'option b' is part of the other sequence
	                    //
	                    // any sequences that do not match here will be discarded
	                    // below by the _resetSequences call
	                    if (callbacks[i].level != maxLevel) {
	                        continue;
	                    }
	
	                    processedSequenceCallback = true;
	
	                    // keep a list of which sequences were matches for later
	                    doNotReset[callbacks[i].seq] = 1;
	                    _fireCallback(callbacks[i].callback, e, callbacks[i].combo, callbacks[i].seq);
	                    continue;
	                }
	
	                // if there were no sequence matches but we are still here
	                // that means this is a regular match so we should fire that
	                if (!processedSequenceCallback) {
	                    _fireCallback(callbacks[i].callback, e, callbacks[i].combo);
	                }
	            }
	
	            // if the key you pressed matches the type of sequence without
	            // being a modifier (ie "keyup" or "keypress") then we should
	            // reset all sequences that were not matched by this event
	            //
	            // this is so, for example, if you have the sequence "h a t" and you
	            // type "h e a r t" it does not match.  in this case the "e" will
	            // cause the sequence to reset
	            //
	            // modifier keys are ignored because you can have a sequence
	            // that contains modifiers such as "enter ctrl+space" and in most
	            // cases the modifier key will be pressed before the next key
	            //
	            // also if you have a sequence such as "ctrl+b a" then pressing the
	            // "b" key will trigger a "keypress" and a "keydown"
	            //
	            // the "keydown" is expected when there is a modifier, but the
	            // "keypress" ends up matching the _nextExpectedAction since it occurs
	            // after and that causes the sequence to reset
	            //
	            // we ignore keypresses in a sequence that directly follow a keydown
	            // for the same character
	            var ignoreThisKeypress = e.type == 'keypress' && _ignoreNextKeypress;
	            if (e.type == _nextExpectedAction && !_isModifier(character) && !ignoreThisKeypress) {
	                _resetSequences(doNotReset);
	            }
	
	            _ignoreNextKeypress = processedSequenceCallback && e.type == 'keydown';
	        };
	
	        /**
	         * handles a keydown event
	         *
	         * @param {Event} e
	         * @returns void
	         */
	        function _handleKeyEvent(e) {
	
	            // normalize e.which for key events
	            // @see http://stackoverflow.com/questions/4285627/javascript-keycode-vs-charcode-utter-confusion
	            if (typeof e.which !== 'number') {
	                e.which = e.keyCode;
	            }
	
	            var character = _characterFromEvent(e);
	
	            // no character found then stop
	            if (!character) {
	                return;
	            }
	
	            // need to use === for the character check because the character can be 0
	            if (e.type == 'keyup' && _ignoreNextKeyup === character) {
	                _ignoreNextKeyup = false;
	                return;
	            }
	
	            self.handleKey(character, _eventModifiers(e), e);
	        }
	
	        /**
	         * called to set a 1 second timeout on the specified sequence
	         *
	         * this is so after each key press in the sequence you have 1 second
	         * to press the next key before you have to start over
	         *
	         * @returns void
	         */
	        function _resetSequenceTimer() {
	            clearTimeout(_resetTimer);
	            _resetTimer = setTimeout(_resetSequences, 1000);
	        }
	
	        /**
	         * binds a key sequence to an event
	         *
	         * @param {string} combo - combo specified in bind call
	         * @param {Array} keys
	         * @param {Function} callback
	         * @param {string=} action
	         * @returns void
	         */
	        function _bindSequence(combo, keys, callback, action) {
	
	            // start off by adding a sequence level record for this combination
	            // and setting the level to 0
	            _sequenceLevels[combo] = 0;
	
	            /**
	             * callback to increase the sequence level for this sequence and reset
	             * all other sequences that were active
	             *
	             * @param {string} nextAction
	             * @returns {Function}
	             */
	            function _increaseSequence(nextAction) {
	                return function() {
	                    _nextExpectedAction = nextAction;
	                    ++_sequenceLevels[combo];
	                    _resetSequenceTimer();
	                };
	            }
	
	            /**
	             * wraps the specified callback inside of another function in order
	             * to reset all sequence counters as soon as this sequence is done
	             *
	             * @param {Event} e
	             * @returns void
	             */
	            function _callbackAndReset(e) {
	                _fireCallback(callback, e, combo);
	
	                // we should ignore the next key up if the action is key down
	                // or keypress.  this is so if you finish a sequence and
	                // release the key the final key will not trigger a keyup
	                if (action !== 'keyup') {
	                    _ignoreNextKeyup = _characterFromEvent(e);
	                }
	
	                // weird race condition if a sequence ends with the key
	                // another sequence begins with
	                setTimeout(_resetSequences, 10);
	            }
	
	            // loop through keys one at a time and bind the appropriate callback
	            // function.  for any key leading up to the final one it should
	            // increase the sequence. after the final, it should reset all sequences
	            //
	            // if an action is specified in the original bind call then that will
	            // be used throughout.  otherwise we will pass the action that the
	            // next key in the sequence should match.  this allows a sequence
	            // to mix and match keypress and keydown events depending on which
	            // ones are better suited to the key provided
	            for (var i = 0; i < keys.length; ++i) {
	                var isFinal = i + 1 === keys.length;
	                var wrappedCallback = isFinal ? _callbackAndReset : _increaseSequence(action || _getKeyInfo(keys[i + 1]).action);
	                _bindSingle(keys[i], wrappedCallback, action, combo, i);
	            }
	        }
	
	        /**
	         * binds a single keyboard combination
	         *
	         * @param {string} combination
	         * @param {Function} callback
	         * @param {string=} action
	         * @param {string=} sequenceName - name of sequence if part of sequence
	         * @param {number=} level - what part of the sequence the command is
	         * @returns void
	         */
	        function _bindSingle(combination, callback, action, sequenceName, level) {
	
	            // store a direct mapped reference for use with Mousetrap.trigger
	            self._directMap[combination + ':' + action] = callback;
	
	            // make sure multiple spaces in a row become a single space
	            combination = combination.replace(/\s+/g, ' ');
	
	            var sequence = combination.split(' ');
	            var info;
	
	            // if this pattern is a sequence of keys then run through this method
	            // to reprocess each pattern one key at a time
	            if (sequence.length > 1) {
	                _bindSequence(combination, sequence, callback, action);
	                return;
	            }
	
	            info = _getKeyInfo(combination, action);
	
	            // make sure to initialize array if this is the first time
	            // a callback is added for this key
	            self._callbacks[info.key] = self._callbacks[info.key] || [];
	
	            // remove an existing match if there is one
	            _getMatches(info.key, info.modifiers, {type: info.action}, sequenceName, combination, level);
	
	            // add this call back to the array
	            // if it is a sequence put it at the beginning
	            // if not put it at the end
	            //
	            // this is important because the way these are processed expects
	            // the sequence ones to come first
	            self._callbacks[info.key][sequenceName ? 'unshift' : 'push']({
	                callback: callback,
	                modifiers: info.modifiers,
	                action: info.action,
	                seq: sequenceName,
	                level: level,
	                combo: combination
	            });
	        }
	
	        /**
	         * binds multiple combinations to the same callback
	         *
	         * @param {Array} combinations
	         * @param {Function} callback
	         * @param {string|undefined} action
	         * @returns void
	         */
	        self._bindMultiple = function(combinations, callback, action) {
	            for (var i = 0; i < combinations.length; ++i) {
	                _bindSingle(combinations[i], callback, action);
	            }
	        };
	
	        // start!
	        _addEvent(targetElement, 'keypress', _handleKeyEvent);
	        _addEvent(targetElement, 'keydown', _handleKeyEvent);
	        _addEvent(targetElement, 'keyup', _handleKeyEvent);
	    }
	
	    /**
	     * binds an event to mousetrap
	     *
	     * can be a single key, a combination of keys separated with +,
	     * an array of keys, or a sequence of keys separated by spaces
	     *
	     * be sure to list the modifier keys first to make sure that the
	     * correct key ends up getting bound (the last key in the pattern)
	     *
	     * @param {string|Array} keys
	     * @param {Function} callback
	     * @param {string=} action - 'keypress', 'keydown', or 'keyup'
	     * @returns void
	     */
	    Mousetrap.prototype.bind = function(keys, callback, action) {
	        var self = this;
	        keys = keys instanceof Array ? keys : [keys];
	        self._bindMultiple.call(self, keys, callback, action);
	        return self;
	    };
	
	    /**
	     * unbinds an event to mousetrap
	     *
	     * the unbinding sets the callback function of the specified key combo
	     * to an empty function and deletes the corresponding key in the
	     * _directMap dict.
	     *
	     * TODO: actually remove this from the _callbacks dictionary instead
	     * of binding an empty function
	     *
	     * the keycombo+action has to be exactly the same as
	     * it was defined in the bind method
	     *
	     * @param {string|Array} keys
	     * @param {string} action
	     * @returns void
	     */
	    Mousetrap.prototype.unbind = function(keys, action) {
	        var self = this;
	        return self.bind.call(self, keys, function() {}, action);
	    };
	
	    /**
	     * triggers an event that has already been bound
	     *
	     * @param {string} keys
	     * @param {string=} action
	     * @returns void
	     */
	    Mousetrap.prototype.trigger = function(keys, action) {
	        var self = this;
	        if (self._directMap[keys + ':' + action]) {
	            self._directMap[keys + ':' + action]({}, keys);
	        }
	        return self;
	    };
	
	    /**
	     * resets the library back to its initial state.  this is useful
	     * if you want to clear out the current keyboard shortcuts and bind
	     * new ones - for example if you switch to another page
	     *
	     * @returns void
	     */
	    Mousetrap.prototype.reset = function() {
	        var self = this;
	        self._callbacks = {};
	        self._directMap = {};
	        return self;
	    };
	
	    /**
	     * should we stop this event before firing off callbacks
	     *
	     * @param {Event} e
	     * @param {Element} element
	     * @return {boolean}
	     */
	    Mousetrap.prototype.stopCallback = function(e, element) {
	        var self = this;
	
	        // if the element has the class "mousetrap" then no need to stop
	        if ((' ' + element.className + ' ').indexOf(' mousetrap ') > -1) {
	            return false;
	        }
	
	        if (_belongsTo(element, self.target)) {
	            return false;
	        }
	
	        // stop for input, select, and textarea
	        return element.tagName == 'INPUT' || element.tagName == 'SELECT' || element.tagName == 'TEXTAREA' || element.isContentEditable;
	    };
	
	    /**
	     * exposes _handleKey publicly so it can be overwritten by extensions
	     */
	    Mousetrap.prototype.handleKey = function() {
	        var self = this;
	        return self._handleKey.apply(self, arguments);
	    };
	
	    /**
	     * allow custom key mappings
	     */
	    Mousetrap.addKeycodes = function(object) {
	        for (var key in object) {
	            if (object.hasOwnProperty(key)) {
	                _MAP[key] = object[key];
	            }
	        }
	        _REVERSE_MAP = null;
	    };
	
	    /**
	     * Init the global mousetrap functions
	     *
	     * This method is needed to allow the global mousetrap functions to work
	     * now that mousetrap is a constructor function.
	     */
	    Mousetrap.init = function() {
	        var documentMousetrap = Mousetrap(document);
	        for (var method in documentMousetrap) {
	            if (method.charAt(0) !== '_') {
	                Mousetrap[method] = (function(method) {
	                    return function() {
	                        return documentMousetrap[method].apply(documentMousetrap, arguments);
	                    };
	                } (method));
	            }
	        }
	    };
	
	    Mousetrap.init();
	
	    // expose mousetrap to the global object
	    window.Mousetrap = Mousetrap;
	
	    // expose as a common js module
	    if (typeof module !== 'undefined' && module.exports) {
	        module.exports = Mousetrap;
	    }
	
	    // expose mousetrap as an AMD module
	    if (true) {
	        !(__WEBPACK_AMD_DEFINE_RESULT__ = function() {
	            return Mousetrap;
	        }.call(exports, __webpack_require__, exports, module), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	    }
	}) (typeof window !== 'undefined' ? window : null, typeof  window !== 'undefined' ? document : null);


/***/ },
/* 16 */
/***/ function(module, exports) {

	'use strict';
	
	exports.__esModule = true;
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var BaseViewVM = exports.BaseViewVM = function () {
	  function BaseViewVM(sails, router, eventAggregator, config) {
	    _classCallCheck(this, BaseViewVM);
	
	    this.entity = {};
	
	    this.sails = sails;
	    this.router = router;
	    this.baseCtrlUrl = config.baseCtrlUrl;
	    this.ea = eventAggregator;
	  }
	
	  BaseViewVM.prototype.submit = function submit() {
	    var _this = this;
	
	    this.sails.put('' + this.baseCtrlUrl + this.entity.id, this.entity).then(function (data) {
	      return _this.router.navigate('');
	    });
	  };
	
	  BaseViewVM.prototype.deleteEntity = function deleteEntity() {
	    var _this2 = this;
	
	    if (confirm('Are you sure you want to remove?')) {
	      this.sails.delete('' + this.baseCtrlUrl + this.entity.id).then(function (data) {
	        return _this2.router.navigate('');
	      });
	    }
	  };
	
	  BaseViewVM.prototype.attached = function attached() {
	    this.ea.publish('InEditMode', true);
	  };
	
	  BaseViewVM.prototype.detached = function detached() {
	    this.ea.publish('InEditMode', false);
	  };
	
	  BaseViewVM.prototype.activate = function activate(params) {
	    var _this3 = this;
	
	    return this.sails.get('' + this.baseCtrlUrl + this.getIdParam(params)).then(function (res) {
	      _this3.entity = res.body;
	    }).catch(function (res) {
	      console.log(res);
	      _this3.router.navigate('');
	    });
	  };
	
	  BaseViewVM.prototype.getIdParam = function getIdParam(params) {
	    return params.id;
	  };
	
	  return BaseViewVM;
	}();

/***/ },
/* 17 */
/***/ function(module, exports, __webpack_require__) {

	/* WEBPACK VAR INJECTION */(function($) {'use strict';
	
	exports.__esModule = true;
	exports.App = undefined;
	
	var _dec, _class;
	
	__webpack_require__(15);
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var App = exports.App = (_dec = (0, _aureliaFramework.inject)(_aureliaEventAggregator.EventAggregator, _aureliaSailsSocketClient.SailsSocketClient), _dec(_class = function () {
	  App.prototype.configureRouter = function configureRouter(config, router) {
	    config.title = 'iQ';
	    config.map([{ route: ['', 'welcome'], name: 'welcome', moduleId: 'home/welcome', nav: true, title: 'Welcome', settings: { icon: 'home' } }, { route: 'test', name: 'test', moduleId: 'test/welcome', nav: true, title: 'Components Playground', settings: { icon: 'code' } }, { route: 'QuestionCategories', name: 'questionCategory', moduleId: 'questionCategory/child-router', nav: true, title: 'Question Categories', settings: { icon: 'tag' } }, { route: 'QuestionTypes', name: 'questionType', moduleId: 'questionType/child-router', nav: true, title: 'Question Types', settings: { icon: 'diamond' } }, { route: 'QuestionKinds', name: 'questionKind', moduleId: 'questionKind/child-router', nav: true, title: 'Question Kinds', settings: { icon: 'asterisk' } }, { route: 'Questions', name: 'question', moduleId: 'question/child-router', nav: true, title: 'Questions', settings: { icon: 'list' } }, { route: 'Users', name: 'user', moduleId: 'users/child-router', nav: true, title: 'Users', settings: { icon: 'users' } }, { route: 'login', name: 'login', moduleId: 'auth/index', nav: false, title: 'Login' }]);
	
	    this.router = router;
	    Mousetrap.bind('w', function () {
	      window.location = "#";
	    });
	    Mousetrap.bind('q t', function () {
	      window.location = "#QuestionTypes";
	    });
	    Mousetrap.bind('q n', function () {
	      window.location = "#Questions";
	    });
	    Mousetrap.bind('q c', function () {
	      window.location = "#QuestionCategories";
	    });
	    Mousetrap.bind('q k', function () {
	      window.location = "#QuestionKinds";
	    });
	  };
	
	  function App(eventAggregator, sails) {
	    _classCallCheck(this, App);
	
	    this.ea = eventAggregator;
	    this.sails = sails;
	  }
	
	  App.prototype.logout = function logout() {
	    var _this = this;
	
	    this.sails.get('/logout').then(function () {
	      _this.user = null;
	      _this.router.navigate('/login');
	    }).catch(function (res) {
	      console.log(res);
	    });
	  };
	
	  App.prototype.attached = function attached() {
	    var _this2 = this;
	
	    $("a.sidebar-toggle").on('click', function () {
	      $('.ui.sidebar').sidebar('toggle');
	    });
	
	    this.sails.get('/questions/currentUser').then(function (res) {
	      _this2.user = res.body.user;
	    }).catch(function (res) {
	      if (res.statusCode === 403) {
	        _this2.router.navigate("/login");
	      } else {
	        console.log(res);
	      }
	    });
	
	    this.subscriber = this.ea.subscribe('uerAuthenticated', function (response) {
	      _this2.user = response;
	    });
	  };
	
	  App.prototype.detached = function detached() {
	    this.subscriber.dispose();
	  };
	
	  return App;
	}()) || _class);
	/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(13)))

/***/ },
/* 18 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.LogManager = exports.FrameworkConfiguration = exports.Aurelia = undefined;
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	Object.keys(_aureliaDependencyInjection).forEach(function (key) {
	  if (key === "default" || key === "__esModule") return;
	  Object.defineProperty(exports, key, {
	    enumerable: true,
	    get: function get() {
	      return _aureliaDependencyInjection[key];
	    }
	  });
	});
	
	var _aureliaBinding = __webpack_require__(20);
	
	Object.keys(_aureliaBinding).forEach(function (key) {
	  if (key === "default" || key === "__esModule") return;
	  Object.defineProperty(exports, key, {
	    enumerable: true,
	    get: function get() {
	      return _aureliaBinding[key];
	    }
	  });
	});
	
	var _aureliaMetadata = __webpack_require__(7);
	
	Object.keys(_aureliaMetadata).forEach(function (key) {
	  if (key === "default" || key === "__esModule") return;
	  Object.defineProperty(exports, key, {
	    enumerable: true,
	    get: function get() {
	      return _aureliaMetadata[key];
	    }
	  });
	});
	
	var _aureliaTemplating = __webpack_require__(24);
	
	Object.keys(_aureliaTemplating).forEach(function (key) {
	  if (key === "default" || key === "__esModule") return;
	  Object.defineProperty(exports, key, {
	    enumerable: true,
	    get: function get() {
	      return _aureliaTemplating[key];
	    }
	  });
	});
	
	var _aureliaLoader = __webpack_require__(8);
	
	Object.keys(_aureliaLoader).forEach(function (key) {
	  if (key === "default" || key === "__esModule") return;
	  Object.defineProperty(exports, key, {
	    enumerable: true,
	    get: function get() {
	      return _aureliaLoader[key];
	    }
	  });
	});
	
	var _aureliaTaskQueue = __webpack_require__(21);
	
	Object.keys(_aureliaTaskQueue).forEach(function (key) {
	  if (key === "default" || key === "__esModule") return;
	  Object.defineProperty(exports, key, {
	    enumerable: true,
	    get: function get() {
	      return _aureliaTaskQueue[key];
	    }
	  });
	});
	
	var _aureliaPath = __webpack_require__(9);
	
	Object.keys(_aureliaPath).forEach(function (key) {
	  if (key === "default" || key === "__esModule") return;
	  Object.defineProperty(exports, key, {
	    enumerable: true,
	    get: function get() {
	      return _aureliaPath[key];
	    }
	  });
	});
	
	var _aureliaPal = __webpack_require__(4);
	
	Object.keys(_aureliaPal).forEach(function (key) {
	  if (key === "default" || key === "__esModule") return;
	  Object.defineProperty(exports, key, {
	    enumerable: true,
	    get: function get() {
	      return _aureliaPal[key];
	    }
	  });
	});
	
	var _aureliaLogging = __webpack_require__(14);
	
	var TheLogManager = _interopRequireWildcard(_aureliaLogging);
	
	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function preventActionlessFormSubmit() {
	  _aureliaPal.DOM.addEventListener('submit', function (evt) {
	    var target = evt.target;
	    var action = target.action;
	
	    if (target.tagName.toLowerCase() === 'form' && !action) {
	      evt.preventDefault();
	    }
	  });
	}
	
	var Aurelia = exports.Aurelia = function () {
	  function Aurelia(loader, container, resources) {
	    _classCallCheck(this, Aurelia);
	
	    this.loader = loader || new _aureliaPal.PLATFORM.Loader();
	    this.container = container || new _aureliaDependencyInjection.Container().makeGlobal();
	    this.resources = resources || new _aureliaTemplating.ViewResources();
	    this.use = new FrameworkConfiguration(this);
	    this.logger = TheLogManager.getLogger('aurelia');
	    this.hostConfigured = false;
	    this.host = null;
	
	    this.use.instance(Aurelia, this);
	    this.use.instance(_aureliaLoader.Loader, this.loader);
	    this.use.instance(_aureliaTemplating.ViewResources, this.resources);
	  }
	
	  Aurelia.prototype.start = function start() {
	    var _this = this;
	
	    if (this.started) {
	      return Promise.resolve(this);
	    }
	
	    this.started = true;
	    this.logger.info('Aurelia Starting');
	
	    return this.use.apply().then(function () {
	      preventActionlessFormSubmit();
	
	      if (!_this.container.hasResolver(_aureliaTemplating.BindingLanguage)) {
	        var message = 'You must configure Aurelia with a BindingLanguage implementation.';
	        _this.logger.error(message);
	        throw new Error(message);
	      }
	
	      _this.logger.info('Aurelia Started');
	      var evt = _aureliaPal.DOM.createCustomEvent('aurelia-started', { bubbles: true, cancelable: true });
	      _aureliaPal.DOM.dispatchEvent(evt);
	      return _this;
	    });
	  };
	
	  Aurelia.prototype.enhance = function enhance() {
	    var _this2 = this;
	
	    var bindingContext = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];
	    var applicationHost = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];
	
	    this._configureHost(applicationHost || _aureliaPal.DOM.querySelectorAll('body')[0]);
	
	    return new Promise(function (resolve) {
	      var engine = _this2.container.get(_aureliaTemplating.TemplatingEngine);
	      _this2.root = engine.enhance({ container: _this2.container, element: _this2.host, resources: _this2.resources, bindingContext: bindingContext });
	      _this2.root.attached();
	      _this2._onAureliaComposed();
	      return _this2;
	    });
	  };
	
	  Aurelia.prototype.setRoot = function setRoot() {
	    var _this3 = this;
	
	    var root = arguments.length <= 0 || arguments[0] === undefined ? 'app' : arguments[0];
	    var applicationHost = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];
	
	    var instruction = {};
	
	    if (this.root && this.root.viewModel && this.root.viewModel.router) {
	      this.root.viewModel.router.deactivate();
	      this.root.viewModel.router.reset();
	    }
	
	    this._configureHost(applicationHost);
	
	    var engine = this.container.get(_aureliaTemplating.TemplatingEngine);
	    var transaction = this.container.get(_aureliaTemplating.CompositionTransaction);
	    delete transaction.initialComposition;
	
	    instruction.viewModel = root;
	    instruction.container = instruction.childContainer = this.container;
	    instruction.viewSlot = this.hostSlot;
	    instruction.host = this.host;
	
	    return engine.compose(instruction).then(function (r) {
	      _this3.root = r;
	      instruction.viewSlot.attached();
	      _this3._onAureliaComposed();
	      return _this3;
	    });
	  };
	
	  Aurelia.prototype._configureHost = function _configureHost(applicationHost) {
	    if (this.hostConfigured) {
	      return;
	    }
	    applicationHost = applicationHost || this.host;
	
	    if (!applicationHost || typeof applicationHost === 'string') {
	      this.host = _aureliaPal.DOM.getElementById(applicationHost || 'applicationHost');
	    } else {
	      this.host = applicationHost;
	    }
	
	    if (!this.host) {
	      throw new Error('No applicationHost was specified.');
	    }
	
	    this.hostConfigured = true;
	    this.host.aurelia = this;
	    this.hostSlot = new _aureliaTemplating.ViewSlot(this.host, true);
	    this.hostSlot.transformChildNodesIntoView();
	    this.container.registerInstance(_aureliaPal.DOM.boundary, this.host);
	  };
	
	  Aurelia.prototype._onAureliaComposed = function _onAureliaComposed() {
	    var evt = _aureliaPal.DOM.createCustomEvent('aurelia-composed', { bubbles: true, cancelable: true });
	    setTimeout(function () {
	      return _aureliaPal.DOM.dispatchEvent(evt);
	    }, 1);
	  };
	
	  return Aurelia;
	}();
	
	var logger = TheLogManager.getLogger('aurelia');
	var extPattern = /\.[^/.]+$/;
	
	function runTasks(config, tasks) {
	  var current = void 0;
	  var next = function next() {
	    if (current = tasks.shift()) {
	      return Promise.resolve(current(config)).then(next);
	    }
	
	    return Promise.resolve();
	  };
	
	  return next();
	}
	
	function loadPlugin(config, loader, info) {
	  logger.debug('Loading plugin ' + info.moduleId + '.');
	  config.resourcesRelativeTo = info.resourcesRelativeTo;
	
	  var id = info.moduleId;
	
	  if (info.resourcesRelativeTo.length > 1) {
	    return loader.normalize(info.moduleId, info.resourcesRelativeTo[1]).then(function (normalizedId) {
	      return _loadPlugin(normalizedId);
	    });
	  }
	
	  return _loadPlugin(id);
	
	  function _loadPlugin(moduleId) {
	    return loader.loadModule(moduleId).then(function (m) {
	      if ('configure' in m) {
	        return Promise.resolve(m.configure(config, info.config || {})).then(function () {
	          config.resourcesRelativeTo = null;
	          logger.debug('Configured plugin ' + info.moduleId + '.');
	        });
	      }
	
	      config.resourcesRelativeTo = null;
	      logger.debug('Loaded plugin ' + info.moduleId + '.');
	    });
	  }
	}
	
	function loadResources(aurelia, resourcesToLoad, appResources) {
	  var viewEngine = aurelia.container.get(_aureliaTemplating.ViewEngine);
	
	  return Promise.all(Object.keys(resourcesToLoad).map(function (n) {
	    return _normalize(resourcesToLoad[n]);
	  })).then(function (loads) {
	    var names = [];
	    var importIds = [];
	
	    loads.forEach(function (l) {
	      names.push(undefined);
	      importIds.push(l.importId);
	    });
	
	    return viewEngine.importViewResources(importIds, names, appResources);
	  });
	
	  function _normalize(load) {
	    var moduleId = load.moduleId;
	    var ext = getExt(moduleId);
	
	    if (isOtherResource(moduleId)) {
	      moduleId = removeExt(moduleId);
	    }
	
	    return aurelia.loader.normalize(moduleId, load.relativeTo).then(function (normalized) {
	      return {
	        name: load.moduleId,
	        importId: isOtherResource(load.moduleId) ? addOriginalExt(normalized, ext) : normalized
	      };
	    });
	  }
	
	  function isOtherResource(name) {
	    var ext = getExt(name);
	    if (!ext) return false;
	    if (ext === '') return false;
	    if (ext === '.js' || ext === '.ts') return false;
	    return true;
	  }
	
	  function removeExt(name) {
	    return name.replace(extPattern, '');
	  }
	
	  function addOriginalExt(normalized, ext) {
	    return removeExt(normalized) + '.' + ext;
	  }
	}
	
	function getExt(name) {
	  var match = name.match(extPattern);
	  if (match && match.length > 0) {
	    return match[0].split('.')[1];
	  }
	}
	
	function assertProcessed(plugins) {
	  if (plugins.processed) {
	    throw new Error('This config instance has already been applied. To load more plugins or global resources, create a new FrameworkConfiguration instance.');
	  }
	}
	
	var FrameworkConfiguration = function () {
	  function FrameworkConfiguration(aurelia) {
	    var _this4 = this;
	
	    _classCallCheck(this, FrameworkConfiguration);
	
	    this.aurelia = aurelia;
	    this.container = aurelia.container;
	    this.info = [];
	    this.processed = false;
	    this.preTasks = [];
	    this.postTasks = [];
	    this.resourcesToLoad = {};
	    this.preTask(function () {
	      return aurelia.loader.normalize('aurelia-bootstrapper').then(function (name) {
	        return _this4.bootstrapperName = name;
	      });
	    });
	    this.postTask(function () {
	      return loadResources(aurelia, _this4.resourcesToLoad, aurelia.resources);
	    });
	  }
	
	  FrameworkConfiguration.prototype.instance = function instance(type, _instance) {
	    this.container.registerInstance(type, _instance);
	    return this;
	  };
	
	  FrameworkConfiguration.prototype.singleton = function singleton(type, implementation) {
	    this.container.registerSingleton(type, implementation);
	    return this;
	  };
	
	  FrameworkConfiguration.prototype.transient = function transient(type, implementation) {
	    this.container.registerTransient(type, implementation);
	    return this;
	  };
	
	  FrameworkConfiguration.prototype.preTask = function preTask(task) {
	    assertProcessed(this);
	    this.preTasks.push(task);
	    return this;
	  };
	
	  FrameworkConfiguration.prototype.postTask = function postTask(task) {
	    assertProcessed(this);
	    this.postTasks.push(task);
	    return this;
	  };
	
	  FrameworkConfiguration.prototype.feature = function feature(plugin, config) {
	    if (getExt(plugin)) {
	      return this.plugin({ moduleId: plugin, resourcesRelativeTo: [plugin, ''], config: config || {} });
	    }
	
	    return this.plugin({ moduleId: plugin + '/index', resourcesRelativeTo: [plugin, ''], config: config || {} });
	  };
	
	  FrameworkConfiguration.prototype.globalResources = function globalResources(resources) {
	    assertProcessed(this);
	
	    var toAdd = Array.isArray(resources) ? resources : arguments;
	    var resource = void 0;
	    var path = void 0;
	    var resourcesRelativeTo = this.resourcesRelativeTo || ['', ''];
	
	    for (var i = 0, ii = toAdd.length; i < ii; ++i) {
	      resource = toAdd[i];
	      if (typeof resource !== 'string') {
	        throw new Error('Invalid resource path [' + resource + ']. Resources must be specified as relative module IDs.');
	      }
	
	      var parent = resourcesRelativeTo[0];
	      var grandParent = resourcesRelativeTo[1];
	      var name = resource;
	
	      if (resource.startsWith('./') && parent !== '') {
	        name = parent + resource.substr(1);
	      }
	
	      this.resourcesToLoad[name] = { moduleId: name, relativeTo: grandParent };
	    }
	
	    return this;
	  };
	
	  FrameworkConfiguration.prototype.globalName = function globalName(resourcePath, newName) {
	    assertProcessed(this);
	    this.resourcesToLoad[resourcePath] = { moduleId: newName, relativeTo: '' };
	    return this;
	  };
	
	  FrameworkConfiguration.prototype.plugin = function plugin(_plugin, config) {
	    assertProcessed(this);
	
	    if (typeof _plugin === 'string') {
	      return this.plugin({ moduleId: _plugin, resourcesRelativeTo: [_plugin, ''], config: config || {} });
	    }
	
	    this.info.push(_plugin);
	    return this;
	  };
	
	  FrameworkConfiguration.prototype._addNormalizedPlugin = function _addNormalizedPlugin(name, config) {
	    var _this5 = this;
	
	    var plugin = { moduleId: name, resourcesRelativeTo: [name, ''], config: config || {} };
	    this.plugin(plugin);
	
	    this.preTask(function () {
	      var relativeTo = [name, _this5.bootstrapperName];
	      plugin.moduleId = name;
	      plugin.resourcesRelativeTo = relativeTo;
	      return Promise.resolve();
	    });
	
	    return this;
	  };
	
	  FrameworkConfiguration.prototype.defaultBindingLanguage = function defaultBindingLanguage() {
	    return this._addNormalizedPlugin('aurelia-templating-binding');
	  };
	
	  FrameworkConfiguration.prototype.router = function router() {
	    return this._addNormalizedPlugin('aurelia-templating-router');
	  };
	
	  FrameworkConfiguration.prototype.history = function history() {
	    return this._addNormalizedPlugin('aurelia-history-browser');
	  };
	
	  FrameworkConfiguration.prototype.defaultResources = function defaultResources() {
	    return this._addNormalizedPlugin('aurelia-templating-resources');
	  };
	
	  FrameworkConfiguration.prototype.eventAggregator = function eventAggregator() {
	    return this._addNormalizedPlugin('aurelia-event-aggregator');
	  };
	
	  FrameworkConfiguration.prototype.standardConfiguration = function standardConfiguration() {
	    return this.defaultBindingLanguage().defaultResources().history().router().eventAggregator();
	  };
	
	  FrameworkConfiguration.prototype.developmentLogging = function developmentLogging() {
	    var _this6 = this;
	
	    this.preTask(function () {
	      return _this6.aurelia.loader.normalize('aurelia-logging-console', _this6.bootstrapperName).then(function (name) {
	        return _this6.aurelia.loader.loadModule(name).then(function (m) {
	          TheLogManager.addAppender(new m.ConsoleAppender());
	          TheLogManager.setLevel(TheLogManager.logLevel.debug);
	        });
	      });
	    });
	
	    return this;
	  };
	
	  FrameworkConfiguration.prototype.apply = function apply() {
	    var _this7 = this;
	
	    if (this.processed) {
	      return Promise.resolve();
	    }
	
	    return runTasks(this, this.preTasks).then(function () {
	      var loader = _this7.aurelia.loader;
	      var info = _this7.info;
	      var current = void 0;
	
	      var next = function next() {
	        if (current = info.shift()) {
	          return loadPlugin(_this7, loader, current).then(next);
	        }
	
	        _this7.processed = true;
	        return Promise.resolve();
	      };
	
	      return next().then(function () {
	        return runTasks(_this7, _this7.postTasks);
	      });
	    });
	  };
	
	  return FrameworkConfiguration;
	}();
	
	exports.FrameworkConfiguration = FrameworkConfiguration;
	var LogManager = exports.LogManager = TheLogManager;


/***/ },
/* 19 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.Container = exports.InvocationHandler = exports._emptyParameters = exports.SingletonRegistration = exports.TransientRegistration = exports.FactoryInvoker = exports.Factory = exports.StrategyResolver = exports.Parent = exports.Optional = exports.All = exports.Lazy = exports.resolver = undefined;
	
	var _dec, _class, _dec2, _class2, _dec3, _class3, _dec4, _class4, _dec5, _class5, _dec6, _class6, _classInvokers;
	
	exports.invoker = invoker;
	exports.factory = factory;
	exports.registration = registration;
	exports.transient = transient;
	exports.singleton = singleton;
	exports.autoinject = autoinject;
	exports.inject = inject;
	
	var _aureliaMetadata = __webpack_require__(7);
	
	var _aureliaPal = __webpack_require__(4);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var resolver = exports.resolver = _aureliaMetadata.protocol.create('aurelia:resolver', function (target) {
	  if (!(typeof target.get === 'function')) {
	    return 'Resolvers must implement: get(container: Container, key: any): any';
	  }
	
	  return true;
	});
	
	var Lazy = exports.Lazy = (_dec = resolver(), _dec(_class = function () {
	  function Lazy(key) {
	    _classCallCheck(this, Lazy);
	
	    this._key = key;
	  }
	
	  Lazy.prototype.get = function get(container) {
	    var _this = this;
	
	    return function () {
	      return container.get(_this._key);
	    };
	  };
	
	  Lazy.of = function of(key) {
	    return new Lazy(key);
	  };
	
	  return Lazy;
	}()) || _class);
	var All = exports.All = (_dec2 = resolver(), _dec2(_class2 = function () {
	  function All(key) {
	    _classCallCheck(this, All);
	
	    this._key = key;
	  }
	
	  All.prototype.get = function get(container) {
	    return container.getAll(this._key);
	  };
	
	  All.of = function of(key) {
	    return new All(key);
	  };
	
	  return All;
	}()) || _class2);
	var Optional = exports.Optional = (_dec3 = resolver(), _dec3(_class3 = function () {
	  function Optional(key) {
	    var checkParent = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
	
	    _classCallCheck(this, Optional);
	
	    this._key = key;
	    this._checkParent = checkParent;
	  }
	
	  Optional.prototype.get = function get(container) {
	    if (container.hasResolver(this._key, this._checkParent)) {
	      return container.get(this._key);
	    }
	
	    return null;
	  };
	
	  Optional.of = function of(key) {
	    var checkParent = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
	
	    return new Optional(key, checkParent);
	  };
	
	  return Optional;
	}()) || _class3);
	var Parent = exports.Parent = (_dec4 = resolver(), _dec4(_class4 = function () {
	  function Parent(key) {
	    _classCallCheck(this, Parent);
	
	    this._key = key;
	  }
	
	  Parent.prototype.get = function get(container) {
	    return container.parent ? container.parent.get(this._key) : null;
	  };
	
	  Parent.of = function of(key) {
	    return new Parent(key);
	  };
	
	  return Parent;
	}()) || _class4);
	var StrategyResolver = exports.StrategyResolver = (_dec5 = resolver(), _dec5(_class5 = function () {
	  function StrategyResolver(strategy, state) {
	    _classCallCheck(this, StrategyResolver);
	
	    this.strategy = strategy;
	    this.state = state;
	  }
	
	  StrategyResolver.prototype.get = function get(container, key) {
	    switch (this.strategy) {
	      case 0:
	        return this.state;
	      case 1:
	        var singleton = container.invoke(this.state);
	        this.state = singleton;
	        this.strategy = 0;
	        return singleton;
	      case 2:
	        return container.invoke(this.state);
	      case 3:
	        return this.state(container, key, this);
	      case 4:
	        return this.state[0].get(container, key);
	      case 5:
	        return container.get(this.state);
	      default:
	        throw new Error('Invalid strategy: ' + this.strategy);
	    }
	  };
	
	  return StrategyResolver;
	}()) || _class5);
	var Factory = exports.Factory = (_dec6 = resolver(), _dec6(_class6 = function () {
	  function Factory(key) {
	    _classCallCheck(this, Factory);
	
	    this._key = key;
	  }
	
	  Factory.prototype.get = function get(container) {
	    var _this2 = this;
	
	    return function () {
	      for (var _len = arguments.length, rest = Array(_len), _key = 0; _key < _len; _key++) {
	        rest[_key] = arguments[_key];
	      }
	
	      return container.invoke(_this2._key, rest);
	    };
	  };
	
	  Factory.of = function of(key) {
	    return new Factory(key);
	  };
	
	  return Factory;
	}()) || _class6);
	function invoker(value) {
	  return function (target) {
	    _aureliaMetadata.metadata.define(_aureliaMetadata.metadata.invoker, value, target);
	  };
	}
	
	function factory(potentialTarget) {
	  var deco = function deco(target) {
	    _aureliaMetadata.metadata.define(_aureliaMetadata.metadata.invoker, FactoryInvoker.instance, target);
	  };
	
	  return potentialTarget ? deco(potentialTarget) : deco;
	}
	
	var FactoryInvoker = exports.FactoryInvoker = function () {
	  function FactoryInvoker() {
	    _classCallCheck(this, FactoryInvoker);
	  }
	
	  FactoryInvoker.prototype.invoke = function invoke(container, fn, dependencies) {
	    var i = dependencies.length;
	    var args = new Array(i);
	
	    while (i--) {
	      args[i] = container.get(dependencies[i]);
	    }
	
	    return fn.apply(undefined, args);
	  };
	
	  FactoryInvoker.prototype.invokeWithDynamicDependencies = function invokeWithDynamicDependencies(container, fn, staticDependencies, dynamicDependencies) {
	    var i = staticDependencies.length;
	    var args = new Array(i);
	
	    while (i--) {
	      args[i] = container.get(staticDependencies[i]);
	    }
	
	    if (dynamicDependencies !== undefined) {
	      args = args.concat(dynamicDependencies);
	    }
	
	    return fn.apply(undefined, args);
	  };
	
	  return FactoryInvoker;
	}();
	
	FactoryInvoker.instance = new FactoryInvoker();
	
	function registration(value) {
	  return function (target) {
	    _aureliaMetadata.metadata.define(_aureliaMetadata.metadata.registration, value, target);
	  };
	}
	
	function transient(key) {
	  return registration(new TransientRegistration(key));
	}
	
	function singleton(keyOrRegisterInChild) {
	  var registerInChild = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
	
	  return registration(new SingletonRegistration(keyOrRegisterInChild, registerInChild));
	}
	
	var TransientRegistration = exports.TransientRegistration = function () {
	  function TransientRegistration(key) {
	    _classCallCheck(this, TransientRegistration);
	
	    this._key = key;
	  }
	
	  TransientRegistration.prototype.registerResolver = function registerResolver(container, key, fn) {
	    var resolver = new StrategyResolver(2, fn);
	    container.registerResolver(this._key || key, resolver);
	    return resolver;
	  };
	
	  return TransientRegistration;
	}();
	
	var SingletonRegistration = exports.SingletonRegistration = function () {
	  function SingletonRegistration(keyOrRegisterInChild) {
	    var registerInChild = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
	
	    _classCallCheck(this, SingletonRegistration);
	
	    if (typeof keyOrRegisterInChild === 'boolean') {
	      this._registerInChild = keyOrRegisterInChild;
	    } else {
	      this._key = keyOrRegisterInChild;
	      this._registerInChild = registerInChild;
	    }
	  }
	
	  SingletonRegistration.prototype.registerResolver = function registerResolver(container, key, fn) {
	    var resolver = new StrategyResolver(1, fn);
	
	    if (this._registerInChild) {
	      container.registerResolver(this._key || key, resolver);
	    } else {
	      container.root.registerResolver(this._key || key, resolver);
	    }
	
	    return resolver;
	  };
	
	  return SingletonRegistration;
	}();
	
	var badKeyError = 'key/value cannot be null or undefined. Are you trying to inject/register something that doesn\'t exist with DI?';
	var _emptyParameters = exports._emptyParameters = Object.freeze([]);
	
	_aureliaMetadata.metadata.registration = 'aurelia:registration';
	_aureliaMetadata.metadata.invoker = 'aurelia:invoker';
	
	var resolverDecorates = resolver.decorates;
	
	var InvocationHandler = exports.InvocationHandler = function () {
	  function InvocationHandler(fn, invoker, dependencies) {
	    _classCallCheck(this, InvocationHandler);
	
	    this.fn = fn;
	    this.invoker = invoker;
	    this.dependencies = dependencies;
	  }
	
	  InvocationHandler.prototype.invoke = function invoke(container, dynamicDependencies) {
	    return dynamicDependencies !== undefined ? this.invoker.invokeWithDynamicDependencies(container, this.fn, this.dependencies, dynamicDependencies) : this.invoker.invoke(container, this.fn, this.dependencies);
	  };
	
	  return InvocationHandler;
	}();
	
	function invokeWithDynamicDependencies(container, fn, staticDependencies, dynamicDependencies) {
	  var i = staticDependencies.length;
	  var args = new Array(i);
	
	  while (i--) {
	    args[i] = container.get(staticDependencies[i]);
	  }
	
	  if (dynamicDependencies !== undefined) {
	    args = args.concat(dynamicDependencies);
	  }
	
	  return Reflect.construct(fn, args);
	}
	
	var classInvokers = (_classInvokers = {}, _classInvokers[0] = {
	  invoke: function invoke(container, Type) {
	    return new Type();
	  },
	
	  invokeWithDynamicDependencies: invokeWithDynamicDependencies
	}, _classInvokers[1] = {
	  invoke: function invoke(container, Type, deps) {
	    return new Type(container.get(deps[0]));
	  },
	
	  invokeWithDynamicDependencies: invokeWithDynamicDependencies
	}, _classInvokers[2] = {
	  invoke: function invoke(container, Type, deps) {
	    return new Type(container.get(deps[0]), container.get(deps[1]));
	  },
	
	  invokeWithDynamicDependencies: invokeWithDynamicDependencies
	}, _classInvokers[3] = {
	  invoke: function invoke(container, Type, deps) {
	    return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]));
	  },
	
	  invokeWithDynamicDependencies: invokeWithDynamicDependencies
	}, _classInvokers[4] = {
	  invoke: function invoke(container, Type, deps) {
	    return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]), container.get(deps[3]));
	  },
	
	  invokeWithDynamicDependencies: invokeWithDynamicDependencies
	}, _classInvokers[5] = {
	  invoke: function invoke(container, Type, deps) {
	    return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]), container.get(deps[3]), container.get(deps[4]));
	  },
	
	  invokeWithDynamicDependencies: invokeWithDynamicDependencies
	}, _classInvokers.fallback = {
	  invoke: invokeWithDynamicDependencies,
	  invokeWithDynamicDependencies: invokeWithDynamicDependencies
	}, _classInvokers);
	
	function getDependencies(f) {
	  if (!f.hasOwnProperty('inject')) {
	    return [];
	  }
	
	  if (typeof f.inject === 'function') {
	    return f.inject();
	  }
	
	  return f.inject;
	}
	
	var Container = exports.Container = function () {
	  function Container(configuration) {
	    _classCallCheck(this, Container);
	
	    if (configuration === undefined) {
	      configuration = {};
	    }
	
	    this._configuration = configuration;
	    this._onHandlerCreated = configuration.onHandlerCreated;
	    this._handlers = configuration.handlers || (configuration.handlers = new Map());
	    this._resolvers = new Map();
	    this.root = this;
	    this.parent = null;
	  }
	
	  Container.prototype.makeGlobal = function makeGlobal() {
	    Container.instance = this;
	    return this;
	  };
	
	  Container.prototype.setHandlerCreatedCallback = function setHandlerCreatedCallback(onHandlerCreated) {
	    this._onHandlerCreated = onHandlerCreated;
	    this._configuration.onHandlerCreated = onHandlerCreated;
	  };
	
	  Container.prototype.registerInstance = function registerInstance(key, instance) {
	    this.registerResolver(key, new StrategyResolver(0, instance === undefined ? key : instance));
	  };
	
	  Container.prototype.registerSingleton = function registerSingleton(key, fn) {
	    this.registerResolver(key, new StrategyResolver(1, fn === undefined ? key : fn));
	  };
	
	  Container.prototype.registerTransient = function registerTransient(key, fn) {
	    this.registerResolver(key, new StrategyResolver(2, fn === undefined ? key : fn));
	  };
	
	  Container.prototype.registerHandler = function registerHandler(key, handler) {
	    this.registerResolver(key, new StrategyResolver(3, handler));
	  };
	
	  Container.prototype.registerAlias = function registerAlias(originalKey, aliasKey) {
	    this.registerResolver(aliasKey, new StrategyResolver(5, originalKey));
	  };
	
	  Container.prototype.registerResolver = function registerResolver(key, resolver) {
	    if (key === null || key === undefined) {
	      throw new Error(badKeyError);
	    }
	
	    var allResolvers = this._resolvers;
	    var result = allResolvers.get(key);
	
	    if (result === undefined) {
	      allResolvers.set(key, resolver);
	    } else if (result.strategy === 4) {
	      result.state.push(resolver);
	    } else {
	      allResolvers.set(key, new StrategyResolver(4, [result, resolver]));
	    }
	  };
	
	  Container.prototype.autoRegister = function autoRegister(fn, key) {
	    var resolver = void 0;
	
	    if (typeof fn === 'function') {
	      var _registration = _aureliaMetadata.metadata.get(_aureliaMetadata.metadata.registration, fn);
	
	      if (_registration === undefined) {
	        resolver = new StrategyResolver(1, fn);
	        this.registerResolver(key === undefined ? fn : key, resolver);
	      } else {
	        resolver = _registration.registerResolver(this, key === undefined ? fn : key, fn);
	      }
	    } else {
	      resolver = new StrategyResolver(0, fn);
	      this.registerResolver(key === undefined ? fn : key, resolver);
	    }
	
	    return resolver;
	  };
	
	  Container.prototype.autoRegisterAll = function autoRegisterAll(fns) {
	    var i = fns.length;
	    while (i--) {
	      this.autoRegister(fns[i]);
	    }
	  };
	
	  Container.prototype.unregister = function unregister(key) {
	    this._resolvers.delete(key);
	  };
	
	  Container.prototype.hasResolver = function hasResolver(key) {
	    var checkParent = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
	
	    if (key === null || key === undefined) {
	      throw new Error(badKeyError);
	    }
	
	    return this._resolvers.has(key) || checkParent && this.parent !== null && this.parent.hasResolver(key, checkParent);
	  };
	
	  Container.prototype.get = function get(key) {
	    if (key === null || key === undefined) {
	      throw new Error(badKeyError);
	    }
	
	    if (key === Container) {
	      return this;
	    }
	
	    if (resolverDecorates(key)) {
	      return key.get(this, key);
	    }
	
	    var resolver = this._resolvers.get(key);
	
	    if (resolver === undefined) {
	      if (this.parent === null) {
	        return this.autoRegister(key).get(this, key);
	      }
	
	      return this.parent._get(key);
	    }
	
	    return resolver.get(this, key);
	  };
	
	  Container.prototype._get = function _get(key) {
	    var resolver = this._resolvers.get(key);
	
	    if (resolver === undefined) {
	      if (this.parent === null) {
	        return this.autoRegister(key).get(this, key);
	      }
	
	      return this.parent._get(key);
	    }
	
	    return resolver.get(this, key);
	  };
	
	  Container.prototype.getAll = function getAll(key) {
	    if (key === null || key === undefined) {
	      throw new Error(badKeyError);
	    }
	
	    var resolver = this._resolvers.get(key);
	
	    if (resolver === undefined) {
	      if (this.parent === null) {
	        return _emptyParameters;
	      }
	
	      return this.parent.getAll(key);
	    }
	
	    if (resolver.strategy === 4) {
	      var state = resolver.state;
	      var i = state.length;
	      var results = new Array(i);
	
	      while (i--) {
	        results[i] = state[i].get(this, key);
	      }
	
	      return results;
	    }
	
	    return [resolver.get(this, key)];
	  };
	
	  Container.prototype.createChild = function createChild() {
	    var child = new Container(this._configuration);
	    child.root = this.root;
	    child.parent = this;
	    return child;
	  };
	
	  Container.prototype.invoke = function invoke(fn, dynamicDependencies) {
	    try {
	      var _handler = this._handlers.get(fn);
	
	      if (_handler === undefined) {
	        _handler = this._createInvocationHandler(fn);
	        this._handlers.set(fn, _handler);
	      }
	
	      return _handler.invoke(this, dynamicDependencies);
	    } catch (e) {
	      throw new _aureliaPal.AggregateError('Error invoking ' + fn.name + '. Check the inner error for details.', e, true);
	    }
	  };
	
	  Container.prototype._createInvocationHandler = function _createInvocationHandler(fn) {
	    var dependencies = void 0;
	
	    if (fn.inject === undefined) {
	      dependencies = _aureliaMetadata.metadata.getOwn(_aureliaMetadata.metadata.paramTypes, fn) || _emptyParameters;
	    } else {
	      dependencies = [];
	      var ctor = fn;
	      while (typeof ctor === 'function') {
	        var _dependencies;
	
	        (_dependencies = dependencies).push.apply(_dependencies, getDependencies(ctor));
	        ctor = Object.getPrototypeOf(ctor);
	      }
	    }
	
	    var invoker = _aureliaMetadata.metadata.getOwn(_aureliaMetadata.metadata.invoker, fn) || classInvokers[dependencies.length] || classInvokers.fallback;
	
	    var handler = new InvocationHandler(fn, invoker, dependencies);
	    return this._onHandlerCreated !== undefined ? this._onHandlerCreated(handler) : handler;
	  };
	
	  return Container;
	}();
	
	function autoinject(potentialTarget) {
	  var deco = function deco(target) {
	    target.inject = _aureliaMetadata.metadata.getOwn(_aureliaMetadata.metadata.paramTypes, target) || _emptyParameters;
	  };
	
	  return potentialTarget ? deco(potentialTarget) : deco;
	}
	
	function inject() {
	  for (var _len2 = arguments.length, rest = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
	    rest[_key2] = arguments[_key2];
	  }
	
	  return function (target, key, descriptor) {
	    if (descriptor) {
	      var _fn = descriptor.value;
	      _fn.inject = rest;
	    } else {
	      target.inject = rest;
	    }
	  };
	}

/***/ },
/* 20 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.getSetObserver = exports.BindingEngine = exports.NameExpression = exports.Listener = exports.ListenerExpression = exports.BindingBehaviorResource = exports.ValueConverterResource = exports.Call = exports.CallExpression = exports.Binding = exports.BindingExpression = exports.ObjectObservationAdapter = exports.ObserverLocator = exports.SVGAnalyzer = exports.presentationAttributes = exports.presentationElements = exports.elements = exports.ComputedExpression = exports.ClassObserver = exports.SelectValueObserver = exports.CheckedObserver = exports.ValueAttributeObserver = exports.StyleObserver = exports.DataAttributeObserver = exports.dataAttributeAccessor = exports.XLinkAttributeObserver = exports.SetterObserver = exports.PrimitiveObserver = exports.propertyAccessor = exports.DirtyCheckProperty = exports.DirtyChecker = exports.EventManager = exports.getMapObserver = exports.ParserImplementation = exports.Parser = exports.Scanner = exports.Lexer = exports.Token = exports.bindingMode = exports.ExpressionCloner = exports.Unparser = exports.LiteralObject = exports.LiteralArray = exports.LiteralString = exports.LiteralPrimitive = exports.PrefixNot = exports.Binary = exports.CallFunction = exports.CallMember = exports.CallScope = exports.AccessKeyed = exports.AccessMember = exports.AccessScope = exports.AccessThis = exports.Conditional = exports.Assign = exports.ValueConverter = exports.BindingBehavior = exports.Chain = exports.Expression = exports.getArrayObserver = exports.CollectionLengthObserver = exports.ModifyCollectionObserver = exports.ExpressionObserver = exports.sourceContext = undefined;
	
	var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol ? "symbol" : typeof obj; };
	
	var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();
	
	var _dec, _dec2, _class, _dec3, _class2, _dec4, _class3, _dec5, _class5, _dec6, _class7, _dec7, _class8, _dec8, _class9, _dec9, _class10, _class11, _temp, _dec10, _class12, _class13, _temp2;
	
	exports.camelCase = camelCase;
	exports.createOverrideContext = createOverrideContext;
	exports.getContextFor = getContextFor;
	exports.createScopeForTest = createScopeForTest;
	exports.connectable = connectable;
	exports.enqueueBindingConnect = enqueueBindingConnect;
	exports.subscriberCollection = subscriberCollection;
	exports.calcSplices = calcSplices;
	exports.mergeSplice = mergeSplice;
	exports.projectArraySplices = projectArraySplices;
	exports.getChangeRecords = getChangeRecords;
	exports.cloneExpression = cloneExpression;
	exports.hasDeclaredDependencies = hasDeclaredDependencies;
	exports.declarePropertyDependencies = declarePropertyDependencies;
	exports.computedFrom = computedFrom;
	exports.createComputedObserver = createComputedObserver;
	exports.valueConverter = valueConverter;
	exports.bindingBehavior = bindingBehavior;
	exports.observable = observable;
	
	var _aureliaLogging = __webpack_require__(14);
	
	var LogManager = _interopRequireWildcard(_aureliaLogging);
	
	var _aureliaPal = __webpack_require__(4);
	
	var _aureliaTaskQueue = __webpack_require__(21);
	
	var _aureliaMetadata = __webpack_require__(7);
	
	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	
	
	var map = Object.create(null);
	
	function camelCase(name) {
	  if (name in map) {
	    return map[name];
	  }
	  var result = name.charAt(0).toLowerCase() + name.slice(1).replace(/[_.-](\w|$)/g, function (_, x) {
	    return x.toUpperCase();
	  });
	  map[name] = result;
	  return result;
	}
	
	function createOverrideContext(bindingContext, parentOverrideContext) {
	  return {
	    bindingContext: bindingContext,
	    parentOverrideContext: parentOverrideContext || null
	  };
	}
	
	function getContextFor(name, scope, ancestor) {
	  var oc = scope.overrideContext;
	
	  if (ancestor) {
	    while (ancestor && oc) {
	      ancestor--;
	      oc = oc.parentOverrideContext;
	    }
	    if (ancestor || !oc) {
	      return undefined;
	    }
	    return name in oc ? oc : oc.bindingContext;
	  }
	
	  while (oc && !(name in oc) && !(oc.bindingContext && name in oc.bindingContext)) {
	    oc = oc.parentOverrideContext;
	  }
	  if (oc) {
	    return name in oc ? oc : oc.bindingContext;
	  }
	
	  return scope.bindingContext || scope.overrideContext;
	}
	
	function createScopeForTest(bindingContext, parentBindingContext) {
	  if (parentBindingContext) {
	    return {
	      bindingContext: bindingContext,
	      overrideContext: createOverrideContext(bindingContext, createOverrideContext(parentBindingContext))
	    };
	  }
	  return {
	    bindingContext: bindingContext,
	    overrideContext: createOverrideContext(bindingContext)
	  };
	}
	
	var sourceContext = exports.sourceContext = 'Binding:source';
	var slotNames = [];
	var versionSlotNames = [];
	
	for (var i = 0; i < 100; i++) {
	  slotNames.push('_observer' + i);
	  versionSlotNames.push('_observerVersion' + i);
	}
	
	function addObserver(observer) {
	  var observerSlots = this._observerSlots === undefined ? 0 : this._observerSlots;
	  var i = observerSlots;
	  while (i-- && this[slotNames[i]] !== observer) {}
	  if (i === -1) {
	    i = 0;
	    while (this[slotNames[i]]) {
	      i++;
	    }
	    this[slotNames[i]] = observer;
	    observer.subscribe(sourceContext, this);
	
	    if (i === observerSlots) {
	      this._observerSlots = i + 1;
	    }
	  }
	
	  if (this._version === undefined) {
	    this._version = 0;
	  }
	  this[versionSlotNames[i]] = this._version;
	}
	
	function observeProperty(obj, propertyName) {
	  var observer = this.observerLocator.getObserver(obj, propertyName);
	  addObserver.call(this, observer);
	}
	
	function observeArray(array) {
	  var observer = this.observerLocator.getArrayObserver(array);
	  addObserver.call(this, observer);
	}
	
	function unobserve(all) {
	  var i = this._observerSlots;
	  while (i--) {
	    if (all || this[versionSlotNames[i]] !== this._version) {
	      var observer = this[slotNames[i]];
	      this[slotNames[i]] = null;
	      if (observer) {
	        observer.unsubscribe(sourceContext, this);
	      }
	    }
	  }
	}
	
	function connectable() {
	  return function (target) {
	    target.prototype.observeProperty = observeProperty;
	    target.prototype.observeArray = observeArray;
	    target.prototype.unobserve = unobserve;
	    target.prototype.addObserver = addObserver;
	  };
	}
	
	var bindings = new Map();
	var minimumImmediate = 100;
	var frameBudget = 15;
	
	var isFlushRequested = false;
	var immediate = 0;
	
	function flush(animationFrameStart) {
	  var i = 0;
	  var keys = bindings.keys();
	  var item = void 0;
	
	  while (item = keys.next()) {
	    if (item.done) {
	      break;
	    }
	
	    var binding = item.value;
	    bindings.delete(binding);
	    binding.connect(true);
	    i++;
	
	    if (i % 100 === 0 && _aureliaPal.PLATFORM.performance.now() - animationFrameStart > frameBudget) {
	      break;
	    }
	  }
	
	  if (bindings.size) {
	    _aureliaPal.PLATFORM.requestAnimationFrame(flush);
	  } else {
	    isFlushRequested = false;
	    immediate = 0;
	  }
	}
	
	function enqueueBindingConnect(binding) {
	  if (immediate < minimumImmediate) {
	    immediate++;
	    binding.connect(false);
	  } else {
	    bindings.set(binding);
	  }
	  if (!isFlushRequested) {
	    isFlushRequested = true;
	    _aureliaPal.PLATFORM.requestAnimationFrame(flush);
	  }
	}
	
	function addSubscriber(context, callable) {
	  if (this.hasSubscriber(context, callable)) {
	    return false;
	  }
	  if (!this._context0) {
	    this._context0 = context;
	    this._callable0 = callable;
	    return true;
	  }
	  if (!this._context1) {
	    this._context1 = context;
	    this._callable1 = callable;
	    return true;
	  }
	  if (!this._context2) {
	    this._context2 = context;
	    this._callable2 = callable;
	    return true;
	  }
	  if (!this._contextsRest) {
	    this._contextsRest = [context];
	    this._callablesRest = [callable];
	    return true;
	  }
	  this._contextsRest.push(context);
	  this._callablesRest.push(callable);
	  return true;
	}
	
	function removeSubscriber(context, callable) {
	  if (this._context0 === context && this._callable0 === callable) {
	    this._context0 = null;
	    this._callable0 = null;
	    return true;
	  }
	  if (this._context1 === context && this._callable1 === callable) {
	    this._context1 = null;
	    this._callable1 = null;
	    return true;
	  }
	  if (this._context2 === context && this._callable2 === callable) {
	    this._context2 = null;
	    this._callable2 = null;
	    return true;
	  }
	  var rest = this._contextsRest;
	  var index = void 0;
	  if (!rest || !rest.length || (index = rest.indexOf(context)) === -1 || this._callablesRest[index] !== callable) {
	    return false;
	  }
	  rest.splice(index, 1);
	  this._callablesRest.splice(index, 1);
	  return true;
	}
	
	var arrayPool1 = [];
	var arrayPool2 = [];
	var poolUtilization = [];
	
	function callSubscribers(newValue, oldValue) {
	  var context0 = this._context0;
	  var callable0 = this._callable0;
	  var context1 = this._context1;
	  var callable1 = this._callable1;
	  var context2 = this._context2;
	  var callable2 = this._callable2;
	  var length = this._contextsRest ? this._contextsRest.length : 0;
	  var contextsRest = void 0;
	  var callablesRest = void 0;
	  var poolIndex = void 0;
	  var i = void 0;
	  if (length) {
	    poolIndex = poolUtilization.length;
	    while (poolIndex-- && poolUtilization[poolIndex]) {}
	    if (poolIndex < 0) {
	      poolIndex = poolUtilization.length;
	      contextsRest = [];
	      callablesRest = [];
	      poolUtilization.push(true);
	      arrayPool1.push(contextsRest);
	      arrayPool2.push(callablesRest);
	    } else {
	      poolUtilization[poolIndex] = true;
	      contextsRest = arrayPool1[poolIndex];
	      callablesRest = arrayPool2[poolIndex];
	    }
	
	    i = length;
	    while (i--) {
	      contextsRest[i] = this._contextsRest[i];
	      callablesRest[i] = this._callablesRest[i];
	    }
	  }
	
	  if (context0) {
	    if (callable0) {
	      callable0.call(context0, newValue, oldValue);
	    } else {
	      context0(newValue, oldValue);
	    }
	  }
	  if (context1) {
	    if (callable1) {
	      callable1.call(context1, newValue, oldValue);
	    } else {
	      context1(newValue, oldValue);
	    }
	  }
	  if (context2) {
	    if (callable2) {
	      callable2.call(context2, newValue, oldValue);
	    } else {
	      context2(newValue, oldValue);
	    }
	  }
	  if (length) {
	    for (i = 0; i < length; i++) {
	      var callable = callablesRest[i];
	      var context = contextsRest[i];
	      if (callable) {
	        callable.call(context, newValue, oldValue);
	      } else {
	        context(newValue, oldValue);
	      }
	      contextsRest[i] = null;
	      callablesRest[i] = null;
	    }
	    poolUtilization[poolIndex] = false;
	  }
	}
	
	function hasSubscribers() {
	  return !!(this._context0 || this._context1 || this._context2 || this._contextsRest && this._contextsRest.length);
	}
	
	function hasSubscriber(context, callable) {
	  var has = this._context0 === context && this._callable0 === callable || this._context1 === context && this._callable1 === callable || this._context2 === context && this._callable2 === callable;
	  if (has) {
	    return true;
	  }
	  var index = void 0;
	  var contexts = this._contextsRest;
	  if (!contexts || (index = contexts.length) === 0) {
	    return false;
	  }
	  var callables = this._callablesRest;
	  while (index--) {
	    if (contexts[index] === context && callables[index] === callable) {
	      return true;
	    }
	  }
	  return false;
	}
	
	function subscriberCollection() {
	  return function (target) {
	    target.prototype.addSubscriber = addSubscriber;
	    target.prototype.removeSubscriber = removeSubscriber;
	    target.prototype.callSubscribers = callSubscribers;
	    target.prototype.hasSubscribers = hasSubscribers;
	    target.prototype.hasSubscriber = hasSubscriber;
	  };
	}
	
	var ExpressionObserver = exports.ExpressionObserver = (_dec = connectable(), _dec2 = subscriberCollection(), _dec(_class = _dec2(_class = function () {
	  function ExpressionObserver(scope, expression, observerLocator, lookupFunctions) {
	    
	
	    this.scope = scope;
	    this.expression = expression;
	    this.observerLocator = observerLocator;
	    this.lookupFunctions = lookupFunctions;
	  }
	
	  ExpressionObserver.prototype.getValue = function getValue() {
	    return this.expression.evaluate(this.scope, this.lookupFunctions);
	  };
	
	  ExpressionObserver.prototype.setValue = function setValue(newValue) {
	    this.expression.assign(this.scope, newValue);
	  };
	
	  ExpressionObserver.prototype.subscribe = function subscribe(context, callable) {
	    var _this = this;
	
	    if (!this.hasSubscribers()) {
	      this.oldValue = this.expression.evaluate(this.scope, this.lookupFunctions);
	      this.expression.connect(this, this.scope);
	    }
	    this.addSubscriber(context, callable);
	    if (arguments.length === 1 && context instanceof Function) {
	      return {
	        dispose: function dispose() {
	          _this.unsubscribe(context, callable);
	        }
	      };
	    }
	  };
	
	  ExpressionObserver.prototype.unsubscribe = function unsubscribe(context, callable) {
	    if (this.removeSubscriber(context, callable) && !this.hasSubscribers()) {
	      this.unobserve(true);
	      this.oldValue = undefined;
	    }
	  };
	
	  ExpressionObserver.prototype.call = function call() {
	    var newValue = this.expression.evaluate(this.scope, this.lookupFunctions);
	    var oldValue = this.oldValue;
	    if (newValue !== oldValue) {
	      this.oldValue = newValue;
	      this.callSubscribers(newValue, oldValue);
	    }
	    this._version++;
	    this.expression.connect(this, this.scope);
	    this.unobserve(false);
	  };
	
	  return ExpressionObserver;
	}()) || _class) || _class);
	
	
	function isIndex(s) {
	  return +s === s >>> 0;
	}
	
	function toNumber(s) {
	  return +s;
	}
	
	function newSplice(index, removed, addedCount) {
	  return {
	    index: index,
	    removed: removed,
	    addedCount: addedCount
	  };
	}
	
	var EDIT_LEAVE = 0;
	var EDIT_UPDATE = 1;
	var EDIT_ADD = 2;
	var EDIT_DELETE = 3;
	
	function ArraySplice() {}
	
	ArraySplice.prototype = {
	  calcEditDistances: function calcEditDistances(current, currentStart, currentEnd, old, oldStart, oldEnd) {
	    var rowCount = oldEnd - oldStart + 1;
	    var columnCount = currentEnd - currentStart + 1;
	    var distances = new Array(rowCount);
	    var north = void 0;
	    var west = void 0;
	
	    for (var _i = 0; _i < rowCount; ++_i) {
	      distances[_i] = new Array(columnCount);
	      distances[_i][0] = _i;
	    }
	
	    for (var j = 0; j < columnCount; ++j) {
	      distances[0][j] = j;
	    }
	
	    for (var _i2 = 1; _i2 < rowCount; ++_i2) {
	      for (var _j = 1; _j < columnCount; ++_j) {
	        if (this.equals(current[currentStart + _j - 1], old[oldStart + _i2 - 1])) {
	          distances[_i2][_j] = distances[_i2 - 1][_j - 1];
	        } else {
	          north = distances[_i2 - 1][_j] + 1;
	          west = distances[_i2][_j - 1] + 1;
	          distances[_i2][_j] = north < west ? north : west;
	        }
	      }
	    }
	
	    return distances;
	  },
	
	  spliceOperationsFromEditDistances: function spliceOperationsFromEditDistances(distances) {
	    var i = distances.length - 1;
	    var j = distances[0].length - 1;
	    var current = distances[i][j];
	    var edits = [];
	    while (i > 0 || j > 0) {
	      if (i === 0) {
	        edits.push(EDIT_ADD);
	        j--;
	        continue;
	      }
	      if (j === 0) {
	        edits.push(EDIT_DELETE);
	        i--;
	        continue;
	      }
	      var northWest = distances[i - 1][j - 1];
	      var west = distances[i - 1][j];
	      var north = distances[i][j - 1];
	
	      var min = void 0;
	      if (west < north) {
	        min = west < northWest ? west : northWest;
	      } else {
	        min = north < northWest ? north : northWest;
	      }
	
	      if (min === northWest) {
	        if (northWest === current) {
	          edits.push(EDIT_LEAVE);
	        } else {
	          edits.push(EDIT_UPDATE);
	          current = northWest;
	        }
	        i--;
	        j--;
	      } else if (min === west) {
	        edits.push(EDIT_DELETE);
	        i--;
	        current = west;
	      } else {
	        edits.push(EDIT_ADD);
	        j--;
	        current = north;
	      }
	    }
	
	    edits.reverse();
	    return edits;
	  },
	
	  calcSplices: function calcSplices(current, currentStart, currentEnd, old, oldStart, oldEnd) {
	    var prefixCount = 0;
	    var suffixCount = 0;
	
	    var minLength = Math.min(currentEnd - currentStart, oldEnd - oldStart);
	    if (currentStart === 0 && oldStart === 0) {
	      prefixCount = this.sharedPrefix(current, old, minLength);
	    }
	
	    if (currentEnd === current.length && oldEnd === old.length) {
	      suffixCount = this.sharedSuffix(current, old, minLength - prefixCount);
	    }
	
	    currentStart += prefixCount;
	    oldStart += prefixCount;
	    currentEnd -= suffixCount;
	    oldEnd -= suffixCount;
	
	    if (currentEnd - currentStart === 0 && oldEnd - oldStart === 0) {
	      return [];
	    }
	
	    if (currentStart === currentEnd) {
	      var _splice = newSplice(currentStart, [], 0);
	      while (oldStart < oldEnd) {
	        _splice.removed.push(old[oldStart++]);
	      }
	
	      return [_splice];
	    } else if (oldStart === oldEnd) {
	      return [newSplice(currentStart, [], currentEnd - currentStart)];
	    }
	
	    var ops = this.spliceOperationsFromEditDistances(this.calcEditDistances(current, currentStart, currentEnd, old, oldStart, oldEnd));
	
	    var splice = undefined;
	    var splices = [];
	    var index = currentStart;
	    var oldIndex = oldStart;
	    for (var _i3 = 0; _i3 < ops.length; ++_i3) {
	      switch (ops[_i3]) {
	        case EDIT_LEAVE:
	          if (splice) {
	            splices.push(splice);
	            splice = undefined;
	          }
	
	          index++;
	          oldIndex++;
	          break;
	        case EDIT_UPDATE:
	          if (!splice) {
	            splice = newSplice(index, [], 0);
	          }
	
	          splice.addedCount++;
	          index++;
	
	          splice.removed.push(old[oldIndex]);
	          oldIndex++;
	          break;
	        case EDIT_ADD:
	          if (!splice) {
	            splice = newSplice(index, [], 0);
	          }
	
	          splice.addedCount++;
	          index++;
	          break;
	        case EDIT_DELETE:
	          if (!splice) {
	            splice = newSplice(index, [], 0);
	          }
	
	          splice.removed.push(old[oldIndex]);
	          oldIndex++;
	          break;
	      }
	    }
	
	    if (splice) {
	      splices.push(splice);
	    }
	    return splices;
	  },
	
	  sharedPrefix: function sharedPrefix(current, old, searchLength) {
	    for (var _i4 = 0; _i4 < searchLength; ++_i4) {
	      if (!this.equals(current[_i4], old[_i4])) {
	        return _i4;
	      }
	    }
	
	    return searchLength;
	  },
	
	  sharedSuffix: function sharedSuffix(current, old, searchLength) {
	    var index1 = current.length;
	    var index2 = old.length;
	    var count = 0;
	    while (count < searchLength && this.equals(current[--index1], old[--index2])) {
	      count++;
	    }
	
	    return count;
	  },
	
	  calculateSplices: function calculateSplices(current, previous) {
	    return this.calcSplices(current, 0, current.length, previous, 0, previous.length);
	  },
	
	  equals: function equals(currentValue, previousValue) {
	    return currentValue === previousValue;
	  }
	};
	
	var arraySplice = new ArraySplice();
	
	function calcSplices(current, currentStart, currentEnd, old, oldStart, oldEnd) {
	  return arraySplice.calcSplices(current, currentStart, currentEnd, old, oldStart, oldEnd);
	}
	
	function intersect(start1, end1, start2, end2) {
	  if (end1 < start2 || end2 < start1) {
	    return -1;
	  }
	
	  if (end1 === start2 || end2 === start1) {
	    return 0;
	  }
	
	  if (start1 < start2) {
	    if (end1 < end2) {
	      return end1 - start2;
	    }
	
	    return end2 - start2;
	  }
	
	  if (end2 < end1) {
	    return end2 - start1;
	  }
	
	  return end1 - start1;
	}
	
	function mergeSplice(splices, index, removed, addedCount) {
	  var splice = newSplice(index, removed, addedCount);
	
	  var inserted = false;
	  var insertionOffset = 0;
	
	  for (var _i5 = 0; _i5 < splices.length; _i5++) {
	    var current = splices[_i5];
	    current.index += insertionOffset;
	
	    if (inserted) {
	      continue;
	    }
	
	    var intersectCount = intersect(splice.index, splice.index + splice.removed.length, current.index, current.index + current.addedCount);
	
	    if (intersectCount >= 0) {
	
	      splices.splice(_i5, 1);
	      _i5--;
	
	      insertionOffset -= current.addedCount - current.removed.length;
	
	      splice.addedCount += current.addedCount - intersectCount;
	      var deleteCount = splice.removed.length + current.removed.length - intersectCount;
	
	      if (!splice.addedCount && !deleteCount) {
	        inserted = true;
	      } else {
	        var currentRemoved = current.removed;
	
	        if (splice.index < current.index) {
	          var prepend = splice.removed.slice(0, current.index - splice.index);
	          Array.prototype.push.apply(prepend, currentRemoved);
	          currentRemoved = prepend;
	        }
	
	        if (splice.index + splice.removed.length > current.index + current.addedCount) {
	          var append = splice.removed.slice(current.index + current.addedCount - splice.index);
	          Array.prototype.push.apply(currentRemoved, append);
	        }
	
	        splice.removed = currentRemoved;
	        if (current.index < splice.index) {
	          splice.index = current.index;
	        }
	      }
	    } else if (splice.index < current.index) {
	
	      inserted = true;
	
	      splices.splice(_i5, 0, splice);
	      _i5++;
	
	      var offset = splice.addedCount - splice.removed.length;
	      current.index += offset;
	      insertionOffset += offset;
	    }
	  }
	
	  if (!inserted) {
	    splices.push(splice);
	  }
	}
	
	function createInitialSplices(array, changeRecords) {
	  var splices = [];
	
	  for (var _i6 = 0; _i6 < changeRecords.length; _i6++) {
	    var record = changeRecords[_i6];
	    switch (record.type) {
	      case 'splice':
	        mergeSplice(splices, record.index, record.removed.slice(), record.addedCount);
	        break;
	      case 'add':
	      case 'update':
	      case 'delete':
	        if (!isIndex(record.name)) {
	          continue;
	        }
	
	        var index = toNumber(record.name);
	        if (index < 0) {
	          continue;
	        }
	
	        mergeSplice(splices, index, [record.oldValue], record.type === 'delete' ? 0 : 1);
	        break;
	      default:
	        console.error('Unexpected record type: ' + JSON.stringify(record));
	        break;
	    }
	  }
	
	  return splices;
	}
	
	function projectArraySplices(array, changeRecords) {
	  var splices = [];
	
	  createInitialSplices(array, changeRecords).forEach(function (splice) {
	    if (splice.addedCount === 1 && splice.removed.length === 1) {
	      if (splice.removed[0] !== array[splice.index]) {
	        splices.push(splice);
	      }
	
	      return;
	    }
	
	    splices = splices.concat(calcSplices(array, splice.index, splice.index + splice.addedCount, splice.removed, 0, splice.removed.length));
	  });
	
	  return splices;
	}
	
	function newRecord(type, object, key, oldValue) {
	  return {
	    type: type,
	    object: object,
	    key: key,
	    oldValue: oldValue
	  };
	}
	
	function getChangeRecords(map) {
	  var entries = new Array(map.size);
	  var keys = map.keys();
	  var i = 0;
	  var item = void 0;
	
	  while (item = keys.next()) {
	    if (item.done) {
	      break;
	    }
	
	    entries[i] = newRecord('added', map, item.value);
	    i++;
	  }
	
	  return entries;
	}
	
	var ModifyCollectionObserver = exports.ModifyCollectionObserver = (_dec3 = subscriberCollection(), _dec3(_class2 = function () {
	  function ModifyCollectionObserver(taskQueue, collection) {
	    
	
	    this.taskQueue = taskQueue;
	    this.queued = false;
	    this.changeRecords = null;
	    this.oldCollection = null;
	    this.collection = collection;
	    this.lengthPropertyName = collection instanceof Map || collection instanceof Set ? 'size' : 'length';
	  }
	
	  ModifyCollectionObserver.prototype.subscribe = function subscribe(context, callable) {
	    this.addSubscriber(context, callable);
	  };
	
	  ModifyCollectionObserver.prototype.unsubscribe = function unsubscribe(context, callable) {
	    this.removeSubscriber(context, callable);
	  };
	
	  ModifyCollectionObserver.prototype.addChangeRecord = function addChangeRecord(changeRecord) {
	    if (!this.hasSubscribers() && !this.lengthObserver) {
	      return;
	    }
	
	    if (changeRecord.type === 'splice') {
	      var index = changeRecord.index;
	      var arrayLength = changeRecord.object.length;
	      if (index > arrayLength) {
	        index = arrayLength - changeRecord.addedCount;
	      } else if (index < 0) {
	        index = arrayLength + changeRecord.removed.length + index - changeRecord.addedCount;
	      }
	      if (index < 0) {
	        index = 0;
	      }
	      changeRecord.index = index;
	    }
	
	    if (this.changeRecords === null) {
	      this.changeRecords = [changeRecord];
	    } else {
	      this.changeRecords.push(changeRecord);
	    }
	
	    if (!this.queued) {
	      this.queued = true;
	      this.taskQueue.queueMicroTask(this);
	    }
	  };
	
	  ModifyCollectionObserver.prototype.flushChangeRecords = function flushChangeRecords() {
	    if (this.changeRecords && this.changeRecords.length || this.oldCollection) {
	      this.call();
	    }
	  };
	
	  ModifyCollectionObserver.prototype.reset = function reset(oldCollection) {
	    this.oldCollection = oldCollection;
	
	    if (this.hasSubscribers() && !this.queued) {
	      this.queued = true;
	      this.taskQueue.queueMicroTask(this);
	    }
	  };
	
	  ModifyCollectionObserver.prototype.getLengthObserver = function getLengthObserver() {
	    return this.lengthObserver || (this.lengthObserver = new CollectionLengthObserver(this.collection));
	  };
	
	  ModifyCollectionObserver.prototype.call = function call() {
	    var changeRecords = this.changeRecords;
	    var oldCollection = this.oldCollection;
	    var records = void 0;
	
	    this.queued = false;
	    this.changeRecords = [];
	    this.oldCollection = null;
	
	    if (this.hasSubscribers()) {
	      if (oldCollection) {
	        if (this.collection instanceof Map || this.collection instanceof Set) {
	          records = getChangeRecords(oldCollection);
	        } else {
	          records = calcSplices(this.collection, 0, this.collection.length, oldCollection, 0, oldCollection.length);
	        }
	      } else {
	        if (this.collection instanceof Map || this.collection instanceof Set) {
	          records = changeRecords;
	        } else {
	          records = projectArraySplices(this.collection, changeRecords);
	        }
	      }
	
	      this.callSubscribers(records);
	    }
	
	    if (this.lengthObserver) {
	      this.lengthObserver.call(this.collection[this.lengthPropertyName]);
	    }
	  };
	
	  return ModifyCollectionObserver;
	}()) || _class2);
	var CollectionLengthObserver = exports.CollectionLengthObserver = (_dec4 = subscriberCollection(), _dec4(_class3 = function () {
	  function CollectionLengthObserver(collection) {
	    
	
	    this.collection = collection;
	    this.lengthPropertyName = collection instanceof Map || collection instanceof Set ? 'size' : 'length';
	    this.currentValue = collection[this.lengthPropertyName];
	  }
	
	  CollectionLengthObserver.prototype.getValue = function getValue() {
	    return this.collection[this.lengthPropertyName];
	  };
	
	  CollectionLengthObserver.prototype.setValue = function setValue(newValue) {
	    this.collection[this.lengthPropertyName] = newValue;
	  };
	
	  CollectionLengthObserver.prototype.subscribe = function subscribe(context, callable) {
	    this.addSubscriber(context, callable);
	  };
	
	  CollectionLengthObserver.prototype.unsubscribe = function unsubscribe(context, callable) {
	    this.removeSubscriber(context, callable);
	  };
	
	  CollectionLengthObserver.prototype.call = function call(newValue) {
	    var oldValue = this.currentValue;
	    this.callSubscribers(newValue, oldValue);
	    this.currentValue = newValue;
	  };
	
	  return CollectionLengthObserver;
	}()) || _class3);
	
	var pop = Array.prototype.pop;
	var push = Array.prototype.push;
	var reverse = Array.prototype.reverse;
	var shift = Array.prototype.shift;
	var sort = Array.prototype.sort;
	var splice = Array.prototype.splice;
	var unshift = Array.prototype.unshift;
	
	Array.prototype.pop = function () {
	  var notEmpty = this.length > 0;
	  var methodCallResult = pop.apply(this, arguments);
	  if (notEmpty && this.__array_observer__ !== undefined) {
	    this.__array_observer__.addChangeRecord({
	      type: 'delete',
	      object: this,
	      name: this.length,
	      oldValue: methodCallResult
	    });
	  }
	  return methodCallResult;
	};
	
	Array.prototype.push = function () {
	  var methodCallResult = push.apply(this, arguments);
	  if (this.__array_observer__ !== undefined) {
	    this.__array_observer__.addChangeRecord({
	      type: 'splice',
	      object: this,
	      index: this.length - arguments.length,
	      removed: [],
	      addedCount: arguments.length
	    });
	  }
	  return methodCallResult;
	};
	
	Array.prototype.reverse = function () {
	  var oldArray = void 0;
	  if (this.__array_observer__ !== undefined) {
	    this.__array_observer__.flushChangeRecords();
	    oldArray = this.slice();
	  }
	  var methodCallResult = reverse.apply(this, arguments);
	  if (this.__array_observer__ !== undefined) {
	    this.__array_observer__.reset(oldArray);
	  }
	  return methodCallResult;
	};
	
	Array.prototype.shift = function () {
	  var notEmpty = this.length > 0;
	  var methodCallResult = shift.apply(this, arguments);
	  if (notEmpty && this.__array_observer__ !== undefined) {
	    this.__array_observer__.addChangeRecord({
	      type: 'delete',
	      object: this,
	      name: 0,
	      oldValue: methodCallResult
	    });
	  }
	  return methodCallResult;
	};
	
	Array.prototype.sort = function () {
	  var oldArray = void 0;
	  if (this.__array_observer__ !== undefined) {
	    this.__array_observer__.flushChangeRecords();
	    oldArray = this.slice();
	  }
	  var methodCallResult = sort.apply(this, arguments);
	  if (this.__array_observer__ !== undefined) {
	    this.__array_observer__.reset(oldArray);
	  }
	  return methodCallResult;
	};
	
	Array.prototype.splice = function () {
	  var methodCallResult = splice.apply(this, arguments);
	  if (this.__array_observer__ !== undefined) {
	    this.__array_observer__.addChangeRecord({
	      type: 'splice',
	      object: this,
	      index: arguments[0],
	      removed: methodCallResult,
	      addedCount: arguments.length > 2 ? arguments.length - 2 : 0
	    });
	  }
	  return methodCallResult;
	};
	
	Array.prototype.unshift = function () {
	  var methodCallResult = unshift.apply(this, arguments);
	  if (this.__array_observer__ !== undefined) {
	    this.__array_observer__.addChangeRecord({
	      type: 'splice',
	      object: this,
	      index: 0,
	      removed: [],
	      addedCount: arguments.length
	    });
	  }
	  return methodCallResult;
	};
	
	function _getArrayObserver(taskQueue, array) {
	  return ModifyArrayObserver.for(taskQueue, array);
	}
	
	exports.getArrayObserver = _getArrayObserver;
	
	var ModifyArrayObserver = function (_ModifyCollectionObse) {
	  _inherits(ModifyArrayObserver, _ModifyCollectionObse);
	
	  function ModifyArrayObserver(taskQueue, array) {
	    
	
	    return _possibleConstructorReturn(this, _ModifyCollectionObse.call(this, taskQueue, array));
	  }
	
	  ModifyArrayObserver.for = function _for(taskQueue, array) {
	    if (!('__array_observer__' in array)) {
	      var observer = ModifyArrayObserver.create(taskQueue, array);
	      Reflect.defineProperty(array, '__array_observer__', { value: observer, enumerable: false, configurable: false });
	    }
	    return array.__array_observer__;
	  };
	
	  ModifyArrayObserver.create = function create(taskQueue, array) {
	    var observer = new ModifyArrayObserver(taskQueue, array);
	    return observer;
	  };
	
	  return ModifyArrayObserver;
	}(ModifyCollectionObserver);
	
	var Expression = exports.Expression = function () {
	  function Expression() {
	    
	
	    this.isChain = false;
	    this.isAssignable = false;
	  }
	
	  Expression.prototype.evaluate = function evaluate(scope, lookupFunctions, args) {
	    throw new Error('Binding expression "' + this + '" cannot be evaluated.');
	  };
	
	  Expression.prototype.assign = function assign(scope, value, lookupFunctions) {
	    throw new Error('Binding expression "' + this + '" cannot be assigned to.');
	  };
	
	  Expression.prototype.toString = function toString() {
	    return Unparser.unparse(this);
	  };
	
	  return Expression;
	}();
	
	var Chain = exports.Chain = function (_Expression) {
	  _inherits(Chain, _Expression);
	
	  function Chain(expressions) {
	    
	
	    var _this3 = _possibleConstructorReturn(this, _Expression.call(this));
	
	    _this3.expressions = expressions;
	    _this3.isChain = true;
	    return _this3;
	  }
	
	  Chain.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    var result = void 0;
	    var expressions = this.expressions;
	    var last = void 0;
	
	    for (var _i7 = 0, length = expressions.length; _i7 < length; ++_i7) {
	      last = expressions[_i7].evaluate(scope, lookupFunctions);
	
	      if (last !== null) {
	        result = last;
	      }
	    }
	
	    return result;
	  };
	
	  Chain.prototype.accept = function accept(visitor) {
	    return visitor.visitChain(this);
	  };
	
	  return Chain;
	}(Expression);
	
	var BindingBehavior = exports.BindingBehavior = function (_Expression2) {
	  _inherits(BindingBehavior, _Expression2);
	
	  function BindingBehavior(expression, name, args) {
	    
	
	    var _this4 = _possibleConstructorReturn(this, _Expression2.call(this));
	
	    _this4.expression = expression;
	    _this4.name = name;
	    _this4.args = args;
	    return _this4;
	  }
	
	  BindingBehavior.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    return this.expression.evaluate(scope, lookupFunctions);
	  };
	
	  BindingBehavior.prototype.assign = function assign(scope, value, lookupFunctions) {
	    return this.expression.assign(scope, value, lookupFunctions);
	  };
	
	  BindingBehavior.prototype.accept = function accept(visitor) {
	    return visitor.visitBindingBehavior(this);
	  };
	
	  BindingBehavior.prototype.connect = function connect(binding, scope) {
	    this.expression.connect(binding, scope);
	  };
	
	  BindingBehavior.prototype.bind = function bind(binding, scope, lookupFunctions) {
	    if (this.expression.expression && this.expression.bind) {
	      this.expression.bind(binding, scope, lookupFunctions);
	    }
	    var behavior = lookupFunctions.bindingBehaviors(this.name);
	    if (!behavior) {
	      throw new Error('No BindingBehavior named "' + this.name + '" was found!');
	    }
	    var behaviorKey = 'behavior-' + this.name;
	    if (binding[behaviorKey]) {
	      throw new Error('A binding behavior named "' + this.name + '" has already been applied to "' + this.expression + '"');
	    }
	    binding[behaviorKey] = behavior;
	    behavior.bind.apply(behavior, [binding, scope].concat(evalList(scope, this.args, binding.lookupFunctions)));
	  };
	
	  BindingBehavior.prototype.unbind = function unbind(binding, scope) {
	    var behaviorKey = 'behavior-' + this.name;
	    binding[behaviorKey].unbind(binding, scope);
	    binding[behaviorKey] = null;
	    if (this.expression.expression && this.expression.unbind) {
	      this.expression.unbind(binding, scope);
	    }
	  };
	
	  return BindingBehavior;
	}(Expression);
	
	var ValueConverter = exports.ValueConverter = function (_Expression3) {
	  _inherits(ValueConverter, _Expression3);
	
	  function ValueConverter(expression, name, args, allArgs) {
	    
	
	    var _this5 = _possibleConstructorReturn(this, _Expression3.call(this));
	
	    _this5.expression = expression;
	    _this5.name = name;
	    _this5.args = args;
	    _this5.allArgs = allArgs;
	    return _this5;
	  }
	
	  ValueConverter.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    var converter = lookupFunctions.valueConverters(this.name);
	    if (!converter) {
	      throw new Error('No ValueConverter named "' + this.name + '" was found!');
	    }
	
	    if ('toView' in converter) {
	      return converter.toView.apply(converter, evalList(scope, this.allArgs, lookupFunctions));
	    }
	
	    return this.allArgs[0].evaluate(scope, lookupFunctions);
	  };
	
	  ValueConverter.prototype.assign = function assign(scope, value, lookupFunctions) {
	    var converter = lookupFunctions.valueConverters(this.name);
	    if (!converter) {
	      throw new Error('No ValueConverter named "' + this.name + '" was found!');
	    }
	
	    if ('fromView' in converter) {
	      value = converter.fromView.apply(converter, [value].concat(evalList(scope, this.args, lookupFunctions)));
	    }
	
	    return this.allArgs[0].assign(scope, value, lookupFunctions);
	  };
	
	  ValueConverter.prototype.accept = function accept(visitor) {
	    return visitor.visitValueConverter(this);
	  };
	
	  ValueConverter.prototype.connect = function connect(binding, scope) {
	    var expressions = this.allArgs;
	    var i = expressions.length;
	    while (i--) {
	      expressions[i].connect(binding, scope);
	    }
	  };
	
	  return ValueConverter;
	}(Expression);
	
	var Assign = exports.Assign = function (_Expression4) {
	  _inherits(Assign, _Expression4);
	
	  function Assign(target, value) {
	    
	
	    var _this6 = _possibleConstructorReturn(this, _Expression4.call(this));
	
	    _this6.target = target;
	    _this6.value = value;
	    return _this6;
	  }
	
	  Assign.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    return this.target.assign(scope, this.value.evaluate(scope, lookupFunctions));
	  };
	
	  Assign.prototype.accept = function accept(vistor) {
	    vistor.visitAssign(this);
	  };
	
	  Assign.prototype.connect = function connect(binding, scope) {};
	
	  return Assign;
	}(Expression);
	
	var Conditional = exports.Conditional = function (_Expression5) {
	  _inherits(Conditional, _Expression5);
	
	  function Conditional(condition, yes, no) {
	    
	
	    var _this7 = _possibleConstructorReturn(this, _Expression5.call(this));
	
	    _this7.condition = condition;
	    _this7.yes = yes;
	    _this7.no = no;
	    return _this7;
	  }
	
	  Conditional.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    return !!this.condition.evaluate(scope) ? this.yes.evaluate(scope) : this.no.evaluate(scope);
	  };
	
	  Conditional.prototype.accept = function accept(visitor) {
	    return visitor.visitConditional(this);
	  };
	
	  Conditional.prototype.connect = function connect(binding, scope) {
	    this.condition.connect(binding, scope);
	    if (this.condition.evaluate(scope)) {
	      this.yes.connect(binding, scope);
	    } else {
	      this.no.connect(binding, scope);
	    }
	  };
	
	  return Conditional;
	}(Expression);
	
	var AccessThis = exports.AccessThis = function (_Expression6) {
	  _inherits(AccessThis, _Expression6);
	
	  function AccessThis(ancestor) {
	    
	
	    var _this8 = _possibleConstructorReturn(this, _Expression6.call(this));
	
	    _this8.ancestor = ancestor;
	    return _this8;
	  }
	
	  AccessThis.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    var oc = scope.overrideContext;
	    var i = this.ancestor;
	    while (i-- && oc) {
	      oc = oc.parentOverrideContext;
	    }
	    return i < 1 && oc ? oc.bindingContext : undefined;
	  };
	
	  AccessThis.prototype.accept = function accept(visitor) {
	    return visitor.visitAccessThis(this);
	  };
	
	  AccessThis.prototype.connect = function connect(binding, scope) {};
	
	  return AccessThis;
	}(Expression);
	
	var AccessScope = exports.AccessScope = function (_Expression7) {
	  _inherits(AccessScope, _Expression7);
	
	  function AccessScope(name, ancestor) {
	    
	
	    var _this9 = _possibleConstructorReturn(this, _Expression7.call(this));
	
	    _this9.name = name;
	    _this9.ancestor = ancestor;
	    _this9.isAssignable = true;
	    return _this9;
	  }
	
	  AccessScope.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    var context = getContextFor(this.name, scope, this.ancestor);
	    return context[this.name];
	  };
	
	  AccessScope.prototype.assign = function assign(scope, value) {
	    var context = getContextFor(this.name, scope, this.ancestor);
	    return context ? context[this.name] = value : undefined;
	  };
	
	  AccessScope.prototype.accept = function accept(visitor) {
	    return visitor.visitAccessScope(this);
	  };
	
	  AccessScope.prototype.connect = function connect(binding, scope) {
	    var context = getContextFor(this.name, scope, this.ancestor);
	    binding.observeProperty(context, this.name);
	  };
	
	  return AccessScope;
	}(Expression);
	
	var AccessMember = exports.AccessMember = function (_Expression8) {
	  _inherits(AccessMember, _Expression8);
	
	  function AccessMember(object, name) {
	    
	
	    var _this10 = _possibleConstructorReturn(this, _Expression8.call(this));
	
	    _this10.object = object;
	    _this10.name = name;
	    _this10.isAssignable = true;
	    return _this10;
	  }
	
	  AccessMember.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    var instance = this.object.evaluate(scope, lookupFunctions);
	    return instance === null || instance === undefined ? instance : instance[this.name];
	  };
	
	  AccessMember.prototype.assign = function assign(scope, value) {
	    var instance = this.object.evaluate(scope);
	
	    if (instance === null || instance === undefined) {
	      instance = {};
	      this.object.assign(scope, instance);
	    }
	
	    return instance[this.name] = value;
	  };
	
	  AccessMember.prototype.accept = function accept(visitor) {
	    return visitor.visitAccessMember(this);
	  };
	
	  AccessMember.prototype.connect = function connect(binding, scope) {
	    this.object.connect(binding, scope);
	    var obj = this.object.evaluate(scope);
	    if (obj) {
	      binding.observeProperty(obj, this.name);
	    }
	  };
	
	  return AccessMember;
	}(Expression);
	
	var AccessKeyed = exports.AccessKeyed = function (_Expression9) {
	  _inherits(AccessKeyed, _Expression9);
	
	  function AccessKeyed(object, key) {
	    
	
	    var _this11 = _possibleConstructorReturn(this, _Expression9.call(this));
	
	    _this11.object = object;
	    _this11.key = key;
	    _this11.isAssignable = true;
	    return _this11;
	  }
	
	  AccessKeyed.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    var instance = this.object.evaluate(scope, lookupFunctions);
	    var lookup = this.key.evaluate(scope, lookupFunctions);
	    return getKeyed(instance, lookup);
	  };
	
	  AccessKeyed.prototype.assign = function assign(scope, value) {
	    var instance = this.object.evaluate(scope);
	    var lookup = this.key.evaluate(scope);
	    return setKeyed(instance, lookup, value);
	  };
	
	  AccessKeyed.prototype.accept = function accept(visitor) {
	    return visitor.visitAccessKeyed(this);
	  };
	
	  AccessKeyed.prototype.connect = function connect(binding, scope) {
	    this.object.connect(binding, scope);
	    var obj = this.object.evaluate(scope);
	    if (obj instanceof Object) {
	      this.key.connect(binding, scope);
	      var key = this.key.evaluate(scope);
	
	      if (key !== null && key !== undefined && !(Array.isArray(obj) && typeof key === 'number')) {
	        binding.observeProperty(obj, key);
	      }
	    }
	  };
	
	  return AccessKeyed;
	}(Expression);
	
	var CallScope = exports.CallScope = function (_Expression10) {
	  _inherits(CallScope, _Expression10);
	
	  function CallScope(name, args, ancestor) {
	    
	
	    var _this12 = _possibleConstructorReturn(this, _Expression10.call(this));
	
	    _this12.name = name;
	    _this12.args = args;
	    _this12.ancestor = ancestor;
	    return _this12;
	  }
	
	  CallScope.prototype.evaluate = function evaluate(scope, lookupFunctions, mustEvaluate) {
	    var args = evalList(scope, this.args, lookupFunctions);
	    var context = getContextFor(this.name, scope, this.ancestor);
	    var func = getFunction(context, this.name, mustEvaluate);
	    if (func) {
	      return func.apply(context, args);
	    }
	    return undefined;
	  };
	
	  CallScope.prototype.accept = function accept(visitor) {
	    return visitor.visitCallScope(this);
	  };
	
	  CallScope.prototype.connect = function connect(binding, scope) {
	    var args = this.args;
	    var i = args.length;
	    while (i--) {
	      args[i].connect(binding, scope);
	    }
	  };
	
	  return CallScope;
	}(Expression);
	
	var CallMember = exports.CallMember = function (_Expression11) {
	  _inherits(CallMember, _Expression11);
	
	  function CallMember(object, name, args) {
	    
	
	    var _this13 = _possibleConstructorReturn(this, _Expression11.call(this));
	
	    _this13.object = object;
	    _this13.name = name;
	    _this13.args = args;
	    return _this13;
	  }
	
	  CallMember.prototype.evaluate = function evaluate(scope, lookupFunctions, mustEvaluate) {
	    var instance = this.object.evaluate(scope, lookupFunctions);
	    var args = evalList(scope, this.args, lookupFunctions);
	    var func = getFunction(instance, this.name, mustEvaluate);
	    if (func) {
	      return func.apply(instance, args);
	    }
	    return undefined;
	  };
	
	  CallMember.prototype.accept = function accept(visitor) {
	    return visitor.visitCallMember(this);
	  };
	
	  CallMember.prototype.connect = function connect(binding, scope) {
	    this.object.connect(binding, scope);
	    var obj = this.object.evaluate(scope);
	    if (getFunction(obj, this.name, false)) {
	      var args = this.args;
	      var _i8 = args.length;
	      while (_i8--) {
	        args[_i8].connect(binding, scope);
	      }
	    }
	  };
	
	  return CallMember;
	}(Expression);
	
	var CallFunction = exports.CallFunction = function (_Expression12) {
	  _inherits(CallFunction, _Expression12);
	
	  function CallFunction(func, args) {
	    
	
	    var _this14 = _possibleConstructorReturn(this, _Expression12.call(this));
	
	    _this14.func = func;
	    _this14.args = args;
	    return _this14;
	  }
	
	  CallFunction.prototype.evaluate = function evaluate(scope, lookupFunctions, mustEvaluate) {
	    var func = this.func.evaluate(scope, lookupFunctions);
	    if (typeof func === 'function') {
	      return func.apply(null, evalList(scope, this.args, lookupFunctions));
	    }
	    if (!mustEvaluate && (func === null || func === undefined)) {
	      return undefined;
	    }
	    throw new Error(this.func + ' is not a function');
	  };
	
	  CallFunction.prototype.accept = function accept(visitor) {
	    return visitor.visitCallFunction(this);
	  };
	
	  CallFunction.prototype.connect = function connect(binding, scope) {
	    this.func.connect(binding, scope);
	    var func = this.func.evaluate(scope);
	    if (typeof func === 'function') {
	      var args = this.args;
	      var _i9 = args.length;
	      while (_i9--) {
	        args[_i9].connect(binding, scope);
	      }
	    }
	  };
	
	  return CallFunction;
	}(Expression);
	
	var Binary = exports.Binary = function (_Expression13) {
	  _inherits(Binary, _Expression13);
	
	  function Binary(operation, left, right) {
	    
	
	    var _this15 = _possibleConstructorReturn(this, _Expression13.call(this));
	
	    _this15.operation = operation;
	    _this15.left = left;
	    _this15.right = right;
	    return _this15;
	  }
	
	  Binary.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    var left = this.left.evaluate(scope);
	
	    switch (this.operation) {
	      case '&&':
	        return left && this.right.evaluate(scope);
	      case '||':
	        return left || this.right.evaluate(scope);
	    }
	
	    var right = this.right.evaluate(scope);
	
	    switch (this.operation) {
	      case '==':
	        return left == right;
	      case '===':
	        return left === right;
	      case '!=':
	        return left != right;
	      case '!==':
	        return left !== right;
	    }
	
	    if (left === null || right === null || left === undefined || right === undefined) {
	      switch (this.operation) {
	        case '+':
	          if (left !== null && left !== undefined) return left;
	          if (right !== null && right !== undefined) return right;
	          return 0;
	        case '-':
	          if (left !== null && left !== undefined) return left;
	          if (right !== null && right !== undefined) return 0 - right;
	          return 0;
	      }
	
	      return null;
	    }
	
	    switch (this.operation) {
	      case '+':
	        return autoConvertAdd(left, right);
	      case '-':
	        return left - right;
	      case '*':
	        return left * right;
	      case '/':
	        return left / right;
	      case '%':
	        return left % right;
	      case '<':
	        return left < right;
	      case '>':
	        return left > right;
	      case '<=':
	        return left <= right;
	      case '>=':
	        return left >= right;
	      case '^':
	        return left ^ right;
	    }
	
	    throw new Error('Internal error [' + this.operation + '] not handled');
	  };
	
	  Binary.prototype.accept = function accept(visitor) {
	    return visitor.visitBinary(this);
	  };
	
	  Binary.prototype.connect = function connect(binding, scope) {
	    this.left.connect(binding, scope);
	    var left = this.left.evaluate(scope);
	    if (this.operation === '&&' && !left || this.operation === '||' && left) {
	      return;
	    }
	    this.right.connect(binding, scope);
	  };
	
	  return Binary;
	}(Expression);
	
	var PrefixNot = exports.PrefixNot = function (_Expression14) {
	  _inherits(PrefixNot, _Expression14);
	
	  function PrefixNot(operation, expression) {
	    
	
	    var _this16 = _possibleConstructorReturn(this, _Expression14.call(this));
	
	    _this16.operation = operation;
	    _this16.expression = expression;
	    return _this16;
	  }
	
	  PrefixNot.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    return !this.expression.evaluate(scope);
	  };
	
	  PrefixNot.prototype.accept = function accept(visitor) {
	    return visitor.visitPrefix(this);
	  };
	
	  PrefixNot.prototype.connect = function connect(binding, scope) {
	    this.expression.connect(binding, scope);
	  };
	
	  return PrefixNot;
	}(Expression);
	
	var LiteralPrimitive = exports.LiteralPrimitive = function (_Expression15) {
	  _inherits(LiteralPrimitive, _Expression15);
	
	  function LiteralPrimitive(value) {
	    
	
	    var _this17 = _possibleConstructorReturn(this, _Expression15.call(this));
	
	    _this17.value = value;
	    return _this17;
	  }
	
	  LiteralPrimitive.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    return this.value;
	  };
	
	  LiteralPrimitive.prototype.accept = function accept(visitor) {
	    return visitor.visitLiteralPrimitive(this);
	  };
	
	  LiteralPrimitive.prototype.connect = function connect(binding, scope) {};
	
	  return LiteralPrimitive;
	}(Expression);
	
	var LiteralString = exports.LiteralString = function (_Expression16) {
	  _inherits(LiteralString, _Expression16);
	
	  function LiteralString(value) {
	    
	
	    var _this18 = _possibleConstructorReturn(this, _Expression16.call(this));
	
	    _this18.value = value;
	    return _this18;
	  }
	
	  LiteralString.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    return this.value;
	  };
	
	  LiteralString.prototype.accept = function accept(visitor) {
	    return visitor.visitLiteralString(this);
	  };
	
	  LiteralString.prototype.connect = function connect(binding, scope) {};
	
	  return LiteralString;
	}(Expression);
	
	var LiteralArray = exports.LiteralArray = function (_Expression17) {
	  _inherits(LiteralArray, _Expression17);
	
	  function LiteralArray(elements) {
	    
	
	    var _this19 = _possibleConstructorReturn(this, _Expression17.call(this));
	
	    _this19.elements = elements;
	    return _this19;
	  }
	
	  LiteralArray.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    var elements = this.elements;
	    var result = [];
	
	    for (var _i10 = 0, length = elements.length; _i10 < length; ++_i10) {
	      result[_i10] = elements[_i10].evaluate(scope, lookupFunctions);
	    }
	
	    return result;
	  };
	
	  LiteralArray.prototype.accept = function accept(visitor) {
	    return visitor.visitLiteralArray(this);
	  };
	
	  LiteralArray.prototype.connect = function connect(binding, scope) {
	    var length = this.elements.length;
	    for (var _i11 = 0; _i11 < length; _i11++) {
	      this.elements[_i11].connect(binding, scope);
	    }
	  };
	
	  return LiteralArray;
	}(Expression);
	
	var LiteralObject = exports.LiteralObject = function (_Expression18) {
	  _inherits(LiteralObject, _Expression18);
	
	  function LiteralObject(keys, values) {
	    
	
	    var _this20 = _possibleConstructorReturn(this, _Expression18.call(this));
	
	    _this20.keys = keys;
	    _this20.values = values;
	    return _this20;
	  }
	
	  LiteralObject.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    var instance = {};
	    var keys = this.keys;
	    var values = this.values;
	
	    for (var _i12 = 0, length = keys.length; _i12 < length; ++_i12) {
	      instance[keys[_i12]] = values[_i12].evaluate(scope, lookupFunctions);
	    }
	
	    return instance;
	  };
	
	  LiteralObject.prototype.accept = function accept(visitor) {
	    return visitor.visitLiteralObject(this);
	  };
	
	  LiteralObject.prototype.connect = function connect(binding, scope) {
	    var length = this.keys.length;
	    for (var _i13 = 0; _i13 < length; _i13++) {
	      this.values[_i13].connect(binding, scope);
	    }
	  };
	
	  return LiteralObject;
	}(Expression);
	
	var evalListCache = [[], [0], [0, 0], [0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0, 0]];
	
	function evalList(scope, list, lookupFunctions) {
	  var length = list.length;
	
	  for (var cacheLength = evalListCache.length; cacheLength <= length; ++cacheLength) {
	    evalListCache.push([]);
	  }
	
	  var result = evalListCache[length];
	
	  for (var _i14 = 0; _i14 < length; ++_i14) {
	    result[_i14] = list[_i14].evaluate(scope, lookupFunctions);
	  }
	
	  return result;
	}
	
	function autoConvertAdd(a, b) {
	  if (a !== null && b !== null) {
	    if (typeof a === 'string' && typeof b !== 'string') {
	      return a + b.toString();
	    }
	
	    if (typeof a !== 'string' && typeof b === 'string') {
	      return a.toString() + b;
	    }
	
	    return a + b;
	  }
	
	  if (a !== null) {
	    return a;
	  }
	
	  if (b !== null) {
	    return b;
	  }
	
	  return 0;
	}
	
	function getFunction(obj, name, mustExist) {
	  var func = obj === null || obj === undefined ? null : obj[name];
	  if (typeof func === 'function') {
	    return func;
	  }
	  if (!mustExist && (func === null || func === undefined)) {
	    return null;
	  }
	  throw new Error(name + ' is not a function');
	}
	
	function getKeyed(obj, key) {
	  if (Array.isArray(obj)) {
	    return obj[parseInt(key, 10)];
	  } else if (obj) {
	    return obj[key];
	  } else if (obj === null || obj === undefined) {
	    return undefined;
	  }
	
	  return obj[key];
	}
	
	function setKeyed(obj, key, value) {
	  if (Array.isArray(obj)) {
	    var index = parseInt(key, 10);
	
	    if (obj.length <= index) {
	      obj.length = index + 1;
	    }
	
	    obj[index] = value;
	  } else {
	    obj[key] = value;
	  }
	
	  return value;
	}
	
	var Unparser = exports.Unparser = function () {
	  function Unparser(buffer) {
	    
	
	    this.buffer = buffer;
	  }
	
	  Unparser.unparse = function unparse(expression) {
	    var buffer = [];
	    var visitor = new Unparser(buffer);
	
	    expression.accept(visitor);
	
	    return buffer.join('');
	  };
	
	  Unparser.prototype.write = function write(text) {
	    this.buffer.push(text);
	  };
	
	  Unparser.prototype.writeArgs = function writeArgs(args) {
	    this.write('(');
	
	    for (var _i15 = 0, length = args.length; _i15 < length; ++_i15) {
	      if (_i15 !== 0) {
	        this.write(',');
	      }
	
	      args[_i15].accept(this);
	    }
	
	    this.write(')');
	  };
	
	  Unparser.prototype.visitChain = function visitChain(chain) {
	    var expressions = chain.expressions;
	
	    for (var _i16 = 0, length = expression.length; _i16 < length; ++_i16) {
	      if (_i16 !== 0) {
	        this.write(';');
	      }
	
	      expressions[_i16].accept(this);
	    }
	  };
	
	  Unparser.prototype.visitBindingBehavior = function visitBindingBehavior(behavior) {
	    var args = behavior.args;
	
	    behavior.expression.accept(this);
	    this.write('&' + behavior.name);
	
	    for (var _i17 = 0, length = args.length; _i17 < length; ++_i17) {
	      this.write(':');
	      args[_i17].accept(this);
	    }
	  };
	
	  Unparser.prototype.visitValueConverter = function visitValueConverter(converter) {
	    var args = converter.args;
	
	    converter.expression.accept(this);
	    this.write('|' + converter.name);
	
	    for (var _i18 = 0, length = args.length; _i18 < length; ++_i18) {
	      this.write(':');
	      args[_i18].accept(this);
	    }
	  };
	
	  Unparser.prototype.visitAssign = function visitAssign(assign) {
	    assign.target.accept(this);
	    this.write('=');
	    assign.value.accept(this);
	  };
	
	  Unparser.prototype.visitConditional = function visitConditional(conditional) {
	    conditional.condition.accept(this);
	    this.write('?');
	    conditional.yes.accept(this);
	    this.write(':');
	    conditional.no.accept(this);
	  };
	
	  Unparser.prototype.visitAccessThis = function visitAccessThis(access) {
	    if (access.ancestor === 0) {
	      this.write('$this');
	      return;
	    }
	    this.write('$parent');
	    var i = access.ancestor - 1;
	    while (i--) {
	      this.write('.$parent');
	    }
	  };
	
	  Unparser.prototype.visitAccessScope = function visitAccessScope(access) {
	    var i = access.ancestor;
	    while (i--) {
	      this.write('$parent.');
	    }
	    this.write(access.name);
	  };
	
	  Unparser.prototype.visitAccessMember = function visitAccessMember(access) {
	    access.object.accept(this);
	    this.write('.' + access.name);
	  };
	
	  Unparser.prototype.visitAccessKeyed = function visitAccessKeyed(access) {
	    access.object.accept(this);
	    this.write('[');
	    access.key.accept(this);
	    this.write(']');
	  };
	
	  Unparser.prototype.visitCallScope = function visitCallScope(call) {
	    var i = call.ancestor;
	    while (i--) {
	      this.write('$parent.');
	    }
	    this.write(call.name);
	    this.writeArgs(call.args);
	  };
	
	  Unparser.prototype.visitCallFunction = function visitCallFunction(call) {
	    call.func.accept(this);
	    this.writeArgs(call.args);
	  };
	
	  Unparser.prototype.visitCallMember = function visitCallMember(call) {
	    call.object.accept(this);
	    this.write('.' + call.name);
	    this.writeArgs(call.args);
	  };
	
	  Unparser.prototype.visitPrefix = function visitPrefix(prefix) {
	    this.write('(' + prefix.operation);
	    prefix.expression.accept(this);
	    this.write(')');
	  };
	
	  Unparser.prototype.visitBinary = function visitBinary(binary) {
	    binary.left.accept(this);
	    this.write(binary.operation);
	    binary.right.accept(this);
	  };
	
	  Unparser.prototype.visitLiteralPrimitive = function visitLiteralPrimitive(literal) {
	    this.write('' + literal.value);
	  };
	
	  Unparser.prototype.visitLiteralArray = function visitLiteralArray(literal) {
	    var elements = literal.elements;
	
	    this.write('[');
	
	    for (var _i19 = 0, length = elements.length; _i19 < length; ++_i19) {
	      if (_i19 !== 0) {
	        this.write(',');
	      }
	
	      elements[_i19].accept(this);
	    }
	
	    this.write(']');
	  };
	
	  Unparser.prototype.visitLiteralObject = function visitLiteralObject(literal) {
	    var keys = literal.keys;
	    var values = literal.values;
	
	    this.write('{');
	
	    for (var _i20 = 0, length = keys.length; _i20 < length; ++_i20) {
	      if (_i20 !== 0) {
	        this.write(',');
	      }
	
	      this.write('\'' + keys[_i20] + '\':');
	      values[_i20].accept(this);
	    }
	
	    this.write('}');
	  };
	
	  Unparser.prototype.visitLiteralString = function visitLiteralString(literal) {
	    var escaped = literal.value.replace(/'/g, "\'");
	    this.write('\'' + escaped + '\'');
	  };
	
	  return Unparser;
	}();
	
	var ExpressionCloner = exports.ExpressionCloner = function () {
	  function ExpressionCloner() {
	    
	  }
	
	  ExpressionCloner.prototype.cloneExpressionArray = function cloneExpressionArray(array) {
	    var clonedArray = [];
	    var i = array.length;
	    while (i--) {
	      clonedArray[i] = array[i].accept(this);
	    }
	    return clonedArray;
	  };
	
	  ExpressionCloner.prototype.visitChain = function visitChain(chain) {
	    return new Chain(this.cloneExpressionArray(chain.expressions));
	  };
	
	  ExpressionCloner.prototype.visitBindingBehavior = function visitBindingBehavior(behavior) {
	    return new BindingBehavior(behavior.expression.accept(this), behavior.name, this.cloneExpressionArray(behavior.args));
	  };
	
	  ExpressionCloner.prototype.visitValueConverter = function visitValueConverter(converter) {
	    return new ValueConverter(converter.expression.accept(this), converter.name, this.cloneExpressionArray(converter.args));
	  };
	
	  ExpressionCloner.prototype.visitAssign = function visitAssign(assign) {
	    return new Assign(assign.target.accept(this), assign.value.accept(this));
	  };
	
	  ExpressionCloner.prototype.visitConditional = function visitConditional(conditional) {
	    return new Conditional(conditional.condition.accept(this), conditional.yes.accept(this), conditional.no.accept(this));
	  };
	
	  ExpressionCloner.prototype.visitAccessThis = function visitAccessThis(access) {
	    return new AccessThis(access.ancestor);
	  };
	
	  ExpressionCloner.prototype.visitAccessScope = function visitAccessScope(access) {
	    return new AccessScope(access.name, access.ancestor);
	  };
	
	  ExpressionCloner.prototype.visitAccessMember = function visitAccessMember(access) {
	    return new AccessMember(access.object.accept(this), access.name);
	  };
	
	  ExpressionCloner.prototype.visitAccessKeyed = function visitAccessKeyed(access) {
	    return new AccessKeyed(access.object.accept(this), access.key.accept(this));
	  };
	
	  ExpressionCloner.prototype.visitCallScope = function visitCallScope(call) {
	    return new CallScope(call.name, this.cloneExpressionArray(call.args), call.ancestor);
	  };
	
	  ExpressionCloner.prototype.visitCallFunction = function visitCallFunction(call) {
	    return new CallFunction(call.func.accept(this), this.cloneExpressionArray(call.args));
	  };
	
	  ExpressionCloner.prototype.visitCallMember = function visitCallMember(call) {
	    return new CallMember(call.object.accept(this), call.name, this.cloneExpressionArray(call.args));
	  };
	
	  ExpressionCloner.prototype.visitPrefix = function visitPrefix(prefix) {
	    return new PrefixNot(prefix.operation, prefix.expression.accept(this));
	  };
	
	  ExpressionCloner.prototype.visitBinary = function visitBinary(binary) {
	    return new Binary(binary.operation, binary.left.accept(this), binary.right.accept(this));
	  };
	
	  ExpressionCloner.prototype.visitLiteralPrimitive = function visitLiteralPrimitive(literal) {
	    return new LiteralPrimitive(literal);
	  };
	
	  ExpressionCloner.prototype.visitLiteralArray = function visitLiteralArray(literal) {
	    return new LiteralArray(this.cloneExpressionArray(literal.elements));
	  };
	
	  ExpressionCloner.prototype.visitLiteralObject = function visitLiteralObject(literal) {
	    return new LiteralObject(literal.keys, this.cloneExpressionArray(literal.values));
	  };
	
	  ExpressionCloner.prototype.visitLiteralString = function visitLiteralString(literal) {
	    return new LiteralString(literal.value);
	  };
	
	  return ExpressionCloner;
	}();
	
	function cloneExpression(expression) {
	  var visitor = new ExpressionCloner();
	  return expression.accept(visitor);
	}
	
	var bindingMode = exports.bindingMode = {
	  oneTime: 0,
	  oneWay: 1,
	  twoWay: 2
	};
	
	var Token = exports.Token = function () {
	  function Token(index, text) {
	    
	
	    this.index = index;
	    this.text = text;
	  }
	
	  Token.prototype.withOp = function withOp(op) {
	    this.opKey = op;
	    return this;
	  };
	
	  Token.prototype.withGetterSetter = function withGetterSetter(key) {
	    this.key = key;
	    return this;
	  };
	
	  Token.prototype.withValue = function withValue(value) {
	    this.value = value;
	    return this;
	  };
	
	  Token.prototype.toString = function toString() {
	    return 'Token(' + this.text + ')';
	  };
	
	  return Token;
	}();
	
	var Lexer = exports.Lexer = function () {
	  function Lexer() {
	    
	  }
	
	  Lexer.prototype.lex = function lex(text) {
	    var scanner = new Scanner(text);
	    var tokens = [];
	    var token = scanner.scanToken();
	
	    while (token) {
	      tokens.push(token);
	      token = scanner.scanToken();
	    }
	
	    return tokens;
	  };
	
	  return Lexer;
	}();
	
	var Scanner = exports.Scanner = function () {
	  function Scanner(input) {
	    
	
	    this.input = input;
	    this.length = input.length;
	    this.peek = 0;
	    this.index = -1;
	
	    this.advance();
	  }
	
	  Scanner.prototype.scanToken = function scanToken() {
	    while (this.peek <= $SPACE) {
	      if (++this.index >= this.length) {
	        this.peek = $EOF;
	        return null;
	      }
	
	      this.peek = this.input.charCodeAt(this.index);
	    }
	
	    if (isIdentifierStart(this.peek)) {
	      return this.scanIdentifier();
	    }
	
	    if (isDigit(this.peek)) {
	      return this.scanNumber(this.index);
	    }
	
	    var start = this.index;
	
	    switch (this.peek) {
	      case $PERIOD:
	        this.advance();
	        return isDigit(this.peek) ? this.scanNumber(start) : new Token(start, '.');
	      case $LPAREN:
	      case $RPAREN:
	      case $LBRACE:
	      case $RBRACE:
	      case $LBRACKET:
	      case $RBRACKET:
	      case $COMMA:
	      case $COLON:
	      case $SEMICOLON:
	        return this.scanCharacter(start, String.fromCharCode(this.peek));
	      case $SQ:
	      case $DQ:
	        return this.scanString();
	      case $PLUS:
	      case $MINUS:
	      case $STAR:
	      case $SLASH:
	      case $PERCENT:
	      case $CARET:
	      case $QUESTION:
	        return this.scanOperator(start, String.fromCharCode(this.peek));
	      case $LT:
	      case $GT:
	      case $BANG:
	      case $EQ:
	        return this.scanComplexOperator(start, $EQ, String.fromCharCode(this.peek), '=');
	      case $AMPERSAND:
	        return this.scanComplexOperator(start, $AMPERSAND, '&', '&');
	      case $BAR:
	        return this.scanComplexOperator(start, $BAR, '|', '|');
	      case $NBSP:
	        while (isWhitespace(this.peek)) {
	          this.advance();
	        }
	
	        return this.scanToken();
	    }
	
	    var character = String.fromCharCode(this.peek);
	    this.error('Unexpected character [' + character + ']');
	    return null;
	  };
	
	  Scanner.prototype.scanCharacter = function scanCharacter(start, text) {
	    assert(this.peek === text.charCodeAt(0));
	    this.advance();
	    return new Token(start, text);
	  };
	
	  Scanner.prototype.scanOperator = function scanOperator(start, text) {
	    assert(this.peek === text.charCodeAt(0));
	    assert(OPERATORS.indexOf(text) !== -1);
	    this.advance();
	    return new Token(start, text).withOp(text);
	  };
	
	  Scanner.prototype.scanComplexOperator = function scanComplexOperator(start, code, one, two) {
	    assert(this.peek === one.charCodeAt(0));
	    this.advance();
	
	    var text = one;
	
	    if (this.peek === code) {
	      this.advance();
	      text += two;
	    }
	
	    if (this.peek === code) {
	      this.advance();
	      text += two;
	    }
	
	    assert(OPERATORS.indexOf(text) !== -1);
	
	    return new Token(start, text).withOp(text);
	  };
	
	  Scanner.prototype.scanIdentifier = function scanIdentifier() {
	    assert(isIdentifierStart(this.peek));
	    var start = this.index;
	
	    this.advance();
	
	    while (isIdentifierPart(this.peek)) {
	      this.advance();
	    }
	
	    var text = this.input.substring(start, this.index);
	    var result = new Token(start, text);
	
	    if (OPERATORS.indexOf(text) !== -1) {
	      result.withOp(text);
	    } else {
	      result.withGetterSetter(text);
	    }
	
	    return result;
	  };
	
	  Scanner.prototype.scanNumber = function scanNumber(start) {
	    assert(isDigit(this.peek));
	    var simple = this.index === start;
	    this.advance();
	
	    while (true) {
	      if (isDigit(this.peek)) {} else if (this.peek === $PERIOD) {
	          simple = false;
	        } else if (isExponentStart(this.peek)) {
	          this.advance();
	
	          if (isExponentSign(this.peek)) {
	            this.advance();
	          }
	
	          if (!isDigit(this.peek)) {
	            this.error('Invalid exponent', -1);
	          }
	
	          simple = false;
	        } else {
	          break;
	        }
	
	      this.advance();
	    }
	
	    var text = this.input.substring(start, this.index);
	    var value = simple ? parseInt(text, 10) : parseFloat(text);
	    return new Token(start, text).withValue(value);
	  };
	
	  Scanner.prototype.scanString = function scanString() {
	    assert(this.peek === $SQ || this.peek === $DQ);
	
	    var start = this.index;
	    var quote = this.peek;
	
	    this.advance();
	
	    var buffer = void 0;
	    var marker = this.index;
	
	    while (this.peek !== quote) {
	      if (this.peek === $BACKSLASH) {
	        if (!buffer) {
	          buffer = [];
	        }
	
	        buffer.push(this.input.substring(marker, this.index));
	        this.advance();
	
	        var _unescaped = void 0;
	
	        if (this.peek === $u) {
	          var hex = this.input.substring(this.index + 1, this.index + 5);
	
	          if (!/[A-Z0-9]{4}/.test(hex)) {
	            this.error('Invalid unicode escape [\\u' + hex + ']');
	          }
	
	          _unescaped = parseInt(hex, 16);
	
	          for (var _i21 = 0; _i21 < 5; ++_i21) {
	            this.advance();
	          }
	        } else {
	          _unescaped = unescape(this.peek);
	          this.advance();
	        }
	
	        buffer.push(String.fromCharCode(_unescaped));
	        marker = this.index;
	      } else if (this.peek === $EOF) {
	        this.error('Unterminated quote');
	      } else {
	        this.advance();
	      }
	    }
	
	    var last = this.input.substring(marker, this.index);
	    this.advance();
	    var text = this.input.substring(start, this.index);
	
	    var unescaped = last;
	
	    if (buffer !== null && buffer !== undefined) {
	      buffer.push(last);
	      unescaped = buffer.join('');
	    }
	
	    return new Token(start, text).withValue(unescaped);
	  };
	
	  Scanner.prototype.advance = function advance() {
	    if (++this.index >= this.length) {
	      this.peek = $EOF;
	    } else {
	      this.peek = this.input.charCodeAt(this.index);
	    }
	  };
	
	  Scanner.prototype.error = function error(message) {
	    var offset = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];
	
	    var position = this.index + offset;
	    throw new Error('Lexer Error: ' + message + ' at column ' + position + ' in expression [' + this.input + ']');
	  };
	
	  return Scanner;
	}();
	
	var OPERATORS = ['undefined', 'null', 'true', 'false', '+', '-', '*', '/', '%', '^', '=', '==', '===', '!=', '!==', '<', '>', '<=', '>=', '&&', '||', '&', '|', '!', '?'];
	
	var $EOF = 0;
	var $TAB = 9;
	var $LF = 10;
	var $VTAB = 11;
	var $FF = 12;
	var $CR = 13;
	var $SPACE = 32;
	var $BANG = 33;
	var $DQ = 34;
	var $$ = 36;
	var $PERCENT = 37;
	var $AMPERSAND = 38;
	var $SQ = 39;
	var $LPAREN = 40;
	var $RPAREN = 41;
	var $STAR = 42;
	var $PLUS = 43;
	var $COMMA = 44;
	var $MINUS = 45;
	var $PERIOD = 46;
	var $SLASH = 47;
	var $COLON = 58;
	var $SEMICOLON = 59;
	var $LT = 60;
	var $EQ = 61;
	var $GT = 62;
	var $QUESTION = 63;
	
	var $0 = 48;
	var $9 = 57;
	
	var $A = 65;
	var $E = 69;
	var $Z = 90;
	
	var $LBRACKET = 91;
	var $BACKSLASH = 92;
	var $RBRACKET = 93;
	var $CARET = 94;
	var $_ = 95;
	
	var $a = 97;
	var $e = 101;
	var $f = 102;
	var $n = 110;
	var $r = 114;
	var $t = 116;
	var $u = 117;
	var $v = 118;
	var $z = 122;
	
	var $LBRACE = 123;
	var $BAR = 124;
	var $RBRACE = 125;
	var $NBSP = 160;
	
	function isWhitespace(code) {
	  return code >= $TAB && code <= $SPACE || code === $NBSP;
	}
	
	function isIdentifierStart(code) {
	  return $a <= code && code <= $z || $A <= code && code <= $Z || code === $_ || code === $$;
	}
	
	function isIdentifierPart(code) {
	  return $a <= code && code <= $z || $A <= code && code <= $Z || $0 <= code && code <= $9 || code === $_ || code === $$;
	}
	
	function isDigit(code) {
	  return $0 <= code && code <= $9;
	}
	
	function isExponentStart(code) {
	  return code === $e || code === $E;
	}
	
	function isExponentSign(code) {
	  return code === $MINUS || code === $PLUS;
	}
	
	function unescape(code) {
	  switch (code) {
	    case $n:
	      return $LF;
	    case $f:
	      return $FF;
	    case $r:
	      return $CR;
	    case $t:
	      return $TAB;
	    case $v:
	      return $VTAB;
	    default:
	      return code;
	  }
	}
	
	function assert(condition, message) {
	  if (!condition) {
	    throw message || 'Assertion failed';
	  }
	}
	
	var EOF = new Token(-1, null);
	
	var Parser = exports.Parser = function () {
	  function Parser() {
	    
	
	    this.cache = {};
	    this.lexer = new Lexer();
	  }
	
	  Parser.prototype.parse = function parse(input) {
	    input = input || '';
	
	    return this.cache[input] || (this.cache[input] = new ParserImplementation(this.lexer, input).parseChain());
	  };
	
	  return Parser;
	}();
	
	var ParserImplementation = exports.ParserImplementation = function () {
	  function ParserImplementation(lexer, input) {
	    
	
	    this.index = 0;
	    this.input = input;
	    this.tokens = lexer.lex(input);
	  }
	
	  ParserImplementation.prototype.parseChain = function parseChain() {
	    var isChain = false;
	    var expressions = [];
	
	    while (this.optional(';')) {
	      isChain = true;
	    }
	
	    while (this.index < this.tokens.length) {
	      if (this.peek.text === ')' || this.peek.text === '}' || this.peek.text === ']') {
	        this.error('Unconsumed token ' + this.peek.text);
	      }
	
	      var expr = this.parseBindingBehavior();
	      expressions.push(expr);
	
	      while (this.optional(';')) {
	        isChain = true;
	      }
	
	      if (isChain) {
	        this.error('Multiple expressions are not allowed.');
	      }
	    }
	
	    return expressions.length === 1 ? expressions[0] : new Chain(expressions);
	  };
	
	  ParserImplementation.prototype.parseBindingBehavior = function parseBindingBehavior() {
	    var result = this.parseValueConverter();
	
	    while (this.optional('&')) {
	      var name = this.peek.text;
	      var args = [];
	
	      this.advance();
	
	      while (this.optional(':')) {
	        args.push(this.parseExpression());
	      }
	
	      result = new BindingBehavior(result, name, args);
	    }
	
	    return result;
	  };
	
	  ParserImplementation.prototype.parseValueConverter = function parseValueConverter() {
	    var result = this.parseExpression();
	
	    while (this.optional('|')) {
	      var name = this.peek.text;
	      var args = [];
	
	      this.advance();
	
	      while (this.optional(':')) {
	        args.push(this.parseExpression());
	      }
	
	      result = new ValueConverter(result, name, args, [result].concat(args));
	    }
	
	    return result;
	  };
	
	  ParserImplementation.prototype.parseExpression = function parseExpression() {
	    var start = this.peek.index;
	    var result = this.parseConditional();
	
	    while (this.peek.text === '=') {
	      if (!result.isAssignable) {
	        var end = this.index < this.tokens.length ? this.peek.index : this.input.length;
	        var _expression = this.input.substring(start, end);
	
	        this.error('Expression ' + _expression + ' is not assignable');
	      }
	
	      this.expect('=');
	      result = new Assign(result, this.parseConditional());
	    }
	
	    return result;
	  };
	
	  ParserImplementation.prototype.parseConditional = function parseConditional() {
	    var start = this.peek.index;
	    var result = this.parseLogicalOr();
	
	    if (this.optional('?')) {
	      var yes = this.parseExpression();
	
	      if (!this.optional(':')) {
	        var end = this.index < this.tokens.length ? this.peek.index : this.input.length;
	        var _expression2 = this.input.substring(start, end);
	
	        this.error('Conditional expression ' + _expression2 + ' requires all 3 expressions');
	      }
	
	      var no = this.parseExpression();
	      result = new Conditional(result, yes, no);
	    }
	
	    return result;
	  };
	
	  ParserImplementation.prototype.parseLogicalOr = function parseLogicalOr() {
	    var result = this.parseLogicalAnd();
	
	    while (this.optional('||')) {
	      result = new Binary('||', result, this.parseLogicalAnd());
	    }
	
	    return result;
	  };
	
	  ParserImplementation.prototype.parseLogicalAnd = function parseLogicalAnd() {
	    var result = this.parseEquality();
	
	    while (this.optional('&&')) {
	      result = new Binary('&&', result, this.parseEquality());
	    }
	
	    return result;
	  };
	
	  ParserImplementation.prototype.parseEquality = function parseEquality() {
	    var result = this.parseRelational();
	
	    while (true) {
	      if (this.optional('==')) {
	        result = new Binary('==', result, this.parseRelational());
	      } else if (this.optional('!=')) {
	        result = new Binary('!=', result, this.parseRelational());
	      } else if (this.optional('===')) {
	        result = new Binary('===', result, this.parseRelational());
	      } else if (this.optional('!==')) {
	        result = new Binary('!==', result, this.parseRelational());
	      } else {
	        return result;
	      }
	    }
	  };
	
	  ParserImplementation.prototype.parseRelational = function parseRelational() {
	    var result = this.parseAdditive();
	
	    while (true) {
	      if (this.optional('<')) {
	        result = new Binary('<', result, this.parseAdditive());
	      } else if (this.optional('>')) {
	        result = new Binary('>', result, this.parseAdditive());
	      } else if (this.optional('<=')) {
	        result = new Binary('<=', result, this.parseAdditive());
	      } else if (this.optional('>=')) {
	        result = new Binary('>=', result, this.parseAdditive());
	      } else {
	        return result;
	      }
	    }
	  };
	
	  ParserImplementation.prototype.parseAdditive = function parseAdditive() {
	    var result = this.parseMultiplicative();
	
	    while (true) {
	      if (this.optional('+')) {
	        result = new Binary('+', result, this.parseMultiplicative());
	      } else if (this.optional('-')) {
	        result = new Binary('-', result, this.parseMultiplicative());
	      } else {
	        return result;
	      }
	    }
	  };
	
	  ParserImplementation.prototype.parseMultiplicative = function parseMultiplicative() {
	    var result = this.parsePrefix();
	
	    while (true) {
	      if (this.optional('*')) {
	        result = new Binary('*', result, this.parsePrefix());
	      } else if (this.optional('%')) {
	        result = new Binary('%', result, this.parsePrefix());
	      } else if (this.optional('/')) {
	        result = new Binary('/', result, this.parsePrefix());
	      } else {
	        return result;
	      }
	    }
	  };
	
	  ParserImplementation.prototype.parsePrefix = function parsePrefix() {
	    if (this.optional('+')) {
	      return this.parsePrefix();
	    } else if (this.optional('-')) {
	        return new Binary('-', new LiteralPrimitive(0), this.parsePrefix());
	      } else if (this.optional('!')) {
	        return new PrefixNot('!', this.parsePrefix());
	      }
	
	    return this.parseAccessOrCallMember();
	  };
	
	  ParserImplementation.prototype.parseAccessOrCallMember = function parseAccessOrCallMember() {
	    var result = this.parsePrimary();
	
	    while (true) {
	      if (this.optional('.')) {
	        var name = this.peek.text;
	
	        this.advance();
	
	        if (this.optional('(')) {
	          var args = this.parseExpressionList(')');
	          this.expect(')');
	          if (result instanceof AccessThis) {
	            result = new CallScope(name, args, result.ancestor);
	          } else {
	            result = new CallMember(result, name, args);
	          }
	        } else {
	          if (result instanceof AccessThis) {
	            result = new AccessScope(name, result.ancestor);
	          } else {
	            result = new AccessMember(result, name);
	          }
	        }
	      } else if (this.optional('[')) {
	        var key = this.parseExpression();
	        this.expect(']');
	        result = new AccessKeyed(result, key);
	      } else if (this.optional('(')) {
	        var _args = this.parseExpressionList(')');
	        this.expect(')');
	        result = new CallFunction(result, _args);
	      } else {
	        return result;
	      }
	    }
	  };
	
	  ParserImplementation.prototype.parsePrimary = function parsePrimary() {
	    if (this.optional('(')) {
	      var result = this.parseExpression();
	      this.expect(')');
	      return result;
	    } else if (this.optional('null')) {
	      return new LiteralPrimitive(null);
	    } else if (this.optional('undefined')) {
	      return new LiteralPrimitive(undefined);
	    } else if (this.optional('true')) {
	      return new LiteralPrimitive(true);
	    } else if (this.optional('false')) {
	      return new LiteralPrimitive(false);
	    } else if (this.optional('[')) {
	      var elements = this.parseExpressionList(']');
	      this.expect(']');
	      return new LiteralArray(elements);
	    } else if (this.peek.text === '{') {
	      return this.parseObject();
	    } else if (this.peek.key !== null && this.peek.key !== undefined) {
	      return this.parseAccessOrCallScope();
	    } else if (this.peek.value !== null && this.peek.value !== undefined) {
	      var value = this.peek.value;
	      this.advance();
	      return value instanceof String || typeof value === 'string' ? new LiteralString(value) : new LiteralPrimitive(value);
	    } else if (this.index >= this.tokens.length) {
	      throw new Error('Unexpected end of expression: ' + this.input);
	    } else {
	      this.error('Unexpected token ' + this.peek.text);
	    }
	  };
	
	  ParserImplementation.prototype.parseAccessOrCallScope = function parseAccessOrCallScope() {
	    var name = this.peek.key;
	
	    this.advance();
	
	    if (name === '$this') {
	      return new AccessThis(0);
	    }
	
	    var ancestor = 0;
	    while (name === '$parent') {
	      ancestor++;
	      if (this.optional('.')) {
	        name = this.peek.key;
	        this.advance();
	      } else if (this.peek === EOF || this.peek.text === '(' || this.peek.text === '[' || this.peek.text === '}') {
	        return new AccessThis(ancestor);
	      } else {
	        this.error('Unexpected token ' + this.peek.text);
	      }
	    }
	
	    if (this.optional('(')) {
	      var args = this.parseExpressionList(')');
	      this.expect(')');
	      return new CallScope(name, args, ancestor);
	    }
	
	    return new AccessScope(name, ancestor);
	  };
	
	  ParserImplementation.prototype.parseObject = function parseObject() {
	    var keys = [];
	    var values = [];
	
	    this.expect('{');
	
	    if (this.peek.text !== '}') {
	      do {
	        var peek = this.peek;
	        var value = peek.value;
	        keys.push(typeof value === 'string' ? value : peek.text);
	
	        this.advance();
	        if (peek.key && (this.peek.text === ',' || this.peek.text === '}')) {
	          --this.index;
	          values.push(this.parseAccessOrCallScope());
	        } else {
	          this.expect(':');
	          values.push(this.parseExpression());
	        }
	      } while (this.optional(','));
	    }
	
	    this.expect('}');
	
	    return new LiteralObject(keys, values);
	  };
	
	  ParserImplementation.prototype.parseExpressionList = function parseExpressionList(terminator) {
	    var result = [];
	
	    if (this.peek.text !== terminator) {
	      do {
	        result.push(this.parseExpression());
	      } while (this.optional(','));
	    }
	
	    return result;
	  };
	
	  ParserImplementation.prototype.optional = function optional(text) {
	    if (this.peek.text === text) {
	      this.advance();
	      return true;
	    }
	
	    return false;
	  };
	
	  ParserImplementation.prototype.expect = function expect(text) {
	    if (this.peek.text === text) {
	      this.advance();
	    } else {
	      this.error('Missing expected ' + text);
	    }
	  };
	
	  ParserImplementation.prototype.advance = function advance() {
	    this.index++;
	  };
	
	  ParserImplementation.prototype.error = function error(message) {
	    var location = this.index < this.tokens.length ? 'at column ' + (this.tokens[this.index].index + 1) + ' in' : 'at the end of the expression';
	
	    throw new Error('Parser Error: ' + message + ' ' + location + ' [' + this.input + ']');
	  };
	
	  _createClass(ParserImplementation, [{
	    key: 'peek',
	    get: function get() {
	      return this.index < this.tokens.length ? this.tokens[this.index] : EOF;
	    }
	  }]);
	
	  return ParserImplementation;
	}();
	
	var mapProto = Map.prototype;
	
	function _getMapObserver(taskQueue, map) {
	  return ModifyMapObserver.for(taskQueue, map);
	}
	
	exports.getMapObserver = _getMapObserver;
	
	var ModifyMapObserver = function (_ModifyCollectionObse2) {
	  _inherits(ModifyMapObserver, _ModifyCollectionObse2);
	
	  function ModifyMapObserver(taskQueue, map) {
	    
	
	    return _possibleConstructorReturn(this, _ModifyCollectionObse2.call(this, taskQueue, map));
	  }
	
	  ModifyMapObserver.for = function _for(taskQueue, map) {
	    if (!('__map_observer__' in map)) {
	      var observer = ModifyMapObserver.create(taskQueue, map);
	      Reflect.defineProperty(map, '__map_observer__', { value: observer, enumerable: false, configurable: false });
	    }
	    return map.__map_observer__;
	  };
	
	  ModifyMapObserver.create = function create(taskQueue, map) {
	    var observer = new ModifyMapObserver(taskQueue, map);
	
	    var proto = mapProto;
	    if (proto.add !== map.add || proto.delete !== map.delete || proto.clear !== map.clear) {
	      proto = {
	        add: map.add,
	        delete: map.delete,
	        clear: map.clear
	      };
	    }
	
	    map.set = function () {
	      var hasValue = map.has(arguments[0]);
	      var type = hasValue ? 'update' : 'add';
	      var oldValue = map.get(arguments[0]);
	      var methodCallResult = proto.set.apply(map, arguments);
	      if (!hasValue || oldValue !== map.get(arguments[0])) {
	        observer.addChangeRecord({
	          type: type,
	          object: map,
	          key: arguments[0],
	          oldValue: oldValue
	        });
	      }
	      return methodCallResult;
	    };
	
	    map.delete = function () {
	      var hasValue = map.has(arguments[0]);
	      var oldValue = map.get(arguments[0]);
	      var methodCallResult = proto.delete.apply(map, arguments);
	      if (hasValue) {
	        observer.addChangeRecord({
	          type: 'delete',
	          object: map,
	          key: arguments[0],
	          oldValue: oldValue
	        });
	      }
	      return methodCallResult;
	    };
	
	    map.clear = function () {
	      var methodCallResult = proto.clear.apply(map, arguments);
	      observer.addChangeRecord({
	        type: 'clear',
	        object: map
	      });
	      return methodCallResult;
	    };
	
	    return observer;
	  };
	
	  return ModifyMapObserver;
	}(ModifyCollectionObserver);
	
	function findOriginalEventTarget(event) {
	  return event.path && event.path[0] || event.deepPath && event.deepPath[0] || event.target;
	}
	
	function handleDelegatedEvent(event) {
	  var target = findOriginalEventTarget(event);
	  var callback = void 0;
	
	  while (target && !callback) {
	    if (target.delegatedCallbacks) {
	      callback = target.delegatedCallbacks[event.type];
	    }
	
	    if (!callback) {
	      target = target.parentNode;
	    }
	  }
	
	  if (callback) {
	    callback(event);
	  }
	}
	
	var DelegateHandlerEntry = function () {
	  function DelegateHandlerEntry(eventName) {
	    
	
	    this.eventName = eventName;
	    this.count = 0;
	  }
	
	  DelegateHandlerEntry.prototype.increment = function increment() {
	    this.count++;
	
	    if (this.count === 1) {
	      _aureliaPal.DOM.addEventListener(this.eventName, handleDelegatedEvent, false);
	    }
	  };
	
	  DelegateHandlerEntry.prototype.decrement = function decrement() {
	    this.count--;
	
	    if (this.count === 0) {
	      _aureliaPal.DOM.removeEventListener(this.eventName, handleDelegatedEvent);
	    }
	  };
	
	  return DelegateHandlerEntry;
	}();
	
	var DefaultEventStrategy = function () {
	  function DefaultEventStrategy() {
	    
	
	    this.delegatedHandlers = [];
	  }
	
	  DefaultEventStrategy.prototype.subscribe = function subscribe(target, targetEvent, callback, delegate) {
	    var _this22 = this;
	
	    if (delegate) {
	      var _ret = function () {
	        var delegatedHandlers = _this22.delegatedHandlers;
	        var handlerEntry = delegatedHandlers[targetEvent] || (delegatedHandlers[targetEvent] = new DelegateHandlerEntry(targetEvent));
	        var delegatedCallbacks = target.delegatedCallbacks || (target.delegatedCallbacks = {});
	
	        handlerEntry.increment();
	        delegatedCallbacks[targetEvent] = callback;
	
	        return {
	          v: function v() {
	            handlerEntry.decrement();
	            delegatedCallbacks[targetEvent] = null;
	          }
	        };
	      }();
	
	      if ((typeof _ret === 'undefined' ? 'undefined' : _typeof(_ret)) === "object") return _ret.v;
	    }
	
	    target.addEventListener(targetEvent, callback, false);
	
	    return function () {
	      target.removeEventListener(targetEvent, callback);
	    };
	  };
	
	  return DefaultEventStrategy;
	}();
	
	var EventManager = exports.EventManager = function () {
	  function EventManager() {
	    
	
	    this.elementHandlerLookup = {};
	    this.eventStrategyLookup = {};
	
	    this.registerElementConfig({
	      tagName: 'input',
	      properties: {
	        value: ['change', 'input'],
	        checked: ['change', 'input'],
	        files: ['change', 'input']
	      }
	    });
	
	    this.registerElementConfig({
	      tagName: 'textarea',
	      properties: {
	        value: ['change', 'input']
	      }
	    });
	
	    this.registerElementConfig({
	      tagName: 'select',
	      properties: {
	        value: ['change']
	      }
	    });
	
	    this.registerElementConfig({
	      tagName: 'content editable',
	      properties: {
	        value: ['change', 'input', 'blur', 'keyup', 'paste']
	      }
	    });
	
	    this.registerElementConfig({
	      tagName: 'scrollable element',
	      properties: {
	        scrollTop: ['scroll'],
	        scrollLeft: ['scroll']
	      }
	    });
	
	    this.defaultEventStrategy = new DefaultEventStrategy();
	  }
	
	  EventManager.prototype.registerElementConfig = function registerElementConfig(config) {
	    var tagName = config.tagName.toLowerCase();
	    var properties = config.properties;
	    var propertyName = void 0;
	
	    this.elementHandlerLookup[tagName] = {};
	
	    for (propertyName in properties) {
	      if (properties.hasOwnProperty(propertyName)) {
	        this.registerElementPropertyConfig(tagName, propertyName, properties[propertyName]);
	      }
	    }
	  };
	
	  EventManager.prototype.registerElementPropertyConfig = function registerElementPropertyConfig(tagName, propertyName, events) {
	    this.elementHandlerLookup[tagName][propertyName] = this.createElementHandler(events);
	  };
	
	  EventManager.prototype.createElementHandler = function createElementHandler(events) {
	    return {
	      subscribe: function subscribe(target, callback) {
	        events.forEach(function (changeEvent) {
	          target.addEventListener(changeEvent, callback, false);
	        });
	
	        return function () {
	          events.forEach(function (changeEvent) {
	            target.removeEventListener(changeEvent, callback);
	          });
	        };
	      }
	    };
	  };
	
	  EventManager.prototype.registerElementHandler = function registerElementHandler(tagName, handler) {
	    this.elementHandlerLookup[tagName.toLowerCase()] = handler;
	  };
	
	  EventManager.prototype.registerEventStrategy = function registerEventStrategy(eventName, strategy) {
	    this.eventStrategyLookup[eventName] = strategy;
	  };
	
	  EventManager.prototype.getElementHandler = function getElementHandler(target, propertyName) {
	    var tagName = void 0;
	    var lookup = this.elementHandlerLookup;
	
	    if (target.tagName) {
	      tagName = target.tagName.toLowerCase();
	
	      if (lookup[tagName] && lookup[tagName][propertyName]) {
	        return lookup[tagName][propertyName];
	      }
	
	      if (propertyName === 'textContent' || propertyName === 'innerHTML') {
	        return lookup['content editable'].value;
	      }
	
	      if (propertyName === 'scrollTop' || propertyName === 'scrollLeft') {
	        return lookup['scrollable element'][propertyName];
	      }
	    }
	
	    return null;
	  };
	
	  EventManager.prototype.addEventListener = function addEventListener(target, targetEvent, callback, delegate) {
	    return (this.eventStrategyLookup[targetEvent] || this.defaultEventStrategy).subscribe(target, targetEvent, callback, delegate);
	  };
	
	  return EventManager;
	}();
	
	var DirtyChecker = exports.DirtyChecker = function () {
	  function DirtyChecker() {
	    
	
	    this.tracked = [];
	    this.checkDelay = 120;
	  }
	
	  DirtyChecker.prototype.addProperty = function addProperty(property) {
	    var tracked = this.tracked;
	
	    tracked.push(property);
	
	    if (tracked.length === 1) {
	      this.scheduleDirtyCheck();
	    }
	  };
	
	  DirtyChecker.prototype.removeProperty = function removeProperty(property) {
	    var tracked = this.tracked;
	    tracked.splice(tracked.indexOf(property), 1);
	  };
	
	  DirtyChecker.prototype.scheduleDirtyCheck = function scheduleDirtyCheck() {
	    var _this23 = this;
	
	    setTimeout(function () {
	      return _this23.check();
	    }, this.checkDelay);
	  };
	
	  DirtyChecker.prototype.check = function check() {
	    var tracked = this.tracked;
	    var i = tracked.length;
	
	    while (i--) {
	      var current = tracked[i];
	
	      if (current.isDirty()) {
	        current.call();
	      }
	    }
	
	    if (tracked.length) {
	      this.scheduleDirtyCheck();
	    }
	  };
	
	  return DirtyChecker;
	}();
	
	var DirtyCheckProperty = exports.DirtyCheckProperty = (_dec5 = subscriberCollection(), _dec5(_class5 = function () {
	  function DirtyCheckProperty(dirtyChecker, obj, propertyName) {
	    
	
	    this.dirtyChecker = dirtyChecker;
	    this.obj = obj;
	    this.propertyName = propertyName;
	  }
	
	  DirtyCheckProperty.prototype.getValue = function getValue() {
	    return this.obj[this.propertyName];
	  };
	
	  DirtyCheckProperty.prototype.setValue = function setValue(newValue) {
	    this.obj[this.propertyName] = newValue;
	  };
	
	  DirtyCheckProperty.prototype.call = function call() {
	    var oldValue = this.oldValue;
	    var newValue = this.getValue();
	
	    this.callSubscribers(newValue, oldValue);
	
	    this.oldValue = newValue;
	  };
	
	  DirtyCheckProperty.prototype.isDirty = function isDirty() {
	    return this.oldValue !== this.obj[this.propertyName];
	  };
	
	  DirtyCheckProperty.prototype.subscribe = function subscribe(context, callable) {
	    if (!this.hasSubscribers()) {
	      this.oldValue = this.getValue();
	      this.dirtyChecker.addProperty(this);
	    }
	    this.addSubscriber(context, callable);
	  };
	
	  DirtyCheckProperty.prototype.unsubscribe = function unsubscribe(context, callable) {
	    if (this.removeSubscriber(context, callable) && !this.hasSubscribers()) {
	      this.dirtyChecker.removeProperty(this);
	    }
	  };
	
	  return DirtyCheckProperty;
	}()) || _class5);
	
	
	var logger = LogManager.getLogger('property-observation');
	
	var propertyAccessor = exports.propertyAccessor = {
	  getValue: function getValue(obj, propertyName) {
	    return obj[propertyName];
	  },
	  setValue: function setValue(value, obj, propertyName) {
	    obj[propertyName] = value;
	  }
	};
	
	var PrimitiveObserver = exports.PrimitiveObserver = function () {
	  function PrimitiveObserver(primitive, propertyName) {
	    
	
	    this.doNotCache = true;
	
	    this.primitive = primitive;
	    this.propertyName = propertyName;
	  }
	
	  PrimitiveObserver.prototype.getValue = function getValue() {
	    return this.primitive[this.propertyName];
	  };
	
	  PrimitiveObserver.prototype.setValue = function setValue() {
	    var type = _typeof(this.primitive);
	    throw new Error('The ' + this.propertyName + ' property of a ' + type + ' (' + this.primitive + ') cannot be assigned.');
	  };
	
	  PrimitiveObserver.prototype.subscribe = function subscribe() {};
	
	  PrimitiveObserver.prototype.unsubscribe = function unsubscribe() {};
	
	  return PrimitiveObserver;
	}();
	
	var SetterObserver = exports.SetterObserver = (_dec6 = subscriberCollection(), _dec6(_class7 = function () {
	  function SetterObserver(taskQueue, obj, propertyName) {
	    
	
	    this.taskQueue = taskQueue;
	    this.obj = obj;
	    this.propertyName = propertyName;
	    this.queued = false;
	    this.observing = false;
	  }
	
	  SetterObserver.prototype.getValue = function getValue() {
	    return this.obj[this.propertyName];
	  };
	
	  SetterObserver.prototype.setValue = function setValue(newValue) {
	    this.obj[this.propertyName] = newValue;
	  };
	
	  SetterObserver.prototype.getterValue = function getterValue() {
	    return this.currentValue;
	  };
	
	  SetterObserver.prototype.setterValue = function setterValue(newValue) {
	    var oldValue = this.currentValue;
	
	    if (oldValue !== newValue) {
	      if (!this.queued) {
	        this.oldValue = oldValue;
	        this.queued = true;
	        this.taskQueue.queueMicroTask(this);
	      }
	
	      this.currentValue = newValue;
	    }
	  };
	
	  SetterObserver.prototype.call = function call() {
	    var oldValue = this.oldValue;
	    var newValue = this.currentValue;
	
	    this.queued = false;
	
	    this.callSubscribers(newValue, oldValue);
	  };
	
	  SetterObserver.prototype.subscribe = function subscribe(context, callable) {
	    if (!this.observing) {
	      this.convertProperty();
	    }
	    this.addSubscriber(context, callable);
	  };
	
	  SetterObserver.prototype.unsubscribe = function unsubscribe(context, callable) {
	    this.removeSubscriber(context, callable);
	  };
	
	  SetterObserver.prototype.convertProperty = function convertProperty() {
	    this.observing = true;
	    this.currentValue = this.obj[this.propertyName];
	    this.setValue = this.setterValue;
	    this.getValue = this.getterValue;
	
	    if (!Reflect.defineProperty(this.obj, this.propertyName, {
	      configurable: true,
	      enumerable: this.propertyName in this.obj ? this.obj.propertyIsEnumerable(this.propertyName) : true,
	      get: this.getValue.bind(this),
	      set: this.setValue.bind(this)
	    })) {
	      logger.warn('Cannot observe property \'' + this.propertyName + '\' of object', this.obj);
	    }
	  };
	
	  return SetterObserver;
	}()) || _class7);
	
	var XLinkAttributeObserver = exports.XLinkAttributeObserver = function () {
	  function XLinkAttributeObserver(element, propertyName, attributeName) {
	    
	
	    this.element = element;
	    this.propertyName = propertyName;
	    this.attributeName = attributeName;
	  }
	
	  XLinkAttributeObserver.prototype.getValue = function getValue() {
	    return this.element.getAttributeNS('http://www.w3.org/1999/xlink', this.attributeName);
	  };
	
	  XLinkAttributeObserver.prototype.setValue = function setValue(newValue) {
	    return this.element.setAttributeNS('http://www.w3.org/1999/xlink', this.attributeName, newValue);
	  };
	
	  XLinkAttributeObserver.prototype.subscribe = function subscribe() {
	    throw new Error('Observation of a "' + this.element.nodeName + '" element\'s "' + this.propertyName + '" property is not supported.');
	  };
	
	  return XLinkAttributeObserver;
	}();
	
	var dataAttributeAccessor = exports.dataAttributeAccessor = {
	  getValue: function getValue(obj, propertyName) {
	    return obj.getAttribute(propertyName);
	  },
	  setValue: function setValue(value, obj, propertyName) {
	    return obj.setAttribute(propertyName, value);
	  }
	};
	
	var DataAttributeObserver = exports.DataAttributeObserver = function () {
	  function DataAttributeObserver(element, propertyName) {
	    
	
	    this.element = element;
	    this.propertyName = propertyName;
	  }
	
	  DataAttributeObserver.prototype.getValue = function getValue() {
	    return this.element.getAttribute(this.propertyName);
	  };
	
	  DataAttributeObserver.prototype.setValue = function setValue(newValue) {
	    return this.element.setAttribute(this.propertyName, newValue);
	  };
	
	  DataAttributeObserver.prototype.subscribe = function subscribe() {
	    throw new Error('Observation of a "' + this.element.nodeName + '" element\'s "' + this.propertyName + '" property is not supported.');
	  };
	
	  return DataAttributeObserver;
	}();
	
	var StyleObserver = exports.StyleObserver = function () {
	  function StyleObserver(element, propertyName) {
	    
	
	    this.element = element;
	    this.propertyName = propertyName;
	
	    this.styles = null;
	    this.version = 0;
	  }
	
	  StyleObserver.prototype.getValue = function getValue() {
	    return this.element.style.cssText;
	  };
	
	  StyleObserver.prototype.setValue = function setValue(newValue) {
	    var styles = this.styles || {};
	    var style = void 0;
	    var version = this.version;
	
	    if (newValue !== null && newValue !== undefined) {
	      if (newValue instanceof Object) {
	        for (style in newValue) {
	          if (newValue.hasOwnProperty(style)) {
	            styles[style] = version;
	            this.element.style[style] = newValue[style];
	          }
	        }
	      } else if (newValue.length) {
	        var pairs = newValue.split(/(?:;|:(?!\/))\s*/);
	        for (var _i22 = 0, length = pairs.length; _i22 < length; _i22++) {
	          style = pairs[_i22].trim();
	          if (!style) {
	            continue;
	          }
	
	          styles[style] = version;
	
	          this.element.style[style] = pairs[++_i22];
	        }
	      }
	    }
	
	    this.styles = styles;
	    this.version += 1;
	
	    if (version === 0) {
	      return;
	    }
	
	    version -= 1;
	    for (style in styles) {
	      if (!styles.hasOwnProperty(style) || styles[style] !== version) {
	        continue;
	      }
	
	      this.element.style[style] = '';
	    }
	  };
	
	  StyleObserver.prototype.subscribe = function subscribe() {
	    throw new Error('Observation of a "' + this.element.nodeName + '" element\'s "' + this.propertyName + '" property is not supported.');
	  };
	
	  return StyleObserver;
	}();
	
	var ValueAttributeObserver = exports.ValueAttributeObserver = (_dec7 = subscriberCollection(), _dec7(_class8 = function () {
	  function ValueAttributeObserver(element, propertyName, handler) {
	    
	
	    this.element = element;
	    this.propertyName = propertyName;
	    this.handler = handler;
	    if (propertyName === 'files') {
	      this.setValue = function () {};
	    }
	  }
	
	  ValueAttributeObserver.prototype.getValue = function getValue() {
	    return this.element[this.propertyName];
	  };
	
	  ValueAttributeObserver.prototype.setValue = function setValue(newValue) {
	    newValue = newValue === undefined || newValue === null ? '' : newValue;
	    if (this.element[this.propertyName] !== newValue) {
	      this.element[this.propertyName] = newValue;
	      this.notify();
	    }
	  };
	
	  ValueAttributeObserver.prototype.notify = function notify() {
	    var oldValue = this.oldValue;
	    var newValue = this.getValue();
	
	    this.callSubscribers(newValue, oldValue);
	
	    this.oldValue = newValue;
	  };
	
	  ValueAttributeObserver.prototype.subscribe = function subscribe(context, callable) {
	    if (!this.hasSubscribers()) {
	      this.oldValue = this.getValue();
	      this.disposeHandler = this.handler.subscribe(this.element, this.notify.bind(this));
	    }
	
	    this.addSubscriber(context, callable);
	  };
	
	  ValueAttributeObserver.prototype.unsubscribe = function unsubscribe(context, callable) {
	    if (this.removeSubscriber(context, callable) && !this.hasSubscribers()) {
	      this.disposeHandler();
	      this.disposeHandler = null;
	    }
	  };
	
	  return ValueAttributeObserver;
	}()) || _class8);
	
	
	var checkedArrayContext = 'CheckedObserver:array';
	var checkedValueContext = 'CheckedObserver:value';
	
	var CheckedObserver = exports.CheckedObserver = (_dec8 = subscriberCollection(), _dec8(_class9 = function () {
	  function CheckedObserver(element, handler, observerLocator) {
	    
	
	    this.element = element;
	    this.handler = handler;
	    this.observerLocator = observerLocator;
	  }
	
	  CheckedObserver.prototype.getValue = function getValue() {
	    return this.value;
	  };
	
	  CheckedObserver.prototype.setValue = function setValue(newValue) {
	    if (this.value === newValue) {
	      return;
	    }
	
	    if (this.arrayObserver) {
	      this.arrayObserver.unsubscribe(checkedArrayContext, this);
	      this.arrayObserver = null;
	    }
	
	    if (this.element.type === 'checkbox' && Array.isArray(newValue)) {
	      this.arrayObserver = this.observerLocator.getArrayObserver(newValue);
	      this.arrayObserver.subscribe(checkedArrayContext, this);
	    }
	
	    this.oldValue = this.value;
	    this.value = newValue;
	    this.synchronizeElement();
	    this.notify();
	
	    if (!this.initialSync) {
	      this.initialSync = true;
	      this.observerLocator.taskQueue.queueMicroTask(this);
	    }
	  };
	
	  CheckedObserver.prototype.call = function call(context, splices) {
	    this.synchronizeElement();
	
	    if (!this.valueObserver && (this.valueObserver = this.element.__observers__.model || this.element.__observers__.value)) {
	      this.valueObserver.subscribe(checkedValueContext, this);
	    }
	  };
	
	  CheckedObserver.prototype.synchronizeElement = function synchronizeElement() {
	    var value = this.value;
	    var element = this.element;
	    var elementValue = element.hasOwnProperty('model') ? element.model : element.value;
	    var isRadio = element.type === 'radio';
	    var matcher = element.matcher || function (a, b) {
	      return a === b;
	    };
	
	    element.checked = isRadio && !!matcher(value, elementValue) || !isRadio && value === true || !isRadio && Array.isArray(value) && !!value.find(function (item) {
	      return !!matcher(item, elementValue);
	    });
	  };
	
	  CheckedObserver.prototype.synchronizeValue = function synchronizeValue() {
	    var value = this.value;
	    var element = this.element;
	    var elementValue = element.hasOwnProperty('model') ? element.model : element.value;
	    var index = void 0;
	    var matcher = element.matcher || function (a, b) {
	      return a === b;
	    };
	
	    if (element.type === 'checkbox') {
	      if (Array.isArray(value)) {
	        index = value.findIndex(function (item) {
	          return !!matcher(item, elementValue);
	        });
	        if (element.checked && index === -1) {
	          value.push(elementValue);
	        } else if (!element.checked && index !== -1) {
	          value.splice(index, 1);
	        }
	
	        return;
	      }
	
	      value = element.checked;
	    } else if (element.checked) {
	      value = elementValue;
	    } else {
	      return;
	    }
	
	    this.oldValue = this.value;
	    this.value = value;
	    this.notify();
	  };
	
	  CheckedObserver.prototype.notify = function notify() {
	    var oldValue = this.oldValue;
	    var newValue = this.value;
	
	    this.callSubscribers(newValue, oldValue);
	  };
	
	  CheckedObserver.prototype.subscribe = function subscribe(context, callable) {
	    if (!this.hasSubscribers()) {
	      this.disposeHandler = this.handler.subscribe(this.element, this.synchronizeValue.bind(this, false));
	    }
	    this.addSubscriber(context, callable);
	  };
	
	  CheckedObserver.prototype.unsubscribe = function unsubscribe(context, callable) {
	    if (this.removeSubscriber(context, callable) && !this.hasSubscribers()) {
	      this.disposeHandler();
	      this.disposeHandler = null;
	    }
	  };
	
	  CheckedObserver.prototype.unbind = function unbind() {
	    if (this.arrayObserver) {
	      this.arrayObserver.unsubscribe(checkedArrayContext, this);
	      this.arrayObserver = null;
	    }
	    if (this.valueObserver) {
	      this.valueObserver.unsubscribe(checkedValueContext, this);
	    }
	  };
	
	  return CheckedObserver;
	}()) || _class9);
	
	
	var selectArrayContext = 'SelectValueObserver:array';
	
	var SelectValueObserver = exports.SelectValueObserver = (_dec9 = subscriberCollection(), _dec9(_class10 = function () {
	  function SelectValueObserver(element, handler, observerLocator) {
	    
	
	    this.element = element;
	    this.handler = handler;
	    this.observerLocator = observerLocator;
	  }
	
	  SelectValueObserver.prototype.getValue = function getValue() {
	    return this.value;
	  };
	
	  SelectValueObserver.prototype.setValue = function setValue(newValue) {
	    if (newValue !== null && newValue !== undefined && this.element.multiple && !Array.isArray(newValue)) {
	      throw new Error('Only null or Array instances can be bound to a multi-select.');
	    }
	    if (this.value === newValue) {
	      return;
	    }
	
	    if (this.arrayObserver) {
	      this.arrayObserver.unsubscribe(selectArrayContext, this);
	      this.arrayObserver = null;
	    }
	
	    if (Array.isArray(newValue)) {
	      this.arrayObserver = this.observerLocator.getArrayObserver(newValue);
	      this.arrayObserver.subscribe(selectArrayContext, this);
	    }
	
	    this.oldValue = this.value;
	    this.value = newValue;
	    this.synchronizeOptions();
	    this.notify();
	
	    if (!this.initialSync) {
	      this.initialSync = true;
	      this.observerLocator.taskQueue.queueMicroTask(this);
	    }
	  };
	
	  SelectValueObserver.prototype.call = function call(context, splices) {
	    this.synchronizeOptions();
	  };
	
	  SelectValueObserver.prototype.synchronizeOptions = function synchronizeOptions() {
	    var value = this.value;
	    var clear = void 0;
	    var isArray = void 0;
	
	    if (value === null || value === undefined) {
	      clear = true;
	    } else if (Array.isArray(value)) {
	      isArray = true;
	    }
	
	    var options = this.element.options;
	    var i = options.length;
	    var matcher = this.element.matcher || function (a, b) {
	      return a === b;
	    };
	
	    var _loop = function _loop() {
	      var option = options.item(i);
	      if (clear) {
	        option.selected = false;
	        return 'continue';
	      }
	      var optionValue = option.hasOwnProperty('model') ? option.model : option.value;
	      if (isArray) {
	        option.selected = !!value.find(function (item) {
	          return !!matcher(optionValue, item);
	        });
	        return 'continue';
	      }
	      option.selected = !!matcher(optionValue, value);
	    };
	
	    while (i--) {
	      var _ret2 = _loop();
	
	      if (_ret2 === 'continue') continue;
	    }
	  };
	
	  SelectValueObserver.prototype.synchronizeValue = function synchronizeValue() {
	    var _this24 = this;
	
	    var options = this.element.options;
	    var count = 0;
	    var value = [];
	
	    for (var _i23 = 0, ii = options.length; _i23 < ii; _i23++) {
	      var _option = options.item(_i23);
	      if (!_option.selected) {
	        continue;
	      }
	      value.push(_option.hasOwnProperty('model') ? _option.model : _option.value);
	      count++;
	    }
	
	    if (this.element.multiple) {
	      if (Array.isArray(this.value)) {
	        var _ret3 = function () {
	          var matcher = _this24.element.matcher || function (a, b) {
	            return a === b;
	          };
	
	          var i = 0;
	
	          var _loop2 = function _loop2() {
	            var a = _this24.value[i];
	            if (value.findIndex(function (b) {
	              return matcher(a, b);
	            }) === -1) {
	              _this24.value.splice(i, 1);
	            } else {
	              i++;
	            }
	          };
	
	          while (i < _this24.value.length) {
	            _loop2();
	          }
	
	          i = 0;
	
	          var _loop3 = function _loop3() {
	            var a = value[i];
	            if (_this24.value.findIndex(function (b) {
	              return matcher(a, b);
	            }) === -1) {
	              _this24.value.push(a);
	            }
	            i++;
	          };
	
	          while (i < value.length) {
	            _loop3();
	          }
	          return {
	            v: void 0
	          };
	        }();
	
	        if ((typeof _ret3 === 'undefined' ? 'undefined' : _typeof(_ret3)) === "object") return _ret3.v;
	      }
	    } else {
	        if (count === 0) {
	          value = null;
	        } else {
	          value = value[0];
	        }
	      }
	
	    if (value !== this.value) {
	      this.oldValue = this.value;
	      this.value = value;
	      this.notify();
	    }
	  };
	
	  SelectValueObserver.prototype.notify = function notify() {
	    var oldValue = this.oldValue;
	    var newValue = this.value;
	
	    this.callSubscribers(newValue, oldValue);
	  };
	
	  SelectValueObserver.prototype.subscribe = function subscribe(context, callable) {
	    if (!this.hasSubscribers()) {
	      this.disposeHandler = this.handler.subscribe(this.element, this.synchronizeValue.bind(this, false));
	    }
	    this.addSubscriber(context, callable);
	  };
	
	  SelectValueObserver.prototype.unsubscribe = function unsubscribe(context, callable) {
	    if (this.removeSubscriber(context, callable) && !this.hasSubscribers()) {
	      this.disposeHandler();
	      this.disposeHandler = null;
	    }
	  };
	
	  SelectValueObserver.prototype.bind = function bind() {
	    var _this25 = this;
	
	    this.domObserver = _aureliaPal.DOM.createMutationObserver(function () {
	      _this25.synchronizeOptions();
	      _this25.synchronizeValue();
	    });
	    this.domObserver.observe(this.element, { childList: true, subtree: true });
	  };
	
	  SelectValueObserver.prototype.unbind = function unbind() {
	    this.domObserver.disconnect();
	    this.domObserver = null;
	
	    if (this.arrayObserver) {
	      this.arrayObserver.unsubscribe(selectArrayContext, this);
	      this.arrayObserver = null;
	    }
	  };
	
	  return SelectValueObserver;
	}()) || _class10);
	
	var ClassObserver = exports.ClassObserver = function () {
	  function ClassObserver(element) {
	    
	
	    this.element = element;
	    this.doNotCache = true;
	    this.value = '';
	    this.version = 0;
	  }
	
	  ClassObserver.prototype.getValue = function getValue() {
	    return this.value;
	  };
	
	  ClassObserver.prototype.setValue = function setValue(newValue) {
	    var nameIndex = this.nameIndex || {};
	    var version = this.version;
	    var names = void 0;
	    var name = void 0;
	
	    if (newValue !== null && newValue !== undefined && newValue.length) {
	      names = newValue.split(/\s+/);
	      for (var _i24 = 0, length = names.length; _i24 < length; _i24++) {
	        name = names[_i24];
	        if (name === '') {
	          continue;
	        }
	        nameIndex[name] = version;
	        this.element.classList.add(name);
	      }
	    }
	
	    this.value = newValue;
	    this.nameIndex = nameIndex;
	    this.version += 1;
	
	    if (version === 0) {
	      return;
	    }
	
	    version -= 1;
	    for (name in nameIndex) {
	      if (!nameIndex.hasOwnProperty(name) || nameIndex[name] !== version) {
	        continue;
	      }
	      this.element.classList.remove(name);
	    }
	  };
	
	  ClassObserver.prototype.subscribe = function subscribe() {
	    throw new Error('Observation of a "' + this.element.nodeName + '" element\'s "class" property is not supported.');
	  };
	
	  return ClassObserver;
	}();
	
	function hasDeclaredDependencies(descriptor) {
	  return !!(descriptor && descriptor.get && descriptor.get.dependencies);
	}
	
	function declarePropertyDependencies(ctor, propertyName, dependencies) {
	  var descriptor = Object.getOwnPropertyDescriptor(ctor.prototype, propertyName);
	  descriptor.get.dependencies = dependencies;
	}
	
	function computedFrom() {
	  for (var _len = arguments.length, rest = Array(_len), _key = 0; _key < _len; _key++) {
	    rest[_key] = arguments[_key];
	  }
	
	  return function (target, key, descriptor) {
	    descriptor.get.dependencies = rest;
	    return descriptor;
	  };
	}
	
	var ComputedExpression = exports.ComputedExpression = function (_Expression19) {
	  _inherits(ComputedExpression, _Expression19);
	
	  function ComputedExpression(name, dependencies) {
	    
	
	    var _this26 = _possibleConstructorReturn(this, _Expression19.call(this));
	
	    _this26.name = name;
	    _this26.dependencies = dependencies;
	    _this26.isAssignable = true;
	    return _this26;
	  }
	
	  ComputedExpression.prototype.evaluate = function evaluate(scope, lookupFunctions) {
	    return scope.bindingContext[this.name];
	  };
	
	  ComputedExpression.prototype.assign = function assign(scope, value) {
	    scope.bindingContext[this.name] = value;
	  };
	
	  ComputedExpression.prototype.accept = function accept(visitor) {
	    throw new Error('not implemented');
	  };
	
	  ComputedExpression.prototype.connect = function connect(binding, scope) {
	    var dependencies = this.dependencies;
	    var i = dependencies.length;
	    while (i--) {
	      dependencies[i].connect(binding, scope);
	    }
	  };
	
	  return ComputedExpression;
	}(Expression);
	
	function createComputedObserver(obj, propertyName, descriptor, observerLocator) {
	  var dependencies = descriptor.get.dependencies;
	  if (!(dependencies instanceof ComputedExpression)) {
	    var _i25 = dependencies.length;
	    while (_i25--) {
	      dependencies[_i25] = observerLocator.parser.parse(dependencies[_i25]);
	    }
	    dependencies = descriptor.get.dependencies = new ComputedExpression(propertyName, dependencies);
	  }
	
	  var scope = { bindingContext: obj, overrideContext: createOverrideContext(obj) };
	  return new ExpressionObserver(scope, dependencies, observerLocator);
	}
	
	var elements = exports.elements = {
	  a: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'target', 'transform', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],
	  altGlyph: ['class', 'dx', 'dy', 'externalResourcesRequired', 'format', 'glyphRef', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rotate', 'style', 'systemLanguage', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  altGlyphDef: ['id', 'xml:base', 'xml:lang', 'xml:space'],
	  altGlyphItem: ['id', 'xml:base', 'xml:lang', 'xml:space'],
	  animate: ['accumulate', 'additive', 'attributeName', 'attributeType', 'begin', 'by', 'calcMode', 'dur', 'end', 'externalResourcesRequired', 'fill', 'from', 'id', 'keySplines', 'keyTimes', 'max', 'min', 'onbegin', 'onend', 'onload', 'onrepeat', 'repeatCount', 'repeatDur', 'requiredExtensions', 'requiredFeatures', 'restart', 'systemLanguage', 'to', 'values', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],
	  animateColor: ['accumulate', 'additive', 'attributeName', 'attributeType', 'begin', 'by', 'calcMode', 'dur', 'end', 'externalResourcesRequired', 'fill', 'from', 'id', 'keySplines', 'keyTimes', 'max', 'min', 'onbegin', 'onend', 'onload', 'onrepeat', 'repeatCount', 'repeatDur', 'requiredExtensions', 'requiredFeatures', 'restart', 'systemLanguage', 'to', 'values', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],
	  animateMotion: ['accumulate', 'additive', 'begin', 'by', 'calcMode', 'dur', 'end', 'externalResourcesRequired', 'fill', 'from', 'id', 'keyPoints', 'keySplines', 'keyTimes', 'max', 'min', 'onbegin', 'onend', 'onload', 'onrepeat', 'origin', 'path', 'repeatCount', 'repeatDur', 'requiredExtensions', 'requiredFeatures', 'restart', 'rotate', 'systemLanguage', 'to', 'values', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],
	  animateTransform: ['accumulate', 'additive', 'attributeName', 'attributeType', 'begin', 'by', 'calcMode', 'dur', 'end', 'externalResourcesRequired', 'fill', 'from', 'id', 'keySplines', 'keyTimes', 'max', 'min', 'onbegin', 'onend', 'onload', 'onrepeat', 'repeatCount', 'repeatDur', 'requiredExtensions', 'requiredFeatures', 'restart', 'systemLanguage', 'to', 'type', 'values', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],
	  circle: ['class', 'cx', 'cy', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'r', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],
	  clipPath: ['class', 'clipPathUnits', 'externalResourcesRequired', 'id', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],
	  'color-profile': ['id', 'local', 'name', 'rendering-intent', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],
	  cursor: ['externalResourcesRequired', 'id', 'requiredExtensions', 'requiredFeatures', 'systemLanguage', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  defs: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],
	  desc: ['class', 'id', 'style', 'xml:base', 'xml:lang', 'xml:space'],
	  ellipse: ['class', 'cx', 'cy', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rx', 'ry', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],
	  feBlend: ['class', 'height', 'id', 'in', 'in2', 'mode', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  feColorMatrix: ['class', 'height', 'id', 'in', 'result', 'style', 'type', 'values', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  feComponentTransfer: ['class', 'height', 'id', 'in', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  feComposite: ['class', 'height', 'id', 'in', 'in2', 'k1', 'k2', 'k3', 'k4', 'operator', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  feConvolveMatrix: ['bias', 'class', 'divisor', 'edgeMode', 'height', 'id', 'in', 'kernelMatrix', 'kernelUnitLength', 'order', 'preserveAlpha', 'result', 'style', 'targetX', 'targetY', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  feDiffuseLighting: ['class', 'diffuseConstant', 'height', 'id', 'in', 'kernelUnitLength', 'result', 'style', 'surfaceScale', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  feDisplacementMap: ['class', 'height', 'id', 'in', 'in2', 'result', 'scale', 'style', 'width', 'x', 'xChannelSelector', 'xml:base', 'xml:lang', 'xml:space', 'y', 'yChannelSelector'],
	  feDistantLight: ['azimuth', 'elevation', 'id', 'xml:base', 'xml:lang', 'xml:space'],
	  feFlood: ['class', 'height', 'id', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  feFuncA: ['amplitude', 'exponent', 'id', 'intercept', 'offset', 'slope', 'tableValues', 'type', 'xml:base', 'xml:lang', 'xml:space'],
	  feFuncB: ['amplitude', 'exponent', 'id', 'intercept', 'offset', 'slope', 'tableValues', 'type', 'xml:base', 'xml:lang', 'xml:space'],
	  feFuncG: ['amplitude', 'exponent', 'id', 'intercept', 'offset', 'slope', 'tableValues', 'type', 'xml:base', 'xml:lang', 'xml:space'],
	  feFuncR: ['amplitude', 'exponent', 'id', 'intercept', 'offset', 'slope', 'tableValues', 'type', 'xml:base', 'xml:lang', 'xml:space'],
	  feGaussianBlur: ['class', 'height', 'id', 'in', 'result', 'stdDeviation', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  feImage: ['class', 'externalResourcesRequired', 'height', 'id', 'preserveAspectRatio', 'result', 'style', 'width', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  feMerge: ['class', 'height', 'id', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  feMergeNode: ['id', 'xml:base', 'xml:lang', 'xml:space'],
	  feMorphology: ['class', 'height', 'id', 'in', 'operator', 'radius', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  feOffset: ['class', 'dx', 'dy', 'height', 'id', 'in', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  fePointLight: ['id', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y', 'z'],
	  feSpecularLighting: ['class', 'height', 'id', 'in', 'kernelUnitLength', 'result', 'specularConstant', 'specularExponent', 'style', 'surfaceScale', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  feSpotLight: ['id', 'limitingConeAngle', 'pointsAtX', 'pointsAtY', 'pointsAtZ', 'specularExponent', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y', 'z'],
	  feTile: ['class', 'height', 'id', 'in', 'result', 'style', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  feTurbulence: ['baseFrequency', 'class', 'height', 'id', 'numOctaves', 'result', 'seed', 'stitchTiles', 'style', 'type', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  filter: ['class', 'externalResourcesRequired', 'filterRes', 'filterUnits', 'height', 'id', 'primitiveUnits', 'style', 'width', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  font: ['class', 'externalResourcesRequired', 'horiz-adv-x', 'horiz-origin-x', 'horiz-origin-y', 'id', 'style', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'xml:base', 'xml:lang', 'xml:space'],
	  'font-face': ['accent-height', 'alphabetic', 'ascent', 'bbox', 'cap-height', 'descent', 'font-family', 'font-size', 'font-stretch', 'font-style', 'font-variant', 'font-weight', 'hanging', 'id', 'ideographic', 'mathematical', 'overline-position', 'overline-thickness', 'panose-1', 'slope', 'stemh', 'stemv', 'strikethrough-position', 'strikethrough-thickness', 'underline-position', 'underline-thickness', 'unicode-range', 'units-per-em', 'v-alphabetic', 'v-hanging', 'v-ideographic', 'v-mathematical', 'widths', 'x-height', 'xml:base', 'xml:lang', 'xml:space'],
	  'font-face-format': ['id', 'string', 'xml:base', 'xml:lang', 'xml:space'],
	  'font-face-name': ['id', 'name', 'xml:base', 'xml:lang', 'xml:space'],
	  'font-face-src': ['id', 'xml:base', 'xml:lang', 'xml:space'],
	  'font-face-uri': ['id', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],
	  foreignObject: ['class', 'externalResourcesRequired', 'height', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  g: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],
	  glyph: ['arabic-form', 'class', 'd', 'glyph-name', 'horiz-adv-x', 'id', 'lang', 'orientation', 'style', 'unicode', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'xml:base', 'xml:lang', 'xml:space'],
	  glyphRef: ['class', 'dx', 'dy', 'format', 'glyphRef', 'id', 'style', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  hkern: ['g1', 'g2', 'id', 'k', 'u1', 'u2', 'xml:base', 'xml:lang', 'xml:space'],
	  image: ['class', 'externalResourcesRequired', 'height', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'preserveAspectRatio', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'width', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  line: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'x1', 'x2', 'xml:base', 'xml:lang', 'xml:space', 'y1', 'y2'],
	  linearGradient: ['class', 'externalResourcesRequired', 'gradientTransform', 'gradientUnits', 'id', 'spreadMethod', 'style', 'x1', 'x2', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y1', 'y2'],
	  marker: ['class', 'externalResourcesRequired', 'id', 'markerHeight', 'markerUnits', 'markerWidth', 'orient', 'preserveAspectRatio', 'refX', 'refY', 'style', 'viewBox', 'xml:base', 'xml:lang', 'xml:space'],
	  mask: ['class', 'externalResourcesRequired', 'height', 'id', 'maskContentUnits', 'maskUnits', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  metadata: ['id', 'xml:base', 'xml:lang', 'xml:space'],
	  'missing-glyph': ['class', 'd', 'horiz-adv-x', 'id', 'style', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'xml:base', 'xml:lang', 'xml:space'],
	  mpath: ['externalResourcesRequired', 'id', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],
	  path: ['class', 'd', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'pathLength', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],
	  pattern: ['class', 'externalResourcesRequired', 'height', 'id', 'patternContentUnits', 'patternTransform', 'patternUnits', 'preserveAspectRatio', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'viewBox', 'width', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  polygon: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'points', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],
	  polyline: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'points', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],
	  radialGradient: ['class', 'cx', 'cy', 'externalResourcesRequired', 'fx', 'fy', 'gradientTransform', 'gradientUnits', 'id', 'r', 'spreadMethod', 'style', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],
	  rect: ['class', 'externalResourcesRequired', 'height', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rx', 'ry', 'style', 'systemLanguage', 'transform', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  script: ['externalResourcesRequired', 'id', 'type', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],
	  set: ['attributeName', 'attributeType', 'begin', 'dur', 'end', 'externalResourcesRequired', 'fill', 'id', 'max', 'min', 'onbegin', 'onend', 'onload', 'onrepeat', 'repeatCount', 'repeatDur', 'requiredExtensions', 'requiredFeatures', 'restart', 'systemLanguage', 'to', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],
	  stop: ['class', 'id', 'offset', 'style', 'xml:base', 'xml:lang', 'xml:space'],
	  style: ['id', 'media', 'title', 'type', 'xml:base', 'xml:lang', 'xml:space'],
	  svg: ['baseProfile', 'class', 'contentScriptType', 'contentStyleType', 'externalResourcesRequired', 'height', 'id', 'onabort', 'onactivate', 'onclick', 'onerror', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'onresize', 'onscroll', 'onunload', 'onzoom', 'preserveAspectRatio', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'version', 'viewBox', 'width', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y', 'zoomAndPan'],
	  switch: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'xml:base', 'xml:lang', 'xml:space'],
	  symbol: ['class', 'externalResourcesRequired', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'preserveAspectRatio', 'style', 'viewBox', 'xml:base', 'xml:lang', 'xml:space'],
	  text: ['class', 'dx', 'dy', 'externalResourcesRequired', 'id', 'lengthAdjust', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rotate', 'style', 'systemLanguage', 'textLength', 'transform', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  textPath: ['class', 'externalResourcesRequired', 'id', 'lengthAdjust', 'method', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'spacing', 'startOffset', 'style', 'systemLanguage', 'textLength', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space'],
	  title: ['class', 'id', 'style', 'xml:base', 'xml:lang', 'xml:space'],
	  tref: ['class', 'dx', 'dy', 'externalResourcesRequired', 'id', 'lengthAdjust', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rotate', 'style', 'systemLanguage', 'textLength', 'x', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  tspan: ['class', 'dx', 'dy', 'externalResourcesRequired', 'id', 'lengthAdjust', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'rotate', 'style', 'systemLanguage', 'textLength', 'x', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  use: ['class', 'externalResourcesRequired', 'height', 'id', 'onactivate', 'onclick', 'onfocusin', 'onfocusout', 'onload', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'requiredExtensions', 'requiredFeatures', 'style', 'systemLanguage', 'transform', 'width', 'x', 'xlink:actuate', 'xlink:arcrole', 'xlink:href', 'xlink:role', 'xlink:show', 'xlink:title', 'xlink:type', 'xml:base', 'xml:lang', 'xml:space', 'y'],
	  view: ['externalResourcesRequired', 'id', 'preserveAspectRatio', 'viewBox', 'viewTarget', 'xml:base', 'xml:lang', 'xml:space', 'zoomAndPan'],
	  vkern: ['g1', 'g2', 'id', 'k', 'u1', 'u2', 'xml:base', 'xml:lang', 'xml:space']
	};
	var presentationElements = exports.presentationElements = {
	  'a': true,
	  'altGlyph': true,
	  'animate': true,
	  'animateColor': true,
	  'circle': true,
	  'clipPath': true,
	  'defs': true,
	  'ellipse': true,
	  'feBlend': true,
	  'feColorMatrix': true,
	  'feComponentTransfer': true,
	  'feComposite': true,
	  'feConvolveMatrix': true,
	  'feDiffuseLighting': true,
	  'feDisplacementMap': true,
	  'feFlood': true,
	  'feGaussianBlur': true,
	  'feImage': true,
	  'feMerge': true,
	  'feMorphology': true,
	  'feOffset': true,
	  'feSpecularLighting': true,
	  'feTile': true,
	  'feTurbulence': true,
	  'filter': true,
	  'font': true,
	  'foreignObject': true,
	  'g': true,
	  'glyph': true,
	  'glyphRef': true,
	  'image': true,
	  'line': true,
	  'linearGradient': true,
	  'marker': true,
	  'mask': true,
	  'missing-glyph': true,
	  'path': true,
	  'pattern': true,
	  'polygon': true,
	  'polyline': true,
	  'radialGradient': true,
	  'rect': true,
	  'stop': true,
	  'svg': true,
	  'switch': true,
	  'symbol': true,
	  'text': true,
	  'textPath': true,
	  'tref': true,
	  'tspan': true,
	  'use': true
	};
	
	var presentationAttributes = exports.presentationAttributes = {
	  'alignment-baseline': true,
	  'baseline-shift': true,
	  'clip-path': true,
	  'clip-rule': true,
	  'clip': true,
	  'color-interpolation-filters': true,
	  'color-interpolation': true,
	  'color-profile': true,
	  'color-rendering': true,
	  'color': true,
	  'cursor': true,
	  'direction': true,
	  'display': true,
	  'dominant-baseline': true,
	  'enable-background': true,
	  'fill-opacity': true,
	  'fill-rule': true,
	  'fill': true,
	  'filter': true,
	  'flood-color': true,
	  'flood-opacity': true,
	  'font-family': true,
	  'font-size-adjust': true,
	  'font-size': true,
	  'font-stretch': true,
	  'font-style': true,
	  'font-variant': true,
	  'font-weight': true,
	  'glyph-orientation-horizontal': true,
	  'glyph-orientation-vertical': true,
	  'image-rendering': true,
	  'kerning': true,
	  'letter-spacing': true,
	  'lighting-color': true,
	  'marker-end': true,
	  'marker-mid': true,
	  'marker-start': true,
	  'mask': true,
	  'opacity': true,
	  'overflow': true,
	  'pointer-events': true,
	  'shape-rendering': true,
	  'stop-color': true,
	  'stop-opacity': true,
	  'stroke-dasharray': true,
	  'stroke-dashoffset': true,
	  'stroke-linecap': true,
	  'stroke-linejoin': true,
	  'stroke-miterlimit': true,
	  'stroke-opacity': true,
	  'stroke-width': true,
	  'stroke': true,
	  'text-anchor': true,
	  'text-decoration': true,
	  'text-rendering': true,
	  'unicode-bidi': true,
	  'visibility': true,
	  'word-spacing': true,
	  'writing-mode': true
	};
	
	function createElement(html) {
	  var div = _aureliaPal.DOM.createElement('div');
	  div.innerHTML = html;
	  return div.firstChild;
	}
	
	var SVGAnalyzer = exports.SVGAnalyzer = function () {
	  function SVGAnalyzer() {
	    
	
	    if (createElement('<svg><altGlyph /></svg>').firstElementChild.nodeName === 'altglyph' && elements.altGlyph) {
	      elements.altglyph = elements.altGlyph;
	      delete elements.altGlyph;
	      elements.altglyphdef = elements.altGlyphDef;
	      delete elements.altGlyphDef;
	      elements.altglyphitem = elements.altGlyphItem;
	      delete elements.altGlyphItem;
	      elements.glyphref = elements.glyphRef;
	      delete elements.glyphRef;
	    }
	  }
	
	  SVGAnalyzer.prototype.isStandardSvgAttribute = function isStandardSvgAttribute(nodeName, attributeName) {
	    return presentationElements[nodeName] && presentationAttributes[attributeName] || elements[nodeName] && elements[nodeName].indexOf(attributeName) !== -1;
	  };
	
	  return SVGAnalyzer;
	}();
	
	var ObserverLocator = exports.ObserverLocator = (_temp = _class11 = function () {
	  function ObserverLocator(taskQueue, eventManager, dirtyChecker, svgAnalyzer, parser) {
	    
	
	    this.taskQueue = taskQueue;
	    this.eventManager = eventManager;
	    this.dirtyChecker = dirtyChecker;
	    this.svgAnalyzer = svgAnalyzer;
	    this.parser = parser;
	    this.adapters = [];
	    this.logger = LogManager.getLogger('observer-locator');
	  }
	
	  ObserverLocator.prototype.getObserver = function getObserver(obj, propertyName) {
	    var observersLookup = obj.__observers__;
	    var observer = void 0;
	
	    if (observersLookup && propertyName in observersLookup) {
	      return observersLookup[propertyName];
	    }
	
	    observer = this.createPropertyObserver(obj, propertyName);
	
	    if (!observer.doNotCache) {
	      if (observersLookup === undefined) {
	        observersLookup = this.getOrCreateObserversLookup(obj);
	      }
	
	      observersLookup[propertyName] = observer;
	    }
	
	    return observer;
	  };
	
	  ObserverLocator.prototype.getOrCreateObserversLookup = function getOrCreateObserversLookup(obj) {
	    return obj.__observers__ || this.createObserversLookup(obj);
	  };
	
	  ObserverLocator.prototype.createObserversLookup = function createObserversLookup(obj) {
	    var value = {};
	
	    if (!Reflect.defineProperty(obj, '__observers__', {
	      enumerable: false,
	      configurable: false,
	      writable: false,
	      value: value
	    })) {
	      this.logger.warn('Cannot add observers to object', obj);
	    }
	
	    return value;
	  };
	
	  ObserverLocator.prototype.addAdapter = function addAdapter(adapter) {
	    this.adapters.push(adapter);
	  };
	
	  ObserverLocator.prototype.getAdapterObserver = function getAdapterObserver(obj, propertyName, descriptor) {
	    for (var _i26 = 0, ii = this.adapters.length; _i26 < ii; _i26++) {
	      var adapter = this.adapters[_i26];
	      var observer = adapter.getObserver(obj, propertyName, descriptor);
	      if (observer) {
	        return observer;
	      }
	    }
	    return null;
	  };
	
	  ObserverLocator.prototype.createPropertyObserver = function createPropertyObserver(obj, propertyName) {
	    var descriptor = void 0;
	    var handler = void 0;
	    var xlinkResult = void 0;
	
	    if (!(obj instanceof Object)) {
	      return new PrimitiveObserver(obj, propertyName);
	    }
	
	    if (obj instanceof _aureliaPal.DOM.Element) {
	      if (propertyName === 'class') {
	        return new ClassObserver(obj);
	      }
	      if (propertyName === 'style' || propertyName === 'css') {
	        return new StyleObserver(obj, propertyName);
	      }
	      handler = this.eventManager.getElementHandler(obj, propertyName);
	      if (propertyName === 'value' && obj.tagName.toLowerCase() === 'select') {
	        return new SelectValueObserver(obj, handler, this);
	      }
	      if (propertyName === 'checked' && obj.tagName.toLowerCase() === 'input') {
	        return new CheckedObserver(obj, handler, this);
	      }
	      if (handler) {
	        return new ValueAttributeObserver(obj, propertyName, handler);
	      }
	      xlinkResult = /^xlink:(.+)$/.exec(propertyName);
	      if (xlinkResult) {
	        return new XLinkAttributeObserver(obj, propertyName, xlinkResult[1]);
	      }
	      if (/^\w+:|^data-|^aria-/.test(propertyName) || obj instanceof _aureliaPal.DOM.SVGElement && this.svgAnalyzer.isStandardSvgAttribute(obj.nodeName, propertyName)) {
	        return new DataAttributeObserver(obj, propertyName);
	      }
	    }
	
	    descriptor = Object.getPropertyDescriptor(obj, propertyName);
	
	    if (hasDeclaredDependencies(descriptor)) {
	      return createComputedObserver(obj, propertyName, descriptor, this);
	    }
	
	    var existingGetterOrSetter = void 0;
	    if (descriptor && (existingGetterOrSetter = descriptor.get || descriptor.set)) {
	      if (existingGetterOrSetter.getObserver) {
	        return existingGetterOrSetter.getObserver(obj);
	      }
	
	      var adapterObserver = this.getAdapterObserver(obj, propertyName, descriptor);
	      if (adapterObserver) {
	        return adapterObserver;
	      }
	      return new DirtyCheckProperty(this.dirtyChecker, obj, propertyName);
	    }
	
	    if (obj instanceof Array) {
	      if (propertyName === 'length') {
	        return this.getArrayObserver(obj).getLengthObserver();
	      }
	
	      return new DirtyCheckProperty(this.dirtyChecker, obj, propertyName);
	    } else if (obj instanceof Map) {
	      if (propertyName === 'size') {
	        return this.getMapObserver(obj).getLengthObserver();
	      }
	
	      return new DirtyCheckProperty(this.dirtyChecker, obj, propertyName);
	    } else if (obj instanceof Set) {
	      if (propertyName === 'size') {
	        return this.getSetObserver(obj).getLengthObserver();
	      }
	
	      return new DirtyCheckProperty(this.dirtyChecker, obj, propertyName);
	    }
	
	    return new SetterObserver(this.taskQueue, obj, propertyName);
	  };
	
	  ObserverLocator.prototype.getAccessor = function getAccessor(obj, propertyName) {
	    if (obj instanceof _aureliaPal.DOM.Element) {
	      if (propertyName === 'class' || propertyName === 'style' || propertyName === 'css' || propertyName === 'value' && (obj.tagName.toLowerCase() === 'input' || obj.tagName.toLowerCase() === 'select') || propertyName === 'checked' && obj.tagName.toLowerCase() === 'input' || propertyName === 'model' && obj.tagName.toLowerCase() === 'input' || /^xlink:.+$/.exec(propertyName)) {
	        return this.getObserver(obj, propertyName);
	      }
	      if (/^\w+:|^data-|^aria-/.test(propertyName) || obj instanceof _aureliaPal.DOM.SVGElement && this.svgAnalyzer.isStandardSvgAttribute(obj.nodeName, propertyName)) {
	        return dataAttributeAccessor;
	      }
	    }
	    return propertyAccessor;
	  };
	
	  ObserverLocator.prototype.getArrayObserver = function getArrayObserver(array) {
	    return _getArrayObserver(this.taskQueue, array);
	  };
	
	  ObserverLocator.prototype.getMapObserver = function getMapObserver(map) {
	    return _getMapObserver(this.taskQueue, map);
	  };
	
	  ObserverLocator.prototype.getSetObserver = function getSetObserver(set) {
	    return _getSetObserver(this.taskQueue, set);
	  };
	
	  return ObserverLocator;
	}(), _class11.inject = [_aureliaTaskQueue.TaskQueue, EventManager, DirtyChecker, SVGAnalyzer, Parser], _temp);
	
	var ObjectObservationAdapter = exports.ObjectObservationAdapter = function () {
	  function ObjectObservationAdapter() {
	    
	  }
	
	  ObjectObservationAdapter.prototype.getObserver = function getObserver(object, propertyName, descriptor) {
	    throw new Error('BindingAdapters must implement getObserver(object, propertyName).');
	  };
	
	  return ObjectObservationAdapter;
	}();
	
	var BindingExpression = exports.BindingExpression = function () {
	  function BindingExpression(observerLocator, targetProperty, sourceExpression, mode, lookupFunctions, attribute) {
	    
	
	    this.observerLocator = observerLocator;
	    this.targetProperty = targetProperty;
	    this.sourceExpression = sourceExpression;
	    this.mode = mode;
	    this.lookupFunctions = lookupFunctions;
	    this.attribute = attribute;
	    this.discrete = false;
	  }
	
	  BindingExpression.prototype.createBinding = function createBinding(target) {
	    return new Binding(this.observerLocator, this.sourceExpression, target, this.targetProperty, this.mode, this.lookupFunctions);
	  };
	
	  return BindingExpression;
	}();
	
	var targetContext = 'Binding:target';
	
	var Binding = exports.Binding = (_dec10 = connectable(), _dec10(_class12 = function () {
	  function Binding(observerLocator, sourceExpression, target, targetProperty, mode, lookupFunctions) {
	    
	
	    this.observerLocator = observerLocator;
	    this.sourceExpression = sourceExpression;
	    this.target = target;
	    this.targetProperty = targetProperty;
	    this.mode = mode;
	    this.lookupFunctions = lookupFunctions;
	  }
	
	  Binding.prototype.updateTarget = function updateTarget(value) {
	    this.targetObserver.setValue(value, this.target, this.targetProperty);
	  };
	
	  Binding.prototype.updateSource = function updateSource(value) {
	    this.sourceExpression.assign(this.source, value, this.lookupFunctions);
	  };
	
	  Binding.prototype.call = function call(context, newValue, oldValue) {
	    if (!this.isBound) {
	      return;
	    }
	    if (context === sourceContext) {
	      oldValue = this.targetObserver.getValue(this.target, this.targetProperty);
	      newValue = this.sourceExpression.evaluate(this.source, this.lookupFunctions);
	      if (newValue !== oldValue) {
	        this.updateTarget(newValue);
	      }
	      if (this.mode !== bindingMode.oneTime) {
	        this._version++;
	        this.sourceExpression.connect(this, this.source);
	        this.unobserve(false);
	      }
	      return;
	    }
	    if (context === targetContext) {
	      if (newValue !== this.sourceExpression.evaluate(this.source, this.lookupFunctions)) {
	        this.updateSource(newValue);
	      }
	      return;
	    }
	    throw new Error('Unexpected call context ' + context);
	  };
	
	  Binding.prototype.bind = function bind(source) {
	    if (this.isBound) {
	      if (this.source === source) {
	        return;
	      }
	      this.unbind();
	    }
	    this.isBound = true;
	    this.source = source;
	
	    if (this.sourceExpression.bind) {
	      this.sourceExpression.bind(this, source, this.lookupFunctions);
	    }
	
	    var mode = this.mode;
	    if (!this.targetObserver) {
	      var method = mode === bindingMode.twoWay ? 'getObserver' : 'getAccessor';
	      this.targetObserver = this.observerLocator[method](this.target, this.targetProperty);
	    }
	
	    if ('bind' in this.targetObserver) {
	      this.targetObserver.bind();
	    }
	    var value = this.sourceExpression.evaluate(source, this.lookupFunctions);
	    this.updateTarget(value);
	
	    if (mode === bindingMode.oneWay) {
	      enqueueBindingConnect(this);
	    } else if (mode === bindingMode.twoWay) {
	      this.sourceExpression.connect(this, source);
	      this.targetObserver.subscribe(targetContext, this);
	    }
	  };
	
	  Binding.prototype.unbind = function unbind() {
	    if (!this.isBound) {
	      return;
	    }
	    this.isBound = false;
	    if (this.sourceExpression.unbind) {
	      this.sourceExpression.unbind(this, this.source);
	    }
	    this.source = null;
	    if ('unbind' in this.targetObserver) {
	      this.targetObserver.unbind();
	    }
	    if (this.targetObserver.unsubscribe) {
	      this.targetObserver.unsubscribe(targetContext, this);
	    }
	    this.unobserve(true);
	  };
	
	  Binding.prototype.connect = function connect(evaluate) {
	    if (!this.isBound) {
	      return;
	    }
	    if (evaluate) {
	      var value = this.sourceExpression.evaluate(this.source, this.lookupFunctions);
	      this.updateTarget(value);
	    }
	    this.sourceExpression.connect(this, this.source);
	  };
	
	  return Binding;
	}()) || _class12);
	
	var CallExpression = exports.CallExpression = function () {
	  function CallExpression(observerLocator, targetProperty, sourceExpression, lookupFunctions) {
	    
	
	    this.observerLocator = observerLocator;
	    this.targetProperty = targetProperty;
	    this.sourceExpression = sourceExpression;
	    this.lookupFunctions = lookupFunctions;
	  }
	
	  CallExpression.prototype.createBinding = function createBinding(target) {
	    return new Call(this.observerLocator, this.sourceExpression, target, this.targetProperty, this.lookupFunctions);
	  };
	
	  return CallExpression;
	}();
	
	var Call = exports.Call = function () {
	  function Call(observerLocator, sourceExpression, target, targetProperty, lookupFunctions) {
	    
	
	    this.sourceExpression = sourceExpression;
	    this.target = target;
	    this.targetProperty = observerLocator.getObserver(target, targetProperty);
	    this.lookupFunctions = lookupFunctions;
	  }
	
	  Call.prototype.callSource = function callSource($event) {
	    var overrideContext = this.source.overrideContext;
	    Object.assign(overrideContext, $event);
	    overrideContext.$event = $event;
	    var mustEvaluate = true;
	    var result = this.sourceExpression.evaluate(this.source, this.lookupFunctions, mustEvaluate);
	    delete overrideContext.$event;
	    for (var prop in $event) {
	      delete overrideContext[prop];
	    }
	    return result;
	  };
	
	  Call.prototype.bind = function bind(source) {
	    var _this27 = this;
	
	    if (this.isBound) {
	      if (this.source === source) {
	        return;
	      }
	      this.unbind();
	    }
	    this.isBound = true;
	    this.source = source;
	
	    if (this.sourceExpression.bind) {
	      this.sourceExpression.bind(this, source, this.lookupFunctions);
	    }
	    this.targetProperty.setValue(function ($event) {
	      return _this27.callSource($event);
	    });
	  };
	
	  Call.prototype.unbind = function unbind() {
	    if (!this.isBound) {
	      return;
	    }
	    this.isBound = false;
	    if (this.sourceExpression.unbind) {
	      this.sourceExpression.unbind(this, this.source);
	    }
	    this.source = null;
	    this.targetProperty.setValue(null);
	  };
	
	  return Call;
	}();
	
	var ValueConverterResource = exports.ValueConverterResource = function () {
	  function ValueConverterResource(name) {
	    
	
	    this.name = name;
	  }
	
	  ValueConverterResource.convention = function convention(name) {
	    if (name.endsWith('ValueConverter')) {
	      return new ValueConverterResource(camelCase(name.substring(0, name.length - 14)));
	    }
	  };
	
	  ValueConverterResource.prototype.initialize = function initialize(container, target) {
	    this.instance = container.get(target);
	  };
	
	  ValueConverterResource.prototype.register = function register(registry, name) {
	    registry.registerValueConverter(name || this.name, this.instance);
	  };
	
	  ValueConverterResource.prototype.load = function load(container, target) {};
	
	  return ValueConverterResource;
	}();
	
	function valueConverter(nameOrTarget) {
	  if (nameOrTarget === undefined || typeof nameOrTarget === 'string') {
	    return function (target) {
	      _aureliaMetadata.metadata.define(_aureliaMetadata.metadata.resource, new ValueConverterResource(nameOrTarget), target);
	    };
	  }
	
	  _aureliaMetadata.metadata.define(_aureliaMetadata.metadata.resource, new ValueConverterResource(), nameOrTarget);
	}
	
	var BindingBehaviorResource = exports.BindingBehaviorResource = function () {
	  function BindingBehaviorResource(name) {
	    
	
	    this.name = name;
	  }
	
	  BindingBehaviorResource.convention = function convention(name) {
	    if (name.endsWith('BindingBehavior')) {
	      return new BindingBehaviorResource(camelCase(name.substring(0, name.length - 15)));
	    }
	  };
	
	  BindingBehaviorResource.prototype.initialize = function initialize(container, target) {
	    this.instance = container.get(target);
	  };
	
	  BindingBehaviorResource.prototype.register = function register(registry, name) {
	    registry.registerBindingBehavior(name || this.name, this.instance);
	  };
	
	  BindingBehaviorResource.prototype.load = function load(container, target) {};
	
	  return BindingBehaviorResource;
	}();
	
	function bindingBehavior(nameOrTarget) {
	  if (nameOrTarget === undefined || typeof nameOrTarget === 'string') {
	    return function (target) {
	      _aureliaMetadata.metadata.define(_aureliaMetadata.metadata.resource, new BindingBehaviorResource(nameOrTarget), target);
	    };
	  }
	
	  _aureliaMetadata.metadata.define(_aureliaMetadata.metadata.resource, new BindingBehaviorResource(), nameOrTarget);
	}
	
	var ListenerExpression = exports.ListenerExpression = function () {
	  function ListenerExpression(eventManager, targetEvent, sourceExpression, delegate, preventDefault, lookupFunctions) {
	    
	
	    this.eventManager = eventManager;
	    this.targetEvent = targetEvent;
	    this.sourceExpression = sourceExpression;
	    this.delegate = delegate;
	    this.discrete = true;
	    this.preventDefault = preventDefault;
	    this.lookupFunctions = lookupFunctions;
	  }
	
	  ListenerExpression.prototype.createBinding = function createBinding(target) {
	    return new Listener(this.eventManager, this.targetEvent, this.delegate, this.sourceExpression, target, this.preventDefault, this.lookupFunctions);
	  };
	
	  return ListenerExpression;
	}();
	
	var Listener = exports.Listener = function () {
	  function Listener(eventManager, targetEvent, delegate, sourceExpression, target, preventDefault, lookupFunctions) {
	    
	
	    this.eventManager = eventManager;
	    this.targetEvent = targetEvent;
	    this.delegate = delegate;
	    this.sourceExpression = sourceExpression;
	    this.target = target;
	    this.preventDefault = preventDefault;
	    this.lookupFunctions = lookupFunctions;
	  }
	
	  Listener.prototype.callSource = function callSource(event) {
	    var overrideContext = this.source.overrideContext;
	    overrideContext.$event = event;
	    var mustEvaluate = true;
	    var result = this.sourceExpression.evaluate(this.source, this.lookupFunctions, mustEvaluate);
	    delete overrideContext.$event;
	    if (result !== true && this.preventDefault) {
	      event.preventDefault();
	    }
	    return result;
	  };
	
	  Listener.prototype.bind = function bind(source) {
	    var _this28 = this;
	
	    if (this.isBound) {
	      if (this.source === source) {
	        return;
	      }
	      this.unbind();
	    }
	    this.isBound = true;
	    this.source = source;
	
	    if (this.sourceExpression.bind) {
	      this.sourceExpression.bind(this, source, this.lookupFunctions);
	    }
	    this._disposeListener = this.eventManager.addEventListener(this.target, this.targetEvent, function (event) {
	      return _this28.callSource(event);
	    }, this.delegate);
	  };
	
	  Listener.prototype.unbind = function unbind() {
	    if (!this.isBound) {
	      return;
	    }
	    this.isBound = false;
	    if (this.sourceExpression.unbind) {
	      this.sourceExpression.unbind(this, this.source);
	    }
	    this.source = null;
	    this._disposeListener();
	    this._disposeListener = null;
	  };
	
	  return Listener;
	}();
	
	function getAU(element) {
	  var au = element.au;
	
	  if (au === undefined) {
	    throw new Error('No Aurelia APIs are defined for the referenced element.');
	  }
	
	  return au;
	}
	
	var NameExpression = exports.NameExpression = function () {
	  function NameExpression(sourceExpression, apiName, lookupFunctions) {
	    
	
	    this.sourceExpression = sourceExpression;
	    this.apiName = apiName;
	    this.lookupFunctions = lookupFunctions;
	    this.discrete = true;
	  }
	
	  NameExpression.prototype.createBinding = function createBinding(target) {
	    return new NameBinder(this.sourceExpression, NameExpression.locateAPI(target, this.apiName), this.lookupFunctions);
	  };
	
	  NameExpression.locateAPI = function locateAPI(element, apiName) {
	    switch (apiName) {
	      case 'element':
	        return element;
	      case 'controller':
	        return getAU(element).controller;
	      case 'view-model':
	        return getAU(element).controller.viewModel;
	      case 'view':
	        return getAU(element).controller.view;
	      default:
	        var target = getAU(element)[apiName];
	
	        if (target === undefined) {
	          throw new Error('Attempted to reference "' + apiName + '", but it was not found amongst the target\'s API.');
	        }
	
	        return target.viewModel;
	    }
	  };
	
	  return NameExpression;
	}();
	
	var NameBinder = function () {
	  function NameBinder(sourceExpression, target, lookupFunctions) {
	    
	
	    this.sourceExpression = sourceExpression;
	    this.target = target;
	    this.lookupFunctions = lookupFunctions;
	  }
	
	  NameBinder.prototype.bind = function bind(source) {
	    if (this.isBound) {
	      if (this.source === source) {
	        return;
	      }
	      this.unbind();
	    }
	    this.isBound = true;
	    this.source = source;
	    if (this.sourceExpression.bind) {
	      this.sourceExpression.bind(this, source, this.lookupFunctions);
	    }
	    this.sourceExpression.assign(this.source, this.target, this.lookupFunctions);
	  };
	
	  NameBinder.prototype.unbind = function unbind() {
	    if (!this.isBound) {
	      return;
	    }
	    this.isBound = false;
	    this.sourceExpression.assign(this.source, null, this.lookupFunctions);
	    if (this.sourceExpression.unbind) {
	      this.sourceExpression.unbind(this, this.source);
	    }
	    this.source = null;
	  };
	
	  return NameBinder;
	}();
	
	var LookupFunctions = {
	  bindingBehaviors: function bindingBehaviors(name) {
	    return null;
	  },
	  valueConverters: function valueConverters(name) {
	    return null;
	  }
	};
	
	var BindingEngine = exports.BindingEngine = (_temp2 = _class13 = function () {
	  function BindingEngine(observerLocator, parser) {
	    
	
	    this.observerLocator = observerLocator;
	    this.parser = parser;
	  }
	
	  BindingEngine.prototype.createBindingExpression = function createBindingExpression(targetProperty, sourceExpression) {
	    var mode = arguments.length <= 2 || arguments[2] === undefined ? bindingMode.oneWay : arguments[2];
	    var lookupFunctions = arguments.length <= 3 || arguments[3] === undefined ? LookupFunctions : arguments[3];
	
	    return new BindingExpression(this.observerLocator, targetProperty, this.parser.parse(sourceExpression), mode, lookupFunctions);
	  };
	
	  BindingEngine.prototype.propertyObserver = function propertyObserver(obj, propertyName) {
	    var _this29 = this;
	
	    return {
	      subscribe: function subscribe(callback) {
	        var observer = _this29.observerLocator.getObserver(obj, propertyName);
	        observer.subscribe(callback);
	        return {
	          dispose: function dispose() {
	            return observer.unsubscribe(callback);
	          }
	        };
	      }
	    };
	  };
	
	  BindingEngine.prototype.collectionObserver = function collectionObserver(collection) {
	    var _this30 = this;
	
	    return {
	      subscribe: function subscribe(callback) {
	        var observer = void 0;
	        if (collection instanceof Array) {
	          observer = _this30.observerLocator.getArrayObserver(collection);
	        } else if (collection instanceof Map) {
	          observer = _this30.observerLocator.getMapObserver(collection);
	        } else if (collection instanceof Set) {
	          observer = _this30.observerLocator.getSetObserver(collection);
	        } else {
	          throw new Error('collection must be an instance of Array, Map or Set.');
	        }
	        observer.subscribe(callback);
	        return {
	          dispose: function dispose() {
	            return observer.unsubscribe(callback);
	          }
	        };
	      }
	    };
	  };
	
	  BindingEngine.prototype.expressionObserver = function expressionObserver(bindingContext, expression) {
	    var scope = { bindingContext: bindingContext, overrideContext: createOverrideContext(bindingContext) };
	    return new ExpressionObserver(scope, this.parser.parse(expression), this.observerLocator, LookupFunctions);
	  };
	
	  BindingEngine.prototype.parseExpression = function parseExpression(expression) {
	    return this.parser.parse(expression);
	  };
	
	  BindingEngine.prototype.registerAdapter = function registerAdapter(adapter) {
	    this.observerLocator.addAdapter(adapter);
	  };
	
	  return BindingEngine;
	}(), _class13.inject = [ObserverLocator, Parser], _temp2);
	
	
	var setProto = Set.prototype;
	
	function _getSetObserver(taskQueue, set) {
	  return ModifySetObserver.for(taskQueue, set);
	}
	
	exports.getSetObserver = _getSetObserver;
	
	var ModifySetObserver = function (_ModifyCollectionObse3) {
	  _inherits(ModifySetObserver, _ModifyCollectionObse3);
	
	  function ModifySetObserver(taskQueue, set) {
	    
	
	    return _possibleConstructorReturn(this, _ModifyCollectionObse3.call(this, taskQueue, set));
	  }
	
	  ModifySetObserver.for = function _for(taskQueue, set) {
	    if (!('__set_observer__' in set)) {
	      var observer = ModifySetObserver.create(taskQueue, set);
	      Reflect.defineProperty(set, '__set_observer__', { value: observer, enumerable: false, configurable: false });
	    }
	    return set.__set_observer__;
	  };
	
	  ModifySetObserver.create = function create(taskQueue, set) {
	    var observer = new ModifySetObserver(taskQueue, set);
	
	    var proto = setProto;
	    if (proto.add !== set.add || proto.delete !== set.delete || proto.clear !== set.clear) {
	      proto = {
	        add: set.add,
	        delete: set.delete,
	        clear: set.clear
	      };
	    }
	
	    set.add = function () {
	      var type = 'add';
	      var oldSize = set.size;
	      var methodCallResult = proto.add.apply(set, arguments);
	      var hasValue = set.size === oldSize;
	      if (!hasValue) {
	        observer.addChangeRecord({
	          type: type,
	          object: set,
	          value: Array.from(set).pop()
	        });
	      }
	      return methodCallResult;
	    };
	
	    set.delete = function () {
	      var hasValue = set.has(arguments[0]);
	      var methodCallResult = proto.delete.apply(set, arguments);
	      if (hasValue) {
	        observer.addChangeRecord({
	          type: 'delete',
	          object: set,
	          value: arguments[0]
	        });
	      }
	      return methodCallResult;
	    };
	
	    set.clear = function () {
	      var methodCallResult = proto.clear.apply(set, arguments);
	      observer.addChangeRecord({
	        type: 'clear',
	        object: set
	      });
	      return methodCallResult;
	    };
	
	    return observer;
	  };
	
	  return ModifySetObserver;
	}(ModifyCollectionObserver);
	
	function observable(targetOrConfig, key, descriptor) {
	  var deco = function deco(target, key2, descriptor2) {
	    var innerPropertyName = '_' + key2;
	    var callbackName = targetOrConfig && targetOrConfig.changeHandler || key2 + 'Changed';
	
	    var babel = descriptor2 !== undefined;
	
	    if (babel) {
	      if (typeof descriptor2.initializer === 'function') {
	        target[innerPropertyName] = descriptor2.initializer();
	      }
	    } else {
	      descriptor2 = {};
	    }
	
	    delete descriptor2.writable;
	    delete descriptor2.initializer;
	
	    descriptor2.get = function () {
	      return this[innerPropertyName];
	    };
	    descriptor2.set = function (newValue) {
	      var oldValue = this[innerPropertyName];
	      this[innerPropertyName] = newValue;
	      if (this[callbackName]) {
	        this[callbackName](newValue, oldValue);
	      }
	    };
	
	    descriptor2.get.dependencies = [innerPropertyName];
	
	    if (!babel) {
	      Reflect.defineProperty(target, key2, descriptor2);
	    }
	  };
	
	  if (key) {
	    var target = targetOrConfig;
	    targetOrConfig = null;
	    return deco(target, key, descriptor);
	  }
	
	  return deco;
	}

/***/ },
/* 21 */
/***/ function(module, exports, __webpack_require__) {

	/* WEBPACK VAR INJECTION */(function(setImmediate) {'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.TaskQueue = undefined;
	
	var _aureliaPal = __webpack_require__(4);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var hasSetImmediate = typeof setImmediate === 'function';
	
	function makeRequestFlushFromMutationObserver(flush) {
	  var toggle = 1;
	  var observer = _aureliaPal.DOM.createMutationObserver(flush);
	  var node = _aureliaPal.DOM.createTextNode('');
	  observer.observe(node, { characterData: true });
	  return function requestFlush() {
	    toggle = -toggle;
	    node.data = toggle;
	  };
	}
	
	function makeRequestFlushFromTimer(flush) {
	  return function requestFlush() {
	    var timeoutHandle = setTimeout(handleFlushTimer, 0);
	
	    var intervalHandle = setInterval(handleFlushTimer, 50);
	    function handleFlushTimer() {
	      clearTimeout(timeoutHandle);
	      clearInterval(intervalHandle);
	      flush();
	    }
	  };
	}
	
	function onError(error, task) {
	  if ('onError' in task) {
	    task.onError(error);
	  } else if (hasSetImmediate) {
	    setImmediate(function () {
	      throw error;
	    });
	  } else {
	    setTimeout(function () {
	      throw error;
	    }, 0);
	  }
	}
	
	var TaskQueue = exports.TaskQueue = function () {
	  function TaskQueue() {
	    var _this = this;
	
	    _classCallCheck(this, TaskQueue);
	
	    this.microTaskQueue = [];
	    this.microTaskQueueCapacity = 1024;
	    this.taskQueue = [];
	
	    if (_aureliaPal.FEATURE.mutationObserver) {
	      this.requestFlushMicroTaskQueue = makeRequestFlushFromMutationObserver(function () {
	        return _this.flushMicroTaskQueue();
	      });
	    } else {
	      this.requestFlushMicroTaskQueue = makeRequestFlushFromTimer(function () {
	        return _this.flushMicroTaskQueue();
	      });
	    }
	
	    this.requestFlushTaskQueue = makeRequestFlushFromTimer(function () {
	      return _this.flushTaskQueue();
	    });
	  }
	
	  TaskQueue.prototype.queueMicroTask = function queueMicroTask(task) {
	    if (this.microTaskQueue.length < 1) {
	      this.requestFlushMicroTaskQueue();
	    }
	
	    this.microTaskQueue.push(task);
	  };
	
	  TaskQueue.prototype.queueTask = function queueTask(task) {
	    if (this.taskQueue.length < 1) {
	      this.requestFlushTaskQueue();
	    }
	
	    this.taskQueue.push(task);
	  };
	
	  TaskQueue.prototype.flushTaskQueue = function flushTaskQueue() {
	    var queue = this.taskQueue;
	    var index = 0;
	    var task = void 0;
	
	    this.taskQueue = [];
	
	    try {
	      while (index < queue.length) {
	        task = queue[index];
	        task.call();
	        index++;
	      }
	    } catch (error) {
	      onError(error, task);
	    }
	  };
	
	  TaskQueue.prototype.flushMicroTaskQueue = function flushMicroTaskQueue() {
	    var queue = this.microTaskQueue;
	    var capacity = this.microTaskQueueCapacity;
	    var index = 0;
	    var task = void 0;
	
	    try {
	      while (index < queue.length) {
	        task = queue[index];
	        task.call();
	        index++;
	
	        if (index > capacity) {
	          for (var scan = 0, newLength = queue.length - index; scan < newLength; scan++) {
	            queue[scan] = queue[scan + index];
	          }
	
	          queue.length -= index;
	          index = 0;
	        }
	      }
	    } catch (error) {
	      onError(error, task);
	    }
	
	    queue.length = 0;
	  };
	
	  return TaskQueue;
	}();
	/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(22).setImmediate))

/***/ },
/* 22 */
/***/ function(module, exports, __webpack_require__) {

	/* WEBPACK VAR INJECTION */(function(setImmediate, clearImmediate) {var nextTick = __webpack_require__(23).nextTick;
	var apply = Function.prototype.apply;
	var slice = Array.prototype.slice;
	var immediateIds = {};
	var nextImmediateId = 0;
	
	// DOM APIs, for completeness
	
	exports.setTimeout = function() {
	  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);
	};
	exports.setInterval = function() {
	  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);
	};
	exports.clearTimeout =
	exports.clearInterval = function(timeout) { timeout.close(); };
	
	function Timeout(id, clearFn) {
	  this._id = id;
	  this._clearFn = clearFn;
	}
	Timeout.prototype.unref = Timeout.prototype.ref = function() {};
	Timeout.prototype.close = function() {
	  this._clearFn.call(window, this._id);
	};
	
	// Does not start the time, just sets up the members needed.
	exports.enroll = function(item, msecs) {
	  clearTimeout(item._idleTimeoutId);
	  item._idleTimeout = msecs;
	};
	
	exports.unenroll = function(item) {
	  clearTimeout(item._idleTimeoutId);
	  item._idleTimeout = -1;
	};
	
	exports._unrefActive = exports.active = function(item) {
	  clearTimeout(item._idleTimeoutId);
	
	  var msecs = item._idleTimeout;
	  if (msecs >= 0) {
	    item._idleTimeoutId = setTimeout(function onTimeout() {
	      if (item._onTimeout)
	        item._onTimeout();
	    }, msecs);
	  }
	};
	
	// That's not how node.js implements it but the exposed api is the same.
	exports.setImmediate = typeof setImmediate === "function" ? setImmediate : function(fn) {
	  var id = nextImmediateId++;
	  var args = arguments.length < 2 ? false : slice.call(arguments, 1);
	
	  immediateIds[id] = true;
	
	  nextTick(function onNextTick() {
	    if (immediateIds[id]) {
	      // fn.call() is faster so we optimize for the common use-case
	      // @see http://jsperf.com/call-apply-segu
	      if (args) {
	        fn.apply(null, args);
	      } else {
	        fn.call(null);
	      }
	      // Prevent ids from leaking
	      exports.clearImmediate(id);
	    }
	  });
	
	  return id;
	};
	
	exports.clearImmediate = typeof clearImmediate === "function" ? clearImmediate : function(id) {
	  delete immediateIds[id];
	};
	/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(22).setImmediate, __webpack_require__(22).clearImmediate))

/***/ },
/* 23 */
/***/ function(module, exports) {

	// shim for using process in browser
	
	var process = module.exports = {};
	var queue = [];
	var draining = false;
	var currentQueue;
	var queueIndex = -1;
	
	function cleanUpNextTick() {
	    if (!draining || !currentQueue) {
	        return;
	    }
	    draining = false;
	    if (currentQueue.length) {
	        queue = currentQueue.concat(queue);
	    } else {
	        queueIndex = -1;
	    }
	    if (queue.length) {
	        drainQueue();
	    }
	}
	
	function drainQueue() {
	    if (draining) {
	        return;
	    }
	    var timeout = setTimeout(cleanUpNextTick);
	    draining = true;
	
	    var len = queue.length;
	    while(len) {
	        currentQueue = queue;
	        queue = [];
	        while (++queueIndex < len) {
	            if (currentQueue) {
	                currentQueue[queueIndex].run();
	            }
	        }
	        queueIndex = -1;
	        len = queue.length;
	    }
	    currentQueue = null;
	    draining = false;
	    clearTimeout(timeout);
	}
	
	process.nextTick = function (fun) {
	    var args = new Array(arguments.length - 1);
	    if (arguments.length > 1) {
	        for (var i = 1; i < arguments.length; i++) {
	            args[i - 1] = arguments[i];
	        }
	    }
	    queue.push(new Item(fun, args));
	    if (queue.length === 1 && !draining) {
	        setTimeout(drainQueue, 0);
	    }
	};
	
	// v8 likes predictible objects
	function Item(fun, array) {
	    this.fun = fun;
	    this.array = array;
	}
	Item.prototype.run = function () {
	    this.fun.apply(null, this.array);
	};
	process.title = 'browser';
	process.browser = true;
	process.env = {};
	process.argv = [];
	process.version = ''; // empty string to avoid regexp issues
	process.versions = {};
	
	function noop() {}
	
	process.on = noop;
	process.addListener = noop;
	process.once = noop;
	process.off = noop;
	process.removeListener = noop;
	process.removeAllListeners = noop;
	process.emit = noop;
	
	process.binding = function (name) {
	    throw new Error('process.binding is not supported');
	};
	
	process.cwd = function () { return '/' };
	process.chdir = function (dir) {
	    throw new Error('process.chdir is not supported');
	};
	process.umask = function() { return 0; };


/***/ },
/* 24 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.TemplatingEngine = exports.ElementConfigResource = exports.CompositionEngine = exports.HtmlBehaviorResource = exports.BindableProperty = exports.BehaviorPropertyObserver = exports.Controller = exports.ViewEngine = exports.ModuleAnalyzer = exports.ResourceDescription = exports.ResourceModule = exports.ViewCompiler = exports.ViewFactory = exports.BoundViewFactory = exports.ViewSlot = exports._ContentSelector = exports.View = exports.ViewResources = exports.BindingLanguage = exports.ViewLocator = exports.InlineViewStrategy = exports.TemplateRegistryViewStrategy = exports.NoViewStrategy = exports.ConventionalViewStrategy = exports.RelativeViewStrategy = exports.viewStrategy = exports.TargetInstruction = exports.BehaviorInstruction = exports.ViewCompileInstruction = exports.ResourceLoadContext = exports.ElementEvents = exports.CompositionTransaction = exports.Animator = exports.animationEvent = undefined;
	
	var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();
	
	var _class3, _temp, _dec, _class4, _dec2, _class5, _dec3, _class6, _dec4, _class7, _dec5, _class8, _class9, _temp2, _class11, _dec6, _class13, _dec7, _class14, _dec8, _class16, _dec9, _class17, _dec10, _class18;
	
	var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol ? "symbol" : typeof obj; };
	
	exports._hyphenate = _hyphenate;
	exports.children = children;
	exports.child = child;
	exports.resource = resource;
	exports.behavior = behavior;
	exports.customElement = customElement;
	exports.customAttribute = customAttribute;
	exports.templateController = templateController;
	exports.bindable = bindable;
	exports.dynamicOptions = dynamicOptions;
	exports.useShadowDOM = useShadowDOM;
	exports.processAttributes = processAttributes;
	exports.processContent = processContent;
	exports.containerless = containerless;
	exports.useViewStrategy = useViewStrategy;
	exports.useView = useView;
	exports.inlineView = inlineView;
	exports.noView = noView;
	exports.elementConfig = elementConfig;
	
	var _aureliaLogging = __webpack_require__(14);
	
	var LogManager = _interopRequireWildcard(_aureliaLogging);
	
	var _aureliaPal = __webpack_require__(4);
	
	var _aureliaMetadata = __webpack_require__(7);
	
	var _aureliaPath = __webpack_require__(9);
	
	var _aureliaLoader = __webpack_require__(8);
	
	var _aureliaBinding = __webpack_require__(20);
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	var _aureliaTaskQueue = __webpack_require__(21);
	
	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var animationEvent = exports.animationEvent = {
	  enterBegin: 'animation:enter:begin',
	  enterActive: 'animation:enter:active',
	  enterDone: 'animation:enter:done',
	  enterTimeout: 'animation:enter:timeout',
	
	  leaveBegin: 'animation:leave:begin',
	  leaveActive: 'animation:leave:active',
	  leaveDone: 'animation:leave:done',
	  leaveTimeout: 'animation:leave:timeout',
	
	  staggerNext: 'animation:stagger:next',
	
	  removeClassBegin: 'animation:remove-class:begin',
	  removeClassActive: 'animation:remove-class:active',
	  removeClassDone: 'animation:remove-class:done',
	  removeClassTimeout: 'animation:remove-class:timeout',
	
	  addClassBegin: 'animation:add-class:begin',
	  addClassActive: 'animation:add-class:active',
	  addClassDone: 'animation:add-class:done',
	  addClassTimeout: 'animation:add-class:timeout',
	
	  animateBegin: 'animation:animate:begin',
	  animateActive: 'animation:animate:active',
	  animateDone: 'animation:animate:done',
	  animateTimeout: 'animation:animate:timeout',
	
	  sequenceBegin: 'animation:sequence:begin',
	  sequenceDone: 'animation:sequence:done'
	};
	
	var Animator = exports.Animator = function () {
	  function Animator() {
	    _classCallCheck(this, Animator);
	  }
	
	  Animator.prototype.enter = function enter(element) {
	    return Promise.resolve(false);
	  };
	
	  Animator.prototype.leave = function leave(element) {
	    return Promise.resolve(false);
	  };
	
	  Animator.prototype.removeClass = function removeClass(element, className) {
	    element.classList.remove(className);
	    return Promise.resolve(false);
	  };
	
	  Animator.prototype.addClass = function addClass(element, className) {
	    element.classList.add(className);
	    return Promise.resolve(false);
	  };
	
	  Animator.prototype.animate = function animate(element, className) {
	    return Promise.resolve(false);
	  };
	
	  Animator.prototype.runSequence = function runSequence(animations) {};
	
	  Animator.prototype.registerEffect = function registerEffect(effectName, properties) {};
	
	  Animator.prototype.unregisterEffect = function unregisterEffect(effectName) {};
	
	  return Animator;
	}();
	
	var CompositionTransaction = exports.CompositionTransaction = function () {
	  function CompositionTransaction() {
	    _classCallCheck(this, CompositionTransaction);
	
	    this._ownershipToken = null;
	    this._compositionCount = 0;
	  }
	
	  CompositionTransaction.prototype.tryCapture = function tryCapture() {
	    if (this._ownershipToken !== null) {
	      return null;
	    }
	
	    return this._ownershipToken = this._createOwnershipToken();
	  };
	
	  CompositionTransaction.prototype.enlist = function enlist() {
	    var that = this;
	
	    that._compositionCount++;
	
	    return {
	      done: function done() {
	        that._compositionCount--;
	        that._tryCompleteTransaction();
	      }
	    };
	  };
	
	  CompositionTransaction.prototype._tryCompleteTransaction = function _tryCompleteTransaction() {
	    if (this._compositionCount <= 0) {
	      this._compositionCount = 0;
	
	      if (this._ownershipToken !== null) {
	        var capture = this._ownershipToken;
	        this._ownershipToken = null;
	        capture._resolve();
	      }
	    }
	  };
	
	  CompositionTransaction.prototype._createOwnershipToken = function _createOwnershipToken() {
	    var _this = this;
	
	    var token = {};
	    var promise = new Promise(function (resolve, reject) {
	      token._resolve = resolve;
	    });
	
	    token.waitForCompositionComplete = function () {
	      _this._tryCompleteTransaction();
	      return promise;
	    };
	
	    return token;
	  };
	
	  return CompositionTransaction;
	}();
	
	var capitalMatcher = /([A-Z])/g;
	
	function addHyphenAndLower(char) {
	  return '-' + char.toLowerCase();
	}
	
	function _hyphenate(name) {
	  return (name.charAt(0).toLowerCase() + name.slice(1)).replace(capitalMatcher, addHyphenAndLower);
	}
	
	var ElementEvents = exports.ElementEvents = function () {
	  function ElementEvents(element) {
	    _classCallCheck(this, ElementEvents);
	
	    this.element = element;
	    this.subscriptions = {};
	  }
	
	  ElementEvents.prototype._enqueueHandler = function _enqueueHandler(handler) {
	    this.subscriptions[handler.eventName] = this.subscriptions[handler.eventName] || [];
	    this.subscriptions[handler.eventName].push(handler);
	  };
	
	  ElementEvents.prototype._dequeueHandler = function _dequeueHandler(handler) {
	    var index = void 0;
	    var subscriptions = this.subscriptions[handler.eventName];
	    if (subscriptions) {
	      index = subscriptions.indexOf(handler);
	      if (index > -1) {
	        subscriptions.splice(index, 1);
	      }
	    }
	    return handler;
	  };
	
	  ElementEvents.prototype.publish = function publish(eventName) {
	    var detail = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];
	    var bubbles = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];
	    var cancelable = arguments.length <= 3 || arguments[3] === undefined ? true : arguments[3];
	
	    var event = _aureliaPal.DOM.createCustomEvent(eventName, { cancelable: cancelable, bubbles: bubbles, detail: detail });
	    this.element.dispatchEvent(event);
	  };
	
	  ElementEvents.prototype.subscribe = function subscribe(eventName, handler) {
	    var _this2 = this;
	
	    var bubbles = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];
	
	    if (handler && typeof handler === 'function') {
	      handler.eventName = eventName;
	      handler.handler = handler;
	      handler.bubbles = bubbles;
	      handler.dispose = function () {
	        _this2.element.removeEventListener(eventName, handler, bubbles);
	        _this2._dequeueHandler(handler);
	      };
	      this.element.addEventListener(eventName, handler, bubbles);
	      this._enqueueHandler(handler);
	      return handler;
	    }
	  };
	
	  ElementEvents.prototype.subscribeOnce = function subscribeOnce(eventName, handler) {
	    var _this3 = this;
	
	    var bubbles = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];
	
	    if (handler && typeof handler === 'function') {
	      var _ret = function () {
	        var _handler = function _handler(event) {
	          handler(event);
	          _handler.dispose();
	        };
	        return {
	          v: _this3.subscribe(eventName, _handler, bubbles)
	        };
	      }();
	
	      if ((typeof _ret === 'undefined' ? 'undefined' : _typeof(_ret)) === "object") return _ret.v;
	    }
	  };
	
	  ElementEvents.prototype.dispose = function dispose(eventName) {
	    if (eventName && typeof eventName === 'string') {
	      var subscriptions = this.subscriptions[eventName];
	      if (subscriptions) {
	        while (subscriptions.length) {
	          var subscription = subscriptions.pop();
	          if (subscription) {
	            subscription.dispose();
	          }
	        }
	      }
	    } else {
	      this.disposeAll();
	    }
	  };
	
	  ElementEvents.prototype.disposeAll = function disposeAll() {
	    for (var key in this.subscriptions) {
	      this.dispose(key);
	    }
	  };
	
	  return ElementEvents;
	}();
	
	var ResourceLoadContext = exports.ResourceLoadContext = function () {
	  function ResourceLoadContext() {
	    _classCallCheck(this, ResourceLoadContext);
	
	    this.dependencies = {};
	  }
	
	  ResourceLoadContext.prototype.addDependency = function addDependency(url) {
	    this.dependencies[url] = true;
	  };
	
	  ResourceLoadContext.prototype.hasDependency = function hasDependency(url) {
	    return url in this.dependencies;
	  };
	
	  return ResourceLoadContext;
	}();
	
	var ViewCompileInstruction = exports.ViewCompileInstruction = function ViewCompileInstruction() {
	  var targetShadowDOM = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];
	  var compileSurrogate = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
	
	  _classCallCheck(this, ViewCompileInstruction);
	
	  this.targetShadowDOM = targetShadowDOM;
	  this.compileSurrogate = compileSurrogate;
	  this.associatedModuleId = null;
	};
	
	ViewCompileInstruction.normal = new ViewCompileInstruction();
	
	var BehaviorInstruction = exports.BehaviorInstruction = function () {
	  BehaviorInstruction.enhance = function enhance() {
	    var instruction = new BehaviorInstruction();
	    instruction.enhance = true;
	    return instruction;
	  };
	
	  BehaviorInstruction.unitTest = function unitTest(type, attributes) {
	    var instruction = new BehaviorInstruction();
	    instruction.type = type;
	    instruction.attributes = attributes || {};
	    return instruction;
	  };
	
	  BehaviorInstruction.element = function element(node, type) {
	    var instruction = new BehaviorInstruction();
	    instruction.type = type;
	    instruction.attributes = {};
	    instruction.anchorIsContainer = !(node.hasAttribute('containerless') || type.containerless);
	    instruction.initiatedByBehavior = true;
	    return instruction;
	  };
	
	  BehaviorInstruction.attribute = function attribute(attrName, type) {
	    var instruction = new BehaviorInstruction();
	    instruction.attrName = attrName;
	    instruction.type = type || null;
	    instruction.attributes = {};
	    return instruction;
	  };
	
	  BehaviorInstruction.dynamic = function dynamic(host, viewModel, viewFactory) {
	    var instruction = new BehaviorInstruction();
	    instruction.host = host;
	    instruction.viewModel = viewModel;
	    instruction.viewFactory = viewFactory;
	    instruction.inheritBindingContext = true;
	    return instruction;
	  };
	
	  function BehaviorInstruction() {
	    _classCallCheck(this, BehaviorInstruction);
	
	    this.initiatedByBehavior = false;
	    this.enhance = false;
	    this.partReplacements = null;
	    this.viewFactory = null;
	    this.originalAttrName = null;
	    this.skipContentProcessing = false;
	    this.contentFactory = null;
	    this.viewModel = null;
	    this.anchorIsContainer = false;
	    this.host = null;
	    this.attributes = null;
	    this.type = null;
	    this.attrName = null;
	    this.inheritBindingContext = false;
	  }
	
	  return BehaviorInstruction;
	}();
	
	BehaviorInstruction.normal = new BehaviorInstruction();
	
	var TargetInstruction = exports.TargetInstruction = (_temp = _class3 = function () {
	  TargetInstruction.contentSelector = function contentSelector(node, parentInjectorId) {
	    var instruction = new TargetInstruction();
	    instruction.parentInjectorId = parentInjectorId;
	    instruction.contentSelector = true;
	    instruction.selector = node.getAttribute('select');
	    return instruction;
	  };
	
	  TargetInstruction.contentExpression = function contentExpression(expression) {
	    var instruction = new TargetInstruction();
	    instruction.contentExpression = expression;
	    return instruction;
	  };
	
	  TargetInstruction.lifting = function lifting(parentInjectorId, liftingInstruction) {
	    var instruction = new TargetInstruction();
	    instruction.parentInjectorId = parentInjectorId;
	    instruction.expressions = TargetInstruction.noExpressions;
	    instruction.behaviorInstructions = [liftingInstruction];
	    instruction.viewFactory = liftingInstruction.viewFactory;
	    instruction.providers = [liftingInstruction.type.target];
	    instruction.lifting = true;
	    return instruction;
	  };
	
	  TargetInstruction.normal = function normal(injectorId, parentInjectorId, providers, behaviorInstructions, expressions, elementInstruction) {
	    var instruction = new TargetInstruction();
	    instruction.injectorId = injectorId;
	    instruction.parentInjectorId = parentInjectorId;
	    instruction.providers = providers;
	    instruction.behaviorInstructions = behaviorInstructions;
	    instruction.expressions = expressions;
	    instruction.anchorIsContainer = elementInstruction ? elementInstruction.anchorIsContainer : true;
	    instruction.elementInstruction = elementInstruction;
	    return instruction;
	  };
	
	  TargetInstruction.surrogate = function surrogate(providers, behaviorInstructions, expressions, values) {
	    var instruction = new TargetInstruction();
	    instruction.expressions = expressions;
	    instruction.behaviorInstructions = behaviorInstructions;
	    instruction.providers = providers;
	    instruction.values = values;
	    return instruction;
	  };
	
	  function TargetInstruction() {
	    _classCallCheck(this, TargetInstruction);
	
	    this.injectorId = null;
	    this.parentInjectorId = null;
	
	    this.contentSelector = false;
	    this.selector = null;
	
	    this.contentExpression = null;
	
	    this.expressions = null;
	    this.behaviorInstructions = null;
	    this.providers = null;
	
	    this.viewFactory = null;
	
	    this.anchorIsContainer = false;
	    this.elementInstruction = null;
	    this.lifting = false;
	
	    this.values = null;
	  }
	
	  return TargetInstruction;
	}(), _class3.noExpressions = Object.freeze([]), _temp);
	var viewStrategy = exports.viewStrategy = _aureliaMetadata.protocol.create('aurelia:view-strategy', {
	  validate: function validate(target) {
	    if (!(typeof target.loadViewFactory === 'function')) {
	      return 'View strategies must implement: loadViewFactory(viewEngine: ViewEngine, compileInstruction: ViewCompileInstruction, loadContext?: ResourceLoadContext): Promise<ViewFactory>';
	    }
	
	    return true;
	  },
	  compose: function compose(target) {
	    if (!(typeof target.makeRelativeTo === 'function')) {
	      target.makeRelativeTo = _aureliaPal.PLATFORM.noop;
	    }
	  }
	});
	
	var RelativeViewStrategy = exports.RelativeViewStrategy = (_dec = viewStrategy(), _dec(_class4 = function () {
	  function RelativeViewStrategy(path) {
	    _classCallCheck(this, RelativeViewStrategy);
	
	    this.path = path;
	    this.absolutePath = null;
	  }
	
	  RelativeViewStrategy.prototype.loadViewFactory = function loadViewFactory(viewEngine, compileInstruction, loadContext) {
	    if (this.absolutePath === null && this.moduleId) {
	      this.absolutePath = (0, _aureliaPath.relativeToFile)(this.path, this.moduleId);
	    }
	
	    compileInstruction.associatedModuleId = this.moduleId;
	    return viewEngine.loadViewFactory(this.absolutePath || this.path, compileInstruction, loadContext);
	  };
	
	  RelativeViewStrategy.prototype.makeRelativeTo = function makeRelativeTo(file) {
	    if (this.absolutePath === null) {
	      this.absolutePath = (0, _aureliaPath.relativeToFile)(this.path, file);
	    }
	  };
	
	  return RelativeViewStrategy;
	}()) || _class4);
	var ConventionalViewStrategy = exports.ConventionalViewStrategy = (_dec2 = viewStrategy(), _dec2(_class5 = function () {
	  function ConventionalViewStrategy(viewLocator, origin) {
	    _classCallCheck(this, ConventionalViewStrategy);
	
	    this.moduleId = origin.moduleId;
	    this.viewUrl = viewLocator.convertOriginToViewUrl(origin);
	  }
	
	  ConventionalViewStrategy.prototype.loadViewFactory = function loadViewFactory(viewEngine, compileInstruction, loadContext) {
	    compileInstruction.associatedModuleId = this.moduleId;
	    return viewEngine.loadViewFactory(this.viewUrl, compileInstruction, loadContext);
	  };
	
	  return ConventionalViewStrategy;
	}()) || _class5);
	var NoViewStrategy = exports.NoViewStrategy = (_dec3 = viewStrategy(), _dec3(_class6 = function () {
	  function NoViewStrategy() {
	    _classCallCheck(this, NoViewStrategy);
	  }
	
	  NoViewStrategy.prototype.loadViewFactory = function loadViewFactory(viewEngine, compileInstruction, loadContext) {
	    return Promise.resolve(null);
	  };
	
	  return NoViewStrategy;
	}()) || _class6);
	var TemplateRegistryViewStrategy = exports.TemplateRegistryViewStrategy = (_dec4 = viewStrategy(), _dec4(_class7 = function () {
	  function TemplateRegistryViewStrategy(moduleId, entry) {
	    _classCallCheck(this, TemplateRegistryViewStrategy);
	
	    this.moduleId = moduleId;
	    this.entry = entry;
	  }
	
	  TemplateRegistryViewStrategy.prototype.loadViewFactory = function loadViewFactory(viewEngine, compileInstruction, loadContext) {
	    var entry = this.entry;
	
	    if (entry.factoryIsReady) {
	      return Promise.resolve(entry.factory);
	    }
	
	    compileInstruction.associatedModuleId = this.moduleId;
	    return viewEngine.loadViewFactory(entry, compileInstruction, loadContext);
	  };
	
	  return TemplateRegistryViewStrategy;
	}()) || _class7);
	var InlineViewStrategy = exports.InlineViewStrategy = (_dec5 = viewStrategy(), _dec5(_class8 = function () {
	  function InlineViewStrategy(markup, dependencies, dependencyBaseUrl) {
	    _classCallCheck(this, InlineViewStrategy);
	
	    this.markup = markup;
	    this.dependencies = dependencies || null;
	    this.dependencyBaseUrl = dependencyBaseUrl || '';
	  }
	
	  InlineViewStrategy.prototype.loadViewFactory = function loadViewFactory(viewEngine, compileInstruction, loadContext) {
	    var entry = this.entry;
	    var dependencies = this.dependencies;
	
	    if (entry && entry.factoryIsReady) {
	      return Promise.resolve(entry.factory);
	    }
	
	    this.entry = entry = new _aureliaLoader.TemplateRegistryEntry(this.moduleId || this.dependencyBaseUrl);
	    entry.template = _aureliaPal.DOM.createTemplateFromMarkup(this.markup);
	
	    if (dependencies !== null) {
	      for (var i = 0, ii = dependencies.length; i < ii; ++i) {
	        var current = dependencies[i];
	
	        if (typeof current === 'string' || typeof current === 'function') {
	          entry.addDependency(current);
	        } else {
	          entry.addDependency(current.from, current.as);
	        }
	      }
	    }
	
	    compileInstruction.associatedModuleId = this.moduleId;
	    return viewEngine.loadViewFactory(entry, compileInstruction, loadContext);
	  };
	
	  return InlineViewStrategy;
	}()) || _class8);
	var ViewLocator = exports.ViewLocator = (_temp2 = _class9 = function () {
	  function ViewLocator() {
	    _classCallCheck(this, ViewLocator);
	  }
	
	  ViewLocator.prototype.getViewStrategy = function getViewStrategy(value) {
	    if (!value) {
	      return null;
	    }
	
	    if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && 'getViewStrategy' in value) {
	      var _origin = _aureliaMetadata.Origin.get(value.constructor);
	
	      value = value.getViewStrategy();
	
	      if (typeof value === 'string') {
	        value = new RelativeViewStrategy(value);
	      }
	
	      viewStrategy.assert(value);
	
	      if (_origin) {
	        value.makeRelativeTo(_origin.moduleId);
	      }
	
	      return value;
	    }
	
	    if (typeof value === 'string') {
	      value = new RelativeViewStrategy(value);
	    }
	
	    if (viewStrategy.validate(value)) {
	      return value;
	    }
	
	    if (typeof value !== 'function') {
	      value = value.constructor;
	    }
	
	    var origin = _aureliaMetadata.Origin.get(value);
	    var strategy = _aureliaMetadata.metadata.get(ViewLocator.viewStrategyMetadataKey, value);
	
	    if (!strategy) {
	      if (!origin) {
	        throw new Error('Cannot determinte default view strategy for object.', value);
	      }
	
	      strategy = this.createFallbackViewStrategy(origin);
	    } else if (origin) {
	      strategy.moduleId = origin.moduleId;
	    }
	
	    return strategy;
	  };
	
	  ViewLocator.prototype.createFallbackViewStrategy = function createFallbackViewStrategy(origin) {
	    return new ConventionalViewStrategy(this, origin);
	  };
	
	  ViewLocator.prototype.convertOriginToViewUrl = function convertOriginToViewUrl(origin) {
	    var moduleId = origin.moduleId;
	    var id = moduleId.endsWith('.js') || moduleId.endsWith('.ts') ? moduleId.substring(0, moduleId.length - 3) : moduleId;
	    return id + '.html';
	  };
	
	  return ViewLocator;
	}(), _class9.viewStrategyMetadataKey = 'aurelia:view-strategy', _temp2);
	
	var BindingLanguage = exports.BindingLanguage = function () {
	  function BindingLanguage() {
	    _classCallCheck(this, BindingLanguage);
	  }
	
	  BindingLanguage.prototype.inspectAttribute = function inspectAttribute(resources, elementName, attrName, attrValue) {
	    throw new Error('A BindingLanguage must implement inspectAttribute(...)');
	  };
	
	  BindingLanguage.prototype.createAttributeInstruction = function createAttributeInstruction(resources, element, info, existingInstruction) {
	    throw new Error('A BindingLanguage must implement createAttributeInstruction(...)');
	  };
	
	  BindingLanguage.prototype.inspectTextContent = function inspectTextContent(resources, value) {
	    throw new Error('A BindingLanguage must implement inspectTextContent(...)');
	  };
	
	  return BindingLanguage;
	}();
	
	function register(lookup, name, resource, type) {
	  if (!name) {
	    return;
	  }
	
	  var existing = lookup[name];
	  if (existing) {
	    if (existing !== resource) {
	      throw new Error('Attempted to register ' + type + ' when one with the same name already exists. Name: ' + name + '.');
	    }
	
	    return;
	  }
	
	  lookup[name] = resource;
	}
	
	var ViewResources = exports.ViewResources = function () {
	  function ViewResources(parent, viewUrl) {
	    _classCallCheck(this, ViewResources);
	
	    this.bindingLanguage = null;
	
	    this.parent = parent || null;
	    this.hasParent = this.parent !== null;
	    this.viewUrl = viewUrl || '';
	    this.lookupFunctions = {
	      valueConverters: this.getValueConverter.bind(this),
	      bindingBehaviors: this.getBindingBehavior.bind(this)
	    };
	    this.attributes = Object.create(null);
	    this.elements = Object.create(null);
	    this.valueConverters = Object.create(null);
	    this.bindingBehaviors = Object.create(null);
	    this.attributeMap = Object.create(null);
	    this.beforeCompile = this.afterCompile = this.beforeCreate = this.afterCreate = this.beforeBind = this.beforeUnbind = false;
	  }
	
	  ViewResources.prototype._tryAddHook = function _tryAddHook(obj, name) {
	    if (typeof obj[name] === 'function') {
	      var func = obj[name].bind(obj);
	      var counter = 1;
	      var callbackName = void 0;
	
	      while (this[callbackName = name + counter.toString()] !== undefined) {
	        counter++;
	      }
	
	      this[name] = true;
	      this[callbackName] = func;
	    }
	  };
	
	  ViewResources.prototype._invokeHook = function _invokeHook(name, one, two, three, four) {
	    if (this.hasParent) {
	      this.parent._invokeHook(name, one, two, three, four);
	    }
	
	    if (this[name]) {
	      this[name + '1'](one, two, three, four);
	
	      var callbackName = name + '2';
	      if (this[callbackName]) {
	        this[callbackName](one, two, three, four);
	
	        callbackName = name + '3';
	        if (this[callbackName]) {
	          this[callbackName](one, two, three, four);
	
	          var counter = 4;
	
	          while (this[callbackName = name + counter.toString()] !== undefined) {
	            this[callbackName](one, two, three, four);
	            counter++;
	          }
	        }
	      }
	    }
	  };
	
	  ViewResources.prototype.registerViewEngineHooks = function registerViewEngineHooks(hooks) {
	    this._tryAddHook(hooks, 'beforeCompile');
	    this._tryAddHook(hooks, 'afterCompile');
	    this._tryAddHook(hooks, 'beforeCreate');
	    this._tryAddHook(hooks, 'afterCreate');
	    this._tryAddHook(hooks, 'beforeBind');
	    this._tryAddHook(hooks, 'beforeUnbind');
	  };
	
	  ViewResources.prototype.getBindingLanguage = function getBindingLanguage(bindingLanguageFallback) {
	    return this.bindingLanguage || (this.bindingLanguage = bindingLanguageFallback);
	  };
	
	  ViewResources.prototype.patchInParent = function patchInParent(newParent) {
	    var originalParent = this.parent;
	
	    this.parent = newParent || null;
	    this.hasParent = this.parent !== null;
	
	    if (newParent.parent === null) {
	      newParent.parent = originalParent;
	      newParent.hasParent = originalParent !== null;
	    }
	  };
	
	  ViewResources.prototype.relativeToView = function relativeToView(path) {
	    return (0, _aureliaPath.relativeToFile)(path, this.viewUrl);
	  };
	
	  ViewResources.prototype.registerElement = function registerElement(tagName, behavior) {
	    register(this.elements, tagName, behavior, 'an Element');
	  };
	
	  ViewResources.prototype.getElement = function getElement(tagName) {
	    return this.elements[tagName] || (this.hasParent ? this.parent.getElement(tagName) : null);
	  };
	
	  ViewResources.prototype.mapAttribute = function mapAttribute(attribute) {
	    return this.attributeMap[attribute] || (this.hasParent ? this.parent.mapAttribute(attribute) : null);
	  };
	
	  ViewResources.prototype.registerAttribute = function registerAttribute(attribute, behavior, knownAttribute) {
	    this.attributeMap[attribute] = knownAttribute;
	    register(this.attributes, attribute, behavior, 'an Attribute');
	  };
	
	  ViewResources.prototype.getAttribute = function getAttribute(attribute) {
	    return this.attributes[attribute] || (this.hasParent ? this.parent.getAttribute(attribute) : null);
	  };
	
	  ViewResources.prototype.registerValueConverter = function registerValueConverter(name, valueConverter) {
	    register(this.valueConverters, name, valueConverter, 'a ValueConverter');
	  };
	
	  ViewResources.prototype.getValueConverter = function getValueConverter(name) {
	    return this.valueConverters[name] || (this.hasParent ? this.parent.getValueConverter(name) : null);
	  };
	
	  ViewResources.prototype.registerBindingBehavior = function registerBindingBehavior(name, bindingBehavior) {
	    register(this.bindingBehaviors, name, bindingBehavior, 'a BindingBehavior');
	  };
	
	  ViewResources.prototype.getBindingBehavior = function getBindingBehavior(name) {
	    return this.bindingBehaviors[name] || (this.hasParent ? this.parent.getBindingBehavior(name) : null);
	  };
	
	  return ViewResources;
	}();
	
	var View = exports.View = function () {
	  function View(container, viewFactory, fragment, controllers, bindings, children, contentSelectors) {
	    _classCallCheck(this, View);
	
	    this.container = container;
	    this.viewFactory = viewFactory;
	    this.resources = viewFactory.resources;
	    this.fragment = fragment;
	    this.controllers = controllers;
	    this.bindings = bindings;
	    this.children = children;
	    this.contentSelectors = contentSelectors;
	    this.firstChild = fragment.firstChild;
	    this.lastChild = fragment.lastChild;
	    this.fromCache = false;
	    this.isBound = false;
	    this.isAttached = false;
	    this.fromCache = false;
	    this.bindingContext = null;
	    this.overrideContext = null;
	    this.controller = null;
	    this.viewModelScope = null;
	    this._isUserControlled = false;
	  }
	
	  View.prototype.returnToCache = function returnToCache() {
	    this.viewFactory.returnViewToCache(this);
	  };
	
	  View.prototype.created = function created() {
	    var i = void 0;
	    var ii = void 0;
	    var controllers = this.controllers;
	
	    for (i = 0, ii = controllers.length; i < ii; ++i) {
	      controllers[i].created(this);
	    }
	  };
	
	  View.prototype.bind = function bind(bindingContext, overrideContext, _systemUpdate) {
	    var controllers = void 0;
	    var bindings = void 0;
	    var children = void 0;
	    var i = void 0;
	    var ii = void 0;
	
	    if (_systemUpdate && this._isUserControlled) {
	      return;
	    }
	
	    if (this.isBound) {
	      if (this.bindingContext === bindingContext) {
	        return;
	      }
	
	      this.unbind();
	    }
	
	    this.isBound = true;
	    this.bindingContext = bindingContext;
	    this.overrideContext = overrideContext || (0, _aureliaBinding.createOverrideContext)(bindingContext);
	
	    this.resources._invokeHook('beforeBind', this);
	
	    bindings = this.bindings;
	    for (i = 0, ii = bindings.length; i < ii; ++i) {
	      bindings[i].bind(this);
	    }
	
	    if (this.viewModelScope !== null) {
	      bindingContext.bind(this.viewModelScope.bindingContext, this.viewModelScope.overrideContext);
	      this.viewModelScope = null;
	    }
	
	    controllers = this.controllers;
	    for (i = 0, ii = controllers.length; i < ii; ++i) {
	      controllers[i].bind(this);
	    }
	
	    children = this.children;
	    for (i = 0, ii = children.length; i < ii; ++i) {
	      children[i].bind(bindingContext, overrideContext, true);
	    }
	  };
	
	  View.prototype.addBinding = function addBinding(binding) {
	    this.bindings.push(binding);
	
	    if (this.isBound) {
	      binding.bind(this);
	    }
	  };
	
	  View.prototype.unbind = function unbind() {
	    var controllers = void 0;
	    var bindings = void 0;
	    var children = void 0;
	    var i = void 0;
	    var ii = void 0;
	
	    if (this.isBound) {
	      this.isBound = false;
	      this.resources._invokeHook('beforeUnbind', this);
	
	      if (this.controller !== null) {
	        this.controller.unbind();
	      }
	
	      bindings = this.bindings;
	      for (i = 0, ii = bindings.length; i < ii; ++i) {
	        bindings[i].unbind();
	      }
	
	      controllers = this.controllers;
	      for (i = 0, ii = controllers.length; i < ii; ++i) {
	        controllers[i].unbind();
	      }
	
	      children = this.children;
	      for (i = 0, ii = children.length; i < ii; ++i) {
	        children[i].unbind();
	      }
	
	      this.bindingContext = null;
	      this.overrideContext = null;
	    }
	  };
	
	  View.prototype.insertNodesBefore = function insertNodesBefore(refNode) {
	    var parent = refNode.parentNode;
	    parent.insertBefore(this.fragment, refNode);
	  };
	
	  View.prototype.appendNodesTo = function appendNodesTo(parent) {
	    parent.appendChild(this.fragment);
	  };
	
	  View.prototype.removeNodes = function removeNodes() {
	    var start = this.firstChild;
	    var end = this.lastChild;
	    var fragment = this.fragment;
	    var next = void 0;
	    var current = start;
	    var loop = true;
	
	    while (loop) {
	      if (current === end) {
	        loop = false;
	      }
	
	      next = current.nextSibling;
	      fragment.appendChild(current);
	      current = next;
	    }
	  };
	
	  View.prototype.attached = function attached() {
	    var controllers = void 0;
	    var children = void 0;
	    var i = void 0;
	    var ii = void 0;
	
	    if (this.isAttached) {
	      return;
	    }
	
	    this.isAttached = true;
	
	    if (this.controller !== null) {
	      this.controller.attached();
	    }
	
	    controllers = this.controllers;
	    for (i = 0, ii = controllers.length; i < ii; ++i) {
	      controllers[i].attached();
	    }
	
	    children = this.children;
	    for (i = 0, ii = children.length; i < ii; ++i) {
	      children[i].attached();
	    }
	  };
	
	  View.prototype.detached = function detached() {
	    var controllers = void 0;
	    var children = void 0;
	    var i = void 0;
	    var ii = void 0;
	
	    if (this.isAttached) {
	      this.isAttached = false;
	
	      if (this.controller !== null) {
	        this.controller.detached();
	      }
	
	      controllers = this.controllers;
	      for (i = 0, ii = controllers.length; i < ii; ++i) {
	        controllers[i].detached();
	      }
	
	      children = this.children;
	      for (i = 0, ii = children.length; i < ii; ++i) {
	        children[i].detached();
	      }
	    }
	  };
	
	  return View;
	}();
	
	var placeholder = [];
	
	function findInsertionPoint(groups, index) {
	  var insertionPoint = void 0;
	
	  while (!insertionPoint && index >= 0) {
	    insertionPoint = groups[index][0];
	    index--;
	  }
	
	  return insertionPoint;
	}
	
	var _ContentSelector = exports._ContentSelector = function () {
	  _ContentSelector.applySelectors = function applySelectors(view, contentSelectors, callback) {
	    var currentChild = view.fragment.firstChild;
	    var contentMap = new Map();
	    var nextSibling = void 0;
	    var i = void 0;
	    var ii = void 0;
	    var contentSelector = void 0;
	
	    while (currentChild) {
	      nextSibling = currentChild.nextSibling;
	
	      if (currentChild.isContentProjectionSource) {
	        var viewSlotSelectors = contentSelectors.map(function (x) {
	          return x.copyForViewSlot();
	        });
	        currentChild.viewSlot._installContentSelectors(viewSlotSelectors);
	      } else {
	        for (i = 0, ii = contentSelectors.length; i < ii; i++) {
	          contentSelector = contentSelectors[i];
	          if (contentSelector.matches(currentChild)) {
	            var elements = contentMap.get(contentSelector);
	            if (!elements) {
	              elements = [];
	              contentMap.set(contentSelector, elements);
	            }
	
	            elements.push(currentChild);
	            break;
	          }
	        }
	      }
	
	      currentChild = nextSibling;
	    }
	
	    for (i = 0, ii = contentSelectors.length; i < ii; ++i) {
	      contentSelector = contentSelectors[i];
	      callback(contentSelector, contentMap.get(contentSelector) || placeholder);
	    }
	  };
	
	  function _ContentSelector(anchor, selector) {
	    _classCallCheck(this, _ContentSelector);
	
	    this.anchor = anchor;
	    this.selector = selector;
	    this.all = !this.selector;
	    this.groups = [];
	  }
	
	  _ContentSelector.prototype.copyForViewSlot = function copyForViewSlot() {
	    return new _ContentSelector(this.anchor, this.selector);
	  };
	
	  _ContentSelector.prototype.matches = function matches(node) {
	    return this.all || node.nodeType === 1 && node.matches(this.selector);
	  };
	
	  _ContentSelector.prototype.add = function add(group) {
	    var anchor = this.anchor;
	    var parent = anchor.parentNode;
	    var i = void 0;
	    var ii = void 0;
	
	    for (i = 0, ii = group.length; i < ii; ++i) {
	      parent.insertBefore(group[i], anchor);
	    }
	
	    this.groups.push(group);
	  };
	
	  _ContentSelector.prototype.insert = function insert(index, group) {
	    if (group.length) {
	      var anchor = findInsertionPoint(this.groups, index) || this.anchor;
	      var parent = anchor.parentNode;
	      var i = void 0;
	      var ii = void 0;
	
	      for (i = 0, ii = group.length; i < ii; ++i) {
	        parent.insertBefore(group[i], anchor);
	      }
	    }
	
	    this.groups.splice(index, 0, group);
	  };
	
	  _ContentSelector.prototype.removeAt = function removeAt(index, fragment) {
	    var group = this.groups[index];
	    var i = void 0;
	    var ii = void 0;
	
	    for (i = 0, ii = group.length; i < ii; ++i) {
	      fragment.appendChild(group[i]);
	    }
	
	    this.groups.splice(index, 1);
	  };
	
	  return _ContentSelector;
	}();
	
	function getAnimatableElement(view) {
	  var firstChild = view.firstChild;
	
	  if (firstChild !== null && firstChild !== undefined && firstChild.nodeType === 8) {
	    var _element = _aureliaPal.DOM.nextElementSibling(firstChild);
	
	    if (_element !== null && _element !== undefined && _element.nodeType === 1 && _element.classList.contains('au-animate')) {
	      return _element;
	    }
	  }
	
	  return null;
	}
	
	var ViewSlot = exports.ViewSlot = function () {
	  function ViewSlot(anchor, anchorIsContainer) {
	    var animator = arguments.length <= 2 || arguments[2] === undefined ? Animator.instance : arguments[2];
	
	    _classCallCheck(this, ViewSlot);
	
	    this.anchor = anchor;
	    this.viewAddMethod = anchorIsContainer ? 'appendNodesTo' : 'insertNodesBefore';
	    this.bindingContext = null;
	    this.overrideContext = null;
	    this.animator = animator;
	    this.children = [];
	    this.isBound = false;
	    this.isAttached = false;
	    this.contentSelectors = null;
	    anchor.viewSlot = this;
	    anchor.isContentProjectionSource = false;
	  }
	
	  ViewSlot.prototype.transformChildNodesIntoView = function transformChildNodesIntoView() {
	    var parent = this.anchor;
	
	    this.children.push({
	      fragment: parent,
	      firstChild: parent.firstChild,
	      lastChild: parent.lastChild,
	      returnToCache: function returnToCache() {},
	      removeNodes: function removeNodes() {
	        var last = void 0;
	
	        while (last = parent.lastChild) {
	          parent.removeChild(last);
	        }
	      },
	      created: function created() {},
	      bind: function bind() {},
	      unbind: function unbind() {},
	      attached: function attached() {},
	      detached: function detached() {}
	    });
	  };
	
	  ViewSlot.prototype.bind = function bind(bindingContext, overrideContext) {
	    var i = void 0;
	    var ii = void 0;
	    var children = void 0;
	
	    if (this.isBound) {
	      if (this.bindingContext === bindingContext) {
	        return;
	      }
	
	      this.unbind();
	    }
	
	    this.isBound = true;
	    this.bindingContext = bindingContext = bindingContext || this.bindingContext;
	    this.overrideContext = overrideContext = overrideContext || this.overrideContext;
	
	    children = this.children;
	    for (i = 0, ii = children.length; i < ii; ++i) {
	      children[i].bind(bindingContext, overrideContext, true);
	    }
	  };
	
	  ViewSlot.prototype.unbind = function unbind() {
	    if (this.isBound) {
	      var i = void 0;
	      var ii = void 0;
	      var _children = this.children;
	
	      this.isBound = false;
	      this.bindingContext = null;
	      this.overrideContext = null;
	
	      for (i = 0, ii = _children.length; i < ii; ++i) {
	        _children[i].unbind();
	      }
	    }
	  };
	
	  ViewSlot.prototype.add = function add(view) {
	    view[this.viewAddMethod](this.anchor);
	    this.children.push(view);
	
	    if (this.isAttached) {
	      view.attached();
	
	      var animatableElement = getAnimatableElement(view);
	      if (animatableElement !== null) {
	        return this.animator.enter(animatableElement);
	      }
	    }
	  };
	
	  ViewSlot.prototype.insert = function insert(index, view) {
	    var children = this.children;
	    var length = children.length;
	
	    if (index === 0 && length === 0 || index >= length) {
	      return this.add(view);
	    }
	
	    view.insertNodesBefore(children[index].firstChild);
	    children.splice(index, 0, view);
	
	    if (this.isAttached) {
	      view.attached();
	
	      var animatableElement = getAnimatableElement(view);
	      if (animatableElement !== null) {
	        return this.animator.enter(animatableElement);
	      }
	    }
	  };
	
	  ViewSlot.prototype.move = function move(sourceIndex, targetIndex) {
	    if (sourceIndex === targetIndex) {
	      return;
	    }
	
	    var children = this.children;
	    var view = children[sourceIndex];
	
	    view.removeNodes();
	    view.insertNodesBefore(children[targetIndex].firstChild);
	    children.splice(sourceIndex, 1);
	    children.splice(targetIndex, 0, view);
	  };
	
	  ViewSlot.prototype.remove = function remove(view, returnToCache, skipAnimation) {
	    return this.removeAt(this.children.indexOf(view), returnToCache, skipAnimation);
	  };
	
	  ViewSlot.prototype.removeMany = function removeMany(viewsToRemove, returnToCache, skipAnimation) {
	    var _this4 = this;
	
	    var children = this.children;
	    var ii = viewsToRemove.length;
	    var i = void 0;
	    var rmPromises = [];
	
	    viewsToRemove.forEach(function (child) {
	      if (skipAnimation) {
	        child.removeNodes();
	        return;
	      }
	
	      var animatableElement = getAnimatableElement(child);
	      if (animatableElement !== null) {
	        rmPromises.push(_this4.animator.leave(animatableElement).then(function () {
	          return child.removeNodes();
	        }));
	      } else {
	        child.removeNodes();
	      }
	    });
	
	    var removeAction = function removeAction() {
	      if (_this4.isAttached) {
	        for (i = 0; i < ii; ++i) {
	          viewsToRemove[i].detached();
	        }
	      }
	
	      if (returnToCache) {
	        for (i = 0; i < ii; ++i) {
	          viewsToRemove[i].returnToCache();
	        }
	      }
	
	      for (i = 0; i < ii; ++i) {
	        var index = children.indexOf(viewsToRemove[i]);
	        if (index >= 0) {
	          children.splice(index, 1);
	        }
	      }
	    };
	
	    if (rmPromises.length > 0) {
	      return Promise.all(rmPromises).then(function () {
	        return removeAction();
	      });
	    }
	
	    removeAction();
	  };
	
	  ViewSlot.prototype.removeAt = function removeAt(index, returnToCache, skipAnimation) {
	    var _this5 = this;
	
	    var view = this.children[index];
	
	    var removeAction = function removeAction() {
	      index = _this5.children.indexOf(view);
	      view.removeNodes();
	      _this5.children.splice(index, 1);
	
	      if (_this5.isAttached) {
	        view.detached();
	      }
	
	      if (returnToCache) {
	        view.returnToCache();
	      }
	
	      return view;
	    };
	
	    if (!skipAnimation) {
	      var animatableElement = getAnimatableElement(view);
	      if (animatableElement !== null) {
	        return this.animator.leave(animatableElement).then(function () {
	          return removeAction();
	        });
	      }
	    }
	
	    return removeAction();
	  };
	
	  ViewSlot.prototype.removeAll = function removeAll(returnToCache, skipAnimation) {
	    var _this6 = this;
	
	    var children = this.children;
	    var ii = children.length;
	    var i = void 0;
	    var rmPromises = [];
	
	    children.forEach(function (child) {
	      if (skipAnimation) {
	        child.removeNodes();
	        return;
	      }
	
	      var animatableElement = getAnimatableElement(child);
	      if (animatableElement !== null) {
	        rmPromises.push(_this6.animator.leave(animatableElement).then(function () {
	          return child.removeNodes();
	        }));
	      } else {
	        child.removeNodes();
	      }
	    });
	
	    var removeAction = function removeAction() {
	      if (_this6.isAttached) {
	        for (i = 0; i < ii; ++i) {
	          children[i].detached();
	        }
	      }
	
	      if (returnToCache) {
	        for (i = 0; i < ii; ++i) {
	          children[i].returnToCache();
	        }
	      }
	
	      _this6.children = [];
	    };
	
	    if (rmPromises.length > 0) {
	      return Promise.all(rmPromises).then(function () {
	        return removeAction();
	      });
	    }
	
	    removeAction();
	  };
	
	  ViewSlot.prototype.attached = function attached() {
	    var i = void 0;
	    var ii = void 0;
	    var children = void 0;
	    var child = void 0;
	
	    if (this.isAttached) {
	      return;
	    }
	
	    this.isAttached = true;
	
	    children = this.children;
	    for (i = 0, ii = children.length; i < ii; ++i) {
	      child = children[i];
	      child.attached();
	
	      var _element2 = child.firstChild ? _aureliaPal.DOM.nextElementSibling(child.firstChild) : null;
	      if (child.firstChild && child.firstChild.nodeType === 8 && _element2 && _element2.nodeType === 1 && _element2.classList.contains('au-animate')) {
	        this.animator.enter(_element2);
	      }
	    }
	  };
	
	  ViewSlot.prototype.detached = function detached() {
	    var i = void 0;
	    var ii = void 0;
	    var children = void 0;
	
	    if (this.isAttached) {
	      this.isAttached = false;
	      children = this.children;
	      for (i = 0, ii = children.length; i < ii; ++i) {
	        children[i].detached();
	      }
	    }
	  };
	
	  ViewSlot.prototype._installContentSelectors = function _installContentSelectors(contentSelectors) {
	    this.contentSelectors = contentSelectors;
	    this.add = this._contentSelectorAdd;
	    this.insert = this._contentSelectorInsert;
	    this.remove = this._contentSelectorRemove;
	    this.removeAt = this._contentSelectorRemoveAt;
	    this.removeAll = this._contentSelectorRemoveAll;
	  };
	
	  ViewSlot.prototype._contentSelectorAdd = function _contentSelectorAdd(view) {
	    _ContentSelector.applySelectors(view, this.contentSelectors, function (contentSelector, group) {
	      return contentSelector.add(group);
	    });
	
	    this.children.push(view);
	
	    if (this.isAttached) {
	      view.attached();
	    }
	  };
	
	  ViewSlot.prototype._contentSelectorInsert = function _contentSelectorInsert(index, view) {
	    if (index === 0 && !this.children.length || index >= this.children.length) {
	      this.add(view);
	    } else {
	      _ContentSelector.applySelectors(view, this.contentSelectors, function (contentSelector, group) {
	        return contentSelector.insert(index, group);
	      });
	
	      this.children.splice(index, 0, view);
	
	      if (this.isAttached) {
	        view.attached();
	      }
	    }
	  };
	
	  ViewSlot.prototype._contentSelectorRemove = function _contentSelectorRemove(view) {
	    var index = this.children.indexOf(view);
	    var contentSelectors = this.contentSelectors;
	    var i = void 0;
	    var ii = void 0;
	
	    for (i = 0, ii = contentSelectors.length; i < ii; ++i) {
	      contentSelectors[i].removeAt(index, view.fragment);
	    }
	
	    this.children.splice(index, 1);
	
	    if (this.isAttached) {
	      view.detached();
	    }
	  };
	
	  ViewSlot.prototype._contentSelectorRemoveAt = function _contentSelectorRemoveAt(index) {
	    var view = this.children[index];
	    var contentSelectors = this.contentSelectors;
	    var i = void 0;
	    var ii = void 0;
	
	    for (i = 0, ii = contentSelectors.length; i < ii; ++i) {
	      contentSelectors[i].removeAt(index, view.fragment);
	    }
	
	    this.children.splice(index, 1);
	
	    if (this.isAttached) {
	      view.detached();
	    }
	
	    return view;
	  };
	
	  ViewSlot.prototype._contentSelectorRemoveAll = function _contentSelectorRemoveAll() {
	    var children = this.children;
	    var contentSelectors = this.contentSelectors;
	    var ii = children.length;
	    var jj = contentSelectors.length;
	    var i = void 0;
	    var j = void 0;
	    var view = void 0;
	
	    for (i = 0; i < ii; ++i) {
	      view = children[i];
	
	      for (j = 0; j < jj; ++j) {
	        contentSelectors[j].removeAt(0, view.fragment);
	      }
	    }
	
	    if (this.isAttached) {
	      for (i = 0; i < ii; ++i) {
	        children[i].detached();
	      }
	    }
	
	    this.children = [];
	  };
	
	  return ViewSlot;
	}();
	
	var ProviderResolver = (0, _aureliaDependencyInjection.resolver)(_class11 = function () {
	  function ProviderResolver() {
	    _classCallCheck(this, ProviderResolver);
	  }
	
	  ProviderResolver.prototype.get = function get(container, key) {
	    var id = key.__providerId__;
	    return id in container ? container[id] : container[id] = container.invoke(key);
	  };
	
	  return ProviderResolver;
	}()) || _class11;
	
	var providerResolverInstance = new ProviderResolver();
	
	function elementContainerGet(key) {
	  if (key === _aureliaPal.DOM.Element) {
	    return this.element;
	  }
	
	  if (key === BoundViewFactory) {
	    if (this.boundViewFactory) {
	      return this.boundViewFactory;
	    }
	
	    var factory = this.instruction.viewFactory;
	    var _partReplacements = this.partReplacements;
	
	    if (_partReplacements) {
	      factory = _partReplacements[factory.part] || factory;
	    }
	
	    this.boundViewFactory = new BoundViewFactory(this, factory, _partReplacements);
	    return this.boundViewFactory;
	  }
	
	  if (key === ViewSlot) {
	    if (this.viewSlot === undefined) {
	      this.viewSlot = new ViewSlot(this.element, this.instruction.anchorIsContainer);
	      this.element.isContentProjectionSource = this.instruction.lifting;
	      this.children.push(this.viewSlot);
	    }
	
	    return this.viewSlot;
	  }
	
	  if (key === ElementEvents) {
	    return this.elementEvents || (this.elementEvents = new ElementEvents(this.element));
	  }
	
	  if (key === CompositionTransaction) {
	    return this.compositionTransaction || (this.compositionTransaction = this.parent.get(key));
	  }
	
	  if (key === ViewResources) {
	    return this.viewResources;
	  }
	
	  if (key === TargetInstruction) {
	    return this.instruction;
	  }
	
	  return this.superGet(key);
	}
	
	function createElementContainer(parent, element, instruction, children, partReplacements, resources) {
	  var container = parent.createChild();
	  var providers = void 0;
	  var i = void 0;
	
	  container.element = element;
	  container.instruction = instruction;
	  container.children = children;
	  container.viewResources = resources;
	  container.partReplacements = partReplacements;
	
	  providers = instruction.providers;
	  i = providers.length;
	
	  while (i--) {
	    container._resolvers.set(providers[i], providerResolverInstance);
	  }
	
	  container.superGet = container.get;
	  container.get = elementContainerGet;
	
	  return container;
	}
	
	function makeElementIntoAnchor(element, elementInstruction) {
	  var anchor = _aureliaPal.DOM.createComment('anchor');
	
	  if (elementInstruction) {
	    anchor.hasAttribute = function (name) {
	      return element.hasAttribute(name);
	    };
	    anchor.getAttribute = function (name) {
	      return element.getAttribute(name);
	    };
	    anchor.setAttribute = function (name, value) {
	      element.setAttribute(name, value);
	    };
	  }
	
	  _aureliaPal.DOM.replaceNode(anchor, element);
	
	  return anchor;
	}
	
	function applyInstructions(containers, element, instruction, controllers, bindings, children, contentSelectors, partReplacements, resources) {
	  var behaviorInstructions = instruction.behaviorInstructions;
	  var expressions = instruction.expressions;
	  var elementContainer = void 0;
	  var i = void 0;
	  var ii = void 0;
	  var current = void 0;
	  var instance = void 0;
	
	  if (instruction.contentExpression) {
	    bindings.push(instruction.contentExpression.createBinding(element.nextSibling));
	    element.parentNode.removeChild(element);
	    return;
	  }
	
	  if (instruction.contentSelector) {
	    var commentAnchor = _aureliaPal.DOM.createComment('anchor');
	    _aureliaPal.DOM.replaceNode(commentAnchor, element);
	    contentSelectors.push(new _ContentSelector(commentAnchor, instruction.selector));
	    return;
	  }
	
	  if (behaviorInstructions.length) {
	    if (!instruction.anchorIsContainer) {
	      element = makeElementIntoAnchor(element, instruction.elementInstruction);
	    }
	
	    containers[instruction.injectorId] = elementContainer = createElementContainer(containers[instruction.parentInjectorId], element, instruction, children, partReplacements, resources);
	
	    for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {
	      current = behaviorInstructions[i];
	      instance = current.type.create(elementContainer, current, element, bindings);
	
	      if (instance.contentView) {
	        children.push(instance.contentView);
	      }
	
	      controllers.push(instance);
	    }
	  }
	
	  for (i = 0, ii = expressions.length; i < ii; ++i) {
	    bindings.push(expressions[i].createBinding(element));
	  }
	}
	
	function styleStringToObject(style, target) {
	  var attributes = style.split(';');
	  var firstIndexOfColon = void 0;
	  var i = void 0;
	  var current = void 0;
	  var key = void 0;
	  var value = void 0;
	
	  target = target || {};
	
	  for (i = 0; i < attributes.length; i++) {
	    current = attributes[i];
	    firstIndexOfColon = current.indexOf(':');
	    key = current.substring(0, firstIndexOfColon).trim();
	    value = current.substring(firstIndexOfColon + 1).trim();
	    target[key] = value;
	  }
	
	  return target;
	}
	
	function styleObjectToString(obj) {
	  var result = '';
	
	  for (var key in obj) {
	    result += key + ':' + obj[key] + ';';
	  }
	
	  return result;
	}
	
	function applySurrogateInstruction(container, element, instruction, controllers, bindings, children) {
	  var behaviorInstructions = instruction.behaviorInstructions;
	  var expressions = instruction.expressions;
	  var providers = instruction.providers;
	  var values = instruction.values;
	  var i = void 0;
	  var ii = void 0;
	  var current = void 0;
	  var instance = void 0;
	  var currentAttributeValue = void 0;
	
	  i = providers.length;
	  while (i--) {
	    container._resolvers.set(providers[i], providerResolverInstance);
	  }
	
	  for (var key in values) {
	    currentAttributeValue = element.getAttribute(key);
	
	    if (currentAttributeValue) {
	      if (key === 'class') {
	        element.setAttribute('class', currentAttributeValue + ' ' + values[key]);
	      } else if (key === 'style') {
	        var styleObject = styleStringToObject(values[key]);
	        styleStringToObject(currentAttributeValue, styleObject);
	        element.setAttribute('style', styleObjectToString(styleObject));
	      }
	    } else {
	        element.setAttribute(key, values[key]);
	      }
	  }
	
	  if (behaviorInstructions.length) {
	    for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {
	      current = behaviorInstructions[i];
	      instance = current.type.create(container, current, element, bindings);
	
	      if (instance.contentView) {
	        children.push(instance.contentView);
	      }
	
	      controllers.push(instance);
	    }
	  }
	
	  for (i = 0, ii = expressions.length; i < ii; ++i) {
	    bindings.push(expressions[i].createBinding(element));
	  }
	}
	
	var BoundViewFactory = exports.BoundViewFactory = function () {
	  function BoundViewFactory(parentContainer, viewFactory, partReplacements) {
	    _classCallCheck(this, BoundViewFactory);
	
	    this.parentContainer = parentContainer;
	    this.viewFactory = viewFactory;
	    this.factoryCreateInstruction = { partReplacements: partReplacements };
	  }
	
	  BoundViewFactory.prototype.create = function create() {
	    var view = this.viewFactory.create(this.parentContainer.createChild(), this.factoryCreateInstruction);
	    view._isUserControlled = true;
	    return view;
	  };
	
	  BoundViewFactory.prototype.setCacheSize = function setCacheSize(size, doNotOverrideIfAlreadySet) {
	    this.viewFactory.setCacheSize(size, doNotOverrideIfAlreadySet);
	  };
	
	  BoundViewFactory.prototype.getCachedView = function getCachedView() {
	    return this.viewFactory.getCachedView();
	  };
	
	  BoundViewFactory.prototype.returnViewToCache = function returnViewToCache(view) {
	    this.viewFactory.returnViewToCache(view);
	  };
	
	  _createClass(BoundViewFactory, [{
	    key: 'isCaching',
	    get: function get() {
	      return this.viewFactory.isCaching;
	    }
	  }]);
	
	  return BoundViewFactory;
	}();
	
	var ViewFactory = exports.ViewFactory = function () {
	  function ViewFactory(template, instructions, resources) {
	    _classCallCheck(this, ViewFactory);
	
	    this.isCaching = false;
	
	    this.template = template;
	    this.instructions = instructions;
	    this.resources = resources;
	    this.cacheSize = -1;
	    this.cache = null;
	  }
	
	  ViewFactory.prototype.setCacheSize = function setCacheSize(size, doNotOverrideIfAlreadySet) {
	    if (size) {
	      if (size === '*') {
	        size = Number.MAX_VALUE;
	      } else if (typeof size === 'string') {
	        size = parseInt(size, 10);
	      }
	    }
	
	    if (this.cacheSize === -1 || !doNotOverrideIfAlreadySet) {
	      this.cacheSize = size;
	    }
	
	    if (this.cacheSize > 0) {
	      this.cache = [];
	    } else {
	      this.cache = null;
	    }
	
	    this.isCaching = this.cacheSize > 0;
	  };
	
	  ViewFactory.prototype.getCachedView = function getCachedView() {
	    return this.cache !== null ? this.cache.pop() || null : null;
	  };
	
	  ViewFactory.prototype.returnViewToCache = function returnViewToCache(view) {
	    if (view.isAttached) {
	      view.detached();
	    }
	
	    if (view.isBound) {
	      view.unbind();
	    }
	
	    if (this.cache !== null && this.cache.length < this.cacheSize) {
	      view.fromCache = true;
	      this.cache.push(view);
	    }
	  };
	
	  ViewFactory.prototype.create = function create(container, createInstruction, element) {
	    createInstruction = createInstruction || BehaviorInstruction.normal;
	    element = element || null;
	
	    var cachedView = this.getCachedView();
	    if (cachedView !== null) {
	      return cachedView;
	    }
	
	    var fragment = createInstruction.enhance ? this.template : this.template.cloneNode(true);
	    var instructables = fragment.querySelectorAll('.au-target');
	    var instructions = this.instructions;
	    var resources = this.resources;
	    var controllers = [];
	    var bindings = [];
	    var children = [];
	    var contentSelectors = [];
	    var containers = { root: container };
	    var partReplacements = createInstruction.partReplacements;
	    var i = void 0;
	    var ii = void 0;
	    var view = void 0;
	    var instructable = void 0;
	    var instruction = void 0;
	
	    this.resources._invokeHook('beforeCreate', this, container, fragment, createInstruction);
	
	    if (element !== null && this.surrogateInstruction !== null) {
	      applySurrogateInstruction(container, element, this.surrogateInstruction, controllers, bindings, children);
	    }
	
	    for (i = 0, ii = instructables.length; i < ii; ++i) {
	      instructable = instructables[i];
	      instruction = instructions[instructable.getAttribute('au-target-id')];
	
	      applyInstructions(containers, instructable, instruction, controllers, bindings, children, contentSelectors, partReplacements, resources);
	    }
	
	    view = new View(container, this, fragment, controllers, bindings, children, contentSelectors);
	
	    if (!createInstruction.initiatedByBehavior) {
	      view.created();
	    }
	
	    this.resources._invokeHook('afterCreate', view);
	
	    return view;
	  };
	
	  return ViewFactory;
	}();
	
	var nextInjectorId = 0;
	function getNextInjectorId() {
	  return ++nextInjectorId;
	}
	
	function configureProperties(instruction, resources) {
	  var type = instruction.type;
	  var attrName = instruction.attrName;
	  var attributes = instruction.attributes;
	  var property = void 0;
	  var key = void 0;
	  var value = void 0;
	
	  var knownAttribute = resources.mapAttribute(attrName);
	  if (knownAttribute && attrName in attributes && knownAttribute !== attrName) {
	    attributes[knownAttribute] = attributes[attrName];
	    delete attributes[attrName];
	  }
	
	  for (key in attributes) {
	    value = attributes[key];
	
	    if (value !== null && (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object') {
	      property = type.attributes[key];
	
	      if (property !== undefined) {
	        value.targetProperty = property.name;
	      } else {
	        value.targetProperty = key;
	      }
	    }
	  }
	}
	
	var lastAUTargetID = 0;
	function getNextAUTargetID() {
	  return (++lastAUTargetID).toString();
	}
	
	function makeIntoInstructionTarget(element) {
	  var value = element.getAttribute('class');
	  var auTargetID = getNextAUTargetID();
	
	  element.setAttribute('class', value ? value += ' au-target' : 'au-target');
	  element.setAttribute('au-target-id', auTargetID);
	
	  return auTargetID;
	}
	
	var ViewCompiler = exports.ViewCompiler = (_dec6 = (0, _aureliaDependencyInjection.inject)(BindingLanguage, ViewResources), _dec6(_class13 = function () {
	  function ViewCompiler(bindingLanguage, resources) {
	    _classCallCheck(this, ViewCompiler);
	
	    this.bindingLanguage = bindingLanguage;
	    this.resources = resources;
	  }
	
	  ViewCompiler.prototype.compile = function compile(source, resources, compileInstruction) {
	    resources = resources || this.resources;
	    compileInstruction = compileInstruction || ViewCompileInstruction.normal;
	    source = typeof source === 'string' ? _aureliaPal.DOM.createTemplateFromMarkup(source) : source;
	
	    var content = void 0;
	    var part = void 0;
	    var cacheSize = void 0;
	
	    if (source.content) {
	      part = source.getAttribute('part');
	      cacheSize = source.getAttribute('view-cache');
	      content = _aureliaPal.DOM.adoptNode(source.content);
	    } else {
	      content = source;
	    }
	
	    compileInstruction.targetShadowDOM = compileInstruction.targetShadowDOM && _aureliaPal.FEATURE.shadowDOM;
	    resources._invokeHook('beforeCompile', content, resources, compileInstruction);
	
	    var instructions = {};
	    this._compileNode(content, resources, instructions, source, 'root', !compileInstruction.targetShadowDOM);
	    content.insertBefore(_aureliaPal.DOM.createComment('<view>'), content.firstChild);
	    content.appendChild(_aureliaPal.DOM.createComment('</view>'));
	
	    var factory = new ViewFactory(content, instructions, resources);
	
	    factory.surrogateInstruction = compileInstruction.compileSurrogate ? this._compileSurrogate(source, resources) : null;
	    factory.part = part;
	
	    if (cacheSize) {
	      factory.setCacheSize(cacheSize);
	    }
	
	    resources._invokeHook('afterCompile', factory);
	
	    return factory;
	  };
	
	  ViewCompiler.prototype._compileNode = function _compileNode(node, resources, instructions, parentNode, parentInjectorId, targetLightDOM) {
	    switch (node.nodeType) {
	      case 1:
	        return this._compileElement(node, resources, instructions, parentNode, parentInjectorId, targetLightDOM);
	      case 3:
	        var expression = resources.getBindingLanguage(this.bindingLanguage).inspectTextContent(resources, node.wholeText);
	        if (expression) {
	          var marker = _aureliaPal.DOM.createElement('au-marker');
	          var auTargetID = makeIntoInstructionTarget(marker);
	          (node.parentNode || parentNode).insertBefore(marker, node);
	          node.textContent = ' ';
	          instructions[auTargetID] = TargetInstruction.contentExpression(expression);
	
	          while (node.nextSibling && node.nextSibling.nodeType === 3) {
	            (node.parentNode || parentNode).removeChild(node.nextSibling);
	          }
	        } else {
	          while (node.nextSibling && node.nextSibling.nodeType === 3) {
	            node = node.nextSibling;
	          }
	        }
	        return node.nextSibling;
	      case 11:
	        var currentChild = node.firstChild;
	        while (currentChild) {
	          currentChild = this._compileNode(currentChild, resources, instructions, node, parentInjectorId, targetLightDOM);
	        }
	        break;
	      default:
	        break;
	    }
	
	    return node.nextSibling;
	  };
	
	  ViewCompiler.prototype._compileSurrogate = function _compileSurrogate(node, resources) {
	    var tagName = node.tagName.toLowerCase();
	    var attributes = node.attributes;
	    var bindingLanguage = resources.getBindingLanguage(this.bindingLanguage);
	    var knownAttribute = void 0;
	    var property = void 0;
	    var instruction = void 0;
	    var i = void 0;
	    var ii = void 0;
	    var attr = void 0;
	    var attrName = void 0;
	    var attrValue = void 0;
	    var info = void 0;
	    var type = void 0;
	    var expressions = [];
	    var expression = void 0;
	    var behaviorInstructions = [];
	    var values = {};
	    var hasValues = false;
	    var providers = [];
	
	    for (i = 0, ii = attributes.length; i < ii; ++i) {
	      attr = attributes[i];
	      attrName = attr.name;
	      attrValue = attr.value;
	
	      info = bindingLanguage.inspectAttribute(resources, tagName, attrName, attrValue);
	      type = resources.getAttribute(info.attrName);
	
	      if (type) {
	        knownAttribute = resources.mapAttribute(info.attrName);
	        if (knownAttribute) {
	          property = type.attributes[knownAttribute];
	
	          if (property) {
	            info.defaultBindingMode = property.defaultBindingMode;
	
	            if (!info.command && !info.expression) {
	              info.command = property.hasOptions ? 'options' : null;
	            }
	          }
	        }
	      }
	
	      instruction = bindingLanguage.createAttributeInstruction(resources, node, info, undefined, type);
	
	      if (instruction) {
	        if (instruction.alteredAttr) {
	          type = resources.getAttribute(instruction.attrName);
	        }
	
	        if (instruction.discrete) {
	          expressions.push(instruction);
	        } else {
	          if (type) {
	            instruction.type = type;
	            configureProperties(instruction, resources);
	
	            if (type.liftsContent) {
	              throw new Error('You cannot place a template controller on a surrogate element.');
	            } else {
	              behaviorInstructions.push(instruction);
	            }
	          } else {
	            expressions.push(instruction.attributes[instruction.attrName]);
	          }
	        }
	      } else {
	        if (type) {
	          instruction = BehaviorInstruction.attribute(attrName, type);
	          instruction.attributes[resources.mapAttribute(attrName)] = attrValue;
	
	          if (type.liftsContent) {
	            throw new Error('You cannot place a template controller on a surrogate element.');
	          } else {
	            behaviorInstructions.push(instruction);
	          }
	        } else if (attrName !== 'id' && attrName !== 'part' && attrName !== 'replace-part') {
	          hasValues = true;
	          values[attrName] = attrValue;
	        }
	      }
	    }
	
	    if (expressions.length || behaviorInstructions.length || hasValues) {
	      for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {
	        instruction = behaviorInstructions[i];
	        instruction.type.compile(this, resources, node, instruction);
	        providers.push(instruction.type.target);
	      }
	
	      for (i = 0, ii = expressions.length; i < ii; ++i) {
	        expression = expressions[i];
	        if (expression.attrToRemove !== undefined) {
	          node.removeAttribute(expression.attrToRemove);
	        }
	      }
	
	      return TargetInstruction.surrogate(providers, behaviorInstructions, expressions, values);
	    }
	
	    return null;
	  };
	
	  ViewCompiler.prototype._compileElement = function _compileElement(node, resources, instructions, parentNode, parentInjectorId, targetLightDOM) {
	    var tagName = node.tagName.toLowerCase();
	    var attributes = node.attributes;
	    var expressions = [];
	    var expression = void 0;
	    var behaviorInstructions = [];
	    var providers = [];
	    var bindingLanguage = resources.getBindingLanguage(this.bindingLanguage);
	    var liftingInstruction = void 0;
	    var viewFactory = void 0;
	    var type = void 0;
	    var elementInstruction = void 0;
	    var elementProperty = void 0;
	    var i = void 0;
	    var ii = void 0;
	    var attr = void 0;
	    var attrName = void 0;
	    var attrValue = void 0;
	    var instruction = void 0;
	    var info = void 0;
	    var property = void 0;
	    var knownAttribute = void 0;
	    var auTargetID = void 0;
	    var injectorId = void 0;
	
	    if (tagName === 'content') {
	      if (targetLightDOM) {
	        auTargetID = makeIntoInstructionTarget(node);
	        instructions[auTargetID] = TargetInstruction.contentSelector(node, parentInjectorId);
	      }
	      return node.nextSibling;
	    } else if (tagName === 'template') {
	      viewFactory = this.compile(node, resources);
	      viewFactory.part = node.getAttribute('part');
	    } else {
	      type = resources.getElement(node.getAttribute('as-element') || tagName);
	      if (type) {
	        elementInstruction = BehaviorInstruction.element(node, type);
	        type.processAttributes(this, resources, node, attributes, elementInstruction);
	        behaviorInstructions.push(elementInstruction);
	      }
	    }
	
	    for (i = 0, ii = attributes.length; i < ii; ++i) {
	      attr = attributes[i];
	      attrName = attr.name;
	      attrValue = attr.value;
	      info = bindingLanguage.inspectAttribute(resources, tagName, attrName, attrValue);
	      type = resources.getAttribute(info.attrName);
	      elementProperty = null;
	
	      if (type) {
	        knownAttribute = resources.mapAttribute(info.attrName);
	        if (knownAttribute) {
	          property = type.attributes[knownAttribute];
	
	          if (property) {
	            info.defaultBindingMode = property.defaultBindingMode;
	
	            if (!info.command && !info.expression) {
	              info.command = property.hasOptions ? 'options' : null;
	            }
	          }
	        }
	      } else if (elementInstruction) {
	          elementProperty = elementInstruction.type.attributes[info.attrName];
	          if (elementProperty) {
	            info.defaultBindingMode = elementProperty.defaultBindingMode;
	          }
	        }
	
	      if (elementProperty) {
	        instruction = bindingLanguage.createAttributeInstruction(resources, node, info, elementInstruction);
	      } else {
	        instruction = bindingLanguage.createAttributeInstruction(resources, node, info, undefined, type);
	      }
	
	      if (instruction) {
	        if (instruction.alteredAttr) {
	          type = resources.getAttribute(instruction.attrName);
	        }
	
	        if (instruction.discrete) {
	          expressions.push(instruction);
	        } else {
	          if (type) {
	            instruction.type = type;
	            configureProperties(instruction, resources);
	
	            if (type.liftsContent) {
	              instruction.originalAttrName = attrName;
	              liftingInstruction = instruction;
	              break;
	            } else {
	              behaviorInstructions.push(instruction);
	            }
	          } else if (elementProperty) {
	            elementInstruction.attributes[info.attrName].targetProperty = elementProperty.name;
	          } else {
	            expressions.push(instruction.attributes[instruction.attrName]);
	          }
	        }
	      } else {
	        if (type) {
	          instruction = BehaviorInstruction.attribute(attrName, type);
	          instruction.attributes[resources.mapAttribute(attrName)] = attrValue;
	
	          if (type.liftsContent) {
	            instruction.originalAttrName = attrName;
	            liftingInstruction = instruction;
	            break;
	          } else {
	            behaviorInstructions.push(instruction);
	          }
	        } else if (elementProperty) {
	          elementInstruction.attributes[attrName] = attrValue;
	        }
	      }
	    }
	
	    if (liftingInstruction) {
	      liftingInstruction.viewFactory = viewFactory;
	      node = liftingInstruction.type.compile(this, resources, node, liftingInstruction, parentNode);
	      auTargetID = makeIntoInstructionTarget(node);
	      instructions[auTargetID] = TargetInstruction.lifting(parentInjectorId, liftingInstruction);
	    } else {
	      if (expressions.length || behaviorInstructions.length) {
	        injectorId = behaviorInstructions.length ? getNextInjectorId() : false;
	
	        for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {
	          instruction = behaviorInstructions[i];
	          instruction.type.compile(this, resources, node, instruction, parentNode);
	          providers.push(instruction.type.target);
	        }
	
	        for (i = 0, ii = expressions.length; i < ii; ++i) {
	          expression = expressions[i];
	          if (expression.attrToRemove !== undefined) {
	            node.removeAttribute(expression.attrToRemove);
	          }
	        }
	
	        auTargetID = makeIntoInstructionTarget(node);
	        instructions[auTargetID] = TargetInstruction.normal(injectorId, parentInjectorId, providers, behaviorInstructions, expressions, elementInstruction);
	      }
	
	      if (elementInstruction && elementInstruction.skipContentProcessing) {
	        return node.nextSibling;
	      }
	
	      var currentChild = node.firstChild;
	      while (currentChild) {
	        currentChild = this._compileNode(currentChild, resources, instructions, node, injectorId || parentInjectorId, targetLightDOM);
	      }
	    }
	
	    return node.nextSibling;
	  };
	
	  return ViewCompiler;
	}()) || _class13);
	
	var ResourceModule = exports.ResourceModule = function () {
	  function ResourceModule(moduleId) {
	    _classCallCheck(this, ResourceModule);
	
	    this.id = moduleId;
	    this.moduleInstance = null;
	    this.mainResource = null;
	    this.resources = null;
	    this.viewStrategy = null;
	    this.isInitialized = false;
	    this.onLoaded = null;
	  }
	
	  ResourceModule.prototype.initialize = function initialize(container) {
	    var current = this.mainResource;
	    var resources = this.resources;
	    var vs = this.viewStrategy;
	
	    if (this.isInitialized) {
	      return;
	    }
	
	    this.isInitialized = true;
	
	    if (current !== undefined) {
	      current.metadata.viewStrategy = vs;
	      current.initialize(container);
	    }
	
	    for (var i = 0, ii = resources.length; i < ii; ++i) {
	      current = resources[i];
	      current.metadata.viewStrategy = vs;
	      current.initialize(container);
	    }
	  };
	
	  ResourceModule.prototype.register = function register(registry, name) {
	    var main = this.mainResource;
	    var resources = this.resources;
	
	    if (main !== undefined) {
	      main.register(registry, name);
	      name = null;
	    }
	
	    for (var i = 0, ii = resources.length; i < ii; ++i) {
	      resources[i].register(registry, name);
	      name = null;
	    }
	  };
	
	  ResourceModule.prototype.load = function load(container, loadContext) {
	    if (this.onLoaded !== null) {
	      return this.onLoaded;
	    }
	
	    var main = this.mainResource;
	    var resources = this.resources;
	    var loads = void 0;
	
	    if (main !== undefined) {
	      loads = new Array(resources.length + 1);
	      loads[0] = main.load(container, loadContext);
	      for (var i = 0, ii = resources.length; i < ii; ++i) {
	        loads[i + 1] = resources[i].load(container, loadContext);
	      }
	    } else {
	      loads = new Array(resources.length);
	      for (var _i = 0, _ii = resources.length; _i < _ii; ++_i) {
	        loads[_i] = resources[_i].load(container, loadContext);
	      }
	    }
	
	    this.onLoaded = Promise.all(loads);
	    return this.onLoaded;
	  };
	
	  return ResourceModule;
	}();
	
	var ResourceDescription = exports.ResourceDescription = function () {
	  function ResourceDescription(key, exportedValue, resourceTypeMeta) {
	    _classCallCheck(this, ResourceDescription);
	
	    if (!resourceTypeMeta) {
	      resourceTypeMeta = _aureliaMetadata.metadata.get(_aureliaMetadata.metadata.resource, exportedValue);
	
	      if (!resourceTypeMeta) {
	        resourceTypeMeta = new HtmlBehaviorResource();
	        resourceTypeMeta.elementName = _hyphenate(key);
	        _aureliaMetadata.metadata.define(_aureliaMetadata.metadata.resource, resourceTypeMeta, exportedValue);
	      }
	    }
	
	    if (resourceTypeMeta instanceof HtmlBehaviorResource) {
	      if (resourceTypeMeta.elementName === undefined) {
	        resourceTypeMeta.elementName = _hyphenate(key);
	      } else if (resourceTypeMeta.attributeName === undefined) {
	        resourceTypeMeta.attributeName = _hyphenate(key);
	      } else if (resourceTypeMeta.attributeName === null && resourceTypeMeta.elementName === null) {
	        HtmlBehaviorResource.convention(key, resourceTypeMeta);
	      }
	    } else if (!resourceTypeMeta.name) {
	      resourceTypeMeta.name = _hyphenate(key);
	    }
	
	    this.metadata = resourceTypeMeta;
	    this.value = exportedValue;
	  }
	
	  ResourceDescription.prototype.initialize = function initialize(container) {
	    this.metadata.initialize(container, this.value);
	  };
	
	  ResourceDescription.prototype.register = function register(registry, name) {
	    this.metadata.register(registry, name);
	  };
	
	  ResourceDescription.prototype.load = function load(container, loadContext) {
	    return this.metadata.load(container, this.value, loadContext);
	  };
	
	  return ResourceDescription;
	}();
	
	var ModuleAnalyzer = exports.ModuleAnalyzer = function () {
	  function ModuleAnalyzer() {
	    _classCallCheck(this, ModuleAnalyzer);
	
	    this.cache = Object.create(null);
	  }
	
	  ModuleAnalyzer.prototype.getAnalysis = function getAnalysis(moduleId) {
	    return this.cache[moduleId];
	  };
	
	  ModuleAnalyzer.prototype.analyze = function analyze(moduleId, moduleInstance, mainResourceKey) {
	    var mainResource = void 0;
	    var fallbackValue = void 0;
	    var fallbackKey = void 0;
	    var resourceTypeMeta = void 0;
	    var key = void 0;
	    var exportedValue = void 0;
	    var resources = [];
	    var conventional = void 0;
	    var vs = void 0;
	    var resourceModule = void 0;
	
	    resourceModule = this.cache[moduleId];
	    if (resourceModule) {
	      return resourceModule;
	    }
	
	    resourceModule = new ResourceModule(moduleId);
	    this.cache[moduleId] = resourceModule;
	
	    if (typeof moduleInstance === 'function') {
	      moduleInstance = { 'default': moduleInstance };
	    }
	
	    if (mainResourceKey) {
	      mainResource = new ResourceDescription(mainResourceKey, moduleInstance[mainResourceKey]);
	    }
	
	    for (key in moduleInstance) {
	      exportedValue = moduleInstance[key];
	
	      if (key === mainResourceKey || typeof exportedValue !== 'function') {
	        continue;
	      }
	
	      resourceTypeMeta = _aureliaMetadata.metadata.get(_aureliaMetadata.metadata.resource, exportedValue);
	
	      if (resourceTypeMeta) {
	        if (resourceTypeMeta.attributeName === null && resourceTypeMeta.elementName === null) {
	          HtmlBehaviorResource.convention(key, resourceTypeMeta);
	        }
	
	        if (resourceTypeMeta.attributeName === null && resourceTypeMeta.elementName === null) {
	          resourceTypeMeta.elementName = _hyphenate(key);
	        }
	
	        if (!mainResource && resourceTypeMeta instanceof HtmlBehaviorResource && resourceTypeMeta.elementName !== null) {
	          mainResource = new ResourceDescription(key, exportedValue, resourceTypeMeta);
	        } else {
	          resources.push(new ResourceDescription(key, exportedValue, resourceTypeMeta));
	        }
	      } else if (viewStrategy.decorates(exportedValue)) {
	        vs = exportedValue;
	      } else if (exportedValue instanceof _aureliaLoader.TemplateRegistryEntry) {
	        vs = new TemplateRegistryViewStrategy(moduleId, exportedValue);
	      } else {
	        if (conventional = HtmlBehaviorResource.convention(key)) {
	          if (conventional.elementName !== null && !mainResource) {
	            mainResource = new ResourceDescription(key, exportedValue, conventional);
	          } else {
	            resources.push(new ResourceDescription(key, exportedValue, conventional));
	          }
	
	          _aureliaMetadata.metadata.define(_aureliaMetadata.metadata.resource, conventional, exportedValue);
	        } else if (conventional = _aureliaBinding.ValueConverterResource.convention(key)) {
	          resources.push(new ResourceDescription(key, exportedValue, conventional));
	          _aureliaMetadata.metadata.define(_aureliaMetadata.metadata.resource, conventional, exportedValue);
	        } else if (conventional = _aureliaBinding.BindingBehaviorResource.convention(key)) {
	          resources.push(new ResourceDescription(key, exportedValue, conventional));
	          _aureliaMetadata.metadata.define(_aureliaMetadata.metadata.resource, conventional, exportedValue);
	        } else if (!fallbackValue) {
	          fallbackValue = exportedValue;
	          fallbackKey = key;
	        }
	      }
	    }
	
	    if (!mainResource && fallbackValue) {
	      mainResource = new ResourceDescription(fallbackKey, fallbackValue);
	    }
	
	    resourceModule.moduleInstance = moduleInstance;
	    resourceModule.mainResource = mainResource;
	    resourceModule.resources = resources;
	    resourceModule.viewStrategy = vs;
	
	    return resourceModule;
	  };
	
	  return ModuleAnalyzer;
	}();
	
	var logger = LogManager.getLogger('templating');
	
	function ensureRegistryEntry(loader, urlOrRegistryEntry) {
	  if (urlOrRegistryEntry instanceof _aureliaLoader.TemplateRegistryEntry) {
	    return Promise.resolve(urlOrRegistryEntry);
	  }
	
	  return loader.loadTemplate(urlOrRegistryEntry);
	}
	
	var ProxyViewFactory = function () {
	  function ProxyViewFactory(promise) {
	    var _this7 = this;
	
	    _classCallCheck(this, ProxyViewFactory);
	
	    promise.then(function (x) {
	      return _this7.viewFactory = x;
	    });
	  }
	
	  ProxyViewFactory.prototype.create = function create(container, bindingContext, createInstruction, element) {
	    return this.viewFactory.create(container, bindingContext, createInstruction, element);
	  };
	
	  ProxyViewFactory.prototype.setCacheSize = function setCacheSize(size, doNotOverrideIfAlreadySet) {
	    this.viewFactory.setCacheSize(size, doNotOverrideIfAlreadySet);
	  };
	
	  ProxyViewFactory.prototype.getCachedView = function getCachedView() {
	    return this.viewFactory.getCachedView();
	  };
	
	  ProxyViewFactory.prototype.returnViewToCache = function returnViewToCache(view) {
	    this.viewFactory.returnViewToCache(view);
	  };
	
	  _createClass(ProxyViewFactory, [{
	    key: 'isCaching',
	    get: function get() {
	      return this.viewFactory.isCaching;
	    }
	  }]);
	
	  return ProxyViewFactory;
	}();
	
	var ViewEngine = exports.ViewEngine = (_dec7 = (0, _aureliaDependencyInjection.inject)(_aureliaLoader.Loader, _aureliaDependencyInjection.Container, ViewCompiler, ModuleAnalyzer, ViewResources), _dec7(_class14 = function () {
	  function ViewEngine(loader, container, viewCompiler, moduleAnalyzer, appResources) {
	    _classCallCheck(this, ViewEngine);
	
	    this.loader = loader;
	    this.container = container;
	    this.viewCompiler = viewCompiler;
	    this.moduleAnalyzer = moduleAnalyzer;
	    this.appResources = appResources;
	    this._pluginMap = {};
	  }
	
	  ViewEngine.prototype.addResourcePlugin = function addResourcePlugin(extension, implementation) {
	    var name = extension.replace('.', '') + '-resource-plugin';
	    this._pluginMap[extension] = name;
	    this.loader.addPlugin(name, implementation);
	  };
	
	  ViewEngine.prototype.loadViewFactory = function loadViewFactory(urlOrRegistryEntry, compileInstruction, loadContext) {
	    var _this8 = this;
	
	    loadContext = loadContext || new ResourceLoadContext();
	
	    return ensureRegistryEntry(this.loader, urlOrRegistryEntry).then(function (registryEntry) {
	      if (registryEntry.onReady) {
	        if (!loadContext.hasDependency(urlOrRegistryEntry)) {
	          loadContext.addDependency(urlOrRegistryEntry);
	          return registryEntry.onReady;
	        }
	
	        return Promise.resolve(new ProxyViewFactory(registryEntry.onReady));
	      }
	
	      loadContext.addDependency(urlOrRegistryEntry);
	
	      registryEntry.onReady = _this8.loadTemplateResources(registryEntry, compileInstruction, loadContext).then(function (resources) {
	        registryEntry.resources = resources;
	        var viewFactory = _this8.viewCompiler.compile(registryEntry.template, resources, compileInstruction);
	        registryEntry.factory = viewFactory;
	        return viewFactory;
	      });
	
	      return registryEntry.onReady;
	    });
	  };
	
	  ViewEngine.prototype.loadTemplateResources = function loadTemplateResources(registryEntry, compileInstruction, loadContext) {
	    var resources = new ViewResources(this.appResources, registryEntry.address);
	    var dependencies = registryEntry.dependencies;
	    var importIds = void 0;
	    var names = void 0;
	
	    compileInstruction = compileInstruction || ViewCompileInstruction.normal;
	
	    if (dependencies.length === 0 && !compileInstruction.associatedModuleId) {
	      return Promise.resolve(resources);
	    }
	
	    importIds = dependencies.map(function (x) {
	      return x.src;
	    });
	    names = dependencies.map(function (x) {
	      return x.name;
	    });
	    logger.debug('importing resources for ' + registryEntry.address, importIds);
	
	    return this.importViewResources(importIds, names, resources, compileInstruction, loadContext);
	  };
	
	  ViewEngine.prototype.importViewModelResource = function importViewModelResource(moduleImport, moduleMember) {
	    var _this9 = this;
	
	    return this.loader.loadModule(moduleImport).then(function (viewModelModule) {
	      var normalizedId = _aureliaMetadata.Origin.get(viewModelModule).moduleId;
	      var resourceModule = _this9.moduleAnalyzer.analyze(normalizedId, viewModelModule, moduleMember);
	
	      if (!resourceModule.mainResource) {
	        throw new Error('No view model found in module "' + moduleImport + '".');
	      }
	
	      resourceModule.initialize(_this9.container);
	
	      return resourceModule.mainResource;
	    });
	  };
	
	  ViewEngine.prototype.importViewResources = function importViewResources(moduleIds, names, resources, compileInstruction, loadContext) {
	    var _this10 = this;
	
	    loadContext = loadContext || new ResourceLoadContext();
	    compileInstruction = compileInstruction || ViewCompileInstruction.normal;
	
	    moduleIds = moduleIds.map(function (x) {
	      return _this10._applyLoaderPlugin(x);
	    });
	
	    return this.loader.loadAllModules(moduleIds).then(function (imports) {
	      var i = void 0;
	      var ii = void 0;
	      var analysis = void 0;
	      var normalizedId = void 0;
	      var current = void 0;
	      var associatedModule = void 0;
	      var container = _this10.container;
	      var moduleAnalyzer = _this10.moduleAnalyzer;
	      var allAnalysis = new Array(imports.length);
	
	      for (i = 0, ii = imports.length; i < ii; ++i) {
	        current = imports[i];
	        normalizedId = _aureliaMetadata.Origin.get(current).moduleId;
	
	        analysis = moduleAnalyzer.analyze(normalizedId, current);
	        analysis.initialize(container);
	        analysis.register(resources, names[i]);
	
	        allAnalysis[i] = analysis;
	      }
	
	      if (compileInstruction.associatedModuleId) {
	        associatedModule = moduleAnalyzer.getAnalysis(compileInstruction.associatedModuleId);
	
	        if (associatedModule) {
	          associatedModule.register(resources);
	        }
	      }
	
	      for (i = 0, ii = allAnalysis.length; i < ii; ++i) {
	        allAnalysis[i] = allAnalysis[i].load(container, loadContext);
	      }
	
	      return Promise.all(allAnalysis).then(function () {
	        return resources;
	      });
	    });
	  };
	
	  ViewEngine.prototype._applyLoaderPlugin = function _applyLoaderPlugin(id) {
	    var index = id.lastIndexOf('.');
	    if (index !== -1) {
	      var ext = id.substring(index);
	      var pluginName = this._pluginMap[ext];
	
	      if (pluginName === undefined) {
	        return id;
	      }
	
	      return this.loader.applyPluginToUrl(id, pluginName);
	    }
	
	    return id;
	  };
	
	  return ViewEngine;
	}()) || _class14);
	
	var Controller = exports.Controller = function () {
	  function Controller(behavior, instruction, viewModel, elementEvents) {
	    _classCallCheck(this, Controller);
	
	    this.behavior = behavior;
	    this.instruction = instruction;
	    this.viewModel = viewModel;
	    this.isAttached = false;
	    this.view = null;
	    this.isBound = false;
	    this.scope = null;
	    this.elementEvents = elementEvents || null;
	
	    var observerLookup = behavior.observerLocator.getOrCreateObserversLookup(viewModel);
	    var handlesBind = behavior.handlesBind;
	    var attributes = instruction.attributes;
	    var boundProperties = this.boundProperties = [];
	    var properties = behavior.properties;
	    var i = void 0;
	    var ii = void 0;
	
	    behavior._ensurePropertiesDefined(viewModel, observerLookup);
	
	    for (i = 0, ii = properties.length; i < ii; ++i) {
	      properties[i]._initialize(viewModel, observerLookup, attributes, handlesBind, boundProperties);
	    }
	  }
	
	  Controller.prototype.created = function created(owningView) {
	    if (this.behavior.handlesCreated) {
	      this.viewModel.created(owningView, this.view);
	    }
	  };
	
	  Controller.prototype.automate = function automate(overrideContext, owningView) {
	    this.view.bindingContext = this.viewModel;
	    this.view.overrideContext = overrideContext || (0, _aureliaBinding.createOverrideContext)(this.viewModel);
	    this.view._isUserControlled = true;
	
	    if (this.behavior.handlesCreated) {
	      this.viewModel.created(owningView || null, this.view);
	    }
	
	    this.bind(this.view);
	  };
	
	  Controller.prototype.bind = function bind(scope) {
	    var skipSelfSubscriber = this.behavior.handlesBind;
	    var boundProperties = this.boundProperties;
	    var i = void 0;
	    var ii = void 0;
	    var x = void 0;
	    var observer = void 0;
	    var selfSubscriber = void 0;
	
	    if (this.isBound) {
	      if (this.scope === scope) {
	        return;
	      }
	
	      this.unbind();
	    }
	
	    this.isBound = true;
	    this.scope = scope;
	
	    for (i = 0, ii = boundProperties.length; i < ii; ++i) {
	      x = boundProperties[i];
	      observer = x.observer;
	      selfSubscriber = observer.selfSubscriber;
	      observer.publishing = false;
	
	      if (skipSelfSubscriber) {
	        observer.selfSubscriber = null;
	      }
	
	      x.binding.bind(scope);
	      observer.call();
	
	      observer.publishing = true;
	      observer.selfSubscriber = selfSubscriber;
	    }
	
	    var overrideContext = void 0;
	    if (this.view !== null) {
	      if (skipSelfSubscriber) {
	        this.view.viewModelScope = scope;
	      }
	
	      if (this.viewModel === scope.overrideContext.bindingContext) {
	        overrideContext = scope.overrideContext;
	      } else if (this.instruction.inheritBindingContext) {
	          overrideContext = (0, _aureliaBinding.createOverrideContext)(this.viewModel, scope.overrideContext);
	        } else {
	            overrideContext = (0, _aureliaBinding.createOverrideContext)(this.viewModel);
	            overrideContext.__parentOverrideContext = scope.overrideContext;
	          }
	      this.view.bind(this.viewModel, overrideContext);
	    } else if (skipSelfSubscriber) {
	      overrideContext = scope.overrideContext;
	
	      if (scope.overrideContext.__parentOverrideContext !== undefined && this.viewModel.viewFactory && this.viewModel.viewFactory.factoryCreateInstruction.partReplacements) {
	        overrideContext = Object.assign({}, scope.overrideContext);
	        overrideContext.parentOverrideContext = scope.overrideContext.__parentOverrideContext;
	      }
	      this.viewModel.bind(scope.bindingContext, overrideContext);
	    }
	  };
	
	  Controller.prototype.unbind = function unbind() {
	    if (this.isBound) {
	      var boundProperties = this.boundProperties;
	      var i = void 0;
	      var ii = void 0;
	
	      this.isBound = false;
	      this.scope = null;
	
	      if (this.view !== null) {
	        this.view.unbind();
	      }
	
	      if (this.behavior.handlesUnbind) {
	        this.viewModel.unbind();
	      }
	
	      if (this.elementEvents !== null) {
	        this.elementEvents.disposeAll();
	      }
	
	      for (i = 0, ii = boundProperties.length; i < ii; ++i) {
	        boundProperties[i].binding.unbind();
	      }
	    }
	  };
	
	  Controller.prototype.attached = function attached() {
	    if (this.isAttached) {
	      return;
	    }
	
	    this.isAttached = true;
	
	    if (this.behavior.handlesAttached) {
	      this.viewModel.attached();
	    }
	
	    if (this.view !== null) {
	      this.view.attached();
	    }
	  };
	
	  Controller.prototype.detached = function detached() {
	    if (this.isAttached) {
	      this.isAttached = false;
	
	      if (this.view !== null) {
	        this.view.detached();
	      }
	
	      if (this.behavior.handlesDetached) {
	        this.viewModel.detached();
	      }
	    }
	  };
	
	  return Controller;
	}();
	
	var BehaviorPropertyObserver = exports.BehaviorPropertyObserver = (_dec8 = (0, _aureliaBinding.subscriberCollection)(), _dec8(_class16 = function () {
	  function BehaviorPropertyObserver(taskQueue, obj, propertyName, selfSubscriber, initialValue) {
	    _classCallCheck(this, BehaviorPropertyObserver);
	
	    this.taskQueue = taskQueue;
	    this.obj = obj;
	    this.propertyName = propertyName;
	    this.notqueued = true;
	    this.publishing = false;
	    this.selfSubscriber = selfSubscriber;
	    this.currentValue = this.oldValue = initialValue;
	  }
	
	  BehaviorPropertyObserver.prototype.getValue = function getValue() {
	    return this.currentValue;
	  };
	
	  BehaviorPropertyObserver.prototype.setValue = function setValue(newValue) {
	    var oldValue = this.currentValue;
	
	    if (oldValue !== newValue) {
	      if (this.publishing && this.notqueued) {
	        this.notqueued = false;
	        this.taskQueue.queueMicroTask(this);
	      }
	
	      this.oldValue = oldValue;
	      this.currentValue = newValue;
	    }
	  };
	
	  BehaviorPropertyObserver.prototype.call = function call() {
	    var oldValue = this.oldValue;
	    var newValue = this.currentValue;
	
	    this.notqueued = true;
	
	    if (newValue === oldValue) {
	      return;
	    }
	
	    if (this.selfSubscriber) {
	      this.selfSubscriber(newValue, oldValue);
	    }
	
	    this.callSubscribers(newValue, oldValue);
	    this.oldValue = newValue;
	  };
	
	  BehaviorPropertyObserver.prototype.subscribe = function subscribe(context, callable) {
	    this.addSubscriber(context, callable);
	  };
	
	  BehaviorPropertyObserver.prototype.unsubscribe = function unsubscribe(context, callable) {
	    this.removeSubscriber(context, callable);
	  };
	
	  return BehaviorPropertyObserver;
	}()) || _class16);
	
	
	function getObserver(behavior, instance, name) {
	  var lookup = instance.__observers__;
	
	  if (lookup === undefined) {
	    if (!behavior.isInitialized) {
	      behavior.initialize(_aureliaDependencyInjection.Container.instance || new _aureliaDependencyInjection.Container(), instance.constructor);
	    }
	
	    lookup = behavior.observerLocator.getOrCreateObserversLookup(instance);
	    behavior._ensurePropertiesDefined(instance, lookup);
	  }
	
	  return lookup[name];
	}
	
	var BindableProperty = exports.BindableProperty = function () {
	  function BindableProperty(nameOrConfig) {
	    _classCallCheck(this, BindableProperty);
	
	    if (typeof nameOrConfig === 'string') {
	      this.name = nameOrConfig;
	    } else {
	      Object.assign(this, nameOrConfig);
	    }
	
	    this.attribute = this.attribute || _hyphenate(this.name);
	    if (this.defaultBindingMode === null || this.defaultBindingMode === undefined) {
	      this.defaultBindingMode = _aureliaBinding.bindingMode.oneWay;
	    }
	    this.changeHandler = this.changeHandler || null;
	    this.owner = null;
	    this.descriptor = null;
	  }
	
	  BindableProperty.prototype.registerWith = function registerWith(target, behavior, descriptor) {
	    behavior.properties.push(this);
	    behavior.attributes[this.attribute] = this;
	    this.owner = behavior;
	
	    if (descriptor) {
	      this.descriptor = descriptor;
	      return this._configureDescriptor(behavior, descriptor);
	    }
	  };
	
	  BindableProperty.prototype._configureDescriptor = function _configureDescriptor(behavior, descriptor) {
	    var name = this.name;
	
	    descriptor.configurable = true;
	    descriptor.enumerable = true;
	
	    if ('initializer' in descriptor) {
	      this.defaultValue = descriptor.initializer;
	      delete descriptor.initializer;
	      delete descriptor.writable;
	    }
	
	    if ('value' in descriptor) {
	      this.defaultValue = descriptor.value;
	      delete descriptor.value;
	      delete descriptor.writable;
	    }
	
	    descriptor.get = function () {
	      return getObserver(behavior, this, name).getValue();
	    };
	
	    descriptor.set = function (value) {
	      getObserver(behavior, this, name).setValue(value);
	    };
	
	    descriptor.get.getObserver = function (obj) {
	      return getObserver(behavior, obj, name);
	    };
	
	    return descriptor;
	  };
	
	  BindableProperty.prototype.defineOn = function defineOn(target, behavior) {
	    var name = this.name;
	    var handlerName = void 0;
	
	    if (this.changeHandler === null) {
	      handlerName = name + 'Changed';
	      if (handlerName in target.prototype) {
	        this.changeHandler = handlerName;
	      }
	    }
	
	    if (this.descriptor === null) {
	      Object.defineProperty(target.prototype, name, this._configureDescriptor(behavior, {}));
	    }
	  };
	
	  BindableProperty.prototype.createObserver = function createObserver(viewModel) {
	    var selfSubscriber = null;
	    var defaultValue = this.defaultValue;
	    var changeHandlerName = this.changeHandler;
	    var name = this.name;
	    var initialValue = void 0;
	
	    if (this.hasOptions) {
	      return undefined;
	    }
	
	    if (changeHandlerName in viewModel) {
	      if ('propertyChanged' in viewModel) {
	        selfSubscriber = function selfSubscriber(newValue, oldValue) {
	          viewModel[changeHandlerName](newValue, oldValue);
	          viewModel.propertyChanged(name, newValue, oldValue);
	        };
	      } else {
	        selfSubscriber = function selfSubscriber(newValue, oldValue) {
	          return viewModel[changeHandlerName](newValue, oldValue);
	        };
	      }
	    } else if ('propertyChanged' in viewModel) {
	      selfSubscriber = function selfSubscriber(newValue, oldValue) {
	        return viewModel.propertyChanged(name, newValue, oldValue);
	      };
	    } else if (changeHandlerName !== null) {
	      throw new Error('Change handler ' + changeHandlerName + ' was specified but not declared on the class.');
	    }
	
	    if (defaultValue !== undefined) {
	      initialValue = typeof defaultValue === 'function' ? defaultValue.call(viewModel) : defaultValue;
	    }
	
	    return new BehaviorPropertyObserver(this.owner.taskQueue, viewModel, this.name, selfSubscriber, initialValue);
	  };
	
	  BindableProperty.prototype._initialize = function _initialize(viewModel, observerLookup, attributes, behaviorHandlesBind, boundProperties) {
	    var selfSubscriber = void 0;
	    var observer = void 0;
	    var attribute = void 0;
	    var defaultValue = this.defaultValue;
	
	    if (this.isDynamic) {
	      for (var key in attributes) {
	        this._createDynamicProperty(viewModel, observerLookup, behaviorHandlesBind, key, attributes[key], boundProperties);
	      }
	    } else if (!this.hasOptions) {
	      observer = observerLookup[this.name];
	
	      if (attributes !== null) {
	        selfSubscriber = observer.selfSubscriber;
	        attribute = attributes[this.attribute];
	
	        if (behaviorHandlesBind) {
	          observer.selfSubscriber = null;
	        }
	
	        if (typeof attribute === 'string') {
	          viewModel[this.name] = attribute;
	          observer.call();
	        } else if (attribute) {
	          boundProperties.push({ observer: observer, binding: attribute.createBinding(viewModel) });
	        } else if (defaultValue !== undefined) {
	          observer.call();
	        }
	
	        observer.selfSubscriber = selfSubscriber;
	      }
	
	      observer.publishing = true;
	    }
	  };
	
	  BindableProperty.prototype._createDynamicProperty = function _createDynamicProperty(viewModel, observerLookup, behaviorHandlesBind, name, attribute, boundProperties) {
	    var changeHandlerName = name + 'Changed';
	    var selfSubscriber = null;
	    var observer = void 0;
	    var info = void 0;
	
	    if (changeHandlerName in viewModel) {
	      if ('propertyChanged' in viewModel) {
	        selfSubscriber = function selfSubscriber(newValue, oldValue) {
	          viewModel[changeHandlerName](newValue, oldValue);
	          viewModel.propertyChanged(name, newValue, oldValue);
	        };
	      } else {
	        selfSubscriber = function selfSubscriber(newValue, oldValue) {
	          return viewModel[changeHandlerName](newValue, oldValue);
	        };
	      }
	    } else if ('propertyChanged' in viewModel) {
	      selfSubscriber = function selfSubscriber(newValue, oldValue) {
	        return viewModel.propertyChanged(name, newValue, oldValue);
	      };
	    }
	
	    observer = observerLookup[name] = new BehaviorPropertyObserver(this.owner.taskQueue, viewModel, name, selfSubscriber);
	
	    Object.defineProperty(viewModel, name, {
	      configurable: true,
	      enumerable: true,
	      get: observer.getValue.bind(observer),
	      set: observer.setValue.bind(observer)
	    });
	
	    if (behaviorHandlesBind) {
	      observer.selfSubscriber = null;
	    }
	
	    if (typeof attribute === 'string') {
	      viewModel[name] = attribute;
	      observer.call();
	    } else if (attribute) {
	      info = { observer: observer, binding: attribute.createBinding(viewModel) };
	      boundProperties.push(info);
	    }
	
	    observer.publishing = true;
	    observer.selfSubscriber = selfSubscriber;
	  };
	
	  return BindableProperty;
	}();
	
	var contentSelectorViewCreateInstruction = { enhance: false };
	var lastProviderId = 0;
	
	function nextProviderId() {
	  return ++lastProviderId;
	}
	
	function doProcessContent() {
	  return true;
	}
	function doProcessAttributes() {}
	
	var HtmlBehaviorResource = exports.HtmlBehaviorResource = function () {
	  function HtmlBehaviorResource() {
	    _classCallCheck(this, HtmlBehaviorResource);
	
	    this.elementName = null;
	    this.attributeName = null;
	    this.attributeDefaultBindingMode = undefined;
	    this.liftsContent = false;
	    this.targetShadowDOM = false;
	    this.processAttributes = doProcessAttributes;
	    this.processContent = doProcessContent;
	    this.usesShadowDOM = false;
	    this.childBindings = null;
	    this.hasDynamicOptions = false;
	    this.containerless = false;
	    this.properties = [];
	    this.attributes = {};
	    this.isInitialized = false;
	  }
	
	  HtmlBehaviorResource.convention = function convention(name, existing) {
	    var behavior = void 0;
	
	    if (name.endsWith('CustomAttribute')) {
	      behavior = existing || new HtmlBehaviorResource();
	      behavior.attributeName = _hyphenate(name.substring(0, name.length - 15));
	    }
	
	    if (name.endsWith('CustomElement')) {
	      behavior = existing || new HtmlBehaviorResource();
	      behavior.elementName = _hyphenate(name.substring(0, name.length - 13));
	    }
	
	    return behavior;
	  };
	
	  HtmlBehaviorResource.prototype.addChildBinding = function addChildBinding(behavior) {
	    if (this.childBindings === null) {
	      this.childBindings = [];
	    }
	
	    this.childBindings.push(behavior);
	  };
	
	  HtmlBehaviorResource.prototype.initialize = function initialize(container, target) {
	    var proto = target.prototype;
	    var properties = this.properties;
	    var attributeName = this.attributeName;
	    var attributeDefaultBindingMode = this.attributeDefaultBindingMode;
	    var i = void 0;
	    var ii = void 0;
	    var current = void 0;
	
	    if (this.isInitialized) {
	      return;
	    }
	
	    this.isInitialized = true;
	    target.__providerId__ = nextProviderId();
	
	    this.observerLocator = container.get(_aureliaBinding.ObserverLocator);
	    this.taskQueue = container.get(_aureliaTaskQueue.TaskQueue);
	
	    this.target = target;
	    this.usesShadowDOM = this.targetShadowDOM && _aureliaPal.FEATURE.shadowDOM;
	    this.handlesCreated = 'created' in proto;
	    this.handlesBind = 'bind' in proto;
	    this.handlesUnbind = 'unbind' in proto;
	    this.handlesAttached = 'attached' in proto;
	    this.handlesDetached = 'detached' in proto;
	    this.htmlName = this.elementName || this.attributeName;
	
	    if (attributeName !== null) {
	      if (properties.length === 0) {
	        new BindableProperty({
	          name: 'value',
	          changeHandler: 'valueChanged' in proto ? 'valueChanged' : null,
	          attribute: attributeName,
	          defaultBindingMode: attributeDefaultBindingMode
	        }).registerWith(target, this);
	      }
	
	      current = properties[0];
	
	      if (properties.length === 1 && current.name === 'value') {
	        current.isDynamic = current.hasOptions = this.hasDynamicOptions;
	        current.defineOn(target, this);
	      } else {
	        for (i = 0, ii = properties.length; i < ii; ++i) {
	          properties[i].defineOn(target, this);
	        }
	
	        current = new BindableProperty({
	          name: 'value',
	          changeHandler: 'valueChanged' in proto ? 'valueChanged' : null,
	          attribute: attributeName,
	          defaultBindingMode: attributeDefaultBindingMode
	        });
	
	        current.hasOptions = true;
	        current.registerWith(target, this);
	      }
	    } else {
	      for (i = 0, ii = properties.length; i < ii; ++i) {
	        properties[i].defineOn(target, this);
	      }
	    }
	  };
	
	  HtmlBehaviorResource.prototype.register = function register(registry, name) {
	    if (this.attributeName !== null) {
	      registry.registerAttribute(name || this.attributeName, this, this.attributeName);
	    }
	
	    if (this.elementName !== null) {
	      registry.registerElement(name || this.elementName, this);
	    }
	  };
	
	  HtmlBehaviorResource.prototype.load = function load(container, target, loadContext, viewStrategy, transientView) {
	    var _this11 = this;
	
	    var options = void 0;
	
	    if (this.elementName !== null) {
	      viewStrategy = container.get(ViewLocator).getViewStrategy(viewStrategy || this.viewStrategy || target);
	      options = new ViewCompileInstruction(this.targetShadowDOM, true);
	
	      if (!viewStrategy.moduleId) {
	        viewStrategy.moduleId = _aureliaMetadata.Origin.get(target).moduleId;
	      }
	
	      return viewStrategy.loadViewFactory(container.get(ViewEngine), options, loadContext).then(function (viewFactory) {
	        if (!transientView || !_this11.viewFactory) {
	          _this11.viewFactory = viewFactory;
	        }
	
	        return viewFactory;
	      });
	    }
	
	    return Promise.resolve(this);
	  };
	
	  HtmlBehaviorResource.prototype.compile = function compile(compiler, resources, node, instruction, parentNode) {
	    if (this.liftsContent) {
	      if (!instruction.viewFactory) {
	        var template = _aureliaPal.DOM.createElement('template');
	        var fragment = _aureliaPal.DOM.createDocumentFragment();
	        var cacheSize = node.getAttribute('view-cache');
	        var part = node.getAttribute('part');
	
	        node.removeAttribute(instruction.originalAttrName);
	        _aureliaPal.DOM.replaceNode(template, node, parentNode);
	        fragment.appendChild(node);
	        instruction.viewFactory = compiler.compile(fragment, resources);
	
	        if (part) {
	          instruction.viewFactory.part = part;
	          node.removeAttribute('part');
	        }
	
	        if (cacheSize) {
	          instruction.viewFactory.setCacheSize(cacheSize);
	          node.removeAttribute('view-cache');
	        }
	
	        node = template;
	      }
	    } else if (this.elementName !== null) {
	      var _partReplacements2 = {};
	
	      if (this.processContent(compiler, resources, node, instruction) && node.hasChildNodes()) {
	        if (this.usesShadowDOM) {
	          var currentChild = node.firstChild;
	          var nextSibling = void 0;
	          var toReplace = void 0;
	
	          while (currentChild) {
	            nextSibling = currentChild.nextSibling;
	
	            if (currentChild.tagName === 'TEMPLATE' && (toReplace = currentChild.getAttribute('replace-part'))) {
	              _partReplacements2[toReplace] = compiler.compile(currentChild, resources);
	              _aureliaPal.DOM.removeNode(currentChild, parentNode);
	              instruction.partReplacements = _partReplacements2;
	            }
	
	            currentChild = nextSibling;
	          }
	
	          instruction.skipContentProcessing = false;
	        } else {
	          var _fragment = _aureliaPal.DOM.createDocumentFragment();
	          var _currentChild = node.firstChild;
	          var _nextSibling = void 0;
	          var _toReplace = void 0;
	
	          while (_currentChild) {
	            _nextSibling = _currentChild.nextSibling;
	
	            if (_currentChild.tagName === 'TEMPLATE' && (_toReplace = _currentChild.getAttribute('replace-part'))) {
	              _partReplacements2[_toReplace] = compiler.compile(_currentChild, resources);
	              _aureliaPal.DOM.removeNode(_currentChild, parentNode);
	              instruction.partReplacements = _partReplacements2;
	            } else {
	              _fragment.appendChild(_currentChild);
	            }
	
	            _currentChild = _nextSibling;
	          }
	
	          instruction.contentFactory = compiler.compile(_fragment, resources);
	          instruction.skipContentProcessing = true;
	        }
	      } else {
	        instruction.skipContentProcessing = true;
	      }
	    }
	
	    return node;
	  };
	
	  HtmlBehaviorResource.prototype.create = function create(container, instruction, element, bindings) {
	    var host = void 0;
	    var au = null;
	
	    instruction = instruction || BehaviorInstruction.normal;
	    element = element || null;
	    bindings = bindings || null;
	
	    if (this.elementName !== null && element) {
	      if (this.usesShadowDOM) {
	        host = element.createShadowRoot();
	        container.registerInstance(_aureliaPal.DOM.boundary, host);
	      } else {
	        host = element;
	
	        if (this.targetShadowDOM) {
	          container.registerInstance(_aureliaPal.DOM.boundary, host);
	        }
	      }
	    }
	
	    if (element !== null) {
	      element.au = au = element.au || {};
	    }
	
	    var viewModel = instruction.viewModel || container.get(this.target);
	    var controller = new Controller(this, instruction, viewModel, container.elementEvents);
	    var childBindings = this.childBindings;
	    var viewFactory = void 0;
	
	    if (this.liftsContent) {
	      au.controller = controller;
	    } else if (this.elementName !== null) {
	      viewFactory = instruction.viewFactory || this.viewFactory;
	      container.viewModel = viewModel;
	
	      if (viewFactory) {
	        controller.view = viewFactory.create(container, instruction, element);
	      }
	
	      if (element !== null) {
	        au.controller = controller;
	
	        if (controller.view) {
	          if (!this.usesShadowDOM) {
	            if (instruction.contentFactory) {
	              var contentView = instruction.contentFactory.create(container, contentSelectorViewCreateInstruction);
	
	              _ContentSelector.applySelectors(contentView, controller.view.contentSelectors, function (contentSelector, group) {
	                return contentSelector.add(group);
	              });
	
	              controller.contentView = contentView;
	            }
	          }
	
	          if (instruction.anchorIsContainer) {
	            if (childBindings !== null) {
	              for (var i = 0, ii = childBindings.length; i < ii; ++i) {
	                controller.view.addBinding(childBindings[i].create(element, viewModel));
	              }
	            }
	
	            controller.view.appendNodesTo(host);
	          } else {
	            controller.view.insertNodesBefore(host);
	          }
	        } else if (childBindings !== null) {
	          for (var _i2 = 0, _ii2 = childBindings.length; _i2 < _ii2; ++_i2) {
	            bindings.push(childBindings[_i2].create(element, viewModel));
	          }
	        }
	      } else if (controller.view) {
	        controller.view.controller = controller;
	
	        if (childBindings !== null) {
	          for (var _i3 = 0, _ii3 = childBindings.length; _i3 < _ii3; ++_i3) {
	            controller.view.addBinding(childBindings[_i3].create(instruction.host, viewModel));
	          }
	        }
	      } else if (childBindings !== null) {
	        for (var _i4 = 0, _ii4 = childBindings.length; _i4 < _ii4; ++_i4) {
	          bindings.push(childBindings[_i4].create(instruction.host, viewModel));
	        }
	      }
	    } else if (childBindings !== null) {
	      for (var _i5 = 0, _ii5 = childBindings.length; _i5 < _ii5; ++_i5) {
	        bindings.push(childBindings[_i5].create(element, viewModel));
	      }
	    }
	
	    if (au !== null) {
	      au[this.htmlName] = controller;
	    }
	
	    if (instruction.initiatedByBehavior && viewFactory) {
	      controller.view.created();
	    }
	
	    return controller;
	  };
	
	  HtmlBehaviorResource.prototype._ensurePropertiesDefined = function _ensurePropertiesDefined(instance, lookup) {
	    var properties = void 0;
	    var i = void 0;
	    var ii = void 0;
	    var observer = void 0;
	
	    if ('__propertiesDefined__' in lookup) {
	      return;
	    }
	
	    lookup.__propertiesDefined__ = true;
	    properties = this.properties;
	
	    for (i = 0, ii = properties.length; i < ii; ++i) {
	      observer = properties[i].createObserver(instance);
	
	      if (observer !== undefined) {
	        lookup[observer.propertyName] = observer;
	      }
	    }
	  };
	
	  return HtmlBehaviorResource;
	}();
	
	function createChildObserverDecorator(selectorOrConfig, all) {
	  return function (target, key, descriptor) {
	    var actualTarget = typeof key === 'string' ? target.constructor : target;
	    var r = _aureliaMetadata.metadata.getOrCreateOwn(_aureliaMetadata.metadata.resource, HtmlBehaviorResource, actualTarget);
	
	    if (typeof selectorOrConfig === 'string') {
	      selectorOrConfig = {
	        selector: selectorOrConfig,
	        name: key
	      };
	    }
	
	    if (descriptor) {
	      descriptor.writable = true;
	    }
	
	    selectorOrConfig.all = all;
	    r.addChildBinding(new ChildObserver(selectorOrConfig));
	  };
	}
	
	function children(selectorOrConfig) {
	  return createChildObserverDecorator(selectorOrConfig, true);
	}
	
	function child(selectorOrConfig) {
	  return createChildObserverDecorator(selectorOrConfig, false);
	}
	
	var ChildObserver = function () {
	  function ChildObserver(config) {
	    _classCallCheck(this, ChildObserver);
	
	    this.name = config.name;
	    this.changeHandler = config.changeHandler || this.name + 'Changed';
	    this.selector = config.selector;
	    this.all = config.all;
	  }
	
	  ChildObserver.prototype.create = function create(target, viewModel) {
	    return new ChildObserverBinder(this.selector, target, this.name, viewModel, this.changeHandler, this.all);
	  };
	
	  return ChildObserver;
	}();
	
	var noMutations = [];
	
	function trackMutation(groupedMutations, binder, record) {
	  var mutations = groupedMutations.get(binder);
	
	  if (!mutations) {
	    mutations = [];
	    groupedMutations.set(binder, mutations);
	  }
	
	  mutations.push(record);
	}
	
	function onChildChange(mutations, observer) {
	  var binders = observer.binders;
	  var bindersLength = binders.length;
	  var groupedMutations = new Map();
	
	  for (var i = 0, ii = mutations.length; i < ii; ++i) {
	    var record = mutations[i];
	    var added = record.addedNodes;
	    var removed = record.removedNodes;
	
	    for (var j = 0, jj = removed.length; j < jj; ++j) {
	      var node = removed[j];
	      if (node.nodeType === 1) {
	        for (var k = 0; k < bindersLength; ++k) {
	          var binder = binders[k];
	          if (binder.onRemove(node)) {
	            trackMutation(groupedMutations, binder, record);
	          }
	        }
	      }
	    }
	
	    for (var _j = 0, _jj = added.length; _j < _jj; ++_j) {
	      var _node = added[_j];
	      if (_node.nodeType === 1) {
	        for (var _k = 0; _k < bindersLength; ++_k) {
	          var _binder = binders[_k];
	          if (_binder.onAdd(_node)) {
	            trackMutation(groupedMutations, _binder, record);
	          }
	        }
	      }
	    }
	  }
	
	  groupedMutations.forEach(function (value, key) {
	    if (key.changeHandler !== null) {
	      key.viewModel[key.changeHandler](value);
	    }
	  });
	}
	
	var ChildObserverBinder = function () {
	  function ChildObserverBinder(selector, target, property, viewModel, changeHandler, all) {
	    _classCallCheck(this, ChildObserverBinder);
	
	    this.selector = selector;
	    this.target = target;
	    this.property = property;
	    this.viewModel = viewModel;
	    this.changeHandler = changeHandler in viewModel ? changeHandler : null;
	    this.all = all;
	  }
	
	  ChildObserverBinder.prototype.bind = function bind(source) {
	    var target = this.target;
	    var viewModel = this.viewModel;
	    var selector = this.selector;
	    var current = target.firstElementChild;
	    var observer = target.__childObserver__;
	
	    if (!observer) {
	      observer = target.__childObserver__ = _aureliaPal.DOM.createMutationObserver(onChildChange);
	      observer.observe(target, { childList: true });
	      observer.binders = [];
	    }
	
	    observer.binders.push(this);
	
	    if (this.all) {
	      var items = viewModel[this.property];
	      if (!items) {
	        items = viewModel[this.property] = [];
	      } else {
	        items.length = 0;
	      }
	
	      while (current) {
	        if (current.matches(selector)) {
	          items.push(current.au && current.au.controller ? current.au.controller.viewModel : current);
	        }
	
	        current = current.nextElementSibling;
	      }
	
	      if (this.changeHandler !== null) {
	        this.viewModel[this.changeHandler](noMutations);
	      }
	    } else {
	      while (current) {
	        if (current.matches(selector)) {
	          var value = current.au && current.au.controller ? current.au.controller.viewModel : current;
	          this.viewModel[this.property] = value;
	
	          if (this.changeHandler !== null) {
	            this.viewModel[this.changeHandler](value);
	          }
	
	          break;
	        }
	
	        current = current.nextElementSibling;
	      }
	    }
	  };
	
	  ChildObserverBinder.prototype.onRemove = function onRemove(element) {
	    if (element.matches(this.selector)) {
	      var value = element.au && element.au.controller ? element.au.controller.viewModel : element;
	
	      if (this.all) {
	        var items = this.viewModel[this.property];
	        var index = items.indexOf(value);
	
	        if (index !== -1) {
	          items.splice(index, 1);
	        }
	
	        return true;
	      }
	
	      return false;
	    }
	  };
	
	  ChildObserverBinder.prototype.onAdd = function onAdd(element) {
	    var selector = this.selector;
	
	    if (element.matches(selector)) {
	      var value = element.au && element.au.controller ? element.au.controller.viewModel : element;
	
	      if (this.all) {
	        var items = this.viewModel[this.property];
	        var index = 0;
	        var prev = element.previousElementSibling;
	
	        while (prev) {
	          if (prev.matches(selector)) {
	            index++;
	          }
	
	          prev = prev.previousElementSibling;
	        }
	
	        items.splice(index, 0, value);
	        return true;
	      }
	
	      this.viewModel[this.property] = value;
	
	      if (this.changeHandler !== null) {
	        this.viewModel[this.changeHandler](value);
	      }
	    }
	
	    return false;
	  };
	
	  ChildObserverBinder.prototype.unbind = function unbind() {
	    if (this.target.__childObserver__) {
	      this.target.__childObserver__.disconnect();
	      this.target.__childObserver__ = null;
	    }
	  };
	
	  return ChildObserverBinder;
	}();
	
	function tryActivateViewModel(context) {
	  if (context.skipActivation || typeof context.viewModel.activate !== 'function') {
	    return Promise.resolve();
	  }
	
	  return context.viewModel.activate(context.model) || Promise.resolve();
	}
	
	var CompositionEngine = exports.CompositionEngine = (_dec9 = (0, _aureliaDependencyInjection.inject)(ViewEngine, ViewLocator), _dec9(_class17 = function () {
	  function CompositionEngine(viewEngine, viewLocator) {
	    _classCallCheck(this, CompositionEngine);
	
	    this.viewEngine = viewEngine;
	    this.viewLocator = viewLocator;
	  }
	
	  CompositionEngine.prototype._createControllerAndSwap = function _createControllerAndSwap(context) {
	    function swap(controller) {
	      return Promise.resolve(context.viewSlot.removeAll(true)).then(function () {
	        if (context.currentController) {
	          context.currentController.unbind();
	        }
	
	        context.viewSlot.add(controller.view);
	
	        if (context.compositionTransactionNotifier) {
	          context.compositionTransactionNotifier.done();
	        }
	
	        return controller;
	      });
	    }
	
	    return this.createController(context).then(function (controller) {
	      controller.automate(context.overrideContext, context.owningView);
	
	      if (context.compositionTransactionOwnershipToken) {
	        return context.compositionTransactionOwnershipToken.waitForCompositionComplete().then(function () {
	          return swap(controller);
	        });
	      }
	
	      return swap(controller);
	    });
	  };
	
	  CompositionEngine.prototype.createController = function createController(context) {
	    var _this12 = this;
	
	    var childContainer = void 0;
	    var viewModel = void 0;
	    var viewModelResource = void 0;
	    var m = void 0;
	
	    return this.ensureViewModel(context).then(tryActivateViewModel).then(function () {
	      childContainer = context.childContainer;
	      viewModel = context.viewModel;
	      viewModelResource = context.viewModelResource;
	      m = viewModelResource.metadata;
	
	      var viewStrategy = _this12.viewLocator.getViewStrategy(context.view || viewModel);
	
	      if (context.viewResources) {
	        viewStrategy.makeRelativeTo(context.viewResources.viewUrl);
	      }
	
	      return m.load(childContainer, viewModelResource.value, null, viewStrategy, true);
	    }).then(function (viewFactory) {
	      return m.create(childContainer, BehaviorInstruction.dynamic(context.host, viewModel, viewFactory));
	    });
	  };
	
	  CompositionEngine.prototype.ensureViewModel = function ensureViewModel(context) {
	    var childContainer = context.childContainer = context.childContainer || context.container.createChild();
	
	    if (typeof context.viewModel === 'string') {
	      context.viewModel = context.viewResources ? context.viewResources.relativeToView(context.viewModel) : context.viewModel;
	
	      return this.viewEngine.importViewModelResource(context.viewModel).then(function (viewModelResource) {
	        childContainer.autoRegister(viewModelResource.value);
	
	        if (context.host) {
	          childContainer.registerInstance(_aureliaPal.DOM.Element, context.host);
	        }
	
	        context.viewModel = childContainer.viewModel = childContainer.get(viewModelResource.value);
	        context.viewModelResource = viewModelResource;
	        return context;
	      });
	    }
	
	    var m = _aureliaMetadata.metadata.getOrCreateOwn(_aureliaMetadata.metadata.resource, HtmlBehaviorResource, context.viewModel.constructor);
	    m.elementName = m.elementName || 'dynamic-element';
	    m.initialize(context.container || childContainer, context.viewModel.constructor);
	    context.viewModelResource = { metadata: m, value: context.viewModel.constructor };
	    childContainer.viewModel = context.viewModel;
	    return Promise.resolve(context);
	  };
	
	  CompositionEngine.prototype.compose = function compose(context) {
	    context.childContainer = context.childContainer || context.container.createChild();
	    context.view = this.viewLocator.getViewStrategy(context.view);
	
	    var transaction = context.childContainer.get(CompositionTransaction);
	    var compositionTransactionOwnershipToken = transaction.tryCapture();
	
	    if (compositionTransactionOwnershipToken) {
	      context.compositionTransactionOwnershipToken = compositionTransactionOwnershipToken;
	    } else {
	      context.compositionTransactionNotifier = transaction.enlist();
	    }
	
	    if (context.viewModel) {
	      return this._createControllerAndSwap(context);
	    } else if (context.view) {
	      if (context.viewResources) {
	        context.view.makeRelativeTo(context.viewResources.viewUrl);
	      }
	
	      return context.view.loadViewFactory(this.viewEngine, new ViewCompileInstruction()).then(function (viewFactory) {
	        var result = viewFactory.create(context.childContainer);
	        result.bind(context.bindingContext, context.overrideContext);
	
	        var work = function work() {
	          return Promise.resolve(context.viewSlot.removeAll(true)).then(function () {
	            context.viewSlot.add(result);
	
	            if (context.compositionTransactionNotifier) {
	              context.compositionTransactionNotifier.done();
	            }
	
	            return result;
	          });
	        };
	
	        if (context.compositionTransactionOwnershipToken) {
	          return context.compositionTransactionOwnershipToken.waitForCompositionComplete().then(work);
	        }
	
	        return work();
	      });
	    } else if (context.viewSlot) {
	      context.viewSlot.removeAll();
	
	      if (context.compositionTransactionNotifier) {
	        context.compositionTransactionNotifier.done();
	      }
	
	      return Promise.resolve(null);
	    }
	  };
	
	  return CompositionEngine;
	}()) || _class17);
	
	var ElementConfigResource = exports.ElementConfigResource = function () {
	  function ElementConfigResource() {
	    _classCallCheck(this, ElementConfigResource);
	  }
	
	  ElementConfigResource.prototype.initialize = function initialize(container, target) {};
	
	  ElementConfigResource.prototype.register = function register(registry, name) {};
	
	  ElementConfigResource.prototype.load = function load(container, target) {
	    var config = new target();
	    var eventManager = container.get(_aureliaBinding.EventManager);
	    eventManager.registerElementConfig(config);
	  };
	
	  return ElementConfigResource;
	}();
	
	function validateBehaviorName(name, type) {
	  if (/[A-Z]/.test(name)) {
	    var newName = _hyphenate(name);
	    LogManager.getLogger('templating').warn('\'' + name + '\' is not a valid ' + type + ' name and has been converted to \'' + newName + '\'. Upper-case letters are not allowed because the DOM is not case-sensitive.');
	    return newName;
	  }
	  return name;
	}
	
	function resource(instance) {
	  return function (target) {
	    _aureliaMetadata.metadata.define(_aureliaMetadata.metadata.resource, instance, target);
	  };
	}
	
	function behavior(override) {
	  return function (target) {
	    if (override instanceof HtmlBehaviorResource) {
	      _aureliaMetadata.metadata.define(_aureliaMetadata.metadata.resource, override, target);
	    } else {
	      var r = _aureliaMetadata.metadata.getOrCreateOwn(_aureliaMetadata.metadata.resource, HtmlBehaviorResource, target);
	      Object.assign(r, override);
	    }
	  };
	}
	
	function customElement(name) {
	  return function (target) {
	    var r = _aureliaMetadata.metadata.getOrCreateOwn(_aureliaMetadata.metadata.resource, HtmlBehaviorResource, target);
	    r.elementName = validateBehaviorName(name, 'custom element');
	  };
	}
	
	function customAttribute(name, defaultBindingMode) {
	  return function (target) {
	    var r = _aureliaMetadata.metadata.getOrCreateOwn(_aureliaMetadata.metadata.resource, HtmlBehaviorResource, target);
	    r.attributeName = validateBehaviorName(name, 'custom attribute');
	    r.attributeDefaultBindingMode = defaultBindingMode;
	  };
	}
	
	function templateController(target) {
	  var deco = function deco(t) {
	    var r = _aureliaMetadata.metadata.getOrCreateOwn(_aureliaMetadata.metadata.resource, HtmlBehaviorResource, t);
	    r.liftsContent = true;
	  };
	
	  return target ? deco(target) : deco;
	}
	
	function bindable(nameOrConfigOrTarget, key, descriptor) {
	  var deco = function deco(target, key2, descriptor2) {
	    var actualTarget = key2 ? target.constructor : target;
	    var r = _aureliaMetadata.metadata.getOrCreateOwn(_aureliaMetadata.metadata.resource, HtmlBehaviorResource, actualTarget);
	    var prop = void 0;
	
	    if (key2) {
	      nameOrConfigOrTarget = nameOrConfigOrTarget || {};
	      nameOrConfigOrTarget.name = key2;
	    }
	
	    prop = new BindableProperty(nameOrConfigOrTarget);
	    return prop.registerWith(actualTarget, r, descriptor2);
	  };
	
	  if (!nameOrConfigOrTarget) {
	    return deco;
	  }
	
	  if (key) {
	    var target = nameOrConfigOrTarget;
	    nameOrConfigOrTarget = null;
	    return deco(target, key, descriptor);
	  }
	
	  return deco;
	}
	
	function dynamicOptions(target) {
	  var deco = function deco(t) {
	    var r = _aureliaMetadata.metadata.getOrCreateOwn(_aureliaMetadata.metadata.resource, HtmlBehaviorResource, t);
	    r.hasDynamicOptions = true;
	  };
	
	  return target ? deco(target) : deco;
	}
	
	function useShadowDOM(target) {
	  var deco = function deco(t) {
	    var r = _aureliaMetadata.metadata.getOrCreateOwn(_aureliaMetadata.metadata.resource, HtmlBehaviorResource, t);
	    r.targetShadowDOM = true;
	  };
	
	  return target ? deco(target) : deco;
	}
	
	function processAttributes(processor) {
	  return function (t) {
	    var r = _aureliaMetadata.metadata.getOrCreateOwn(_aureliaMetadata.metadata.resource, HtmlBehaviorResource, t);
	    r.processAttributes = processor;
	  };
	}
	
	function doNotProcessContent() {
	  return false;
	}
	
	function processContent(processor) {
	  return function (t) {
	    var r = _aureliaMetadata.metadata.getOrCreateOwn(_aureliaMetadata.metadata.resource, HtmlBehaviorResource, t);
	    r.processContent = processor || doNotProcessContent;
	  };
	}
	
	function containerless(target) {
	  var deco = function deco(t) {
	    var r = _aureliaMetadata.metadata.getOrCreateOwn(_aureliaMetadata.metadata.resource, HtmlBehaviorResource, t);
	    r.containerless = true;
	  };
	
	  return target ? deco(target) : deco;
	}
	
	function useViewStrategy(strategy) {
	  return function (target) {
	    _aureliaMetadata.metadata.define(ViewLocator.viewStrategyMetadataKey, strategy, target);
	  };
	}
	
	function useView(path) {
	  return useViewStrategy(new RelativeViewStrategy(path));
	}
	
	function inlineView(markup, dependencies, dependencyBaseUrl) {
	  return useViewStrategy(new InlineViewStrategy(markup, dependencies, dependencyBaseUrl));
	}
	
	function noView(target) {
	  var deco = function deco(t) {
	    _aureliaMetadata.metadata.define(ViewLocator.viewStrategyMetadataKey, new NoViewStrategy(), t);
	  };
	
	  return target ? deco(target) : deco;
	}
	
	function elementConfig(target) {
	  var deco = function deco(t) {
	    _aureliaMetadata.metadata.define(_aureliaMetadata.metadata.resource, new ElementConfigResource(), t);
	  };
	
	  return target ? deco(target) : deco;
	}
	
	var TemplatingEngine = exports.TemplatingEngine = (_dec10 = (0, _aureliaDependencyInjection.inject)(_aureliaDependencyInjection.Container, ModuleAnalyzer, ViewCompiler, CompositionEngine), _dec10(_class18 = function () {
	  function TemplatingEngine(container, moduleAnalyzer, viewCompiler, compositionEngine) {
	    _classCallCheck(this, TemplatingEngine);
	
	    this._container = container;
	    this._moduleAnalyzer = moduleAnalyzer;
	    this._viewCompiler = viewCompiler;
	    this._compositionEngine = compositionEngine;
	    container.registerInstance(Animator, Animator.instance = new Animator());
	  }
	
	  TemplatingEngine.prototype.configureAnimator = function configureAnimator(animator) {
	    this._container.unregister(Animator);
	    this._container.registerInstance(Animator, Animator.instance = animator);
	  };
	
	  TemplatingEngine.prototype.compose = function compose(context) {
	    return this._compositionEngine.compose(context);
	  };
	
	  TemplatingEngine.prototype.enhance = function enhance(instruction) {
	    if (instruction instanceof _aureliaPal.DOM.Element) {
	      instruction = { element: instruction };
	    }
	
	    var compilerInstructions = {};
	    var resources = instruction.resources || this._container.get(ViewResources);
	
	    this._viewCompiler._compileNode(instruction.element, resources, compilerInstructions, instruction.element.parentNode, 'root', true);
	
	    var factory = new ViewFactory(instruction.element, compilerInstructions, resources);
	    var container = instruction.container || this._container.createChild();
	    var view = factory.create(container, BehaviorInstruction.enhance());
	
	    view.bind(instruction.bindingContext || {}, instruction.overrideContext);
	
	    return view;
	  };
	
	  TemplatingEngine.prototype.createControllerForUnitTest = function createControllerForUnitTest(viewModelType, attributesFromHTML) {
	    var _moduleAnalyzer$analy;
	
	    var exportName = viewModelType.name;
	    var resourceModule = this._moduleAnalyzer.analyze('test-module', (_moduleAnalyzer$analy = {}, _moduleAnalyzer$analy[exportName] = viewModelType, _moduleAnalyzer$analy), exportName);
	    var description = resourceModule.mainResource;
	
	    description.initialize(this._container);
	
	    var viewModel = this._container.get(viewModelType);
	    var instruction = BehaviorInstruction.unitTest(description, attributesFromHTML);
	
	    return new Controller(description.metadata, instruction, viewModel);
	  };
	
	  TemplatingEngine.prototype.createViewModelForUnitTest = function createViewModelForUnitTest(viewModelType, attributesFromHTML, bindingContext) {
	    var controller = this.createControllerForUnitTest(viewModelType, attributesFromHTML);
	    controller.bind((0, _aureliaBinding.createScopeForTest)(bindingContext));
	    return controller.viewModel;
	  };
	
	  return TemplatingEngine;
	}()) || _class18);

/***/ },
/* 25 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.EventAggregator = undefined;
	exports.includeEventsIn = includeEventsIn;
	exports.configure = configure;
	
	var _aureliaLogging = __webpack_require__(14);
	
	var LogManager = _interopRequireWildcard(_aureliaLogging);
	
	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var logger = LogManager.getLogger('event-aggregator');
	
	var Handler = function () {
	  function Handler(messageType, callback) {
	    _classCallCheck(this, Handler);
	
	    this.messageType = messageType;
	    this.callback = callback;
	  }
	
	  Handler.prototype.handle = function handle(message) {
	    if (message instanceof this.messageType) {
	      this.callback.call(null, message);
	    }
	  };
	
	  return Handler;
	}();
	
	var EventAggregator = exports.EventAggregator = function () {
	  function EventAggregator() {
	    _classCallCheck(this, EventAggregator);
	
	    this.eventLookup = {};
	    this.messageHandlers = [];
	  }
	
	  EventAggregator.prototype.publish = function publish(event, data) {
	    var subscribers = void 0;
	    var i = void 0;
	
	    if (!event) {
	      throw new Error('Event was invalid.');
	    }
	
	    if (typeof event === 'string') {
	      subscribers = this.eventLookup[event];
	      if (subscribers) {
	        subscribers = subscribers.slice();
	        i = subscribers.length;
	
	        try {
	          while (i--) {
	            subscribers[i](data, event);
	          }
	        } catch (e) {
	          logger.error(e);
	        }
	      }
	    } else {
	      subscribers = this.messageHandlers.slice();
	      i = subscribers.length;
	
	      try {
	        while (i--) {
	          subscribers[i].handle(event);
	        }
	      } catch (e) {
	        logger.error(e);
	      }
	    }
	  };
	
	  EventAggregator.prototype.subscribe = function subscribe(event, callback) {
	    var handler = void 0;
	    var subscribers = void 0;
	
	    if (!event) {
	      throw new Error('Event channel/type was invalid.');
	    }
	
	    if (typeof event === 'string') {
	      handler = callback;
	      subscribers = this.eventLookup[event] || (this.eventLookup[event] = []);
	    } else {
	      handler = new Handler(event, callback);
	      subscribers = this.messageHandlers;
	    }
	
	    subscribers.push(handler);
	
	    return {
	      dispose: function dispose() {
	        var idx = subscribers.indexOf(handler);
	        if (idx !== -1) {
	          subscribers.splice(idx, 1);
	        }
	      }
	    };
	  };
	
	  EventAggregator.prototype.subscribeOnce = function subscribeOnce(event, callback) {
	    var sub = this.subscribe(event, function (a, b) {
	      sub.dispose();
	      return callback(a, b);
	    });
	
	    return sub;
	  };
	
	  return EventAggregator;
	}();
	
	function includeEventsIn(obj) {
	  var ea = new EventAggregator();
	
	  obj.subscribeOnce = function (event, callback) {
	    return ea.subscribeOnce(event, callback);
	  };
	
	  obj.subscribe = function (event, callback) {
	    return ea.subscribe(event, callback);
	  };
	
	  obj.publish = function (event, data) {
	    ea.publish(event, data);
	  };
	
	  return ea;
	}
	
	function configure(config) {
	  config.instance(EventAggregator, includeEventsIn(config.aurelia));
	}

/***/ },
/* 26 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.configure = exports.SailsSocketClient = exports.RequestBuilder = exports.SocketRequestMessage = exports.RequestMessageProcessor = exports.SocketResponseMessage = exports.Headers = exports.LoggerInterceptor = exports.CSRFInterceptor = undefined;
	
	var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();
	
	exports.createSocketRequestMessageProcessor = createSocketRequestMessageProcessor;
	exports.configure = configure;
	
	var _aureliaLogging = __webpack_require__(14);
	
	var LogManager = _interopRequireWildcard(_aureliaLogging);
	
	var _aureliaPath = __webpack_require__(9);
	
	var _aureliaPal = __webpack_require__(4);
	
	__webpack_require__(27);
	
	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var logger = LogManager.getLogger('sails');
	
	var CSRFInterceptor = exports.CSRFInterceptor = function () {
	  function CSRFInterceptor(url, client, token) {
	    _classCallCheck(this, CSRFInterceptor);
	
	    this.url = url;
	    this.client = client;
	    this.token = token;
	  }
	
	  CSRFInterceptor.prototype.request = function request(message) {
	    var _this = this;
	
	    if (message.method === 'get' || message.url === this.url) {
	      return message;
	    }
	
	    if (this.token) {
	      this.setCsrfTokenHeader(message);
	      return message;
	    }
	
	    return new Promise(function (resolve, reject) {
	      var promise = void 0;
	      if (_this._fetching) {
	        promise = _this._fetching;
	      } else {
	        promise = _this._fetching = _this.client.get(_this.url);
	      }
	      promise.then(function (response) {
	        _this.token = response.content._csrf;
	        _this.setCsrfTokenHeader(message);
	        resolve(message);
	      }).catch(reject);
	    });
	  };
	
	  CSRFInterceptor.prototype.setCsrfTokenHeader = function setCsrfTokenHeader(message) {
	    message.headers.add('X-Csrf-Token', this.token);
	    return message;
	  };
	
	  return CSRFInterceptor;
	}();
	
	var LoggerInterceptor = function () {
	  function LoggerInterceptor() {
	    _classCallCheck(this, LoggerInterceptor);
	  }
	
	  LoggerInterceptor.prototype.request = function request(message) {
	    logger.debug('Sending message to sails', message);
	    return message;
	  };
	
	  LoggerInterceptor.prototype.response = function response(_response) {
	    logger.debug('Receiving response from sails', _response);
	    return _response;
	  };
	
	  LoggerInterceptor.prototype.responseError = function responseError(response) {
	    logger.error('There was an error during sails request', response);
	    throw response;
	  };
	
	  return LoggerInterceptor;
	}();
	
	exports.LoggerInterceptor = LoggerInterceptor;
	
	var Headers = exports.Headers = function () {
	  function Headers() {
	    var headers = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];
	
	    _classCallCheck(this, Headers);
	
	    this.headers = headers;
	  }
	
	  Headers.prototype.add = function add(key, value) {
	    this.headers[key] = value;
	  };
	
	  Headers.prototype.get = function get(key) {
	    return this.headers[key];
	  };
	
	  Headers.prototype.clear = function clear() {
	    this.headers = {};
	  };
	
	  return Headers;
	}();
	
	var SocketResponseMessage = exports.SocketResponseMessage = function () {
	  function SocketResponseMessage(requestMessage, body, JWR) {
	    _classCallCheck(this, SocketResponseMessage);
	
	    this.requestMessage = requestMessage;
	    this.statusCode = JWR.statusCode;
	    this.body = body;
	
	    this.isSuccess = this.statusCode >= 200 && this.statusCode < 400;
	    this.headers = new Headers(JWR.headers);
	  }
	
	  _createClass(SocketResponseMessage, [{
	    key: 'content',
	    get: function get() {
	      return this.body;
	    }
	  }]);
	
	  return SocketResponseMessage;
	}();
	
	var RequestMessageProcessor = exports.RequestMessageProcessor = function () {
	  function RequestMessageProcessor(transformers) {
	    _classCallCheck(this, RequestMessageProcessor);
	
	    this.transformers = transformers;
	  }
	
	  RequestMessageProcessor.prototype.abort = function abort() {
	    throw new Error('Cannot abort socket request');
	  };
	
	  RequestMessageProcessor.prototype.process = function process(client, requestMessage) {
	    var _this2 = this;
	
	    return new Promise(function (resolve, reject) {
	      var transformers = _this2.transformers;
	      var promises = [];
	      var i = void 0;
	      var ii = void 0;
	
	      for (i = 0, ii = transformers.length; i < ii; ++i) {
	        promises.push(transformers[i](client, _this2, requestMessage));
	      }
	
	      return Promise.all(promises).then(function () {
	        return resolve(requestMessage);
	      }).catch(reject);
	    }).then(function (message) {
	      var processRequest = function processRequest(currentMessage) {
	        return new Promise(function (resolve, reject) {
	          client.socket.request(currentMessage.options, function (data, jwr) {
	            var response = new SocketResponseMessage(currentMessage, data, jwr);
	            if (response.isSuccess) {
	              resolve(response);
	            } else {
	              reject(response);
	            }
	          });
	        });
	      };
	
	      var chain = [[processRequest, undefined]];
	
	      var interceptors = message.interceptors || [];
	      interceptors.forEach(function (interceptor) {
	        if (interceptor.request || interceptor.requestError) {
	          chain.unshift([interceptor.request ? interceptor.request.bind(interceptor) : undefined, interceptor.requestError ? interceptor.requestError.bind(interceptor) : undefined]);
	        }
	
	        if (interceptor.response || interceptor.responseError) {
	          chain.push([interceptor.response ? interceptor.response.bind(interceptor) : undefined, interceptor.responseError ? interceptor.responseError.bind(interceptor) : undefined]);
	        }
	      });
	
	      var interceptorsPromise = Promise.resolve(message);
	
	      while (chain.length) {
	        var _interceptorsPromise;
	
	        interceptorsPromise = (_interceptorsPromise = interceptorsPromise).then.apply(_interceptorsPromise, chain.shift());
	      }
	
	      return interceptorsPromise;
	    });
	  };
	
	  return RequestMessageProcessor;
	}();
	
	function buildFullUrl(message) {
	  var url = void 0;
	  var qs = void 0;
	
	  if (message.url && message.url[0] === '/') {
	    url = message.url;
	  } else {
	    url = (0, _aureliaPath.join)(message.baseUrl, message.url);
	  }
	
	  if (message.params) {
	    qs = (0, _aureliaPath.buildQueryString)(message.params);
	    url = qs ? url + '?' + qs : url;
	  }
	
	  return url;
	}
	
	var SocketRequestMessage = exports.SocketRequestMessage = function () {
	  function SocketRequestMessage(method, url, content, headers) {
	    _classCallCheck(this, SocketRequestMessage);
	
	    this.method = method;
	    this.url = url;
	    this.content = content;
	    this.headers = headers || new Headers();
	  }
	
	  _createClass(SocketRequestMessage, [{
	    key: 'options',
	    get: function get() {
	      return {
	        method: this.method,
	        url: buildFullUrl(this),
	        params: this.content,
	        headers: this.headers.headers
	      };
	    }
	  }]);
	
	  return SocketRequestMessage;
	}();
	
	function createSocketRequestMessageProcessor() {
	  return new RequestMessageProcessor([]);
	}
	
	var RequestBuilder = exports.RequestBuilder = function () {
	  function RequestBuilder(client) {
	    _classCallCheck(this, RequestBuilder);
	
	    this.client = client;
	    this.transformers = client.requestTransformers.slice(0);
	  }
	
	  RequestBuilder.addHelper = function addHelper(name, fn) {
	    RequestBuilder.prototype[name] = function () {
	      this.transformers.push(fn.apply(this, arguments));
	      return this;
	    };
	  };
	
	  RequestBuilder.prototype.send = function send() {
	    var message = new SocketRequestMessage();
	    return this.client.send(message, this.transformers);
	  };
	
	  return RequestBuilder;
	}();
	
	RequestBuilder.addHelper('asDelete', function () {
	  return function (client, processor, message) {
	    message.method = 'delete';
	  };
	});
	
	RequestBuilder.addHelper('asGet', function () {
	  return function (client, processor, message) {
	    message.method = 'get';
	  };
	});
	
	RequestBuilder.addHelper('asHead', function () {
	  return function (client, processor, message) {
	    message.method = 'head';
	  };
	});
	
	RequestBuilder.addHelper('asOptions', function () {
	  return function (client, processor, message) {
	    message.method = 'options';
	  };
	});
	
	RequestBuilder.addHelper('asPatch', function () {
	  return function (client, processor, message) {
	    message.method = 'patch';
	  };
	});
	
	RequestBuilder.addHelper('asPost', function () {
	  return function (client, processor, message) {
	    message.method = 'post';
	  };
	});
	
	RequestBuilder.addHelper('asPut', function () {
	  return function (client, processor, message) {
	    message.method = 'put';
	  };
	});
	
	RequestBuilder.addHelper('withUrl', function (url) {
	  return function (client, processor, message) {
	    message.url = url;
	  };
	});
	
	RequestBuilder.addHelper('withContent', function (content) {
	  return function (client, processor, message) {
	    message.content = content;
	  };
	});
	
	RequestBuilder.addHelper('withBaseUrl', function (baseUrl) {
	  return function (client, processor, message) {
	    message.baseUrl = baseUrl;
	  };
	});
	
	RequestBuilder.addHelper('withParams', function (params) {
	  return function (client, processor, message) {
	    message.params = params;
	  };
	});
	
	RequestBuilder.addHelper('withHeader', function (key, value) {
	  return function (client, processor, message) {
	    message.headers.add(key, value);
	  };
	});
	
	RequestBuilder.addHelper('withCredentials', function (value) {
	  return function (client, processor, message) {
	    message.withCredentials = value;
	  };
	});
	
	RequestBuilder.addHelper('withInterceptor', function (interceptor) {
	  return function (client, processor, message) {
	    message.interceptors = message.interceptors || [];
	    message.interceptors.unshift(interceptor);
	  };
	});
	
	function trackRequestStart(client, processor) {
	  client.pendingRequests.push(processor);
	  client.isRequesting = true;
	}
	
	function trackRequestEnd(client, processor) {
	  var index = client.pendingRequests.indexOf(processor);
	
	  client.pendingRequests.splice(index, 1);
	  client.isRequesting = client.pendingRequests.length > 0;
	
	  if (!client.isRequesting) {
	    (function () {
	      var evt = _aureliaPal.DOM.createCustomEvent('aurelia-sails-socket-client-requests-drained', { bubbles: true, cancelable: true });
	      setTimeout(function () {
	        return _aureliaPal.DOM.dispatchEvent(evt);
	      }, 1);
	    })();
	  }
	}
	
	var SailsSocketClient = exports.SailsSocketClient = function () {
	  function SailsSocketClient(socket) {
	    _classCallCheck(this, SailsSocketClient);
	
	    this.socket = socket;
	
	    this.requestTransformers = [];
	
	    this.interceptors = [];
	
	    this.pendingRequests = [];
	    this.isRequesting = false;
	  }
	
	  SailsSocketClient.prototype.setSocket = function setSocket(socket) {
	    this.socket = socket;
	    return this;
	  };
	
	  SailsSocketClient.prototype.addInterceptor = function addInterceptor(interceptor) {
	    this.interceptors.unshift(interceptor);
	    return this;
	  };
	
	  SailsSocketClient.prototype.configure = function configure(fn) {
	    var builder = new RequestBuilder(this);
	    fn(builder);
	    this.requestTransformers = builder.transformers;
	    return this;
	  };
	
	  SailsSocketClient.prototype.createRequest = function createRequest(url) {
	    var builder = new RequestBuilder(this);
	
	    if (url) {
	      builder.withUrl(url);
	    }
	
	    return builder;
	  };
	
	  SailsSocketClient.prototype.send = function send(requestMessage, transformers) {
	    var _this3 = this;
	
	    var processor = void 0;
	    var promise = void 0;
	    var i = void 0;
	    var ii = void 0;
	    var transformPromises = [];
	
	    processor = createSocketRequestMessageProcessor();
	    trackRequestStart(this, processor);
	
	    transformers = transformers || this.requestTransformers;
	
	    promise = Promise.resolve(requestMessage).then(function (message) {
	      for (i = 0, ii = transformers.length; i < ii; ++i) {
	        transformPromises.push(transformers[i](_this3, processor, message));
	      }
	
	      return processor.process(_this3, message).then(function (response) {
	        trackRequestEnd(_this3, processor);
	        return response;
	      }).catch(function (response) {
	        trackRequestEnd(_this3, processor);
	        throw response;
	      });
	    });
	
	    promise.abort = promise.cancel = function () {
	      processor.abort();
	    };
	
	    return promise;
	  };
	
	  SailsSocketClient.prototype.delete = function _delete(url, content) {
	    return this.createRequest(url).asDelete().withContent(content).send();
	  };
	
	  SailsSocketClient.prototype.get = function get(url, content) {
	    return this.createRequest(url).asGet().withContent(content).send();
	  };
	
	  SailsSocketClient.prototype.head = function head(url, content) {
	    return this.createRequest(url).asHead().withContent(content).send();
	  };
	
	  SailsSocketClient.prototype.options = function options(url, content) {
	    return this.createRequest(url).asOptions().withContent(content).send();
	  };
	
	  SailsSocketClient.prototype.put = function put(url, content) {
	    return this.createRequest(url).asPut().withContent(content).send();
	  };
	
	  SailsSocketClient.prototype.patch = function patch(url, content) {
	    return this.createRequest(url).asPatch().withContent(content).send();
	  };
	
	  SailsSocketClient.prototype.post = function post(url, content) {
	    return this.createRequest(url).asPost().withContent(content).send();
	  };
	
	  SailsSocketClient.prototype.on = function on(eventName, fn) {
	    this.socket.on(eventName, fn);
	    return this;
	  };
	
	  SailsSocketClient.prototype.off = function off(eventName, fn) {
	    this.socket.off(eventName, fn);
	    return this;
	  };
	
	  return SailsSocketClient;
	}();
	
	var io = _aureliaPal.PLATFORM.global.io;
	
	if (io) {
	  io.sails.autoConnect = false;
	}
	
	function configure(config, configCallback) {
	  var sails = new SailsSocketClient();
	
	  if (configCallback !== undefined && typeof configCallback === 'function') {
	    configCallback(sails, io);
	  }
	
	  sails.setSocket(io.sails.connect());
	
	  config.instance(SailsSocketClient, sails);
	}
	
	exports.configure = configure;
	exports.SailsSocketClient = SailsSocketClient;
	exports.CSRFInterceptor = CSRFInterceptor;
	exports.LoggerInterceptor = LoggerInterceptor;

/***/ },
/* 27 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;//////////////////////////////////////////////////////////////////////////////////////
	 //                                                                                //
	 //  ███████╗ █████╗ ██╗██╗     ███████╗   ██╗ ██████╗         ██╗███████╗         //
	 //  ██╔════╝██╔══██╗██║██║     ██╔════╝   ██║██╔═══██╗        ██║██╔════╝         //
	 //  ███████╗███████║██║██║     ███████╗   ██║██║   ██║        ██║███████╗         //
	 //  ╚════██║██╔══██║██║██║     ╚════██║   ██║██║   ██║   ██   ██║╚════██║         //
	 //  ███████║██║  ██║██║███████╗███████║██╗██║╚██████╔╝██╗╚█████╔╝███████║         //
	 //  ╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝ ╚═════╝ ╚═╝ ╚════╝ ╚══════╝         //
	 //                                                                                //
	 //   ╦╔═╗╦  ╦╔═╗╔═╗╔═╗╦═╗╦╔═╗╔╦╗  ╔═╗╦  ╦╔═╗╔╗╔╔╦╗  ╔═╗╔╦╗╦╔═                     //
	 //   ║╠═╣╚╗╔╝╠═╣╚═╗║  ╠╦╝║╠═╝ ║   ║  ║  ║║╣ ║║║ ║   ╚═╗ ║║╠╩╗                     //
	 //  ╚╝╩ ╩ ╚╝ ╩ ╩╚═╝╚═╝╩╚═╩╩   ╩   ╚═╝╩═╝╩╚═╝╝╚╝ ╩   ╚═╝═╩╝╩ ╩                     //
	 //  ┌─┐┌─┐┬─┐  ┌┐┌┌─┐┌┬┐┌─┐  ┬┌─┐  ┌─┐┌┐┌┌┬┐  ┌┬┐┬ ┬┌─┐  ┌┐ ┬─┐┌─┐┬ ┬┌─┐┌─┐┬─┐    //
	 //  ├┤ │ │├┬┘  ││││ │ ││├┤   │└─┐  ├─┤│││ ││   │ ├─┤├┤   ├┴┐├┬┘│ ││││└─┐├┤ ├┬┘    //
	 //  └  └─┘┴└─  ┘└┘└─┘─┴┘└─┘o└┘└─┘  ┴ ┴┘└┘─┴┘   ┴ ┴ ┴└─┘  └─┘┴└─└─┘└┴┘└─┘└─┘┴└─    //
	 //                                                                                //
	//////////////////////////////////////////////////////////////////////////////////////
	
	/**
	 * sails.io.js
	 * ------------------------------------------------------------------------
	 * JavaScript Client (SDK) for communicating with Sails.
	 *
	 * Note that this script is completely optional, but it is handy if you're
	 * using WebSockets from the browser to talk to your Sails server.
	 *
	 * For tips and documentation, visit:
	 * http://sailsjs.org/#!documentation/reference/BrowserSDK/BrowserSDK.html
	 * ------------------------------------------------------------------------
	 *
	 * This file allows you to send and receive socket.io messages to & from Sails
	 * by simulating a REST client interface on top of socket.io. It models its API
	 * after the $.ajax pattern from jQuery you might already be familiar with.
	 *
	 * So if you're switching from using AJAX to sockets, instead of:
	 *    `$.post( url, [data], [cb] )`
	 *
	 * You would use:
	 *    `socket.post( url, [data], [cb] )`
	 */
	
	
	(function() {
	
	
	  //   ██████╗ ██████╗ ███╗   ██╗███████╗████████╗ █████╗ ███╗   ██╗████████╗███████╗
	  //  ██╔════╝██╔═══██╗████╗  ██║██╔════╝╚══██╔══╝██╔══██╗████╗  ██║╚══██╔══╝██╔════╝
	  //  ██║     ██║   ██║██╔██╗ ██║███████╗   ██║   ███████║██╔██╗ ██║   ██║   ███████╗
	  //  ██║     ██║   ██║██║╚██╗██║╚════██║   ██║   ██╔══██║██║╚██╗██║   ██║   ╚════██║
	  //  ╚██████╗╚██████╔╝██║ ╚████║███████║   ██║   ██║  ██║██║ ╚████║   ██║   ███████║
	  //   ╚═════╝ ╚═════╝ ╚═╝  ╚═══╝╚══════╝   ╚═╝   ╚═╝  ╚═╝╚═╝  ╚═══╝   ╚═╝   ╚══════╝
	  //
	
	
	  /**
	   * Constant containing the names of all available options
	   * for individual sockets.
	   *
	   * @type {Array}
	   */
	  var SOCKET_OPTIONS = [
	    'useCORSRouteToGetCookie',
	    'url',
	    'multiplex',
	    'transports',
	    'query',
	    'path',
	    'headers',
	    'initialConnectionHeaders',
	    'reconnection',
	    'reconnectionAttempts',
	    'reconnectionDelay',
	    'reconnectionDelayMax',
	    'rejectUnauthorized',
	    'randomizationFactor',
	    'timeout'
	  ];
	
	
	  /**
	   * Constant containing the names of properties on `io.sails` which
	   * may be configured using HTML attributes on the script tag which
	   * loaded this file.
	   *
	   * @type {Array}
	   *
	   * (this is unused if loading from node.js)
	   */
	  var CONFIGURABLE_VIA_HTML_ATTR = [
	    'autoConnect',
	    'environment',
	    'headers',
	    'url',
	    'transports',
	    'path'
	  ];
	
	
	
	
	  /**
	   * Constant containing the names of querystring
	   * parameters sent when connecting any SailsSocket.
	   *
	   * @type {Dictionary}
	   */
	  var CONNECTION_METADATA_PARAMS = {
	    version: '__sails_io_sdk_version',
	    platform: '__sails_io_sdk_platform',
	    language: '__sails_io_sdk_language'
	  };
	
	
	  /**
	   * Constant containing metadata about the platform, language, and
	   * current version of this SDK.
	   *
	   * @type {Dictionary}
	   */
	  var SDK_INFO = {
	    version: '0.13.8', // <-- pulled automatically from package.json, do not change!
	    language: 'javascript',
	    platform: (function (){
	      if (typeof module === 'object' && typeof module.exports !== 'undefined') {
	        return 'node';
	      }
	      else {
	        return 'browser';
	      }
	    })()
	  };
	
	  // Build `versionString` (a querystring snippet) by
	  // combining SDK_INFO and CONNECTION_METADATA_PARAMS.
	  SDK_INFO.versionString =
	    CONNECTION_METADATA_PARAMS.version + '=' + SDK_INFO.version + '&' +
	    CONNECTION_METADATA_PARAMS.platform + '=' + SDK_INFO.platform + '&' +
	    CONNECTION_METADATA_PARAMS.language + '=' + SDK_INFO.language;
	
	
	
	
	  //   █████╗ ██████╗ ███████╗ ██████╗ ██████╗ ██████╗     ██╗  ██╗████████╗███╗   ███╗██╗
	  //  ██╔══██╗██╔══██╗██╔════╝██╔═══██╗██╔══██╗██╔══██╗    ██║  ██║╚══██╔══╝████╗ ████║██║
	  //  ███████║██████╔╝███████╗██║   ██║██████╔╝██████╔╝    ███████║   ██║   ██╔████╔██║██║
	  //  ██╔══██║██╔══██╗╚════██║██║   ██║██╔══██╗██╔══██╗    ██╔══██║   ██║   ██║╚██╔╝██║██║
	  //  ██║  ██║██████╔╝███████║╚██████╔╝██║  ██║██████╔╝    ██║  ██║   ██║   ██║ ╚═╝ ██║███████╗
	  //  ╚═╝  ╚═╝╚═════╝ ╚══════╝ ╚═════╝ ╚═╝  ╚═╝╚═════╝     ╚═╝  ╚═╝   ╚═╝   ╚═╝     ╚═╝╚══════╝
	  //
	  //   █████╗ ████████╗████████╗██████╗ ██╗██████╗ ██╗   ██╗████████╗███████╗███████╗
	  //  ██╔══██╗╚══██╔══╝╚══██╔══╝██╔══██╗██║██╔══██╗██║   ██║╚══██╔══╝██╔════╝██╔════╝
	  //  ███████║   ██║      ██║   ██████╔╝██║██████╔╝██║   ██║   ██║   █████╗  ███████╗
	  //  ██╔══██║   ██║      ██║   ██╔══██╗██║██╔══██╗██║   ██║   ██║   ██╔══╝  ╚════██║
	  //  ██║  ██║   ██║      ██║   ██║  ██║██║██████╔╝╚██████╔╝   ██║   ███████╗███████║
	  //  ╚═╝  ╚═╝   ╚═╝      ╚═╝   ╚═╝  ╚═╝╚═╝╚═════╝  ╚═════╝    ╚═╝   ╚══════╝╚══════╝
	  //
	  //  ███████╗██████╗  ██████╗ ███╗   ███╗      ██╗███████╗ ██████╗██████╗ ██╗██████╗ ████████╗██╗
	  //  ██╔════╝██╔══██╗██╔═══██╗████╗ ████║     ██╔╝██╔════╝██╔════╝██╔══██╗██║██╔══██╗╚══██╔══╝╚██╗
	  //  █████╗  ██████╔╝██║   ██║██╔████╔██║    ██╔╝ ███████╗██║     ██████╔╝██║██████╔╝   ██║    ╚██╗
	  //  ██╔══╝  ██╔══██╗██║   ██║██║╚██╔╝██║    ╚██╗ ╚════██║██║     ██╔══██╗██║██╔═══╝    ██║    ██╔╝
	  //  ██║     ██║  ██║╚██████╔╝██║ ╚═╝ ██║     ╚██╗███████║╚██████╗██║  ██║██║██║        ██║   ██╔╝
	  //  ╚═╝     ╚═╝  ╚═╝ ╚═════╝ ╚═╝     ╚═╝      ╚═╝╚══════╝ ╚═════╝╚═╝  ╚═╝╚═╝╚═╝        ╚═╝   ╚═╝
	  //
	  //
	  // If available, grab the DOM element for the script tag which imported this file.
	  // (skip this if this SDK is being used outside of the DOM, i.e. in a Node process)
	  //
	  // This is used below to parse client-side sails.io.js configuration encoded as
	  // HTML attributes, as well as grabbing hold of the URL from whence the SDK was fetched.
	  var thisScriptTag = (function() {
	    if (
	      typeof window !== 'object' ||
	      typeof window.document !== 'object' ||
	      typeof window.document.getElementsByTagName !== 'function'
	    ) {
	      return null;
	    }
	
	    // Return the URL of the last script loaded (i.e. this one)
	    // (this must run before nextTick; see http://stackoverflow.com/a/2976714/486547)
	    var allScriptsCurrentlyInDOM = window.document.getElementsByTagName('script');
	    return allScriptsCurrentlyInDOM[allScriptsCurrentlyInDOM.length - 1];
	  })();
	
	
	  // Variables to contain src URL and other script tag config (for use below).
	  var urlThisScriptWasFetchedFrom = '';
	  var scriptTagConfig = {};
	
	
	  if (thisScriptTag) {
	    // Save the URL that this script was fetched from.
	    urlThisScriptWasFetchedFrom = thisScriptTag.src;
	
	    // Now parse the most common client-side configuration settings
	    // from the script tag where they may be encoded as HTML attributes.
	    //
	    // Any configuration which may be provided as an HTML attribute may
	    // also be provided prefixed with `data-`.  This is for folks who
	    // need to support browsers that have issues with nonstandard
	    // HTML attributes (or if the idea of using nonstandard HTML attributes
	    // just creeps you out)
	    //
	    // If a `data-` prefixed attr is provided, it takes precedence.
	    // (this is so that if you are already using one of these HTML
	    //  attrs for some reason, you can keep it as-is and override
	    //  it using `data-`. If you are using the `data-` prefixed version
	    //  for some other purpose... well, in that case you'll just have to
	    //  configure programmatically using `io.sails` instead.)
	    CONFIGURABLE_VIA_HTML_ATTR.forEach(function (configKey){
	
	      scriptTagConfig[configKey] = (function (){
	
	        // Support 'data-' prefixed or normal attributes.
	        // (prefixed versions take precedence if provided)
	        var htmlAttrVal = thisScriptTag.getAttribute( 'data-'+configKey );
	        if (!htmlAttrVal) {
	          htmlAttrVal = thisScriptTag.getAttribute( configKey );
	        }
	
	        // The HTML attribute value should always be a string or `null`.
	        // We'll try to parse it as JSON and use that, but worst case fall back
	        // to the default situation of it being a string.
	        if (typeof htmlAttrVal === 'string') {
	          try { return JSON.parse(htmlAttrVal); } catch (e) { return htmlAttrVal; }
	        }
	        // If `null` was returned from getAttribute(), it means that the HTML attribute
	        // was not specified, so we treat it as undefined (which will cause the property
	        // to be removed below)
	        else if (htmlAttrVal === null) {
	          return undefined;
	        }
	        // Any other contingency shouldn't be possible:
	        // - if no quotes are used in the HTML attribute, it still comes in as a string.
	        // - if no RHS is provided for the attribute, it still comes in as "" (empty string)
	        // (but we still handle this with an explicit error just in case--for debugging and support purposes)
	        else throw new Error('sails.io.js :: Unexpected/invalid script tag configuration for `'+configKey+'`: `'+htmlAttrVal+'` (a `'+typeof htmlAttrVal+'`). Should be a string.');
	      })();
	
	      if (scriptTagConfig[configKey] === undefined){
	        delete scriptTagConfig[configKey];
	      }
	    });
	
	
	
	    // Now that they've been parsed, do an extremely lean version of
	    // logical type validation/coercion of provided values.
	    //////////////////////////////////////////////////////////////////
	
	    // `autoConnect`
	    if (typeof scriptTagConfig.autoConnect !== 'undefined') {
	      if (scriptTagConfig.autoConnect === '') {
	        // Special case for empty string.  It means `true` (see above).
	        scriptTagConfig.autoConnect = true;
	      }
	      else if (typeof scriptTagConfig.autoConnect !== 'boolean') {
	        throw new Error('sails.io.js :: Unexpected/invalid configuration for `autoConnect` provided in script tag: `'+scriptTagConfig.autoConnect+'` (a `'+typeof scriptTagConfig.autoConnect+'`). Should be a boolean.');
	      }
	    }
	
	
	    // `environment`
	    if (typeof scriptTagConfig.environment !== 'undefined') {
	      if (typeof scriptTagConfig.environment !== 'string') {
	        throw new Error('sails.io.js :: Unexpected/invalid configuration for `environment` provided in script tag: `'+scriptTagConfig.environment+'` (a `'+typeof scriptTagConfig.environment+'`). Should be a string.');
	      }
	    }
	
	
	    // `headers`
	    if (typeof scriptTagConfig.headers !== 'undefined') {
	      if (typeof scriptTagConfig.headers !== 'object' || Array.isArray(scriptTagConfig.headers)) {
	        throw new Error('sails.io.js :: Unexpected/invalid configuration for `headers` provided in script tag: `'+scriptTagConfig.headers+'` (a `'+typeof scriptTagConfig.headers+'`). Should be a JSON-compatible dictionary (i.e. `{}`).  Don\'t forget those double quotes (""), even on key names!  Use single quotes (\'\') to wrap the HTML attribute value; e.g. `headers=\'{"X-Auth": "foo"}\'`');
	      }
	    }
	
	
	    // `url`
	    if (typeof scriptTagConfig.url !== 'undefined') {
	      if (typeof scriptTagConfig.url !== 'string') {
	        throw new Error('sails.io.js :: Unexpected/invalid configuration for `url` provided in script tag: `'+scriptTagConfig.url+'` (a `'+typeof scriptTagConfig.url+'`). Should be a string.');
	      }
	    }
	
	    // OTHER `io.sails` options are NOT CURRENTLY SUPPORTED VIA HTML ATTRIBUTES.
	  }
	
	
	
	
	  // Grab a reference to the global socket.io client (if one is available).
	  // This is used via closure below to determine which `io` to use when the
	  // socket.io client instance (`io`) is augmented to become the Sails client
	  // SDK instance (still `io`).
	  var _existingGlobalSocketIO = (typeof io !== 'undefined') ? io : undefined;
	
	
	
	
	  //////////////////////////////////////////////////////////////
	  /////
	  ///// NOW FOR BUNCHES OF:
	  /////  - PRIVATE FUNCTION DEFINITIONS
	  /////  - CONSTRUCTORS
	  /////  - AND METHODS
	  /////
	  //////////////////////////////////////////////////////////////
	  //
	
	
	
	  //  ███████╗ █████╗ ██╗██╗     ███████╗      ██╗ ██████╗        ██████╗██╗     ██╗███████╗███╗   ██╗████████╗
	  //  ██╔════╝██╔══██╗██║██║     ██╔════╝      ██║██╔═══██╗      ██╔════╝██║     ██║██╔════╝████╗  ██║╚══██╔══╝
	  //  ███████╗███████║██║██║     ███████╗█████╗██║██║   ██║█████╗██║     ██║     ██║█████╗  ██╔██╗ ██║   ██║
	  //  ╚════██║██╔══██║██║██║     ╚════██║╚════╝██║██║   ██║╚════╝██║     ██║     ██║██╔══╝  ██║╚██╗██║   ██║
	  //  ███████║██║  ██║██║███████╗███████║      ██║╚██████╔╝      ╚██████╗███████╗██║███████╗██║ ╚████║   ██║
	  //  ╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝      ╚═╝ ╚═════╝        ╚═════╝╚══════╝╚═╝╚══════╝╚═╝  ╚═══╝   ╚═╝
	  //
	
	  /**
	   * SailsIOClient()
	   *
	   * Augment the provided Socket.io client object (`io`) with methods for
	   * talking and listening to one or more Sails backend(s).  If no `io` was
	   * provided (i.e. in a browser setting), then attempt to use the global.
	   *
	   * This absorbs implicit `io.sails` configuration, sets a timer for
	   * automatically connecting a socket (if `io.sails.autoConnect` is enabled)
	   * and returns the augmented `io`.
	   *
	   * Note:
	   * The automatically-connected socket is exposed as `io.socket`.  If this
	   * socket attempts to bind event listeners or send requests before it is
	   * connected, it will be queued up and replayed when the connection is
	   * successfully opened.
	   *
	   * @param {SocketIO} io
	   * @returns {SailsIOClient} [also called `io`]
	   */
	
	  function SailsIOClient(_providedSocketIO) {
	
	    // First, determine which `io` we're augmenting.
	    //
	    // Prefer the passed-in `io` instance, but fall back to the
	    // global one if we've got it.
	    var io;
	    if (_providedSocketIO) {
	      io = _providedSocketIO;
	    }
	    else {
	      io = _existingGlobalSocketIO;
	    }
	    // (note that for readability, we deliberately do not short circuit or use the tertiary operator above)
	
	
	    // If a socket.io client (`io`) is not available, none of this will work.
	    if (!io) {
	      // If node:
	      if (SDK_INFO.platform === 'node') {
	        throw new Error('No socket.io client available.  When requiring `sails.io.js` from Node.js, a socket.io client (`io`) must be passed in; e.g.:\n```\nvar io = require(\'sails.io.js\')( require(\'socket.io-client\') )\n```\n(see https://github.com/balderdashy/sails.io.js/tree/master/test for more examples)');
	      }
	      // Otherwise, this is a web browser:
	      else {
	        throw new Error('The Sails socket SDK depends on the socket.io client, but the socket.io global (`io`) was not available when `sails.io.js` loaded.  Normally, the socket.io client code is bundled with sails.io.js, so something is a little off.  Please check to be sure this version of `sails.io.js` has the minified Socket.io client at the top of the file.');
	      }
	    }
	
	    // If the chosen socket.io client (`io`) has ALREADY BEEN AUGMENTED by this SDK,
	    // (i.e. if it already has a `.sails` property) then throw an error.
	    if (io.sails) {
	      // If node:
	      if (SDK_INFO.platform === 'node') {
	        throw new Error('The provided socket.io client (`io`) has already been augmented into a Sails socket SDK instance (it has `io.sails`).');
	      }
	      // Otherwise, this is a web browser:
	      else {
	        throw new Error('The socket.io client (`io`) has already been augmented into a Sails socket SDK instance.  Usually, this means you are bringing `sails.io.js` onto the page more than once.');
	      }
	    }
	
	
	    /**
	     * A little logger for this library to use internally.
	     * Basically just a wrapper around `console.log` with
	     * support for feature-detection.
	     *
	     * @api private
	     * @factory
	     */
	    function LoggerFactory(options) {
	      options = options || {
	        prefix: true
	      };
	
	      // If `console.log` is not accessible, `log` is a noop.
	      if (
	        typeof console !== 'object' ||
	        typeof console.log !== 'function' ||
	        typeof console.log.bind !== 'function'
	      ) {
	        return function noop() {};
	      }
	
	      return function log() {
	        var args = Array.prototype.slice.call(arguments);
	
	        // All logs are disabled when `io.sails.environment = 'production'`.
	        if (io.sails.environment === 'production') return;
	
	        // Add prefix to log messages (unless disabled)
	        var PREFIX = '';
	        if (options.prefix) {
	          args.unshift(PREFIX);
	        }
	
	        // Call wrapped logger
	        console.log
	          .bind(console)
	          .apply(this, args);
	      };
	    }//</LoggerFactory>
	
	    // Create a private logger instance
	    var consolog = LoggerFactory();
	    consolog.noPrefix = LoggerFactory({
	      prefix: false
	    });
	
	
	
	    /**
	     * What is the `requestQueue`?
	     *
	     * The request queue is used to simplify app-level connection logic--
	     * i.e. so you don't have to wait for the socket to be connected
	     * to start trying to  synchronize data.
	     *
	     * @api private
	     * @param  {SailsSocket}  socket
	     */
	
	    function runRequestQueue (socket) {
	      var queue = socket.requestQueue;
	
	      if (!queue) return;
	      for (var i in queue) {
	
	        // Double-check that `queue[i]` will not
	        // inadvertently discover extra properties attached to the Object
	        // and/or Array prototype by other libraries/frameworks/tools.
	        // (e.g. Ember does this. See https://github.com/balderdashy/sails.io.js/pull/5)
	        var isSafeToDereference = ({}).hasOwnProperty.call(queue, i);
	        if (isSafeToDereference) {
	          // Get the arguments that were originally made to the "request" method
	          var requestArgs = queue[i];
	          // Call the request method again in the context of the socket, with the original args
	          socket.request.apply(socket, requestArgs);
	        }
	      }
	
	      // Now empty the queue to remove it as a source of additional complexity.
	      socket.requestQueue = null;
	    }
	
	
	
	    /**
	     * Send a JSONP request.
	     *
	     * @param  {Object}   opts [optional]
	     * @param  {Function} cb
	     * @return {XMLHttpRequest}
	     */
	
	    function jsonp(opts, cb) {
	      opts = opts || {};
	
	      if (typeof window === 'undefined') {
	        // TODO: refactor node usage to live in here
	        return cb();
	      }
	
	      var scriptEl = document.createElement('script');
	      window._sailsIoJSConnect = function(response) {
	        // In rare circumstances our script may have been vaporised.
	        // Remove it, but only if it still exists
	        // https://github.com/balderdashy/sails.io.js/issues/92
	        if (scriptEl && scriptEl.parentNode) {
	            scriptEl.parentNode.removeChild(scriptEl);
	        }
	
	        cb(response);
	      };
	      scriptEl.src = opts.url;
	      document.getElementsByTagName('head')[0].appendChild(scriptEl);
	
	    }
	
	
	
	
	    //       ██╗███████╗ ██████╗ ███╗   ██╗      ██╗    ██╗███████╗██████╗ ███████╗ ██████╗  ██████╗██╗  ██╗███████╗████████╗
	    //       ██║██╔════╝██╔═══██╗████╗  ██║      ██║    ██║██╔════╝██╔══██╗██╔════╝██╔═══██╗██╔════╝██║ ██╔╝██╔════╝╚══██╔══╝
	    //       ██║███████╗██║   ██║██╔██╗ ██║█████╗██║ █╗ ██║█████╗  ██████╔╝███████╗██║   ██║██║     █████╔╝ █████╗     ██║
	    //  ██   ██║╚════██║██║   ██║██║╚██╗██║╚════╝██║███╗██║██╔══╝  ██╔══██╗╚════██║██║   ██║██║     ██╔═██╗ ██╔══╝     ██║
	    //  ╚█████╔╝███████║╚██████╔╝██║ ╚████║      ╚███╔███╔╝███████╗██████╔╝███████║╚██████╔╝╚██████╗██║  ██╗███████╗   ██║
	    //   ╚════╝ ╚══════╝ ╚═════╝ ╚═╝  ╚═══╝       ╚══╝╚══╝ ╚══════╝╚═════╝ ╚══════╝ ╚═════╝  ╚═════╝╚═╝  ╚═╝╚══════╝   ╚═╝
	    //
	    //  ██████╗ ███████╗███████╗██████╗  ██████╗ ███╗   ██╗███████╗███████╗     ██╗     ██╗██╗    ██╗██████╗ ██╗
	    //  ██╔══██╗██╔════╝██╔════╝██╔══██╗██╔═══██╗████╗  ██║██╔════╝██╔════╝    ██╔╝     ██║██║    ██║██╔══██╗╚██╗
	    //  ██████╔╝█████╗  ███████╗██████╔╝██║   ██║██╔██╗ ██║███████╗█████╗      ██║      ██║██║ █╗ ██║██████╔╝ ██║
	    //  ██╔══██╗██╔══╝  ╚════██║██╔═══╝ ██║   ██║██║╚██╗██║╚════██║██╔══╝      ██║ ██   ██║██║███╗██║██╔══██╗ ██║
	    //  ██║  ██║███████╗███████║██║     ╚██████╔╝██║ ╚████║███████║███████╗    ╚██╗╚█████╔╝╚███╔███╔╝██║  ██║██╔╝
	    //  ╚═╝  ╚═╝╚══════╝╚══════╝╚═╝      ╚═════╝ ╚═╝  ╚═══╝╚══════╝╚══════╝     ╚═╝ ╚════╝  ╚══╝╚══╝ ╚═╝  ╚═╝╚═╝
	    //
	
	    /**
	     * The JWR (JSON WebSocket Response) received from a Sails server.
	     *
	     * @api public
	     * @param  {Object}  responseCtx
	     *         => :body
	     *         => :statusCode
	     *         => :headers
	     *
	     * @constructor
	     */
	
	    function JWR(responseCtx) {
	      this.body = responseCtx.body || {};
	      this.headers = responseCtx.headers || {};
	      this.statusCode = responseCtx.statusCode || 200;
	      if (this.statusCode < 200 || this.statusCode >= 400) {
	        this.error = this.body || this.statusCode;
	      }
	    }
	    JWR.prototype.toString = function() {
	      return '[ResponseFromSails]' + '  -- ' +
	        'Status: ' + this.statusCode + '  -- ' +
	        'Headers: ' + this.headers + '  -- ' +
	        'Body: ' + this.body;
	    };
	    JWR.prototype.toPOJO = function() {
	      return {
	        body: this.body,
	        headers: this.headers,
	        statusCode: this.statusCode
	      };
	    };
	    JWR.prototype.pipe = function() {
	      // TODO: look at substack's stuff
	      return new Error('Client-side streaming support not implemented yet.');
	    };
	
	
	
	
	    //          ███████╗███╗   ███╗██╗████████╗███████╗██████╗  ██████╗ ███╗   ███╗ ██╗██╗
	    //          ██╔════╝████╗ ████║██║╚══██╔══╝██╔════╝██╔══██╗██╔═══██╗████╗ ████║██╔╝╚██╗
	    //          █████╗  ██╔████╔██║██║   ██║   █████╗  ██████╔╝██║   ██║██╔████╔██║██║  ██║
	    //          ██╔══╝  ██║╚██╔╝██║██║   ██║   ██╔══╝  ██╔══██╗██║   ██║██║╚██╔╝██║██║  ██║
	    //  ███████╗███████╗██║ ╚═╝ ██║██║   ██║   ██║     ██║  ██║╚██████╔╝██║ ╚═╝ ██║╚██╗██╔╝
	    //  ╚══════╝╚══════╝╚═╝     ╚═╝╚═╝   ╚═╝   ╚═╝     ╚═╝  ╚═╝ ╚═════╝ ╚═╝     ╚═╝ ╚═╝╚═╝
	    //
	
	    /**
	     * @api private
	     * @param  {SailsSocket} socket  [description]
	     * @param  {Object} requestCtx [description]
	     */
	
	    function _emitFrom(socket, requestCtx) {
	
	      if (!socket._raw) {
	        throw new Error('Failed to emit from socket- raw SIO socket is missing.');
	      }
	
	      // Since callback is embedded in requestCtx,
	      // retrieve it and delete the key before continuing.
	      var cb = requestCtx.cb;
	      delete requestCtx.cb;
	
	      // Name of the appropriate socket.io listener on the server
	      // ( === the request method or "verb", e.g. 'get', 'post', 'put', etc. )
	      var sailsEndpoint = requestCtx.method;
	
	      socket._raw.emit(sailsEndpoint, requestCtx, function serverResponded(responseCtx) {
	
	        // Send back (emulatedHTTPBody, jsonWebSocketResponse)
	        if (cb) {
	          cb(responseCtx.body, new JWR(responseCtx));
	        }
	      });
	    }
	
	
	
	
	
	
	
	    //  ███████╗ █████╗ ██╗██╗     ███████╗███████╗ ██████╗  ██████╗██╗  ██╗███████╗████████╗
	    //  ██╔════╝██╔══██╗██║██║     ██╔════╝██╔════╝██╔═══██╗██╔════╝██║ ██╔╝██╔════╝╚══██╔══╝
	    //  ███████╗███████║██║██║     ███████╗███████╗██║   ██║██║     █████╔╝ █████╗     ██║
	    //  ╚════██║██╔══██║██║██║     ╚════██║╚════██║██║   ██║██║     ██╔═██╗ ██╔══╝     ██║
	    //  ███████║██║  ██║██║███████╗███████║███████║╚██████╔╝╚██████╗██║  ██╗███████╗   ██║
	    //  ╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚══════╝ ╚═════╝  ╚═════╝╚═╝  ╚═╝╚══════╝   ╚═╝
	    //
	
	    /**
	     * SailsSocket
	     *
	     * A wrapper for an underlying Socket instance that communicates directly
	     * to the Socket.io server running inside of Sails.
	     *
	     * If no `socket` option is provied, SailsSocket will function as a mock. It will queue socket
	     * requests and event handler bindings, replaying them when the raw underlying socket actually
	     * connects. This is handy when we don't necessarily have the valid configuration to know
	     * WHICH SERVER to talk to yet, etc.  It is also used by `io.socket` for your convenience.
	     *
	     * @constructor
	     * @api private
	     *
	     * ----------------------------------------------------------------------
	     * Note: This constructor should not be used directly. To obtain a `SailsSocket`
	     * instance of your very own, run:
	     * ```
	     * var mySocket = io.sails.connect();
	     * ```
	     * ----------------------------------------------------------------------
	     */
	    function SailsSocket (opts){
	      var self = this;
	      opts = opts||{};
	
	      // Set up connection options so that they can only be changed when socket is disconnected.
	      var _opts = {};
	      SOCKET_OPTIONS.forEach(function(option) {
	        // Okay to change global headers while socket is connected
	        if (option == 'headers') {return;}
	        Object.defineProperty(self, option, {
	          get: function() {
	            if (option == 'url') {
	              return _opts[option] || (self._raw && self._raw.io && self._raw.io.uri);
	            }
	            return _opts[option];
	          },
	          set: function(value) {
	            // Don't allow value to be changed while socket is connected
	            if (self.isConnected() && io.sails.strict !== false && value != _opts[option]) {
	              throw new Error('Cannot change value of `' + option + '` while socket is connected.');
	            }
	            // If socket is attempting to reconnect, stop it.
	            if (self._raw && self._raw.io && self._raw.io.reconnecting && !self._raw.io.skipReconnect) {
	              self._raw.io.skipReconnect = true;
	              consolog('Stopping reconnect; use .reconnect() to connect socket after changing options.');
	            }
	            _opts[option] = value;
	          }
	        });
	      });
	
	      // Absorb opts into SailsSocket instance
	      // See https://sailsjs.org/reference/websockets/sails.io.js/SailsSocket/properties.md
	      // for description of options
	      SOCKET_OPTIONS.forEach(function(option) {
	        self[option] = opts[option];
	      });
	
	      // Set up "eventQueue" to hold event handlers which have not been set on the actual raw socket yet.
	      self.eventQueue = {};
	
	      // Listen for special `parseError` event sent from sockets hook on the backend
	      // if an error occurs but a valid callback was not received from the client
	      // (i.e. so the server had no other way to send back the error information)
	      self.on('sails:parseError', function (err){
	        consolog('Sails encountered an error parsing a socket message sent from this client, and did not have access to a callback function to respond with.');
	        consolog('Error details:',err);
	      });
	
	      // TODO:
	      // Listen for a special private message on any connected that allows the server
	      // to set the environment (giving us 100% certainty that we guessed right)
	      // However, note that the `console.log`s called before and after connection
	      // are still forced to rely on our existing heuristics (to disable, tack #production
	      // onto the URL used to fetch this file.)
	    }//</SailsSocket>
	
	
	    /**
	     * `SailsSocket.prototype._connect()`
	     *
	     * Begin connecting this socket to the server.
	     *
	     * @api private
	     */
	    SailsSocket.prototype._connect = function (){
	      var self = this;
	
	      self.isConnecting = true;
	
	      // Apply `io.sails` config as defaults
	      // (now that at least one tick has elapsed)
	      // See https://sailsjs.org/reference/websockets/sails.io.js/SailsSocket/properties.md
	      // for description of options and default values
	      SOCKET_OPTIONS.forEach(function(option) {
	        if ('undefined' == typeof self[option]) {
	          self[option] = io.sails[option];
	        }
	      });
	
	      // Headers that will be sent with the initial request to /socket.io (Node.js only)
	      self.extraHeaders = self.initialConnectionHeaders || {};
	
	      // Log a warning if non-Node.js platform attempts to use `initialConnectionHeaders`
	      if (self.initialConnectionHeaders && SDK_INFO.platform !== 'node') {
	        if (typeof console === 'object' && typeof console.warn === 'function') {
	          console.warn('initialConnectionHeaders option available in Node.js only!');
	        }
	      }
	
	      // Ensure URL has no trailing slash
	      self.url = self.url ? self.url.replace(/(\/)$/, '') : undefined;
	
	      // Mix the current SDK version into the query string in
	      // the connection request to the server:
	      if (typeof self.query !== 'string') self.query = SDK_INFO.versionString;
	      else self.query += '&' + SDK_INFO.versionString;
	
	      // Determine whether this is a cross-origin socket by examining the
	      // hostname and port on the `window.location` object.  If it's cross-origin,
	      // we'll attempt to get a cookie for the domain so that a Sails session can
	      // be established.
	      var isXOrigin = (function (){
	
	        // If `window` doesn't exist (i.e. being used from Node.js), then
	        // we won't bother attempting to get a cookie.  If you're using sockets
	        // from Node.js and find you need to share a session between multiple
	        // socket connections, you'll need to make an HTTP request to the /__getcookie
	        // endpoint of the Sails server (or any endpoint that returns a set-cookie header)
	        // and then use the cookie value in the `initialConnectionHeaders` option to
	        // io.sails.connect()
	        if (typeof window === 'undefined' || typeof window.location === 'undefined') {
	          return false;
	        }
	
	        // If `self.url` (aka "target") is falsy, then we don't need to worry about it.
	        if (typeof self.url !== 'string') { return false; }
	
	        // Get information about the "target" (`self.url`)
	        var targetProtocol = (function (){
	          try {
	            targetProtocol = self.url.match(/^([a-z]+:\/\/)/i)[1].toLowerCase();
	          }
	          catch (e) {}
	          targetProtocol = targetProtocol || 'http://';
	          return targetProtocol;
	        })();
	        var isTargetSSL = !!self.url.match('^https');
	        var targetPort = (function (){
	          try {
	            return self.url.match(/^[a-z]+:\/\/[^:]*:([0-9]*)/i)[1];
	          }
	          catch (e){}
	          return isTargetSSL ? '443' : '80';
	        })();
	        var targetAfterProtocol = self.url.replace(/^([a-z]+:\/\/)/i, '');
	
	
	        // If target protocol is different than the actual protocol,
	        // then we'll consider this cross-origin.
	        if (targetProtocol.replace(/[:\/]/g, '') !== window.location.protocol.replace(/[:\/]/g,'')) {
	          return true;
	        }
	
	
	        // If target hostname is different than actual hostname, we'll consider this cross-origin.
	        var hasSameHostname = targetAfterProtocol.search(window.location.hostname) === 0;
	        if (!hasSameHostname) {
	          return true;
	        }
	
	        // If no actual port is explicitly set on the `window.location` object,
	        // we'll assume either 80 or 443.
	        var isLocationSSL = window.location.protocol.match(/https/i);
	        var locationPort = (window.location.port+'') || (isLocationSSL ? '443' : '80');
	
	        // Finally, if ports don't match, we'll consider this cross-origin.
	        if (targetPort !== locationPort) {
	          return true;
	        }
	
	        // Otherwise, it's the same origin.
	        return false;
	
	      })();
	
	
	      // Prepare to start connecting the socket
	      (function selfInvoking (cb){
	
	        // If this is an attempt at a cross-origin or cross-port
	        // socket connection via a browswe, send a JSONP request
	        // first to ensure that a valid cookie is available.
	        // This can be disabled by setting `io.sails.useCORSRouteToGetCookie`
	        // to false.
	        //
	        // Otherwise, skip the stuff below.
	        //
	        if (!(self.useCORSRouteToGetCookie && isXOrigin)) {
	          return cb();
	        }
	
	        // Figure out the x-origin CORS route
	        // (Sails provides a default)
	        var xOriginCookieURL = self.url;
	        if (typeof self.useCORSRouteToGetCookie === 'string') {
	          xOriginCookieURL += self.useCORSRouteToGetCookie;
	        }
	        else {
	          xOriginCookieURL += '/__getcookie';
	        }
	
	        // Make the AJAX request (CORS)
	        jsonp({
	          url: xOriginCookieURL,
	          method: 'GET'
	        }, cb);
	
	      })(function goAheadAndActuallyConnect() {
	
	        // Now that we're ready to connect, create a raw underlying Socket
	        // using Socket.io and save it as `_raw` (this will start it connecting)
	        self._raw = io(self.url, self);
	
	        // Replay event bindings from the eager socket
	        self.replay();
	
	
	        /**
	         * 'connect' event is triggered when the socket establishes a connection
	         *  successfully.
	         */
	        self.on('connect', function socketConnected() {
	          self.isConnecting = false;
	          consolog.noPrefix(
	            '\n' +
	            '\n' +
	            // '    |>    ' + '\n' +
	            // '  \\___/  '+️
	            // '\n'+
	             '  |>    Now connected to Sails.' + '\n' +
	            '\\___/   For help, see: http://bit.ly/1DmTvgK' + '\n' +
	             '        (using sails.io.js '+io.sails.sdk.platform+' SDK @v'+io.sails.sdk.version+')'+ '\n' +
	            '\n'+
	            '\n'+
	            // '\n'+
	            ''
	            // ' ⚓︎ (development mode)'
	            // 'e.g. to send a GET request to Sails via WebSockets, run:'+ '\n' +
	            // '`io.socket.get("/foo", function serverRespondedWith (body, jwr) { console.log(body); })`'+ '\n' +
	          );
	        });
	
	        self.on('disconnect', function() {
	          self.connectionLostTimestamp = (new Date()).getTime();
	          consolog('====================================');
	          consolog('Socket was disconnected from Sails.');
	          consolog('Usually, this is due to one of the following reasons:' + '\n' +
	            ' -> the server ' + (self.url ? self.url + ' ' : '') + 'was taken down' + '\n' +
	            ' -> your browser lost internet connectivity');
	          consolog('====================================');
	        });
	
	        self.on('reconnecting', function(numAttempts) {
	          consolog(
	            '\n'+
	            '        Socket is trying to reconnect to Sails...\n'+
	            '_-|>_-  (attempt #' + numAttempts + ')'+'\n'+
	            '\n'
	          );
	        });
	
	        self.on('reconnect', function(transport, numAttempts) {
	          if (!self.isConnecting) {
	            self.on('connect', runRequestQueue.bind(self, self));
	          }
	          var msSinceConnectionLost = ((new Date()).getTime() - self.connectionLostTimestamp);
	          var numSecsOffline = (msSinceConnectionLost / 1000);
	          consolog(
	            '\n'+
	             '  |>    Socket reconnected successfully after'+'\n'+
	            '\\___/   being offline for ~' + numSecsOffline + ' seconds.'+'\n'+
	            '\n'
	          );
	        });
	
	        // 'error' event is triggered if connection can not be established.
	        // (usually because of a failed authorization, which is in turn
	        // usually due to a missing or invalid cookie)
	        self.on('error', function failedToConnect(err) {
	          self.isConnecting = false;
	          ////////////////////////////////////////////////////////////////////////////////////
	          // Note:
	          // In the future, we could provide a separate event for when a socket cannot connect
	          // due to a failed `beforeConnect` (aka "authorization" if you're old school).
	          // this could probably be implemented by emitting a special event from the server.
	          ////////////////////////////////////////////////////////////////////////////////////
	
	          consolog(
	            'Failed to connect socket (possibly due to failed `beforeConnect` on server)',
	            'Error:', err
	          );
	        });
	      });
	
	    };
	
	    /**
	     * Reconnect the underlying socket.
	     *
	     * @api public
	     */
	    SailsSocket.prototype.reconnect = function (){
	      if (this.isConnecting) {
	        throw new Error('Cannot connect- socket is already connecting');
	      }
	      if (this.isConnected()) {
	        throw new Error('Cannot connect- socket is already connected');
	      }
	      return this._connect();
	    };
	
	    /**
	     * Disconnect the underlying socket.
	     *
	     * @api public
	     */
	    SailsSocket.prototype.disconnect = function (){
	      this.isConnecting = false;
	      if (!this.isConnected()) {
	        throw new Error('Cannot disconnect- socket is already disconnected');
	      }
	      return this._raw.disconnect();
	    };
	
	
	
	    /**
	     * isConnected
	     *
	     * @api private
	     * @return {Boolean} whether the socket is connected and able to
	     *                           communicate w/ the server.
	     */
	
	    SailsSocket.prototype.isConnected = function () {
	      if (!this._raw) {
	        return false;
	      }
	
	      return !!this._raw.connected;
	    };
	
	
	
	    /**
	     * [replay description]
	     * @return {[type]} [description]
	     */
	    SailsSocket.prototype.replay = function (){
	      var self = this;
	
	      // Pass events and a reference to the request queue
	      // off to the self._raw for consumption
	      for (var evName in self.eventQueue) {
	        for (var i in self.eventQueue[evName]) {
	          self._raw.on(evName, self.eventQueue[evName][i]);
	        }
	      }
	
	      // Bind a one-time function to run the request queue
	      // when the self._raw connects.
	      if ( !self.isConnected() ) {
	        self._raw.once('connect', runRequestQueue.bind(self, self));
	      }
	      // Or run it immediately if self._raw is already connected
	      else {
	        runRequestQueue(self);
	      }
	
	      return self;
	    };
	
	
	    /**
	     * Chainable method to bind an event to the socket.
	     *
	     * @param  {String}   evName [event name]
	     * @param  {Function} fn     [event handler function]
	     * @return {SailsSocket}
	     */
	    SailsSocket.prototype.on = function (evName, fn){
	
	      // Bind the event to the raw underlying socket if possible.
	      if (this._raw) {
	        this._raw.on(evName, fn);
	        return this;
	      }
	
	      // Otherwise queue the event binding.
	      if (!this.eventQueue[evName]) {
	        this.eventQueue[evName] = [fn];
	      }
	      else {
	        this.eventQueue[evName].push(fn);
	      }
	
	      return this;
	    };
	
	    /**
	     * Chainable method to unbind an event from the socket.
	     *
	     * @param  {String}   evName [event name]
	     * @param  {Function} fn     [event handler function]
	     * @return {SailsSocket}
	     */
	    SailsSocket.prototype.off = function (evName, fn){
	
	      // Bind the event to the raw underlying socket if possible.
	      if (this._raw) {
	        this._raw.off(evName, fn);
	        return this;
	      }
	
	      // Otherwise queue the event binding.
	      if (this.eventQueue[evName] && this.eventQueue[evName].indexOf(fn) > -1) {
	        this.eventQueue[evName].splice(this.eventQueue[evName].indexOf(fn), 1);
	      }
	
	      return this;
	    };
	
	
	    /**
	     * Chainable method to unbind all events from the socket.
	     *
	     * @return {SailsSocket}
	     */
	    SailsSocket.prototype.removeAllListeners = function (){
	
	      // Bind the event to the raw underlying socket if possible.
	      if (this._raw) {
	        this._raw.removeAllListeners();
	        return this;
	      }
	
	      // Otherwise queue the event binding.
	      this.eventQueue = {};
	
	      return this;
	    };
	
	    /**
	     * Simulate a GET request to sails
	     * e.g.
	     *    `socket.get('/user/3', Stats.populate)`
	     *
	     * @api public
	     * @param {String} url    ::    destination URL
	     * @param {Object} data   ::    parameters to send with the request [optional]
	     * @param {Function} cb   ::    callback function to call when finished [optional]
	     */
	
	    SailsSocket.prototype.get = function(url, data, cb) {
	
	      // `data` is optional
	      if (typeof data === 'function') {
	        cb = data;
	        data = {};
	      }
	
	      return this.request({
	        method: 'get',
	        params: data,
	        url: url
	      }, cb);
	    };
	
	
	
	    /**
	     * Simulate a POST request to sails
	     * e.g.
	     *    `socket.post('/event', newMeeting, $spinner.hide)`
	     *
	     * @api public
	     * @param {String} url    ::    destination URL
	     * @param {Object} data   ::    parameters to send with the request [optional]
	     * @param {Function} cb   ::    callback function to call when finished [optional]
	     */
	
	    SailsSocket.prototype.post = function(url, data, cb) {
	
	      // `data` is optional
	      if (typeof data === 'function') {
	        cb = data;
	        data = {};
	      }
	
	      return this.request({
	        method: 'post',
	        data: data,
	        url: url
	      }, cb);
	    };
	
	
	
	    /**
	     * Simulate a PUT request to sails
	     * e.g.
	     *    `socket.post('/event/3', changedFields, $spinner.hide)`
	     *
	     * @api public
	     * @param {String} url    ::    destination URL
	     * @param {Object} data   ::    parameters to send with the request [optional]
	     * @param {Function} cb   ::    callback function to call when finished [optional]
	     */
	
	    SailsSocket.prototype.put = function(url, data, cb) {
	
	      // `data` is optional
	      if (typeof data === 'function') {
	        cb = data;
	        data = {};
	      }
	
	      return this.request({
	        method: 'put',
	        params: data,
	        url: url
	      }, cb);
	    };
	
	
	
	    /**
	     * Simulate a DELETE request to sails
	     * e.g.
	     *    `socket.delete('/event', $spinner.hide)`
	     *
	     * @api public
	     * @param {String} url    ::    destination URL
	     * @param {Object} data   ::    parameters to send with the request [optional]
	     * @param {Function} cb   ::    callback function to call when finished [optional]
	     */
	
	    SailsSocket.prototype['delete'] = function(url, data, cb) {
	
	      // `data` is optional
	      if (typeof data === 'function') {
	        cb = data;
	        data = {};
	      }
	
	      return this.request({
	        method: 'delete',
	        params: data,
	        url: url
	      }, cb);
	    };
	
	
	
	    /**
	     * Simulate an HTTP request to sails
	     * e.g.
	     * ```
	     * socket.request({
	     *   url:'/user',
	     *   params: {},
	     *   method: 'POST',
	     *   headers: {}
	     * }, function (responseBody, JWR) {
	     *   // ...
	     * });
	     * ```
	     *
	     * @api public
	     * @option {String} url    ::    destination URL
	     * @option {Object} params ::    parameters to send with the request [optional]
	     * @option {Object} headers::    headers to send with the request [optional]
	     * @option {Function} cb   ::    callback function to call when finished [optional]
	     * @option {String} method ::    HTTP request method [optional]
	     */
	
	    SailsSocket.prototype.request = function(options, cb) {
	
	      var usage =
	      'Usage:\n'+
	      'socket.request( options, [fnToCallWhenComplete] )\n\n'+
	      'options.url :: e.g. "/foo/bar"'+'\n'+
	      'options.method :: e.g. "get", "post", "put", or "delete", etc.'+'\n'+
	      'options.params :: e.g. { emailAddress: "mike@sailsjs.org" }'+'\n'+
	      'options.headers :: e.g. { "x-my-custom-header": "some string" }';
	      // Old usage:
	      // var usage = 'Usage:\n socket.'+(options.method||'request')+'('+
	      //   ' destinationURL, [dataToSend], [fnToCallWhenComplete] )';
	
	
	      // Validate options and callback
	      if (typeof options !== 'object' || typeof options.url !== 'string') {
	        throw new Error('Invalid or missing URL!\n' + usage);
	      }
	      if (options.method && typeof options.method !== 'string') {
	        throw new Error('Invalid `method` provided (should be a string like "post" or "put")\n' + usage);
	      }
	      if (options.headers && typeof options.headers !== 'object') {
	        throw new Error('Invalid `headers` provided (should be a dictionary with string values)\n' + usage);
	      }
	      if (options.params && typeof options.params !== 'object') {
	        throw new Error('Invalid `params` provided (should be a dictionary with JSON-serializable values)\n' + usage);
	      }
	      if (options.data && typeof options.data !== 'object') {
	        throw new Error('Invalid `data` provided (should be a dictionary with JSON-serializable values)\n' + usage);
	      }
	      if (cb && typeof cb !== 'function') {
	        throw new Error('Invalid callback function!\n' + usage);
	      }
	
	      // Accept either `params` or `data` for backwards compatibility (but not both!)
	      if (options.data && options.params) {
	        throw new Error('Cannot specify both `params` and `data`!  They are aliases of each other.\n' + usage);
	      }
	      else if (options.data) {
	        options.params = options.data;
	        delete options.data;
	      }
	
	
	      // If this socket is not connected yet, queue up this request
	      // instead of sending it.
	      // (so it can be replayed when the socket comes online.)
	      if ( ! this.isConnected() ) {
	
	        // If no queue array exists for this socket yet, create it.
	        this.requestQueue = this.requestQueue || [];
	        this.requestQueue.push([options, cb]);
	        return;
	      }
	
	      // Otherwise, our socket is connected, so continue prepping
	      // the request.
	
	      // Default headers to an empty object
	      options.headers = options.headers || {};
	
	      // Build a simulated request object
	      // (and sanitize/marshal options along the way)
	      var requestCtx = {
	
	        method: options.method.toLowerCase() || 'get',
	
	        headers: options.headers,
	
	        data: options.params || options.data || {},
	
	        // Remove trailing slashes and spaces to make packets smaller.
	        url: options.url.replace(/^(.+)\/*\s*$/, '$1'),
	
	        cb: cb
	      };
	
	      // Merge global headers in
	      if (this.headers && 'object' == typeof this.headers) {
	        for (var header in this.headers) {
	          if (!options.headers.hasOwnProperty(header)) {
	            options.headers[header] = this.headers[header];
	          }
	        }
	      }
	
	      // Send the request.
	      _emitFrom(this, requestCtx);
	    };
	
	
	
	    /**
	     * Socket.prototype._request
	     *
	     * Simulate HTTP over Socket.io.
	     *
	     * @api private
	     * @param  {[type]}   options [description]
	     * @param  {Function} cb      [description]
	     */
	    SailsSocket.prototype._request = function(options, cb) {
	      throw new Error('`_request()` was a private API deprecated as of v0.11 of the sails.io.js client. Use `.request()` instead.');
	    };
	
	
	
	
	
	
	
	    //  ██╗ ██████╗    ███████╗ █████╗ ██╗██╗     ███████╗
	    //  ██║██╔═══██╗   ██╔════╝██╔══██╗██║██║     ██╔════╝
	    //  ██║██║   ██║   ███████╗███████║██║██║     ███████╗
	    //  ██║██║   ██║   ╚════██║██╔══██║██║██║     ╚════██║
	    //  ██║╚██████╔╝██╗███████║██║  ██║██║███████╗███████║
	    //  ╚═╝ ╚═════╝ ╚═╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝
	    //
	    // Set an `io.sails` object that may be used for configuration before the
	    // first socket connects (i.e. to allow auto-connect behavior to be
	    // prevented by setting `io.sails.autoConnect` in an inline script
	    // directly after the script tag which loaded this file).
	
	
	    //  ┌─┐┌─┐┌┬┐  ┬ ┬┌─┐  ╔╦╗╔═╗╔═╗╔═╗╦ ╦╦ ╔╦╗╔═╗  ┌─┐┌─┐┬─┐  ┬┌─┐ ┌─┐┌─┐┬┬  ┌─┐
	    //  └─┐├┤  │   │ │├─┘   ║║║╣ ╠╣ ╠═╣║ ║║  ║ ╚═╗  ├┤ │ │├┬┘  ││ │ └─┐├─┤││  └─┐
	    //  └─┘└─┘ ┴   └─┘┴    ═╩╝╚═╝╚  ╩ ╩╚═╝╩═╝╩ ╚═╝  └  └─┘┴└─  ┴└─┘o└─┘┴ ┴┴┴─┘└─┘
	    io.sails = {
	
	      // Whether to automatically connect a socket and save it as `io.socket`.
	      autoConnect: true,
	
	      // The route (path) to hit to get a x-origin (CORS) cookie
	      // (or true to use the default: '/__getcookie')
	      useCORSRouteToGetCookie: true,
	
	      // The environment we're running in.
	      // (logs are not displayed when this is set to 'production')
	      //
	      // Defaults to development unless this script was fetched from a URL
	      // that ends in `*.min.js` or '#production' (may also be manually overridden.)
	      //
	      environment: urlThisScriptWasFetchedFrom.match(/(\#production|\.min\.js)/g) ? 'production' : 'development',
	
	      // The version of this sails.io.js client SDK
	      sdk: SDK_INFO,
	
	      // Transports to use when communicating with the server, in the order they will be tried
	      transports: ['polling', 'websocket']
	    };
	
	
	
	    //  ┌─┐─┐ ┬┌┬┐┌─┐┌┐┌┌┬┐  ┬┌─┐ ┌─┐┌─┐┬┬  ┌─┐  ┌┬┐┌─┐┌─┐┌─┐┬ ┬┬ ┌┬┐┌─┐
	    //  ├┤ ┌┴┬┘ │ ├┤ │││ ││  ││ │ └─┐├─┤││  └─┐   ││├┤ ├┤ ├─┤│ ││  │ └─┐
	    //  └─┘┴ └─ ┴ └─┘┘└┘─┴┘  ┴└─┘o└─┘┴ ┴┴┴─┘└─┘  ─┴┘└─┘└  ┴ ┴└─┘┴─┘┴ └─┘
	    //  ┬ ┬┬┌┬┐┬ ┬  ┌┬┐┬ ┬┌─┐  ╦ ╦╔╦╗╔╦╗╦    ╔═╗╔╦╗╔╦╗╦═╗╦╔╗ ╦ ╦╔╦╗╔═╗╔═╗
	    //  ││││ │ ├─┤   │ ├─┤├┤   ╠═╣ ║ ║║║║    ╠═╣ ║  ║ ╠╦╝║╠╩╗║ ║ ║ ║╣ ╚═╗
	    //  └┴┘┴ ┴ ┴ ┴   ┴ ┴ ┴└─┘  ╩ ╩ ╩ ╩ ╩╩═╝  ╩ ╩ ╩  ╩ ╩╚═╩╚═╝╚═╝ ╩ ╚═╝╚═╝
	    //  ┌─┐┬─┐┌─┐┌┬┐  ┌┬┐┬ ┬┌─┐  ┌─┐┌─┐┬─┐┬┌─┐┌┬┐  ┌┬┐┌─┐┌─┐
	    //  ├┤ ├┬┘│ ││││   │ ├─┤├┤   └─┐│  ├┬┘│├─┘ │    │ ├─┤│ ┬
	    //  └  ┴└─└─┘┴ ┴   ┴ ┴ ┴└─┘  └─┘└─┘┴└─┴┴   ┴    ┴ ┴ ┴└─┘
	    //
	    // Now fold in config provided as HTML attributes on the script tag:
	    // (note that if `io.sails.*` is changed after this script, those changes
	    //  will still take precedence)
	    CONFIGURABLE_VIA_HTML_ATTR.forEach(function (configKey){
	      if (typeof scriptTagConfig[configKey] !== 'undefined') {
	        io.sails[configKey] = scriptTagConfig[configKey];
	      }
	    });
	    //////////////////////////////////////////////////////////////////////////////
	    // Note that the new HTML attribute configuration style may eventually
	    // completely replace the original approach of setting `io.sails` properties,
	    // since the new strategy is easier to reason about.  Also, it would allow us
	    // to remove the timeout below someday.
	    //////////////////////////////////////////////////////////////////////////////
	
	
	
	
	    //  ┬┌─┐ ┌─┐┌─┐┬┬  ┌─┐ ╔═╗╔═╗╔╗╔╔╗╔╔═╗╔═╗╔╦╗  /  \
	    //  ││ │ └─┐├─┤││  └─┐ ║  ║ ║║║║║║║║╣ ║   ║  /   /
	    //  ┴└─┘o└─┘┴ ┴┴┴─┘└─┘o╚═╝╚═╝╝╚╝╝╚╝╚═╝╚═╝ ╩  \  /
	
	    /**
	     * Add `io.sails.connect` function as a wrapper for the built-in `io()` aka `io.connect()`
	     * method, returning a SailsSocket. This special function respects the configured io.sails
	     * connection URL, as well as sending other identifying information (most importantly, the
	     * current version of this SDK).
	     *
	     * @param  {String} url  [optional]
	     * @param  {Object} opts [optional]
	     * @return {Socket}
	     */
	    io.sails.connect = function(url, opts) {
	
	      // Make URL optional
	      if ('object' === typeof url) {
	        opts = url;
	        url = null;
	      }
	
	      // Default opts to empty object
	      opts = opts || {};
	
	      // If explicit connection url is specified, save it to options
	      opts.url = url || opts.url || undefined;
	
	      // Instantiate and return a new SailsSocket- and try to connect immediately.
	      var socket = new SailsSocket(opts);
	      socket._connect();
	      return socket;
	    };
	
	
	
	
	
	
	    //  ██╗ ██████╗    ███████╗ ██████╗  ██████╗██╗  ██╗███████╗████████╗
	    //  ██║██╔═══██╗   ██╔════╝██╔═══██╗██╔════╝██║ ██╔╝██╔════╝╚══██╔══╝
	    //  ██║██║   ██║   ███████╗██║   ██║██║     █████╔╝ █████╗     ██║
	    //  ██║██║   ██║   ╚════██║██║   ██║██║     ██╔═██╗ ██╔══╝     ██║
	    //  ██║╚██████╔╝██╗███████║╚██████╔╝╚██████╗██║  ██╗███████╗   ██║
	    //  ╚═╝ ╚═════╝ ╚═╝╚══════╝ ╚═════╝  ╚═════╝╚═╝  ╚═╝╚══════╝   ╚═╝
	    //
	    // io.socket
	    //
	    // The eager instance of Socket which will automatically try to connect
	    // using the host that this js file was served from.
	    //
	    // This can be disabled or configured by setting properties on `io.sails.*` within the
	    // first cycle of the event loop.
	    //
	
	
	    // Build `io.socket` so it exists
	    // (note that this DOES NOT start the connection process)
	    io.socket = new SailsSocket();
	    //
	    // This socket is not connected yet, and has not even _started_ connecting.
	    //
	    // But in the mean time, this eager socket will be queue events bound by the user
	    // before the first cycle of the event loop (using `.on()`), which will later
	    // be rebound on the raw underlying socket.
	
	
	    //  ┌─┐┌─┐┌┬┐  ┌─┐┬ ┬┌┬┐┌─┐   ┌─┐┌─┐┌┐┌┌┐┌┌─┐┌─┐┌┬┐  ┌┬┐┬┌┬┐┌─┐┬─┐
	    //  └─┐├┤  │   ├─┤│ │ │ │ │───│  │ │││││││├┤ │   │    │ ││││├┤ ├┬┘
	    //  └─┘└─┘ ┴   ┴ ┴└─┘ ┴ └─┘   └─┘└─┘┘└┘┘└┘└─┘└─┘ ┴    ┴ ┴┴ ┴└─┘┴└─
	    // If configured to do so, start auto-connecting after the first cycle of the event loop
	    // has completed (to allow time for this behavior to be configured/disabled
	    // by specifying properties on `io.sails`)
	    setTimeout(function() {
	
	      // If autoConnect is disabled, delete the eager socket (io.socket) and bail out.
	      if (io.sails.autoConnect === false || io.sails.autoconnect === false) {
	        delete io.socket;
	        return;
	      }
	
	      // consolog('Eagerly auto-connecting socket to Sails... (requests will be queued in the mean-time)');
	      io.socket._connect();
	
	
	    }, 0); // </setTimeout>
	
	
	    // Return the `io` object.
	    return io;
	  } //</SailsIOClient>
	
	  //
	  /////////////////////////////////////////////////////////////////////////////////
	  ///// </bunches of private function definitions, constructors, and methods>
	  /////////////////////////////////////////////////////////////////////////////////
	
	
	
	
	  //  ███████╗██╗  ██╗██████╗  ██████╗ ███████╗███████╗    ███████╗██████╗ ██╗  ██╗
	  //  ██╔════╝╚██╗██╔╝██╔══██╗██╔═══██╗██╔════╝██╔════╝    ██╔════╝██╔══██╗██║ ██╔╝
	  //  █████╗   ╚███╔╝ ██████╔╝██║   ██║███████╗█████╗      ███████╗██║  ██║█████╔╝
	  //  ██╔══╝   ██╔██╗ ██╔═══╝ ██║   ██║╚════██║██╔══╝      ╚════██║██║  ██║██╔═██╗
	  //  ███████╗██╔╝ ██╗██║     ╚██████╔╝███████║███████╗    ███████║██████╔╝██║  ██╗
	  //  ╚══════╝╚═╝  ╚═╝╚═╝      ╚═════╝ ╚══════╝╚══════╝    ╚══════╝╚═════╝ ╚═╝  ╚═╝
	  //
	
	
	  // Add CommonJS support to allow this client SDK to be used from Node.js.
	  if (SDK_INFO.platform === 'node') {
	    module.exports = SailsIOClient;
	  }
	  // Add AMD support, registering this client SDK as an anonymous module.
	  else if (true) {
	    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = function() {
	      return SailsIOClient;
	    }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	  }
	  else {
	    // Otherwise, try to instantiate the client using the global `io`:
	    SailsIOClient();
	
	    // Note:
	    // If you are modifying this file manually to wrap an existing socket.io client
	    // (e.g. to prevent pollution of the global namespace), you can replace the global
	    // `io` with your own `io` instance above.
	  }
	
	})();


/***/ },
/* 28 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <!-- Responsive sidebar menu -->\n  <div class=\"ui sidebar inverted vertical menu\">\n    <a class=\"item\" click.delegate=\"logout()\">\n      <h4 class=\"ui grey header\">${user.username}</h4>\n      <p>Sign Out</p>\n    </a>\n    <a repeat.for=\"row of router.navigation\" href.bind=\"row.href\"\n       class=\"item ${row.isActive ? 'active' : ''}\">\n      <i class=\"ui icon ${row.settings.icon}\"></i>${row.title}\n    </a>\n  </div>\n\n  <div class=\"pusher\">\n    <div class=\"ui active inverted dimmer\" if.bind=\"router.isNavigating\">\n      <div class=\"ui large text loader\">Loading</div>\n    </div>\n    <p></p>\n    <p></p>\n    <p></p>\n    <div class=\"ui container\">\n      <div class=\"ui left fixed vertical inverted menu\">\n        <a class=\"item\" click.delegate=\"logout()\">\n          <h4 class=\"ui grey header\">${user.username}</h4>\n          <p>Sign Out</p>\n        </a>\n        <a repeat.for=\"row of router.navigation\" href.bind=\"row.href\"\n           class=\"ui item ${row.isActive ? 'active' : ''}\">\n          <i class=\"ui icon ${row.settings.icon}\"></i>${row.title}\n        </a>\n      </div>\n      <div class=\"ui main grid\" id=\"mainView\">\n        <!-- Responsive top menu -->\n        <div class=\"ui fixed inverted main menu\">\n          <div class=\"ui container\">\n            <a class=\"launch icon item sidebar-toggle\">\n              <i class=\"sidebar icon\"></i>\n            </a>\n          </div>\n        </div>\n        <router-view class=\"sixteen wide column\"></router-view>\n      </div>\n    </div>\n  </div>\n</template>\n";

/***/ },
/* 29 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.CssAnimator = undefined;
	exports.configure = configure;
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _aureliaPal = __webpack_require__(4);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var CssAnimator = exports.CssAnimator = function () {
	  function CssAnimator() {
	    _classCallCheck(this, CssAnimator);
	
	    this.useAnimationDoneClasses = false;
	    this.animationEnteredClass = 'au-entered';
	    this.animationLeftClass = 'au-left';
	    this.isAnimating = false;
	
	    this.verifyKeyframesExist = true;
	  }
	
	  CssAnimator.prototype._addMultipleEventListener = function _addMultipleEventListener(el, s, fn) {
	    var evts = s.split(' ');
	    for (var i = 0, ii = evts.length; i < ii; ++i) {
	      el.addEventListener(evts[i], fn, false);
	    }
	  };
	
	  CssAnimator.prototype._getElementAnimationDelay = function _getElementAnimationDelay(element) {
	    var styl = _aureliaPal.DOM.getComputedStyle(element);
	    var prop = void 0;
	    var delay = void 0;
	
	    if (styl.getPropertyValue('animation-delay')) {
	      prop = 'animation-delay';
	    } else if (styl.getPropertyValue('-webkit-animation-delay')) {
	      prop = '-webkit-animation-delay';
	    } else if (styl.getPropertyValue('-moz-animation-delay')) {
	      prop = '-moz-animation-delay';
	    } else {
	      return 0;
	    }
	
	    delay = styl.getPropertyValue(prop);
	    delay = Number(delay.replace(/[^\d\.]/g, ''));
	
	    return delay * 1000;
	  };
	
	  CssAnimator.prototype._getElementAnimationNames = function _getElementAnimationNames(element) {
	    var styl = _aureliaPal.DOM.getComputedStyle(element);
	    var prefix = void 0;
	
	    if (styl.getPropertyValue('animation-name')) {
	      prefix = '';
	    } else if (styl.getPropertyValue('-webkit-animation-name')) {
	      prefix = '-webkit-';
	    } else if (styl.getPropertyValue('-moz-animation-name')) {
	      prefix = '-moz-';
	    } else {
	      return [];
	    }
	
	    var animationNames = styl.getPropertyValue(prefix + 'animation-name');
	    return animationNames ? animationNames.split(' ') : [];
	  };
	
	  CssAnimator.prototype._performSingleAnimate = function _performSingleAnimate(element, className) {
	    var _this = this;
	
	    this._triggerDOMEvent(_aureliaTemplating.animationEvent.animateBegin, element);
	
	    return this.addClass(element, className, true).then(function (result) {
	      _this._triggerDOMEvent(_aureliaTemplating.animationEvent.animateActive, element);
	
	      if (result !== false) {
	        return _this.removeClass(element, className, true).then(function () {
	          _this._triggerDOMEvent(_aureliaTemplating.animationEvent.animateDone, element);
	        });
	      }
	
	      return false;
	    }).catch(function () {
	      _this._triggerDOMEvent(_aureliaTemplating.animationEvent.animateTimeout, element);
	    });
	  };
	
	  CssAnimator.prototype._triggerDOMEvent = function _triggerDOMEvent(eventType, element) {
	    var evt = _aureliaPal.DOM.createCustomEvent(eventType, { bubbles: true, cancelable: true, detail: element });
	    _aureliaPal.DOM.dispatchEvent(evt);
	  };
	
	  CssAnimator.prototype._animationChangeWithValidKeyframe = function _animationChangeWithValidKeyframe(animationNames, prevAnimationNames) {
	    var newAnimationNames = animationNames.filter(function (name) {
	      return prevAnimationNames.indexOf(name) === -1;
	    });
	
	    if (newAnimationNames.length === 0) {
	      return false;
	    }
	
	    if (!this.verifyKeyframesExist) {
	      return true;
	    }
	
	    var keyframesRuleType = window.CSSRule.KEYFRAMES_RULE || window.CSSRule.MOZ_KEYFRAMES_RULE || window.CSSRule.WEBKIT_KEYFRAMES_RULE;
	
	    var styleSheets = document.styleSheets;
	
	    try {
	      for (var i = 0; i < styleSheets.length; ++i) {
	        var cssRules = styleSheets[i].cssRules;
	
	        if (!cssRules) {
	          continue;
	        }
	
	        for (var j = 0; j < cssRules.length; ++j) {
	          var cssRule = cssRules[j];
	
	          if (cssRule.type === keyframesRuleType) {
	            if (newAnimationNames.indexOf(cssRule.name) !== -1) {
	              return true;
	            }
	          }
	        }
	      }
	    } catch (e) {}
	
	    return false;
	  };
	
	  CssAnimator.prototype.animate = function animate(element, className) {
	    var _this2 = this;
	
	    if (Array.isArray(element)) {
	      return Promise.all(element.map(function (el) {
	        return _this2._performSingleAnimate(el, className);
	      }));
	    }
	
	    return this._performSingleAnimate(element, className);
	  };
	
	  CssAnimator.prototype.runSequence = function runSequence(animations) {
	    var _this3 = this;
	
	    this._triggerDOMEvent(_aureliaTemplating.animationEvent.sequenceBegin, null);
	
	    return animations.reduce(function (p, anim) {
	      return p.then(function () {
	        return _this3.animate(anim.element, anim.className);
	      });
	    }, Promise.resolve(true)).then(function () {
	      _this3._triggerDOMEvent(_aureliaTemplating.animationEvent.sequenceDone, null);
	    });
	  };
	
	  CssAnimator.prototype.enter = function enter(element) {
	    var _this4 = this;
	
	    return new Promise(function (resolve, reject) {
	      var classList = element.classList;
	
	      _this4._triggerDOMEvent(_aureliaTemplating.animationEvent.enterBegin, element);
	
	      if (_this4.useAnimationDoneClasses) {
	        classList.remove(_this4.animationEnteredClass);
	        classList.remove(_this4.animationLeftClass);
	      }
	
	      classList.add('au-enter');
	      var prevAnimationNames = _this4._getElementAnimationNames(element);
	
	      var _animStart = void 0;
	      var animHasStarted = false;
	      _this4._addMultipleEventListener(element, 'webkitAnimationStart animationstart', _animStart = function animStart(evAnimStart) {
	        animHasStarted = true;
	        _this4.isAnimating = true;
	
	        _this4._triggerDOMEvent(_aureliaTemplating.animationEvent.enterActive, element);
	
	        evAnimStart.stopPropagation();
	
	        evAnimStart.target.removeEventListener(evAnimStart.type, _animStart);
	      }, false);
	
	      var _animEnd = void 0;
	      _this4._addMultipleEventListener(element, 'webkitAnimationEnd animationend', _animEnd = function animEnd(evAnimEnd) {
	        if (!animHasStarted) {
	          return;
	        }
	
	        evAnimEnd.stopPropagation();
	
	        classList.remove('au-enter-active');
	        classList.remove('au-enter');
	
	        evAnimEnd.target.removeEventListener(evAnimEnd.type, _animEnd);
	
	        if (_this4.useAnimationDoneClasses && _this4.animationEnteredClass !== undefined && _this4.animationEnteredClass !== null) {
	          classList.add(_this4.animationEnteredClass);
	        }
	
	        _this4.isAnimating = false;
	        _this4._triggerDOMEvent(_aureliaTemplating.animationEvent.enterDone, element);
	
	        resolve(true);
	      }, false);
	
	      var parent = element.parentElement;
	      var delay = 0;
	
	      var cleanupAnimation = function cleanupAnimation() {
	        var animationNames = _this4._getElementAnimationNames(element);
	        if (!_this4._animationChangeWithValidKeyframe(animationNames, prevAnimationNames)) {
	          classList.remove('au-enter-active');
	          classList.remove('au-enter');
	          _this4._triggerDOMEvent(_aureliaTemplating.animationEvent.enterTimeout, element);
	          resolve(false);
	        }
	      };
	
	      if (parent !== null && parent !== undefined && (parent.classList.contains('au-stagger') || parent.classList.contains('au-stagger-enter'))) {
	        var elemPos = Array.prototype.indexOf.call(parent.children, element);
	        delay = _this4._getElementAnimationDelay(parent) * elemPos;
	
	        _this4._triggerDOMEvent(_aureliaTemplating.animationEvent.staggerNext, element);
	
	        setTimeout(function () {
	          classList.add('au-enter-active');
	          cleanupAnimation();
	        }, delay);
	      } else {
	        classList.add('au-enter-active');
	        cleanupAnimation();
	      }
	    });
	  };
	
	  CssAnimator.prototype.leave = function leave(element) {
	    var _this5 = this;
	
	    return new Promise(function (resolve, reject) {
	      var classList = element.classList;
	
	      _this5._triggerDOMEvent(_aureliaTemplating.animationEvent.leaveBegin, element);
	
	      if (_this5.useAnimationDoneClasses) {
	        classList.remove(_this5.animationEnteredClass);
	        classList.remove(_this5.animationLeftClass);
	      }
	
	      classList.add('au-leave');
	      var prevAnimationNames = _this5._getElementAnimationNames(element);
	
	      var _animStart2 = void 0;
	      var animHasStarted = false;
	      _this5._addMultipleEventListener(element, 'webkitAnimationStart animationstart', _animStart2 = function animStart(evAnimStart) {
	        animHasStarted = true;
	        _this5.isAnimating = true;
	
	        _this5._triggerDOMEvent(_aureliaTemplating.animationEvent.leaveActive, element);
	
	        evAnimStart.stopPropagation();
	
	        evAnimStart.target.removeEventListener(evAnimStart.type, _animStart2);
	      }, false);
	
	      var _animEnd2 = void 0;
	      _this5._addMultipleEventListener(element, 'webkitAnimationEnd animationend', _animEnd2 = function animEnd(evAnimEnd) {
	        if (!animHasStarted) {
	          return;
	        }
	
	        evAnimEnd.stopPropagation();
	
	        classList.remove('au-leave-active');
	        classList.remove('au-leave');
	
	        evAnimEnd.target.removeEventListener(evAnimEnd.type, _animEnd2);
	
	        if (_this5.useAnimationDoneClasses && _this5.animationLeftClass !== undefined && _this5.animationLeftClass !== null) {
	          classList.add(_this5.animationLeftClass);
	        }
	
	        _this5.isAnimating = false;
	        _this5._triggerDOMEvent(_aureliaTemplating.animationEvent.leaveDone, element);
	
	        resolve(true);
	      }, false);
	
	      var parent = element.parentElement;
	      var delay = 0;
	
	      var cleanupAnimation = function cleanupAnimation() {
	        var animationNames = _this5._getElementAnimationNames(element);
	        if (!_this5._animationChangeWithValidKeyframe(animationNames, prevAnimationNames)) {
	          classList.remove('au-leave-active');
	          classList.remove('au-leave');
	          _this5._triggerDOMEvent(_aureliaTemplating.animationEvent.leaveTimeout, element);
	          resolve(false);
	        }
	      };
	
	      if (parent !== null && parent !== undefined && (parent.classList.contains('au-stagger') || parent.classList.contains('au-stagger-leave'))) {
	        var elemPos = Array.prototype.indexOf.call(parent.children, element);
	        delay = _this5._getElementAnimationDelay(parent) * elemPos;
	
	        _this5._triggerDOMEvent(_aureliaTemplating.animationEvent.staggerNext, element);
	
	        setTimeout(function () {
	          classList.add('au-leave-active');
	          cleanupAnimation();
	        }, delay);
	      } else {
	        classList.add('au-leave-active');
	        cleanupAnimation();
	      }
	    });
	  };
	
	  CssAnimator.prototype.removeClass = function removeClass(element, className) {
	    var _this6 = this;
	
	    var suppressEvents = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];
	
	    return new Promise(function (resolve, reject) {
	      var classList = element.classList;
	
	      if (!classList.contains(className) && !classList.contains(className + '-add')) {
	        resolve(false);
	        return;
	      }
	
	      if (suppressEvents !== true) {
	        _this6._triggerDOMEvent(_aureliaTemplating.animationEvent.removeClassBegin, element);
	      }
	
	      classList.remove(className);
	      var prevAnimationNames = _this6._getElementAnimationNames(element);
	
	      var _animStart3 = void 0;
	      var animHasStarted = false;
	      _this6._addMultipleEventListener(element, 'webkitAnimationStart animationstart', _animStart3 = function animStart(evAnimStart) {
	        animHasStarted = true;
	        _this6.isAnimating = true;
	
	        if (suppressEvents !== true) {
	          _this6._triggerDOMEvent(_aureliaTemplating.animationEvent.removeClassActive, element);
	        }
	
	        evAnimStart.stopPropagation();
	
	        evAnimStart.target.removeEventListener(evAnimStart.type, _animStart3);
	      }, false);
	
	      var _animEnd3 = void 0;
	      _this6._addMultipleEventListener(element, 'webkitAnimationEnd animationend', _animEnd3 = function animEnd(evAnimEnd) {
	        if (!animHasStarted) {
	          return;
	        }
	
	        evAnimEnd.stopPropagation();
	
	        classList.remove(className + '-remove');
	
	        evAnimEnd.target.removeEventListener(evAnimEnd.type, _animEnd3);
	
	        _this6.isAnimating = false;
	
	        if (suppressEvents !== true) {
	          _this6._triggerDOMEvent(_aureliaTemplating.animationEvent.removeClassDone, element);
	        }
	
	        resolve(true);
	      }, false);
	
	      classList.add(className + '-remove');
	
	      var animationNames = _this6._getElementAnimationNames(element);
	      if (!_this6._animationChangeWithValidKeyframe(animationNames, prevAnimationNames)) {
	        classList.remove(className + '-remove');
	        classList.remove(className);
	
	        if (suppressEvents !== true) {
	          _this6._triggerDOMEvent(_aureliaTemplating.animationEvent.removeClassTimeout, element);
	        }
	
	        resolve(false);
	      }
	    });
	  };
	
	  CssAnimator.prototype.addClass = function addClass(element, className) {
	    var _this7 = this;
	
	    var suppressEvents = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];
	
	    return new Promise(function (resolve, reject) {
	      var classList = element.classList;
	
	      if (suppressEvents !== true) {
	        _this7._triggerDOMEvent(_aureliaTemplating.animationEvent.addClassBegin, element);
	      }
	
	      var _animStart4 = void 0;
	      var animHasStarted = false;
	      _this7._addMultipleEventListener(element, 'webkitAnimationStart animationstart', _animStart4 = function animStart(evAnimStart) {
	        animHasStarted = true;
	        _this7.isAnimating = true;
	
	        if (suppressEvents !== true) {
	          _this7._triggerDOMEvent(_aureliaTemplating.animationEvent.addClassActive, element);
	        }
	
	        evAnimStart.stopPropagation();
	
	        evAnimStart.target.removeEventListener(evAnimStart.type, _animStart4);
	      }, false);
	
	      var _animEnd4 = void 0;
	      _this7._addMultipleEventListener(element, 'webkitAnimationEnd animationend', _animEnd4 = function animEnd(evAnimEnd) {
	        if (!animHasStarted) {
	          return;
	        }
	
	        evAnimEnd.stopPropagation();
	
	        classList.add(className);
	
	        classList.remove(className + '-add');
	
	        evAnimEnd.target.removeEventListener(evAnimEnd.type, _animEnd4);
	
	        _this7.isAnimating = false;
	
	        if (suppressEvents !== true) {
	          _this7._triggerDOMEvent(_aureliaTemplating.animationEvent.addClassDone, element);
	        }
	
	        resolve(true);
	      }, false);
	
	      var prevAnimationNames = _this7._getElementAnimationNames(element);
	
	      classList.add(className + '-add');
	
	      var animationNames = _this7._getElementAnimationNames(element);
	      if (!_this7._animationChangeWithValidKeyframe(animationNames, prevAnimationNames)) {
	        classList.remove(className + '-add');
	        classList.add(className);
	
	        if (suppressEvents !== true) {
	          _this7._triggerDOMEvent(_aureliaTemplating.animationEvent.addClassTimeout, element);
	        }
	
	        resolve(false);
	      }
	    });
	  };
	
	  return CssAnimator;
	}();
	
	function configure(config, callback) {
	  var animator = config.container.get(CssAnimator);
	  config.container.get(_aureliaTemplating.TemplatingEngine).configureAnimator(animator);
	  if (typeof callback === 'function') {
	    callback(animator);
	  }
	}

/***/ },
/* 30 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.BrowserHistory = exports.DefaultLinkHandler = exports.LinkHandler = undefined;
	
	var _class, _temp;
	
	exports.configure = configure;
	
	var _aureliaPal = __webpack_require__(4);
	
	var _aureliaHistory = __webpack_require__(31);
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var LinkHandler = exports.LinkHandler = function () {
	  function LinkHandler() {
	    _classCallCheck(this, LinkHandler);
	  }
	
	  LinkHandler.prototype.activate = function activate(history) {};
	
	  LinkHandler.prototype.deactivate = function deactivate() {};
	
	  return LinkHandler;
	}();
	
	var DefaultLinkHandler = exports.DefaultLinkHandler = function (_LinkHandler) {
	  _inherits(DefaultLinkHandler, _LinkHandler);
	
	  function DefaultLinkHandler() {
	    _classCallCheck(this, DefaultLinkHandler);
	
	    var _this = _possibleConstructorReturn(this, _LinkHandler.call(this));
	
	    _this.handler = function (e) {
	      var _DefaultLinkHandler$g = DefaultLinkHandler.getEventInfo(e);
	
	      var shouldHandleEvent = _DefaultLinkHandler$g.shouldHandleEvent;
	      var href = _DefaultLinkHandler$g.href;
	
	
	      if (shouldHandleEvent) {
	        e.preventDefault();
	        _this.history.navigate(href);
	      }
	    };
	    return _this;
	  }
	
	  DefaultLinkHandler.prototype.activate = function activate(history) {
	    if (history._hasPushState) {
	      this.history = history;
	      _aureliaPal.DOM.addEventListener('click', this.handler, true);
	    }
	  };
	
	  DefaultLinkHandler.prototype.deactivate = function deactivate() {
	    _aureliaPal.DOM.removeEventListener('click', this.handler);
	  };
	
	  DefaultLinkHandler.getEventInfo = function getEventInfo(event) {
	    var info = {
	      shouldHandleEvent: false,
	      href: null,
	      anchor: null
	    };
	
	    var target = DefaultLinkHandler.findClosestAnchor(event.target);
	    if (!target || !DefaultLinkHandler.targetIsThisWindow(target)) {
	      return info;
	    }
	
	    if (event.altKey || event.ctrlKey || event.metaKey || event.shiftKey) {
	      return info;
	    }
	
	    var href = target.getAttribute('href');
	    info.anchor = target;
	    info.href = href;
	
	    var leftButtonClicked = event.which === 1;
	    var isRelative = href && !(href.charAt(0) === '#' || /^[a-z]+:/i.test(href));
	
	    info.shouldHandleEvent = leftButtonClicked && isRelative;
	    return info;
	  };
	
	  DefaultLinkHandler.findClosestAnchor = function findClosestAnchor(el) {
	    while (el) {
	      if (el.tagName === 'A') {
	        return el;
	      }
	
	      el = el.parentNode;
	    }
	  };
	
	  DefaultLinkHandler.targetIsThisWindow = function targetIsThisWindow(target) {
	    var targetWindow = target.getAttribute('target');
	    var win = _aureliaPal.PLATFORM.global;
	
	    return !targetWindow || targetWindow === win.name || targetWindow === '_self' || targetWindow === 'top' && win === win.top;
	  };
	
	  return DefaultLinkHandler;
	}(LinkHandler);
	
	function configure(config) {
	  config.singleton(_aureliaHistory.History, BrowserHistory);
	  config.transient(LinkHandler, DefaultLinkHandler);
	}
	
	var BrowserHistory = exports.BrowserHistory = (_temp = _class = function (_History) {
	  _inherits(BrowserHistory, _History);
	
	  function BrowserHistory(linkHandler) {
	    _classCallCheck(this, BrowserHistory);
	
	    var _this2 = _possibleConstructorReturn(this, _History.call(this));
	
	    _this2._isActive = false;
	    _this2._checkUrlCallback = _this2._checkUrl.bind(_this2);
	
	    _this2.location = _aureliaPal.PLATFORM.location;
	    _this2.history = _aureliaPal.PLATFORM.history;
	    _this2.linkHandler = linkHandler;
	    return _this2;
	  }
	
	  BrowserHistory.prototype.activate = function activate(options) {
	    if (this._isActive) {
	      throw new Error('History has already been activated.');
	    }
	
	    var wantsPushState = !!options.pushState;
	
	    this._isActive = true;
	    this.options = Object.assign({}, { root: '/' }, this.options, options);
	
	    this.root = ('/' + this.options.root + '/').replace(rootStripper, '/');
	
	    this._wantsHashChange = this.options.hashChange !== false;
	    this._hasPushState = !!(this.options.pushState && this.history && this.history.pushState);
	
	    var eventName = void 0;
	    if (this._hasPushState) {
	      eventName = 'popstate';
	    } else if (this._wantsHashChange) {
	      eventName = 'hashchange';
	    }
	
	    _aureliaPal.PLATFORM.addEventListener(eventName, this._checkUrlCallback);
	
	    if (this._wantsHashChange && wantsPushState) {
	      var loc = this.location;
	      var atRoot = loc.pathname.replace(/[^\/]$/, '$&/') === this.root;
	
	      if (!this._hasPushState && !atRoot) {
	        this.fragment = this._getFragment(null, true);
	        this.location.replace(this.root + this.location.search + '#' + this.fragment);
	
	        return true;
	      } else if (this._hasPushState && atRoot && loc.hash) {
	          this.fragment = this._getHash().replace(routeStripper, '');
	          this.history.replaceState({}, _aureliaPal.DOM.title, this.root + this.fragment + loc.search);
	        }
	    }
	
	    if (!this.fragment) {
	      this.fragment = this._getFragment();
	    }
	
	    this.linkHandler.activate(this);
	
	    if (!this.options.silent) {
	      return this._loadUrl();
	    }
	  };
	
	  BrowserHistory.prototype.deactivate = function deactivate() {
	    _aureliaPal.PLATFORM.removeEventListener('popstate', this._checkUrlCallback);
	    _aureliaPal.PLATFORM.removeEventListener('hashchange', this._checkUrlCallback);
	    this._isActive = false;
	    this.linkHandler.deactivate();
	  };
	
	  BrowserHistory.prototype.getAbsoluteRoot = function getAbsoluteRoot() {
	    var origin = createOrigin(this.location.protocol, this.location.hostname, this.location.port);
	    return '' + origin + this.root;
	  };
	
	  BrowserHistory.prototype.navigate = function navigate(fragment) {
	    var _ref = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];
	
	    var _ref$trigger = _ref.trigger;
	    var trigger = _ref$trigger === undefined ? true : _ref$trigger;
	    var _ref$replace = _ref.replace;
	    var replace = _ref$replace === undefined ? false : _ref$replace;
	
	    if (fragment && absoluteUrl.test(fragment)) {
	      this.location.href = fragment;
	      return true;
	    }
	
	    if (!this._isActive) {
	      return false;
	    }
	
	    fragment = this._getFragment(fragment || '');
	
	    if (this.fragment === fragment && !replace) {
	      return false;
	    }
	
	    this.fragment = fragment;
	
	    var url = this.root + fragment;
	
	    if (fragment === '' && url !== '/') {
	      url = url.slice(0, -1);
	    }
	
	    if (this._hasPushState) {
	      url = url.replace('//', '/');
	      this.history[replace ? 'replaceState' : 'pushState']({}, _aureliaPal.DOM.title, url);
	    } else if (this._wantsHashChange) {
	      updateHash(this.location, fragment, replace);
	    } else {
	      return this.location.assign(url);
	    }
	
	    if (trigger) {
	      return this._loadUrl(fragment);
	    }
	  };
	
	  BrowserHistory.prototype.navigateBack = function navigateBack() {
	    this.history.back();
	  };
	
	  BrowserHistory.prototype.setTitle = function setTitle(title) {
	    _aureliaPal.DOM.title = title;
	  };
	
	  BrowserHistory.prototype._getHash = function _getHash() {
	    return this.location.hash.substr(1);
	  };
	
	  BrowserHistory.prototype._getFragment = function _getFragment(fragment, forcePushState) {
	    var root = void 0;
	
	    if (!fragment) {
	      if (this._hasPushState || !this._wantsHashChange || forcePushState) {
	        fragment = this.location.pathname + this.location.search;
	        root = this.root.replace(trailingSlash, '');
	        if (!fragment.indexOf(root)) {
	          fragment = fragment.substr(root.length);
	        }
	      } else {
	        fragment = this._getHash();
	      }
	    }
	
	    return '/' + fragment.replace(routeStripper, '');
	  };
	
	  BrowserHistory.prototype._checkUrl = function _checkUrl() {
	    var current = this._getFragment();
	    if (current !== this.fragment) {
	      this._loadUrl();
	    }
	  };
	
	  BrowserHistory.prototype._loadUrl = function _loadUrl(fragmentOverride) {
	    var fragment = this.fragment = this._getFragment(fragmentOverride);
	
	    return this.options.routeHandler ? this.options.routeHandler(fragment) : false;
	  };
	
	  return BrowserHistory;
	}(_aureliaHistory.History), _class.inject = [LinkHandler], _temp);
	
	var routeStripper = /^#?\/*|\s+$/g;
	
	var rootStripper = /^\/+|\/+$/g;
	
	var trailingSlash = /\/$/;
	
	var absoluteUrl = /^([a-z][a-z0-9+\-.]*:)?\/\//i;
	
	function updateHash(location, fragment, replace) {
	  if (replace) {
	    var _href = location.href.replace(/(javascript:|#).*$/, '');
	    location.replace(_href + '#' + fragment);
	  } else {
	    location.hash = '#' + fragment;
	  }
	}
	
	function createOrigin(protocol, hostname, port) {
	  return protocol + '//' + hostname + (port ? ':' + port : '');
	}

/***/ },
/* 31 */
/***/ function(module, exports) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function mi(name) {
	  throw new Error('History must implement ' + name + '().');
	}
	
	var History = exports.History = function () {
	  function History() {
	    _classCallCheck(this, History);
	  }
	
	  History.prototype.activate = function activate(options) {
	    mi('activate');
	  };
	
	  History.prototype.deactivate = function deactivate() {
	    mi('deactivate');
	  };
	
	  History.prototype.getAbsoluteRoot = function getAbsoluteRoot() {
	    mi('getAbsoluteRoot');
	  };
	
	  History.prototype.navigate = function navigate(fragment, options) {
	    mi('navigate');
	  };
	
	  History.prototype.navigateBack = function navigateBack() {
	    mi('navigateBack');
	  };
	
	  History.prototype.setTitle = function setTitle(title) {
	    mi('setTitle');
	  };
	
	  return History;
	}();

/***/ },
/* 32 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.ConsoleAppender = undefined;
	
	var _aureliaLogging = __webpack_require__(14);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var ConsoleAppender = exports.ConsoleAppender = function () {
	  function ConsoleAppender() {
	    _classCallCheck(this, ConsoleAppender);
	  }
	
	  ConsoleAppender.prototype.debug = function debug(logger) {
	    var _console;
	
	    for (var _len = arguments.length, rest = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
	      rest[_key - 1] = arguments[_key];
	    }
	
	    (_console = console).debug.apply(_console, ['DEBUG [' + logger.id + ']'].concat(rest));
	  };
	
	  ConsoleAppender.prototype.info = function info(logger) {
	    var _console2;
	
	    for (var _len2 = arguments.length, rest = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
	      rest[_key2 - 1] = arguments[_key2];
	    }
	
	    (_console2 = console).info.apply(_console2, ['INFO [' + logger.id + ']'].concat(rest));
	  };
	
	  ConsoleAppender.prototype.warn = function warn(logger) {
	    var _console3;
	
	    for (var _len3 = arguments.length, rest = Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {
	      rest[_key3 - 1] = arguments[_key3];
	    }
	
	    (_console3 = console).warn.apply(_console3, ['WARN [' + logger.id + ']'].concat(rest));
	  };
	
	  ConsoleAppender.prototype.error = function error(logger) {
	    var _console4;
	
	    for (var _len4 = arguments.length, rest = Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {
	      rest[_key4 - 1] = arguments[_key4];
	    }
	
	    (_console4 = console).error.apply(_console4, ['ERROR [' + logger.id + ']'].concat(rest));
	  };
	
	  return ConsoleAppender;
	}();

/***/ },
/* 33 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.AppRouter = exports.PipelineProvider = exports.LoadRouteStep = exports.RouteLoader = exports.ActivateNextStep = exports.DeactivatePreviousStep = exports.CanActivateNextStep = exports.CanDeactivatePreviousStep = exports.Router = exports.BuildNavigationPlanStep = exports.activationStrategy = exports.RouterConfiguration = exports.RedirectToRoute = exports.Redirect = exports.NavModel = exports.NavigationInstruction = exports.CommitChangesStep = exports.Pipeline = exports.pipelineStatus = undefined;
	
	var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol ? "symbol" : typeof obj; };
	
	var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();
	
	exports._normalizeAbsolutePath = _normalizeAbsolutePath;
	exports._createRootedPath = _createRootedPath;
	exports._resolveUrl = _resolveUrl;
	exports.isNavigationCommand = isNavigationCommand;
	exports._buildNavigationPlan = _buildNavigationPlan;
	
	var _aureliaLogging = __webpack_require__(14);
	
	var LogManager = _interopRequireWildcard(_aureliaLogging);
	
	var _aureliaRouteRecognizer = __webpack_require__(34);
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	var _aureliaHistory = __webpack_require__(31);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _normalizeAbsolutePath(path, hasPushState) {
	  var absolute = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];
	
	  if (!hasPushState && path[0] !== '#') {
	    path = '#' + path;
	  }
	
	  if (hasPushState && absolute) {
	    path = path.substring(1, path.length);
	  }
	
	  return path;
	}
	
	function _createRootedPath(fragment, baseUrl, hasPushState, absolute) {
	  if (isAbsoluteUrl.test(fragment)) {
	    return fragment;
	  }
	
	  var path = '';
	
	  if (baseUrl.length && baseUrl[0] !== '/') {
	    path += '/';
	  }
	
	  path += baseUrl;
	
	  if ((!path.length || path[path.length - 1] !== '/') && fragment[0] !== '/') {
	    path += '/';
	  }
	
	  if (path.length && path[path.length - 1] === '/' && fragment[0] === '/') {
	    path = path.substring(0, path.length - 1);
	  }
	
	  return _normalizeAbsolutePath(path + fragment, hasPushState, absolute);
	}
	
	function _resolveUrl(fragment, baseUrl, hasPushState) {
	  if (isRootedPath.test(fragment)) {
	    return _normalizeAbsolutePath(fragment, hasPushState);
	  }
	
	  return _createRootedPath(fragment, baseUrl, hasPushState);
	}
	
	var isRootedPath = /^#?\//;
	var isAbsoluteUrl = /^([a-z][a-z0-9+\-.]*:)?\/\//i;
	
	var pipelineStatus = exports.pipelineStatus = {
	  completed: 'completed',
	  canceled: 'canceled',
	  rejected: 'rejected',
	  running: 'running'
	};
	
	var Pipeline = exports.Pipeline = function () {
	  function Pipeline() {
	    _classCallCheck(this, Pipeline);
	
	    this.steps = [];
	  }
	
	  Pipeline.prototype.addStep = function addStep(step) {
	    var run = void 0;
	
	    if (typeof step === 'function') {
	      run = step;
	    } else if (typeof step.getSteps === 'function') {
	      var steps = step.getSteps();
	      for (var i = 0, l = steps.length; i < l; i++) {
	        this.addStep(steps[i]);
	      }
	
	      return this;
	    } else {
	      run = step.run.bind(step);
	    }
	
	    this.steps.push(run);
	
	    return this;
	  };
	
	  Pipeline.prototype.run = function run(instruction) {
	    var index = -1;
	    var steps = this.steps;
	
	    function next() {
	      index++;
	
	      if (index < steps.length) {
	        var currentStep = steps[index];
	
	        try {
	          return currentStep(instruction, next);
	        } catch (e) {
	          return next.reject(e);
	        }
	      } else {
	        return next.complete();
	      }
	    }
	
	    next.complete = createCompletionHandler(next, pipelineStatus.completed);
	    next.cancel = createCompletionHandler(next, pipelineStatus.canceled);
	    next.reject = createCompletionHandler(next, pipelineStatus.rejected);
	
	    return next();
	  };
	
	  return Pipeline;
	}();
	
	function createCompletionHandler(next, status) {
	  return function (output) {
	    return Promise.resolve({ status: status, output: output, completed: status === pipelineStatus.completed });
	  };
	}
	
	var CommitChangesStep = exports.CommitChangesStep = function () {
	  function CommitChangesStep() {
	    _classCallCheck(this, CommitChangesStep);
	  }
	
	  CommitChangesStep.prototype.run = function run(navigationInstruction, next) {
	    return navigationInstruction._commitChanges(true).then(function () {
	      navigationInstruction._updateTitle();
	      return next();
	    });
	  };
	
	  return CommitChangesStep;
	}();
	
	var NavigationInstruction = exports.NavigationInstruction = function () {
	  function NavigationInstruction(init) {
	    _classCallCheck(this, NavigationInstruction);
	
	    this.plan = null;
	    this.options = {};
	
	    Object.assign(this, init);
	
	    this.params = this.params || {};
	    this.viewPortInstructions = {};
	
	    var ancestorParams = [];
	    var current = this;
	    do {
	      var currentParams = Object.assign({}, current.params);
	      if (current.config && current.config.hasChildRouter) {
	        delete currentParams[current.getWildCardName()];
	      }
	
	      ancestorParams.unshift(currentParams);
	      current = current.parentInstruction;
	    } while (current);
	
	    var allParams = Object.assign.apply(Object, [{}, this.queryParams].concat(ancestorParams));
	    this.lifecycleArgs = [allParams, this.config, this];
	  }
	
	  NavigationInstruction.prototype.getAllInstructions = function getAllInstructions() {
	    var instructions = [this];
	    for (var key in this.viewPortInstructions) {
	      var childInstruction = this.viewPortInstructions[key].childNavigationInstruction;
	      if (childInstruction) {
	        instructions.push.apply(instructions, childInstruction.getAllInstructions());
	      }
	    }
	
	    return instructions;
	  };
	
	  NavigationInstruction.prototype.getAllPreviousInstructions = function getAllPreviousInstructions() {
	    return this.getAllInstructions().map(function (c) {
	      return c.previousInstruction;
	    }).filter(function (c) {
	      return c;
	    });
	  };
	
	  NavigationInstruction.prototype.addViewPortInstruction = function addViewPortInstruction(viewPortName, strategy, moduleId, component) {
	    var viewportInstruction = this.viewPortInstructions[viewPortName] = {
	      name: viewPortName,
	      strategy: strategy,
	      moduleId: moduleId,
	      component: component,
	      childRouter: component.childRouter,
	      lifecycleArgs: this.lifecycleArgs.slice()
	    };
	
	    return viewportInstruction;
	  };
	
	  NavigationInstruction.prototype.getWildCardName = function getWildCardName() {
	    var wildcardIndex = this.config.route.lastIndexOf('*');
	    return this.config.route.substr(wildcardIndex + 1);
	  };
	
	  NavigationInstruction.prototype.getWildcardPath = function getWildcardPath() {
	    var wildcardName = this.getWildCardName();
	    var path = this.params[wildcardName] || '';
	
	    if (this.queryString) {
	      path += '?' + this.queryString;
	    }
	
	    return path;
	  };
	
	  NavigationInstruction.prototype.getBaseUrl = function getBaseUrl() {
	    if (!this.params) {
	      return this.fragment;
	    }
	
	    var wildcardName = this.getWildCardName();
	    var path = this.params[wildcardName] || '';
	
	    if (!path) {
	      return this.fragment;
	    }
	
	    return this.fragment.substr(0, this.fragment.lastIndexOf(path));
	  };
	
	  NavigationInstruction.prototype._commitChanges = function _commitChanges(waitToSwap) {
	    var _this = this;
	
	    var router = this.router;
	    router.currentInstruction = this;
	
	    if (this.previousInstruction) {
	      this.previousInstruction.config.navModel.isActive = false;
	    }
	
	    this.config.navModel.isActive = true;
	
	    router._refreshBaseUrl();
	    router.refreshNavigation();
	
	    var loads = [];
	    var delaySwaps = [];
	
	    var _loop = function _loop(viewPortName) {
	      var viewPortInstruction = _this.viewPortInstructions[viewPortName];
	      var viewPort = router.viewPorts[viewPortName];
	
	      if (!viewPort) {
	        throw new Error('There was no router-view found in the view for ' + viewPortInstruction.moduleId + '.');
	      }
	
	      if (viewPortInstruction.strategy === activationStrategy.replace) {
	        if (waitToSwap) {
	          delaySwaps.push({ viewPort: viewPort, viewPortInstruction: viewPortInstruction });
	        }
	
	        loads.push(viewPort.process(viewPortInstruction, waitToSwap).then(function (x) {
	          if (viewPortInstruction.childNavigationInstruction) {
	            return viewPortInstruction.childNavigationInstruction._commitChanges();
	          }
	        }));
	      } else {
	        if (viewPortInstruction.childNavigationInstruction) {
	          loads.push(viewPortInstruction.childNavigationInstruction._commitChanges(waitToSwap));
	        }
	      }
	    };
	
	    for (var viewPortName in this.viewPortInstructions) {
	      _loop(viewPortName);
	    }
	
	    return Promise.all(loads).then(function () {
	      delaySwaps.forEach(function (x) {
	        return x.viewPort.swap(x.viewPortInstruction);
	      });
	      return null;
	    }).then(function () {
	      return prune(_this);
	    });
	  };
	
	  NavigationInstruction.prototype._updateTitle = function _updateTitle() {
	    var title = this._buildTitle();
	    if (title) {
	      this.router.history.setTitle(title);
	    }
	  };
	
	  NavigationInstruction.prototype._buildTitle = function _buildTitle() {
	    var separator = arguments.length <= 0 || arguments[0] === undefined ? ' | ' : arguments[0];
	
	    var title = this.config.navModel.title || '';
	    var childTitles = [];
	
	    for (var viewPortName in this.viewPortInstructions) {
	      var _viewPortInstruction = this.viewPortInstructions[viewPortName];
	
	      if (_viewPortInstruction.childNavigationInstruction) {
	        var childTitle = _viewPortInstruction.childNavigationInstruction._buildTitle(separator);
	        if (childTitle) {
	          childTitles.push(childTitle);
	        }
	      }
	    }
	
	    if (childTitles.length) {
	      title = childTitles.join(separator) + (title ? separator : '') + title;
	    }
	
	    if (this.router.title) {
	      title += (title ? separator : '') + this.router.title;
	    }
	
	    return title;
	  };
	
	  return NavigationInstruction;
	}();
	
	function prune(instruction) {
	  instruction.previousInstruction = null;
	  instruction.plan = null;
	}
	
	var NavModel = exports.NavModel = function () {
	  function NavModel(router, relativeHref) {
	    _classCallCheck(this, NavModel);
	
	    this.isActive = false;
	    this.title = null;
	    this.href = null;
	    this.relativeHref = null;
	    this.settings = {};
	    this.config = null;
	
	    this.router = router;
	    this.relativeHref = relativeHref;
	  }
	
	  NavModel.prototype.setTitle = function setTitle(title) {
	    this.title = title;
	
	    if (this.isActive) {
	      this.router.updateTitle();
	    }
	  };
	
	  return NavModel;
	}();
	
	function isNavigationCommand(obj) {
	  return obj && typeof obj.navigate === 'function';
	}
	
	var Redirect = exports.Redirect = function () {
	  function Redirect(url) {
	    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];
	
	    _classCallCheck(this, Redirect);
	
	    this.url = url;
	    this.options = Object.assign({ trigger: true, replace: true }, options);
	    this.shouldContinueProcessing = false;
	  }
	
	  Redirect.prototype.setRouter = function setRouter(router) {
	    this.router = router;
	  };
	
	  Redirect.prototype.navigate = function navigate(appRouter) {
	    var navigatingRouter = this.options.useAppRouter ? appRouter : this.router || appRouter;
	    navigatingRouter.navigate(this.url, this.options);
	  };
	
	  return Redirect;
	}();
	
	var RedirectToRoute = exports.RedirectToRoute = function () {
	  function RedirectToRoute(route) {
	    var params = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];
	    var options = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];
	
	    _classCallCheck(this, RedirectToRoute);
	
	    this.route = route;
	    this.params = params;
	    this.options = Object.assign({ trigger: true, replace: true }, options);
	    this.shouldContinueProcessing = false;
	  }
	
	  RedirectToRoute.prototype.setRouter = function setRouter(router) {
	    this.router = router;
	  };
	
	  RedirectToRoute.prototype.navigate = function navigate(appRouter) {
	    var navigatingRouter = this.options.useAppRouter ? appRouter : this.router || appRouter;
	    navigatingRouter.navigateToRoute(this.route, this.params, this.options);
	  };
	
	  return RedirectToRoute;
	}();
	
	var RouterConfiguration = exports.RouterConfiguration = function () {
	  function RouterConfiguration() {
	    _classCallCheck(this, RouterConfiguration);
	
	    this.instructions = [];
	    this.options = {};
	    this.pipelineSteps = [];
	  }
	
	  RouterConfiguration.prototype.addPipelineStep = function addPipelineStep(name, step) {
	    this.pipelineSteps.push({ name: name, step: step });
	    return this;
	  };
	
	  RouterConfiguration.prototype.addAuthorizeStep = function addAuthorizeStep(step) {
	    return this.addPipelineStep('authorize', step);
	  };
	
	  RouterConfiguration.prototype.addPreActivateStep = function addPreActivateStep(step) {
	    return this.addPipelineStep('preActivate', step);
	  };
	
	  RouterConfiguration.prototype.addPreRenderStep = function addPreRenderStep(step) {
	    return this.addPipelineStep('preRender', step);
	  };
	
	  RouterConfiguration.prototype.addPostRenderStep = function addPostRenderStep(step) {
	    return this.addPipelineStep('postRender', step);
	  };
	
	  RouterConfiguration.prototype.map = function map(route) {
	    if (Array.isArray(route)) {
	      route.forEach(this.map.bind(this));
	      return this;
	    }
	
	    return this.mapRoute(route);
	  };
	
	  RouterConfiguration.prototype.mapRoute = function mapRoute(config) {
	    this.instructions.push(function (router) {
	      var routeConfigs = [];
	
	      if (Array.isArray(config.route)) {
	        for (var i = 0, ii = config.route.length; i < ii; ++i) {
	          var _current = Object.assign({}, config);
	          _current.route = config.route[i];
	          routeConfigs.push(_current);
	        }
	      } else {
	        routeConfigs.push(Object.assign({}, config));
	      }
	
	      var navModel = void 0;
	      for (var _i = 0, _ii = routeConfigs.length; _i < _ii; ++_i) {
	        var routeConfig = routeConfigs[_i];
	        routeConfig.settings = routeConfig.settings || {};
	        if (!navModel) {
	          navModel = router.createNavModel(routeConfig);
	        }
	
	        router.addRoute(routeConfig, navModel);
	      }
	    });
	
	    return this;
	  };
	
	  RouterConfiguration.prototype.mapUnknownRoutes = function mapUnknownRoutes(config) {
	    this.unknownRouteConfig = config;
	    return this;
	  };
	
	  RouterConfiguration.prototype.exportToRouter = function exportToRouter(router) {
	    var instructions = this.instructions;
	    for (var i = 0, ii = instructions.length; i < ii; ++i) {
	      instructions[i](router);
	    }
	
	    if (this.title) {
	      router.title = this.title;
	    }
	
	    if (this.unknownRouteConfig) {
	      router.handleUnknownRoutes(this.unknownRouteConfig);
	    }
	
	    router.options = this.options;
	
	    var pipelineSteps = this.pipelineSteps;
	    if (pipelineSteps.length) {
	      if (!router.isRoot) {
	        throw new Error('Pipeline steps can only be added to the root router');
	      }
	
	      var pipelineProvider = router.pipelineProvider;
	      for (var _i2 = 0, _ii2 = pipelineSteps.length; _i2 < _ii2; ++_i2) {
	        var _pipelineSteps$_i = pipelineSteps[_i2];
	        var _name = _pipelineSteps$_i.name;
	        var step = _pipelineSteps$_i.step;
	
	        pipelineProvider.addStep(_name, step);
	      }
	    }
	  };
	
	  return RouterConfiguration;
	}();
	
	var activationStrategy = exports.activationStrategy = {
	  noChange: 'no-change',
	  invokeLifecycle: 'invoke-lifecycle',
	  replace: 'replace'
	};
	
	var BuildNavigationPlanStep = exports.BuildNavigationPlanStep = function () {
	  function BuildNavigationPlanStep() {
	    _classCallCheck(this, BuildNavigationPlanStep);
	  }
	
	  BuildNavigationPlanStep.prototype.run = function run(navigationInstruction, next) {
	    return _buildNavigationPlan(navigationInstruction).then(function (plan) {
	      navigationInstruction.plan = plan;
	      return next();
	    }).catch(next.cancel);
	  };
	
	  return BuildNavigationPlanStep;
	}();
	
	function _buildNavigationPlan(instruction, forceLifecycleMinimum) {
	  var prev = instruction.previousInstruction;
	  var config = instruction.config;
	  var plan = {};
	
	  if ('redirect' in config) {
	    var redirectLocation = _resolveUrl(config.redirect, getInstructionBaseUrl(instruction));
	    if (instruction.queryString) {
	      redirectLocation += '?' + instruction.queryString;
	    }
	
	    return Promise.reject(new Redirect(redirectLocation));
	  }
	
	  if (prev) {
	    var newParams = hasDifferentParameterValues(prev, instruction);
	    var pending = [];
	
	    var _loop2 = function _loop2(viewPortName) {
	      var prevViewPortInstruction = prev.viewPortInstructions[viewPortName];
	      var nextViewPortConfig = config.viewPorts[viewPortName];
	
	      if (!nextViewPortConfig) throw new Error('Invalid Route Config: Configuration for viewPort "' + viewPortName + '" was not found for route: "' + instruction.config.route + '."');
	
	      var viewPortPlan = plan[viewPortName] = {
	        name: viewPortName,
	        config: nextViewPortConfig,
	        prevComponent: prevViewPortInstruction.component,
	        prevModuleId: prevViewPortInstruction.moduleId
	      };
	
	      if (prevViewPortInstruction.moduleId !== nextViewPortConfig.moduleId) {
	        viewPortPlan.strategy = activationStrategy.replace;
	      } else if ('determineActivationStrategy' in prevViewPortInstruction.component.viewModel) {
	        var _prevViewPortInstruct;
	
	        viewPortPlan.strategy = (_prevViewPortInstruct = prevViewPortInstruction.component.viewModel).determineActivationStrategy.apply(_prevViewPortInstruct, instruction.lifecycleArgs);
	      } else if (config.activationStrategy) {
	        viewPortPlan.strategy = config.activationStrategy;
	      } else if (newParams || forceLifecycleMinimum) {
	        viewPortPlan.strategy = activationStrategy.invokeLifecycle;
	      } else {
	        viewPortPlan.strategy = activationStrategy.noChange;
	      }
	
	      if (viewPortPlan.strategy !== activationStrategy.replace && prevViewPortInstruction.childRouter) {
	        var path = instruction.getWildcardPath();
	        var task = prevViewPortInstruction.childRouter._createNavigationInstruction(path, instruction).then(function (childInstruction) {
	          viewPortPlan.childNavigationInstruction = childInstruction;
	
	          return _buildNavigationPlan(childInstruction, viewPortPlan.strategy === activationStrategy.invokeLifecycle).then(function (childPlan) {
	            childInstruction.plan = childPlan;
	          });
	        });
	
	        pending.push(task);
	      }
	    };
	
	    for (var viewPortName in prev.viewPortInstructions) {
	      _loop2(viewPortName);
	    }
	
	    return Promise.all(pending).then(function () {
	      return plan;
	    });
	  }
	
	  for (var _viewPortName in config.viewPorts) {
	    plan[_viewPortName] = {
	      name: _viewPortName,
	      strategy: activationStrategy.replace,
	      config: instruction.config.viewPorts[_viewPortName]
	    };
	  }
	
	  return Promise.resolve(plan);
	}
	
	function hasDifferentParameterValues(prev, next) {
	  var prevParams = prev.params;
	  var nextParams = next.params;
	  var nextWildCardName = next.config.hasChildRouter ? next.getWildCardName() : null;
	
	  for (var key in nextParams) {
	    if (key === nextWildCardName) {
	      continue;
	    }
	
	    if (prevParams[key] !== nextParams[key]) {
	      return true;
	    }
	  }
	
	  for (var _key in prevParams) {
	    if (_key === nextWildCardName) {
	      continue;
	    }
	
	    if (prevParams[_key] !== nextParams[_key]) {
	      return true;
	    }
	  }
	
	  if (!next.options.compareQueryParams) {
	    return false;
	  }
	
	  var prevQueryParams = prev.queryParams;
	  var nextQueryParams = next.queryParams;
	  for (var _key2 in nextQueryParams) {
	    if (prevQueryParams[_key2] !== nextQueryParams[_key2]) {
	      return true;
	    }
	  }
	
	  for (var _key3 in prevQueryParams) {
	    if (prevQueryParams[_key3] !== nextQueryParams[_key3]) {
	      return true;
	    }
	  }
	
	  return false;
	}
	
	function getInstructionBaseUrl(instruction) {
	  var instructionBaseUrlParts = [];
	  instruction = instruction.parentInstruction;
	
	  while (instruction) {
	    instructionBaseUrlParts.unshift(instruction.getBaseUrl());
	    instruction = instruction.parentInstruction;
	  }
	
	  instructionBaseUrlParts.unshift('/');
	  return instructionBaseUrlParts.join('');
	}
	
	var Router = exports.Router = function () {
	  function Router(container, history) {
	    _classCallCheck(this, Router);
	
	    this.parent = null;
	    this.options = {};
	
	    this.container = container;
	    this.history = history;
	    this.reset();
	  }
	
	  Router.prototype.reset = function reset() {
	    var _this2 = this;
	
	    this.viewPorts = {};
	    this.routes = [];
	    this.baseUrl = '';
	    this.isConfigured = false;
	    this.isNavigating = false;
	    this.navigation = [];
	    this.currentInstruction = null;
	    this._fallbackOrder = 100;
	    this._recognizer = new _aureliaRouteRecognizer.RouteRecognizer();
	    this._childRecognizer = new _aureliaRouteRecognizer.RouteRecognizer();
	    this._configuredPromise = new Promise(function (resolve) {
	      _this2._resolveConfiguredPromise = resolve;
	    });
	  };
	
	  Router.prototype.registerViewPort = function registerViewPort(viewPort, name) {
	    name = name || 'default';
	    this.viewPorts[name] = viewPort;
	  };
	
	  Router.prototype.ensureConfigured = function ensureConfigured() {
	    return this._configuredPromise;
	  };
	
	  Router.prototype.configure = function configure(callbackOrConfig) {
	    var _this3 = this;
	
	    this.isConfigured = true;
	
	    var result = callbackOrConfig;
	    var config = void 0;
	    if (typeof callbackOrConfig === 'function') {
	      config = new RouterConfiguration();
	      result = callbackOrConfig(config);
	    }
	
	    return Promise.resolve(result).then(function (c) {
	      if (c && c.exportToRouter) {
	        config = c;
	      }
	
	      config.exportToRouter(_this3);
	      _this3.isConfigured = true;
	      _this3._resolveConfiguredPromise();
	    });
	  };
	
	  Router.prototype.navigate = function navigate(fragment, options) {
	    if (!this.isConfigured && this.parent) {
	      return this.parent.navigate(fragment, options);
	    }
	
	    return this.history.navigate(_resolveUrl(fragment, this.baseUrl, this.history._hasPushState), options);
	  };
	
	  Router.prototype.navigateToRoute = function navigateToRoute(route, params, options) {
	    var path = this.generate(route, params);
	    return this.navigate(path, options);
	  };
	
	  Router.prototype.navigateBack = function navigateBack() {
	    this.history.navigateBack();
	  };
	
	  Router.prototype.createChild = function createChild(container) {
	    var childRouter = new Router(container || this.container.createChild(), this.history);
	    childRouter.parent = this;
	    return childRouter;
	  };
	
	  Router.prototype.generate = function generate(name, params) {
	    var options = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];
	
	    var hasRoute = this._recognizer.hasRoute(name);
	    if ((!this.isConfigured || !hasRoute) && this.parent) {
	      return this.parent.generate(name, params);
	    }
	
	    if (!hasRoute) {
	      throw new Error('A route with name \'' + name + '\' could not be found. Check that `name: \'' + name + '\'` was specified in the route\'s config.');
	    }
	
	    var path = this._recognizer.generate(name, params);
	    var rootedPath = _createRootedPath(path, this.baseUrl, this.history._hasPushState, options.absolute);
	    return options.absolute ? '' + this.history.getAbsoluteRoot() + rootedPath : rootedPath;
	  };
	
	  Router.prototype.createNavModel = function createNavModel(config) {
	    var navModel = new NavModel(this, 'href' in config ? config.href : config.route);
	    navModel.title = config.title;
	    navModel.order = config.nav;
	    navModel.href = config.href;
	    navModel.settings = config.settings;
	    navModel.config = config;
	
	    return navModel;
	  };
	
	  Router.prototype.addRoute = function addRoute(config, navModel) {
	    validateRouteConfig(config);
	
	    if (!('viewPorts' in config) && !config.navigationStrategy) {
	      config.viewPorts = {
	        'default': {
	          moduleId: config.moduleId,
	          view: config.view
	        }
	      };
	    }
	
	    if (!navModel) {
	      navModel = this.createNavModel(config);
	    }
	
	    this.routes.push(config);
	
	    var path = config.route;
	    if (path.charAt(0) === '/') {
	      path = path.substr(1);
	    }
	    var caseSensitive = config.caseSensitive === true;
	    var state = this._recognizer.add({ path: path, handler: config, caseSensitive: caseSensitive });
	
	    if (path) {
	      var _settings = config.settings;
	      delete config.settings;
	      var withChild = JSON.parse(JSON.stringify(config));
	      config.settings = _settings;
	      withChild.route = path + '/*childRoute';
	      withChild.hasChildRouter = true;
	      this._childRecognizer.add({
	        path: withChild.route,
	        handler: withChild,
	        caseSensitive: caseSensitive
	      });
	
	      withChild.navModel = navModel;
	      withChild.settings = config.settings;
	    }
	
	    config.navModel = navModel;
	
	    if ((navModel.order || navModel.order === 0) && this.navigation.indexOf(navModel) === -1) {
	      if (!navModel.href && navModel.href !== '' && (state.types.dynamics || state.types.stars)) {
	        throw new Error('Invalid route config: dynamic routes must specify an href to be included in the navigation model.');
	      }
	
	      if (typeof navModel.order !== 'number') {
	        navModel.order = ++this._fallbackOrder;
	      }
	
	      this.navigation.push(navModel);
	      this.navigation = this.navigation.sort(function (a, b) {
	        return a.order - b.order;
	      });
	    }
	  };
	
	  Router.prototype.hasRoute = function hasRoute(name) {
	    return !!(this._recognizer.hasRoute(name) || this.parent && this.parent.hasRoute(name));
	  };
	
	  Router.prototype.hasOwnRoute = function hasOwnRoute(name) {
	    return this._recognizer.hasRoute(name);
	  };
	
	  Router.prototype.handleUnknownRoutes = function handleUnknownRoutes(config) {
	    var _this4 = this;
	
	    if (!config) {
	      throw new Error('Invalid unknown route handler');
	    }
	
	    this.catchAllHandler = function (instruction) {
	      return _this4._createRouteConfig(config, instruction).then(function (c) {
	        instruction.config = c;
	        return instruction;
	      });
	    };
	  };
	
	  Router.prototype.updateTitle = function updateTitle() {
	    if (this.parent) {
	      return this.parent.updateTitle();
	    }
	
	    this.currentInstruction._updateTitle();
	  };
	
	  Router.prototype.refreshNavigation = function refreshNavigation() {
	    var nav = this.navigation;
	
	    for (var i = 0, length = nav.length; i < length; i++) {
	      var _current2 = nav[i];
	      if (!_current2.config.href) {
	        _current2.href = _createRootedPath(_current2.relativeHref, this.baseUrl, this.history._hasPushState);
	      }
	    }
	  };
	
	  Router.prototype._refreshBaseUrl = function _refreshBaseUrl() {
	    if (this.parent) {
	      var baseUrl = this.parent.currentInstruction.getBaseUrl();
	      this.baseUrl = this.parent.baseUrl + baseUrl;
	    }
	  };
	
	  Router.prototype._createNavigationInstruction = function _createNavigationInstruction() {
	    var url = arguments.length <= 0 || arguments[0] === undefined ? '' : arguments[0];
	    var parentInstruction = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];
	
	    var fragment = url;
	    var queryString = '';
	
	    var queryIndex = url.indexOf('?');
	    if (queryIndex !== -1) {
	      fragment = url.substr(0, queryIndex);
	      queryString = url.substr(queryIndex + 1);
	    }
	
	    var results = this._recognizer.recognize(url);
	    if (!results || !results.length) {
	      results = this._childRecognizer.recognize(url);
	    }
	
	    var instructionInit = {
	      fragment: fragment,
	      queryString: queryString,
	      config: null,
	      parentInstruction: parentInstruction,
	      previousInstruction: this.currentInstruction,
	      router: this,
	      options: {
	        compareQueryParams: this.options.compareQueryParams
	      }
	    };
	
	    if (results && results.length) {
	      var first = results[0];
	      var _instruction = new NavigationInstruction(Object.assign({}, instructionInit, {
	        params: first.params,
	        queryParams: first.queryParams || results.queryParams,
	        config: first.config || first.handler
	      }));
	
	      if (typeof first.handler === 'function') {
	        return evaluateNavigationStrategy(_instruction, first.handler, first);
	      } else if (first.handler && 'navigationStrategy' in first.handler) {
	        return evaluateNavigationStrategy(_instruction, first.handler.navigationStrategy, first.handler);
	      }
	
	      return Promise.resolve(_instruction);
	    } else if (this.catchAllHandler) {
	      var _instruction2 = new NavigationInstruction(Object.assign({}, instructionInit, {
	        params: { path: fragment },
	        queryParams: results && results.queryParams,
	        config: null }));
	
	      return evaluateNavigationStrategy(_instruction2, this.catchAllHandler);
	    }
	
	    return Promise.reject(new Error('Route not found: ' + url));
	  };
	
	  Router.prototype._createRouteConfig = function _createRouteConfig(config, instruction) {
	    var _this5 = this;
	
	    return Promise.resolve(config).then(function (c) {
	      if (typeof c === 'string') {
	        return { moduleId: c };
	      } else if (typeof c === 'function') {
	        return c(instruction);
	      }
	
	      return c;
	    }).then(function (c) {
	      return typeof c === 'string' ? { moduleId: c } : c;
	    }).then(function (c) {
	      c.route = instruction.params.path;
	      validateRouteConfig(c);
	
	      if (!c.navModel) {
	        c.navModel = _this5.createNavModel(c);
	      }
	
	      return c;
	    });
	  };
	
	  _createClass(Router, [{
	    key: 'isRoot',
	    get: function get() {
	      return !this.parent;
	    }
	  }]);
	
	  return Router;
	}();
	
	function validateRouteConfig(config) {
	  if ((typeof config === 'undefined' ? 'undefined' : _typeof(config)) !== 'object') {
	    throw new Error('Invalid Route Config');
	  }
	
	  if (typeof config.route !== 'string') {
	    throw new Error('Invalid Route Config: You must specify a route pattern.');
	  }
	
	  if (!('redirect' in config || config.moduleId || config.navigationStrategy || config.viewPorts)) {
	    throw new Error('Invalid Route Config: You must specify a moduleId, redirect, navigationStrategy, or viewPorts.');
	  }
	}
	
	function evaluateNavigationStrategy(instruction, evaluator, context) {
	  return Promise.resolve(evaluator.call(context, instruction)).then(function () {
	    if (!('viewPorts' in instruction.config)) {
	      instruction.config.viewPorts = {
	        'default': {
	          moduleId: instruction.config.moduleId
	        }
	      };
	    }
	
	    return instruction;
	  });
	}
	
	var CanDeactivatePreviousStep = exports.CanDeactivatePreviousStep = function () {
	  function CanDeactivatePreviousStep() {
	    _classCallCheck(this, CanDeactivatePreviousStep);
	  }
	
	  CanDeactivatePreviousStep.prototype.run = function run(navigationInstruction, next) {
	    return processDeactivatable(navigationInstruction.plan, 'canDeactivate', next);
	  };
	
	  return CanDeactivatePreviousStep;
	}();
	
	var CanActivateNextStep = exports.CanActivateNextStep = function () {
	  function CanActivateNextStep() {
	    _classCallCheck(this, CanActivateNextStep);
	  }
	
	  CanActivateNextStep.prototype.run = function run(navigationInstruction, next) {
	    return processActivatable(navigationInstruction, 'canActivate', next);
	  };
	
	  return CanActivateNextStep;
	}();
	
	var DeactivatePreviousStep = exports.DeactivatePreviousStep = function () {
	  function DeactivatePreviousStep() {
	    _classCallCheck(this, DeactivatePreviousStep);
	  }
	
	  DeactivatePreviousStep.prototype.run = function run(navigationInstruction, next) {
	    return processDeactivatable(navigationInstruction.plan, 'deactivate', next, true);
	  };
	
	  return DeactivatePreviousStep;
	}();
	
	var ActivateNextStep = exports.ActivateNextStep = function () {
	  function ActivateNextStep() {
	    _classCallCheck(this, ActivateNextStep);
	  }
	
	  ActivateNextStep.prototype.run = function run(navigationInstruction, next) {
	    return processActivatable(navigationInstruction, 'activate', next, true);
	  };
	
	  return ActivateNextStep;
	}();
	
	function processDeactivatable(plan, callbackName, next, ignoreResult) {
	  var infos = findDeactivatable(plan, callbackName);
	  var i = infos.length;
	
	  function inspect(val) {
	    if (ignoreResult || shouldContinue(val)) {
	      return iterate();
	    }
	
	    return next.cancel(val);
	  }
	
	  function iterate() {
	    if (i--) {
	      try {
	        var viewModel = infos[i];
	        var _result = viewModel[callbackName]();
	        return processPotential(_result, inspect, next.cancel);
	      } catch (error) {
	        return next.cancel(error);
	      }
	    }
	
	    return next();
	  }
	
	  return iterate();
	}
	
	function findDeactivatable(plan, callbackName) {
	  var list = arguments.length <= 2 || arguments[2] === undefined ? [] : arguments[2];
	
	  for (var viewPortName in plan) {
	    var _viewPortPlan = plan[viewPortName];
	    var prevComponent = _viewPortPlan.prevComponent;
	
	    if ((_viewPortPlan.strategy === activationStrategy.invokeLifecycle || _viewPortPlan.strategy === activationStrategy.replace) && prevComponent) {
	      var viewModel = prevComponent.viewModel;
	
	      if (callbackName in viewModel) {
	        list.push(viewModel);
	      }
	    }
	
	    if (_viewPortPlan.childNavigationInstruction) {
	      findDeactivatable(_viewPortPlan.childNavigationInstruction.plan, callbackName, list);
	    } else if (prevComponent) {
	      addPreviousDeactivatable(prevComponent, callbackName, list);
	    }
	  }
	
	  return list;
	}
	
	function addPreviousDeactivatable(component, callbackName, list) {
	  var childRouter = component.childRouter;
	
	  if (childRouter && childRouter.currentInstruction) {
	    var viewPortInstructions = childRouter.currentInstruction.viewPortInstructions;
	
	    for (var viewPortName in viewPortInstructions) {
	      var _viewPortInstruction2 = viewPortInstructions[viewPortName];
	      var prevComponent = _viewPortInstruction2.component;
	      var prevViewModel = prevComponent.viewModel;
	
	      if (callbackName in prevViewModel) {
	        list.push(prevViewModel);
	      }
	
	      addPreviousDeactivatable(prevComponent, callbackName, list);
	    }
	  }
	}
	
	function processActivatable(navigationInstruction, callbackName, next, ignoreResult) {
	  var infos = findActivatable(navigationInstruction, callbackName);
	  var length = infos.length;
	  var i = -1;
	
	  function inspect(val, router) {
	    if (ignoreResult || shouldContinue(val, router)) {
	      return iterate();
	    }
	
	    return next.cancel(val);
	  }
	
	  function iterate() {
	    i++;
	
	    if (i < length) {
	      try {
	        var _ret3 = function () {
	          var _current$viewModel;
	
	          var current = infos[i];
	          var result = (_current$viewModel = current.viewModel)[callbackName].apply(_current$viewModel, current.lifecycleArgs);
	          return {
	            v: processPotential(result, function (val) {
	              return inspect(val, current.router);
	            }, next.cancel)
	          };
	        }();
	
	        if ((typeof _ret3 === 'undefined' ? 'undefined' : _typeof(_ret3)) === "object") return _ret3.v;
	      } catch (error) {
	        return next.cancel(error);
	      }
	    }
	
	    return next();
	  }
	
	  return iterate();
	}
	
	function findActivatable(navigationInstruction, callbackName) {
	  var list = arguments.length <= 2 || arguments[2] === undefined ? [] : arguments[2];
	  var router = arguments[3];
	
	  var plan = navigationInstruction.plan;
	
	  Object.keys(plan).filter(function (viewPortName) {
	    var viewPortPlan = plan[viewPortName];
	    var viewPortInstruction = navigationInstruction.viewPortInstructions[viewPortName];
	    var viewModel = viewPortInstruction.component.viewModel;
	
	    if ((viewPortPlan.strategy === activationStrategy.invokeLifecycle || viewPortPlan.strategy === activationStrategy.replace) && callbackName in viewModel) {
	      list.push({
	        viewModel: viewModel,
	        lifecycleArgs: viewPortInstruction.lifecycleArgs,
	        router: router
	      });
	    }
	
	    if (viewPortPlan.childNavigationInstruction) {
	      findActivatable(viewPortPlan.childNavigationInstruction, callbackName, list, viewPortInstruction.component.childRouter || router);
	    }
	  });
	
	  return list;
	}
	
	function shouldContinue(output, router) {
	  if (output instanceof Error) {
	    return false;
	  }
	
	  if (isNavigationCommand(output)) {
	    if (typeof output.setRouter === 'function') {
	      output.setRouter(router);
	    }
	
	    return !!output.shouldContinueProcessing;
	  }
	
	  if (output === undefined) {
	    return true;
	  }
	
	  return output;
	}
	
	var SafeSubscription = function () {
	  function SafeSubscription(subscriptionFunc) {
	    _classCallCheck(this, SafeSubscription);
	
	    this._subscribed = true;
	    this._subscription = subscriptionFunc(this);
	
	    if (!this._subscribed) this.unsubscribe();
	  }
	
	  SafeSubscription.prototype.unsubscribe = function unsubscribe() {
	    if (this._subscribed && this._subscription) this._subscription.unsubscribe();
	
	    this._subscribed = false;
	  };
	
	  _createClass(SafeSubscription, [{
	    key: 'subscribed',
	    get: function get() {
	      return this._subscribed;
	    }
	  }]);
	
	  return SafeSubscription;
	}();
	
	function processPotential(obj, resolve, reject) {
	  if (obj && typeof obj.then === 'function') {
	    return Promise.resolve(obj).then(resolve).catch(reject);
	  }
	
	  if (obj && typeof obj.subscribe === 'function') {
	    var _ret4 = function () {
	      var obs = obj;
	      return {
	        v: new SafeSubscription(function (sub) {
	          return obs.subscribe({
	            next: function next() {
	              if (sub.subscribed) {
	                sub.unsubscribe();
	                resolve(obj);
	              }
	            },
	            error: function error(_error) {
	              if (sub.subscribed) {
	                sub.unsubscribe();
	                reject(_error);
	              }
	            },
	            complete: function complete() {
	              if (sub.subscribed) {
	                sub.unsubscribe();
	                resolve(obj);
	              }
	            }
	          });
	        })
	      };
	    }();
	
	    if ((typeof _ret4 === 'undefined' ? 'undefined' : _typeof(_ret4)) === "object") return _ret4.v;
	  }
	
	  try {
	    return resolve(obj);
	  } catch (error) {
	    return reject(error);
	  }
	}
	
	var RouteLoader = exports.RouteLoader = function () {
	  function RouteLoader() {
	    _classCallCheck(this, RouteLoader);
	  }
	
	  RouteLoader.prototype.loadRoute = function loadRoute(router, config, navigationInstruction) {
	    throw Error('Route loaders must implement "loadRoute(router, config, navigationInstruction)".');
	  };
	
	  return RouteLoader;
	}();
	
	var LoadRouteStep = exports.LoadRouteStep = function () {
	  LoadRouteStep.inject = function inject() {
	    return [RouteLoader];
	  };
	
	  function LoadRouteStep(routeLoader) {
	    _classCallCheck(this, LoadRouteStep);
	
	    this.routeLoader = routeLoader;
	  }
	
	  LoadRouteStep.prototype.run = function run(navigationInstruction, next) {
	    return loadNewRoute(this.routeLoader, navigationInstruction).then(next).catch(next.cancel);
	  };
	
	  return LoadRouteStep;
	}();
	
	function loadNewRoute(routeLoader, navigationInstruction) {
	  var toLoad = determineWhatToLoad(navigationInstruction);
	  var loadPromises = toLoad.map(function (current) {
	    return loadRoute(routeLoader, current.navigationInstruction, current.viewPortPlan);
	  });
	
	  return Promise.all(loadPromises);
	}
	
	function determineWhatToLoad(navigationInstruction) {
	  var toLoad = arguments.length <= 1 || arguments[1] === undefined ? [] : arguments[1];
	
	  var plan = navigationInstruction.plan;
	
	  for (var viewPortName in plan) {
	    var _viewPortPlan2 = plan[viewPortName];
	
	    if (_viewPortPlan2.strategy === activationStrategy.replace) {
	      toLoad.push({ viewPortPlan: _viewPortPlan2, navigationInstruction: navigationInstruction });
	
	      if (_viewPortPlan2.childNavigationInstruction) {
	        determineWhatToLoad(_viewPortPlan2.childNavigationInstruction, toLoad);
	      }
	    } else {
	      var _viewPortInstruction3 = navigationInstruction.addViewPortInstruction(viewPortName, _viewPortPlan2.strategy, _viewPortPlan2.prevModuleId, _viewPortPlan2.prevComponent);
	
	      if (_viewPortPlan2.childNavigationInstruction) {
	        _viewPortInstruction3.childNavigationInstruction = _viewPortPlan2.childNavigationInstruction;
	        determineWhatToLoad(_viewPortPlan2.childNavigationInstruction, toLoad);
	      }
	    }
	  }
	
	  return toLoad;
	}
	
	function loadRoute(routeLoader, navigationInstruction, viewPortPlan) {
	  var moduleId = viewPortPlan.config.moduleId;
	
	  return loadComponent(routeLoader, navigationInstruction, viewPortPlan.config).then(function (component) {
	    var viewPortInstruction = navigationInstruction.addViewPortInstruction(viewPortPlan.name, viewPortPlan.strategy, moduleId, component);
	
	    var childRouter = component.childRouter;
	    if (childRouter) {
	      var path = navigationInstruction.getWildcardPath();
	
	      return childRouter._createNavigationInstruction(path, navigationInstruction).then(function (childInstruction) {
	        viewPortPlan.childNavigationInstruction = childInstruction;
	
	        return _buildNavigationPlan(childInstruction).then(function (childPlan) {
	          childInstruction.plan = childPlan;
	          viewPortInstruction.childNavigationInstruction = childInstruction;
	
	          return loadNewRoute(routeLoader, childInstruction);
	        });
	      });
	    }
	  });
	}
	
	function loadComponent(routeLoader, navigationInstruction, config) {
	  var router = navigationInstruction.router;
	  var lifecycleArgs = navigationInstruction.lifecycleArgs;
	
	  return routeLoader.loadRoute(router, config, navigationInstruction).then(function (component) {
	    var viewModel = component.viewModel;
	    var childContainer = component.childContainer;
	
	    component.router = router;
	    component.config = config;
	
	    if ('configureRouter' in viewModel) {
	      var _ret5 = function () {
	        var childRouter = childContainer.getChildRouter();
	        component.childRouter = childRouter;
	
	        return {
	          v: childRouter.configure(function (c) {
	            return viewModel.configureRouter.apply(viewModel, [c, childRouter].concat(lifecycleArgs));
	          }).then(function () {
	            return component;
	          })
	        };
	      }();
	
	      if ((typeof _ret5 === 'undefined' ? 'undefined' : _typeof(_ret5)) === "object") return _ret5.v;
	    }
	
	    return component;
	  });
	}
	
	var PipelineSlot = function () {
	  function PipelineSlot(container, name, alias) {
	    _classCallCheck(this, PipelineSlot);
	
	    this.steps = [];
	
	    this.container = container;
	    this.slotName = name;
	    this.slotAlias = alias;
	  }
	
	  PipelineSlot.prototype.getSteps = function getSteps() {
	    var _this6 = this;
	
	    return this.steps.map(function (x) {
	      return _this6.container.get(x);
	    });
	  };
	
	  return PipelineSlot;
	}();
	
	var PipelineProvider = exports.PipelineProvider = function () {
	  PipelineProvider.inject = function inject() {
	    return [_aureliaDependencyInjection.Container];
	  };
	
	  function PipelineProvider(container) {
	    _classCallCheck(this, PipelineProvider);
	
	    this.container = container;
	    this.steps = [BuildNavigationPlanStep, CanDeactivatePreviousStep, LoadRouteStep, this._createPipelineSlot('authorize'), CanActivateNextStep, this._createPipelineSlot('preActivate', 'modelbind'), DeactivatePreviousStep, ActivateNextStep, this._createPipelineSlot('preRender', 'precommit'), CommitChangesStep, this._createPipelineSlot('postRender', 'postcomplete')];
	  }
	
	  PipelineProvider.prototype.createPipeline = function createPipeline() {
	    var _this7 = this;
	
	    var pipeline = new Pipeline();
	    this.steps.forEach(function (step) {
	      return pipeline.addStep(_this7.container.get(step));
	    });
	    return pipeline;
	  };
	
	  PipelineProvider.prototype._findStep = function _findStep(name) {
	    return this.steps.find(function (x) {
	      return x.slotName === name || x.slotAlias === name;
	    });
	  };
	
	  PipelineProvider.prototype.addStep = function addStep(name, step) {
	    var found = this._findStep(name);
	    if (found) {
	      if (!found.steps.includes(step)) {
	        found.steps.push(step);
	      }
	    } else {
	      throw new Error('Invalid pipeline slot name: ' + name + '.');
	    }
	  };
	
	  PipelineProvider.prototype.removeStep = function removeStep(name, step) {
	    var slot = this._findStep(name);
	    if (slot) {
	      slot.steps.splice(slot.steps.indexOf(step), 1);
	    }
	  };
	
	  PipelineProvider.prototype._clearSteps = function _clearSteps() {
	    var name = arguments.length <= 0 || arguments[0] === undefined ? '' : arguments[0];
	
	    var slot = this._findStep(name);
	    if (slot) {
	      slot.steps = [];
	    }
	  };
	
	  PipelineProvider.prototype.reset = function reset() {
	    this._clearSteps('authorize');
	    this._clearSteps('preActivate');
	    this._clearSteps('preRender');
	    this._clearSteps('postRender');
	  };
	
	  PipelineProvider.prototype._createPipelineSlot = function _createPipelineSlot(name, alias) {
	    return new PipelineSlot(this.container, name, alias);
	  };
	
	  return PipelineProvider;
	}();
	
	var logger = LogManager.getLogger('app-router');
	
	var AppRouter = exports.AppRouter = function (_Router) {
	  _inherits(AppRouter, _Router);
	
	  AppRouter.inject = function inject() {
	    return [_aureliaDependencyInjection.Container, _aureliaHistory.History, PipelineProvider, _aureliaEventAggregator.EventAggregator];
	  };
	
	  function AppRouter(container, history, pipelineProvider, events) {
	    _classCallCheck(this, AppRouter);
	
	    var _this8 = _possibleConstructorReturn(this, _Router.call(this, container, history));
	
	    _this8.pipelineProvider = pipelineProvider;
	    _this8.events = events;
	    return _this8;
	  }
	
	  AppRouter.prototype.reset = function reset() {
	    _Router.prototype.reset.call(this);
	    this.maxInstructionCount = 10;
	    if (!this._queue) {
	      this._queue = [];
	    } else {
	      this._queue.length = 0;
	    }
	  };
	
	  AppRouter.prototype.loadUrl = function loadUrl(url) {
	    var _this9 = this;
	
	    return this._createNavigationInstruction(url).then(function (instruction) {
	      return _this9._queueInstruction(instruction);
	    }).catch(function (error) {
	      logger.error(error);
	      restorePreviousLocation(_this9);
	    });
	  };
	
	  AppRouter.prototype.registerViewPort = function registerViewPort(viewPort, name) {
	    var _this10 = this;
	
	    _Router.prototype.registerViewPort.call(this, viewPort, name);
	
	    if (!this.isActive) {
	      var _ret6 = function () {
	        var viewModel = _this10._findViewModel(viewPort);
	        if ('configureRouter' in viewModel) {
	          if (!_this10.isConfigured) {
	            var _ret7 = function () {
	              var resolveConfiguredPromise = _this10._resolveConfiguredPromise;
	              _this10._resolveConfiguredPromise = function () {};
	              return {
	                v: {
	                  v: _this10.configure(function (config) {
	                    return viewModel.configureRouter(config, _this10);
	                  }).then(function () {
	                    _this10.activate();
	                    resolveConfiguredPromise();
	                  })
	                }
	              };
	            }();
	
	            if ((typeof _ret7 === 'undefined' ? 'undefined' : _typeof(_ret7)) === "object") return _ret7.v;
	          }
	        } else {
	          _this10.activate();
	        }
	      }();
	
	      if ((typeof _ret6 === 'undefined' ? 'undefined' : _typeof(_ret6)) === "object") return _ret6.v;
	    } else {
	      this._dequeueInstruction();
	    }
	
	    return Promise.resolve();
	  };
	
	  AppRouter.prototype.activate = function activate(options) {
	    if (this.isActive) {
	      return;
	    }
	
	    this.isActive = true;
	    this.options = Object.assign({ routeHandler: this.loadUrl.bind(this) }, this.options, options);
	    this.history.activate(this.options);
	    this._dequeueInstruction();
	  };
	
	  AppRouter.prototype.deactivate = function deactivate() {
	    this.isActive = false;
	    this.history.deactivate();
	  };
	
	  AppRouter.prototype._queueInstruction = function _queueInstruction(instruction) {
	    var _this11 = this;
	
	    return new Promise(function (resolve) {
	      instruction.resolve = resolve;
	      _this11._queue.unshift(instruction);
	      _this11._dequeueInstruction();
	    });
	  };
	
	  AppRouter.prototype._dequeueInstruction = function _dequeueInstruction() {
	    var _this12 = this;
	
	    var instructionCount = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];
	
	    return Promise.resolve().then(function () {
	      if (_this12.isNavigating && !instructionCount) {
	        return undefined;
	      }
	
	      var instruction = _this12._queue.shift();
	      _this12._queue.length = 0;
	
	      if (!instruction) {
	        return undefined;
	      }
	
	      _this12.isNavigating = true;
	      instruction.previousInstruction = _this12.currentInstruction;
	
	      if (!instructionCount) {
	        _this12.events.publish('router:navigation:processing', { instruction: instruction });
	      } else if (instructionCount === _this12.maxInstructionCount - 1) {
	        logger.error(instructionCount + 1 + ' navigation instructions have been attempted without success. Restoring last known good location.');
	        restorePreviousLocation(_this12);
	        return _this12._dequeueInstruction(instructionCount + 1);
	      } else if (instructionCount > _this12.maxInstructionCount) {
	        throw new Error('Maximum navigation attempts exceeded. Giving up.');
	      }
	
	      var pipeline = _this12.pipelineProvider.createPipeline();
	
	      return pipeline.run(instruction).then(function (result) {
	        return processResult(instruction, result, instructionCount, _this12);
	      }).catch(function (error) {
	        return { output: error instanceof Error ? error : new Error(error) };
	      }).then(function (result) {
	        return resolveInstruction(instruction, result, !!instructionCount, _this12);
	      });
	    });
	  };
	
	  AppRouter.prototype._findViewModel = function _findViewModel(viewPort) {
	    if (this.container.viewModel) {
	      return this.container.viewModel;
	    }
	
	    if (viewPort.container) {
	      var container = viewPort.container;
	
	      while (container) {
	        if (container.viewModel) {
	          this.container.viewModel = container.viewModel;
	          return container.viewModel;
	        }
	
	        container = container.parent;
	      }
	    }
	  };
	
	  return AppRouter;
	}(Router);
	
	function processResult(instruction, result, instructionCount, router) {
	  if (!(result && 'completed' in result && 'output' in result)) {
	    result = result || {};
	    result.output = new Error('Expected router pipeline to return a navigation result, but got [' + JSON.stringify(result) + '] instead.');
	  }
	
	  var finalResult = null;
	  if (isNavigationCommand(result.output)) {
	    result.output.navigate(router);
	  } else {
	    finalResult = result;
	
	    if (!result.completed) {
	      if (result.output instanceof Error) {
	        logger.error(result.output);
	      }
	
	      restorePreviousLocation(router);
	    }
	  }
	
	  return router._dequeueInstruction(instructionCount + 1).then(function (innerResult) {
	    return finalResult || innerResult || result;
	  });
	}
	
	function resolveInstruction(instruction, result, isInnerInstruction, router) {
	  instruction.resolve(result);
	
	  if (!isInnerInstruction) {
	    router.isNavigating = false;
	    var eventArgs = { instruction: instruction, result: result };
	    var eventName = void 0;
	
	    if (result.output instanceof Error) {
	      eventName = 'error';
	    } else if (!result.completed) {
	      eventName = 'canceled';
	    } else {
	      var _queryString = instruction.queryString ? '?' + instruction.queryString : '';
	      router.history.previousLocation = instruction.fragment + _queryString;
	      eventName = 'success';
	    }
	
	    router.events.publish('router:navigation:' + eventName, eventArgs);
	    router.events.publish('router:navigation:complete', eventArgs);
	  }
	
	  return result;
	}
	
	function restorePreviousLocation(router) {
	  var previousLocation = router.history.previousLocation;
	  if (previousLocation) {
	    router.navigate(router.history.previousLocation, { trigger: false, replace: true });
	  } else {
	    logger.error('Router navigation failed, and no previous location could be restored.');
	  }
	}

/***/ },
/* 34 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.RouteRecognizer = exports.EpsilonSegment = exports.StarSegment = exports.DynamicSegment = exports.StaticSegment = exports.State = undefined;
	
	var _aureliaPath = __webpack_require__(9);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var State = exports.State = function () {
	  function State(charSpec) {
	    _classCallCheck(this, State);
	
	    this.charSpec = charSpec;
	    this.nextStates = [];
	  }
	
	  State.prototype.get = function get(charSpec) {
	    for (var _iterator = this.nextStates, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
	      var _ref;
	
	      if (_isArray) {
	        if (_i >= _iterator.length) break;
	        _ref = _iterator[_i++];
	      } else {
	        _i = _iterator.next();
	        if (_i.done) break;
	        _ref = _i.value;
	      }
	
	      var child = _ref;
	
	      var isEqual = child.charSpec.validChars === charSpec.validChars && child.charSpec.invalidChars === charSpec.invalidChars;
	
	      if (isEqual) {
	        return child;
	      }
	    }
	  };
	
	  State.prototype.put = function put(charSpec) {
	    var state = this.get(charSpec);
	
	    if (state) {
	      return state;
	    }
	
	    state = new State(charSpec);
	
	    this.nextStates.push(state);
	
	    if (charSpec.repeat) {
	      state.nextStates.push(state);
	    }
	
	    return state;
	  };
	
	  State.prototype.match = function match(ch) {
	    var nextStates = this.nextStates;
	    var results = [];
	
	    for (var i = 0, l = nextStates.length; i < l; i++) {
	      var child = nextStates[i];
	      var charSpec = child.charSpec;
	
	      if (charSpec.validChars !== undefined) {
	        if (charSpec.validChars.indexOf(ch) !== -1) {
	          results.push(child);
	        }
	      } else if (charSpec.invalidChars !== undefined) {
	        if (charSpec.invalidChars.indexOf(ch) === -1) {
	          results.push(child);
	        }
	      }
	    }
	
	    return results;
	  };
	
	  return State;
	}();
	
	var specials = ['/', '.', '*', '+', '?', '|', '(', ')', '[', ']', '{', '}', '\\'];
	
	var escapeRegex = new RegExp('(\\' + specials.join('|\\') + ')', 'g');
	
	var StaticSegment = exports.StaticSegment = function () {
	  function StaticSegment(string, caseSensitive) {
	    _classCallCheck(this, StaticSegment);
	
	    this.string = string;
	    this.caseSensitive = caseSensitive;
	  }
	
	  StaticSegment.prototype.eachChar = function eachChar(callback) {
	    var s = this.string;
	    for (var i = 0, ii = s.length; i < ii; ++i) {
	      var ch = s[i];
	      callback({ validChars: this.caseSensitive ? ch : ch.toUpperCase() + ch.toLowerCase() });
	    }
	  };
	
	  StaticSegment.prototype.regex = function regex() {
	    return this.string.replace(escapeRegex, '\\$1');
	  };
	
	  StaticSegment.prototype.generate = function generate() {
	    return this.string;
	  };
	
	  return StaticSegment;
	}();
	
	var DynamicSegment = exports.DynamicSegment = function () {
	  function DynamicSegment(name) {
	    _classCallCheck(this, DynamicSegment);
	
	    this.name = name;
	  }
	
	  DynamicSegment.prototype.eachChar = function eachChar(callback) {
	    callback({ invalidChars: '/', repeat: true });
	  };
	
	  DynamicSegment.prototype.regex = function regex() {
	    return '([^/]+)';
	  };
	
	  DynamicSegment.prototype.generate = function generate(params, consumed) {
	    consumed[this.name] = true;
	    return params[this.name];
	  };
	
	  return DynamicSegment;
	}();
	
	var StarSegment = exports.StarSegment = function () {
	  function StarSegment(name) {
	    _classCallCheck(this, StarSegment);
	
	    this.name = name;
	  }
	
	  StarSegment.prototype.eachChar = function eachChar(callback) {
	    callback({ invalidChars: '', repeat: true });
	  };
	
	  StarSegment.prototype.regex = function regex() {
	    return '(.+)';
	  };
	
	  StarSegment.prototype.generate = function generate(params, consumed) {
	    consumed[this.name] = true;
	    return params[this.name];
	  };
	
	  return StarSegment;
	}();
	
	var EpsilonSegment = exports.EpsilonSegment = function () {
	  function EpsilonSegment() {
	    _classCallCheck(this, EpsilonSegment);
	  }
	
	  EpsilonSegment.prototype.eachChar = function eachChar() {};
	
	  EpsilonSegment.prototype.regex = function regex() {
	    return '';
	  };
	
	  EpsilonSegment.prototype.generate = function generate() {
	    return '';
	  };
	
	  return EpsilonSegment;
	}();
	
	var RouteRecognizer = exports.RouteRecognizer = function () {
	  function RouteRecognizer() {
	    _classCallCheck(this, RouteRecognizer);
	
	    this.rootState = new State();
	    this.names = {};
	  }
	
	  RouteRecognizer.prototype.add = function add(route) {
	    var _this = this;
	
	    if (Array.isArray(route)) {
	      route.forEach(function (r) {
	        return _this.add(r);
	      });
	      return undefined;
	    }
	
	    var currentState = this.rootState;
	    var regex = '^';
	    var types = { statics: 0, dynamics: 0, stars: 0 };
	    var names = [];
	    var routeName = route.handler.name;
	    var isEmpty = true;
	    var segments = parse(route.path, names, types, route.caseSensitive);
	
	    for (var i = 0, ii = segments.length; i < ii; i++) {
	      var segment = segments[i];
	      if (segment instanceof EpsilonSegment) {
	        continue;
	      }
	
	      isEmpty = false;
	
	      currentState = currentState.put({ validChars: '/' });
	      regex += '/';
	
	      currentState = addSegment(currentState, segment);
	      regex += segment.regex();
	    }
	
	    if (isEmpty) {
	      currentState = currentState.put({ validChars: '/' });
	      regex += '/';
	    }
	
	    var handlers = [{ handler: route.handler, names: names }];
	
	    if (routeName) {
	      var routeNames = Array.isArray(routeName) ? routeName : [routeName];
	      for (var _i2 = 0; _i2 < routeNames.length; _i2++) {
	        this.names[routeNames[_i2]] = {
	          segments: segments,
	          handlers: handlers
	        };
	      }
	    }
	
	    currentState.handlers = handlers;
	    currentState.regex = new RegExp(regex + '$', route.caseSensitive ? '' : 'i');
	    currentState.types = types;
	
	    return currentState;
	  };
	
	  RouteRecognizer.prototype.handlersFor = function handlersFor(name) {
	    var route = this.names[name];
	    if (!route) {
	      throw new Error('There is no route named ' + name);
	    }
	
	    return [].concat(route.handlers);
	  };
	
	  RouteRecognizer.prototype.hasRoute = function hasRoute(name) {
	    return !!this.names[name];
	  };
	
	  RouteRecognizer.prototype.generate = function generate(name, params) {
	    var routeParams = Object.assign({}, params);
	
	    var route = this.names[name];
	    if (!route) {
	      throw new Error('There is no route named ' + name);
	    }
	
	    var segments = route.segments;
	    var consumed = {};
	    var output = '';
	
	    for (var i = 0, l = segments.length; i < l; i++) {
	      var segment = segments[i];
	
	      if (segment instanceof EpsilonSegment) {
	        continue;
	      }
	
	      output += '/';
	      var segmentValue = segment.generate(routeParams, consumed);
	      if (segmentValue === null || segmentValue === undefined) {
	        throw new Error('A value is required for route parameter \'' + segment.name + '\' in route \'' + name + '\'.');
	      }
	
	      output += segmentValue;
	    }
	
	    if (output.charAt(0) !== '/') {
	      output = '/' + output;
	    }
	
	    for (var param in consumed) {
	      delete routeParams[param];
	    }
	
	    var queryString = (0, _aureliaPath.buildQueryString)(routeParams);
	    output += queryString ? '?' + queryString : '';
	
	    return output;
	  };
	
	  RouteRecognizer.prototype.recognize = function recognize(path) {
	    var states = [this.rootState];
	    var queryParams = {};
	    var isSlashDropped = false;
	    var normalizedPath = path;
	
	    var queryStart = normalizedPath.indexOf('?');
	    if (queryStart !== -1) {
	      var queryString = normalizedPath.substr(queryStart + 1, normalizedPath.length);
	      normalizedPath = normalizedPath.substr(0, queryStart);
	      queryParams = (0, _aureliaPath.parseQueryString)(queryString);
	    }
	
	    normalizedPath = decodeURI(normalizedPath);
	
	    if (normalizedPath.charAt(0) !== '/') {
	      normalizedPath = '/' + normalizedPath;
	    }
	
	    var pathLen = normalizedPath.length;
	    if (pathLen > 1 && normalizedPath.charAt(pathLen - 1) === '/') {
	      normalizedPath = normalizedPath.substr(0, pathLen - 1);
	      isSlashDropped = true;
	    }
	
	    for (var i = 0, l = normalizedPath.length; i < l; i++) {
	      states = recognizeChar(states, normalizedPath.charAt(i));
	      if (!states.length) {
	        break;
	      }
	    }
	
	    var solutions = [];
	    for (var _i3 = 0, _l = states.length; _i3 < _l; _i3++) {
	      if (states[_i3].handlers) {
	        solutions.push(states[_i3]);
	      }
	    }
	
	    states = sortSolutions(solutions);
	
	    var state = solutions[0];
	    if (state && state.handlers) {
	      if (isSlashDropped && state.regex.source.slice(-5) === '(.+)$') {
	        normalizedPath = normalizedPath + '/';
	      }
	
	      return findHandler(state, normalizedPath, queryParams);
	    }
	  };
	
	  return RouteRecognizer;
	}();
	
	var RecognizeResults = function RecognizeResults(queryParams) {
	  _classCallCheck(this, RecognizeResults);
	
	  this.splice = Array.prototype.splice;
	  this.slice = Array.prototype.slice;
	  this.push = Array.prototype.push;
	  this.length = 0;
	  this.queryParams = queryParams || {};
	};
	
	function parse(route, names, types, caseSensitive) {
	  var normalizedRoute = route;
	  if (route.charAt(0) === '/') {
	    normalizedRoute = route.substr(1);
	  }
	
	  var results = [];
	
	  var splitRoute = normalizedRoute.split('/');
	  for (var i = 0, ii = splitRoute.length; i < ii; ++i) {
	    var segment = splitRoute[i];
	    var match = segment.match(/^:([^\/]+)$/);
	    if (match) {
	      results.push(new DynamicSegment(match[1]));
	      names.push(match[1]);
	      types.dynamics++;
	      continue;
	    }
	
	    match = segment.match(/^\*([^\/]+)$/);
	    if (match) {
	      results.push(new StarSegment(match[1]));
	      names.push(match[1]);
	      types.stars++;
	    } else if (segment === '') {
	      results.push(new EpsilonSegment());
	    } else {
	      results.push(new StaticSegment(segment, caseSensitive));
	      types.statics++;
	    }
	  }
	
	  return results;
	}
	
	function sortSolutions(states) {
	  return states.sort(function (a, b) {
	    if (a.types.stars !== b.types.stars) {
	      return a.types.stars - b.types.stars;
	    }
	
	    if (a.types.stars) {
	      if (a.types.statics !== b.types.statics) {
	        return b.types.statics - a.types.statics;
	      }
	      if (a.types.dynamics !== b.types.dynamics) {
	        return b.types.dynamics - a.types.dynamics;
	      }
	    }
	
	    if (a.types.dynamics !== b.types.dynamics) {
	      return a.types.dynamics - b.types.dynamics;
	    }
	
	    if (a.types.statics !== b.types.statics) {
	      return b.types.statics - a.types.statics;
	    }
	
	    return 0;
	  });
	}
	
	function recognizeChar(states, ch) {
	  var nextStates = [];
	
	  for (var i = 0, l = states.length; i < l; i++) {
	    var state = states[i];
	    nextStates.push.apply(nextStates, state.match(ch));
	  }
	
	  return nextStates;
	}
	
	function findHandler(state, path, queryParams) {
	  var handlers = state.handlers;
	  var regex = state.regex;
	  var captures = path.match(regex);
	  var currentCapture = 1;
	  var result = new RecognizeResults(queryParams);
	
	  for (var i = 0, l = handlers.length; i < l; i++) {
	    var _handler = handlers[i];
	    var _names = _handler.names;
	    var _params = {};
	
	    for (var j = 0, m = _names.length; j < m; j++) {
	      _params[_names[j]] = captures[currentCapture++];
	    }
	
	    result.push({ handler: _handler.handler, params: _params, isDynamic: !!_names.length });
	  }
	
	  return result;
	}
	
	function addSegment(currentState, segment) {
	  var state = currentState;
	  segment.eachChar(function (ch) {
	    state = state.put(ch);
	  });
	
	  return state;
	}

/***/ },
/* 35 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.TemplatingBindingLanguage = exports.SyntaxInterpreter = exports.ChildInterpolationBinding = exports.InterpolationBinding = exports.InterpolationBindingExpression = exports.AttributeMap = undefined;
	
	var _class, _temp, _dec, _class2, _class3, _temp2, _class4, _temp3;
	
	exports.configure = configure;
	
	var _aureliaLogging = __webpack_require__(14);
	
	var LogManager = _interopRequireWildcard(_aureliaLogging);
	
	var _aureliaBinding = __webpack_require__(20);
	
	var _aureliaTemplating = __webpack_require__(24);
	
	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var AttributeMap = exports.AttributeMap = (_temp = _class = function () {
	  function AttributeMap(svg) {
	    _classCallCheck(this, AttributeMap);
	
	    this.elements = Object.create(null);
	    this.allElements = Object.create(null);
	
	    this.svg = svg;
	
	    this.registerUniversal('accesskey', 'accessKey');
	    this.registerUniversal('contenteditable', 'contentEditable');
	    this.registerUniversal('tabindex', 'tabIndex');
	    this.registerUniversal('textcontent', 'textContent');
	    this.registerUniversal('innerhtml', 'innerHTML');
	    this.registerUniversal('scrolltop', 'scrollTop');
	    this.registerUniversal('scrollleft', 'scrollLeft');
	    this.registerUniversal('readonly', 'readOnly');
	
	    this.register('label', 'for', 'htmlFor');
	
	    this.register('input', 'maxlength', 'maxLength');
	    this.register('input', 'minlength', 'minLength');
	    this.register('input', 'formaction', 'formAction');
	    this.register('input', 'formenctype', 'formEncType');
	    this.register('input', 'formmethod', 'formMethod');
	    this.register('input', 'formnovalidate', 'formNoValidate');
	    this.register('input', 'formtarget', 'formTarget');
	
	    this.register('td', 'rowspan', 'rowSpan');
	    this.register('td', 'colspan', 'colSpan');
	    this.register('th', 'rowspan', 'rowSpan');
	    this.register('th', 'colspan', 'colSpan');
	  }
	
	  AttributeMap.prototype.register = function register(elementName, attributeName, propertyName) {
	    elementName = elementName.toLowerCase();
	    attributeName = attributeName.toLowerCase();
	    var element = this.elements[elementName] = this.elements[elementName] || Object.create(null);
	    element[attributeName] = propertyName;
	  };
	
	  AttributeMap.prototype.registerUniversal = function registerUniversal(attributeName, propertyName) {
	    attributeName = attributeName.toLowerCase();
	    this.allElements[attributeName] = propertyName;
	  };
	
	  AttributeMap.prototype.map = function map(elementName, attributeName) {
	    if (this.svg.isStandardSvgAttribute(elementName, attributeName)) {
	      return attributeName;
	    }
	    elementName = elementName.toLowerCase();
	    attributeName = attributeName.toLowerCase();
	    var element = this.elements[elementName];
	    if (element !== undefined && attributeName in element) {
	      return element[attributeName];
	    }
	    if (attributeName in this.allElements) {
	      return this.allElements[attributeName];
	    }
	
	    if (/(^data-)|(^aria-)|:/.test(attributeName)) {
	      return attributeName;
	    }
	    return (0, _aureliaBinding.camelCase)(attributeName);
	  };
	
	  return AttributeMap;
	}(), _class.inject = [_aureliaBinding.SVGAnalyzer], _temp);
	
	var InterpolationBindingExpression = exports.InterpolationBindingExpression = function () {
	  function InterpolationBindingExpression(observerLocator, targetProperty, parts, mode, lookupFunctions, attribute) {
	    _classCallCheck(this, InterpolationBindingExpression);
	
	    this.observerLocator = observerLocator;
	    this.targetProperty = targetProperty;
	    this.parts = parts;
	    this.mode = mode;
	    this.lookupFunctions = lookupFunctions;
	    this.attribute = this.attrToRemove = attribute;
	    this.discrete = false;
	  }
	
	  InterpolationBindingExpression.prototype.createBinding = function createBinding(target) {
	    if (this.parts.length === 3) {
	      return new ChildInterpolationBinding(target, this.observerLocator, this.parts[1], this.mode, this.lookupFunctions, this.targetProperty, this.parts[0], this.parts[2]);
	    }
	    return new InterpolationBinding(this.observerLocator, this.parts, target, this.targetProperty, this.mode, this.lookupFunctions);
	  };
	
	  return InterpolationBindingExpression;
	}();
	
	function validateTarget(target, propertyName) {
	  if (propertyName === 'style') {
	    LogManager.getLogger('templating-binding').info('Internet Explorer does not support interpolation in "style" attributes.  Use the style attribute\'s alias, "css" instead.');
	  } else if (target.parentElement && target.parentElement.nodeName === 'TEXTAREA' && propertyName === 'textContent') {
	    throw new Error('Interpolation binding cannot be used in the content of a textarea element.  Use <textarea value.bind="expression"></textarea> instead.');
	  }
	}
	
	var InterpolationBinding = exports.InterpolationBinding = function () {
	  function InterpolationBinding(observerLocator, parts, target, targetProperty, mode, lookupFunctions) {
	    _classCallCheck(this, InterpolationBinding);
	
	    validateTarget(target, targetProperty);
	    this.observerLocator = observerLocator;
	    this.parts = parts;
	    this.target = target;
	    this.targetProperty = targetProperty;
	    this.targetAccessor = observerLocator.getAccessor(target, targetProperty);
	    this.mode = mode;
	    this.lookupFunctions = lookupFunctions;
	  }
	
	  InterpolationBinding.prototype.interpolate = function interpolate() {
	    if (this.isBound) {
	      var value = '';
	      var parts = this.parts;
	      for (var i = 0, ii = parts.length; i < ii; i++) {
	        value += i % 2 === 0 ? parts[i] : this['childBinding' + i].value;
	      }
	      this.targetAccessor.setValue(value, this.target, this.targetProperty);
	    }
	  };
	
	  InterpolationBinding.prototype.updateOneTimeBindings = function updateOneTimeBindings() {
	    for (var i = 1, ii = this.parts.length; i < ii; i += 2) {
	      var child = this['childBinding' + i];
	      if (child.mode === _aureliaBinding.bindingMode.oneTime) {
	        child.call();
	      }
	    }
	  };
	
	  InterpolationBinding.prototype.bind = function bind(source) {
	    if (this.isBound) {
	      if (this.source === source) {
	        return;
	      }
	      this.unbind();
	    }
	    this.source = source;
	
	    var parts = this.parts;
	    for (var i = 1, ii = parts.length; i < ii; i += 2) {
	      var binding = new ChildInterpolationBinding(this, this.observerLocator, parts[i], this.mode, this.lookupFunctions);
	      binding.bind(source);
	      this['childBinding' + i] = binding;
	    }
	
	    this.isBound = true;
	    this.interpolate();
	  };
	
	  InterpolationBinding.prototype.unbind = function unbind() {
	    if (!this.isBound) {
	      return;
	    }
	    this.isBound = false;
	    this.source = null;
	    var parts = this.parts;
	    for (var i = 1, ii = parts.length; i < ii; i += 2) {
	      var name = 'childBinding' + i;
	      this[name].unbind();
	    }
	  };
	
	  return InterpolationBinding;
	}();
	
	var ChildInterpolationBinding = exports.ChildInterpolationBinding = (_dec = (0, _aureliaBinding.connectable)(), _dec(_class2 = function () {
	  function ChildInterpolationBinding(target, observerLocator, sourceExpression, mode, lookupFunctions, targetProperty, left, right) {
	    _classCallCheck(this, ChildInterpolationBinding);
	
	    if (target instanceof InterpolationBinding) {
	      this.parent = target;
	    } else {
	      validateTarget(target, targetProperty);
	      this.target = target;
	      this.targetProperty = targetProperty;
	      this.targetAccessor = observerLocator.getAccessor(target, targetProperty);
	    }
	    this.observerLocator = observerLocator;
	    this.sourceExpression = sourceExpression;
	    this.mode = mode;
	    this.lookupFunctions = lookupFunctions;
	    this.left = left;
	    this.right = right;
	  }
	
	  ChildInterpolationBinding.prototype.updateTarget = function updateTarget(value) {
	    value = value === null || value === undefined ? '' : value.toString();
	    if (value !== this.value) {
	      this.value = value;
	      if (this.parent) {
	        this.parent.interpolate();
	      } else {
	        this.targetAccessor.setValue(this.left + value + this.right, this.target, this.targetProperty);
	      }
	    }
	  };
	
	  ChildInterpolationBinding.prototype.call = function call() {
	    if (!this.isBound) {
	      return;
	    }
	
	    var value = this.sourceExpression.evaluate(this.source, this.lookupFunctions);
	    this.updateTarget(value);
	
	    if (this.mode !== _aureliaBinding.bindingMode.oneTime) {
	      this._version++;
	      this.sourceExpression.connect(this, this.source);
	      if (value instanceof Array) {
	        this.observeArray(value);
	      }
	      this.unobserve(false);
	    }
	  };
	
	  ChildInterpolationBinding.prototype.bind = function bind(source) {
	    if (this.isBound) {
	      if (this.source === source) {
	        return;
	      }
	      this.unbind();
	    }
	    this.isBound = true;
	    this.source = source;
	
	    var sourceExpression = this.sourceExpression;
	    if (sourceExpression.bind) {
	      sourceExpression.bind(this, source, this.lookupFunctions);
	    }
	
	    var value = sourceExpression.evaluate(source, this.lookupFunctions);
	    this.updateTarget(value);
	
	    if (this.mode === _aureliaBinding.bindingMode.oneWay) {
	      (0, _aureliaBinding.enqueueBindingConnect)(this);
	    }
	  };
	
	  ChildInterpolationBinding.prototype.unbind = function unbind() {
	    if (!this.isBound) {
	      return;
	    }
	    this.isBound = false;
	    var sourceExpression = this.sourceExpression;
	    if (sourceExpression.unbind) {
	      sourceExpression.unbind(this, this.source);
	    }
	    this.source = null;
	    this.unobserve(true);
	  };
	
	  ChildInterpolationBinding.prototype.connect = function connect(evaluate) {
	    if (!this.isBound) {
	      return;
	    }
	    if (evaluate) {
	      var value = this.sourceExpression.evaluate(this.source, this.lookupFunctions);
	      this.updateTarget(value);
	    }
	    this.sourceExpression.connect(this, this.source);
	    if (this.value instanceof Array) {
	      this.observeArray(this.value);
	    }
	  };
	
	  return ChildInterpolationBinding;
	}()) || _class2);
	var SyntaxInterpreter = exports.SyntaxInterpreter = (_temp2 = _class3 = function () {
	  function SyntaxInterpreter(parser, observerLocator, eventManager, attributeMap) {
	    _classCallCheck(this, SyntaxInterpreter);
	
	    this.parser = parser;
	    this.observerLocator = observerLocator;
	    this.eventManager = eventManager;
	    this.attributeMap = attributeMap;
	  }
	
	  SyntaxInterpreter.prototype.interpret = function interpret(resources, element, info, existingInstruction, context) {
	    if (info.command in this) {
	      return this[info.command](resources, element, info, existingInstruction, context);
	    }
	
	    return this.handleUnknownCommand(resources, element, info, existingInstruction, context);
	  };
	
	  SyntaxInterpreter.prototype.handleUnknownCommand = function handleUnknownCommand(resources, element, info, existingInstruction, context) {
	    LogManager.getLogger('templating-binding').warn('Unknown binding command.', info);
	    return existingInstruction;
	  };
	
	  SyntaxInterpreter.prototype.determineDefaultBindingMode = function determineDefaultBindingMode(element, attrName, context) {
	    var tagName = element.tagName.toLowerCase();
	
	    if (tagName === 'input' && (attrName === 'value' || attrName === 'files') && element.type !== 'checkbox' && element.type !== 'radio' || tagName === 'input' && attrName === 'checked' && (element.type === 'checkbox' || element.type === 'radio') || (tagName === 'textarea' || tagName === 'select') && attrName === 'value' || (attrName === 'textcontent' || attrName === 'innerhtml') && element.contentEditable === 'true' || attrName === 'scrolltop' || attrName === 'scrollleft') {
	      return _aureliaBinding.bindingMode.twoWay;
	    }
	
	    if (context && attrName in context.attributes && context.attributes[attrName] && context.attributes[attrName].defaultBindingMode >= _aureliaBinding.bindingMode.oneTime) {
	      return context.attributes[attrName].defaultBindingMode;
	    }
	
	    return _aureliaBinding.bindingMode.oneWay;
	  };
	
	  SyntaxInterpreter.prototype.bind = function bind(resources, element, info, existingInstruction, context) {
	    var instruction = existingInstruction || _aureliaTemplating.BehaviorInstruction.attribute(info.attrName);
	
	    instruction.attributes[info.attrName] = new _aureliaBinding.BindingExpression(this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), info.defaultBindingMode || this.determineDefaultBindingMode(element, info.attrName, context), resources.lookupFunctions);
	
	    return instruction;
	  };
	
	  SyntaxInterpreter.prototype.trigger = function trigger(resources, element, info) {
	    return new _aureliaBinding.ListenerExpression(this.eventManager, info.attrName, this.parser.parse(info.attrValue), false, true, resources.lookupFunctions);
	  };
	
	  SyntaxInterpreter.prototype.delegate = function delegate(resources, element, info) {
	    return new _aureliaBinding.ListenerExpression(this.eventManager, info.attrName, this.parser.parse(info.attrValue), true, true, resources.lookupFunctions);
	  };
	
	  SyntaxInterpreter.prototype.call = function call(resources, element, info, existingInstruction) {
	    var instruction = existingInstruction || _aureliaTemplating.BehaviorInstruction.attribute(info.attrName);
	
	    instruction.attributes[info.attrName] = new _aureliaBinding.CallExpression(this.observerLocator, info.attrName, this.parser.parse(info.attrValue), resources.lookupFunctions);
	
	    return instruction;
	  };
	
	  SyntaxInterpreter.prototype.options = function options(resources, element, info, existingInstruction, context) {
	    var instruction = existingInstruction || _aureliaTemplating.BehaviorInstruction.attribute(info.attrName);
	    var attrValue = info.attrValue;
	    var language = this.language;
	    var name = null;
	    var target = '';
	    var current = void 0;
	    var i = void 0;
	    var ii = void 0;
	    var inString = false;
	    var inEscape = false;
	
	    for (i = 0, ii = attrValue.length; i < ii; ++i) {
	      current = attrValue[i];
	
	      if (current === ';' && !inString) {
	        info = language.inspectAttribute(resources, '?', name, target.trim());
	        language.createAttributeInstruction(resources, element, info, instruction, context);
	
	        if (!instruction.attributes[info.attrName]) {
	          instruction.attributes[info.attrName] = info.attrValue;
	        }
	
	        target = '';
	        name = null;
	      } else if (current === ':' && name === null) {
	        name = target.trim();
	        target = '';
	      } else if (current === '\\') {
	        target += current;
	        inEscape = true;
	        continue;
	      } else {
	        target += current;
	
	        if (name !== null && inEscape === false && current === '\'') {
	          inString = !inString;
	        }
	      }
	
	      inEscape = false;
	    }
	
	    if (name !== null) {
	      info = language.inspectAttribute(resources, '?', name, target.trim());
	      language.createAttributeInstruction(resources, element, info, instruction, context);
	
	      if (!instruction.attributes[info.attrName]) {
	        instruction.attributes[info.attrName] = info.attrValue;
	      }
	    }
	
	    return instruction;
	  };
	
	  SyntaxInterpreter.prototype['for'] = function _for(resources, element, info, existingInstruction) {
	    var parts = void 0;
	    var keyValue = void 0;
	    var instruction = void 0;
	    var attrValue = void 0;
	    var isDestructuring = void 0;
	
	    attrValue = info.attrValue;
	    isDestructuring = attrValue.match(/^ *[[].+[\]]/);
	    parts = isDestructuring ? attrValue.split('of ') : attrValue.split(' of ');
	
	    if (parts.length !== 2) {
	      throw new Error('Incorrect syntax for "for". The form is: "$local of $items" or "[$key, $value] of $items".');
	    }
	
	    instruction = existingInstruction || _aureliaTemplating.BehaviorInstruction.attribute(info.attrName);
	
	    if (isDestructuring) {
	      keyValue = parts[0].replace(/[[\]]/g, '').replace(/,/g, ' ').replace(/\s+/g, ' ').trim().split(' ');
	      instruction.attributes.key = keyValue[0];
	      instruction.attributes.value = keyValue[1];
	    } else {
	      instruction.attributes.local = parts[0];
	    }
	
	    instruction.attributes.items = new _aureliaBinding.BindingExpression(this.observerLocator, 'items', this.parser.parse(parts[1]), _aureliaBinding.bindingMode.oneWay, resources.lookupFunctions);
	
	    return instruction;
	  };
	
	  SyntaxInterpreter.prototype['two-way'] = function twoWay(resources, element, info, existingInstruction) {
	    var instruction = existingInstruction || _aureliaTemplating.BehaviorInstruction.attribute(info.attrName);
	
	    instruction.attributes[info.attrName] = new _aureliaBinding.BindingExpression(this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), _aureliaBinding.bindingMode.twoWay, resources.lookupFunctions);
	
	    return instruction;
	  };
	
	  SyntaxInterpreter.prototype['one-way'] = function oneWay(resources, element, info, existingInstruction) {
	    var instruction = existingInstruction || _aureliaTemplating.BehaviorInstruction.attribute(info.attrName);
	
	    instruction.attributes[info.attrName] = new _aureliaBinding.BindingExpression(this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), _aureliaBinding.bindingMode.oneWay, resources.lookupFunctions);
	
	    return instruction;
	  };
	
	  SyntaxInterpreter.prototype['one-time'] = function oneTime(resources, element, info, existingInstruction) {
	    var instruction = existingInstruction || _aureliaTemplating.BehaviorInstruction.attribute(info.attrName);
	
	    instruction.attributes[info.attrName] = new _aureliaBinding.BindingExpression(this.observerLocator, this.attributeMap.map(element.tagName, info.attrName), this.parser.parse(info.attrValue), _aureliaBinding.bindingMode.oneTime, resources.lookupFunctions);
	
	    return instruction;
	  };
	
	  return SyntaxInterpreter;
	}(), _class3.inject = [_aureliaBinding.Parser, _aureliaBinding.ObserverLocator, _aureliaBinding.EventManager, AttributeMap], _temp2);
	
	var info = {};
	
	var TemplatingBindingLanguage = exports.TemplatingBindingLanguage = (_temp3 = _class4 = function (_BindingLanguage) {
	  _inherits(TemplatingBindingLanguage, _BindingLanguage);
	
	  function TemplatingBindingLanguage(parser, observerLocator, syntaxInterpreter, attributeMap) {
	    _classCallCheck(this, TemplatingBindingLanguage);
	
	    var _this = _possibleConstructorReturn(this, _BindingLanguage.call(this));
	
	    _this.parser = parser;
	    _this.observerLocator = observerLocator;
	    _this.syntaxInterpreter = syntaxInterpreter;
	    _this.emptyStringExpression = _this.parser.parse('\'\'');
	    syntaxInterpreter.language = _this;
	    _this.attributeMap = attributeMap;
	    return _this;
	  }
	
	  TemplatingBindingLanguage.prototype.inspectAttribute = function inspectAttribute(resources, elementName, attrName, attrValue) {
	    var parts = attrName.split('.');
	
	    info.defaultBindingMode = null;
	
	    if (parts.length === 2) {
	      info.attrName = parts[0].trim();
	      info.attrValue = attrValue;
	      info.command = parts[1].trim();
	
	      if (info.command === 'ref') {
	        info.expression = new _aureliaBinding.NameExpression(this.parser.parse(attrValue), info.attrName);
	        info.command = null;
	        info.attrName = 'ref';
	      } else {
	        info.expression = null;
	      }
	    } else if (attrName === 'ref') {
	      info.attrName = attrName;
	      info.attrValue = attrValue;
	      info.command = null;
	      info.expression = new _aureliaBinding.NameExpression(this.parser.parse(attrValue), 'element');
	    } else {
	      info.attrName = attrName;
	      info.attrValue = attrValue;
	      info.command = null;
	      var interpolationParts = this.parseInterpolation(resources, attrValue);
	      if (interpolationParts === null) {
	        info.expression = null;
	      } else {
	        info.expression = new InterpolationBindingExpression(this.observerLocator, this.attributeMap.map(elementName, attrName), interpolationParts, _aureliaBinding.bindingMode.oneWay, resources.lookupFunctions, attrName);
	      }
	    }
	
	    return info;
	  };
	
	  TemplatingBindingLanguage.prototype.createAttributeInstruction = function createAttributeInstruction(resources, element, theInfo, existingInstruction, context) {
	    var instruction = void 0;
	
	    if (theInfo.expression) {
	      if (theInfo.attrName === 'ref') {
	        return theInfo.expression;
	      }
	
	      instruction = existingInstruction || _aureliaTemplating.BehaviorInstruction.attribute(theInfo.attrName);
	      instruction.attributes[theInfo.attrName] = theInfo.expression;
	    } else if (theInfo.command) {
	      instruction = this.syntaxInterpreter.interpret(resources, element, theInfo, existingInstruction, context);
	    }
	
	    return instruction;
	  };
	
	  TemplatingBindingLanguage.prototype.inspectTextContent = function inspectTextContent(resources, value) {
	    var parts = this.parseInterpolation(resources, value);
	    if (parts === null) {
	      return null;
	    }
	    return new InterpolationBindingExpression(this.observerLocator, 'textContent', parts, _aureliaBinding.bindingMode.oneWay, resources.lookupFunctions, 'textContent');
	  };
	
	  TemplatingBindingLanguage.prototype.parseInterpolation = function parseInterpolation(resources, value) {
	    var i = value.indexOf('${', 0);
	    var ii = value.length;
	    var char = void 0;
	    var pos = 0;
	    var open = 0;
	    var quote = null;
	    var interpolationStart = void 0;
	    var parts = void 0;
	    var partIndex = 0;
	
	    while (i >= 0 && i < ii - 2) {
	      open = 1;
	      interpolationStart = i;
	      i += 2;
	
	      do {
	        char = value[i];
	        i++;
	
	        if (char === "'" || char === '"') {
	          if (quote === null) {
	            quote = char;
	          } else if (quote === char) {
	            quote = null;
	          }
	          continue;
	        }
	
	        if (char === '\\') {
	          i++;
	          continue;
	        }
	
	        if (quote !== null) {
	          continue;
	        }
	
	        if (char === '{') {
	          open++;
	        } else if (char === '}') {
	          open--;
	        }
	      } while (open > 0 && i < ii);
	
	      if (open === 0) {
	        parts = parts || [];
	        if (value[interpolationStart - 1] === '\\' && value[interpolationStart - 2] !== '\\') {
	          parts[partIndex] = value.substring(pos, interpolationStart - 1) + value.substring(interpolationStart, i);
	          partIndex++;
	          parts[partIndex] = this.emptyStringExpression;
	          partIndex++;
	        } else {
	          parts[partIndex] = value.substring(pos, interpolationStart);
	          partIndex++;
	          parts[partIndex] = this.parser.parse(value.substring(interpolationStart + 2, i - 1));
	          partIndex++;
	        }
	        pos = i;
	        i = value.indexOf('${', i);
	      } else {
	        break;
	      }
	    }
	
	    if (partIndex === 0) {
	      return null;
	    }
	
	    parts[partIndex] = value.substr(pos);
	    return parts;
	  };
	
	  return TemplatingBindingLanguage;
	}(_aureliaTemplating.BindingLanguage), _class4.inject = [_aureliaBinding.Parser, _aureliaBinding.ObserverLocator, SyntaxInterpreter, AttributeMap], _temp3);
	function configure(config) {
	  config.container.registerSingleton(_aureliaTemplating.BindingLanguage, TemplatingBindingLanguage);
	  config.container.registerAlias(_aureliaTemplating.BindingLanguage, TemplatingBindingLanguage);
	}

/***/ },
/* 36 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.viewsRequireLifecycle = exports.unwrapExpression = exports.updateOneTimeBinding = exports.isOneTime = exports.getItemsSourceExpression = exports.updateOverrideContext = exports.createFullOverrideContext = exports.NumberRepeatStrategy = exports.SetRepeatStrategy = exports.MapRepeatStrategy = exports.ArrayRepeatStrategy = exports.NullRepeatStrategy = exports.RepeatStrategyLocator = exports.AbstractRepeater = exports.UpdateTriggerBindingBehavior = exports.BindingSignaler = exports.SignalBindingBehavior = exports.DebounceBindingBehavior = exports.ThrottleBindingBehavior = exports.TwoWayBindingBehavior = exports.OneWayBindingBehavior = exports.OneTimeBindingBehavior = exports.configure = exports.ViewSpy = exports.CompileSpy = exports.Focus = exports.Replaceable = exports.SanitizeHTMLValueConverter = exports.HTMLSanitizer = exports.Hide = exports.Show = exports.Repeat = exports.With = exports.If = exports.Compose = undefined;
	
	var _compose = __webpack_require__(37);
	
	var _if = __webpack_require__(38);
	
	var _with = __webpack_require__(39);
	
	var _repeat = __webpack_require__(40);
	
	var _show = __webpack_require__(50);
	
	var _hide = __webpack_require__(51);
	
	var _sanitizeHtml = __webpack_require__(52);
	
	var _replaceable = __webpack_require__(54);
	
	var _focus = __webpack_require__(55);
	
	var _compileSpy = __webpack_require__(56);
	
	var _viewSpy = __webpack_require__(57);
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _cssResource = __webpack_require__(58);
	
	var _aureliaPal = __webpack_require__(4);
	
	var _htmlSanitizer = __webpack_require__(53);
	
	var _bindingModeBehaviors = __webpack_require__(59);
	
	var _throttleBindingBehavior = __webpack_require__(60);
	
	var _debounceBindingBehavior = __webpack_require__(61);
	
	var _signalBindingBehavior = __webpack_require__(62);
	
	var _bindingSignaler = __webpack_require__(63);
	
	var _updateTriggerBindingBehavior = __webpack_require__(64);
	
	var _abstractRepeater = __webpack_require__(49);
	
	var _repeatStrategyLocator = __webpack_require__(41);
	
	var _htmlResourcePlugin = __webpack_require__(65);
	
	var _nullRepeatStrategy = __webpack_require__(42);
	
	var _arrayRepeatStrategy = __webpack_require__(43);
	
	var _mapRepeatStrategy = __webpack_require__(45);
	
	var _setRepeatStrategy = __webpack_require__(46);
	
	var _numberRepeatStrategy = __webpack_require__(47);
	
	var _repeatUtilities = __webpack_require__(44);
	
	var _analyzeViewFactory = __webpack_require__(48);
	
	function configure(config) {
	  if (_aureliaPal.FEATURE.shadowDOM) {
	    _aureliaPal.DOM.injectStyles('body /deep/ .aurelia-hide { display:none !important; }');
	  } else {
	    _aureliaPal.DOM.injectStyles('.aurelia-hide { display:none !important; }');
	  }
	
	  config.globalResources('./compose', './if', './with', './repeat', './show', './hide', './replaceable', './sanitize-html', './focus', './compile-spy', './view-spy', './binding-mode-behaviors', './throttle-binding-behavior', './debounce-binding-behavior', './signal-binding-behavior', './update-trigger-binding-behavior');
	
	  (0, _htmlResourcePlugin.configure)(config);
	
	  var viewEngine = config.container.get(_aureliaTemplating.ViewEngine);
	  viewEngine.addResourcePlugin('.css', {
	    'fetch': function fetch(address) {
	      var _ref;
	
	      return _ref = {}, _ref[address] = (0, _cssResource._createCSSResource)(address), _ref;
	    }
	  });
	}
	
	exports.Compose = _compose.Compose;
	exports.If = _if.If;
	exports.With = _with.With;
	exports.Repeat = _repeat.Repeat;
	exports.Show = _show.Show;
	exports.Hide = _hide.Hide;
	exports.HTMLSanitizer = _htmlSanitizer.HTMLSanitizer;
	exports.SanitizeHTMLValueConverter = _sanitizeHtml.SanitizeHTMLValueConverter;
	exports.Replaceable = _replaceable.Replaceable;
	exports.Focus = _focus.Focus;
	exports.CompileSpy = _compileSpy.CompileSpy;
	exports.ViewSpy = _viewSpy.ViewSpy;
	exports.configure = configure;
	exports.OneTimeBindingBehavior = _bindingModeBehaviors.OneTimeBindingBehavior;
	exports.OneWayBindingBehavior = _bindingModeBehaviors.OneWayBindingBehavior;
	exports.TwoWayBindingBehavior = _bindingModeBehaviors.TwoWayBindingBehavior;
	exports.ThrottleBindingBehavior = _throttleBindingBehavior.ThrottleBindingBehavior;
	exports.DebounceBindingBehavior = _debounceBindingBehavior.DebounceBindingBehavior;
	exports.SignalBindingBehavior = _signalBindingBehavior.SignalBindingBehavior;
	exports.BindingSignaler = _bindingSignaler.BindingSignaler;
	exports.UpdateTriggerBindingBehavior = _updateTriggerBindingBehavior.UpdateTriggerBindingBehavior;
	exports.AbstractRepeater = _abstractRepeater.AbstractRepeater;
	exports.RepeatStrategyLocator = _repeatStrategyLocator.RepeatStrategyLocator;
	exports.NullRepeatStrategy = _nullRepeatStrategy.NullRepeatStrategy;
	exports.ArrayRepeatStrategy = _arrayRepeatStrategy.ArrayRepeatStrategy;
	exports.MapRepeatStrategy = _mapRepeatStrategy.MapRepeatStrategy;
	exports.SetRepeatStrategy = _setRepeatStrategy.SetRepeatStrategy;
	exports.NumberRepeatStrategy = _numberRepeatStrategy.NumberRepeatStrategy;
	exports.createFullOverrideContext = _repeatUtilities.createFullOverrideContext;
	exports.updateOverrideContext = _repeatUtilities.updateOverrideContext;
	exports.getItemsSourceExpression = _repeatUtilities.getItemsSourceExpression;
	exports.isOneTime = _repeatUtilities.isOneTime;
	exports.updateOneTimeBinding = _repeatUtilities.updateOneTimeBinding;
	exports.unwrapExpression = _repeatUtilities.unwrapExpression;
	exports.viewsRequireLifecycle = _analyzeViewFactory.viewsRequireLifecycle;

/***/ },
/* 37 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.Compose = undefined;
	
	var _dec, _dec2, _class, _desc, _value, _class2, _descriptor, _descriptor2, _descriptor3;
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	var _aureliaTaskQueue = __webpack_require__(21);
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _aureliaPal = __webpack_require__(4);
	
	function _initDefineProp(target, property, descriptor, context) {
	  if (!descriptor) return;
	  Object.defineProperty(target, property, {
	    enumerable: descriptor.enumerable,
	    configurable: descriptor.configurable,
	    writable: descriptor.writable,
	    value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
	  });
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
	  var desc = {};
	  Object['ke' + 'ys'](descriptor).forEach(function (key) {
	    desc[key] = descriptor[key];
	  });
	  desc.enumerable = !!desc.enumerable;
	  desc.configurable = !!desc.configurable;
	
	  if ('value' in desc || desc.initializer) {
	    desc.writable = true;
	  }
	
	  desc = decorators.slice().reverse().reduce(function (desc, decorator) {
	    return decorator(target, property, desc) || desc;
	  }, desc);
	
	  if (context && desc.initializer !== void 0) {
	    desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
	    desc.initializer = undefined;
	  }
	
	  if (desc.initializer === void 0) {
	    Object['define' + 'Property'](target, property, desc);
	    desc = null;
	  }
	
	  return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
	  throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var Compose = exports.Compose = (_dec = (0, _aureliaTemplating.customElement)('compose'), _dec2 = (0, _aureliaDependencyInjection.inject)(_aureliaPal.DOM.Element, _aureliaDependencyInjection.Container, _aureliaTemplating.CompositionEngine, _aureliaTemplating.ViewSlot, _aureliaTemplating.ViewResources, _aureliaTaskQueue.TaskQueue), _dec(_class = (0, _aureliaTemplating.noView)(_class = _dec2(_class = (_class2 = function () {
	  function Compose(element, container, compositionEngine, viewSlot, viewResources, taskQueue) {
	    _classCallCheck(this, Compose);
	
	    _initDefineProp(this, 'model', _descriptor, this);
	
	    _initDefineProp(this, 'view', _descriptor2, this);
	
	    _initDefineProp(this, 'viewModel', _descriptor3, this);
	
	    this.element = element;
	    this.container = container;
	    this.compositionEngine = compositionEngine;
	    this.viewSlot = viewSlot;
	    this.viewResources = viewResources;
	    this.taskQueue = taskQueue;
	    this.currentController = null;
	    this.currentViewModel = null;
	  }
	
	  Compose.prototype.created = function created(owningView) {
	    this.owningView = owningView;
	  };
	
	  Compose.prototype.bind = function bind(bindingContext, overrideContext) {
	    this.bindingContext = bindingContext;
	    this.overrideContext = overrideContext;
	    processInstruction(this, createInstruction(this, {
	      view: this.view,
	      viewModel: this.viewModel,
	      model: this.model
	    }));
	  };
	
	  Compose.prototype.unbind = function unbind(bindingContext, overrideContext) {
	    this.bindingContext = null;
	    this.overrideContext = null;
	    var returnToCache = true;
	    var skipAnimation = true;
	    this.viewSlot.removeAll(returnToCache, skipAnimation);
	  };
	
	  Compose.prototype.modelChanged = function modelChanged(newValue, oldValue) {
	    var _this = this;
	
	    if (this.currentInstruction) {
	      this.currentInstruction.model = newValue;
	      return;
	    }
	
	    this.taskQueue.queueMicroTask(function () {
	      if (_this.currentInstruction) {
	        _this.currentInstruction.model = newValue;
	        return;
	      }
	
	      var vm = _this.currentViewModel;
	
	      if (vm && typeof vm.activate === 'function') {
	        vm.activate(newValue);
	      }
	    });
	  };
	
	  Compose.prototype.viewChanged = function viewChanged(newValue, oldValue) {
	    var _this2 = this;
	
	    var instruction = createInstruction(this, {
	      view: newValue,
	      viewModel: this.currentViewModel || this.viewModel,
	      model: this.model
	    });
	
	    if (this.currentInstruction) {
	      this.currentInstruction = instruction;
	      return;
	    }
	
	    this.currentInstruction = instruction;
	    this.taskQueue.queueMicroTask(function () {
	      return processInstruction(_this2, _this2.currentInstruction);
	    });
	  };
	
	  Compose.prototype.viewModelChanged = function viewModelChanged(newValue, oldValue) {
	    var _this3 = this;
	
	    var instruction = createInstruction(this, {
	      viewModel: newValue,
	      view: this.view,
	      model: this.model
	    });
	
	    if (this.currentInstruction) {
	      this.currentInstruction = instruction;
	      return;
	    }
	
	    this.currentInstruction = instruction;
	    this.taskQueue.queueMicroTask(function () {
	      return processInstruction(_this3, _this3.currentInstruction);
	    });
	  };
	
	  return Compose;
	}(), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'model', [_aureliaTemplating.bindable], {
	  enumerable: true,
	  initializer: null
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'view', [_aureliaTemplating.bindable], {
	  enumerable: true,
	  initializer: null
	}), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, 'viewModel', [_aureliaTemplating.bindable], {
	  enumerable: true,
	  initializer: null
	})), _class2)) || _class) || _class) || _class);
	
	
	function createInstruction(composer, instruction) {
	  return Object.assign(instruction, {
	    bindingContext: composer.bindingContext,
	    overrideContext: composer.overrideContext,
	    owningView: composer.owningView,
	    container: composer.container,
	    viewSlot: composer.viewSlot,
	    viewResources: composer.viewResources,
	    currentController: composer.currentController,
	    host: composer.element
	  });
	}
	
	function processInstruction(composer, instruction) {
	  composer.currentInstruction = null;
	  composer.compositionEngine.compose(instruction).then(function (controller) {
	    composer.currentController = controller;
	    composer.currentViewModel = controller ? controller.viewModel : null;
	  });
	}

/***/ },
/* 38 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.If = undefined;
	
	var _dec, _dec2, _class;
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var If = exports.If = (_dec = (0, _aureliaTemplating.customAttribute)('if'), _dec2 = (0, _aureliaDependencyInjection.inject)(_aureliaTemplating.BoundViewFactory, _aureliaTemplating.ViewSlot), _dec(_class = (0, _aureliaTemplating.templateController)(_class = _dec2(_class = function () {
	  function If(viewFactory, viewSlot) {
	    _classCallCheck(this, If);
	
	    this.viewFactory = viewFactory;
	    this.viewSlot = viewSlot;
	    this.showing = false;
	    this.view = null;
	    this.bindingContext = null;
	    this.overrideContext = null;
	  }
	
	  If.prototype.bind = function bind(bindingContext, overrideContext) {
	    this.bindingContext = bindingContext;
	    this.overrideContext = overrideContext;
	    this.valueChanged(this.value);
	  };
	
	  If.prototype.valueChanged = function valueChanged(newValue) {
	    var _this = this;
	
	    if (this.__queuedChanges) {
	      this.__queuedChanges.push(newValue);
	      return;
	    }
	
	    var maybePromise = this._runValueChanged(newValue);
	    if (maybePromise instanceof Promise) {
	      (function () {
	        var queuedChanges = _this.__queuedChanges = [];
	
	        var runQueuedChanges = function runQueuedChanges() {
	          if (!queuedChanges.length) {
	            _this.__queuedChanges = undefined;
	            return;
	          }
	
	          var nextPromise = _this._runValueChanged(queuedChanges.shift()) || Promise.resolve();
	          nextPromise.then(runQueuedChanges);
	        };
	
	        maybePromise.then(runQueuedChanges);
	      })();
	    }
	  };
	
	  If.prototype._runValueChanged = function _runValueChanged(newValue) {
	    var _this2 = this;
	
	    if (!newValue) {
	      var viewOrPromise = void 0;
	      if (this.view !== null && this.showing) {
	        viewOrPromise = this.viewSlot.remove(this.view);
	        if (viewOrPromise instanceof Promise) {
	          viewOrPromise.then(function () {
	            return _this2.view.unbind();
	          });
	        } else {
	          this.view.unbind();
	        }
	      }
	
	      this.showing = false;
	      return viewOrPromise;
	    }
	
	    if (this.view === null) {
	      this.view = this.viewFactory.create();
	    }
	
	    if (!this.view.isBound) {
	      this.view.bind(this.bindingContext, this.overrideContext);
	    }
	
	    if (!this.showing) {
	      this.showing = true;
	      return this.viewSlot.add(this.view);
	    }
	  };
	
	  If.prototype.unbind = function unbind() {
	    if (this.view === null) {
	      return;
	    }
	
	    this.view.unbind();
	
	    if (!this.viewFactory.isCaching) {
	      return;
	    }
	
	    if (this.showing) {
	      this.showing = false;
	      this.viewSlot.remove(this.view, true, true);
	    }
	    this.view.returnToCache();
	    this.view = null;
	  };
	
	  return If;
	}()) || _class) || _class) || _class);

/***/ },
/* 39 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.With = undefined;
	
	var _dec, _dec2, _class;
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _aureliaBinding = __webpack_require__(20);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var With = exports.With = (_dec = (0, _aureliaTemplating.customAttribute)('with'), _dec2 = (0, _aureliaDependencyInjection.inject)(_aureliaTemplating.BoundViewFactory, _aureliaTemplating.ViewSlot), _dec(_class = (0, _aureliaTemplating.templateController)(_class = _dec2(_class = function () {
	  function With(viewFactory, viewSlot) {
	    _classCallCheck(this, With);
	
	    this.viewFactory = viewFactory;
	    this.viewSlot = viewSlot;
	    this.parentOverrideContext = null;
	    this.view = null;
	  }
	
	  With.prototype.bind = function bind(bindingContext, overrideContext) {
	    this.parentOverrideContext = overrideContext;
	    this.valueChanged(this.value);
	  };
	
	  With.prototype.valueChanged = function valueChanged(newValue) {
	    var overrideContext = (0, _aureliaBinding.createOverrideContext)(newValue, this.parentOverrideContext);
	    if (!this.view) {
	      this.view = this.viewFactory.create();
	      this.view.bind(newValue, overrideContext);
	      this.viewSlot.add(this.view);
	    } else {
	      this.view.bind(newValue, overrideContext);
	    }
	  };
	
	  With.prototype.unbind = function unbind() {
	    this.parentOverrideContext = null;
	
	    if (this.view) {
	      this.view.unbind();
	    }
	  };
	
	  return With;
	}()) || _class) || _class) || _class);

/***/ },
/* 40 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.Repeat = undefined;
	
	var _dec, _dec2, _class, _desc, _value, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4;
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	var _aureliaBinding = __webpack_require__(20);
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _repeatStrategyLocator = __webpack_require__(41);
	
	var _repeatUtilities = __webpack_require__(44);
	
	var _analyzeViewFactory = __webpack_require__(48);
	
	var _abstractRepeater = __webpack_require__(49);
	
	function _initDefineProp(target, property, descriptor, context) {
	  if (!descriptor) return;
	  Object.defineProperty(target, property, {
	    enumerable: descriptor.enumerable,
	    configurable: descriptor.configurable,
	    writable: descriptor.writable,
	    value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
	  });
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
	  var desc = {};
	  Object['ke' + 'ys'](descriptor).forEach(function (key) {
	    desc[key] = descriptor[key];
	  });
	  desc.enumerable = !!desc.enumerable;
	  desc.configurable = !!desc.configurable;
	
	  if ('value' in desc || desc.initializer) {
	    desc.writable = true;
	  }
	
	  desc = decorators.slice().reverse().reduce(function (desc, decorator) {
	    return decorator(target, property, desc) || desc;
	  }, desc);
	
	  if (context && desc.initializer !== void 0) {
	    desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
	    desc.initializer = undefined;
	  }
	
	  if (desc.initializer === void 0) {
	    Object['define' + 'Property'](target, property, desc);
	    desc = null;
	  }
	
	  return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
	  throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var Repeat = exports.Repeat = (_dec = (0, _aureliaTemplating.customAttribute)('repeat'), _dec2 = (0, _aureliaDependencyInjection.inject)(_aureliaTemplating.BoundViewFactory, _aureliaTemplating.TargetInstruction, _aureliaTemplating.ViewSlot, _aureliaTemplating.ViewResources, _aureliaBinding.ObserverLocator, _repeatStrategyLocator.RepeatStrategyLocator), _dec(_class = (0, _aureliaTemplating.templateController)(_class = _dec2(_class = (_class2 = function (_AbstractRepeater) {
	  _inherits(Repeat, _AbstractRepeater);
	
	  function Repeat(viewFactory, instruction, viewSlot, viewResources, observerLocator, strategyLocator) {
	    _classCallCheck(this, Repeat);
	
	    var _this = _possibleConstructorReturn(this, _AbstractRepeater.call(this, {
	      local: 'item',
	      viewsRequireLifecycle: (0, _analyzeViewFactory.viewsRequireLifecycle)(viewFactory)
	    }));
	
	    _initDefineProp(_this, 'items', _descriptor, _this);
	
	    _initDefineProp(_this, 'local', _descriptor2, _this);
	
	    _initDefineProp(_this, 'key', _descriptor3, _this);
	
	    _initDefineProp(_this, 'value', _descriptor4, _this);
	
	    _this.viewFactory = viewFactory;
	    _this.instruction = instruction;
	    _this.viewSlot = viewSlot;
	    _this.lookupFunctions = viewResources.lookupFunctions;
	    _this.observerLocator = observerLocator;
	    _this.key = 'key';
	    _this.value = 'value';
	    _this.strategyLocator = strategyLocator;
	    _this.ignoreMutation = false;
	    _this.sourceExpression = (0, _repeatUtilities.getItemsSourceExpression)(_this.instruction, 'repeat.for');
	    _this.isOneTime = (0, _repeatUtilities.isOneTime)(_this.sourceExpression);
	    _this.viewsRequireLifecycle = (0, _analyzeViewFactory.viewsRequireLifecycle)(viewFactory);
	    return _this;
	  }
	
	  Repeat.prototype.call = function call(context, changes) {
	    this[context](this.items, changes);
	  };
	
	  Repeat.prototype.bind = function bind(bindingContext, overrideContext) {
	    this.scope = { bindingContext: bindingContext, overrideContext: overrideContext };
	    this.matcherBinding = this._captureAndRemoveMatcherBinding();
	    this.itemsChanged();
	  };
	
	  Repeat.prototype.unbind = function unbind() {
	    this.scope = null;
	    this.items = null;
	    this.matcherBinding = null;
	    this.viewSlot.removeAll(true);
	    this._unsubscribeCollection();
	  };
	
	  Repeat.prototype._unsubscribeCollection = function _unsubscribeCollection() {
	    if (this.collectionObserver) {
	      this.collectionObserver.unsubscribe(this.callContext, this);
	      this.collectionObserver = null;
	      this.callContext = null;
	    }
	  };
	
	  Repeat.prototype.itemsChanged = function itemsChanged() {
	    this._unsubscribeCollection();
	
	    if (!this.scope) {
	      return;
	    }
	
	    var items = this.items;
	    this.strategy = this.strategyLocator.getStrategy(items);
	    if (!this.strategy) {
	      throw new Error('Value for \'' + this.sourceExpression + '\' is non-repeatable');
	    }
	
	    if (!this.isOneTime && !this._observeInnerCollection()) {
	      this._observeCollection();
	    }
	    this.strategy.instanceChanged(this, items);
	  };
	
	  Repeat.prototype._getInnerCollection = function _getInnerCollection() {
	    var expression = (0, _repeatUtilities.unwrapExpression)(this.sourceExpression);
	    if (!expression) {
	      return null;
	    }
	    return expression.evaluate(this.scope, null);
	  };
	
	  Repeat.prototype.handleCollectionMutated = function handleCollectionMutated(collection, changes) {
	    if (!this.collectionObserver) {
	      return;
	    }
	    this.strategy.instanceMutated(this, collection, changes);
	  };
	
	  Repeat.prototype.handleInnerCollectionMutated = function handleInnerCollectionMutated(collection, changes) {
	    var _this2 = this;
	
	    if (!this.collectionObserver) {
	      return;
	    }
	
	    if (this.ignoreMutation) {
	      return;
	    }
	    this.ignoreMutation = true;
	    var newItems = this.sourceExpression.evaluate(this.scope, this.lookupFunctions);
	    this.observerLocator.taskQueue.queueMicroTask(function () {
	      return _this2.ignoreMutation = false;
	    });
	
	    if (newItems === this.items) {
	      this.itemsChanged();
	    } else {
	      this.items = newItems;
	    }
	  };
	
	  Repeat.prototype._observeInnerCollection = function _observeInnerCollection() {
	    var items = this._getInnerCollection();
	    var strategy = this.strategyLocator.getStrategy(items);
	    if (!strategy) {
	      return false;
	    }
	    this.collectionObserver = strategy.getCollectionObserver(this.observerLocator, items);
	    if (!this.collectionObserver) {
	      return false;
	    }
	    this.callContext = 'handleInnerCollectionMutated';
	    this.collectionObserver.subscribe(this.callContext, this);
	    return true;
	  };
	
	  Repeat.prototype._observeCollection = function _observeCollection() {
	    var items = this.items;
	    this.collectionObserver = this.strategy.getCollectionObserver(this.observerLocator, items);
	    if (this.collectionObserver) {
	      this.callContext = 'handleCollectionMutated';
	      this.collectionObserver.subscribe(this.callContext, this);
	    }
	  };
	
	  Repeat.prototype._captureAndRemoveMatcherBinding = function _captureAndRemoveMatcherBinding() {
	    if (this.viewFactory.viewFactory) {
	      var instructions = this.viewFactory.viewFactory.instructions;
	      var instructionIds = Object.keys(instructions);
	      for (var i = 0; i < instructionIds.length; i++) {
	        var expressions = instructions[instructionIds[i]].expressions;
	        if (expressions) {
	          for (var ii = 0; i < expressions.length; i++) {
	            if (expressions[ii].targetProperty === 'matcher') {
	              var matcherBinding = expressions[ii];
	              expressions.splice(ii, 1);
	              return matcherBinding;
	            }
	          }
	        }
	      }
	    }
	  };
	
	  Repeat.prototype.viewCount = function viewCount() {
	    return this.viewSlot.children.length;
	  };
	
	  Repeat.prototype.views = function views() {
	    return this.viewSlot.children;
	  };
	
	  Repeat.prototype.view = function view(index) {
	    return this.viewSlot.children[index];
	  };
	
	  Repeat.prototype.matcher = function matcher() {
	    return this.matcherBinding ? this.matcherBinding.sourceExpression.evaluate(this.scope, this.matcherBinding.lookupFunctions) : null;
	  };
	
	  Repeat.prototype.addView = function addView(bindingContext, overrideContext) {
	    var view = this.viewFactory.create();
	    view.bind(bindingContext, overrideContext);
	    this.viewSlot.add(view);
	  };
	
	  Repeat.prototype.insertView = function insertView(index, bindingContext, overrideContext) {
	    var view = this.viewFactory.create();
	    view.bind(bindingContext, overrideContext);
	    this.viewSlot.insert(index, view);
	  };
	
	  Repeat.prototype.moveView = function moveView(sourceIndex, targetIndex) {
	    this.viewSlot.move(sourceIndex, targetIndex);
	  };
	
	  Repeat.prototype.removeAllViews = function removeAllViews(returnToCache, skipAnimation) {
	    return this.viewSlot.removeAll(returnToCache, skipAnimation);
	  };
	
	  Repeat.prototype.removeViews = function removeViews(viewsToRemove, returnToCache, skipAnimation) {
	    return this.viewSlot.removeMany(viewsToRemove, returnToCache, skipAnimation);
	  };
	
	  Repeat.prototype.removeView = function removeView(index, returnToCache, skipAnimation) {
	    return this.viewSlot.removeAt(index, returnToCache, skipAnimation);
	  };
	
	  Repeat.prototype.updateBindings = function updateBindings(view) {
	    var j = view.bindings.length;
	    while (j--) {
	      (0, _repeatUtilities.updateOneTimeBinding)(view.bindings[j]);
	    }
	    j = view.controllers.length;
	    while (j--) {
	      var k = view.controllers[j].boundProperties.length;
	      while (k--) {
	        var binding = view.controllers[j].boundProperties[k].binding;
	        (0, _repeatUtilities.updateOneTimeBinding)(binding);
	      }
	    }
	  };
	
	  return Repeat;
	}(_abstractRepeater.AbstractRepeater), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'items', [_aureliaTemplating.bindable], {
	  enumerable: true,
	  initializer: null
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'local', [_aureliaTemplating.bindable], {
	  enumerable: true,
	  initializer: null
	}), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, 'key', [_aureliaTemplating.bindable], {
	  enumerable: true,
	  initializer: null
	}), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, 'value', [_aureliaTemplating.bindable], {
	  enumerable: true,
	  initializer: null
	})), _class2)) || _class) || _class) || _class);

/***/ },
/* 41 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.RepeatStrategyLocator = undefined;
	
	var _nullRepeatStrategy = __webpack_require__(42);
	
	var _arrayRepeatStrategy = __webpack_require__(43);
	
	var _mapRepeatStrategy = __webpack_require__(45);
	
	var _setRepeatStrategy = __webpack_require__(46);
	
	var _numberRepeatStrategy = __webpack_require__(47);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var RepeatStrategyLocator = exports.RepeatStrategyLocator = function () {
	  function RepeatStrategyLocator() {
	    _classCallCheck(this, RepeatStrategyLocator);
	
	    this.matchers = [];
	    this.strategies = [];
	
	    this.addStrategy(function (items) {
	      return items === null || items === undefined;
	    }, new _nullRepeatStrategy.NullRepeatStrategy());
	    this.addStrategy(function (items) {
	      return items instanceof Array;
	    }, new _arrayRepeatStrategy.ArrayRepeatStrategy());
	    this.addStrategy(function (items) {
	      return items instanceof Map;
	    }, new _mapRepeatStrategy.MapRepeatStrategy());
	    this.addStrategy(function (items) {
	      return items instanceof Set;
	    }, new _setRepeatStrategy.SetRepeatStrategy());
	    this.addStrategy(function (items) {
	      return typeof items === 'number';
	    }, new _numberRepeatStrategy.NumberRepeatStrategy());
	  }
	
	  RepeatStrategyLocator.prototype.addStrategy = function addStrategy(matcher, strategy) {
	    this.matchers.push(matcher);
	    this.strategies.push(strategy);
	  };
	
	  RepeatStrategyLocator.prototype.getStrategy = function getStrategy(items) {
	    var matchers = this.matchers;
	
	    for (var i = 0, ii = matchers.length; i < ii; ++i) {
	      if (matchers[i](items)) {
	        return this.strategies[i];
	      }
	    }
	
	    return null;
	  };
	
	  return RepeatStrategyLocator;
	}();

/***/ },
/* 42 */
/***/ function(module, exports) {

	"use strict";
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var NullRepeatStrategy = exports.NullRepeatStrategy = function () {
	  function NullRepeatStrategy() {
	    _classCallCheck(this, NullRepeatStrategy);
	  }
	
	  NullRepeatStrategy.prototype.instanceChanged = function instanceChanged(repeat, items) {
	    repeat.removeAllViews(true);
	  };
	
	  NullRepeatStrategy.prototype.getCollectionObserver = function getCollectionObserver(observerLocator, items) {};
	
	  return NullRepeatStrategy;
	}();

/***/ },
/* 43 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.ArrayRepeatStrategy = undefined;
	
	var _repeatUtilities = __webpack_require__(44);
	
	var _aureliaBinding = __webpack_require__(20);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var ArrayRepeatStrategy = exports.ArrayRepeatStrategy = function () {
	  function ArrayRepeatStrategy() {
	    _classCallCheck(this, ArrayRepeatStrategy);
	  }
	
	  ArrayRepeatStrategy.prototype.getCollectionObserver = function getCollectionObserver(observerLocator, items) {
	    return observerLocator.getArrayObserver(items);
	  };
	
	  ArrayRepeatStrategy.prototype.instanceChanged = function instanceChanged(repeat, items) {
	    var _this = this;
	
	    var itemsLength = items.length;
	
	    if (!items || itemsLength === 0) {
	      repeat.removeAllViews(true);
	      return;
	    }
	
	    var children = repeat.views();
	    var viewsLength = children.length;
	
	    if (viewsLength === 0) {
	      this._standardProcessInstanceChanged(repeat, items);
	      return;
	    }
	
	    if (repeat.viewsRequireLifecycle) {
	      (function () {
	        var childrenSnapshot = children.slice(0);
	        var itemNameInBindingContext = repeat.local;
	        var matcher = repeat.matcher();
	
	        var itemsPreviouslyInViews = [];
	        var viewsToRemove = [];
	
	        for (var index = 0; index < viewsLength; index++) {
	          var view = childrenSnapshot[index];
	          var oldItem = view.bindingContext[itemNameInBindingContext];
	
	          if ((0, _repeatUtilities.indexOf)(items, oldItem, matcher) === -1) {
	            viewsToRemove.push(view);
	          } else {
	            itemsPreviouslyInViews.push(oldItem);
	          }
	        }
	
	        var updateViews = void 0;
	        var removePromise = void 0;
	
	        if (itemsPreviouslyInViews.length > 0) {
	          removePromise = repeat.removeViews(viewsToRemove, true);
	          updateViews = function updateViews() {
	            for (var _index = 0; _index < itemsLength; _index++) {
	              var item = items[_index];
	              var indexOfView = (0, _repeatUtilities.indexOf)(itemsPreviouslyInViews, item, matcher, _index);
	              var _view = void 0;
	
	              if (indexOfView === -1) {
	                var overrideContext = (0, _repeatUtilities.createFullOverrideContext)(repeat, items[_index], _index, itemsLength);
	                repeat.insertView(_index, overrideContext.bindingContext, overrideContext);
	
	                itemsPreviouslyInViews.splice(_index, 0, undefined);
	              } else if (indexOfView === _index) {
	                _view = children[indexOfView];
	                itemsPreviouslyInViews[indexOfView] = undefined;
	              } else {
	                _view = children[indexOfView];
	                repeat.moveView(indexOfView, _index);
	                itemsPreviouslyInViews.splice(indexOfView, 1);
	                itemsPreviouslyInViews.splice(_index, 0, undefined);
	              }
	
	              if (_view) {
	                (0, _repeatUtilities.updateOverrideContext)(_view.overrideContext, _index, itemsLength);
	              }
	            }
	
	            _this._inPlaceProcessItems(repeat, items);
	          };
	        } else {
	          removePromise = repeat.removeAllViews(true);
	          updateViews = function updateViews() {
	            return _this._standardProcessInstanceChanged(repeat, items);
	          };
	        }
	
	        if (removePromise instanceof Promise) {
	          removePromise.then(updateViews);
	        } else {
	          updateViews();
	        }
	      })();
	    } else {
	      this._inPlaceProcessItems(repeat, items);
	    }
	  };
	
	  ArrayRepeatStrategy.prototype._standardProcessInstanceChanged = function _standardProcessInstanceChanged(repeat, items) {
	    for (var i = 0, ii = items.length; i < ii; i++) {
	      var overrideContext = (0, _repeatUtilities.createFullOverrideContext)(repeat, items[i], i, ii);
	      repeat.addView(overrideContext.bindingContext, overrideContext);
	    }
	  };
	
	  ArrayRepeatStrategy.prototype._inPlaceProcessItems = function _inPlaceProcessItems(repeat, items) {
	    var itemsLength = items.length;
	    var viewsLength = repeat.viewCount();
	
	    while (viewsLength > itemsLength) {
	      viewsLength--;
	      repeat.removeView(viewsLength, true);
	    }
	
	    var local = repeat.local;
	
	    for (var i = 0; i < viewsLength; i++) {
	      var view = repeat.view(i);
	      var last = i === itemsLength - 1;
	      var middle = i !== 0 && !last;
	
	      if (view.bindingContext[local] === items[i] && view.overrideContext.$middle === middle && view.overrideContext.$last === last) {
	        continue;
	      }
	
	      view.bindingContext[local] = items[i];
	      view.overrideContext.$middle = middle;
	      view.overrideContext.$last = last;
	      repeat.updateBindings(view);
	    }
	
	    for (var _i = viewsLength; _i < itemsLength; _i++) {
	      var overrideContext = (0, _repeatUtilities.createFullOverrideContext)(repeat, items[_i], _i, itemsLength);
	      repeat.addView(overrideContext.bindingContext, overrideContext);
	    }
	  };
	
	  ArrayRepeatStrategy.prototype.instanceMutated = function instanceMutated(repeat, array, splices) {
	    if (repeat.viewsRequireLifecycle) {
	      this._standardProcessInstanceMutated(repeat, array, splices);
	      return;
	    }
	    this._inPlaceProcessItems(repeat, array);
	  };
	
	  ArrayRepeatStrategy.prototype._standardProcessInstanceMutated = function _standardProcessInstanceMutated(repeat, array, splices) {
	    var _this2 = this;
	
	    if (repeat.__queuedSplices) {
	      for (var i = 0, ii = splices.length; i < ii; ++i) {
	        var _splices$i = splices[i];
	        var index = _splices$i.index;
	        var removed = _splices$i.removed;
	        var addedCount = _splices$i.addedCount;
	
	        (0, _aureliaBinding.mergeSplice)(repeat.__queuedSplices, index, removed, addedCount);
	      }
	
	      repeat.__array = array.slice(0);
	      return;
	    }
	
	    var maybePromise = this._runSplices(repeat, array.slice(0), splices);
	    if (maybePromise instanceof Promise) {
	      (function () {
	        var queuedSplices = repeat.__queuedSplices = [];
	
	        var runQueuedSplices = function runQueuedSplices() {
	          if (!queuedSplices.length) {
	            repeat.__queuedSplices = undefined;
	            repeat.__array = undefined;
	            return;
	          }
	
	          var nextPromise = _this2._runSplices(repeat, repeat.__array, queuedSplices) || Promise.resolve();
	          queuedSplices = repeat.__queuedSplices = [];
	          nextPromise.then(runQueuedSplices);
	        };
	
	        maybePromise.then(runQueuedSplices);
	      })();
	    }
	  };
	
	  ArrayRepeatStrategy.prototype._runSplices = function _runSplices(repeat, array, splices) {
	    var _this3 = this;
	
	    var removeDelta = 0;
	    var rmPromises = [];
	
	    for (var i = 0, ii = splices.length; i < ii; ++i) {
	      var splice = splices[i];
	      var removed = splice.removed;
	
	      for (var j = 0, jj = removed.length; j < jj; ++j) {
	        var viewOrPromise = repeat.removeView(splice.index + removeDelta + rmPromises.length, true);
	        if (viewOrPromise instanceof Promise) {
	          rmPromises.push(viewOrPromise);
	        }
	      }
	      removeDelta -= splice.addedCount;
	    }
	
	    if (rmPromises.length > 0) {
	      return Promise.all(rmPromises).then(function () {
	        var spliceIndexLow = _this3._handleAddedSplices(repeat, array, splices);
	        (0, _repeatUtilities.updateOverrideContexts)(repeat.views(), spliceIndexLow);
	      });
	    }
	
	    var spliceIndexLow = this._handleAddedSplices(repeat, array, splices);
	    (0, _repeatUtilities.updateOverrideContexts)(repeat.views(), spliceIndexLow);
	  };
	
	  ArrayRepeatStrategy.prototype._handleAddedSplices = function _handleAddedSplices(repeat, array, splices) {
	    var spliceIndex = void 0;
	    var spliceIndexLow = void 0;
	    var arrayLength = array.length;
	    for (var i = 0, ii = splices.length; i < ii; ++i) {
	      var splice = splices[i];
	      var addIndex = spliceIndex = splice.index;
	      var end = splice.index + splice.addedCount;
	
	      if (typeof spliceIndexLow === 'undefined' || spliceIndexLow === null || spliceIndexLow > splice.index) {
	        spliceIndexLow = spliceIndex;
	      }
	
	      for (; addIndex < end; ++addIndex) {
	        var overrideContext = (0, _repeatUtilities.createFullOverrideContext)(repeat, array[addIndex], addIndex, arrayLength);
	        repeat.insertView(addIndex, overrideContext.bindingContext, overrideContext);
	      }
	    }
	
	    return spliceIndexLow;
	  };
	
	  return ArrayRepeatStrategy;
	}();

/***/ },
/* 44 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.updateOverrideContexts = updateOverrideContexts;
	exports.createFullOverrideContext = createFullOverrideContext;
	exports.updateOverrideContext = updateOverrideContext;
	exports.getItemsSourceExpression = getItemsSourceExpression;
	exports.unwrapExpression = unwrapExpression;
	exports.isOneTime = isOneTime;
	exports.updateOneTimeBinding = updateOneTimeBinding;
	exports.indexOf = indexOf;
	
	var _aureliaBinding = __webpack_require__(20);
	
	var oneTime = _aureliaBinding.bindingMode.oneTime;
	
	function updateOverrideContexts(views, startIndex) {
	  var length = views.length;
	
	  if (startIndex > 0) {
	    startIndex = startIndex - 1;
	  }
	
	  for (; startIndex < length; ++startIndex) {
	    updateOverrideContext(views[startIndex].overrideContext, startIndex, length);
	  }
	}
	
	function createFullOverrideContext(repeat, data, index, length, key) {
	  var bindingContext = {};
	  var overrideContext = (0, _aureliaBinding.createOverrideContext)(bindingContext, repeat.scope.overrideContext);
	
	  if (typeof key !== 'undefined') {
	    bindingContext[repeat.key] = key;
	    bindingContext[repeat.value] = data;
	  } else {
	    bindingContext[repeat.local] = data;
	  }
	  updateOverrideContext(overrideContext, index, length);
	  return overrideContext;
	}
	
	function updateOverrideContext(overrideContext, index, length) {
	  var first = index === 0;
	  var last = index === length - 1;
	  var even = index % 2 === 0;
	
	  overrideContext.$index = index;
	  overrideContext.$first = first;
	  overrideContext.$last = last;
	  overrideContext.$middle = !(first || last);
	  overrideContext.$odd = !even;
	  overrideContext.$even = even;
	}
	
	function getItemsSourceExpression(instruction, attrName) {
	  return instruction.behaviorInstructions.filter(function (bi) {
	    return bi.originalAttrName === attrName;
	  })[0].attributes.items.sourceExpression;
	}
	
	function unwrapExpression(expression) {
	  var unwrapped = false;
	  while (expression instanceof _aureliaBinding.BindingBehavior) {
	    expression = expression.expression;
	  }
	  while (expression instanceof _aureliaBinding.ValueConverter) {
	    expression = expression.expression;
	    unwrapped = true;
	  }
	  return unwrapped ? expression : null;
	}
	
	function isOneTime(expression) {
	  while (expression instanceof _aureliaBinding.BindingBehavior) {
	    if (expression.name === 'oneTime') {
	      return true;
	    }
	    expression = expression.expression;
	  }
	  return false;
	}
	
	function updateOneTimeBinding(binding) {
	  if (binding.call && binding.mode === oneTime) {
	    binding.call(_aureliaBinding.sourceContext);
	  } else if (binding.updateOneTimeBindings) {
	    binding.updateOneTimeBindings();
	  }
	}
	
	function indexOf(array, item, matcher, startIndex) {
	  if (!matcher) {
	    return array.indexOf(item);
	  }
	  var length = array.length;
	  for (var index = startIndex || 0; index < length; index++) {
	    if (matcher(array[index], item)) {
	      return index;
	    }
	  }
	  return -1;
	}

/***/ },
/* 45 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.MapRepeatStrategy = undefined;
	
	var _repeatUtilities = __webpack_require__(44);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var MapRepeatStrategy = exports.MapRepeatStrategy = function () {
	  function MapRepeatStrategy() {
	    _classCallCheck(this, MapRepeatStrategy);
	  }
	
	  MapRepeatStrategy.prototype.getCollectionObserver = function getCollectionObserver(observerLocator, items) {
	    return observerLocator.getMapObserver(items);
	  };
	
	  MapRepeatStrategy.prototype.instanceChanged = function instanceChanged(repeat, items) {
	    var _this = this;
	
	    var removePromise = repeat.removeAllViews(true);
	    if (removePromise instanceof Promise) {
	      removePromise.then(function () {
	        return _this._standardProcessItems(repeat, items);
	      });
	      return;
	    }
	    this._standardProcessItems(repeat, items);
	  };
	
	  MapRepeatStrategy.prototype._standardProcessItems = function _standardProcessItems(repeat, items) {
	    var index = 0;
	    var overrideContext = void 0;
	
	    items.forEach(function (value, key) {
	      overrideContext = (0, _repeatUtilities.createFullOverrideContext)(repeat, value, index, items.size, key);
	      repeat.addView(overrideContext.bindingContext, overrideContext);
	      ++index;
	    });
	  };
	
	  MapRepeatStrategy.prototype.instanceMutated = function instanceMutated(repeat, map, records) {
	    var key = void 0;
	    var i = void 0;
	    var ii = void 0;
	    var overrideContext = void 0;
	    var removeIndex = void 0;
	    var record = void 0;
	    var rmPromises = [];
	    var viewOrPromise = void 0;
	
	    for (i = 0, ii = records.length; i < ii; ++i) {
	      record = records[i];
	      key = record.key;
	      switch (record.type) {
	        case 'update':
	          removeIndex = this._getViewIndexByKey(repeat, key);
	          viewOrPromise = repeat.removeView(removeIndex, true);
	          if (viewOrPromise instanceof Promise) {
	            rmPromises.push(viewOrPromise);
	          }
	          overrideContext = (0, _repeatUtilities.createFullOverrideContext)(repeat, map.get(key), removeIndex, map.size, key);
	          repeat.insertView(removeIndex, overrideContext.bindingContext, overrideContext);
	          break;
	        case 'add':
	          overrideContext = (0, _repeatUtilities.createFullOverrideContext)(repeat, map.get(key), map.size - 1, map.size, key);
	          repeat.insertView(map.size - 1, overrideContext.bindingContext, overrideContext);
	          break;
	        case 'delete':
	          if (record.oldValue === undefined) {
	            return;
	          }
	          removeIndex = this._getViewIndexByKey(repeat, key);
	          viewOrPromise = repeat.removeView(removeIndex, true);
	          if (viewOrPromise instanceof Promise) {
	            rmPromises.push(viewOrPromise);
	          }
	          break;
	        case 'clear':
	          repeat.removeAllViews(true);
	          break;
	        default:
	          continue;
	      }
	    }
	
	    if (rmPromises.length > 0) {
	      Promise.all(rmPromises).then(function () {
	        (0, _repeatUtilities.updateOverrideContexts)(repeat.views(), 0);
	      });
	    } else {
	      (0, _repeatUtilities.updateOverrideContexts)(repeat.views(), 0);
	    }
	  };
	
	  MapRepeatStrategy.prototype._getViewIndexByKey = function _getViewIndexByKey(repeat, key) {
	    var i = void 0;
	    var ii = void 0;
	    var child = void 0;
	
	    for (i = 0, ii = repeat.viewCount(); i < ii; ++i) {
	      child = repeat.view(i);
	      if (child.bindingContext[repeat.key] === key) {
	        return i;
	      }
	    }
	  };
	
	  return MapRepeatStrategy;
	}();

/***/ },
/* 46 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.SetRepeatStrategy = undefined;
	
	var _repeatUtilities = __webpack_require__(44);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var SetRepeatStrategy = exports.SetRepeatStrategy = function () {
	  function SetRepeatStrategy() {
	    _classCallCheck(this, SetRepeatStrategy);
	  }
	
	  SetRepeatStrategy.prototype.getCollectionObserver = function getCollectionObserver(observerLocator, items) {
	    return observerLocator.getSetObserver(items);
	  };
	
	  SetRepeatStrategy.prototype.instanceChanged = function instanceChanged(repeat, items) {
	    var _this = this;
	
	    var removePromise = repeat.removeAllViews(true);
	    if (removePromise instanceof Promise) {
	      removePromise.then(function () {
	        return _this._standardProcessItems(repeat, items);
	      });
	      return;
	    }
	    this._standardProcessItems(repeat, items);
	  };
	
	  SetRepeatStrategy.prototype._standardProcessItems = function _standardProcessItems(repeat, items) {
	    var index = 0;
	    var overrideContext = void 0;
	
	    items.forEach(function (value) {
	      overrideContext = (0, _repeatUtilities.createFullOverrideContext)(repeat, value, index, items.size);
	      repeat.addView(overrideContext.bindingContext, overrideContext);
	      ++index;
	    });
	  };
	
	  SetRepeatStrategy.prototype.instanceMutated = function instanceMutated(repeat, set, records) {
	    var value = void 0;
	    var i = void 0;
	    var ii = void 0;
	    var overrideContext = void 0;
	    var removeIndex = void 0;
	    var record = void 0;
	    var rmPromises = [];
	    var viewOrPromise = void 0;
	
	    for (i = 0, ii = records.length; i < ii; ++i) {
	      record = records[i];
	      value = record.value;
	      switch (record.type) {
	        case 'add':
	          overrideContext = (0, _repeatUtilities.createFullOverrideContext)(repeat, value, set.size - 1, set.size);
	          repeat.insertView(set.size - 1, overrideContext.bindingContext, overrideContext);
	          break;
	        case 'delete':
	          removeIndex = this._getViewIndexByValue(repeat, value);
	          viewOrPromise = repeat.removeView(removeIndex, true);
	          if (viewOrPromise instanceof Promise) {
	            rmPromises.push(viewOrPromise);
	          }
	          break;
	        case 'clear':
	          repeat.removeAllViews(true);
	          break;
	        default:
	          continue;
	      }
	    }
	
	    if (rmPromises.length > 0) {
	      Promise.all(rmPromises).then(function () {
	        (0, _repeatUtilities.updateOverrideContexts)(repeat.views(), 0);
	      });
	    } else {
	      (0, _repeatUtilities.updateOverrideContexts)(repeat.views(), 0);
	    }
	  };
	
	  SetRepeatStrategy.prototype._getViewIndexByValue = function _getViewIndexByValue(repeat, value) {
	    var i = void 0;
	    var ii = void 0;
	    var child = void 0;
	
	    for (i = 0, ii = repeat.viewCount(); i < ii; ++i) {
	      child = repeat.view(i);
	      if (child.bindingContext[repeat.local] === value) {
	        return i;
	      }
	    }
	  };
	
	  return SetRepeatStrategy;
	}();

/***/ },
/* 47 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.NumberRepeatStrategy = undefined;
	
	var _repeatUtilities = __webpack_require__(44);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var NumberRepeatStrategy = exports.NumberRepeatStrategy = function () {
	  function NumberRepeatStrategy() {
	    _classCallCheck(this, NumberRepeatStrategy);
	  }
	
	  NumberRepeatStrategy.prototype.getCollectionObserver = function getCollectionObserver() {
	    return null;
	  };
	
	  NumberRepeatStrategy.prototype.instanceChanged = function instanceChanged(repeat, value) {
	    var _this = this;
	
	    var removePromise = repeat.removeAllViews(true);
	    if (removePromise instanceof Promise) {
	      removePromise.then(function () {
	        return _this._standardProcessItems(repeat, value);
	      });
	      return;
	    }
	    this._standardProcessItems(repeat, value);
	  };
	
	  NumberRepeatStrategy.prototype._standardProcessItems = function _standardProcessItems(repeat, value) {
	    var childrenLength = repeat.viewCount();
	    var i = void 0;
	    var ii = void 0;
	    var overrideContext = void 0;
	    var viewsToRemove = void 0;
	
	    value = Math.floor(value);
	    viewsToRemove = childrenLength - value;
	
	    if (viewsToRemove > 0) {
	      if (viewsToRemove > childrenLength) {
	        viewsToRemove = childrenLength;
	      }
	
	      for (i = 0, ii = viewsToRemove; i < ii; ++i) {
	        repeat.removeView(childrenLength - (i + 1), true);
	      }
	
	      return;
	    }
	
	    for (i = childrenLength, ii = value; i < ii; ++i) {
	      overrideContext = (0, _repeatUtilities.createFullOverrideContext)(repeat, i, i, ii);
	      repeat.addView(overrideContext.bindingContext, overrideContext);
	    }
	
	    (0, _repeatUtilities.updateOverrideContexts)(repeat.views(), 0);
	  };
	
	  return NumberRepeatStrategy;
	}();

/***/ },
/* 48 */
/***/ function(module, exports) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.viewsRequireLifecycle = viewsRequireLifecycle;
	var lifecycleOptionalBehaviors = exports.lifecycleOptionalBehaviors = ['focus', 'if', 'repeat', 'show', 'with'];
	
	function behaviorRequiresLifecycle(instruction) {
	  var t = instruction.type;
	  var name = t.elementName !== null ? t.elementName : t.attributeName;
	  return lifecycleOptionalBehaviors.indexOf(name) === -1 && (t.handlesAttached || t.handlesBind || t.handlesCreated || t.handlesDetached || t.handlesUnbind) || t.viewFactory && viewsRequireLifecycle(t.viewFactory) || instruction.viewFactory && viewsRequireLifecycle(instruction.viewFactory);
	}
	
	function targetRequiresLifecycle(instruction) {
	  var behaviors = instruction.behaviorInstructions;
	  if (behaviors) {
	    var i = behaviors.length;
	    while (i--) {
	      if (behaviorRequiresLifecycle(behaviors[i])) {
	        return true;
	      }
	    }
	  }
	
	  return instruction.viewFactory && viewsRequireLifecycle(instruction.viewFactory);
	}
	
	function viewsRequireLifecycle(viewFactory) {
	  if ('_viewsRequireLifecycle' in viewFactory) {
	    return viewFactory._viewsRequireLifecycle;
	  }
	
	  viewFactory._viewsRequireLifecycle = false;
	
	  if (viewFactory.viewFactory) {
	    viewFactory._viewsRequireLifecycle = viewsRequireLifecycle(viewFactory.viewFactory);
	    return viewFactory._viewsRequireLifecycle;
	  }
	
	  if (viewFactory.template.querySelector('.au-animate')) {
	    viewFactory._viewsRequireLifecycle = true;
	    return true;
	  }
	
	  for (var id in viewFactory.instructions) {
	    if (targetRequiresLifecycle(viewFactory.instructions[id])) {
	      viewFactory._viewsRequireLifecycle = true;
	      return true;
	    }
	  }
	
	  viewFactory._viewsRequireLifecycle = false;
	  return false;
	}

/***/ },
/* 49 */
/***/ function(module, exports) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var AbstractRepeater = exports.AbstractRepeater = function () {
	  function AbstractRepeater(options) {
	    _classCallCheck(this, AbstractRepeater);
	
	    Object.assign(this, {
	      local: 'items',
	      viewsRequireLifecycle: true
	    }, options);
	  }
	
	  AbstractRepeater.prototype.viewCount = function viewCount() {
	    throw new Error('subclass must implement `viewCount`');
	  };
	
	  AbstractRepeater.prototype.views = function views() {
	    throw new Error('subclass must implement `views`');
	  };
	
	  AbstractRepeater.prototype.view = function view(index) {
	    throw new Error('subclass must implement `view`');
	  };
	
	  AbstractRepeater.prototype.matcher = function matcher() {
	    throw new Error('subclass must implement `matcher`');
	  };
	
	  AbstractRepeater.prototype.addView = function addView(bindingContext, overrideContext) {
	    throw new Error('subclass must implement `addView`');
	  };
	
	  AbstractRepeater.prototype.insertView = function insertView(index, bindingContext, overrideContext) {
	    throw new Error('subclass must implement `insertView`');
	  };
	
	  AbstractRepeater.prototype.moveView = function moveView(sourceIndex, targetIndex) {
	    throw new Error('subclass must implement `moveView`');
	  };
	
	  AbstractRepeater.prototype.removeAllViews = function removeAllViews(returnToCache, skipAnimation) {
	    throw new Error('subclass must implement `removeAllViews`');
	  };
	
	  AbstractRepeater.prototype.removeViews = function removeViews(viewsToRemove, returnToCache, skipAnimation) {
	    throw new Error('subclass must implement `removeView`');
	  };
	
	  AbstractRepeater.prototype.removeView = function removeView(index, returnToCache, skipAnimation) {
	    throw new Error('subclass must implement `removeView`');
	  };
	
	  AbstractRepeater.prototype.updateBindings = function updateBindings(view) {
	    throw new Error('subclass must implement `updateBindings`');
	  };
	
	  return AbstractRepeater;
	}();

/***/ },
/* 50 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.Show = undefined;
	
	var _dec, _dec2, _class;
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _aureliaPal = __webpack_require__(4);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var Show = exports.Show = (_dec = (0, _aureliaTemplating.customAttribute)('show'), _dec2 = (0, _aureliaDependencyInjection.inject)(_aureliaPal.DOM.Element, _aureliaTemplating.Animator), _dec(_class = _dec2(_class = function () {
	  function Show(element, animator) {
	    _classCallCheck(this, Show);
	
	    this.element = element;
	    this.animator = animator;
	  }
	
	  Show.prototype.valueChanged = function valueChanged(newValue) {
	    if (newValue) {
	      this.animator.removeClass(this.element, 'aurelia-hide');
	    } else {
	      this.animator.addClass(this.element, 'aurelia-hide');
	    }
	  };
	
	  Show.prototype.bind = function bind(bindingContext) {
	    this.valueChanged(this.value);
	  };
	
	  return Show;
	}()) || _class) || _class);

/***/ },
/* 51 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.Hide = undefined;
	
	var _dec, _dec2, _class;
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _aureliaPal = __webpack_require__(4);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var Hide = exports.Hide = (_dec = (0, _aureliaTemplating.customAttribute)('hide'), _dec2 = (0, _aureliaDependencyInjection.inject)(_aureliaPal.DOM.Element, _aureliaTemplating.Animator), _dec(_class = _dec2(_class = function () {
	  function Hide(element, animator) {
	    _classCallCheck(this, Hide);
	
	    this.element = element;
	    this.animator = animator;
	  }
	
	  Hide.prototype.valueChanged = function valueChanged(newValue) {
	    if (newValue) {
	      this.animator.addClass(this.element, 'aurelia-hide');
	    } else {
	      this.animator.removeClass(this.element, 'aurelia-hide');
	    }
	  };
	
	  Hide.prototype.bind = function bind(bindingContext) {
	    this.valueChanged(this.value);
	  };
	
	  return Hide;
	}()) || _class) || _class);

/***/ },
/* 52 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.SanitizeHTMLValueConverter = undefined;
	
	var _dec, _dec2, _class;
	
	var _aureliaBinding = __webpack_require__(20);
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	var _htmlSanitizer = __webpack_require__(53);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var SanitizeHTMLValueConverter = exports.SanitizeHTMLValueConverter = (_dec = (0, _aureliaBinding.valueConverter)('sanitizeHTML'), _dec2 = (0, _aureliaDependencyInjection.inject)(_htmlSanitizer.HTMLSanitizer), _dec(_class = _dec2(_class = function () {
	  function SanitizeHTMLValueConverter(sanitizer) {
	    _classCallCheck(this, SanitizeHTMLValueConverter);
	
	    this.sanitizer = sanitizer;
	  }
	
	  SanitizeHTMLValueConverter.prototype.toView = function toView(untrustedMarkup) {
	    if (untrustedMarkup === null || untrustedMarkup === undefined) {
	      return null;
	    }
	
	    return this.sanitizer.sanitize(untrustedMarkup);
	  };
	
	  return SanitizeHTMLValueConverter;
	}()) || _class) || _class);

/***/ },
/* 53 */
/***/ function(module, exports) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var SCRIPT_REGEX = /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;
	
	var HTMLSanitizer = exports.HTMLSanitizer = function () {
	  function HTMLSanitizer() {
	    _classCallCheck(this, HTMLSanitizer);
	  }
	
	  HTMLSanitizer.prototype.sanitize = function sanitize(input) {
	    return input.replace(SCRIPT_REGEX, '');
	  };
	
	  return HTMLSanitizer;
	}();

/***/ },
/* 54 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.Replaceable = undefined;
	
	var _dec, _dec2, _class;
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	var _aureliaTemplating = __webpack_require__(24);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var Replaceable = exports.Replaceable = (_dec = (0, _aureliaTemplating.customAttribute)('replaceable'), _dec2 = (0, _aureliaDependencyInjection.inject)(_aureliaTemplating.BoundViewFactory, _aureliaTemplating.ViewSlot), _dec(_class = (0, _aureliaTemplating.templateController)(_class = _dec2(_class = function () {
	  function Replaceable(viewFactory, viewSlot) {
	    _classCallCheck(this, Replaceable);
	
	    this.viewFactory = viewFactory;
	    this.viewSlot = viewSlot;
	    this.view = null;
	  }
	
	  Replaceable.prototype.bind = function bind(bindingContext, overrideContext) {
	    if (this.view === null) {
	      this.view = this.viewFactory.create();
	      this.viewSlot.add(this.view);
	    }
	
	    this.view.bind(bindingContext, overrideContext);
	  };
	
	  Replaceable.prototype.unbind = function unbind() {
	    this.view.unbind();
	  };
	
	  return Replaceable;
	}()) || _class) || _class) || _class);

/***/ },
/* 55 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.Focus = undefined;
	
	var _dec, _dec2, _class;
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _aureliaBinding = __webpack_require__(20);
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	var _aureliaTaskQueue = __webpack_require__(21);
	
	var _aureliaPal = __webpack_require__(4);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var Focus = exports.Focus = (_dec = (0, _aureliaTemplating.customAttribute)('focus', _aureliaBinding.bindingMode.twoWay), _dec2 = (0, _aureliaDependencyInjection.inject)(_aureliaPal.DOM.Element, _aureliaTaskQueue.TaskQueue), _dec(_class = _dec2(_class = function () {
	  function Focus(element, taskQueue) {
	    var _this = this;
	
	    _classCallCheck(this, Focus);
	
	    this.element = element;
	    this.taskQueue = taskQueue;
	    this.isAttached = false;
	    this.needsApply = false;
	
	    this.focusListener = function (e) {
	      _this.value = true;
	    };
	    this.blurListener = function (e) {
	      if (_aureliaPal.DOM.activeElement !== _this.element) {
	        _this.value = false;
	      }
	    };
	  }
	
	  Focus.prototype.valueChanged = function valueChanged(newValue) {
	    if (this.isAttached) {
	      this._apply();
	    } else {
	      this.needsApply = true;
	    }
	  };
	
	  Focus.prototype._apply = function _apply() {
	    var _this2 = this;
	
	    if (this.value) {
	      this.taskQueue.queueMicroTask(function () {
	        if (_this2.value) {
	          _this2.element.focus();
	        }
	      });
	    } else {
	      this.element.blur();
	    }
	  };
	
	  Focus.prototype.attached = function attached() {
	    this.isAttached = true;
	    if (this.needsApply) {
	      this.needsApply = false;
	      this._apply();
	    }
	    this.element.addEventListener('focus', this.focusListener);
	    this.element.addEventListener('blur', this.blurListener);
	  };
	
	  Focus.prototype.detached = function detached() {
	    this.isAttached = false;
	    this.element.removeEventListener('focus', this.focusListener);
	    this.element.removeEventListener('blur', this.blurListener);
	  };
	
	  return Focus;
	}()) || _class) || _class);

/***/ },
/* 56 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.CompileSpy = undefined;
	
	var _dec, _dec2, _class;
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	var _aureliaLogging = __webpack_require__(14);
	
	var LogManager = _interopRequireWildcard(_aureliaLogging);
	
	var _aureliaPal = __webpack_require__(4);
	
	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var CompileSpy = exports.CompileSpy = (_dec = (0, _aureliaTemplating.customAttribute)('compile-spy'), _dec2 = (0, _aureliaDependencyInjection.inject)(_aureliaPal.DOM.Element, _aureliaTemplating.TargetInstruction), _dec(_class = _dec2(_class = function CompileSpy(element, instruction) {
	  _classCallCheck(this, CompileSpy);
	
	  LogManager.getLogger('compile-spy').info(element, instruction);
	}) || _class) || _class);

/***/ },
/* 57 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.ViewSpy = undefined;
	
	var _dec, _class;
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _aureliaLogging = __webpack_require__(14);
	
	var LogManager = _interopRequireWildcard(_aureliaLogging);
	
	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var ViewSpy = exports.ViewSpy = (_dec = (0, _aureliaTemplating.customAttribute)('view-spy'), _dec(_class = function () {
	  function ViewSpy() {
	    _classCallCheck(this, ViewSpy);
	
	    this.logger = LogManager.getLogger('view-spy');
	  }
	
	  ViewSpy.prototype._log = function _log(lifecycleName, context) {
	    if (!this.value && lifecycleName === 'created') {
	      this.logger.info(lifecycleName, this.view);
	    } else if (this.value && this.value.indexOf(lifecycleName) !== -1) {
	      this.logger.info(lifecycleName, this.view, context);
	    }
	  };
	
	  ViewSpy.prototype.created = function created(view) {
	    this.view = view;
	    this._log('created');
	  };
	
	  ViewSpy.prototype.bind = function bind(bindingContext) {
	    this._log('bind', bindingContext);
	  };
	
	  ViewSpy.prototype.attached = function attached() {
	    this._log('attached');
	  };
	
	  ViewSpy.prototype.detached = function detached() {
	    this._log('detached');
	  };
	
	  ViewSpy.prototype.unbind = function unbind() {
	    this._log('unbind');
	  };
	
	  return ViewSpy;
	}()) || _class);

/***/ },
/* 58 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports._createCSSResource = _createCSSResource;
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _aureliaLoader = __webpack_require__(8);
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	var _aureliaPath = __webpack_require__(9);
	
	var _aureliaPal = __webpack_require__(4);
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var cssUrlMatcher = /url\((?!['"]data)([^)]+)\)/gi;
	
	function fixupCSSUrls(address, css) {
	  if (typeof css !== 'string') {
	    throw new Error('Failed loading required CSS file: ' + address);
	  }
	  return css.replace(cssUrlMatcher, function (match, p1) {
	    var quote = p1.charAt(0);
	    if (quote === '\'' || quote === '"') {
	      p1 = p1.substr(1, p1.length - 2);
	    }
	    return 'url(\'' + (0, _aureliaPath.relativeToFile)(p1, address) + '\')';
	  });
	}
	
	var CSSResource = function () {
	  function CSSResource(address) {
	    _classCallCheck(this, CSSResource);
	
	    this.address = address;
	    this._global = null;
	    this._scoped = null;
	  }
	
	  CSSResource.prototype.initialize = function initialize(container, target) {
	    this._global = new target('global');
	    this._scoped = new target('scoped');
	  };
	
	  CSSResource.prototype.register = function register(registry, name) {
	    registry.registerViewEngineHooks(name === 'scoped' ? this._scoped : this._global);
	  };
	
	  CSSResource.prototype.load = function load(container) {
	    var _this = this;
	
	    return container.get(_aureliaLoader.Loader).loadText(this.address).catch(function (err) {
	      return null;
	    }).then(function (text) {
	      text = fixupCSSUrls(_this.address, text);
	      _this._global.css = text;
	      _this._scoped.css = text;
	    });
	  };
	
	  return CSSResource;
	}();
	
	var CSSViewEngineHooks = function () {
	  function CSSViewEngineHooks(mode) {
	    _classCallCheck(this, CSSViewEngineHooks);
	
	    this.mode = mode;
	    this.css = null;
	    this._alreadyGloballyInjected = false;
	  }
	
	  CSSViewEngineHooks.prototype.beforeCompile = function beforeCompile(content, resources, instruction) {
	    if (this.mode === 'scoped') {
	      if (instruction.targetShadowDOM) {
	        _aureliaPal.DOM.injectStyles(this.css, content, true);
	      } else if (_aureliaPal.FEATURE.scopedCSS) {
	        var styleNode = _aureliaPal.DOM.injectStyles(this.css, content, true);
	        styleNode.setAttribute('scoped', 'scoped');
	      } else if (!this._alreadyGloballyInjected) {
	        _aureliaPal.DOM.injectStyles(this.css);
	        this._alreadyGloballyInjected = true;
	      }
	    } else if (!this._alreadyGloballyInjected) {
	      _aureliaPal.DOM.injectStyles(this.css);
	      this._alreadyGloballyInjected = true;
	    }
	  };
	
	  return CSSViewEngineHooks;
	}();
	
	function _createCSSResource(address) {
	  var _dec, _class;
	
	  var ViewCSS = (_dec = (0, _aureliaTemplating.resource)(new CSSResource(address)), _dec(_class = function (_CSSViewEngineHooks) {
	    _inherits(ViewCSS, _CSSViewEngineHooks);
	
	    function ViewCSS() {
	      _classCallCheck(this, ViewCSS);
	
	      return _possibleConstructorReturn(this, _CSSViewEngineHooks.apply(this, arguments));
	    }
	
	    return ViewCSS;
	  }(CSSViewEngineHooks)) || _class);
	
	  return ViewCSS;
	}

/***/ },
/* 59 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.TwoWayBindingBehavior = exports.OneWayBindingBehavior = exports.OneTimeBindingBehavior = undefined;
	
	var _dec, _class, _dec2, _class2, _dec3, _class3;
	
	var _aureliaBinding = __webpack_require__(20);
	
	var _aureliaMetadata = __webpack_require__(7);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var modeBindingBehavior = {
	  bind: function bind(binding, source, lookupFunctions) {
	    binding.originalMode = binding.mode;
	    binding.mode = this.mode;
	  },
	  unbind: function unbind(binding, source) {
	    binding.mode = binding.originalMode;
	    binding.originalMode = null;
	  }
	};
	
	var OneTimeBindingBehavior = exports.OneTimeBindingBehavior = (_dec = (0, _aureliaMetadata.mixin)(modeBindingBehavior), _dec(_class = function OneTimeBindingBehavior() {
	  _classCallCheck(this, OneTimeBindingBehavior);
	
	  this.mode = _aureliaBinding.bindingMode.oneTime;
	}) || _class);
	var OneWayBindingBehavior = exports.OneWayBindingBehavior = (_dec2 = (0, _aureliaMetadata.mixin)(modeBindingBehavior), _dec2(_class2 = function OneWayBindingBehavior() {
	  _classCallCheck(this, OneWayBindingBehavior);
	
	  this.mode = _aureliaBinding.bindingMode.oneWay;
	}) || _class2);
	var TwoWayBindingBehavior = exports.TwoWayBindingBehavior = (_dec3 = (0, _aureliaMetadata.mixin)(modeBindingBehavior), _dec3(_class3 = function TwoWayBindingBehavior() {
	  _classCallCheck(this, TwoWayBindingBehavior);
	
	  this.mode = _aureliaBinding.bindingMode.twoWay;
	}) || _class3);

/***/ },
/* 60 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.ThrottleBindingBehavior = undefined;
	
	var _aureliaBinding = __webpack_require__(20);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function throttle(newValue) {
	  var _this = this;
	
	  var state = this.throttleState;
	  var elapsed = +new Date() - state.last;
	  if (elapsed >= state.delay) {
	    clearTimeout(state.timeoutId);
	    state.timeoutId = null;
	    state.last = +new Date();
	    this.throttledMethod(newValue);
	    return;
	  }
	  state.newValue = newValue;
	  if (state.timeoutId === null) {
	    state.timeoutId = setTimeout(function () {
	      state.timeoutId = null;
	      state.last = +new Date();
	      _this.throttledMethod(state.newValue);
	    }, state.delay - elapsed);
	  }
	}
	
	var ThrottleBindingBehavior = exports.ThrottleBindingBehavior = function () {
	  function ThrottleBindingBehavior() {
	    _classCallCheck(this, ThrottleBindingBehavior);
	  }
	
	  ThrottleBindingBehavior.prototype.bind = function bind(binding, source) {
	    var delay = arguments.length <= 2 || arguments[2] === undefined ? 200 : arguments[2];
	
	    var methodToThrottle = 'updateTarget';
	    if (binding.callSource) {
	      methodToThrottle = 'callSource';
	    } else if (binding.updateSource && binding.mode === _aureliaBinding.bindingMode.twoWay) {
	        methodToThrottle = 'updateSource';
	      }
	
	    binding.throttledMethod = binding[methodToThrottle];
	    binding.throttledMethod.originalName = methodToThrottle;
	
	    binding[methodToThrottle] = throttle;
	
	    binding.throttleState = {
	      delay: delay,
	      last: 0,
	      timeoutId: null
	    };
	  };
	
	  ThrottleBindingBehavior.prototype.unbind = function unbind(binding, source) {
	    var methodToRestore = binding.throttledMethod.originalName;
	    binding[methodToRestore] = binding.throttledMethod;
	    binding.throttledMethod = null;
	    clearTimeout(binding.throttleState.timeoutId);
	    binding.throttleState = null;
	  };
	
	  return ThrottleBindingBehavior;
	}();

/***/ },
/* 61 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.DebounceBindingBehavior = undefined;
	
	var _aureliaBinding = __webpack_require__(20);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function debounce(newValue) {
	  var _this = this;
	
	  var state = this.debounceState;
	  if (state.immediate) {
	    state.immediate = false;
	    this.debouncedMethod(newValue);
	    return;
	  }
	  clearTimeout(state.timeoutId);
	  state.timeoutId = setTimeout(function () {
	    return _this.debouncedMethod(newValue);
	  }, state.delay);
	}
	
	var DebounceBindingBehavior = exports.DebounceBindingBehavior = function () {
	  function DebounceBindingBehavior() {
	    _classCallCheck(this, DebounceBindingBehavior);
	  }
	
	  DebounceBindingBehavior.prototype.bind = function bind(binding, source) {
	    var delay = arguments.length <= 2 || arguments[2] === undefined ? 200 : arguments[2];
	
	    var methodToDebounce = 'updateTarget';
	    if (binding.callSource) {
	      methodToDebounce = 'callSource';
	    } else if (binding.updateSource && binding.mode === _aureliaBinding.bindingMode.twoWay) {
	        methodToDebounce = 'updateSource';
	      }
	
	    binding.debouncedMethod = binding[methodToDebounce];
	    binding.debouncedMethod.originalName = methodToDebounce;
	
	    binding[methodToDebounce] = debounce;
	
	    binding.debounceState = {
	      delay: delay,
	      timeoutId: null,
	      immediate: methodToDebounce === 'updateTarget' };
	  };
	
	  DebounceBindingBehavior.prototype.unbind = function unbind(binding, source) {
	    var methodToRestore = binding.debouncedMethod.originalName;
	    binding[methodToRestore] = binding.debouncedMethod;
	    binding.debouncedMethod = null;
	    clearTimeout(binding.debounceState.timeoutId);
	    binding.debounceState = null;
	  };
	
	  return DebounceBindingBehavior;
	}();

/***/ },
/* 62 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.SignalBindingBehavior = undefined;
	
	var _bindingSignaler = __webpack_require__(63);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var SignalBindingBehavior = exports.SignalBindingBehavior = function () {
	  SignalBindingBehavior.inject = function inject() {
	    return [_bindingSignaler.BindingSignaler];
	  };
	
	  function SignalBindingBehavior(bindingSignaler) {
	    _classCallCheck(this, SignalBindingBehavior);
	
	    this.signals = bindingSignaler.signals;
	  }
	
	  SignalBindingBehavior.prototype.bind = function bind(binding, source) {
	    if (!binding.updateTarget) {
	      throw new Error('Only property bindings and string interpolation bindings can be signaled.  Trigger, delegate and call bindings cannot be signaled.');
	    }
	    if (arguments.length === 3) {
	      var name = arguments[2];
	      var bindings = this.signals[name] || (this.signals[name] = []);
	      bindings.push(binding);
	      binding.signalName = name;
	    } else if (arguments.length > 3) {
	      var names = Array.prototype.slice.call(arguments, 2);
	      var i = names.length;
	      while (i--) {
	        var _name = names[i];
	        var _bindings = this.signals[_name] || (this.signals[_name] = []);
	        _bindings.push(binding);
	      }
	      binding.signalName = names;
	    } else {
	      throw new Error('Signal name is required.');
	    }
	  };
	
	  SignalBindingBehavior.prototype.unbind = function unbind(binding, source) {
	    var name = binding.signalName;
	    binding.signalName = null;
	    if (Array.isArray(name)) {
	      var names = name;
	      var i = names.length;
	      while (i--) {
	        var n = names[i];
	        var bindings = this.signals[n];
	        bindings.splice(bindings.indexOf(binding), 1);
	      }
	    } else {
	      var _bindings2 = this.signals[name];
	      _bindings2.splice(_bindings2.indexOf(binding), 1);
	    }
	  };
	
	  return SignalBindingBehavior;
	}();

/***/ },
/* 63 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.BindingSignaler = undefined;
	
	var _aureliaBinding = __webpack_require__(20);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var BindingSignaler = exports.BindingSignaler = function () {
	  function BindingSignaler() {
	    _classCallCheck(this, BindingSignaler);
	
	    this.signals = {};
	  }
	
	  BindingSignaler.prototype.signal = function signal(name) {
	    var bindings = this.signals[name];
	    if (!bindings) {
	      return;
	    }
	    var i = bindings.length;
	    while (i--) {
	      bindings[i].call(_aureliaBinding.sourceContext);
	    }
	  };
	
	  return BindingSignaler;
	}();

/***/ },
/* 64 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.UpdateTriggerBindingBehavior = undefined;
	
	var _class, _temp;
	
	var _aureliaBinding = __webpack_require__(20);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var eventNamesRequired = 'The updateTrigger binding behavior requires at least one event name argument: eg <input value.bind="firstName & updateTrigger:\'blur\'">';
	var notApplicableMessage = 'The updateTrigger binding behavior can only be applied to two-way bindings on input/select elements.';
	
	var UpdateTriggerBindingBehavior = exports.UpdateTriggerBindingBehavior = (_temp = _class = function () {
	  function UpdateTriggerBindingBehavior(eventManager) {
	    _classCallCheck(this, UpdateTriggerBindingBehavior);
	
	    this.eventManager = eventManager;
	  }
	
	  UpdateTriggerBindingBehavior.prototype.bind = function bind(binding, source) {
	    for (var _len = arguments.length, events = Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {
	      events[_key - 2] = arguments[_key];
	    }
	
	    if (events.length === 0) {
	      throw new Error(eventNamesRequired);
	    }
	    if (binding.mode !== _aureliaBinding.bindingMode.twoWay) {
	      throw new Error(notApplicableMessage);
	    }
	
	    var targetObserver = binding.observerLocator.getObserver(binding.target, binding.targetProperty);
	    if (!targetObserver.handler) {
	      throw new Error(notApplicableMessage);
	    }
	    binding.targetObserver = targetObserver;
	
	    targetObserver.originalHandler = binding.targetObserver.handler;
	
	    var handler = this.eventManager.createElementHandler(events);
	    targetObserver.handler = handler;
	  };
	
	  UpdateTriggerBindingBehavior.prototype.unbind = function unbind(binding, source) {
	    binding.targetObserver.handler = binding.targetObserver.originalHandler;
	    binding.targetObserver.originalHandler = null;
	  };
	
	  return UpdateTriggerBindingBehavior;
	}(), _class.inject = [_aureliaBinding.EventManager], _temp);

/***/ },
/* 65 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.getElementName = getElementName;
	exports.configure = configure;
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _dynamicElement = __webpack_require__(66);
	
	function getElementName(address) {
	  return (/([^\/^\?]+)\.html/i.exec(address)[1].toLowerCase()
	  );
	}
	
	function configure(config) {
	  var viewEngine = config.container.get(_aureliaTemplating.ViewEngine);
	  var loader = config.aurelia.loader;
	
	  viewEngine.addResourcePlugin('.html', {
	    'fetch': function fetch(address) {
	      return loader.loadTemplate(address).then(function (registryEntry) {
	        var _ref;
	
	        var bindable = registryEntry.template.getAttribute('bindable');
	        var elementName = getElementName(address);
	
	        if (bindable) {
	          bindable = bindable.split(',').map(function (x) {
	            return x.trim();
	          });
	          registryEntry.template.removeAttribute('bindable');
	        } else {
	          bindable = [];
	        }
	
	        return _ref = {}, _ref[elementName] = (0, _dynamicElement._createDynamicElement)(elementName, address, bindable), _ref;
	      });
	    }
	  });
	}

/***/ },
/* 66 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports._createDynamicElement = _createDynamicElement;
	
	var _aureliaTemplating = __webpack_require__(24);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _createDynamicElement(name, viewUrl, bindableNames) {
	  var _dec, _dec2, _class;
	
	  var DynamicElement = (_dec = (0, _aureliaTemplating.customElement)(name), _dec2 = (0, _aureliaTemplating.useView)(viewUrl), _dec(_class = _dec2(_class = function () {
	    function DynamicElement() {
	      _classCallCheck(this, DynamicElement);
	    }
	
	    DynamicElement.prototype.bind = function bind(bindingContext) {
	      this.$parent = bindingContext;
	    };
	
	    return DynamicElement;
	  }()) || _class) || _class);
	
	  for (var i = 0, ii = bindableNames.length; i < ii; ++i) {
	    (0, _aureliaTemplating.bindable)(bindableNames[i])(DynamicElement);
	  }
	  return DynamicElement;
	}

/***/ },
/* 67 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.configure = exports.RouteHref = exports.RouterView = exports.TemplatingRouteLoader = undefined;
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _routeLoader = __webpack_require__(68);
	
	var _routerView = __webpack_require__(69);
	
	var _routeHref = __webpack_require__(70);
	
	function configure(config) {
	  config.singleton(_aureliaRouter.RouteLoader, _routeLoader.TemplatingRouteLoader).singleton(_aureliaRouter.Router, _aureliaRouter.AppRouter).globalResources('./router-view', './route-href');
	
	  config.container.registerAlias(_aureliaRouter.Router, _aureliaRouter.AppRouter);
	}
	
	exports.TemplatingRouteLoader = _routeLoader.TemplatingRouteLoader;
	exports.RouterView = _routerView.RouterView;
	exports.RouteHref = _routeHref.RouteHref;
	exports.configure = configure;

/***/ },
/* 68 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.TemplatingRouteLoader = undefined;
	
	var _dec, _class;
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaPath = __webpack_require__(9);
	
	var _aureliaMetadata = __webpack_require__(7);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var TemplatingRouteLoader = exports.TemplatingRouteLoader = (_dec = (0, _aureliaDependencyInjection.inject)(_aureliaTemplating.CompositionEngine), _dec(_class = function (_RouteLoader) {
	  _inherits(TemplatingRouteLoader, _RouteLoader);
	
	  function TemplatingRouteLoader(compositionEngine) {
	    _classCallCheck(this, TemplatingRouteLoader);
	
	    var _this = _possibleConstructorReturn(this, _RouteLoader.call(this));
	
	    _this.compositionEngine = compositionEngine;
	    return _this;
	  }
	
	  TemplatingRouteLoader.prototype.loadRoute = function loadRoute(router, config) {
	    var childContainer = router.container.createChild();
	    var instruction = {
	      viewModel: (0, _aureliaPath.relativeToFile)(config.moduleId, _aureliaMetadata.Origin.get(router.container.viewModel.constructor).moduleId),
	      childContainer: childContainer,
	      view: config.view || config.viewStrategy,
	      router: router
	    };
	
	    childContainer.getChildRouter = function () {
	      var childRouter = void 0;
	
	      childContainer.registerHandler(_aureliaRouter.Router, function (c) {
	        return childRouter || (childRouter = router.createChild(childContainer));
	      });
	
	      return childContainer.get(_aureliaRouter.Router);
	    };
	
	    return this.compositionEngine.ensureViewModel(instruction);
	  };
	
	  return TemplatingRouteLoader;
	}(_aureliaRouter.RouteLoader)) || _class);

/***/ },
/* 69 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.RouterView = undefined;
	
	var _dec, _dec2, _class, _desc, _value, _class2, _descriptor;
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaMetadata = __webpack_require__(7);
	
	var _aureliaPal = __webpack_require__(4);
	
	function _initDefineProp(target, property, descriptor, context) {
	  if (!descriptor) return;
	  Object.defineProperty(target, property, {
	    enumerable: descriptor.enumerable,
	    configurable: descriptor.configurable,
	    writable: descriptor.writable,
	    value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
	  });
	}
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
	  var desc = {};
	  Object['ke' + 'ys'](descriptor).forEach(function (key) {
	    desc[key] = descriptor[key];
	  });
	  desc.enumerable = !!desc.enumerable;
	  desc.configurable = !!desc.configurable;
	
	  if ('value' in desc || desc.initializer) {
	    desc.writable = true;
	  }
	
	  desc = decorators.slice().reverse().reduce(function (desc, decorator) {
	    return decorator(target, property, desc) || desc;
	  }, desc);
	
	  if (context && desc.initializer !== void 0) {
	    desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
	    desc.initializer = undefined;
	  }
	
	  if (desc.initializer === void 0) {
	    Object['define' + 'Property'](target, property, desc);
	    desc = null;
	  }
	
	  return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
	  throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var SwapStrategies = function () {
	  function SwapStrategies() {
	    _classCallCheck(this, SwapStrategies);
	  }
	
	  SwapStrategies.prototype.before = function before(viewSlot, previousView, callback) {
	    var promise = Promise.resolve(callback());
	
	    if (previousView !== undefined) {
	      return promise.then(function () {
	        return viewSlot.remove(previousView, true);
	      });
	    }
	
	    return promise;
	  };
	
	  SwapStrategies.prototype.with = function _with(viewSlot, previousView, callback) {
	    var promise = Promise.resolve(callback());
	
	    if (previousView !== undefined) {
	      return Promise.all([viewSlot.remove(previousView, true), promise]);
	    }
	
	    return promise;
	  };
	
	  SwapStrategies.prototype.after = function after(viewSlot, previousView, callback) {
	    return Promise.resolve(viewSlot.removeAll(true)).then(callback);
	  };
	
	  return SwapStrategies;
	}();
	
	var swapStrategies = new SwapStrategies();
	
	var RouterView = exports.RouterView = (_dec = (0, _aureliaTemplating.customElement)('router-view'), _dec2 = (0, _aureliaDependencyInjection.inject)(_aureliaPal.DOM.Element, _aureliaDependencyInjection.Container, _aureliaTemplating.ViewSlot, _aureliaRouter.Router, _aureliaTemplating.ViewLocator, _aureliaTemplating.CompositionTransaction), _dec(_class = (0, _aureliaTemplating.noView)(_class = _dec2(_class = (_class2 = function () {
	  function RouterView(element, container, viewSlot, router, viewLocator, compositionTransaction) {
	    _classCallCheck(this, RouterView);
	
	    _initDefineProp(this, 'swapOrder', _descriptor, this);
	
	    this.element = element;
	    this.container = container;
	    this.viewSlot = viewSlot;
	    this.router = router;
	    this.viewLocator = viewLocator;
	    this.compositionTransaction = compositionTransaction;
	    this.router.registerViewPort(this, this.element.getAttribute('name'));
	
	    if (!('initialComposition' in compositionTransaction)) {
	      compositionTransaction.initialComposition = true;
	      this.compositionTransactionNotifier = compositionTransaction.enlist();
	    }
	  }
	
	  RouterView.prototype.created = function created(owningView) {
	    this.owningView = owningView;
	  };
	
	  RouterView.prototype.bind = function bind(bindingContext, overrideContext) {
	    this.container.viewModel = bindingContext;
	    this.overrideContext = overrideContext;
	  };
	
	  RouterView.prototype.process = function process(viewPortInstruction, waitToSwap) {
	    var _this = this;
	
	    var component = viewPortInstruction.component;
	    var childContainer = component.childContainer;
	    var viewModel = component.viewModel;
	    var viewModelResource = component.viewModelResource;
	    var metadata = viewModelResource.metadata;
	
	    var viewStrategy = this.viewLocator.getViewStrategy(component.view || viewModel);
	    if (viewStrategy) {
	      viewStrategy.makeRelativeTo(_aureliaMetadata.Origin.get(component.router.container.viewModel.constructor).moduleId);
	    }
	
	    return metadata.load(childContainer, viewModelResource.value, null, viewStrategy, true).then(function (viewFactory) {
	      if (!_this.compositionTransactionNotifier) {
	        _this.compositionTransactionOwnershipToken = _this.compositionTransaction.tryCapture();
	      }
	
	      viewPortInstruction.controller = metadata.create(childContainer, _aureliaTemplating.BehaviorInstruction.dynamic(_this.element, viewModel, viewFactory));
	
	      if (waitToSwap) {
	        return;
	      }
	
	      _this.swap(viewPortInstruction);
	    });
	  };
	
	  RouterView.prototype.swap = function swap(viewPortInstruction) {
	    var _this2 = this;
	
	    var work = function work() {
	      var previousView = _this2.view;
	      var viewSlot = _this2.viewSlot;
	      var swapStrategy = void 0;
	
	      swapStrategy = _this2.swapOrder in swapStrategies ? swapStrategies[_this2.swapOrder] : swapStrategies.after;
	
	      swapStrategy(viewSlot, previousView, function () {
	        return Promise.resolve(viewSlot.add(viewPortInstruction.controller.view)).then(function () {
	          if (_this2.compositionTransactionNotifier) {
	            _this2.compositionTransactionNotifier.done();
	            _this2.compositionTransactionNotifier = null;
	          }
	        });
	      });
	
	      _this2.view = viewPortInstruction.controller.view;
	    };
	
	    viewPortInstruction.controller.automate(this.overrideContext, this.owningView);
	
	    if (this.compositionTransactionOwnershipToken) {
	      return this.compositionTransactionOwnershipToken.waitForCompositionComplete().then(function () {
	        _this2.compositionTransactionOwnershipToken = null;
	        work();
	      });
	    }
	
	    work();
	  };
	
	  return RouterView;
	}(), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'swapOrder', [_aureliaTemplating.bindable], {
	  enumerable: true,
	  initializer: null
	})), _class2)) || _class) || _class) || _class);

/***/ },
/* 70 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.RouteHref = undefined;
	
	var _dec, _dec2, _dec3, _dec4, _dec5, _class;
	
	var _aureliaTemplating = __webpack_require__(24);
	
	var _aureliaDependencyInjection = __webpack_require__(19);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaPal = __webpack_require__(4);
	
	var _aureliaLogging = __webpack_require__(14);
	
	var LogManager = _interopRequireWildcard(_aureliaLogging);
	
	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var logger = LogManager.getLogger('route-href');
	
	var RouteHref = exports.RouteHref = (_dec = (0, _aureliaTemplating.customAttribute)('route-href'), _dec2 = (0, _aureliaTemplating.bindable)({ name: 'route', changeHandler: 'processChange' }), _dec3 = (0, _aureliaTemplating.bindable)({ name: 'params', changeHandler: 'processChange' }), _dec4 = (0, _aureliaTemplating.bindable)({ name: 'attribute', defaultValue: 'href' }), _dec5 = (0, _aureliaDependencyInjection.inject)(_aureliaRouter.Router, _aureliaPal.DOM.Element), _dec(_class = _dec2(_class = _dec3(_class = _dec4(_class = _dec5(_class = function () {
	  function RouteHref(router, element) {
	    _classCallCheck(this, RouteHref);
	
	    this.router = router;
	    this.element = element;
	  }
	
	  RouteHref.prototype.bind = function bind() {
	    this.isActive = true;
	    this.processChange();
	  };
	
	  RouteHref.prototype.unbind = function unbind() {
	    this.isActive = false;
	  };
	
	  RouteHref.prototype.attributeChanged = function attributeChanged(value, previous) {
	    if (previous) {
	      this.element.removeAttribute(previous);
	    }
	
	    this.processChange();
	  };
	
	  RouteHref.prototype.processChange = function processChange() {
	    var _this = this;
	
	    return this.router.ensureConfigured().then(function () {
	      if (!_this.isActive) {
	        return;
	      }
	
	      var href = _this.router.generate(_this.route, _this.params);
	      _this.element.setAttribute(_this.attribute, href);
	    }).catch(function (reason) {
	      logger.error(reason);
	    });
	  };
	
	  return RouteHref;
	}()) || _class) || _class) || _class) || _class) || _class);

/***/ },
/* 71 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.Index = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var Index = exports.Index = (_dec = (0, _aureliaFramework.inject)(_aureliaEventAggregator.EventAggregator, _aureliaRouter.Router, _aureliaSailsSocketClient.SailsSocketClient), _dec(_class = function () {
	  function Index(eventAggregator, router, sails) {
	    _classCallCheck(this, Index);
	
	    this.entity = { identifier: 'admin@example.com', password: 'admin1234' };
	
	    this.ea = eventAggregator;
	    this.sails = sails;
	    this.router = router;
	  }
	
	  Index.prototype.login = function login() {
	    var _this = this;
	
	    this.sails.post('/auth/local', this.entity).then(function (data) {
	      _this.ea.publish('uerAuthenticated', data.body);
	      _this.router.navigate('/');
	    }).catch(function (error) {
	      return console.log(error);
	    });
	  };
	
	  return Index;
	}()) || _class);

/***/ },
/* 72 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <!-- <div ui-card class=\"centered\">\n    <div class=\"image\">\n\n    </div>\n    <div class=\"content\">\n      <a class=\"header\">Elyse</a>\n    </div>\n  </div> -->\n\n  <!-- <div class=\"ui icon message\">\n    <i class=\"inbox icon\"></i>\n    <div class=\"content\">\n      <div class=\"header\">\n        Have you heard about our mailing list?\n      </div>\n      <p>Get the best news in your e-mail every day.</p>\n    </div>\n  </div>\n\n  <div ui-message=\"icon: blue loading notched circle\">\n    <div class=\"content\">\n      <div class=\"header\">\n        Just one second\n      </div>\n      <p>We're fetching that content for you.</p>\n    </div>\n  </div>\n\n  <div ui-message=\"icon.bind: messageIcon\" class=\"icon\">\n    <i class=\"ui icon inbox\"></i>\n    <div class=\"content\">\n      <div class=\"header\">\n        Have you heard about our mailing list?\n      </div>\n      <p>Get the best news in your e-mail every day.</p>\n    </div>\n  </div>\n\n  <div ui-dropdown=\"selection: messageIcon\">\n    <input name=\"messageIcon\" type=\"hidden\" value.bind=\"messageIcon\">\n    <i class=\"dropdown icon\"></i>\n    <div class=\"default text\">Message Icon</div>\n    <div class=\"menu\">\n      <div class=\"item\" data-value=\"inbox\">Inbox</div>\n      <div class=\"item\" data-value=\"teal lab\">Lab</div>\n      <div class=\"item\" data-value=\"payment\">Payment</div>\n      <div class=\"item\" data-value=\"calendar\">Calendar</div>\n      <div class=\"item\" data-value=\"horizontally flipped comment\">Comment</div>\n    </div>\n  </div> -->\n  <div class=\"ui middle aligned center aligned grid\">\n    <div class=\"six wide column\">\n      <h2 class=\"ui teal image header\">\n\n        <div class=\"content\">\n          Log-in to your account\n        </div>\n      </h2>\n      <form class=\"ui large form\" submit.delegate=\"login()\">\n        <div class=\"ui stacked segment\">\n          <div class=\"field\">\n            <div class=\"ui left icon input\">\n              <i class=\"user icon\"></i>\n              <input type=\"text\" name=\"email\" value.bind=\"entity.identifier\" placeholder=\"E-mail address\">\n            </div>\n          </div>\n          <div class=\"field\">\n            <div class=\"ui left icon input\">\n              <i class=\"lock icon\"></i>\n              <input type=\"password\" name=\"password\" value.bind=\"entity.password\" placeholder=\"Password\">\n            </div>\n          </div>\n          <button type=\"submit\" class=\"ui button green\">Login</button>\n        </div>\n\n        <div class=\"ui error message\"></div>\n\n      </form>\n\n      <div class=\"ui message\">\n        New to us? <a>Sign Up</a>\n      </div>\n    </div>\n  </div>\n</template>\n";

/***/ },
/* 73 */
/***/ function(module, exports) {

	'use strict';
	
	exports.__esModule = true;
	var configForDevelopment = {
	  providers: {
	    google: {
	      clientId: '239531826023-ibk10mb9p7ull54j55a61og5lvnjrff6.apps.googleusercontent.com'
	    } /*
	      ,
	      linkedin:{
	       clientId:'778mif8zyqbei7'
	      },
	      facebook:{
	       clientId:'1452782111708498'
	      }*/
	  }
	};
	
	var configForProduction = {
	  providers: {
	    google: {
	      clientId: '239531826023-3ludu3934rmcra3oqscc1gid3l9o497i.apps.googleusercontent.com'
	    } /*
	      ,
	      linkedin:{
	       clientId:'7561959vdub4x1'
	      },
	      facebook:{
	       clientId:'1653908914832509'
	      }*/
	
	  }
	};
	var config;
	if (window.location.hostname === 'localhost') {
	  config = configForDevelopment;
	} else {
	  config = configForProduction;
	}
	
	exports.default = config;

/***/ },
/* 74 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Breadcrumb - http://semantic-ui.com/collections/breadcrumb.html
	 */
	
	exports.__esModule = true;
	exports.UIBreadcrumbDividerAttribute = exports.UIBreadcrumbSectionAttribute = exports.UIBreadcrumbAttribute = undefined;
	
	var _dec, _dec2, _dec3, _class, _desc, _value, _class2, _descriptor, _descriptor2, _descriptor3, _dec4, _class4, _desc2, _value2, _class5, _descriptor4, _dec5, _class7;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIBreadcrumbAttribute = exports.UIBreadcrumbAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'breadcrumb'), _dec2 = (0, _uiAttribute.bindableEnum)('small', 'large', 'huge'), _dec3 = (0, _aureliaFramework.children)('[ui-breadcrumb-section]'), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UIBreadcrumbAttribute, _UIAttribute);
	
		function UIBreadcrumbAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UIBreadcrumbAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'divider', _descriptor, _this), _initDefineProp(_this, 'size', _descriptor2, _this), _initDefineProp(_this, 'sections', _descriptor3, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		UIBreadcrumbAttribute.prototype.bind = function bind() {
			_UIAttribute.prototype.bind.call(this);
	
			if (this.divider) {
				var dividerNode = null;
	
				// Icon divider (<i>)
				if (this.divider.match(/\bicon\b/)) {
					var _dividerNode$classLis;
	
					this.logger.debug('Icon divider (' + this.divider + ')');
					dividerNode = document.createElement('i');
					(_dividerNode$classLis = dividerNode.classList).add.apply(_dividerNode$classLis, this.divider.split(/\s+/));
					dividerNode.classList.add('divider');
				}
	
				// Text divider (<span>)
				else {
						this.logger.debug('Text divider (' + this.divider + ')');
						var content = document.createTextNode(this.divider);
						dividerNode = document.createElement('span');
						dividerNode.classList.add('divider');
						dividerNode.appendChild(content);
					}
	
				for (var i in this.sections) {
					if (i > 0) {
						var section = this.sections[i];
						this.element.insertBefore(dividerNode.cloneNode(true), section);
					}
				}
			}
		};
	
		return UIBreadcrumbAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'divider', [_aureliaFramework.bindable], {
		enumerable: true,
		initializer: null
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'size', [_dec2], {
		enumerable: true,
		initializer: null
	}), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, 'sections', [_dec3], {
		enumerable: true,
		initializer: null
	})), _class2)) || _class);
	
	/**
	 * ui-breadcrumb-section
	 */
	
	var UIBreadcrumbSectionAttribute = exports.UIBreadcrumbSectionAttribute = (_dec4 = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'breadcrumb-section'), _dec4(_class4 = (_class5 = function (_UIAttribute2) {
		_inherits(UIBreadcrumbSectionAttribute, _UIAttribute2);
	
		function UIBreadcrumbSectionAttribute() {
			var _temp2, _this2, _ret2;
	
			_classCallCheck(this, UIBreadcrumbSectionAttribute);
	
			for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
				args[_key2] = arguments[_key2];
			}
	
			return _ret2 = (_temp2 = (_this2 = _possibleConstructorReturn(this, _UIAttribute2.call.apply(_UIAttribute2, [this].concat(args))), _this2), _initDefineProp(_this2, 'active', _descriptor4, _this2), _temp2), _possibleConstructorReturn(_this2, _ret2);
		}
	
		UIBreadcrumbSectionAttribute.prototype.bind = function bind() {
			// No super
			this.element.classList.add('section');
		};
	
		return UIBreadcrumbSectionAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor4 = _applyDecoratedDescriptor(_class5.prototype, 'active', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	})), _class5)) || _class4);
	
	/**
	 * ui-breadcrumb-divider
	 */
	
	var UIBreadcrumbDividerAttribute = exports.UIBreadcrumbDividerAttribute = (_dec5 = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'breadcrumb-divider'), _dec5(_class7 = function (_UIAttribute3) {
		_inherits(UIBreadcrumbDividerAttribute, _UIAttribute3);
	
		function UIBreadcrumbDividerAttribute() {
			_classCallCheck(this, UIBreadcrumbDividerAttribute);
	
			return _possibleConstructorReturn(this, _UIAttribute3.apply(this, arguments));
		}
	
		UIBreadcrumbDividerAttribute.prototype.bind = function bind() {
			// No super
			if (this.element.classList) {
				this.element.classList.add('divider');
			}
		};
	
		return UIBreadcrumbDividerAttribute;
	}(_uiAttribute.UIAttribute)) || _class7);

/***/ },
/* 75 */
/***/ function(module, exports) {

	/* -*- javascript -*- */
	"use strict";
	
	exports.__esModule = true;
	var constants = exports.constants = {
		attributePrefix: 'ui-',
		elementPrefix: 'ui-',
		VALID_SIZES: ['mini', 'tiny', 'small', 'medium', 'large', 'big', 'huge', 'massive'],
		VALID_COLORS: ['red', 'orange', 'yellow', 'olive', 'green', 'teal', 'blue', 'violet', 'purple', 'pink', 'brown', 'grey', 'black']
	};

/***/ },
/* 76 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * UIAttribute -- base class for Semantic UI attributes
	 */
	
	exports.__esModule = true;
	exports.UIAttribute = undefined;
	
	var _dec, _class;
	
	exports.bindableEnum = bindableEnum;
	exports.bindableToggle = bindableToggle;
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var UI_ATTRIBUTE_NAME = /UI(\w+)Attribute/;
	
	var UIAttribute = exports.UIAttribute = (_dec = (0, _aureliaFramework.inject)(Element), _dec(_class = function () {
		function UIAttribute(element) {
			_classCallCheck(this, UIAttribute);
	
			this.logger = _aureliaFramework.LogManager.getLogger(this.constructor.name);
			this.element = element;
		}
	
		UIAttribute.prototype.bind = function bind() {
			var nameMatch = UI_ATTRIBUTE_NAME.exec(this.constructor.name);
	
			if (nameMatch) {
				var attrName = nameMatch[1].toLowerCase();
				this.element.classList.add('ui', attrName);
			} else {
				this.logger.warn("Attribute class doesn't match the naming convention; ", "assuming it's going to manage the classList itself.");
			}
		};
	
		return UIAttribute;
	}()) || _class);
	function bindableEnum() {
		// console.debug( "Bindable enum decorator called with: ", validValues );
		return function (target, name, descriptor) {
			var changedMethodName = name + 'Changed';
			// console.debug( "Setting up a ", changedMethodName, " method on ", target );
			target[changedMethodName] = function (newValue, oldValue) {
				this.logger.debug('Changing ' + name + ' to ' + newValue + ' from ' + oldValue);
				this.element.classList.remove(oldValue);
				this.element.classList.add(newValue);
			};
	
			var originalBind = target.bind;
			target.bind = function () {
				for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
					args[_key] = arguments[_key];
				}
	
				Reflect.apply(originalBind, this, args);
				if (this[name]) {
					this.element.classList.add(this[name]);
				}
			};
	
			return (0, _aureliaFramework.bindable)(target, name, descriptor);
		};
	}
	
	function bindableToggle(target, name, descriptor) {
		// console.debug( "Bindable toggle decorator called with args: ", target, name, descriptor );
		var changedMethodName = name + 'Changed';
		// console.debug( "Setting up a ", changedMethodName, " method on ", target );
		target[changedMethodName] = function (newValue) {
			this.logger.debug('Toggling ' + name + ' to ' + (newValue ? 'on' : 'off') + '.');
			if (newValue) {
				this.element.classList.add(name);
			} else {
				this.element.classList.remove(name);
			}
		};
	
		var originalBind = target.bind;
		target.bind = function () {
			for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
				args[_key2] = arguments[_key2];
			}
	
			Reflect.apply(originalBind, this, args);
			if (this[name]) {
				this.element.classList.add(name);
			}
		};
	
		return (0, _aureliaFramework.bindable)(target, name, descriptor);
	}

/***/ },
/* 77 */
/***/ function(module, exports, __webpack_require__) {

	/* WEBPACK VAR INJECTION */(function($) {/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Form - http://semantic-ui.com/collections/form.html
	 */
	
	exports.__esModule = true;
	exports.UICheckboxAttribute = exports.UIFormAttribute = undefined;
	
	var _dec, _dec2, _class, _desc, _value, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _dec3, _class4;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIFormAttribute = exports.UIFormAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'form'), _dec2 = (0, _aureliaFramework.children)('.field'), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UIFormAttribute, _UIAttribute);
	
		function UIFormAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UIFormAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'loading', _descriptor, _this), _initDefineProp(_this, 'error', _descriptor2, _this), _initDefineProp(_this, 'success', _descriptor3, _this), _initDefineProp(_this, 'warning', _descriptor4, _this), _initDefineProp(_this, 'fields', _descriptor5, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		return UIFormAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'loading', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'error', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: null
	}), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, 'success', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: null
	}), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, 'warning', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: null
	}), _descriptor5 = _applyDecoratedDescriptor(_class2.prototype, 'fields', [_dec2], {
		enumerable: true,
		initializer: null
	})), _class2)) || _class);
	var UICheckboxAttribute = exports.UICheckboxAttribute = (_dec3 = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'checkbox'), _dec3(_class4 = function (_UIAttribute2) {
		_inherits(UICheckboxAttribute, _UIAttribute2);
	
		function UICheckboxAttribute() {
			_classCallCheck(this, UICheckboxAttribute);
	
			return _possibleConstructorReturn(this, _UIAttribute2.apply(this, arguments));
		}
	
		UICheckboxAttribute.prototype.attached = function attached() {
			this.logger.debug("Activating a ui-checkbox");
			$(this.element).checkbox();
		};
	
		return UICheckboxAttribute;
	}(_uiAttribute.UIAttribute)) || _class4);
	/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(13)))

/***/ },
/* 78 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Grid - http://semantic-ui.com/collections/grid.html
	 */
	
	exports.__esModule = true;
	exports.UIGridAttribute = undefined;
	
	var _dec, _dec2, _class, _desc, _value, _class2, _descriptor;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
	  if (!descriptor) return;
	  Object.defineProperty(target, property, {
	    enumerable: descriptor.enumerable,
	    configurable: descriptor.configurable,
	    writable: descriptor.writable,
	    value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
	  });
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
	  var desc = {};
	  Object['ke' + 'ys'](descriptor).forEach(function (key) {
	    desc[key] = descriptor[key];
	  });
	  desc.enumerable = !!desc.enumerable;
	  desc.configurable = !!desc.configurable;
	
	  if ('value' in desc || desc.initializer) {
	    desc.writable = true;
	  }
	
	  desc = decorators.slice().reverse().reduce(function (desc, decorator) {
	    return decorator(target, property, desc) || desc;
	  }, desc);
	
	  if (context && desc.initializer !== void 0) {
	    desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
	    desc.initializer = undefined;
	  }
	
	  if (desc.initializer === void 0) {
	    Object['define' + 'Property'](target, property, desc);
	    desc = null;
	  }
	
	  return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
	  throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIGridAttribute = exports.UIGridAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'grid'), _dec2 = (0, _aureliaFramework.children)('.column'), _dec(_class = (_class2 = function (_UIAttribute) {
	  _inherits(UIGridAttribute, _UIAttribute);

	  function UIGridAttribute() {
	    var _temp, _this, _ret;

	    _classCallCheck(this, UIGridAttribute);

	    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
	      args[_key] = arguments[_key];
	    }

	    return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'columns', _descriptor, _this), _temp), _possibleConstructorReturn(_this, _ret);
	  }

	  return UIGridAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'columns', [_dec2], {
	  enumerable: true,
	  initializer: null
	})), _class2)) || _class);

/***/ },
/* 79 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Menu - http://semantic-ui.com/collections/menu.html
	 */
	
	exports.__esModule = true;
	exports.UIMenuItemAttribute = exports.UIMenuAttribute = undefined;
	
	var _dec, _dec2, _class, _desc, _value, _class2, _descriptor, _descriptor2, _dec3, _class4, _desc2, _value2, _class5, _descriptor3;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIMenuAttribute = exports.UIMenuAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'menu'), _dec2 = (0, _aureliaFramework.children)('[ui-menu-item]'), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UIMenuAttribute, _UIAttribute);
	
		function UIMenuAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UIMenuAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'router', _descriptor, _this), _initDefineProp(_this, 'items', _descriptor2, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		UIMenuAttribute.prototype.isSubmenu = function isSubmenu() {
			var parent = this.element.parentElement;
			if (!parent) {
				return false;
			}
	
			var classes = parent.classList;
			if (!classes) {
				return false;
			}
	
			return classes.contains('item') || classes.contains('menu');
		};
	
		UIMenuAttribute.prototype.bind = function bind() {
			// Don't super for sub-menus because they shouldn't get the 'ui'
			if (this.isSubmenu()) {
				this.element.classList.add('menu');
			} else {
				_UIAttribute.prototype.bind.call(this);
			}
		};
	
		return UIMenuAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'router', [_aureliaFramework.bindable], {
		enumerable: true,
		initializer: null
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'items', [_dec2], {
		enumerable: true,
		initializer: null
	})), _class2)) || _class);
	
	/**
	 * ui-menu-item
	 */
	
	var UIMenuItemAttribute = exports.UIMenuItemAttribute = (_dec3 = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'menu-item'), _dec3(_class4 = (_class5 = function (_UIAttribute2) {
		_inherits(UIMenuItemAttribute, _UIAttribute2);
	
		function UIMenuItemAttribute() {
			var _temp2, _this2, _ret2;
	
			_classCallCheck(this, UIMenuItemAttribute);
	
			for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
				args[_key2] = arguments[_key2];
			}
	
			return _ret2 = (_temp2 = (_this2 = _possibleConstructorReturn(this, _UIAttribute2.call.apply(_UIAttribute2, [this].concat(args))), _this2), _initDefineProp(_this2, 'active', _descriptor3, _this2), _temp2), _possibleConstructorReturn(_this2, _ret2);
		}
	
		UIMenuItemAttribute.prototype.bind = function bind() {
			// no super
			this.element.classList.add('item');
		};
	
		return UIMenuItemAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor3 = _applyDecoratedDescriptor(_class5.prototype, 'active', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	})), _class5)) || _class4);

/***/ },
/* 80 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Message - http://semantic-ui.com/collections/message.html
	 */
	
	exports.__esModule = true;
	exports.UIMessageAttribute = undefined;
	
	var _dec, _dec2, _class, _desc, _value, _class2, _descriptor, _descriptor2;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIMessageAttribute = exports.UIMessageAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'message'), _dec2 = (0, _aureliaFramework.child)('i.ui.icon'), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UIMessageAttribute, _UIAttribute);
	
		function UIMessageAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UIMessageAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'icon', _descriptor, _this), _initDefineProp(_this, 'iconElement', _descriptor2, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		UIMessageAttribute.prototype.bind = function bind() {
			var _UIAttribute$prototyp;
	
			for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
				args[_key2] = arguments[_key2];
			}
	
			(_UIAttribute$prototyp = _UIAttribute.prototype.bind).call.apply(_UIAttribute$prototyp, [this].concat(args));
			if (this.icon) {
				this.logger.debug('Adding \'icon\' to the list of classes.');
				this.element.classList.add('icon');
			}
		};
	
		UIMessageAttribute.prototype.attached = function attached() {
			this.logger.debug("Attaching a ui-message. Icon element is: ", this.iconElement);
	
			// Inject the icon if it's set but not already there
			if (this.icon && !this.iconElement) {
				var _iconNode$classList;
	
				this.logger.debug('Creating a ' + this.icon + ' icon for ', this.element);
				var iconNode = document.createElement('i');
				iconNode.classList.add('ui', 'icon');
				(_iconNode$classList = iconNode.classList).add.apply(_iconNode$classList, this.icon.split(' '));
				this.element.insertBefore(iconNode, this.element.firstChild);
				this.iconElement = iconNode;
			}
		};
	
		UIMessageAttribute.prototype.iconChanged = function iconChanged(newValue, oldValue) {
			if (this.iconElement) {
				this.logger.debug('Swapping icon of ' + this.iconElement + ' to ' + newValue + ' from ' + oldValue);
				if (oldValue) {
					var _iconElement$classLis;
	
					(_iconElement$classLis = this.iconElement.classList).remove.apply(_iconElement$classLis, oldValue.split(' '));
				}
				if (newValue) {
					var _iconElement$classLis2;
	
					(_iconElement$classLis2 = this.iconElement.classList).add.apply(_iconElement$classLis2, newValue.split(' '));
				}
			}
		};
	
		return UIMessageAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'icon', [_aureliaFramework.bindable], {
		enumerable: true,
		initializer: null
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'iconElement', [_dec2], {
		enumerable: true,
		initializer: null
	})), _class2)) || _class);

/***/ },
/* 81 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Table - http://semantic-ui.com/collections/table.html
	 */
	
	exports.__esModule = true;
	exports.UITableAttribute = undefined;
	
	var _dec, _class;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var UITableAttribute = exports.UITableAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'table'), _dec(_class = function (_UIAttribute) {
	  _inherits(UITableAttribute, _UIAttribute);

	  function UITableAttribute() {
	    _classCallCheck(this, UITableAttribute);

	    return _possibleConstructorReturn(this, _UIAttribute.apply(this, arguments));
	  }

	  return UITableAttribute;
	}(_uiAttribute.UIAttribute)) || _class);

/***/ },
/* 82 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Button - http://semantic-ui.com/elements/button.html
	 */
	
	exports.__esModule = true;
	exports.UIButtonsAttribute = exports.UIButtonAttribute = undefined;
	
	var _dec, _dec2, _dec3, _class, _desc, _value, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _dec4, _class4;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIButtonAttribute = exports.UIButtonAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'button'), _dec2 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_COLORS), _dec3 = (0, _aureliaFramework.child)('i.ui.icon'), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UIButtonAttribute, _UIAttribute);
	
		function UIButtonAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UIButtonAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'icon', _descriptor, _this), _initDefineProp(_this, 'color', _descriptor2, _this), _initDefineProp(_this, 'disabled', _descriptor3, _this), _initDefineProp(_this, 'iconElement', _descriptor4, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		UIButtonAttribute.prototype.bind = function bind() {
			var _UIAttribute$prototyp;
	
			for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
				args[_key2] = arguments[_key2];
			}
	
			(_UIAttribute$prototyp = _UIAttribute.prototype.bind).call.apply(_UIAttribute$prototyp, [this].concat(args));
			if (this.icon) {
				this.logger.debug('Adding \'icon\' to the list of classes.');
				this.element.classList.add('icon');
			}
		};
	
		UIButtonAttribute.prototype.attached = function attached() {
			// Inject the icon if it's set but not already there
			if (this.icon && !this.iconElement) {
				var _iconNode$classList;
	
				this.logger.debug('Creating a ' + this.icon + ' icon for ', this.element);
				var iconNode = document.createElement('i');
				iconNode.classList.add('ui', 'icon');
				(_iconNode$classList = iconNode.classList).add.apply(_iconNode$classList, this.icon.split(' '));
				this.element.insertBefore(iconNode, this.element.firstChild);
				this.iconElement = iconNode;
			}
		};
	
		UIButtonAttribute.prototype.iconChanged = function iconChanged(newValue, oldValue) {
			if (this.iconElement) {
				this.logger.debug('Swapping icon of ' + this.iconElement + ' to ' + newValue + ' from ' + oldValue);
				if (oldValue) {
					var _iconElement$classLis;
	
					(_iconElement$classLis = this.iconElement.classList).remove.apply(_iconElement$classLis, oldValue.split(' '));
				}
				if (newValue) {
					var _iconElement$classLis2;
	
					(_iconElement$classLis2 = this.iconElement.classList).add.apply(_iconElement$classLis2, newValue.split(' '));
				}
			}
		};
	
		return UIButtonAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'icon', [_aureliaFramework.bindable], {
		enumerable: true,
		initializer: null
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'color', [_dec2], {
		enumerable: true,
		initializer: null
	}), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, 'disabled', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: null
	}), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, 'iconElement', [_dec3], {
		enumerable: true,
		initializer: null
	})), _class2)) || _class);
	var UIButtonsAttribute = exports.UIButtonsAttribute = (_dec4 = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'buttons'), _dec4(_class4 = function (_UIAttribute2) {
		_inherits(UIButtonsAttribute, _UIAttribute2);

		function UIButtonsAttribute() {
			_classCallCheck(this, UIButtonsAttribute);

			return _possibleConstructorReturn(this, _UIAttribute2.apply(this, arguments));
		}

		return UIButtonsAttribute;
	}(_uiAttribute.UIAttribute)) || _class4);

/***/ },
/* 83 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Container - http://semantic-ui.com/elements/container.html
	 */
	
	exports.__esModule = true;
	exports.UIContainerAttribute = undefined;
	
	var _dec, _class;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var UIContainerAttribute = exports.UIContainerAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'container'), _dec(_class = function (_UIAttribute) {
	  _inherits(UIContainerAttribute, _UIAttribute);

	  function UIContainerAttribute() {
	    _classCallCheck(this, UIContainerAttribute);

	    return _possibleConstructorReturn(this, _UIAttribute.apply(this, arguments));
	  }

	  return UIContainerAttribute;
	}(_uiAttribute.UIAttribute)) || _class);

/***/ },
/* 84 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Divider - http://semantic-ui.com/elements/divider.html
	 */
	
	exports.__esModule = true;
	exports.UIDividerAttribute = undefined;
	
	var _dec, _class;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var UIDividerAttribute = exports.UIDividerAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'divider'), _dec(_class = function (_UIAttribute) {
	  _inherits(UIDividerAttribute, _UIAttribute);

	  function UIDividerAttribute() {
	    _classCallCheck(this, UIDividerAttribute);

	    return _possibleConstructorReturn(this, _UIAttribute.apply(this, arguments));
	  }

	  return UIDividerAttribute;
	}(_uiAttribute.UIAttribute)) || _class);

/***/ },
/* 85 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Flag - http://semantic-ui.com/elements/flag.html
	 */
	
	exports.__esModule = true;
	exports.UIFlagAttribute = undefined;
	
	var _dec, _class, _desc, _value, _class2, _descriptor;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
	    if (!descriptor) return;
	    Object.defineProperty(target, property, {
	        enumerable: descriptor.enumerable,
	        configurable: descriptor.configurable,
	        writable: descriptor.writable,
	        value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
	    });
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
	    var desc = {};
	    Object['ke' + 'ys'](descriptor).forEach(function (key) {
	        desc[key] = descriptor[key];
	    });
	    desc.enumerable = !!desc.enumerable;
	    desc.configurable = !!desc.configurable;
	
	    if ('value' in desc || desc.initializer) {
	        desc.writable = true;
	    }
	
	    desc = decorators.slice().reverse().reduce(function (desc, decorator) {
	        return decorator(target, property, desc) || desc;
	    }, desc);
	
	    if (context && desc.initializer !== void 0) {
	        desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
	        desc.initializer = undefined;
	    }
	
	    if (desc.initializer === void 0) {
	        Object['define' + 'Property'](target, property, desc);
	        desc = null;
	    }
	
	    return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
	    throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIFlagAttribute = exports.UIFlagAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'flag'), _dec(_class = (_class2 = function (_UIAttribute) {
	    _inherits(UIFlagAttribute, _UIAttribute);
	
	    function UIFlagAttribute() {
	        var _temp, _this, _ret;
	
	        _classCallCheck(this, UIFlagAttribute);
	
	        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
	            args[_key] = arguments[_key];
	        }
	
	        return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'country', _descriptor, _this), _temp), _possibleConstructorReturn(_this, _ret);
	    }
	
	    UIFlagAttribute.prototype.bind = function bind() {
	        var _UIAttribute$prototyp;
	
	        for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
	            args[_key2] = arguments[_key2];
	        }
	
	        (_UIAttribute$prototyp = _UIAttribute.prototype.bind).call.apply(_UIAttribute$prototyp, [this].concat(args));
	        if (this.country) {
	            var _element$classList;
	
	            (_element$classList = this.element.classList).add.apply(_element$classList, this.country.split(' '));
	        }
	    };
	
	    UIFlagAttribute.prototype.countryChanged = function countryChanged(newValue, oldValue) {
	        if (oldValue) {
	            var _element$classList2;
	
	            (_element$classList2 = this.element.classList).remove.apply(_element$classList2, oldValue.split(' '));
	        }
	        if (newValue) {
	            var _element$classList3;
	
	            (_element$classList3 = this.element.classList).add.apply(_element$classList3, newValue.split(' '));
	        }
	    };
	
	    return UIFlagAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'country', [_aureliaFramework.bindable], {
	    enumerable: true,
	    initializer: null
	})), _class2)) || _class);

/***/ },
/* 86 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Content Header - http://semantic-ui.com/elements/header.html#content-headers
	 */
	
	exports.__esModule = true;
	exports.UIHeaderAttribute = undefined;
	
	var _dec, _dec2, _dec3, _class, _desc, _value, _class2, _descriptor, _descriptor2;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
	  if (!descriptor) return;
	  Object.defineProperty(target, property, {
	    enumerable: descriptor.enumerable,
	    configurable: descriptor.configurable,
	    writable: descriptor.writable,
	    value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
	  });
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
	  var desc = {};
	  Object['ke' + 'ys'](descriptor).forEach(function (key) {
	    desc[key] = descriptor[key];
	  });
	  desc.enumerable = !!desc.enumerable;
	  desc.configurable = !!desc.configurable;
	
	  if ('value' in desc || desc.initializer) {
	    desc.writable = true;
	  }
	
	  desc = decorators.slice().reverse().reduce(function (desc, decorator) {
	    return decorator(target, property, desc) || desc;
	  }, desc);
	
	  if (context && desc.initializer !== void 0) {
	    desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
	    desc.initializer = undefined;
	  }
	
	  if (desc.initializer === void 0) {
	    Object['define' + 'Property'](target, property, desc);
	    desc = null;
	  }
	
	  return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
	  throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIHeaderAttribute = exports.UIHeaderAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'header'), _dec2 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_SIZES), _dec3 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_COLORS), _dec(_class = (_class2 = function (_UIAttribute) {
	  _inherits(UIHeaderAttribute, _UIAttribute);

	  function UIHeaderAttribute() {
	    var _temp, _this, _ret;

	    _classCallCheck(this, UIHeaderAttribute);

	    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
	      args[_key] = arguments[_key];
	    }

	    return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'size', _descriptor, _this), _initDefineProp(_this, 'color', _descriptor2, _this), _temp), _possibleConstructorReturn(_this, _ret);
	  }

	  return UIHeaderAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'size', [_dec2], {
	  enumerable: true,
	  initializer: null
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'color', [_dec3], {
	  enumerable: true,
	  initializer: null
	})), _class2)) || _class);

/***/ },
/* 87 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Icon - http://semantic-ui.com/elements/icon.html#/definition
	 */
	
	exports.__esModule = true;
	exports.UIIconsAttribute = exports.UIIconAttribute = undefined;
	
	var _dec, _dec2, _dec3, _class, _desc, _value, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _dec4, _dec5, _class4, _desc2, _value2, _class5, _descriptor6;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIIconAttribute = exports.UIIconAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'icon'), _dec2 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_SIZES), _dec3 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_COLORS), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UIIconAttribute, _UIAttribute);
	
		function UIIconAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UIIconAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'name', _descriptor, _this), _initDefineProp(_this, 'size', _descriptor2, _this), _initDefineProp(_this, 'color', _descriptor3, _this), _initDefineProp(_this, 'disabled', _descriptor4, _this), _initDefineProp(_this, 'loading', _descriptor5, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		UIIconAttribute.prototype.bind = function bind() {
			var _element$classList;
	
			// No super, as the classList doesn't get the 'ui' class.
			(_element$classList = this.element.classList).add.apply(_element$classList, this.name.split(' '));
			this.element.classList.add('icon');
		};
	
		UIIconAttribute.prototype.nameChanged = function nameChanged(newValue, oldValue) {
			var _element$classList2, _element$classList3;
	
			this.logger.debug('Name changed from ' + oldValue + ' to ' + newValue);
			(_element$classList2 = this.element.classList).remove.apply(_element$classList2, oldValue.split(' '));
			(_element$classList3 = this.element.classList).add.apply(_element$classList3, newValue.split(' '));
		};
	
		return UIIconAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'name', [_aureliaFramework.bindable], {
		enumerable: true,
		initializer: function initializer() {
			return "help circle";
		}
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'size', [_dec2], {
		enumerable: true,
		initializer: null
	}), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, 'color', [_dec3], {
		enumerable: true,
		initializer: null
	}), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, 'disabled', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: null
	}), _descriptor5 = _applyDecoratedDescriptor(_class2.prototype, 'loading', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: null
	})), _class2)) || _class);
	var UIIconsAttribute = exports.UIIconsAttribute = (_dec4 = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'icons'), _dec5 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_SIZES), _dec4(_class4 = (_class5 = function (_UIAttribute2) {
		_inherits(UIIconsAttribute, _UIAttribute2);

		function UIIconsAttribute() {
			var _temp2, _this2, _ret2;

			_classCallCheck(this, UIIconsAttribute);

			for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
				args[_key2] = arguments[_key2];
			}

			return _ret2 = (_temp2 = (_this2 = _possibleConstructorReturn(this, _UIAttribute2.call.apply(_UIAttribute2, [this].concat(args))), _this2), _initDefineProp(_this2, 'size', _descriptor6, _this2), _temp2), _possibleConstructorReturn(_this2, _ret2);
		}

		return UIIconsAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor6 = _applyDecoratedDescriptor(_class5.prototype, 'size', [_dec5], {
		enumerable: true,
		initializer: null
	})), _class5)) || _class4);

/***/ },
/* 88 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Image - http://semantic-ui.com/elements/image.html
	 */
	
	exports.__esModule = true;
	exports.UIImagesAttribute = exports.UIImageAttribute = undefined;
	
	var _dec, _dec2, _class, _desc, _value, _class2, _descriptor, _descriptor2, _descriptor3, _dec3, _dec4, _class4, _desc2, _value2, _class5, _descriptor4;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIImageAttribute = exports.UIImageAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'image'), _dec2 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_SIZES), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UIImageAttribute, _UIAttribute);
	
		function UIImageAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UIImageAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'size', _descriptor, _this), _initDefineProp(_this, 'hidden', _descriptor2, _this), _initDefineProp(_this, 'disabled', _descriptor3, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		return UIImageAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'size', [_dec2], {
		enumerable: true,
		initializer: null
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'hidden', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	}), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, 'disabled', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	})), _class2)) || _class);
	var UIImagesAttribute = exports.UIImagesAttribute = (_dec3 = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'images'), _dec4 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_SIZES), _dec3(_class4 = (_class5 = function (_UIAttribute2) {
		_inherits(UIImagesAttribute, _UIAttribute2);

		function UIImagesAttribute() {
			var _temp2, _this2, _ret2;

			_classCallCheck(this, UIImagesAttribute);

			for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
				args[_key2] = arguments[_key2];
			}

			return _ret2 = (_temp2 = (_this2 = _possibleConstructorReturn(this, _UIAttribute2.call.apply(_UIAttribute2, [this].concat(args))), _this2), _initDefineProp(_this2, 'size', _descriptor4, _this2), _temp2), _possibleConstructorReturn(_this2, _ret2);
		}

		return UIImagesAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor4 = _applyDecoratedDescriptor(_class5.prototype, 'size', [_dec4], {
		enumerable: true,
		initializer: null
	})), _class5)) || _class4);

/***/ },
/* 89 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Input - http://semantic-ui.com/elements/input.html
	 */
	
	exports.__esModule = true;
	exports.UIInputAttribute = undefined;
	
	var _dec, _dec2, _class, _desc, _value, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIInputAttribute = exports.UIInputAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'input'), _dec2 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_SIZES), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UIInputAttribute, _UIAttribute);
	
		function UIInputAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UIInputAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'focus', _descriptor, _this), _initDefineProp(_this, 'loading', _descriptor2, _this), _initDefineProp(_this, 'disabled', _descriptor3, _this), _initDefineProp(_this, 'error', _descriptor4, _this), _initDefineProp(_this, 'size', _descriptor5, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		return UIInputAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'focus', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'loading', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	}), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, 'disabled', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	}), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, 'error', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return null;
		}
	}), _descriptor5 = _applyDecoratedDescriptor(_class2.prototype, 'size', [_dec2], {
		enumerable: true,
		initializer: null
	})), _class2)) || _class);

/***/ },
/* 90 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Label - http://semantic-ui.com/elements/label.html
	 */
	
	exports.__esModule = true;
	exports.UILabelsAttribute = exports.UILabelAttribute = undefined;
	
	var _dec, _dec2, _dec3, _class, _desc, _value, _class2, _descriptor, _descriptor2, _dec4, _dec5, _dec6, _class4, _desc2, _value2, _class5, _descriptor3, _descriptor4;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UILabelAttribute = exports.UILabelAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'label'), _dec2 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_COLORS), _dec3 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_SIZES), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UILabelAttribute, _UIAttribute);
	
		function UILabelAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UILabelAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'color', _descriptor, _this), _initDefineProp(_this, 'size', _descriptor2, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		return UILabelAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'color', [_dec2], {
		enumerable: true,
		initializer: null
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'size', [_dec3], {
		enumerable: true,
		initializer: null
	})), _class2)) || _class);
	var UILabelsAttribute = exports.UILabelsAttribute = (_dec4 = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'labels'), _dec5 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_COLORS), _dec6 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_SIZES), _dec4(_class4 = (_class5 = function (_UIAttribute2) {
		_inherits(UILabelsAttribute, _UIAttribute2);

		function UILabelsAttribute() {
			var _temp2, _this2, _ret2;

			_classCallCheck(this, UILabelsAttribute);

			for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
				args[_key2] = arguments[_key2];
			}

			return _ret2 = (_temp2 = (_this2 = _possibleConstructorReturn(this, _UIAttribute2.call.apply(_UIAttribute2, [this].concat(args))), _this2), _initDefineProp(_this2, 'color', _descriptor3, _this2), _initDefineProp(_this2, 'size', _descriptor4, _this2), _temp2), _possibleConstructorReturn(_this2, _ret2);
		}

		return UILabelsAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor3 = _applyDecoratedDescriptor(_class5.prototype, 'color', [_dec5], {
		enumerable: true,
		initializer: null
	}), _descriptor4 = _applyDecoratedDescriptor(_class5.prototype, 'size', [_dec6], {
		enumerable: true,
		initializer: null
	})), _class5)) || _class4);

/***/ },
/* 91 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * List - http://semantic-ui.com/elements/list.html
	 */
	
	exports.__esModule = true;
	exports.UIListAttribute = undefined;
	
	var _dec, _dec2, _class, _desc, _value, _class2, _descriptor;
	
	var _constants = __webpack_require__(75);
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _uiAttribute = __webpack_require__(76);
	
	function _initDefineProp(target, property, descriptor, context) {
	  if (!descriptor) return;
	  Object.defineProperty(target, property, {
	    enumerable: descriptor.enumerable,
	    configurable: descriptor.configurable,
	    writable: descriptor.writable,
	    value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
	  });
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
	  var desc = {};
	  Object['ke' + 'ys'](descriptor).forEach(function (key) {
	    desc[key] = descriptor[key];
	  });
	  desc.enumerable = !!desc.enumerable;
	  desc.configurable = !!desc.configurable;
	
	  if ('value' in desc || desc.initializer) {
	    desc.writable = true;
	  }
	
	  desc = decorators.slice().reverse().reduce(function (desc, decorator) {
	    return decorator(target, property, desc) || desc;
	  }, desc);
	
	  if (context && desc.initializer !== void 0) {
	    desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
	    desc.initializer = undefined;
	  }
	
	  if (desc.initializer === void 0) {
	    Object['define' + 'Property'](target, property, desc);
	    desc = null;
	  }
	
	  return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
	  throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIListAttribute = exports.UIListAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'list'), _dec2 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_SIZES), _dec(_class = (_class2 = function (_UIAttribute) {
	  _inherits(UIListAttribute, _UIAttribute);

	  function UIListAttribute() {
	    var _temp, _this, _ret;

	    _classCallCheck(this, UIListAttribute);

	    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
	      args[_key] = arguments[_key];
	    }

	    return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'size', _descriptor, _this), _temp), _possibleConstructorReturn(_this, _ret);
	  }

	  return UIListAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'size', [_dec2], {
	  enumerable: true,
	  initializer: null
	})), _class2)) || _class);

/***/ },
/* 92 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Loader - http://semantic-ui.com/elements/loader.html
	 */
	
	exports.__esModule = true;
	exports.UILoaderAttribute = undefined;
	
	var _dec, _class, _desc, _value, _class2, _descriptor;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UILoaderAttribute = exports.UILoaderAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'loader'), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UILoaderAttribute, _UIAttribute);
	
		function UILoaderAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UILoaderAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'active', _descriptor, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		UILoaderAttribute.prototype.bind = function bind() {
			var _UIAttribute$prototyp;
	
			for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
				args[_key2] = arguments[_key2];
			}
	
			(_UIAttribute$prototyp = _UIAttribute.prototype.bind).call.apply(_UIAttribute$prototyp, [this].concat(args));
	
			if (this.active) {
				this.logger.debug("Loader is starting out active.");
				this.element.classList.add('active');
			};
		};
	
		UILoaderAttribute.prototype.activeChanged = function activeChanged(newValue) {
			if (newValue) {
				this.logger.debug("Activating loader.");
				this.element.classList.remove('disabled');
				this.element.classList.add('active');
			} else {
				this.logger.debug("Deactivating loader.");
				this.element.classList.remove('active');
				this.element.classList.add('disabled');
			}
		};
	
		return UILoaderAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'active', [_aureliaFramework.bindable], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	})), _class2)) || _class);

/***/ },
/* 93 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Content Rail - http://semantic-ui.com/elements/rail.html
	 */
	
	exports.__esModule = true;
	exports.UIRailAttribute = undefined;
	
	var _dec, _dec2, _class, _desc, _value, _class2, _descriptor;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
	  if (!descriptor) return;
	  Object.defineProperty(target, property, {
	    enumerable: descriptor.enumerable,
	    configurable: descriptor.configurable,
	    writable: descriptor.writable,
	    value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
	  });
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
	  var desc = {};
	  Object['ke' + 'ys'](descriptor).forEach(function (key) {
	    desc[key] = descriptor[key];
	  });
	  desc.enumerable = !!desc.enumerable;
	  desc.configurable = !!desc.configurable;
	
	  if ('value' in desc || desc.initializer) {
	    desc.writable = true;
	  }
	
	  desc = decorators.slice().reverse().reduce(function (desc, decorator) {
	    return decorator(target, property, desc) || desc;
	  }, desc);
	
	  if (context && desc.initializer !== void 0) {
	    desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
	    desc.initializer = undefined;
	  }
	
	  if (desc.initializer === void 0) {
	    Object['define' + 'Property'](target, property, desc);
	    desc = null;
	  }
	
	  return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
	  throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIRailAttribute = exports.UIRailAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'rail'), _dec2 = (0, _uiAttribute.bindableEnum)('left', 'right'), _dec(_class = (_class2 = function (_UIAttribute) {
	  _inherits(UIRailAttribute, _UIAttribute);
	
	  function UIRailAttribute() {
	    var _temp, _this, _ret;
	
	    _classCallCheck(this, UIRailAttribute);
	
	    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
	      args[_key] = arguments[_key];
	    }
	
	    return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'side', _descriptor, _this), _temp), _possibleConstructorReturn(_this, _ret);
	  }
	
	  return UIRailAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'side', [_dec2], {
	  enumerable: true,
	  initializer: function initializer() {
	    return 'left';
	  }
	})), _class2)) || _class);

/***/ },
/* 94 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Content Reveal - http://semantic-ui.com/elements/reveal.html
	 */
	
	exports.__esModule = true;
	exports.UIRevealHiddenAttribute = exports.UIRevealVisibleAttribute = exports.UIRevealAttribute = undefined;
	
	var _dec, _class, _desc, _value, _class2, _descriptor, _dec2, _class4, _dec3, _class5;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIRevealAttribute = exports.UIRevealAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'reveal'), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UIRevealAttribute, _UIAttribute);
	
		function UIRevealAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UIRevealAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'active', _descriptor, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		return UIRevealAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'active', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: null
	})), _class2)) || _class);
	var UIRevealVisibleAttribute = exports.UIRevealVisibleAttribute = (_dec2 = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'reveal-visible'), _dec2(_class4 = function (_UIAttribute2) {
		_inherits(UIRevealVisibleAttribute, _UIAttribute2);
	
		function UIRevealVisibleAttribute() {
			_classCallCheck(this, UIRevealVisibleAttribute);
	
			return _possibleConstructorReturn(this, _UIAttribute2.apply(this, arguments));
		}
	
		UIRevealVisibleAttribute.prototype.bind = function bind() {
			// No super
			this.element.classList.add('visible', 'content');
		};
	
		return UIRevealVisibleAttribute;
	}(_uiAttribute.UIAttribute)) || _class4);
	var UIRevealHiddenAttribute = exports.UIRevealHiddenAttribute = (_dec3 = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'reveal-hidden'), _dec3(_class5 = function (_UIAttribute3) {
		_inherits(UIRevealHiddenAttribute, _UIAttribute3);
	
		function UIRevealHiddenAttribute() {
			_classCallCheck(this, UIRevealHiddenAttribute);
	
			return _possibleConstructorReturn(this, _UIAttribute3.apply(this, arguments));
		}
	
		UIRevealHiddenAttribute.prototype.bind = function bind() {
			// No super
			this.element.classList.add('hidden', 'content');
		};
	
		return UIRevealHiddenAttribute;
	}(_uiAttribute.UIAttribute)) || _class5);

/***/ },
/* 95 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Segment - http://semantic-ui.com/elements/segment.html
	 */
	
	exports.__esModule = true;
	exports.UISegmentsAttribute = exports.UISegmentAttribute = undefined;
	
	var _dec, _dec2, _class, _desc, _value, _class2, _descriptor, _descriptor2, _descriptor3, _dec3, _class4;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UISegmentAttribute = exports.UISegmentAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'segment'), _dec2 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_COLORS), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UISegmentAttribute, _UIAttribute);
	
		function UISegmentAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UISegmentAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'loading', _descriptor, _this), _initDefineProp(_this, 'disabled', _descriptor2, _this), _initDefineProp(_this, 'color', _descriptor3, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		return UISegmentAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'loading', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'disabled', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	}), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, 'color', [_dec2], {
		enumerable: true,
		initializer: null
	})), _class2)) || _class);
	var UISegmentsAttribute = exports.UISegmentsAttribute = (_dec3 = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'segments'), _dec3(_class4 = function (_UIAttribute2) {
		_inherits(UISegmentsAttribute, _UIAttribute2);

		function UISegmentsAttribute() {
			_classCallCheck(this, UISegmentsAttribute);

			return _possibleConstructorReturn(this, _UIAttribute2.apply(this, arguments));
		}

		return UISegmentsAttribute;
	}(_uiAttribute.UIAttribute)) || _class4);

/***/ },
/* 96 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Step - http://semantic-ui.com/elements/step.html
	 */
	
	exports.__esModule = true;
	exports.UIStepsAttribute = exports.UIStepAttribute = undefined;
	
	var _dec, _dec2, _class, _desc, _value, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _dec3, _class4;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIStepAttribute = exports.UIStepAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'step'), _dec2 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_COLORS), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UIStepAttribute, _UIAttribute);
	
		function UIStepAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UIStepAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'active', _descriptor, _this), _initDefineProp(_this, 'disabled', _descriptor2, _this), _initDefineProp(_this, 'completed', _descriptor3, _this), _initDefineProp(_this, 'color', _descriptor4, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		UIStepAttribute.prototype.bind = function bind() {
			// No super
			this.element.classList.add('step');
		};
	
		return UIStepAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'active', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'disabled', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	}), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, 'completed', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	}), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, 'color', [_dec2], {
		enumerable: true,
		initializer: null
	})), _class2)) || _class);
	var UIStepsAttribute = exports.UIStepsAttribute = (_dec3 = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'steps'), _dec3(_class4 = function (_UIAttribute2) {
		_inherits(UIStepsAttribute, _UIAttribute2);

		function UIStepsAttribute() {
			_classCallCheck(this, UIStepsAttribute);

			return _possibleConstructorReturn(this, _UIAttribute2.apply(this, arguments));
		}

		return UIStepsAttribute;
	}(_uiAttribute.UIAttribute)) || _class4);

/***/ },
/* 97 */
/***/ function(module, exports) {

	'use strict';
	
	exports.__esModule = true;
	exports.configure = configure;
	/**
	 * Aurelia-Semantic-UI -- Aurelia components for Semantic-UI
	 * $Id$
	 *
	 * Authors
	 * - Michael Granger <ged@FaerieMUD.org>
	 */
	/*
	import 'node_modules/semantic-ui';
	import 'node_modules/semantic-ui/semantic.css!';*/
	
	var VERSION = exports.VERSION = '0.0.1-alpha.4';
	
	// Aurelia plugin hook
	function configure(config) {
		config.globalResources('./collections/ui-breadcrumb', './collections/ui-form', './collections/ui-grid', './collections/ui-menu', './collections/ui-message', './collections/ui-table', './elements/ui-button', './elements/ui-container', './elements/ui-divider', './elements/ui-flag', './elements/ui-header', './elements/ui-icon', './elements/ui-image', './elements/ui-input', './elements/ui-label', './elements/ui-list', './elements/ui-loader', './elements/ui-rail', './elements/ui-reveal', './elements/ui-segment', './elements/ui-step', './modules/ui-accordion', './modules/ui-dropdown', './modules/ui-modal', './modules/ui-search', './modules/ui-sidebar', './views/ui-card', './views/ui-statistic');
	}

/***/ },
/* 98 */
/***/ function(module, exports, __webpack_require__) {

	/* WEBPACK VAR INJECTION */(function($) {/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Accordion - http://semantic-ui.com/modules/accordion.html
	 */
	
	exports.__esModule = true;
	exports.UIAccordionAttribute = undefined;
	
	var _dec, _class;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var UIAccordionAttribute = exports.UIAccordionAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'accordion'), _dec(_class = function (_UIAttribute) {
	    _inherits(UIAccordionAttribute, _UIAttribute);
	
	    function UIAccordionAttribute() {
	        _classCallCheck(this, UIAccordionAttribute);
	
	        return _possibleConstructorReturn(this, _UIAttribute.apply(this, arguments));
	    }
	
	    UIAccordionAttribute.prototype.attached = function attached() {
	        this.logger.debug("Activating accordion for ", this.element);
	        $(this.element).accordion();
	    };
	
	    return UIAccordionAttribute;
	}(_uiAttribute.UIAttribute)) || _class);
	/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(13)))

/***/ },
/* 99 */
/***/ function(module, exports, __webpack_require__) {

	/* WEBPACK VAR INJECTION */(function($) {/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Dropdown - http://semantic-ui.com/modules/dropdown.html
	 */
	
	exports.__esModule = true;
	exports.UIDropdownAttribute = undefined;
	
	var _dec, _dec2, _class, _desc, _value, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIDropdownAttribute = exports.UIDropdownAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'dropdown'), _dec2 = (0, _aureliaFramework.bindable)({ defaultBindingMode: _aureliaFramework.bindingMode.twoWay }), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UIDropdownAttribute, _UIAttribute);
	
		function UIDropdownAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UIDropdownAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'selection', _descriptor, _this), _initDefineProp(_this, 'loading', _descriptor2, _this), _initDefineProp(_this, 'error', _descriptor3, _this), _initDefineProp(_this, 'disabled', _descriptor4, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		UIDropdownAttribute.prototype.bind = function bind() {
			var _UIAttribute$prototyp;
	
			for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
				args[_key2] = arguments[_key2];
			}
	
			(_UIAttribute$prototyp = _UIAttribute.prototype.bind).call.apply(_UIAttribute$prototyp, [this].concat(args));
	
			if (this.selection) {
				var name = this.selection;
				this.logger.debug("Selection set to: ", name);
				this.element.classList.add('selection');
	
				if (this.element.tagName !== 'select') {
					this.logger.debug("Non-select dropdown.");
	
					// TODO: This doesn't work yet; it injects the hidden field, but the binding
					// doesn't work. It likely needs to be hooked up manually, but I have no
					// clue how to do that currently.
					var input = this.element.querySelector('input[type=hidden]');
					if (!input) {
						this.logger.debug('No hidden input for ' + name + '; creating one.');
						input = document.createElement('input');
						input.type = 'hidden';
						input.name = name;
	
						var binding = document.createAttribute("value.bind");
						binding.value = name;
						input.setAttributeNode(binding);
	
						this.element.insertBefore(input, this.element.firstChild);
					} else {
						this.logger.debug("Already has a hidden element: ", input);
					}
				}
			}
		};
	
		UIDropdownAttribute.prototype.attached = function attached() {
			this.logger.debug("Activating dropdown for ", this.element);
			$(this.element).dropdown();
		};
	
		return UIDropdownAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'selection', [_dec2], {
		enumerable: true,
		initializer: null
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'loading', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	}), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, 'error', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	}), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, 'disabled', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	})), _class2)) || _class);
	/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(13)))

/***/ },
/* 100 */
/***/ function(module, exports, __webpack_require__) {

	/* WEBPACK VAR INJECTION */(function($) {/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Modal - http://semantic-ui.com/modules/modal.html
	 */
	
	exports.__esModule = true;
	exports.UIModalAttribute = undefined;
	
	var _dec, _class, _desc, _value, _class2, _descriptor;
	
	var _constants = __webpack_require__(75);
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _uiAttribute = __webpack_require__(76);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIModalAttribute = exports.UIModalAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'modal'), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UIModalAttribute, _UIAttribute);
	
		function UIModalAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UIModalAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'active', _descriptor, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		UIModalAttribute.prototype.attached = function attached() {
			$(this.element).modal();
		};
	
		UIModalAttribute.prototype.activeChanged = function activeChanged(newValue) {
			if (newValue) {
				$(this.element).modal('show');
			} else {
				$(this.element).modal('hide');
			}
		};
	
		return UIModalAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'active', [_uiAttribute.bindableToggle], {
		enumerable: true,
		initializer: function initializer() {
			return false;
		}
	})), _class2)) || _class);
	/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(13)))

/***/ },
/* 101 */
/***/ function(module, exports, __webpack_require__) {

	/* WEBPACK VAR INJECTION */(function($) {/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Search - http://semantic-ui.com/modules/search.html
	 */
	
	exports.__esModule = true;
	exports.UISearchAttribute = undefined;
	
	var _dec, _class;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var UISearchAttribute = exports.UISearchAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'search'), _dec(_class = function (_UIAttribute) {
		_inherits(UISearchAttribute, _UIAttribute);
	
		function UISearchAttribute() {
			_classCallCheck(this, UISearchAttribute);
	
			return _possibleConstructorReturn(this, _UIAttribute.apply(this, arguments));
		}
	
		UISearchAttribute.prototype.attached = function attached() {
			this.logger.debug("Activating search on ", this.element);
			$(this.element).search();
		};
	
		return UISearchAttribute;
	}(_uiAttribute.UIAttribute)) || _class);
	/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(13)))

/***/ },
/* 102 */
/***/ function(module, exports, __webpack_require__) {

	/* WEBPACK VAR INJECTION */(function($) {/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Sidebar - http://semantic-ui.com/modules/sidebar.html
	 */
	
	exports.__esModule = true;
	exports.UISidebarAttribute = undefined;
	
	var _dec, _class, _desc, _value, _class2, _descriptor, _descriptor2;
	
	var _constants = __webpack_require__(75);
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _uiAttribute = __webpack_require__(76);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UISidebarAttribute = exports.UISidebarAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'sidebar'), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UISidebarAttribute, _UIAttribute);
	
		function UISidebarAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UISidebarAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'context', _descriptor, _this), _initDefineProp(_this, 'events', _descriptor2, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		UISidebarAttribute.prototype.attached = function attached() {
			this.logger.debug("Sidebar attached: ", this.element);
			if (this.context) {
				var contextEl = $(this.element).parent(this.context).first();
				$(this.element).sidebar({ context: contextEl });
			}
	
			if (this.events) {
				var _contextEl = $(this.element).parent(this.events).first();
				$(this.element).sidebar('attach events', _contextEl);
			}
		};
	
		UISidebarAttribute.prototype.toggle = function toggle() {
			$(this.element).sidebar('toggle');
		};
	
		return UISidebarAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'context', [_aureliaFramework.bindable], {
		enumerable: true,
		initializer: null
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'events', [_aureliaFramework.bindable], {
		enumerable: true,
		initializer: null
	})), _class2)) || _class);
	/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(13)))

/***/ },
/* 103 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Card - http://semantic-ui.com/views/card.html
	 */
	
	exports.__esModule = true;
	exports.UICardAttribute = undefined;
	
	var _dec, _class;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var UICardAttribute = exports.UICardAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'card'), _dec(_class = function (_UIAttribute) {
	  _inherits(UICardAttribute, _UIAttribute);

	  function UICardAttribute() {
	    _classCallCheck(this, UICardAttribute);

	    return _possibleConstructorReturn(this, _UIAttribute.apply(this, arguments));
	  }

	  return UICardAttribute;
	}(_uiAttribute.UIAttribute)) || _class);

/***/ },
/* 104 */
/***/ function(module, exports, __webpack_require__) {

	/* -*- javascript -*- */
	"use strict";
	
	/**
	 * Statistic - http://semantic-ui.com/views/statistic.html
	 */
	
	exports.__esModule = true;
	exports.UIStatisticsAttribute = exports.UIStatisticAttribute = undefined;
	
	var _dec, _dec2, _dec3, _class, _desc, _value, _class2, _descriptor, _descriptor2, _dec4, _dec5, _dec6, _class4, _desc2, _value2, _class5, _descriptor3, _descriptor4;
	
	var _constants = __webpack_require__(75);
	
	var _uiAttribute = __webpack_require__(76);
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
		if (!descriptor) return;
		Object.defineProperty(target, property, {
			enumerable: descriptor.enumerable,
			configurable: descriptor.configurable,
			writable: descriptor.writable,
			value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
		});
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
		var desc = {};
		Object['ke' + 'ys'](descriptor).forEach(function (key) {
			desc[key] = descriptor[key];
		});
		desc.enumerable = !!desc.enumerable;
		desc.configurable = !!desc.configurable;
	
		if ('value' in desc || desc.initializer) {
			desc.writable = true;
		}
	
		desc = decorators.slice().reverse().reduce(function (desc, decorator) {
			return decorator(target, property, desc) || desc;
		}, desc);
	
		if (context && desc.initializer !== void 0) {
			desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
			desc.initializer = undefined;
		}
	
		if (desc.initializer === void 0) {
			Object['define' + 'Property'](target, property, desc);
			desc = null;
		}
	
		return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
		throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var UIStatisticAttribute = exports.UIStatisticAttribute = (_dec = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'statistic'), _dec2 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_SIZES), _dec3 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_COLORS), _dec(_class = (_class2 = function (_UIAttribute) {
		_inherits(UIStatisticAttribute, _UIAttribute);
	
		function UIStatisticAttribute() {
			var _temp, _this, _ret;
	
			_classCallCheck(this, UIStatisticAttribute);
	
			for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
				args[_key] = arguments[_key];
			}
	
			return _ret = (_temp = (_this = _possibleConstructorReturn(this, _UIAttribute.call.apply(_UIAttribute, [this].concat(args))), _this), _initDefineProp(_this, 'size', _descriptor, _this), _initDefineProp(_this, 'color', _descriptor2, _this), _temp), _possibleConstructorReturn(_this, _ret);
		}
	
		return UIStatisticAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'size', [_dec2], {
		enumerable: true,
		initializer: null
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'color', [_dec3], {
		enumerable: true,
		initializer: null
	})), _class2)) || _class);
	var UIStatisticsAttribute = exports.UIStatisticsAttribute = (_dec4 = (0, _aureliaFramework.customAttribute)(_constants.constants.attributePrefix + 'statistics'), _dec5 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_SIZES), _dec6 = _uiAttribute.bindableEnum.apply(undefined, _constants.constants.VALID_COLORS), _dec4(_class4 = (_class5 = function (_UIAttribute2) {
		_inherits(UIStatisticsAttribute, _UIAttribute2);

		function UIStatisticsAttribute() {
			var _temp2, _this2, _ret2;

			_classCallCheck(this, UIStatisticsAttribute);

			for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
				args[_key2] = arguments[_key2];
			}

			return _ret2 = (_temp2 = (_this2 = _possibleConstructorReturn(this, _UIAttribute2.call.apply(_UIAttribute2, [this].concat(args))), _this2), _initDefineProp(_this2, 'size', _descriptor3, _this2), _initDefineProp(_this2, 'color', _descriptor4, _this2), _temp2), _possibleConstructorReturn(_this2, _ret2);
		}

		return UIStatisticsAttribute;
	}(_uiAttribute.UIAttribute), (_descriptor3 = _applyDecoratedDescriptor(_class5.prototype, 'size', [_dec5], {
		enumerable: true,
		initializer: null
	}), _descriptor4 = _applyDecoratedDescriptor(_class5.prototype, 'color', [_dec6], {
		enumerable: true,
		initializer: null
	})), _class5)) || _class4);

/***/ },
/* 105 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.FormControl = undefined;
	
	var _dec, _dec2, _dec3, _dec4, _class, _desc, _value, _class2, _descriptor, _descriptor2;
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
	  if (!descriptor) return;
	  Object.defineProperty(target, property, {
	    enumerable: descriptor.enumerable,
	    configurable: descriptor.configurable,
	    writable: descriptor.writable,
	    value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
	  });
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
	  var desc = {};
	  Object['ke' + 'ys'](descriptor).forEach(function (key) {
	    desc[key] = descriptor[key];
	  });
	  desc.enumerable = !!desc.enumerable;
	  desc.configurable = !!desc.configurable;
	
	  if ('value' in desc || desc.initializer) {
	    desc.writable = true;
	  }
	
	  desc = decorators.slice().reverse().reduce(function (desc, decorator) {
	    return decorator(target, property, desc) || desc;
	  }, desc);
	
	  if (context && desc.initializer !== void 0) {
	    desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
	    desc.initializer = undefined;
	  }
	
	  if (desc.initializer === void 0) {
	    Object['define' + 'Property'](target, property, desc);
	    desc = null;
	  }
	
	  return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
	  throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	//default value of the property, if not bound or set in HTML
	var FormControl = exports.FormControl = (_dec = (0, _aureliaFramework.customElement)('form-control'), _dec2 = (0, _aureliaFramework.containerless)(), _dec3 = (0, _aureliaFramework.bindable)({
	  name: 'value', //name of the property on the class
	  attribute: 'value', //name of the attribute in HTML
	
	  defaultBindingMode: 2, //default binding mode used with the .bind command
	  defaultValue: undefined //default value of the property, if not bound or set in HTML
	}), _dec4 = (0, _aureliaFramework.bindable)({
	  name: 'type', //name of the property on the class
	  attribute: 'type', //name of the attribute in HTML
	  defaultValue: 'text' }), _dec(_class = _dec2(_class = _dec3(_class = _dec4(_class = (_class2 = function FormControl() {
	  _classCallCheck(this, FormControl);

	  _initDefineProp(this, 'name', _descriptor, this);

	  _initDefineProp(this, 'label', _descriptor2, this);
	}, (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'name', [_aureliaFramework.bindable], {
	  enumerable: true,
	  initializer: null
	}), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, 'label', [_aureliaFramework.bindable], {
	  enumerable: true,
	  initializer: null
	})), _class2)) || _class) || _class) || _class) || _class);

/***/ },
/* 106 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <div class=\"field\">\n    <label for.bind=\"name\">${label}</label>\n    <input type.bind=\"type\" id.bind=\"name\" placeholder.bind=\"label\" value.bind=\"value\" class=\"mini\">\n  </div>\n</template>\n";

/***/ },
/* 107 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.FormSubmit = undefined;
	
	var _dec, _dec2, _class, _desc, _value, _class2, _descriptor;
	
	var _aureliaFramework = __webpack_require__(18);
	
	function _initDefineProp(target, property, descriptor, context) {
	  if (!descriptor) return;
	  Object.defineProperty(target, property, {
	    enumerable: descriptor.enumerable,
	    configurable: descriptor.configurable,
	    writable: descriptor.writable,
	    value: descriptor.initializer ? descriptor.initializer.call(context) : void 0
	  });
	}
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
	  var desc = {};
	  Object['ke' + 'ys'](descriptor).forEach(function (key) {
	    desc[key] = descriptor[key];
	  });
	  desc.enumerable = !!desc.enumerable;
	  desc.configurable = !!desc.configurable;
	
	  if ('value' in desc || desc.initializer) {
	    desc.writable = true;
	  }
	
	  desc = decorators.slice().reverse().reduce(function (desc, decorator) {
	    return decorator(target, property, desc) || desc;
	  }, desc);
	
	  if (context && desc.initializer !== void 0) {
	    desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
	    desc.initializer = undefined;
	  }
	
	  if (desc.initializer === void 0) {
	    Object['define' + 'Property'](target, property, desc);
	    desc = null;
	  }
	
	  return desc;
	}
	
	function _initializerWarningHelper(descriptor, context) {
	  throw new Error('Decorating class property failed. Please ensure that transform-class-properties is enabled.');
	}
	
	var FormSubmit = exports.FormSubmit = (_dec = (0, _aureliaFramework.customElement)('form-submit'), _dec2 = (0, _aureliaFramework.containerless)(), _dec(_class = _dec2(_class = (_class2 = function FormSubmit() {
	  _classCallCheck(this, FormSubmit);

	  _initDefineProp(this, 'label', _descriptor, this);
	}, (_descriptor = _applyDecoratedDescriptor(_class2.prototype, 'label', [_aureliaFramework.bindable], {
	  enumerable: true,
	  initializer: null
	})), _class2)) || _class) || _class);

/***/ },
/* 108 */
/***/ function(module, exports) {

	module.exports = "<template>\r\n\t<div class=\"form-group\">\r\n\t\t<div class=\"col-sm-offset-2 col-sm-10\">\r\n\t\t\t<button type=\"submit\" class=\"btn btn-primary\"><i class=\"fa fa-send\"></i> ${label}</button>\r\n\t\t</div>\r\n\t</div>\r\n</template>";

/***/ },
/* 109 */
/***/ function(module, exports) {

	'use strict';
	
	exports.__esModule = true;
	exports.configure = configure;
	function configure(aurelia) {
	  aurelia.globalResources('./form-control', './form-submit'
	  //    , './nav-bar'
	  );
	}

/***/ },
/* 110 */
/***/ function(module, exports) {

	"use strict";
	
	exports.__esModule = true;
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var Welcome = exports.Welcome = function Welcome() {
	  _classCallCheck(this, Welcome);
	};

/***/ },
/* 111 */
/***/ function(module, exports) {

	module.exports = "<template>\n<section class=\"au-animate\">\n<div id=\"example\" class=\"index full height\">\n  <div class=\"masthead segment bg9 inverted\">\n  <div class=\"ui container\">\n    <div class=\"introduction\">\n      <span class=\"ui black version label\">\n        0.0.1\n      </span>\n      <h1 class=\"ui inverted header\">\n        <span class=\"library\">\n          iQ - Admin App\n        </span>\n        <span class=\"tagline\">\n          built with Semantic User Interface\n        </span>\n      </h1>\n      <div class=\"ui hidden divider\"></div>\n      <a href=\"#/Questions\" class=\"ui huge inverted download button\">\n        Get Started with Questions\n      </a>\n    </div>\n  </div>\n</div>\n</div>\n</section>\n</template>\n";

/***/ },
/* 112 */,
/* 113 */,
/* 114 */,
/* 115 */,
/* 116 */,
/* 117 */,
/* 118 */,
/* 119 */,
/* 120 */,
/* 121 */,
/* 122 */,
/* 123 */,
/* 124 */,
/* 125 */
/***/ function(module, exports) {

	'use strict';
	
	exports.__esModule = true;
	var baseConfig = exports.baseConfig = {
	  'baseCtrlUrl': '/answers/',
	  'entityToSubscribe': 'answer'
	};

/***/ },
/* 126 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.Create = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _base = __webpack_require__(125);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var Create = exports.Create = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _aureliaEventAggregator.EventAggregator), _dec(_class = function () {
	  function Create(sails, router, eventAggregator) {
	    _classCallCheck(this, Create);
	
	    this.questionId = null;
	
	    this.sails = sails;
	    this.theRouter = router;
	    this.ea = eventAggregator;
	  }
	
	  Create.prototype.activate = function activate(params) {
	    this.questionId = params.id;
	  };
	
	  Create.prototype.submit = function submit() {
	    var _this = this;
	
	    this.sails.post('/questions/' + this.questionId + '/answers', this.entity).then(function (data) {
	      return _this.theRouter.navigate('');
	    });
	  };
	
	  Create.prototype.attached = function attached() {
	    this.ea.publish('InAddAnswerView', true);
	  };
	
	  Create.prototype.detached = function detached() {
	    this.ea.publish('InAddAnswerView', false);
	  };
	
	  return Create;
	}()) || _class);

/***/ },
/* 127 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <form class=\"ui form\" submit.delegate=\"submit()\">\n      <form-control name=\"text\" value.bind=\"entity.text\" label=\"Text\"></form-control>\n      <form-control name=\"desc\" value.bind=\"entity.desc\" label=\"Description\"></form-control>\n      <div class=\"field\">\n        <label for=\"isCorrect\">Is Correct Answer</label>\n        <div class=\"ui toggle checkbox\">\n          <input id=\"isCorrect\" type=\"checkbox\" name=\"public\" checked.bind=\"entity.isCorrect\">\n          <label> </label>\n        </div>\n      </div>\n      <button type=\"submit\" class=\"ui submit fluid button green\"><i class=\"send icon\"></i>Add</button>\n    </form>\n  </section>\n</template>\n";

/***/ },
/* 128 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.List = undefined;
	
	var _dec, _class;
	/*import {BaseListVM} from '../BaseCrudOperations/BaseListVM';
	 import {baseConfig} from './base';*/
	
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	__webpack_require__(13);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var List = exports.List = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _aureliaEventAggregator.EventAggregator), _dec(_class = function () {
	  function List(sails, router, eventAggregator) {
	    _classCallCheck(this, List);
	
	    this.sails = sails;
	    this.router = router;
	    this.ea = eventAggregator;
	  }
	
	  List.prototype.attached = function attached() {
	    this.ea.publish('InAnswersView', true);
	  };
	
	  List.prototype.detached = function detached() {
	    this.ea.publish('InAnswersView', false);
	  };
	
	  List.prototype.activate = function activate(params) {
	    var _this = this;
	
	    this.questionId = params.id;
	    return this.sails.get('/answers?question=' + params.id).then(function (res) {
	      _this.entities = res.body;
	    }).catch(function (res) {
	      console.log(res);
	    });
	  };
	
	  return List;
	}()) || _class);

/***/ },
/* 129 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <div class=\"ui toggle checkbox\">\n      <input type=\"checkbox\" name=\"public\" checked.bind=\"isCelled\"> \n      <label>Toggle Celled Table</label>\n    </div>\n    <a class=\"ui submit button blue\" route-href=\"route: addAnswer; params.bind: { id: questionId }\"><i class=\"plus icon\"></i>Add Answer</a>\n    <table class=\"striped ${isCelled?'celled':''} green compact\"  ui-table=\"\">\n      <thead>\n      <th>Text</th>\n      <th>Description</th>\n      <th>Is Correct Answer</th>\n      <th>Actions</th>\n      </thead>\n      <tbody>\n      <tr repeat.for=\"obj of entities\">\n        <td>${obj.text}</td>\n        <td>${obj.desc}</td>\n        <td><i class=\"${obj.isCorrect  ?'checkmark green':'remove red'} icon\"></i></td>\n        <td>\n          <a class=\"btn btn-xs\" route-href=\"route: viewAnswer; params.bind: { answerId: obj.id, id: questionId }\"><i class=\"edit icon\" data-content=\"Edit\"></i></a>\n          <a class=\"btn btn-xs\" route-href=\"route: viewAnswer; params.bind: { answerId: obj.id, id: questionId }\"><i class=\"trash outline icon red\" data-content=\"Delete\"></i></a>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </section>\n</template>\n";

/***/ },
/* 130 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.View = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _BaseViewVM2 = __webpack_require__(16);
	
	var _base = __webpack_require__(125);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var View = exports.View = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _aureliaEventAggregator.EventAggregator), _dec(_class = function (_BaseViewVM) {
	  _inherits(View, _BaseViewVM);
	
	  function View(sails, router, eventAggregator) {
	    _classCallCheck(this, View);
	
	    return _possibleConstructorReturn(this, _BaseViewVM.call(this, sails, router, eventAggregator, _base.baseConfig));
	  }
	
	  View.prototype.attached = function attached() {};
	
	  View.prototype.detached = function detached() {};
	
	  View.prototype.getIdParam = function getIdParam(params) {
	    return params.answerId;
	  };
	
	  return View;
	}(_BaseViewVM2.BaseViewVM)) || _class);

/***/ },
/* 131 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <form class=\"ui form\" submit.delegate=\"submit()\">\n      <form-control name=\"text\" value.bind=\"entity.text\" label=\"Text\"></form-control>\n      <form-control name=\"desc\" value.bind=\"entity.desc\" label=\"Description\"></form-control>\n      <div class=\"field\">\n        <label for=\"isCorrect\">Is Correct Answer</label>\n        <div class=\"ui toggle checkbox\">\n          <input id=\"isCorrect\" type=\"checkbox\" name=\"public\" checked.bind=\"entity.isCorrect\">\n          <label> </label>\n        </div>\n      </div>\n      <button type=\"submit\" class=\"ui submit button blue\"><i class=\"upload icon\"></i>Update</button>\n      <div class=\"ui vertical animated red button\" click.delegate=\"deleteEntity()\">\n        <div class=\"hidden content\">Delete</div>\n        <div class=\"visible content\">\n          <i class=\"trash outline icon\"></i>\n        </div>\n      </div>\n    </form>\n  </section>\n</template>\n";

/***/ },
/* 132 */
/***/ function(module, exports) {

	'use strict';
	
	exports.__esModule = true;
	var baseConfig = exports.baseConfig = {
	  'baseCtrlUrl': '/questions/',
	  'entityToSubscribe': 'question'
	};

/***/ },
/* 133 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.ChildRouter = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var ChildRouter = exports.ChildRouter = (_dec = (0, _aureliaFramework.inject)(_aureliaEventAggregator.EventAggregator), _dec(_class = function () {
	  ChildRouter.prototype.configureRouter = function configureRouter(config, router) {
	    config.map([{ route: '', name: 'list', moduleId: 'question/list', title: 'List', nav: true, settings: { icon: 'list outline' } }, { route: 'create', name: 'create', moduleId: 'question/create', title: 'Add Question', nav: true, settings: { icon: 'plus' } }, { route: '/:id', name: 'details', moduleId: 'question/view', title: 'Details' }, { route: '/:id/answers', name: 'answers', moduleId: 'question/answers/list', title: 'Answers' }, { route: '/:id/answers/create', name: 'addAnswer', moduleId: 'question/answers/create', title: 'Answers', settings: { icon: 'list-alt' } }, { route: '/:id/answers/:answerId', name: 'viewAnswer', moduleId: 'question/answers/view', title: 'Details' }]);
	    this.router = router;
	  };
	
	  function ChildRouter(eventAggregator) {
	    _classCallCheck(this, ChildRouter);
	
	    this.ea = eventAggregator;
	  }
	
	  ChildRouter.prototype.attached = function attached() {
	    var _this = this;
	
	    this.subscriber = this.ea.subscribe('InEditMode', function (data) {
	      return _this.isEdit = data;
	    });
	    this.subscriber = this.ea.subscribe('InAnswersView', function (data) {
	      return _this.isAnswersView = data;
	    });
	    this.subscriber = this.ea.subscribe('InAddAnswerView', function (data) {
	      return _this.isAddAnswerView = data;
	    });
	  };
	
	  return ChildRouter;
	}()) || _class);

/***/ },
/* 134 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <div class=\"ui pointing menu\">\n    <a repeat.for=\"row of router.navigation\" class=\"${row.isActive ? 'active' : ''} item\" href.bind=\"row.href\">\n      <i class=\"${row.settings.icon} icon\" data-content=\"View Answers\"></i>${row.title}\n    </a>\n    <a class=\"${isEdit ? 'active' : ''} item\">\n      <i class=\"unhide icon\"></i>Edit/Delete\n    </a>\n    <a class=\"${isAnswersView ? 'active' : ''} item\">\n      <i class=\"sitemap icon\"></i>Answers\n    </a>\n    <a class=\"${isAddAnswerView ? 'active' : ''} item\">\n      <i class=\"plus icon\"></i>Add Answer\n    </a>\n  </div>\n  <div class=\"ui segment\">\n    <section class=\"au-animate\">\n      <router-view></router-view>\n    </section>\n  </div>\n</template>\n";

/***/ },
/* 135 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.Create = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _BaseCreateVM2 = __webpack_require__(11);
	
	var _base = __webpack_require__(132);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var Create = exports.Create = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _base.baseConfig), _dec(_class = function (_BaseCreateVM) {
	  _inherits(Create, _BaseCreateVM);
	
	  function Create(sails, router, baseConfig) {
	    _classCallCheck(this, Create);
	
	    return _possibleConstructorReturn(this, _BaseCreateVM.call(this, sails, router, baseConfig));
	  }
	
	  Create.prototype.activate = function activate(params) {
	    var _this2 = this;
	
	    return Promise.all([this.sails.get("/questionCategories").then(function (res) {
	      _this2.questionCategories = res.body;
	    }).catch(function (res) {
	      console.log('error');
	      console.log(res);
	    }), this.sails.get("/questionKinds").then(function (res) {
	      _this2.questionKinds = res.body;
	    }).catch(function (res) {
	      console.log('error');
	      console.log(res);
	    })]);
	  };
	
	  return Create;
	}(_BaseCreateVM2.BaseCreateVM)) || _class);

/***/ },
/* 136 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <form class=\"ui form\" submit.delegate=\"submit()\">\n      <div class=\"field\">\n        <label for.bind=\"type\" class=\"col-sm-2 control-label\">Kind</label>\n        <div ui-dropdown=\"selection: entity.kind.id\">\n          <input type=\"hidden\" value.bind=\"entity.kind.id\">\n          <i class=\"dropdown icon\"></i>\n          <div class=\"default text\">Please Select</div>\n          <div class=\"menu\">\n            <div class=\"item\" data-value.bind=\"k.id\" repeat.for=\"k of questionKinds\">${k.text}</div>\n          </div>\n        </div>\n      </div>\n      <div class=\"field\">\n        <label for.bind=\"type\" class=\"col-sm-2 control-label\">Category</label>\n        <div ui-dropdown=\"selection: entity.category.id\">\n          <input type=\"hidden\" value.bind=\"entity.category.id\">\n          <i class=\"dropdown icon\"></i>\n          <div class=\"default text\">Please Select</div>\n          <div class=\"menu\">\n            <div class=\"item\" data-value.bind=\"k.id\" repeat.for=\"k of questionCategories\">${k.text}</div>\n          </div>\n        </div>\n      </div>\n      <div class=\"field\">\n        <label for=\"Question\">Question</label>\n        <textarea id=\"Question\" name=\"text\" value.bind=\"entity.text\"></textarea>\n      </div>\n      <div class=\"field\">\n        <label for=\"isMultipleChoice\">Is Multiple Choice</label>\n        <div class=\"ui toggle checkbox\">\n          <input type=\"checkbox\" id=\"isMultipleChoice\" checked.bind=\"entity.isMultipleChoice\">\n          <label> </label>\n        </div>\n      </div>\n      <div class=\"field\">\n        <label for=\"hasManyAnswers\">Has Many Answers</label>\n        <div class=\"ui toggle checkbox\">\n          <input type=\"checkbox\" id=\"hasManyAnswers\" checked.bind=\"entity.hasManyAnswers\">\n          <label> </label>\n        </div>\n      </div>\n      <form-control name=\"score\" value.bind=\"entity.score\" label=\"Score\" type=\"number\"></form-control>\n      <button type=\"submit\" class=\"submit fluid green\" ui-button=\"icon:send\">Add</button>\n    </form>\n  </section>\n</template>\n";

/***/ },
/* 137 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.AddAnswer = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var AddAnswer = exports.AddAnswer = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router), _dec(_class = function () {
	  function AddAnswer(sails, router) {
	    _classCallCheck(this, AddAnswer);
	
	    this.entity = {};
	
	    this.sails = sails;
	    this.router = router;
	  }
	
	  AddAnswer.prototype.submit = function submit() {
	    var _this = this;
	
	    this.sails.put('' + this.baseCtrlUrl + this.entity.id, entity).then(function (data) {
	      return _this.router.navigate('');
	    });
	  };
	
	  AddAnswer.prototype.activate = function activate(params) {
	    var _this2 = this;
	
	    return this.sails.get('/answers').then(function (res) {
	      _this2.answers = res.body;
	      console.log(_this2.entity.kind.id);
	    }).catch(function (res) {
	      console.log(res);
	    });
	  };
	
	  return AddAnswer;
	}()) || _class);

/***/ },
/* 138 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n\n  </section>\n</template>\n";

/***/ },
/* 139 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.ChildRouter = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var ChildRouter = exports.ChildRouter = (_dec = (0, _aureliaFramework.inject)(_aureliaEventAggregator.EventAggregator), _dec(_class = function () {
	  ChildRouter.prototype.configureRouter = function configureRouter(config, router) {
	    config.map([{ route: [''], name: 'details', moduleId: 'question/details/view', title: 'Details', nav: true, settings: { icon: 'list-alt' } }, { route: ['/addAnswer'], name: 'addAnswer', moduleId: 'question/details/addAnswer', title: 'Add Answer', nav: true }]);
	    this.router = router;
	  };
	
	  function ChildRouter(eventAggregator) {
	    _classCallCheck(this, ChildRouter);
	
	    this.ea = eventAggregator;
	  }
	
	  ChildRouter.prototype.attached = function attached() {
	    var _this = this;
	
	    this.subscriber = this.ea.subscribe('InEditMode', function (data) {
	      return _this.isEdit = data;
	    });
	  };
	
	  return ChildRouter;
	}()) || _class);

/***/ },
/* 140 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <div class=\"ui pointing menu\">\n    <a repeat.for=\"row of router.navigation\" class=\"${row.isActive ? 'active' : ''} item\" href.bind=\"row.href\">\n      ${row.title}\n    </a>\n  </div>\n\n    <section class=\"au-animate\">\n      <router-view></router-view>\n    </section>\n\n</template>\n";

/***/ },
/* 141 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.View = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _BaseViewVM2 = __webpack_require__(16);
	
	var _base = __webpack_require__(132);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var View = exports.View = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _aureliaEventAggregator.EventAggregator), _dec(_class = function (_BaseViewVM) {
	  _inherits(View, _BaseViewVM);
	
	  function View(sails, router, eventAggregator) {
	    _classCallCheck(this, View);
	
	    return _possibleConstructorReturn(this, _BaseViewVM.call(this, sails, router, eventAggregator, _base.baseConfig));
	  }
	
	  View.prototype.submit = function submit() {
	    var _this2 = this;
	
	    //Work around to https://github.com/balderdashy/sails/issues/1573
	    var entity = {
	      id: this.entity.id, category: { id: this.entity.category.id }, kind: { id: this.entity.kind.id },
	      text: this.entity.text,
	      isMultipleChoice: this.entity.isMultipleChoice,
	      hasManyAnswers: this.entity.hasManyAnswers, score: this.entity.score
	    };
	    this.sails.put('' + this.baseCtrlUrl + this.entity.id, entity).then(function (data) {
	      return _this2.router.navigate('/Questions/');
	    });
	  };
	
	  View.prototype.activate = function activate(params) {
	    var _this3 = this;
	
	    return Promise.all([this.sails.get('' + _base.baseConfig.baseCtrlUrl + params.id + '?populate=kind,category,answers').then(function (res) {
	      _this3.entity = res.body;
	      console.log(_this3.entity.kind.id);
	    }).catch(function (res) {
	      console.log(res);
	    }), this.sails.get("/questionCategories").then(function (res) {
	      _this3.questionCategories = res.body;
	    }).catch(function (res) {
	      console.log(res);
	    }), this.sails.get("/questionKinds").then(function (res) {
	      _this3.questionKinds = res.body;
	    }).catch(function (res) {
	      console.log(res);
	    })]);
	  };
	
	  return View;
	}(_BaseViewVM2.BaseViewVM)) || _class);

/***/ },
/* 142 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <form submit.delegate=\"submit()\" ui-form>\n      <div class=\"field\">\n        <label for.bind=\"type\" class=\"col-sm-2 control-label\">Kind</label>\n        <div ui-dropdown=\"selection: entity.kind.id\">\n          <input type=\"hidden\" value.bind=\"entity.kind.id\">\n          <i class=\"dropdown icon\"></i>\n          <div class=\"default text\">Please Select</div>\n          <div class=\"menu\">\n            <div class=\"item\" data-value.bind=\"k.id\" repeat.for=\"k of questionKinds\">${k.text}</div>\n          </div>\n        </div>\n      </div>\n      <div class=\"field\">\n        <label for.bind=\"type\" class=\"col-sm-2 control-label\">Category</label>\n        <div ui-dropdown=\"selection: entity.category.id\">\n          <input type=\"hidden\" value.bind=\"entity.category.id\">\n          <i class=\"dropdown icon\"></i>\n          <div class=\"default text\">Please Select</div>\n          <div class=\"menu\">\n            <div class=\"item\" data-value.bind=\"k.id\" repeat.for=\"k of questionCategories\">${k.text}</div>\n          </div>\n        </div>\n      </div>\n      <div class=\"field\">\n        <label for=\"Question\">Question</label>\n        <textarea id=\"Question\" name=\"text\" value.bind=\"entity.text\"></textarea>\n      </div>\n      <div class=\"field\">\n        <label for=\"isMultipleChoice\">Is Multiple Choice</label>\n        <div class=\"ui toggle checkbox\">\n          <input type=\"checkbox\" id=\"isMultipleChoice\" checked.bind=\"entity.isMultipleChoice\">\n          <label> </label>\n        </div>\n      </div>\n      <div class=\"field\">\n        <label for=\"hasManyAnswers\">Has Many Answers</label>\n        <div class=\"ui toggle checkbox\">\n          <input type=\"checkbox\" id=\"hasManyAnswers\" checked.bind=\"entity.hasManyAnswers\">\n          <label> </label>\n        </div>\n      </div>\n      <form-control value.bind=\"entity.score\" label=\"Score\" type=\"number\"></form-control>\n      <button type=\"submit\" class=\"ui submit button blue\"><i class=\"upload icon\"></i>Update</button>\n      <div class=\"ui vertical animated red button\" click.delegate=\"deleteEntity()\">\n        <div class=\"hidden content\">Delete</div>\n        <div class=\"visible content\">\n          <i class=\"trash outline icon\"></i>\n        </div>\n      </div>\n    </form>\n\n    <div class=\"ui toggle checkbox\">\n      <input type=\"checkbox\" name=\"public\" checked.bind=\"isCelled\">\n      <label>Toggle Celled Table</label>\n    </div>\n    <table class=\"striped ${isCelled?'celled':''}\"  ui-table=\"\">\n      <thead>\n      <th>Text</th>\n      <th>Description</th>\n      <th>Actions</th>\n      </thead>\n      <tbody>\n      <tr repeat.for=\"obj of entity.answers\">\n        <td>${obj.text}</td>\n        <td>${obj.desc}</td>\n        <td>\n          <a class=\"btn btn-xs\" route-href=\"route: details; params.bind: { id: obj.id }\"><i class=\"trash outline icon red\" data-content=\"Delete\"></i></a>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </section>\n</template>\n";

/***/ },
/* 143 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.List = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _BaseListVM2 = __webpack_require__(12);
	
	var _base = __webpack_require__(132);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var List = exports.List = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _base.baseConfig), _dec(_class = function (_BaseListVM) {
	  _inherits(List, _BaseListVM);
	
	  function List(sails, router, config) {
	    _classCallCheck(this, List);
	
	    return _possibleConstructorReturn(this, _BaseListVM.call(this, sails, router, config));
	  }
	
	  List.prototype.activate = function activate() {
	    var _this2 = this;
	
	    return this.sails.get(this.baseCtrlUrl + '?populate=kind,category').then(function (res) {
	      _this2.entities = res.body;
	      _BaseListVM.prototype.subscribe.call(_this2);
	    }).catch(function (res) {
	      res.statusCode === 403 ? _this2.router.navigate('/login') : _BaseListVM.prototype.logger.error(res);
	    });
	  };
	
	  return List;
	}(_BaseListVM2.BaseListVM)) || _class);

/***/ },
/* 144 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <div class=\"ui toggle checkbox\">\n      <input type=\"checkbox\" name=\"public\" checked.bind=\"isCelled\"> \n      <label>Toggle Celled Table</label>\n    </div>\n    <table class=\"striped ${isCelled?'celled':''} green compact\"  ui-table=\"\">\n      <thead>\n      <th>Question</th>\n      <th>Kind</th>\n      <th>Category</th>\n      <th>Is Multiple Choice</th>\n      <th>Has Many Answers</th>\n      <th class=\"right aligned\">Score</th>\n      <th>Actions</th>\n      </thead>\n      <tbody>\n      <tr repeat.for=\"obj of entities\">\n        <td>${obj.text}</td>\n        <td>${obj.kind.text}</td>\n        <td>${obj.category.text}</td>\n        <td><i class=\"${obj.isMultipleChoice?'checkmark green':'remove red'} icon\"></i></td>\n        <td><i class=\"${obj.hasManyAnswers  ?'checkmark green':'remove red'} icon\"></i></td>\n        <td class=\"right aligned\">${obj.score}</td>\n        <td>\n          <a class=\"btn btn-xs\" route-href=\"route: details; params.bind: { id: obj.id }\"><i class=\"unhide icon\" data-content=\"View and edit\"></i></a>\n          <a class=\"btn btn-xs\" route-href=\"route: details; params.bind: { id: obj.id }\"><i class=\"trash outline icon red\" data-content=\"Delete\"></i></a>\n          <a class=\"btn btn-xs\" route-href=\"route: answers; params.bind: { id: obj.id }\"><i class=\"sitemap icon\" data-content=\"View Answers\"></i></a>\n          <a class=\"btn btn-xs\" route-href=\"route: addAnswer; params.bind: { id: obj.id }\"><i class=\" plus icon\" data-content=\"Add Answer\"></i></a>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n    </div>\n    </div>\n  </section>\n</template>\n";

/***/ },
/* 145 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.View = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _BaseViewVM2 = __webpack_require__(16);
	
	var _base = __webpack_require__(132);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var View = exports.View = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _aureliaEventAggregator.EventAggregator), _dec(_class = function (_BaseViewVM) {
	  _inherits(View, _BaseViewVM);
	
	  function View(sails, router, eventAggregator) {
	    _classCallCheck(this, View);
	
	    return _possibleConstructorReturn(this, _BaseViewVM.call(this, sails, router, eventAggregator, _base.baseConfig));
	  }
	
	  View.prototype.submit = function submit() {
	    var _this2 = this;
	
	    //Work around to https://github.com/balderdashy/sails/issues/1573
	    var entity = {
	      id: this.entity.id, category: { id: this.entity.category.id }, kind: { id: this.entity.kind.id },
	      text: this.entity.text,
	      isMultipleChoice: this.entity.isMultipleChoice,
	      hasManyAnswers: this.entity.hasManyAnswers, score: this.entity.score
	    };
	    this.sails.put('' + this.baseCtrlUrl + this.entity.id, entity).then(function (data) {
	      return _this2.router.navigate('');
	    });
	  };
	
	  View.prototype.activate = function activate(params) {
	    var _this3 = this;
	
	    return Promise.all([this.sails.get('' + _base.baseConfig.baseCtrlUrl + params.id + '?populate=kind,category,answers').then(function (res) {
	      _this3.entity = res.body;
	      console.log(_this3.entity.kind.id);
	    }).catch(function (res) {
	      console.log(res);
	    }), this.sails.get("/questionCategories").then(function (res) {
	      _this3.questionCategories = res.body;
	    }).catch(function (res) {
	      console.log(res);
	    }), this.sails.get("/questionKinds").then(function (res) {
	      _this3.questionKinds = res.body;
	    }).catch(function (res) {
	      console.log(res);
	    })]);
	  };
	
	  return View;
	}(_BaseViewVM2.BaseViewVM)) || _class);

/***/ },
/* 146 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <a class=\"ui submit button blue\" route-href=\"route: answers; params.bind: { id: entity.id }\"><i class=\"unordered list icon\"></i>Answers</a>\n    <a class=\"ui submit button blue\" route-href=\"route: addAnswer; params.bind: { id: entity.id }\"><i class=\"plus outline icon\"></i>Add Answer</a>\n    <form submit.delegate=\"submit()\" ui-form>\n      <div class=\"two fields\">\n        <div class=\"field\">\n          <label for.bind=\"type\" class=\"col-sm-2 control-label\">Kind</label>\n          <div ui-dropdown=\"selection: entity.kind.id\">\n            <input type=\"hidden\" value.bind=\"entity.kind.id\">\n            <i class=\"dropdown icon\"></i>\n            <div class=\"default text\">Please Select</div>\n            <div class=\"menu\">\n              <div class=\"item\" data-value.bind=\"k.id\" repeat.for=\"k of questionKinds\">${k.text}</div>\n            </div>\n          </div>\n        </div>\n        <div class=\"field\">\n          <label for.bind=\"type\" class=\"col-sm-2 control-label\">Category</label>\n          <div ui-dropdown=\"selection: entity.category.id\">\n            <input type=\"hidden\" value.bind=\"entity.category.id\">\n            <i class=\"dropdown icon\"></i>\n            <div class=\"default text\">Please Select</div>\n            <div class=\"menu\">\n              <div class=\"item\" data-value.bind=\"k.id\" repeat.for=\"k of questionCategories\">${k.text}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"field\">\n        <label for=\"Question\">Question</label>\n        <textarea id=\"Question\" name=\"text\" value.bind=\"entity.text\"></textarea>\n      </div>\n      <div class=\"three fields\">\n        <form-control value.bind=\"entity.score\" label=\"Score\" type=\"number\"></form-control>\n        <div class=\"field\">\n          <label for=\"isMultipleChoice\">Is Multiple Choice</label>\n          <div class=\"ui toggle checkbox\">\n            <input type=\"checkbox\" id=\"isMultipleChoice\" checked.bind=\"entity.isMultipleChoice\">\n            <label> </label>\n          </div>\n        </div>\n        <div class=\"field\">\n          <label for=\"hasManyAnswers\">Has Many Answers</label>\n          <div class=\"ui toggle checkbox\">\n            <input type=\"checkbox\" id=\"hasManyAnswers\" checked.bind=\"entity.hasManyAnswers\">\n            <label> </label>\n          </div>\n        </div>\n      </div>\n\n      <button type=\"submit\" class=\"ui submit button blue\"><i class=\"upload icon\"></i>Update</button>\n      <div class=\"ui animated red button\" click.delegate=\"deleteEntity()\">\n        <div class=\"hidden content\">Delete</div>\n        <div class=\"visible content\">\n          <i class=\"trash outline icon\"></i>\n        </div>\n      </div>\n    </form>\n  </section>\n</template>\n";

/***/ },
/* 147 */
/***/ function(module, exports) {

	'use strict';
	
	exports.__esModule = true;
	var baseConfig = exports.baseConfig = {
	  'baseCtrlUrl': '/questionCategories/',
	  'entityToSubscribe': 'questioncategory'
	};

/***/ },
/* 148 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.ChildRouter = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var ChildRouter = exports.ChildRouter = (_dec = (0, _aureliaFramework.inject)(_aureliaEventAggregator.EventAggregator), _dec(_class = function () {
	  ChildRouter.prototype.configureRouter = function configureRouter(config, router) {
	    config.map([{ route: [''], name: 'list', moduleId: 'questionCategory/list', title: 'List', nav: true, settings: { icon: 'list outline' } }, { route: ['create'], name: 'create', moduleId: 'questionCategory/create', title: 'Add New', nav: true, settings: { icon: 'plus' } }, { route: ['/:id'], name: 'details', moduleId: 'questionCategory/view', title: 'Details' }]);
	    this.router = router;
	  };
	
	  function ChildRouter(eventAggregator) {
	    _classCallCheck(this, ChildRouter);
	
	    this.ea = eventAggregator;
	  }
	
	  ChildRouter.prototype.attached = function attached() {
	    var _this = this;
	
	    this.subscriber = this.ea.subscribe('InEditMode', function (data) {
	      return _this.isEdit = data;
	    });
	  };
	
	  return ChildRouter;
	}()) || _class);

/***/ },
/* 149 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <div class=\"ui pointing menu\">\n    <a repeat.for=\"row of router.navigation\" class=\"${row.isActive ? 'active' : ''} item\" href.bind=\"row.href\">\n      <i class=\"${row.settings.icon} icon\" data-content=\"View Answers\"></i>${row.title}\n    </a>\n    <a class=\"${isEdit ? 'active' : ''} item\">\n      <i class=\"unhide icon\"></i>Edit/Delete\n    </a>\n  </div>\n  <div class=\"ui segment\">\n    <section class=\"au-animate\">\n      <router-view></router-view>\n    </section>\n  </div>\n</template>\n";

/***/ },
/* 150 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.Create = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _BaseCreateVM2 = __webpack_require__(11);
	
	var _base = __webpack_require__(147);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var Create = exports.Create = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _base.baseConfig), _dec(_class = function (_BaseCreateVM) {
	  _inherits(Create, _BaseCreateVM);
	
	  function Create(sails, router, baseConfig) {
	    _classCallCheck(this, Create);
	
	    return _possibleConstructorReturn(this, _BaseCreateVM.call(this, sails, router, baseConfig));
	  }
	
	  return Create;
	}(_BaseCreateVM2.BaseCreateVM)) || _class);

/***/ },
/* 151 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <form class=\"ui form\" submit.delegate=\"submit()\">\n      <form-control name=\"text\" value.bind=\"entity.text\" label=\"Text\"></form-control>\n      <form-control name=\"desc\" value.bind=\"entity.desc\" label=\"Description\"></form-control>\n      <button type=\"submit\" class=\"ui submit fluid button green\"><i class=\"send icon\"></i>Add</button>\n    </form>\n  </section>\n</template>\n";

/***/ },
/* 152 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.List = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _BaseListVM2 = __webpack_require__(12);
	
	var _base = __webpack_require__(147);
	
	__webpack_require__(13);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var List = exports.List = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _base.baseConfig), _dec(_class = function (_BaseListVM) {
	  _inherits(List, _BaseListVM);
	
	  function List(sails, router, config) {
	    _classCallCheck(this, List);
	
	    return _possibleConstructorReturn(this, _BaseListVM.call(this, sails, router, config));
	  }
	
	  return List;
	}(_BaseListVM2.BaseListVM)) || _class);

/***/ },
/* 153 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <div class=\"ui toggle checkbox\">\n      <input type=\"checkbox\" name=\"public\" checked.bind=\"isCelled\"> \n      <label>Toggle Celled Table</label>\n    </div>\n    <table class=\"striped ${isCelled?'celled':''} green compact\"  ui-table=\"\">\n      <thead>\n      <th>Text</th>\n      <th>Description</th>\n      <th>Actions</th>\n      </thead>\n      <tbody>\n      <tr repeat.for=\"obj of entities\">\n        <td>${obj.text}</td>\n        <td>${obj.desc}</td>\n        <td>\n          <a class=\"btn btn-xs\" route-href=\"route: details; params.bind: { id: obj.id }\"><i class=\"edit icon\" data-content=\"Edit\"></i></a>\n          <a class=\"btn btn-xs\" route-href=\"route: details; params.bind: { id: obj.id }\"><i class=\"trash outline icon red\" data-content=\"Delete\"></i></a>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </section>\n</template>\n";

/***/ },
/* 154 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.View = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _BaseViewVM2 = __webpack_require__(16);
	
	var _base = __webpack_require__(147);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var View = exports.View = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _aureliaEventAggregator.EventAggregator), _dec(_class = function (_BaseViewVM) {
	  _inherits(View, _BaseViewVM);
	
	  function View(sails, router, eventAggregator) {
	    _classCallCheck(this, View);
	
	    return _possibleConstructorReturn(this, _BaseViewVM.call(this, sails, router, eventAggregator, _base.baseConfig));
	  }
	
	  return View;
	}(_BaseViewVM2.BaseViewVM)) || _class);

/***/ },
/* 155 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <form class=\"ui form\" submit.delegate=\"submit()\">\n      <form-control name=\"text\" value.bind=\"entity.text\" label=\"Text\"></form-control>\n      <form-control name=\"desc\" value.bind=\"entity.desc\" label=\"Description\"></form-control>\n      <button type=\"submit\" class=\"ui submit button blue\"><i class=\"upload icon\"></i>Update</button>\n      <div class=\"ui vertical animated red button\" click.delegate=\"deleteEntity()\">\n        <div class=\"hidden content\">Delete</div>\n        <div class=\"visible content\">\n          <i class=\"trash outline icon\"></i>\n        </div>\n      </div>\n    </form>\n  </section>\n</template>\n";

/***/ },
/* 156 */
/***/ function(module, exports) {

	'use strict';
	
	exports.__esModule = true;
	var baseConfig = exports.baseConfig = {
	  'baseCtrlUrl': '/questionKinds/',
	  'entityToSubscribe': 'questionkind'
	};

/***/ },
/* 157 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.ChildRouter = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var ChildRouter = exports.ChildRouter = (_dec = (0, _aureliaFramework.inject)(_aureliaEventAggregator.EventAggregator), _dec(_class = function () {
	  ChildRouter.prototype.configureRouter = function configureRouter(config, router) {
	    config.map([{ route: [''], name: 'list', moduleId: 'questionKind/list', title: 'List', nav: true, settings: { icon: 'list outline' } }, { route: ['create'], name: 'create', moduleId: 'questionKind/create', title: 'Add New', nav: true, settings: { icon: 'plus' } }, { route: ['/:id'], name: 'details', moduleId: 'questionKind/view', title: 'Details' }]);
	    this.router = router;
	  };
	
	  function ChildRouter(eventAggregator) {
	    _classCallCheck(this, ChildRouter);
	
	    this.ea = eventAggregator;
	  }
	
	  ChildRouter.prototype.attached = function attached() {
	    var _this = this;
	
	    this.subscriber = this.ea.subscribe('InEditMode', function (data) {
	      return _this.isEdit = data;
	    });
	  };
	
	  return ChildRouter;
	}()) || _class);

/***/ },
/* 158 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <div class=\"ui pointing menu\">\n    <a repeat.for=\"row of router.navigation\" class=\"${row.isActive ? 'active' : ''} item\" href.bind=\"row.href\">\n      <i class=\"${row.settings.icon} icon\" data-content=\"View Answers\"></i>${row.title}\n    </a>\n    <a class=\"${isEdit ? 'active' : ''} item\">\n      <i class=\"unhide icon\"></i>Edit/Delete\n    </a>\n  </div>\n  <div class=\"ui segment\">\n    <section class=\"au-animate\">\n      <router-view></router-view>\n    </section>\n  </div>\n</template>\n";

/***/ },
/* 159 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.Create = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _base = __webpack_require__(156);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var Create = exports.Create = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router), _dec(_class = function () {
	  function Create(sails, router) {
	    _classCallCheck(this, Create);
	
	    this.sails = sails;
	    this.theRouter = router;
	  }
	
	  Create.prototype.submit = function submit() {
	    var _this = this;
	
	    this.sails.post(_base.baseConfig.baseCtrlUrl, this.entity).then(function (data) {
	      return _this.theRouter.navigate("");
	    });
	  };
	
	  return Create;
	}()) || _class);

/***/ },
/* 160 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <form class=\"ui form\" submit.delegate=\"submit()\">\n      <form-control name=\"text\" value.bind=\"entity.text\" label=\"Text\"></form-control>\n      <form-control name=\"desc\" value.bind=\"entity.desc\" label=\"Description\"></form-control>\n      <button type=\"submit\" class=\"ui submit fluid button green\"><i class=\"send icon\"></i>Add</button>\n    </form>\n  </section>\n</template>\n";

/***/ },
/* 161 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.List = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _BaseListVM2 = __webpack_require__(12);
	
	var _base = __webpack_require__(156);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var List = exports.List = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _base.baseConfig), _dec(_class = function (_BaseListVM) {
	  _inherits(List, _BaseListVM);
	
	  function List(sails, router, config) {
	    _classCallCheck(this, List);
	
	    return _possibleConstructorReturn(this, _BaseListVM.call(this, sails, router, config));
	  }
	
	  return List;
	}(_BaseListVM2.BaseListVM)) || _class);

/***/ },
/* 162 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <div class=\"ui toggle checkbox\">\n      <input type=\"checkbox\" name=\"public\" checked.bind=\"isCelled\"> \n      <label>Toggle Celled Table</label>\n    </div>\n    <table class=\"striped ${isCelled?'celled':''} green compact\"  ui-table=\"\">\n      <thead>\n      <th>Text</th>\n      <th>Description</th>\n      <th>Actions</th>\n      </thead>\n      <tbody>\n      <tr repeat.for=\"obj of entities\">\n        <td>${obj.text}</td>\n        <td>${obj.desc}</td>\n        <td>\n          <a class=\"btn btn-xs\" route-href=\"route: details; params.bind: { id: obj.id }\"><i class=\"edit icon\" data-content=\"Edit\"></i></a>\n          <a class=\"btn btn-xs\" route-href=\"route: details; params.bind: { id: obj.id }\"><i class=\"trash outline icon red\" data-content=\"Delete\"></i></a>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </section>\n</template>\n";

/***/ },
/* 163 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.View = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _BaseViewVM2 = __webpack_require__(16);
	
	var _base = __webpack_require__(156);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var View = exports.View = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _aureliaEventAggregator.EventAggregator), _dec(_class = function (_BaseViewVM) {
	  _inherits(View, _BaseViewVM);
	
	  function View(sails, router, eventAggregator) {
	    _classCallCheck(this, View);
	
	    return _possibleConstructorReturn(this, _BaseViewVM.call(this, sails, router, eventAggregator, _base.baseConfig));
	  }
	
	  return View;
	}(_BaseViewVM2.BaseViewVM)) || _class);

/***/ },
/* 164 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <form class=\"ui form\" submit.delegate=\"submit()\">\n      <form-control name=\"text\" value.bind=\"entity.text\" label=\"Text\"></form-control>\n      <form-control name=\"desc\" value.bind=\"entity.desc\" label=\"Description\"></form-control>\n      <button type=\"submit\" class=\"ui submit button blue\"><i class=\"upload icon\"></i>Update</button>\n      <div class=\"ui vertical animated red button\" click.delegate=\"deleteEntity()\">\n        <div class=\"hidden content\">Delete</div>\n        <div class=\"visible content\">\n          <i class=\"trash outline icon\"></i>\n        </div>\n      </div>\n    </form>\n  </section>\n</template>\n";

/***/ },
/* 165 */
/***/ function(module, exports) {

	'use strict';
	
	exports.__esModule = true;
	var baseConfig = exports.baseConfig = {
	  'baseCtrlUrl': '/questionTypes/',
	  'entityToSubscribe': 'questiontype'
	};

/***/ },
/* 166 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.ChildRouter = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var ChildRouter = exports.ChildRouter = (_dec = (0, _aureliaFramework.inject)(_aureliaEventAggregator.EventAggregator), _dec(_class = function () {
	  ChildRouter.prototype.configureRouter = function configureRouter(config, router) {
	    config.map([{ route: [''], name: 'list', moduleId: 'questionType/list', title: 'List', nav: true, settings: { icon: 'list outline' } }, { route: ['create'], name: 'create', moduleId: 'questionType/create', title: 'Add New', nav: true, settings: { icon: 'plus' } }, { route: ['/:id'], name: 'details', moduleId: 'questionType/view', title: 'Details' }]);
	    this.router = router;
	  };
	
	  function ChildRouter(eventAggregator) {
	    _classCallCheck(this, ChildRouter);
	
	    this.ea = eventAggregator;
	  }
	
	  ChildRouter.prototype.attached = function attached() {
	    var _this = this;
	
	    this.subscriber = this.ea.subscribe('InEditMode', function (data) {
	      return _this.isEdit = data;
	    });
	  };
	
	  return ChildRouter;
	}()) || _class);

/***/ },
/* 167 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <div class=\"ui pointing menu\">\n    <a repeat.for=\"row of router.navigation\" class=\"${row.isActive ? 'active' : ''} item\" href.bind=\"row.href\">\n      <i class=\"${row.settings.icon} icon\" data-content=\"View Answers\"></i>${row.title}\n    </a>\n    <a class=\"${isEdit ? 'active' : ''} item\">\n      <i class=\"unhide icon\"></i>Edit/Delete\n    </a>\n  </div>\n  <div class=\"ui segment\">\n    <section class=\"au-animate\">\n      <router-view></router-view>\n    </section>\n  </div>\n</template>\n";

/***/ },
/* 168 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.Create = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _base = __webpack_require__(165);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var Create = exports.Create = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router), _dec(_class = function () {
	  function Create(sails, router) {
	    _classCallCheck(this, Create);
	
	    this.sails = sails;
	    this.theRouter = router;
	  }
	
	  Create.prototype.submit = function submit() {
	    var _this = this;
	
	    this.sails.post(_base.baseConfig.baseCtrlUrl, this.entity).then(function (data) {
	      return _this.theRouter.navigate("");
	    });
	  };
	
	  return Create;
	}()) || _class);

/***/ },
/* 169 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <form class=\"ui form\" submit.delegate=\"submit()\">\n      <form-control name=\"text\" value.bind=\"entity.text\" label=\"Text\"></form-control>\n      <form-control name=\"desc\" value.bind=\"entity.desc\" label=\"Description\"></form-control>\n      <button type=\"submit\" class=\"ui submit fluid button green\"><i class=\"send icon\"></i>Add</button>\n    </form>\n  </section>\n</template>\n";

/***/ },
/* 170 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.List = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _BaseListVM2 = __webpack_require__(12);
	
	var _base = __webpack_require__(165);
	
	__webpack_require__(13);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var List = exports.List = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _base.baseConfig), _dec(_class = function (_BaseListVM) {
	  _inherits(List, _BaseListVM);
	
	  function List(sails, router, config) {
	    _classCallCheck(this, List);
	
	    return _possibleConstructorReturn(this, _BaseListVM.call(this, sails, router, config));
	  }
	
	  return List;
	}(_BaseListVM2.BaseListVM)) || _class);

/***/ },
/* 171 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <div class=\"ui toggle checkbox\">\n      <input type=\"checkbox\" name=\"public\" checked.bind=\"isCelled\"> \n      <label>Toggle Celled Table</label>\n    </div>\n    <table class=\"striped ${isCelled?'celled':''} green compact\"  ui-table=\"\">\n      <thead>\n      <th>Text</th>\n      <th>Description</th>\n      <th>Actions</th>\n      </thead>\n      <tbody>\n      <tr repeat.for=\"obj of entities\">\n        <td>${obj.text}</td>\n        <td>${obj.desc}</td>\n        <td>\n          <a class=\"btn btn-xs\" route-href=\"route: details; params.bind: { id: obj.id }\"><i class=\"edit icon\" data-content=\"Edit\"></i></a>\n          <a class=\"btn btn-xs\" route-href=\"route: details; params.bind: { id: obj.id }\"><i class=\"trash outline icon red\" data-content=\"Delete\"></i></a>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </section>\n</template>\n";

/***/ },
/* 172 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.View = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _BaseViewVM2 = __webpack_require__(16);
	
	var _base = __webpack_require__(165);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var View = exports.View = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _aureliaEventAggregator.EventAggregator), _dec(_class = function (_BaseViewVM) {
	  _inherits(View, _BaseViewVM);
	
	  function View(sails, router, eventAggregator) {
	    _classCallCheck(this, View);
	
	    return _possibleConstructorReturn(this, _BaseViewVM.call(this, sails, router, eventAggregator, _base.baseConfig));
	  }
	
	  return View;
	}(_BaseViewVM2.BaseViewVM)) || _class);

/***/ },
/* 173 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <form class=\"ui form\" submit.delegate=\"submit()\">\n      <form-control name=\"text\" value.bind=\"entity.text\" label=\"Text\"></form-control>\n      <form-control name=\"desc\" value.bind=\"entity.desc\" label=\"Description\"></form-control>\n      <button type=\"submit\" class=\"ui submit button blue\"><i class=\"upload icon\"></i>Update</button>\n      <div class=\"ui vertical animated red button\" click.delegate=\"deleteEntity()\">\n        <div class=\"hidden content\">Delete</div>\n        <div class=\"visible content\">\n          <i class=\"trash outline icon\"></i>\n        </div>\n      </div>\n    </form>\n  </section>\n</template>\n";

/***/ },
/* 174 */
/***/ function(module, exports) {

	"use strict";
	
	exports.__esModule = true;
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var Welcome = exports.Welcome = function Welcome() {
	  _classCallCheck(this, Welcome);
	};

/***/ },
/* 175 */
/***/ function(module, exports) {

	module.exports = "<template>\n   <div ui-card class=\"centered\">\n    <div class=\"image\">\n\n    </div>\n    <div class=\"content\">\n      <a class=\"header\">Elyse</a>\n    </div>\n  </div>\n\n   <div class=\"ui icon message\">\n    <i class=\"inbox icon\"></i>\n    <div class=\"content\">\n      <div class=\"header\">\n        Have you heard about our mailing list?\n      </div>\n      <p>Get the best news in your e-mail every day.</p>\n    </div>\n  </div>\n\n  <div ui-message=\"icon: blue loading notched circle\">\n    <div class=\"content\">\n      <div class=\"header\">\n        Just one second\n      </div>\n      <p>We're fetching that content for you.</p>\n    </div>\n  </div>\n\n  <div ui-message=\"icon.bind: messageIcon\" class=\"icon\">\n    <i class=\"ui icon inbox\"></i>\n    <div class=\"content\">\n      <div class=\"header\">\n        Have you heard about our mailing list?\n      </div>\n      <p>Get the best news in your e-mail every day.</p>\n    </div>\n  </div>\n  \n  <div ui-dropdown=\"selection: messageIcon\">\n    <input name=\"messageIcon\" type=\"hidden\" value.bind=\"messageIcon\">\n    <i class=\"dropdown icon\"></i>\n    <div class=\"default text\">Message Icon</div>\n    <div class=\"menu\">\n      <div class=\"item\" data-value=\"inbox\">Inbox</div>\n      <div class=\"item\" data-value=\"teal lab\">Lab</div>\n      <div class=\"item\" data-value=\"payment\">Payment</div>\n      <div class=\"item\" data-value=\"calendar\">Calendar</div>\n      <div class=\"item\" data-value=\"horizontally flipped comment\">Comment</div>\n    </div>\n  </div>\n</template>\n";

/***/ },
/* 176 */
/***/ function(module, exports) {

	'use strict';
	
	exports.__esModule = true;
	var baseConfig = exports.baseConfig = {
	  'baseCtrlUrl': '/users/',
	  'entityToSubscribe': 'user'
	};

/***/ },
/* 177 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.ChildRouter = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	var ChildRouter = exports.ChildRouter = (_dec = (0, _aureliaFramework.inject)(_aureliaEventAggregator.EventAggregator), _dec(_class = function () {
	  ChildRouter.prototype.configureRouter = function configureRouter(config, router) {
	    config.map([{ route: [''], name: 'list', moduleId: 'users/list', title: 'List', nav: true, settings: { icon: 'list outline' } }, { route: ['create'], name: 'create', moduleId: 'users/create', title: 'Add New', nav: true, settings: { icon: 'plus' } }, { route: ['/:id'], name: 'details', moduleId: 'users/view', title: 'Details' }]);
	    this.router = router;
	  };
	
	  function ChildRouter(eventAggregator) {
	    _classCallCheck(this, ChildRouter);
	
	    this.ea = eventAggregator;
	  }
	
	  ChildRouter.prototype.attached = function attached() {
	    var _this = this;
	
	    this.subscriber = this.ea.subscribe('InEditMode', function (data) {
	      return _this.isEdit = data;
	    });
	  };
	
	  return ChildRouter;
	}()) || _class);

/***/ },
/* 178 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <div class=\"ui pointing menu\">\n    <a repeat.for=\"row of router.navigation\" class=\"${row.isActive ? 'active' : ''} item\" href.bind=\"row.href\">\n      <i class=\"${row.settings.icon} icon\" data-content=\"View Answers\"></i>${row.title}\n    </a>\n    <a class=\"${isEdit ? 'active' : ''} item\">\n      <i class=\"unhide icon\"></i>Edit/Delete\n    </a>\n  </div>\n  <div class=\"ui segment\">\n    <section class=\"au-animate\">\n      <router-view></router-view>\n    </section>\n  </div>\n</template>\n";

/***/ },
/* 179 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.Create = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _BaseCreateVM2 = __webpack_require__(11);
	
	var _base = __webpack_require__(176);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var Create = exports.Create = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _base.baseConfig), _dec(_class = function (_BaseCreateVM) {
	  _inherits(Create, _BaseCreateVM);
	
	  function Create(sails, router, baseConfig) {
	    _classCallCheck(this, Create);
	
	    return _possibleConstructorReturn(this, _BaseCreateVM.call(this, sails, router, baseConfig));
	  }
	
	  return Create;
	}(_BaseCreateVM2.BaseCreateVM)) || _class);

/***/ },
/* 180 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <form class=\"ui form\" submit.delegate=\"submit()\">\n      <form-control name=\"username\" value.bind=\"entity.username\" label=\"Username\"></form-control>\n      <form-control name=\"email\" value.bind=\"entity.email\" label=\"Email\"></form-control>\n      <form-control name=\"gravatarUrl\" value.bind=\"entity.gravatarUrl\" label=\"Avatar Url\"></form-control>\n      <button type=\"submit\" class=\"ui submit fluid button green\"><i class=\"send icon\"></i>Add</button>\n    </form>\n  </section>\n</template>\n";

/***/ },
/* 181 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.List = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _BaseListVM2 = __webpack_require__(12);
	
	var _base = __webpack_require__(176);
	
	__webpack_require__(13);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var List = exports.List = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _base.baseConfig), _dec(_class = function (_BaseListVM) {
	  _inherits(List, _BaseListVM);
	
	  function List(sails, router, config) {
	    _classCallCheck(this, List);
	
	    return _possibleConstructorReturn(this, _BaseListVM.call(this, sails, router, config));
	  }
	
	  List.prototype.activate = function activate() {
	    var _this2 = this;
	
	    return this.sails.get(this.baseCtrlUrl + '?populate=roles').then(function (res) {
	      _this2.entities = res.body;
	      _this2.subscribe();
	    }).catch(function (res) {
	      res.statusCode === 403 ? _this2.router.navigate('/login') : logger.error(res);
	    });
	  };
	
	  return List;
	}(_BaseListVM2.BaseListVM)) || _class);

/***/ },
/* 182 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <div class=\"ui toggle checkbox\">\n      <input type=\"checkbox\" name=\"public\" checked.bind=\"isCelled\"> \n      <label>Toggle Celled Table</label>\n    </div>\n    <table class=\"striped ${isCelled?'celled':''} green compact\"  ui-table=\"\">\n      <thead>\n      <th>Username</th>\n      <th>Email Id</th>\n      <th>Avatar URL</th>\n      <th>Roles</th>\n      </thead>\n      <tbody>\n      <tr repeat.for=\"obj of entities\">\n        <td>${obj.username}</td>\n        <td>${obj.email}</td>\n        <td>\n          <span repeat.for=\"r of obj.roles\">${r.name}, </span>\n        </td>\n        <td>\n          <a class=\"btn btn-xs\" route-href=\"route: details; params.bind: { id: obj.id }\"><i class=\"edit icon\" data-content=\"Edit\"></i></a>\n          <a class=\"btn btn-xs\" route-href=\"route: details; params.bind: { id: obj.id }\"><i class=\"trash outline icon red\" data-content=\"Delete\"></i></a>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </section>\n</template>\n";

/***/ },
/* 183 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	exports.View = undefined;
	
	var _dec, _class;
	
	var _aureliaFramework = __webpack_require__(18);
	
	var _aureliaRouter = __webpack_require__(33);
	
	var _aureliaEventAggregator = __webpack_require__(25);
	
	var _aureliaSailsSocketClient = __webpack_require__(26);
	
	var _BaseViewVM2 = __webpack_require__(16);
	
	var _base = __webpack_require__(176);
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var View = exports.View = (_dec = (0, _aureliaFramework.inject)(_aureliaSailsSocketClient.SailsSocketClient, _aureliaRouter.Router, _aureliaEventAggregator.EventAggregator), _dec(_class = function (_BaseViewVM) {
	  _inherits(View, _BaseViewVM);
	
	  function View(sails, router, eventAggregator) {
	    _classCallCheck(this, View);
	
	    return _possibleConstructorReturn(this, _BaseViewVM.call(this, sails, router, eventAggregator, _base.baseConfig));
	  }
	
	  return View;
	}(_BaseViewVM2.BaseViewVM)) || _class);

/***/ },
/* 184 */
/***/ function(module, exports) {

	module.exports = "<template>\n  <section class=\"au-animate\">\n    <form class=\"ui form\" submit.delegate=\"submit()\">\n      <form-control name=\"username\" value.bind=\"entity.username\" label=\"Username\"></form-control>\n      <form-control name=\"email\" value.bind=\"entity.email\" label=\"Email\"></form-control>\n      <form-control name=\"gravatarUrl\" value.bind=\"entity.gravatarUrl\" label=\"Avatar Url\"></form-control>\n      <button type=\"submit\" class=\"ui submit button blue\"><i class=\"upload icon\"></i>Update</button>\n      <div class=\"ui vertical animated red button\" click.delegate=\"deleteEntity()\">\n        <div class=\"hidden content\">Delete</div>\n        <div class=\"visible content\">\n          <i class=\"trash outline icon\"></i>\n        </div>\n      </div>\n    </form>\n  </section>\n</template>\n";

/***/ }
]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMgXlxcLlxcLy4qJCIsIndlYnBhY2s6Ly8vLi9zcmMvQmFzZUNydWRPcGVyYXRpb25zL0Jhc2VDcmVhdGVWTS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvQmFzZUNydWRPcGVyYXRpb25zL0Jhc2VMaXN0Vk0uanMiLCJ3ZWJwYWNrOi8vLy4vfi9hdXJlbGlhLWxvZ2dpbmcvZGlzdC9jb21tb25qcy9hdXJlbGlhLWxvZ2dpbmcuanMiLCJ3ZWJwYWNrOi8vLy4vfi9tb3VzZXRyYXAvbW91c2V0cmFwLmpzIiwid2VicGFjazovLy8uL3NyYy9CYXNlQ3J1ZE9wZXJhdGlvbnMvQmFzZVZpZXdWTS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvYXBwLmpzIiwid2VicGFjazovLy8uL34vYXVyZWxpYS1mcmFtZXdvcmsvZGlzdC9jb21tb25qcy9hdXJlbGlhLWZyYW1ld29yay5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtZGVwZW5kZW5jeS1pbmplY3Rpb24vZGlzdC9jb21tb25qcy9hdXJlbGlhLWRlcGVuZGVuY3ktaW5qZWN0aW9uLmpzIiwid2VicGFjazovLy8uL34vYXVyZWxpYS1iaW5kaW5nL2Rpc3QvY29tbW9uanMvYXVyZWxpYS1iaW5kaW5nLmpzIiwid2VicGFjazovLy8uL34vYXVyZWxpYS10YXNrLXF1ZXVlL2Rpc3QvY29tbW9uanMvYXVyZWxpYS10YXNrLXF1ZXVlLmpzIiwid2VicGFjazovLy8uL34vdGltZXJzLWJyb3dzZXJpZnkvbWFpbi5qcyIsIndlYnBhY2s6Ly8vLi9+L3Byb2Nlc3MvYnJvd3Nlci5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy9kaXN0L2NvbW1vbmpzL2F1cmVsaWEtdGVtcGxhdGluZy5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtZXZlbnQtYWdncmVnYXRvci9kaXN0L2NvbW1vbmpzL2F1cmVsaWEtZXZlbnQtYWdncmVnYXRvci5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtc2FpbHMtc29ja2V0LWNsaWVudC9kaXN0L2NvbW1vbmpzL2F1cmVsaWEtc2FpbHMtc29ja2V0LWNsaWVudC5qcyIsIndlYnBhY2s6Ly8vLi9+L3NhaWxzLmlvLmpzL3NhaWxzLmlvLmpzIiwid2VicGFjazovLy8uL3NyYy9hcHAuaHRtbCIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtYW5pbWF0b3ItY3NzL2Rpc3QvY29tbW9uanMvYXVyZWxpYS1hbmltYXRvci1jc3MuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hdXJlbGlhLWhpc3RvcnktYnJvd3Nlci9kaXN0L2NvbW1vbmpzL2F1cmVsaWEtaGlzdG9yeS1icm93c2VyLmpzIiwid2VicGFjazovLy8uL34vYXVyZWxpYS1oaXN0b3J5L2Rpc3QvY29tbW9uanMvYXVyZWxpYS1oaXN0b3J5LmpzIiwid2VicGFjazovLy8uL34vYXVyZWxpYS1sb2dnaW5nLWNvbnNvbGUvZGlzdC9jb21tb25qcy9hdXJlbGlhLWxvZ2dpbmctY29uc29sZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtcm91dGVyL2Rpc3QvY29tbW9uanMvYXVyZWxpYS1yb3V0ZXIuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hdXJlbGlhLXJvdXRlLXJlY29nbml6ZXIvZGlzdC9jb21tb25qcy9hdXJlbGlhLXJvdXRlLXJlY29nbml6ZXIuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hdXJlbGlhLXRlbXBsYXRpbmctYmluZGluZy9kaXN0L2NvbW1vbmpzL2F1cmVsaWEtdGVtcGxhdGluZy1iaW5kaW5nLmpzIiwid2VicGFjazovLy8uL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9kaXN0L2NvbW1vbmpzL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvY29tcG9zZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9pZi5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy93aXRoLmpzIiwid2VicGFjazovLy8uL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9kaXN0L2NvbW1vbmpzL3JlcGVhdC5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9yZXBlYXQtc3RyYXRlZ3ktbG9jYXRvci5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9udWxsLXJlcGVhdC1zdHJhdGVneS5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9hcnJheS1yZXBlYXQtc3RyYXRlZ3kuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvcmVwZWF0LXV0aWxpdGllcy5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9tYXAtcmVwZWF0LXN0cmF0ZWd5LmpzIiwid2VicGFjazovLy8uL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9kaXN0L2NvbW1vbmpzL3NldC1yZXBlYXQtc3RyYXRlZ3kuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvbnVtYmVyLXJlcGVhdC1zdHJhdGVneS5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9hbmFseXplLXZpZXctZmFjdG9yeS5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9hYnN0cmFjdC1yZXBlYXRlci5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9zaG93LmpzIiwid2VicGFjazovLy8uL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9kaXN0L2NvbW1vbmpzL2hpZGUuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvc2FuaXRpemUtaHRtbC5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9odG1sLXNhbml0aXplci5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9yZXBsYWNlYWJsZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9mb2N1cy5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9jb21waWxlLXNweS5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy92aWV3LXNweS5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9jc3MtcmVzb3VyY2UuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvYmluZGluZy1tb2RlLWJlaGF2aW9ycy5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy90aHJvdHRsZS1iaW5kaW5nLWJlaGF2aW9yLmpzIiwid2VicGFjazovLy8uL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9kaXN0L2NvbW1vbmpzL2RlYm91bmNlLWJpbmRpbmctYmVoYXZpb3IuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvc2lnbmFsLWJpbmRpbmctYmVoYXZpb3IuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvYmluZGluZy1zaWduYWxlci5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy91cGRhdGUtdHJpZ2dlci1iaW5kaW5nLWJlaGF2aW9yLmpzIiwid2VicGFjazovLy8uL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9kaXN0L2NvbW1vbmpzL2h0bWwtcmVzb3VyY2UtcGx1Z2luLmpzIiwid2VicGFjazovLy8uL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9kaXN0L2NvbW1vbmpzL2R5bmFtaWMtZWxlbWVudC5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yb3V0ZXIvZGlzdC9jb21tb25qcy9hdXJlbGlhLXRlbXBsYXRpbmctcm91dGVyLmpzIiwid2VicGFjazovLy8uL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJvdXRlci9kaXN0L2NvbW1vbmpzL3JvdXRlLWxvYWRlci5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yb3V0ZXIvZGlzdC9jb21tb25qcy9yb3V0ZXItdmlldy5qcyIsIndlYnBhY2s6Ly8vLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yb3V0ZXIvZGlzdC9jb21tb25qcy9yb3V0ZS1ocmVmLmpzIiwid2VicGFjazovLy8uL3NyYy9hdXRoL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9hdXRoL2luZGV4Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vc3JjL2F1dGhDb25maWcuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9jb2xsZWN0aW9ucy91aS1icmVhZGNydW1iLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvY29uc3RhbnRzLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvdWktYXR0cmlidXRlLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvY29sbGVjdGlvbnMvdWktZm9ybS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2NvbGxlY3Rpb25zL3VpLWdyaWQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9jb2xsZWN0aW9ucy91aS1tZW51LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvY29sbGVjdGlvbnMvdWktbWVzc2FnZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2NvbGxlY3Rpb25zL3VpLXRhYmxlLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktYnV0dG9uLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktY29udGFpbmVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktZGl2aWRlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWZsYWcuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1oZWFkZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1pY29uLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktaW1hZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1pbnB1dC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWxhYmVsLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktbGlzdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWxvYWRlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLXJhaWwuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1yZXZlYWwuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1zZWdtZW50LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktc3RlcC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvbW9kdWxlcy91aS1hY2NvcmRpb24uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9tb2R1bGVzL3VpLWRyb3Bkb3duLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvbW9kdWxlcy91aS1tb2RhbC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL21vZHVsZXMvdWktc2VhcmNoLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvbW9kdWxlcy91aS1zaWRlYmFyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvdmlld3MvdWktY2FyZC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL3ZpZXdzL3VpLXN0YXRpc3RpYy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9mb3JtLWNvbnRyb2wuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvZm9ybS1jb250cm9sLmh0bWwiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvZm9ybS1zdWJtaXQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvZm9ybS1zdWJtaXQuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaG9tZS93ZWxjb21lLmpzIiwid2VicGFjazovLy8uL3NyYy9ob21lL3dlbGNvbWUuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb24vYW5zd2Vycy9iYXNlLmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvbi9hbnN3ZXJzL2NyZWF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb24vYW5zd2Vycy9jcmVhdGUuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb24vYW5zd2Vycy9saXN0LmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvbi9hbnN3ZXJzL2xpc3QuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb24vYW5zd2Vycy92aWV3LmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvbi9hbnN3ZXJzL3ZpZXcuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb24vYmFzZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb24vY2hpbGQtcm91dGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvbi9jaGlsZC1yb3V0ZXIuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb24vY3JlYXRlLmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvbi9jcmVhdGUuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb24vZGV0YWlscy9hZGRBbnN3ZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXN0aW9uL2RldGFpbHMvYWRkQW5zd2VyLmh0bWwiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXN0aW9uL2RldGFpbHMvY2hpbGQtcm91dGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvbi9kZXRhaWxzL2NoaWxkLXJvdXRlci5odG1sIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvbi9kZXRhaWxzL3ZpZXcuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXN0aW9uL2RldGFpbHMvdmlldy5odG1sIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvbi9saXN0LmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvbi9saXN0Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXN0aW9uL3ZpZXcuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXN0aW9uL3ZpZXcuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb25DYXRlZ29yeS9iYXNlLmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvbkNhdGVnb3J5L2NoaWxkLXJvdXRlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb25DYXRlZ29yeS9jaGlsZC1yb3V0ZXIuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb25DYXRlZ29yeS9jcmVhdGUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXN0aW9uQ2F0ZWdvcnkvY3JlYXRlLmh0bWwiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXN0aW9uQ2F0ZWdvcnkvbGlzdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb25DYXRlZ29yeS9saXN0Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXN0aW9uQ2F0ZWdvcnkvdmlldy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb25DYXRlZ29yeS92aWV3Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXN0aW9uS2luZC9iYXNlLmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvbktpbmQvY2hpbGQtcm91dGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvbktpbmQvY2hpbGQtcm91dGVyLmh0bWwiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXN0aW9uS2luZC9jcmVhdGUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXN0aW9uS2luZC9jcmVhdGUuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb25LaW5kL2xpc3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXN0aW9uS2luZC9saXN0Lmh0bWwiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXN0aW9uS2luZC92aWV3LmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvbktpbmQvdmlldy5odG1sIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvblR5cGUvYmFzZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb25UeXBlL2NoaWxkLXJvdXRlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb25UeXBlL2NoaWxkLXJvdXRlci5odG1sIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvblR5cGUvY3JlYXRlLmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvblR5cGUvY3JlYXRlLmh0bWwiLCJ3ZWJwYWNrOi8vLy4vc3JjL3F1ZXN0aW9uVHlwZS9saXN0LmpzIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvblR5cGUvbGlzdC5odG1sIiwid2VicGFjazovLy8uL3NyYy9xdWVzdGlvblR5cGUvdmlldy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcXVlc3Rpb25UeXBlL3ZpZXcuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvdGVzdC93ZWxjb21lLmpzIiwid2VicGFjazovLy8uL3NyYy90ZXN0L3dlbGNvbWUuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvdXNlcnMvYmFzZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXNlcnMvY2hpbGQtcm91dGVyLmpzIiwid2VicGFjazovLy8uL3NyYy91c2Vycy9jaGlsZC1yb3V0ZXIuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvdXNlcnMvY3JlYXRlLmpzIiwid2VicGFjazovLy8uL3NyYy91c2Vycy9jcmVhdGUuaHRtbCIsIndlYnBhY2s6Ly8vLi9zcmMvdXNlcnMvbGlzdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXNlcnMvbGlzdC5odG1sIiwid2VicGFjazovLy8uL3NyYy91c2Vycy92aWV3LmpzIiwid2VicGFjazovLy8uL3NyYy91c2Vycy92aWV3Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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QTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLEVBQUMsRzs7Ozs7O0FDN0hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFjO0FBQ2Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFtQixRQUFRO0FBQzNC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QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EscUVBQW9FO0FBQ3BFO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7O0FBRUw7QUFDQSxJQUFHOztBQUVIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsMkJBQTBCLDBFQUEwRSxFQUFFO0FBQ3RHOztBQUVBLHlCQUF3QixxRkFBcUYsRUFBRTtBQUMvRzs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHVDQUFzQyxRQUFRO0FBQzlDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEscUNBQW9DO0FBQ3BDOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDJDQUEwQztBQUMxQztBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSwyQkFBMEIsNEVBQTRFLEVBQUU7QUFDeEc7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsbUJBQWtCLHNFQUFzRTtBQUN4Rjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSzs7QUFFTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVCxRQUFPO0FBQ1AsTUFBSzs7QUFFTDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsUUFBTztBQUNQLE1BQUs7QUFDTDs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTs7Ozs7OztBQ2hpQkE7O0FBRUE7QUFDQTtBQUNBLEVBQUM7QUFDRDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQSxrREFBaUQsMENBQTBDLDBEQUEwRCxFQUFFOztBQUV2SjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLHNFQUFxRSxhQUFhO0FBQ2xGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSx5Q0FBd0M7QUFDeEM7QUFDQTtBQUNBLElBQUc7O0FBRUg7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBLElBQUc7O0FBRUg7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBLElBQUc7O0FBRUg7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBLElBQUc7O0FBRUg7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBLElBQUc7O0FBRUg7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBLElBQUc7O0FBRUg7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7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QTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFlLFlBQVk7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FB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QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxJQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7QUFDRDtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsNERBQTJELDBEQUEwRDtBQUNySDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTs7QUFFQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsbURBQWtELGNBQWM7QUFDaEU7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7O0FBRUE7OztBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBOztBQUVBOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTs7QUFFQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTs7QUFFQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTs7QUFFQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBOztBQUVBOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTs7QUFFQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBOztBQUVBOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7O0FBRUE7OztBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTs7QUFFQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7O0FBRUE7OztBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBOztBQUVBOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBOztBQUVBOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTs7QUFFQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7O0FBRUE7OztBQUdBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBOztBQUVBOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLGlEQUFnRCxlQUFlO0FBQy9EO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVCQUFzQixlQUFlO0FBQ3JDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTs7QUFFQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsNkNBQTRDLGVBQWU7QUFDM0Q7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsdUJBQXNCLGVBQWU7QUFDckM7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDs7QUFFQTtBQUNBOztBQUVBLCtDQUE4Qyx1QkFBdUI7QUFDckU7QUFDQTs7QUFFQTs7QUFFQSxxQkFBb0IsZUFBZTtBQUNuQztBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0EsSUFBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLDZDQUE0QyxlQUFlO0FBQzNEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxtREFBa0QsZUFBZTtBQUNqRTtBQUNBLHNCQUFxQjtBQUNyQjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBLDZDQUE0QyxlQUFlO0FBQzNEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSw2Q0FBNEMsZUFBZTtBQUMzRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUEsaURBQWdELGVBQWU7QUFDL0Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsa0JBQWlCOztBQUVqQiw2Q0FBNEMsZUFBZTtBQUMzRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLGtCQUFpQjtBQUNqQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxpQ0FBZ0M7QUFDaEM7QUFDQSxVQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFVBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUEsMEJBQXlCLEVBQUU7QUFDM0I7QUFDQTs7QUFFQTs7QUFFQSw2QkFBNEIsVUFBVTtBQUN0QztBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsNEJBQTJCO0FBQzNCO0FBQ0E7O0FBRUE7QUFDQSwwREFBeUQ7QUFDekQ7QUFDQTs7QUFFQTtBQUNBOztBQUVBLDhCQUE2QjtBQUM3QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLFFBQU87QUFDUDtBQUNBLFFBQU87QUFDUDtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLFFBQU87QUFDUDtBQUNBLFFBQU87QUFDUDtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLFFBQU87QUFDUDtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSxRQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSxNQUFLO0FBQ0w7QUFDQSxNQUFLO0FBQ0w7QUFDQSxNQUFLO0FBQ0w7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsTUFBSywrQkFBK0I7QUFDcEM7QUFDQSxNQUFLO0FBQ0w7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPLHdHQUF3RztBQUMvRztBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxtQkFBa0I7O0FBRWxCLDhCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHlFQUF3RTtBQUN4RTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDs7QUFFQSxtQkFBa0I7O0FBRWxCO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHOztBQUVIO0FBQ0EsRUFBQzs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSx3REFBdUQsMERBQTBEO0FBQ2pIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhGQUE2Rjs7QUFFN0Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPOztBQUVQO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7O0FBRUw7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE1BQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7OztBQUdEOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQLHlDQUF3QztBQUN4QyxrREFBaUQsZUFBZTtBQUNoRTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7O0FBR0Q7QUFDQTs7QUFFQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE1BQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsTUFBSztBQUNMO0FBQ0EsTUFBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOzs7QUFHRDs7QUFFQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsNENBQTJDLFdBQVc7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUzs7QUFFVDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMLDZDQUE0QyxpQ0FBaUM7QUFDN0U7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdEQUErQyxlQUFlO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esa0VBQWlFLGFBQWE7QUFDOUU7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7OztBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxnQkFBZTtBQUNmO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0Esa0RBQWlELFdBQVc7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7O0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0EsVUFBUztBQUNUO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxrQkFBaUI7QUFDakI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7O0FBR0Q7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esd0RBQXVELDBEQUEwRDtBQUNqSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFOzs7Ozs7QUM1cEtBOztBQUVBO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7O0FBRUE7O0FBRUEsa0RBQWlELDBDQUEwQywwREFBMEQsRUFBRTs7QUFFdko7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMEIsc0JBQXNCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQSxNQUFLO0FBQ0wsSUFBRztBQUNIO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUCxNQUFLO0FBQ0w7QUFDQTtBQUNBLFFBQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0EsTUFBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsMEVBQXlFO0FBQ3pFO0FBQ0E7O0FBRUEsK0RBQThELDJEQUEyRDtBQUN6SDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPOztBQUVQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxJQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsZ0RBQStDLFFBQVE7QUFDdkQ7O0FBRUE7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLE1BQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHlDQUF3QyxRQUFRO0FBQ2hEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0Esc0NBQXFDLFFBQVE7QUFDN0M7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHlDQUF3QyxRQUFRO0FBQ2hEO0FBQ0E7O0FBRUE7QUFDQSxzQ0FBcUMsUUFBUTtBQUM3QztBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHdDQUF1QyxRQUFRO0FBQy9DO0FBQ0E7O0FBRUE7QUFDQSwyQ0FBMEMsUUFBUTtBQUNsRDtBQUNBOztBQUVBO0FBQ0Esd0NBQXVDLFFBQVE7QUFDL0M7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx5Q0FBd0MsUUFBUTtBQUNoRDtBQUNBOztBQUVBO0FBQ0Esc0NBQXFDLFFBQVE7QUFDN0M7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSwyQ0FBMEMsUUFBUTtBQUNsRDtBQUNBOztBQUVBO0FBQ0Esd0NBQXVDLFFBQVE7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0EsUUFBTztBQUNQLGtEQUFpRCxRQUFRO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSw4Q0FBNkMsUUFBUTtBQUNyRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLG1DQUFrQyxRQUFRO0FBQzFDO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEscUNBQW9DLFFBQVE7QUFDNUM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtB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QTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsOENBQTZDLFFBQVE7QUFDckQ7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDhDQUE2QyxRQUFRO0FBQ3JEO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxnQkFBZSxRQUFRO0FBQ3ZCOztBQUVBLGtCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGtCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsa0RBQWlELFFBQVE7QUFDekQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLHVDQUFzQyxRQUFRO0FBQzlDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGtDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBLGNBQWEsdUJBQXVCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSx3Q0FBdUM7QUFDdkM7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxrREFBaUQsUUFBUTtBQUN6RDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsdUNBQXNDLFFBQVE7QUFDOUM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esc0NBQXFDO0FBQ3JDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7O0FBRUg7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBc0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSwyQ0FBMEMsUUFBUTtBQUNsRDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsd0NBQXVDLFFBQVE7QUFDL0M7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGNBQWE7QUFDYjtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvREFBbUQsUUFBUTtBQUMzRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQSwyQ0FBMEMsUUFBUTtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsd0NBQXVDLFFBQVE7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWE7QUFDYjtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7O0FBRUEsc0RBQXFELFFBQVE7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsNkNBQTRDLFFBQVE7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDJDQUEwQyxRQUFRO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDJDQUEwQyxRQUFRO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNEMsUUFBUTtBQUNwRDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0EsK0NBQThDLFVBQVU7QUFDeEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EseUJBQXdCO0FBQ3hCOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0EsUUFBTztBQUNQO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBOztBQUVBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsTUFBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRzs7QUFFSDtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTzs7QUFFUDtBQUNBLE1BQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxNQUFLO0FBQ0w7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHVDQUFzQyxRQUFRO0FBQzlDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSwyQ0FBMEMsUUFBUTtBQUNsRDtBQUNBOztBQUVBO0FBQ0E7QUFDQSxRQUFPO0FBQ1AsTUFBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsd0NBQXVDLFFBQVE7QUFDL0M7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsNkNBQTRDLFFBQVE7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDs7QUFFQTtBQUNBLDJDQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSwrQ0FBOEMsUUFBUTtBQUN0RDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7O0FBR0Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDJGQUEwRjtBQUMxRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1QsaUNBQWdDLGtFQUFrRTtBQUNsRyxVQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMLGVBQWM7QUFDZDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQsNkNBQTRDO0FBQzVDOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUCw0Q0FBMkMsUUFBUTtBQUNuRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTCwwQ0FBeUMsUUFBUTtBQUNqRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxRQUFPO0FBQ1A7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsUUFBTztBQUNQOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUOztBQUVBO0FBQ0EsTUFBSztBQUNMOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxNQUFLO0FBQ0w7QUFDQSxNQUFLO0FBQ0w7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBaUM7QUFDakM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFlBQVc7QUFDWDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxRQUFPO0FBQ1AsTUFBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxzQkFBcUI7QUFDckI7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsK0NBQThDOztBQUU5QztBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxpR0FBZ0c7QUFDaEc7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDLGlCOzs7Ozs7QUMxbUlEOztBQUVBO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBOztB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O0FBQ0E7QUFDQSxRQUFPOztBQUVQOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLE1BQUs7QUFDTDs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRzs7QUFFSDtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxvR0FBbUcsa0NBQWtDO0FBQ3JJO0FBQ0E7QUFDQSxRQUFPO0FBQ1AsTUFBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLDRDQUEyQyxRQUFRO0FBQ25EO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQSxRQUFPO0FBQ1AsTUFBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLCtDOzs7Ozs7QUM5Z0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFnQixZQUFZO0FBQzVCOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQSxpQkFBZ0IsT0FBTztBQUN2QixpQkFBZ0IsU0FBUztBQUN6QixpQkFBZ0I7QUFDaEI7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBZ0IsT0FBTztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFnQixZQUFZO0FBQzVCLGlCQUFnQixPQUFPO0FBQ3ZCOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7Ozs7Ozs7O0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBMkM7QUFDM0M7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNULFFBQU87O0FBRVA7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87O0FBRVA7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7OztBQUdMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTzs7QUFFUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSw0Q0FBMkMsY0FBYzs7QUFFekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLFFBQU87OztBQUdQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTOztBQUVULFFBQU87O0FBRVA7QUFDQTtBQUNBOztBQUVBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtGQUFpRixtQkFBbUIsRUFBRTtBQUN0RztBQUNBLFVBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVCxRQUFPOztBQUVQOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBZ0IsUUFBUTtBQUN4QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0EsaUJBQWdCLE9BQU87QUFDdkI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7QUFH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Ozs7QUNBN25DOztBQUVBO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQSxrREFBaUQsMENBQTBDLDBEQUEwRCxFQUFFOztBQUV2SjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esc0NBQXFDLFFBQVE7QUFDN0M7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSxNQUFLO0FBQ0w7QUFDQSxNQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSxNQUFLO0FBQ0w7QUFDQSxNQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDs7QUFFQTtBQUNBLE1BQUs7QUFDTDtBQUNBLE1BQUs7QUFDTDs7QUFFQTtBQUNBLDZEQUE0RCxtREFBbUQ7QUFDL0c7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxzQkFBcUIsd0JBQXdCO0FBQzdDOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSx3QkFBdUIscUJBQXFCO0FBQzVDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSzs7QUFFTDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1AsTUFBSztBQUNMO0FBQ0EsTUFBSztBQUNMOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxRQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLFFBQU87O0FBRVA7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVCxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxRQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLFFBQU87O0FBRVA7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVCxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLFFBQU87O0FBRVA7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxRQUFPOztBQUVQOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBSztBQUNMOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxRQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsUUFBTzs7QUFFUDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE1BQUs7QUFDTDs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRTs7Ozs7O0FDNWRBOztBQUVBO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUEsa0RBQWlELGFBQWEsdUZBQXVGLEVBQUUsdUZBQXVGOztBQUU5TywyQ0FBMEMsK0RBQStELHFHQUFxRyxFQUFFLHlFQUF5RSxlQUFlLHlFQUF5RSxFQUFFLEVBQUUsdUhBQXVIOztBQUU1ZSxrREFBaUQsMENBQTBDLDBEQUEwRCxFQUFFOztBQUV2SjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLG9DQUFtQyxHQUFHLFlBQVk7O0FBRWxEOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFFBQU87QUFDUDtBQUNBLHVDQUFzQztBQUN0QztBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx3RUFBdUU7O0FBRXZFO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSw4REFBNkQ7QUFDN0QsTUFBSztBQUNMO0FBQ0EsTUFBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEU7Ozs7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O0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSxNQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsNEJBQTJCLCtEQUErRDtBQUMxRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVCxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0EsTUFBSztBQUNMO0FBQ0EsTUFBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsMkVBQTBFOztBQUUxRTs7QUFFQTtBQUNBLG1DQUFrQywrQkFBK0I7QUFDakU7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQSwwRUFBeUU7QUFDekUsMkVBQTBFOztBQUUxRTs7QUFFQTtBQUNBO0FBQ0EsbUNBQWtDLCtCQUErQjtBQUNqRTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsOEJBQTZCLHlCQUF5QjtBQUN0RDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0Esa0RBQWlELFFBQVE7QUFDekQsMENBQXlDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUCwyQ0FBMEM7QUFDMUM7O0FBRUE7QUFDQSxrREFBaUQsVUFBVTtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFLOztBQUVMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDhDQUE2QyxRQUFRO0FBQ3JEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EscURBQW9ELFlBQVk7QUFDaEU7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFFBQU87QUFDUDs7QUFFQTtBQUNBLFFBQU87QUFDUDtBQUNBLFFBQU87QUFDUDtBQUNBLFFBQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxZQUFXO0FBQ1gsVUFBUzs7QUFFVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsMkVBQTBFOztBQUUxRTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBc0MsNERBQTREOztBQUVsRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTzs7QUFFUDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEseUNBQXdDLFlBQVk7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9FQUFtRTtBQUNuRTtBQUNBO0FBQ0E7QUFDQSxRQUFPOztBQUVQO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBLE1BQUs7QUFDTCxxRUFBb0U7QUFDcEUsa0JBQWlCLGlCQUFpQjtBQUNsQztBQUNBLHVCQUFzQjs7QUFFdEI7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFnQjtBQUNoQixRQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBLE1BQUs7QUFDTCx1Q0FBc0MsY0FBYztBQUNwRCxNQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxNQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7O0FBRUg7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxJQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWE7QUFDYjtBQUNBLFVBQVM7O0FBRVQ7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBRzs7QUFFSDtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWCxVQUFTO0FBQ1Q7QUFDQSxNQUFLOztBQUVMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxvQkFBbUIsNkVBQTZFOztBQUVoRztBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFVBQVM7QUFDVCxRQUFPO0FBQ1A7QUFDQSxJQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBLFlBQVc7QUFDWDtBQUNBLFFBQU87O0FBRVA7QUFDQTs7QUFFQTtBQUNBLElBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBSztBQUNMOztBQUVBO0FBQ0EsRUFBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSztB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dUhBQXVIOztBQUU1ZSxrREFBaUQsMENBQTBDLDBEQUEwRCxFQUFFOztBQUV2SjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXdDLFFBQVE7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDRDQUEyQyxRQUFRO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsdUNBQXNDLFFBQVE7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXNDLFFBQVE7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsdUNBQXNDLFFBQVE7QUFDOUM7O0FBRUEseUJBQXdCO0FBQ3hCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDOztBQUVEOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLHdCQUF1QjtBQUN2QjtBQUNBLFVBQVMscUJBQXFCO0FBQzlCO0FBQ0E7QUFDQSxRQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE2QjtBQUM3QixRQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsRTs7Ozs7O0FDdm5CQTs7QUFFQTtBQUNBO0FBQ0EsRUFBQztBQUNEOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSw4REFBNkQseUJBQXlCLEVBQUU7QUFDeEYsSUFBRztBQUNILGtEQUFpRCx5QkFBeUIsRUFBRTtBQUM1RTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSx1QkFBc0I7QUFDdEI7QUFDQSxJQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyRTs7Ozs7O0FDNUhBOztBQUVBO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7O0FBRUEsa0RBQWlELDBDQUEwQywwREFBMEQsRUFBRTs7QUFFdko7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMOztBQUVBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0EsRUFBQzs7O0FBR0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUc7QUFDSCxFOzs7Ozs7QUN0TUE7O0FBRUE7QUFDQTtBQUNBLEVBQUM7QUFDRDs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQSxrREFBaUQsMENBQTBDLDBEQUEwRCxFQUFFOztBQUV2SjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQSxFQUFDLCtDOzs7Ozs7QUNoVEQ7O0FBRUE7QUFDQTtBQUNBLEVBQUM7QUFDRDs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQSxrREFBaUQsMENBQTBDLDBEQUEwRCxFQUFFOztBQUV2SjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSwwQ0FBeUMsUUFBUTtBQUNqRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsRUFBQyxHOzs7Ozs7QUM3REQ7O0FBRUE7QUFDQTtBQUNBLEVBQUM7O0FBRUQsa0RBQWlELDBDQUEwQywwREFBMEQsRUFBRTs7QUFFdko7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsRUFBQyxHOzs7Ozs7QUNwQkQ7O0FBRUE7QUFDQTtBQUNBLEVBQUM7QUFDRDs7QUFFQTs7QUFFQTs7QUFF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QUFXO0FBQUE7O0FBQ1QsWUFBTyxLQUFLLEtBQUwsQ0FBVyxHQUFYLENBQWtCLEtBQUssV0FBdkIsc0JBQXFELElBQXJELENBQTBELFVBQUMsR0FBRCxFQUFTO0FBQ3hFLGNBQUssUUFBTCxHQUFnQixJQUFJLElBQXBCO0FBQ0EsY0FBSyxTQUFMO0FBQ0QsTUFITSxFQUdKLEtBSEksQ0FHRSxVQUFDLEdBQUQsRUFBUztBQUNmLFdBQUksVUFBSixLQUFtQixHQUFwQixHQUEyQixPQUFLLE1BQUwsQ0FBWSxRQUFaLENBQXFCLFFBQXJCLENBQTNCLEdBQTRELE9BQU8sS0FBUCxDQUFhLEdBQWIsQ0FBNUQ7QUFDRCxNQUxNLENBQVA7QUFNRCxJOzs7Ozs7Ozs7QUNuQkgsd1FBQXVRLHFCQUFxQiw0T0FBNE8sYUFBYSxxQkFBcUIsVUFBVSxxRUFBcUUsT0FBTyxzR0FBc0csZUFBZSxhQUFhLHdIQUF3SCxlQUFlLGFBQWEsZ0s7Ozs7Ozs7Ozs7Ozs7QUNBdDVCOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7OztLQUdhLEksV0FBQSxJLFdBRFosMEk7OztBQUdDLGlCQUFZLEtBQVosRUFBbUIsTUFBbkIsRUFBMkIsZUFBM0IsRUFBNEM7QUFBQTs7QUFBQSw2Q0FDMUMsdUJBQU0sS0FBTixFQUFhLE1BQWIsRUFBcUIsZUFBckIsbUJBRDBDO0FBRTNDOzs7Ozs7Ozs7QUNaSCxnMUIiLCJmaWxlIjoiMS5idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbWFwID0ge1xuXHRcIi4vQmFzZUNydWRPcGVyYXRpb25zL0Jhc2VDcmVhdGVWTVwiOiAxMSxcblx0XCIuL0Jhc2VDcnVkT3BlcmF0aW9ucy9CYXNlQ3JlYXRlVk0uanNcIjogMTEsXG5cdFwiLi9CYXNlQ3J1ZE9wZXJhdGlvbnMvQmFzZUxpc3RWTVwiOiAxMixcblx0XCIuL0Jhc2VDcnVkT3BlcmF0aW9ucy9CYXNlTGlzdFZNLmpzXCI6IDEyLFxuXHRcIi4vQmFzZUNydWRPcGVyYXRpb25zL0Jhc2VWaWV3Vk1cIjogMTYsXG5cdFwiLi9CYXNlQ3J1ZE9wZXJhdGlvbnMvQmFzZVZpZXdWTS5qc1wiOiAxNixcblx0XCIuL2FwcFwiOiAxNyxcblx0XCIuL2FwcC5odG1sXCI6IDI4LFxuXHRcIi4vYXBwLmpzXCI6IDE3LFxuXHRcIi4vYXVyZWxpYS1hbmltYXRvci1jc3NcIjogMjksXG5cdFwiLi9hdXJlbGlhLWJvb3RzdHJhcHBlci13ZWJwYWNrXCI6IDIsXG5cdFwiLi9hdXJlbGlhLWV2ZW50LWFnZ3JlZ2F0b3JcIjogMjUsXG5cdFwiLi9hdXJlbGlhLWZyYW1ld29ya1wiOiAxOCxcblx0XCIuL2F1cmVsaWEtaGlzdG9yeS1icm93c2VyXCI6IDMwLFxuXHRcIi4vYXVyZWxpYS1sb2dnaW5nLWNvbnNvbGVcIjogMzIsXG5cdFwiLi9hdXJlbGlhLXBhbC1icm93c2VyXCI6IDUsXG5cdFwiLi9hdXJlbGlhLXBvbHlmaWxsc1wiOiAzLFxuXHRcIi4vYXVyZWxpYS1yb3V0ZXJcIjogMzMsXG5cdFwiLi9hdXJlbGlhLXNhaWxzLXNvY2tldC1jbGllbnRcIjogMjYsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctYmluZGluZ1wiOiAzNSxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXNcIjogMzYsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Fic3RyYWN0LXJlcGVhdGVyXCI6IDQ5LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9hYnN0cmFjdC1yZXBlYXRlci5qc1wiOiA0OSxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvYW5hbHl6ZS12aWV3LWZhY3RvcnlcIjogNDgsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2FuYWx5emUtdmlldy1mYWN0b3J5LmpzXCI6IDQ4LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9hcnJheS1yZXBlYXQtc3RyYXRlZ3lcIjogNDMsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2FycmF5LXJlcGVhdC1zdHJhdGVneS5qc1wiOiA0Myxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvYmluZGluZy1tb2RlLWJlaGF2aW9yc1wiOiA1OSxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvYmluZGluZy1tb2RlLWJlaGF2aW9ycy5qc1wiOiA1OSxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvYmluZGluZy1zaWduYWxlclwiOiA2Myxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvYmluZGluZy1zaWduYWxlci5qc1wiOiA2Myxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvY29tcGlsZS1zcHlcIjogNTYsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2NvbXBpbGUtc3B5LmpzXCI6IDU2LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9jb21wb3NlXCI6IDM3LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9jb21wb3NlLmpzXCI6IDM3LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9jc3MtcmVzb3VyY2VcIjogNTgsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Nzcy1yZXNvdXJjZS5qc1wiOiA1OCxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGVib3VuY2UtYmluZGluZy1iZWhhdmlvclwiOiA2MSxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGVib3VuY2UtYmluZGluZy1iZWhhdmlvci5qc1wiOiA2MSxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZHluYW1pYy1lbGVtZW50XCI6IDY2LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9keW5hbWljLWVsZW1lbnQuanNcIjogNjYsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2ZvY3VzXCI6IDU1LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9mb2N1cy5qc1wiOiA1NSxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvaGlkZVwiOiA1MSxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvaGlkZS5qc1wiOiA1MSxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvaHRtbC1yZXNvdXJjZS1wbHVnaW5cIjogNjUsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2h0bWwtcmVzb3VyY2UtcGx1Z2luLmpzXCI6IDY1LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9odG1sLXNhbml0aXplclwiOiA1Myxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvaHRtbC1zYW5pdGl6ZXIuanNcIjogNTMsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2lmXCI6IDM4LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9pZi5qc1wiOiAzOCxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvbWFwLXJlcGVhdC1zdHJhdGVneVwiOiA0NSxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvbWFwLXJlcGVhdC1zdHJhdGVneS5qc1wiOiA0NSxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvbnVsbC1yZXBlYXQtc3RyYXRlZ3lcIjogNDIsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL251bGwtcmVwZWF0LXN0cmF0ZWd5LmpzXCI6IDQyLFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9udW1iZXItcmVwZWF0LXN0cmF0ZWd5XCI6IDQ3LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9udW1iZXItcmVwZWF0LXN0cmF0ZWd5LmpzXCI6IDQ3LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9yZXBlYXRcIjogNDAsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL3JlcGVhdC1zdHJhdGVneS1sb2NhdG9yXCI6IDQxLFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9yZXBlYXQtc3RyYXRlZ3ktbG9jYXRvci5qc1wiOiA0MSxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvcmVwZWF0LXV0aWxpdGllc1wiOiA0NCxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvcmVwZWF0LXV0aWxpdGllcy5qc1wiOiA0NCxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvcmVwZWF0LmpzXCI6IDQwLFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9yZXBsYWNlYWJsZVwiOiA1NCxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvcmVwbGFjZWFibGUuanNcIjogNTQsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL3Nhbml0aXplLWh0bWxcIjogNTIsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL3Nhbml0aXplLWh0bWwuanNcIjogNTIsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL3NldC1yZXBlYXQtc3RyYXRlZ3lcIjogNDYsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL3NldC1yZXBlYXQtc3RyYXRlZ3kuanNcIjogNDYsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL3Nob3dcIjogNTAsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL3Nob3cuanNcIjogNTAsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL3NpZ25hbC1iaW5kaW5nLWJlaGF2aW9yXCI6IDYyLFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9zaWduYWwtYmluZGluZy1iZWhhdmlvci5qc1wiOiA2Mixcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvdGhyb3R0bGUtYmluZGluZy1iZWhhdmlvclwiOiA2MCxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvdGhyb3R0bGUtYmluZGluZy1iZWhhdmlvci5qc1wiOiA2MCxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvdXBkYXRlLXRyaWdnZXItYmluZGluZy1iZWhhdmlvclwiOiA2NCxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvdXBkYXRlLXRyaWdnZXItYmluZGluZy1iZWhhdmlvci5qc1wiOiA2NCxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvdmlldy1zcHlcIjogNTcsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL3ZpZXctc3B5LmpzXCI6IDU3LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy93aXRoXCI6IDM5LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy93aXRoLmpzXCI6IDM5LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJvdXRlclwiOiA2Nyxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yb3V0ZXIvcm91dGUtaHJlZlwiOiA3MCxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yb3V0ZXIvcm91dGUtaHJlZi5qc1wiOiA3MCxcblx0XCIuL2F1cmVsaWEtdGVtcGxhdGluZy1yb3V0ZXIvcm91dGUtbG9hZGVyXCI6IDY4LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJvdXRlci9yb3V0ZS1sb2FkZXIuanNcIjogNjgsXG5cdFwiLi9hdXJlbGlhLXRlbXBsYXRpbmctcm91dGVyL3JvdXRlci12aWV3XCI6IDY5LFxuXHRcIi4vYXVyZWxpYS10ZW1wbGF0aW5nLXJvdXRlci9yb3V0ZXItdmlldy5qc1wiOiA2OSxcblx0XCIuL2F1dGgvaW5kZXhcIjogNzEsXG5cdFwiLi9hdXRoL2luZGV4Lmh0bWxcIjogNzIsXG5cdFwiLi9hdXRoL2luZGV4LmpzXCI6IDcxLFxuXHRcIi4vYXV0aENvbmZpZ1wiOiA3Myxcblx0XCIuL2F1dGhDb25maWcuanNcIjogNzMsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvY29sbGVjdGlvbnMvdWktYnJlYWRjcnVtYlwiOiA3NCxcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9jb2xsZWN0aW9ucy91aS1icmVhZGNydW1iLmpzXCI6IDc0LFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2NvbGxlY3Rpb25zL3VpLWZvcm1cIjogNzcsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvY29sbGVjdGlvbnMvdWktZm9ybS5qc1wiOiA3Nyxcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9jb2xsZWN0aW9ucy91aS1ncmlkXCI6IDc4LFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2NvbGxlY3Rpb25zL3VpLWdyaWQuanNcIjogNzgsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvY29sbGVjdGlvbnMvdWktbWVudVwiOiA3OSxcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9jb2xsZWN0aW9ucy91aS1tZW51LmpzXCI6IDc5LFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2NvbGxlY3Rpb25zL3VpLW1lc3NhZ2VcIjogODAsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvY29sbGVjdGlvbnMvdWktbWVzc2FnZS5qc1wiOiA4MCxcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9jb2xsZWN0aW9ucy91aS10YWJsZVwiOiA4MSxcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9jb2xsZWN0aW9ucy91aS10YWJsZS5qc1wiOiA4MSxcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9jb25zdGFudHNcIjogNzUsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvY29uc3RhbnRzLmpzXCI6IDc1LFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWJ1dHRvblwiOiA4Mixcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1idXR0b24uanNcIjogODIsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktY29udGFpbmVyXCI6IDgzLFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWNvbnRhaW5lci5qc1wiOiA4Myxcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1kaXZpZGVyXCI6IDg0LFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWRpdmlkZXIuanNcIjogODQsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktZmxhZ1wiOiA4NSxcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1mbGFnLmpzXCI6IDg1LFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWhlYWRlclwiOiA4Nixcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1oZWFkZXIuanNcIjogODYsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktaWNvblwiOiA4Nyxcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1pY29uLmpzXCI6IDg3LFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWltYWdlXCI6IDg4LFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWltYWdlLmpzXCI6IDg4LFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWlucHV0XCI6IDg5LFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWlucHV0LmpzXCI6IDg5LFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWxhYmVsXCI6IDkwLFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWxhYmVsLmpzXCI6IDkwLFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWxpc3RcIjogOTEsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktbGlzdC5qc1wiOiA5MSxcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1sb2FkZXJcIjogOTIsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktbG9hZGVyLmpzXCI6IDkyLFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLXJhaWxcIjogOTMsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktcmFpbC5qc1wiOiA5Myxcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1yZXZlYWxcIjogOTQsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktcmV2ZWFsLmpzXCI6IDk0LFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLXNlZ21lbnRcIjogOTUsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktc2VnbWVudC5qc1wiOiA5NSxcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1zdGVwXCI6IDk2LFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLXN0ZXAuanNcIjogOTYsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvaW5kZXhcIjogOTcsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvaW5kZXguanNcIjogOTcsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvbW9kdWxlcy91aS1hY2NvcmRpb25cIjogOTgsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvbW9kdWxlcy91aS1hY2NvcmRpb24uanNcIjogOTgsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvbW9kdWxlcy91aS1kcm9wZG93blwiOiA5OSxcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9tb2R1bGVzL3VpLWRyb3Bkb3duLmpzXCI6IDk5LFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL21vZHVsZXMvdWktbW9kYWxcIjogMTAwLFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL21vZHVsZXMvdWktbW9kYWwuanNcIjogMTAwLFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL21vZHVsZXMvdWktc2VhcmNoXCI6IDEwMSxcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9tb2R1bGVzL3VpLXNlYXJjaC5qc1wiOiAxMDEsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvbW9kdWxlcy91aS1zaWRlYmFyXCI6IDEwMixcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9tb2R1bGVzL3VpLXNpZGViYXIuanNcIjogMTAyLFxuXHRcIi4vY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL3VpLWF0dHJpYnV0ZVwiOiA3Nixcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS91aS1hdHRyaWJ1dGUuanNcIjogNzYsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvdmlld3MvdWktY2FyZFwiOiAxMDMsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvdmlld3MvdWktY2FyZC5qc1wiOiAxMDMsXG5cdFwiLi9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvdmlld3MvdWktc3RhdGlzdGljXCI6IDEwNCxcblx0XCIuL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS92aWV3cy91aS1zdGF0aXN0aWMuanNcIjogMTA0LFxuXHRcIi4vY29tcG9uZW50cy9mb3JtLWNvbnRyb2xcIjogMTA1LFxuXHRcIi4vY29tcG9uZW50cy9mb3JtLWNvbnRyb2wuaHRtbFwiOiAxMDYsXG5cdFwiLi9jb21wb25lbnRzL2Zvcm0tY29udHJvbC5qc1wiOiAxMDUsXG5cdFwiLi9jb21wb25lbnRzL2Zvcm0tc3VibWl0XCI6IDEwNyxcblx0XCIuL2NvbXBvbmVudHMvZm9ybS1zdWJtaXQuaHRtbFwiOiAxMDgsXG5cdFwiLi9jb21wb25lbnRzL2Zvcm0tc3VibWl0LmpzXCI6IDEwNyxcblx0XCIuL2NvbXBvbmVudHMvaW5kZXhcIjogMTA5LFxuXHRcIi4vY29tcG9uZW50cy9pbmRleC5qc1wiOiAxMDksXG5cdFwiLi9ob21lL3dlbGNvbWVcIjogMTEwLFxuXHRcIi4vaG9tZS93ZWxjb21lLmh0bWxcIjogMTExLFxuXHRcIi4vaG9tZS93ZWxjb21lLmpzXCI6IDExMCxcblx0XCIuL2pxdWVyeVwiOiAxMyxcblx0XCIuL21haW5cIjogMSxcblx0XCIuL21haW4uanNcIjogMSxcblx0XCIuL21vdXNldHJhcFwiOiAxNSxcblx0XCIuL3F1ZXN0aW9uL2Fuc3dlcnMvYmFzZVwiOiAxMjUsXG5cdFwiLi9xdWVzdGlvbi9hbnN3ZXJzL2Jhc2UuanNcIjogMTI1LFxuXHRcIi4vcXVlc3Rpb24vYW5zd2Vycy9jcmVhdGVcIjogMTI2LFxuXHRcIi4vcXVlc3Rpb24vYW5zd2Vycy9jcmVhdGUuaHRtbFwiOiAxMjcsXG5cdFwiLi9xdWVzdGlvbi9hbnN3ZXJzL2NyZWF0ZS5qc1wiOiAxMjYsXG5cdFwiLi9xdWVzdGlvbi9hbnN3ZXJzL2xpc3RcIjogMTI4LFxuXHRcIi4vcXVlc3Rpb24vYW5zd2Vycy9saXN0Lmh0bWxcIjogMTI5LFxuXHRcIi4vcXVlc3Rpb24vYW5zd2Vycy9saXN0LmpzXCI6IDEyOCxcblx0XCIuL3F1ZXN0aW9uL2Fuc3dlcnMvdmlld1wiOiAxMzAsXG5cdFwiLi9xdWVzdGlvbi9hbnN3ZXJzL3ZpZXcuaHRtbFwiOiAxMzEsXG5cdFwiLi9xdWVzdGlvbi9hbnN3ZXJzL3ZpZXcuanNcIjogMTMwLFxuXHRcIi4vcXVlc3Rpb24vYmFzZVwiOiAxMzIsXG5cdFwiLi9xdWVzdGlvbi9iYXNlLmpzXCI6IDEzMixcblx0XCIuL3F1ZXN0aW9uL2NoaWxkLXJvdXRlclwiOiAxMzMsXG5cdFwiLi9xdWVzdGlvbi9jaGlsZC1yb3V0ZXIuaHRtbFwiOiAxMzQsXG5cdFwiLi9xdWVzdGlvbi9jaGlsZC1yb3V0ZXIuanNcIjogMTMzLFxuXHRcIi4vcXVlc3Rpb24vY3JlYXRlXCI6IDEzNSxcblx0XCIuL3F1ZXN0aW9uL2NyZWF0ZS5odG1sXCI6IDEzNixcblx0XCIuL3F1ZXN0aW9uL2NyZWF0ZS5qc1wiOiAxMzUsXG5cdFwiLi9xdWVzdGlvbi9kZXRhaWxzL2FkZEFuc3dlclwiOiAxMzcsXG5cdFwiLi9xdWVzdGlvbi9kZXRhaWxzL2FkZEFuc3dlci5odG1sXCI6IDEzOCxcblx0XCIuL3F1ZXN0aW9uL2RldGFpbHMvYWRkQW5zd2VyLmpzXCI6IDEzNyxcblx0XCIuL3F1ZXN0aW9uL2RldGFpbHMvY2hpbGQtcm91dGVyXCI6IDEzOSxcblx0XCIuL3F1ZXN0aW9uL2RldGFpbHMvY2hpbGQtcm91dGVyLmh0bWxcIjogMTQwLFxuXHRcIi4vcXVlc3Rpb24vZGV0YWlscy9jaGlsZC1yb3V0ZXIuanNcIjogMTM5LFxuXHRcIi4vcXVlc3Rpb24vZGV0YWlscy92aWV3XCI6IDE0MSxcblx0XCIuL3F1ZXN0aW9uL2RldGFpbHMvdmlldy5odG1sXCI6IDE0Mixcblx0XCIuL3F1ZXN0aW9uL2RldGFpbHMvdmlldy5qc1wiOiAxNDEsXG5cdFwiLi9xdWVzdGlvbi9saXN0XCI6IDE0Myxcblx0XCIuL3F1ZXN0aW9uL2xpc3QuaHRtbFwiOiAxNDQsXG5cdFwiLi9xdWVzdGlvbi9saXN0LmpzXCI6IDE0Myxcblx0XCIuL3F1ZXN0aW9uL3ZpZXdcIjogMTQ1LFxuXHRcIi4vcXVlc3Rpb24vdmlldy5odG1sXCI6IDE0Nixcblx0XCIuL3F1ZXN0aW9uL3ZpZXcuanNcIjogMTQ1LFxuXHRcIi4vcXVlc3Rpb25DYXRlZ29yeS9iYXNlXCI6IDE0Nyxcblx0XCIuL3F1ZXN0aW9uQ2F0ZWdvcnkvYmFzZS5qc1wiOiAxNDcsXG5cdFwiLi9xdWVzdGlvbkNhdGVnb3J5L2NoaWxkLXJvdXRlclwiOiAxNDgsXG5cdFwiLi9xdWVzdGlvbkNhdGVnb3J5L2NoaWxkLXJvdXRlci5odG1sXCI6IDE0OSxcblx0XCIuL3F1ZXN0aW9uQ2F0ZWdvcnkvY2hpbGQtcm91dGVyLmpzXCI6IDE0OCxcblx0XCIuL3F1ZXN0aW9uQ2F0ZWdvcnkvY3JlYXRlXCI6IDE1MCxcblx0XCIuL3F1ZXN0aW9uQ2F0ZWdvcnkvY3JlYXRlLmh0bWxcIjogMTUxLFxuXHRcIi4vcXVlc3Rpb25DYXRlZ29yeS9jcmVhdGUuanNcIjogMTUwLFxuXHRcIi4vcXVlc3Rpb25DYXRlZ29yeS9saXN0XCI6IDE1Mixcblx0XCIuL3F1ZXN0aW9uQ2F0ZWdvcnkvbGlzdC5odG1sXCI6IDE1Myxcblx0XCIuL3F1ZXN0aW9uQ2F0ZWdvcnkvbGlzdC5qc1wiOiAxNTIsXG5cdFwiLi9xdWVzdGlvbkNhdGVnb3J5L3ZpZXdcIjogMTU0LFxuXHRcIi4vcXVlc3Rpb25DYXRlZ29yeS92aWV3Lmh0bWxcIjogMTU1LFxuXHRcIi4vcXVlc3Rpb25DYXRlZ29yeS92aWV3LmpzXCI6IDE1NCxcblx0XCIuL3F1ZXN0aW9uS2luZC9iYXNlXCI6IDE1Nixcblx0XCIuL3F1ZXN0aW9uS2luZC9iYXNlLmpzXCI6IDE1Nixcblx0XCIuL3F1ZXN0aW9uS2luZC9jaGlsZC1yb3V0ZXJcIjogMTU3LFxuXHRcIi4vcXVlc3Rpb25LaW5kL2NoaWxkLXJvdXRlci5odG1sXCI6IDE1OCxcblx0XCIuL3F1ZXN0aW9uS2luZC9jaGlsZC1yb3V0ZXIuanNcIjogMTU3LFxuXHRcIi4vcXVlc3Rpb25LaW5kL2NyZWF0ZVwiOiAxNTksXG5cdFwiLi9xdWVzdGlvbktpbmQvY3JlYXRlLmh0bWxcIjogMTYwLFxuXHRcIi4vcXVlc3Rpb25LaW5kL2NyZWF0ZS5qc1wiOiAxNTksXG5cdFwiLi9xdWVzdGlvbktpbmQvbGlzdFwiOiAxNjEsXG5cdFwiLi9xdWVzdGlvbktpbmQvbGlzdC5odG1sXCI6IDE2Mixcblx0XCIuL3F1ZXN0aW9uS2luZC9saXN0LmpzXCI6IDE2MSxcblx0XCIuL3F1ZXN0aW9uS2luZC92aWV3XCI6IDE2Myxcblx0XCIuL3F1ZXN0aW9uS2luZC92aWV3Lmh0bWxcIjogMTY0LFxuXHRcIi4vcXVlc3Rpb25LaW5kL3ZpZXcuanNcIjogMTYzLFxuXHRcIi4vcXVlc3Rpb25UeXBlL2Jhc2VcIjogMTY1LFxuXHRcIi4vcXVlc3Rpb25UeXBlL2Jhc2UuanNcIjogMTY1LFxuXHRcIi4vcXVlc3Rpb25UeXBlL2NoaWxkLXJvdXRlclwiOiAxNjYsXG5cdFwiLi9xdWVzdGlvblR5cGUvY2hpbGQtcm91dGVyLmh0bWxcIjogMTY3LFxuXHRcIi4vcXVlc3Rpb25UeXBlL2NoaWxkLXJvdXRlci5qc1wiOiAxNjYsXG5cdFwiLi9xdWVzdGlvblR5cGUvY3JlYXRlXCI6IDE2OCxcblx0XCIuL3F1ZXN0aW9uVHlwZS9jcmVhdGUuaHRtbFwiOiAxNjksXG5cdFwiLi9xdWVzdGlvblR5cGUvY3JlYXRlLmpzXCI6IDE2OCxcblx0XCIuL3F1ZXN0aW9uVHlwZS9saXN0XCI6IDE3MCxcblx0XCIuL3F1ZXN0aW9uVHlwZS9saXN0Lmh0bWxcIjogMTcxLFxuXHRcIi4vcXVlc3Rpb25UeXBlL2xpc3QuanNcIjogMTcwLFxuXHRcIi4vcXVlc3Rpb25UeXBlL3ZpZXdcIjogMTcyLFxuXHRcIi4vcXVlc3Rpb25UeXBlL3ZpZXcuaHRtbFwiOiAxNzMsXG5cdFwiLi9xdWVzdGlvblR5cGUvdmlldy5qc1wiOiAxNzIsXG5cdFwiLi90ZXN0L3dlbGNvbWVcIjogMTc0LFxuXHRcIi4vdGVzdC93ZWxjb21lLmh0bWxcIjogMTc1LFxuXHRcIi4vdGVzdC93ZWxjb21lLmpzXCI6IDE3NCxcblx0XCIuL3VzZXJzL2Jhc2VcIjogMTc2LFxuXHRcIi4vdXNlcnMvYmFzZS5qc1wiOiAxNzYsXG5cdFwiLi91c2Vycy9jaGlsZC1yb3V0ZXJcIjogMTc3LFxuXHRcIi4vdXNlcnMvY2hpbGQtcm91dGVyLmh0bWxcIjogMTc4LFxuXHRcIi4vdXNlcnMvY2hpbGQtcm91dGVyLmpzXCI6IDE3Nyxcblx0XCIuL3VzZXJzL2NyZWF0ZVwiOiAxNzksXG5cdFwiLi91c2Vycy9jcmVhdGUuaHRtbFwiOiAxODAsXG5cdFwiLi91c2Vycy9jcmVhdGUuanNcIjogMTc5LFxuXHRcIi4vdXNlcnMvbGlzdFwiOiAxODEsXG5cdFwiLi91c2Vycy9saXN0Lmh0bWxcIjogMTgyLFxuXHRcIi4vdXNlcnMvbGlzdC5qc1wiOiAxODEsXG5cdFwiLi91c2Vycy92aWV3XCI6IDE4Myxcblx0XCIuL3VzZXJzL3ZpZXcuaHRtbFwiOiAxODQsXG5cdFwiLi91c2Vycy92aWV3LmpzXCI6IDE4M1xufTtcbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0KHJlcSkge1xuXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyh3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKSk7XG59O1xuZnVuY3Rpb24gd2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSkge1xuXHRyZXR1cm4gbWFwW3JlcV0gfHwgKGZ1bmN0aW9uKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInLlwiKSB9KCkpO1xufTtcbndlYnBhY2tDb250ZXh0LmtleXMgPSBmdW5jdGlvbiB3ZWJwYWNrQ29udGV4dEtleXMoKSB7XG5cdHJldHVybiBPYmplY3Qua2V5cyhtYXApO1xufTtcbndlYnBhY2tDb250ZXh0LnJlc29sdmUgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmU7XG5tb2R1bGUuZXhwb3J0cyA9IHdlYnBhY2tDb250ZXh0O1xud2VicGFja0NvbnRleHQuaWQgPSAxMDtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMgXlxcLlxcLy4qJFxuICoqIG1vZHVsZSBpZCA9IDEwXG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCJleHBvcnQgY2xhc3MgQmFzZUNyZWF0ZVZNIHtcbiAgY29uc3RydWN0b3Ioc2FpbHMsIHJvdXRlciwgY29uZmlnKSB7XG4gICAgdGhpcy5zYWlscyA9IHNhaWxzO1xuICAgIHRoaXMucm91dGVyID0gcm91dGVyO1xuICAgIHRoaXMuYmFzZUN0cmxVcmwgPSBjb25maWcuYmFzZUN0cmxVcmw7XG4gIH1cblxuICBzdWJtaXQoKSB7XG4gICAgdGhpcy5zYWlscy5wb3N0KHRoaXMuYmFzZUN0cmxVcmwsIHRoaXMuZW50aXR5KVxuICAgICAgLnRoZW4oZGF0YSA9PiB0aGlzLnJvdXRlci5uYXZpZ2F0ZSgnJykpO1xuICB9XG59XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9CYXNlQ3J1ZE9wZXJhdGlvbnMvQmFzZUNyZWF0ZVZNLmpzXG4gKiovIiwiaW1wb3J0ICogYXMgTG9nTWFuYWdlciBmcm9tICdhdXJlbGlhLWxvZ2dpbmcnO1xuaW1wb3J0ICdtb3VzZXRyYXAnO1xuaW1wb3J0ICdqcXVlcnknO1xuXG5jb25zdCBsb2dnZXIgPSBMb2dNYW5hZ2VyLmdldExvZ2dlcignQmFzZUxpc3RWTScpO1xuXG5leHBvcnQgY2xhc3MgQmFzZUxpc3RWTSB7XG4gIGVudGl0aWVzID0gW107XG5cbiAgY29uc3RydWN0b3Ioc2FpbHMsIHJvdXRlciwgY29uZmlnKSB7XG4gICAgdGhpcy5zYWlscyA9IHNhaWxzO1xuICAgIHRoaXMucm91dGVyID0gcm91dGVyO1xuICAgIHRoaXMuYmFzZUN0cmxVcmwgPSBjb25maWcuYmFzZUN0cmxVcmw7XG4gICAgdGhpcy5lbnRpdHlUb1N1YnNjcmliZSA9IGNvbmZpZy5lbnRpdHlUb1N1YnNjcmliZTtcblxuICAgIE1vdXNldHJhcC5iaW5kKCdhJywgKCk9PndpbmRvdy5sb2NhdGlvbiA9IGAjJHt0aGlzLmJhc2VDdHJsVXJsfUNyZWF0ZWApO1xuICAgIE1vdXNldHJhcC5iaW5kKCdsJywgKCk9PndpbmRvdy5sb2NhdGlvbiA9IGAjJHt0aGlzLmJhc2VDdHJsVXJsfWApO1xuICB9XG5cbiAgYWN0aXZhdGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuc2FpbHMuZ2V0KHRoaXMuYmFzZUN0cmxVcmwpLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdGhpcy5lbnRpdGllcyA9IHJlcy5ib2R5O1xuICAgICAgdGhpcy5zdWJzY3JpYmUoKTtcbiAgICB9KS5jYXRjaCgocmVzKSA9PiB7XG4gICAgICAocmVzLnN0YXR1c0NvZGUgPT09IDQwMykgPyB0aGlzLnJvdXRlci5uYXZpZ2F0ZSgnL2xvZ2luJykgOiBsb2dnZXIuZXJyb3IocmVzKTtcbiAgICB9KTtcbiAgfVxuXG4gIGF0dGFjaGVkKCkge1xuICAgICQoJ3RhYmxlIGEgLmljb24nKS5wb3B1cCh7dmFyaWF0aW9uOiAnbWluaSBpbnZlcnRlZCcsIGlubGluZTogdHJ1ZX0pO1xuICB9XG5cbiAgZGVhY3RpdmF0ZSgpIHtcbiAgICB0aGlzLnVuc3Vic2NyaWJlKCk7XG4gIH1cblxuICBzdWJzY3JpYmUoKSB7XG4gICAgdGhpcy5zYWlscy5vbih0aGlzLmVudGl0eVRvU3Vic2NyaWJlLCB0aGlzLnNlcnZlclVwZGF0ZS5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIHVuc3Vic2NyaWJlKCkge1xuICAgIHRoaXMuc2FpbHMub2ZmKHRoaXMuZW50aXR5VG9TdWJzY3JpYmUpO1xuICB9XG5cbiAgc2VydmVyVXBkYXRlKG1lc3NhZ2UpIHtcbiAgICBpZiAobWVzc2FnZS52ZXJiID09PSAnY3JlYXRlZCcpIHtcbiAgICAgIHRoaXMuZW50aXRpZXMucHVzaChtZXNzYWdlLmRhdGEpO1xuICAgIH0gZWxzZSBpZiAobWVzc2FnZS52ZXJiID09PSAndXBkYXRlZCcpIHtcbiAgICAgIGxldCBpO1xuICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZW50aXRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IGVudGl0eSA9IHRoaXMuZW50aXRpZXNbaV07XG4gICAgICAgIGlmICgnJyArIGVudGl0eS5pZCA9PT0gbWVzc2FnZS5pZCkge1xuICAgICAgICAgIHRoaXMuZW50aXRpZXNbaV0gPSBtZXNzYWdlLmRhdGE7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKG1lc3NhZ2UudmVyYiA9PT0gJ2Rlc3Ryb3llZCcpIHtcbiAgICAgIGxldCBpO1xuICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZW50aXRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IGVudGl0eSA9IHRoaXMuZW50aXRpZXNbaV07XG4gICAgICAgIGlmICgnJyArIGVudGl0eS5pZCA9PT0gbWVzc2FnZS5pZCkge1xuICAgICAgICAgIHRoaXMuZW50aXRpZXMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9CYXNlQ3J1ZE9wZXJhdGlvbnMvQmFzZUxpc3RWTS5qc1xuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZ2V0TG9nZ2VyID0gZ2V0TG9nZ2VyO1xuZXhwb3J0cy5hZGRBcHBlbmRlciA9IGFkZEFwcGVuZGVyO1xuZXhwb3J0cy5zZXRMZXZlbCA9IHNldExldmVsO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgbG9nTGV2ZWwgPSBleHBvcnRzLmxvZ0xldmVsID0ge1xuICBub25lOiAwLFxuICBlcnJvcjogMSxcbiAgd2FybjogMixcbiAgaW5mbzogMyxcbiAgZGVidWc6IDRcbn07XG5cbnZhciBsb2dnZXJzID0ge307XG52YXIgY3VycmVudExldmVsID0gbG9nTGV2ZWwubm9uZTtcbnZhciBhcHBlbmRlcnMgPSBbXTtcbnZhciBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcbnZhciBsb2dnZXJDb25zdHJ1Y3Rpb25LZXkgPSB7fTtcblxuZnVuY3Rpb24gbG9nKGxvZ2dlciwgbGV2ZWwsIGFyZ3MpIHtcbiAgdmFyIGkgPSBhcHBlbmRlcnMubGVuZ3RoO1xuICB2YXIgY3VycmVudCA9IHZvaWQgMDtcblxuICBhcmdzID0gc2xpY2UuY2FsbChhcmdzKTtcbiAgYXJncy51bnNoaWZ0KGxvZ2dlcik7XG5cbiAgd2hpbGUgKGktLSkge1xuICAgIGN1cnJlbnQgPSBhcHBlbmRlcnNbaV07XG4gICAgY3VycmVudFtsZXZlbF0uYXBwbHkoY3VycmVudCwgYXJncyk7XG4gIH1cbn1cblxuZnVuY3Rpb24gZGVidWcoKSB7XG4gIGlmIChjdXJyZW50TGV2ZWwgPCA0KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbG9nKHRoaXMsICdkZWJ1ZycsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIGluZm8oKSB7XG4gIGlmIChjdXJyZW50TGV2ZWwgPCAzKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbG9nKHRoaXMsICdpbmZvJywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gd2FybigpIHtcbiAgaWYgKGN1cnJlbnRMZXZlbCA8IDIpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsb2codGhpcywgJ3dhcm4nLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBlcnJvcigpIHtcbiAgaWYgKGN1cnJlbnRMZXZlbCA8IDEpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsb2codGhpcywgJ2Vycm9yJywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gY29ubmVjdExvZ2dlcihsb2dnZXIpIHtcbiAgbG9nZ2VyLmRlYnVnID0gZGVidWc7XG4gIGxvZ2dlci5pbmZvID0gaW5mbztcbiAgbG9nZ2VyLndhcm4gPSB3YXJuO1xuICBsb2dnZXIuZXJyb3IgPSBlcnJvcjtcbn1cblxuZnVuY3Rpb24gY3JlYXRlTG9nZ2VyKGlkKSB7XG4gIHZhciBsb2dnZXIgPSBuZXcgTG9nZ2VyKGlkLCBsb2dnZXJDb25zdHJ1Y3Rpb25LZXkpO1xuXG4gIGlmIChhcHBlbmRlcnMubGVuZ3RoKSB7XG4gICAgY29ubmVjdExvZ2dlcihsb2dnZXIpO1xuICB9XG5cbiAgcmV0dXJuIGxvZ2dlcjtcbn1cblxuZnVuY3Rpb24gZ2V0TG9nZ2VyKGlkKSB7XG4gIHJldHVybiBsb2dnZXJzW2lkXSB8fCAobG9nZ2Vyc1tpZF0gPSBjcmVhdGVMb2dnZXIoaWQpKTtcbn1cblxuZnVuY3Rpb24gYWRkQXBwZW5kZXIoYXBwZW5kZXIpIHtcbiAgYXBwZW5kZXJzLnB1c2goYXBwZW5kZXIpO1xuXG4gIGlmIChhcHBlbmRlcnMubGVuZ3RoID09PSAxKSB7XG4gICAgZm9yICh2YXIga2V5IGluIGxvZ2dlcnMpIHtcbiAgICAgIGNvbm5lY3RMb2dnZXIobG9nZ2Vyc1trZXldKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gc2V0TGV2ZWwobGV2ZWwpIHtcbiAgY3VycmVudExldmVsID0gbGV2ZWw7XG59XG5cbnZhciBMb2dnZXIgPSBleHBvcnRzLkxvZ2dlciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gTG9nZ2VyKGlkLCBrZXkpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTG9nZ2VyKTtcblxuICAgIGlmIChrZXkgIT09IGxvZ2dlckNvbnN0cnVjdGlvbktleSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgaW5zdGFudGlhdGUgXCJMb2dnZXJcIi4gVXNlIFwiZ2V0TG9nZ2VyXCIgaW5zdGVhZC4nKTtcbiAgICB9XG5cbiAgICB0aGlzLmlkID0gaWQ7XG4gIH1cblxuICBMb2dnZXIucHJvdG90eXBlLmRlYnVnID0gZnVuY3Rpb24gZGVidWcobWVzc2FnZSkge307XG5cbiAgTG9nZ2VyLnByb3RvdHlwZS5pbmZvID0gZnVuY3Rpb24gaW5mbyhtZXNzYWdlKSB7fTtcblxuICBMb2dnZXIucHJvdG90eXBlLndhcm4gPSBmdW5jdGlvbiB3YXJuKG1lc3NhZ2UpIHt9O1xuXG4gIExvZ2dlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiBlcnJvcihtZXNzYWdlKSB7fTtcblxuICByZXR1cm4gTG9nZ2VyO1xufSgpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtbG9nZ2luZy9kaXN0L2NvbW1vbmpzL2F1cmVsaWEtbG9nZ2luZy5qc1xuICoqIG1vZHVsZSBpZCA9IDE0XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIvKmdsb2JhbCBkZWZpbmU6ZmFsc2UgKi9cbi8qKlxuICogQ29weXJpZ2h0IDIwMTYgQ3JhaWcgQ2FtcGJlbGxcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqXG4gKiBNb3VzZXRyYXAgaXMgYSBzaW1wbGUga2V5Ym9hcmQgc2hvcnRjdXQgbGlicmFyeSBmb3IgSmF2YXNjcmlwdCB3aXRoXG4gKiBubyBleHRlcm5hbCBkZXBlbmRlbmNpZXNcbiAqXG4gKiBAdmVyc2lvbiAxLjYuMFxuICogQHVybCBjcmFpZy5pcy9raWxsaW5nL21pY2VcbiAqL1xuKGZ1bmN0aW9uKHdpbmRvdywgZG9jdW1lbnQsIHVuZGVmaW5lZCkge1xuXG4gICAgLy8gQ2hlY2sgaWYgbW91c2V0cmFwIGlzIHVzZWQgaW5zaWRlIGJyb3dzZXIsIGlmIG5vdCwgcmV0dXJuXG4gICAgaWYgKCF3aW5kb3cpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIG1hcHBpbmcgb2Ygc3BlY2lhbCBrZXljb2RlcyB0byB0aGVpciBjb3JyZXNwb25kaW5nIGtleXNcbiAgICAgKlxuICAgICAqIGV2ZXJ5dGhpbmcgaW4gdGhpcyBkaWN0aW9uYXJ5IGNhbm5vdCB1c2Uga2V5cHJlc3MgZXZlbnRzXG4gICAgICogc28gaXQgaGFzIHRvIGJlIGhlcmUgdG8gbWFwIHRvIHRoZSBjb3JyZWN0IGtleWNvZGVzIGZvclxuICAgICAqIGtleXVwL2tleWRvd24gZXZlbnRzXG4gICAgICpcbiAgICAgKiBAdHlwZSB7T2JqZWN0fVxuICAgICAqL1xuICAgIHZhciBfTUFQID0ge1xuICAgICAgICA4OiAnYmFja3NwYWNlJyxcbiAgICAgICAgOTogJ3RhYicsXG4gICAgICAgIDEzOiAnZW50ZXInLFxuICAgICAgICAxNjogJ3NoaWZ0JyxcbiAgICAgICAgMTc6ICdjdHJsJyxcbiAgICAgICAgMTg6ICdhbHQnLFxuICAgICAgICAyMDogJ2NhcHNsb2NrJyxcbiAgICAgICAgMjc6ICdlc2MnLFxuICAgICAgICAzMjogJ3NwYWNlJyxcbiAgICAgICAgMzM6ICdwYWdldXAnLFxuICAgICAgICAzNDogJ3BhZ2Vkb3duJyxcbiAgICAgICAgMzU6ICdlbmQnLFxuICAgICAgICAzNjogJ2hvbWUnLFxuICAgICAgICAzNzogJ2xlZnQnLFxuICAgICAgICAzODogJ3VwJyxcbiAgICAgICAgMzk6ICdyaWdodCcsXG4gICAgICAgIDQwOiAnZG93bicsXG4gICAgICAgIDQ1OiAnaW5zJyxcbiAgICAgICAgNDY6ICdkZWwnLFxuICAgICAgICA5MTogJ21ldGEnLFxuICAgICAgICA5MzogJ21ldGEnLFxuICAgICAgICAyMjQ6ICdtZXRhJ1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBtYXBwaW5nIGZvciBzcGVjaWFsIGNoYXJhY3RlcnMgc28gdGhleSBjYW4gc3VwcG9ydFxuICAgICAqXG4gICAgICogdGhpcyBkaWN0aW9uYXJ5IGlzIG9ubHkgdXNlZCBpbmNhc2UgeW91IHdhbnQgdG8gYmluZCBhXG4gICAgICoga2V5dXAgb3Iga2V5ZG93biBldmVudCB0byBvbmUgb2YgdGhlc2Uga2V5c1xuICAgICAqXG4gICAgICogQHR5cGUge09iamVjdH1cbiAgICAgKi9cbiAgICB2YXIgX0tFWUNPREVfTUFQID0ge1xuICAgICAgICAxMDY6ICcqJyxcbiAgICAgICAgMTA3OiAnKycsXG4gICAgICAgIDEwOTogJy0nLFxuICAgICAgICAxMTA6ICcuJyxcbiAgICAgICAgMTExIDogJy8nLFxuICAgICAgICAxODY6ICc7JyxcbiAgICAgICAgMTg3OiAnPScsXG4gICAgICAgIDE4ODogJywnLFxuICAgICAgICAxODk6ICctJyxcbiAgICAgICAgMTkwOiAnLicsXG4gICAgICAgIDE5MTogJy8nLFxuICAgICAgICAxOTI6ICdgJyxcbiAgICAgICAgMjE5OiAnWycsXG4gICAgICAgIDIyMDogJ1xcXFwnLFxuICAgICAgICAyMjE6ICddJyxcbiAgICAgICAgMjIyOiAnXFwnJ1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiB0aGlzIGlzIGEgbWFwcGluZyBvZiBrZXlzIHRoYXQgcmVxdWlyZSBzaGlmdCBvbiBhIFVTIGtleXBhZFxuICAgICAqIGJhY2sgdG8gdGhlIG5vbiBzaGlmdCBlcXVpdmVsZW50c1xuICAgICAqXG4gICAgICogdGhpcyBpcyBzbyB5b3UgY2FuIHVzZSBrZXl1cCBldmVudHMgd2l0aCB0aGVzZSBrZXlzXG4gICAgICpcbiAgICAgKiBub3RlIHRoYXQgdGhpcyB3aWxsIG9ubHkgd29yayByZWxpYWJseSBvbiBVUyBrZXlib2FyZHNcbiAgICAgKlxuICAgICAqIEB0eXBlIHtPYmplY3R9XG4gICAgICovXG4gICAgdmFyIF9TSElGVF9NQVAgPSB7XG4gICAgICAgICd+JzogJ2AnLFxuICAgICAgICAnISc6ICcxJyxcbiAgICAgICAgJ0AnOiAnMicsXG4gICAgICAgICcjJzogJzMnLFxuICAgICAgICAnJCc6ICc0JyxcbiAgICAgICAgJyUnOiAnNScsXG4gICAgICAgICdeJzogJzYnLFxuICAgICAgICAnJic6ICc3JyxcbiAgICAgICAgJyonOiAnOCcsXG4gICAgICAgICcoJzogJzknLFxuICAgICAgICAnKSc6ICcwJyxcbiAgICAgICAgJ18nOiAnLScsXG4gICAgICAgICcrJzogJz0nLFxuICAgICAgICAnOic6ICc7JyxcbiAgICAgICAgJ1xcXCInOiAnXFwnJyxcbiAgICAgICAgJzwnOiAnLCcsXG4gICAgICAgICc+JzogJy4nLFxuICAgICAgICAnPyc6ICcvJyxcbiAgICAgICAgJ3wnOiAnXFxcXCdcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogdGhpcyBpcyBhIGxpc3Qgb2Ygc3BlY2lhbCBzdHJpbmdzIHlvdSBjYW4gdXNlIHRvIG1hcFxuICAgICAqIHRvIG1vZGlmaWVyIGtleXMgd2hlbiB5b3Ugc3BlY2lmeSB5b3VyIGtleWJvYXJkIHNob3J0Y3V0c1xuICAgICAqXG4gICAgICogQHR5cGUge09iamVjdH1cbiAgICAgKi9cbiAgICB2YXIgX1NQRUNJQUxfQUxJQVNFUyA9IHtcbiAgICAgICAgJ29wdGlvbic6ICdhbHQnLFxuICAgICAgICAnY29tbWFuZCc6ICdtZXRhJyxcbiAgICAgICAgJ3JldHVybic6ICdlbnRlcicsXG4gICAgICAgICdlc2NhcGUnOiAnZXNjJyxcbiAgICAgICAgJ3BsdXMnOiAnKycsXG4gICAgICAgICdtb2QnOiAvTWFjfGlQb2R8aVBob25lfGlQYWQvLnRlc3QobmF2aWdhdG9yLnBsYXRmb3JtKSA/ICdtZXRhJyA6ICdjdHJsJ1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiB2YXJpYWJsZSB0byBzdG9yZSB0aGUgZmxpcHBlZCB2ZXJzaW9uIG9mIF9NQVAgZnJvbSBhYm92ZVxuICAgICAqIG5lZWRlZCB0byBjaGVjayBpZiB3ZSBzaG91bGQgdXNlIGtleXByZXNzIG9yIG5vdCB3aGVuIG5vIGFjdGlvblxuICAgICAqIGlzIHNwZWNpZmllZFxuICAgICAqXG4gICAgICogQHR5cGUge09iamVjdHx1bmRlZmluZWR9XG4gICAgICovXG4gICAgdmFyIF9SRVZFUlNFX01BUDtcblxuICAgIC8qKlxuICAgICAqIGxvb3AgdGhyb3VnaCB0aGUgZiBrZXlzLCBmMSB0byBmMTkgYW5kIGFkZCB0aGVtIHRvIHRoZSBtYXBcbiAgICAgKiBwcm9ncmFtYXRpY2FsbHlcbiAgICAgKi9cbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IDIwOyArK2kpIHtcbiAgICAgICAgX01BUFsxMTEgKyBpXSA9ICdmJyArIGk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogbG9vcCB0aHJvdWdoIHRvIG1hcCBudW1iZXJzIG9uIHRoZSBudW1lcmljIGtleXBhZFxuICAgICAqL1xuICAgIGZvciAoaSA9IDA7IGkgPD0gOTsgKytpKSB7XG4gICAgICAgIF9NQVBbaSArIDk2XSA9IGk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY3Jvc3MgYnJvd3NlciBhZGQgZXZlbnQgbWV0aG9kXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR8SFRNTERvY3VtZW50fSBvYmplY3RcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrXG4gICAgICogQHJldHVybnMgdm9pZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIF9hZGRFdmVudChvYmplY3QsIHR5cGUsIGNhbGxiYWNrKSB7XG4gICAgICAgIGlmIChvYmplY3QuYWRkRXZlbnRMaXN0ZW5lcikge1xuICAgICAgICAgICAgb2JqZWN0LmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgY2FsbGJhY2ssIGZhbHNlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIG9iamVjdC5hdHRhY2hFdmVudCgnb24nICsgdHlwZSwgY2FsbGJhY2spO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHRha2VzIHRoZSBldmVudCBhbmQgcmV0dXJucyB0aGUga2V5IGNoYXJhY3RlclxuICAgICAqXG4gICAgICogQHBhcmFtIHtFdmVudH0gZVxuICAgICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBfY2hhcmFjdGVyRnJvbUV2ZW50KGUpIHtcblxuICAgICAgICAvLyBmb3Iga2V5cHJlc3MgZXZlbnRzIHdlIHNob3VsZCByZXR1cm4gdGhlIGNoYXJhY3RlciBhcyBpc1xuICAgICAgICBpZiAoZS50eXBlID09ICdrZXlwcmVzcycpIHtcbiAgICAgICAgICAgIHZhciBjaGFyYWN0ZXIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuXG4gICAgICAgICAgICAvLyBpZiB0aGUgc2hpZnQga2V5IGlzIG5vdCBwcmVzc2VkIHRoZW4gaXQgaXMgc2FmZSB0byBhc3N1bWVcbiAgICAgICAgICAgIC8vIHRoYXQgd2Ugd2FudCB0aGUgY2hhcmFjdGVyIHRvIGJlIGxvd2VyY2FzZS4gIHRoaXMgbWVhbnMgaWZcbiAgICAgICAgICAgIC8vIHlvdSBhY2NpZGVudGFsbHkgaGF2ZSBjYXBzIGxvY2sgb24gdGhlbiB5b3VyIGtleSBiaW5kaW5nc1xuICAgICAgICAgICAgLy8gd2lsbCBjb250aW51ZSB0byB3b3JrXG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgLy8gdGhlIG9ubHkgc2lkZSBlZmZlY3QgdGhhdCBtaWdodCBub3QgYmUgZGVzaXJlZCBpcyBpZiB5b3VcbiAgICAgICAgICAgIC8vIGJpbmQgc29tZXRoaW5nIGxpa2UgJ0EnIGNhdXNlIHlvdSB3YW50IHRvIHRyaWdnZXIgYW5cbiAgICAgICAgICAgIC8vIGV2ZW50IHdoZW4gY2FwaXRhbCBBIGlzIHByZXNzZWQgY2FwcyBsb2NrIHdpbGwgbm8gbG9uZ2VyXG4gICAgICAgICAgICAvLyB0cmlnZ2VyIHRoZSBldmVudC4gIHNoaWZ0K2Egd2lsbCB0aG91Z2guXG4gICAgICAgICAgICBpZiAoIWUuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICBjaGFyYWN0ZXIgPSBjaGFyYWN0ZXIudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGNoYXJhY3RlcjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZvciBub24ga2V5cHJlc3MgZXZlbnRzIHRoZSBzcGVjaWFsIG1hcHMgYXJlIG5lZWRlZFxuICAgICAgICBpZiAoX01BUFtlLndoaWNoXSkge1xuICAgICAgICAgICAgcmV0dXJuIF9NQVBbZS53aGljaF07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoX0tFWUNPREVfTUFQW2Uud2hpY2hdKSB7XG4gICAgICAgICAgICByZXR1cm4gX0tFWUNPREVfTUFQW2Uud2hpY2hdO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgaXQgaXMgbm90IGluIHRoZSBzcGVjaWFsIG1hcFxuXG4gICAgICAgIC8vIHdpdGgga2V5ZG93biBhbmQga2V5dXAgZXZlbnRzIHRoZSBjaGFyYWN0ZXIgc2VlbXMgdG8gYWx3YXlzXG4gICAgICAgIC8vIGNvbWUgaW4gYXMgYW4gdXBwZXJjYXNlIGNoYXJhY3RlciB3aGV0aGVyIHlvdSBhcmUgcHJlc3Npbmcgc2hpZnRcbiAgICAgICAgLy8gb3Igbm90LiAgd2Ugc2hvdWxkIG1ha2Ugc3VyZSBpdCBpcyBhbHdheXMgbG93ZXJjYXNlIGZvciBjb21wYXJpc29uc1xuICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKS50b0xvd2VyQ2FzZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNoZWNrcyBpZiB0d28gYXJyYXlzIGFyZSBlcXVhbFxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gbW9kaWZpZXJzMVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IG1vZGlmaWVyczJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBfbW9kaWZpZXJzTWF0Y2gobW9kaWZpZXJzMSwgbW9kaWZpZXJzMikge1xuICAgICAgICByZXR1cm4gbW9kaWZpZXJzMS5zb3J0KCkuam9pbignLCcpID09PSBtb2RpZmllcnMyLnNvcnQoKS5qb2luKCcsJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogdGFrZXMgYSBrZXkgZXZlbnQgYW5kIGZpZ3VyZXMgb3V0IHdoYXQgdGhlIG1vZGlmaWVycyBhcmVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RXZlbnR9IGVcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9XG4gICAgICovXG4gICAgZnVuY3Rpb24gX2V2ZW50TW9kaWZpZXJzKGUpIHtcbiAgICAgICAgdmFyIG1vZGlmaWVycyA9IFtdO1xuXG4gICAgICAgIGlmIChlLnNoaWZ0S2V5KSB7XG4gICAgICAgICAgICBtb2RpZmllcnMucHVzaCgnc2hpZnQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlLmFsdEtleSkge1xuICAgICAgICAgICAgbW9kaWZpZXJzLnB1c2goJ2FsdCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGUuY3RybEtleSkge1xuICAgICAgICAgICAgbW9kaWZpZXJzLnB1c2goJ2N0cmwnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlLm1ldGFLZXkpIHtcbiAgICAgICAgICAgIG1vZGlmaWVycy5wdXNoKCdtZXRhJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbW9kaWZpZXJzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHByZXZlbnRzIGRlZmF1bHQgZm9yIHRoaXMgZXZlbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RXZlbnR9IGVcbiAgICAgKiBAcmV0dXJucyB2b2lkXG4gICAgICovXG4gICAgZnVuY3Rpb24gX3ByZXZlbnREZWZhdWx0KGUpIHtcbiAgICAgICAgaWYgKGUucHJldmVudERlZmF1bHQpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGUucmV0dXJuVmFsdWUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBzdG9wcyBwcm9wb2dhdGlvbiBmb3IgdGhpcyBldmVudFxuICAgICAqXG4gICAgICogQHBhcmFtIHtFdmVudH0gZVxuICAgICAqIEByZXR1cm5zIHZvaWRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBfc3RvcFByb3BhZ2F0aW9uKGUpIHtcbiAgICAgICAgaWYgKGUuc3RvcFByb3BhZ2F0aW9uKSB7XG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZS5jYW5jZWxCdWJibGUgPSB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGRldGVybWluZXMgaWYgdGhlIGtleWNvZGUgc3BlY2lmaWVkIGlzIGEgbW9kaWZpZXIga2V5IG9yIG5vdFxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleVxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIF9pc01vZGlmaWVyKGtleSkge1xuICAgICAgICByZXR1cm4ga2V5ID09ICdzaGlmdCcgfHwga2V5ID09ICdjdHJsJyB8fCBrZXkgPT0gJ2FsdCcgfHwga2V5ID09ICdtZXRhJztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZXZlcnNlcyB0aGUgbWFwIGxvb2t1cCBzbyB0aGF0IHdlIGNhbiBsb29rIGZvciBzcGVjaWZpYyBrZXlzXG4gICAgICogdG8gc2VlIHdoYXQgY2FuIGFuZCBjYW4ndCB1c2Uga2V5cHJlc3NcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge09iamVjdH1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBfZ2V0UmV2ZXJzZU1hcCgpIHtcbiAgICAgICAgaWYgKCFfUkVWRVJTRV9NQVApIHtcbiAgICAgICAgICAgIF9SRVZFUlNFX01BUCA9IHt9O1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIF9NQVApIHtcblxuICAgICAgICAgICAgICAgIC8vIHB1bGwgb3V0IHRoZSBudW1lcmljIGtleXBhZCBmcm9tIGhlcmUgY2F1c2Uga2V5cHJlc3Mgc2hvdWxkXG4gICAgICAgICAgICAgICAgLy8gYmUgYWJsZSB0byBkZXRlY3QgdGhlIGtleXMgZnJvbSB0aGUgY2hhcmFjdGVyXG4gICAgICAgICAgICAgICAgaWYgKGtleSA+IDk1ICYmIGtleSA8IDExMikge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoX01BUC5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIF9SRVZFUlNFX01BUFtfTUFQW2tleV1dID0ga2V5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX1JFVkVSU0VfTUFQO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHBpY2tzIHRoZSBiZXN0IGFjdGlvbiBiYXNlZCBvbiB0aGUga2V5IGNvbWJpbmF0aW9uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0gY2hhcmFjdGVyIGZvciBrZXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBtb2RpZmllcnNcbiAgICAgKiBAcGFyYW0ge3N0cmluZz19IGFjdGlvbiBwYXNzZWQgaW5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBfcGlja0Jlc3RBY3Rpb24oa2V5LCBtb2RpZmllcnMsIGFjdGlvbikge1xuXG4gICAgICAgIC8vIGlmIG5vIGFjdGlvbiB3YXMgcGlja2VkIGluIHdlIHNob3VsZCB0cnkgdG8gcGljayB0aGUgb25lXG4gICAgICAgIC8vIHRoYXQgd2UgdGhpbmsgd291bGQgd29yayBiZXN0IGZvciB0aGlzIGtleVxuICAgICAgICBpZiAoIWFjdGlvbikge1xuICAgICAgICAgICAgYWN0aW9uID0gX2dldFJldmVyc2VNYXAoKVtrZXldID8gJ2tleWRvd24nIDogJ2tleXByZXNzJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIG1vZGlmaWVyIGtleXMgZG9uJ3Qgd29yayBhcyBleHBlY3RlZCB3aXRoIGtleXByZXNzLFxuICAgICAgICAvLyBzd2l0Y2ggdG8ga2V5ZG93blxuICAgICAgICBpZiAoYWN0aW9uID09ICdrZXlwcmVzcycgJiYgbW9kaWZpZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgYWN0aW9uID0gJ2tleWRvd24nO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGFjdGlvbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBmcm9tIGEgc3RyaW5nIGtleSBjb21iaW5hdGlvbiB0byBhbiBhcnJheVxuICAgICAqXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSBjb21iaW5hdGlvbiBsaWtlIFwiY29tbWFuZCtzaGlmdCtsXCJcbiAgICAgKiBAcmV0dXJuIHtBcnJheX1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBfa2V5c0Zyb21TdHJpbmcoY29tYmluYXRpb24pIHtcbiAgICAgICAgaWYgKGNvbWJpbmF0aW9uID09PSAnKycpIHtcbiAgICAgICAgICAgIHJldHVybiBbJysnXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbWJpbmF0aW9uID0gY29tYmluYXRpb24ucmVwbGFjZSgvXFwrezJ9L2csICcrcGx1cycpO1xuICAgICAgICByZXR1cm4gY29tYmluYXRpb24uc3BsaXQoJysnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGluZm8gZm9yIGEgc3BlY2lmaWMga2V5IGNvbWJpbmF0aW9uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGNvbWJpbmF0aW9uIGtleSBjb21iaW5hdGlvbiAoXCJjb21tYW5kK3NcIiBvciBcImFcIiBvciBcIipcIilcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmc9fSBhY3Rpb25cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIF9nZXRLZXlJbmZvKGNvbWJpbmF0aW9uLCBhY3Rpb24pIHtcbiAgICAgICAgdmFyIGtleXM7XG4gICAgICAgIHZhciBrZXk7XG4gICAgICAgIHZhciBpO1xuICAgICAgICB2YXIgbW9kaWZpZXJzID0gW107XG5cbiAgICAgICAgLy8gdGFrZSB0aGUga2V5cyBmcm9tIHRoaXMgcGF0dGVybiBhbmQgZmlndXJlIG91dCB3aGF0IHRoZSBhY3R1YWxcbiAgICAgICAgLy8gcGF0dGVybiBpcyBhbGwgYWJvdXRcbiAgICAgICAga2V5cyA9IF9rZXlzRnJvbVN0cmluZyhjb21iaW5hdGlvbik7XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGtleXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIGtleSA9IGtleXNbaV07XG5cbiAgICAgICAgICAgIC8vIG5vcm1hbGl6ZSBrZXkgbmFtZXNcbiAgICAgICAgICAgIGlmIChfU1BFQ0lBTF9BTElBU0VTW2tleV0pIHtcbiAgICAgICAgICAgICAgICBrZXkgPSBfU1BFQ0lBTF9BTElBU0VTW2tleV07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgbm90IGEga2V5cHJlc3MgZXZlbnQgdGhlbiB3ZSBzaG91bGRcbiAgICAgICAgICAgIC8vIGJlIHNtYXJ0IGFib3V0IHVzaW5nIHNoaWZ0IGtleXNcbiAgICAgICAgICAgIC8vIHRoaXMgd2lsbCBvbmx5IHdvcmsgZm9yIFVTIGtleWJvYXJkcyBob3dldmVyXG4gICAgICAgICAgICBpZiAoYWN0aW9uICYmIGFjdGlvbiAhPSAna2V5cHJlc3MnICYmIF9TSElGVF9NQVBba2V5XSkge1xuICAgICAgICAgICAgICAgIGtleSA9IF9TSElGVF9NQVBba2V5XTtcbiAgICAgICAgICAgICAgICBtb2RpZmllcnMucHVzaCgnc2hpZnQnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gaWYgdGhpcyBrZXkgaXMgYSBtb2RpZmllciB0aGVuIGFkZCBpdCB0byB0aGUgbGlzdCBvZiBtb2RpZmllcnNcbiAgICAgICAgICAgIGlmIChfaXNNb2RpZmllcihrZXkpKSB7XG4gICAgICAgICAgICAgICAgbW9kaWZpZXJzLnB1c2goa2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGRlcGVuZGluZyBvbiB3aGF0IHRoZSBrZXkgY29tYmluYXRpb24gaXNcbiAgICAgICAgLy8gd2Ugd2lsbCB0cnkgdG8gcGljayB0aGUgYmVzdCBldmVudCBmb3IgaXRcbiAgICAgICAgYWN0aW9uID0gX3BpY2tCZXN0QWN0aW9uKGtleSwgbW9kaWZpZXJzLCBhY3Rpb24pO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBrZXk6IGtleSxcbiAgICAgICAgICAgIG1vZGlmaWVyczogbW9kaWZpZXJzLFxuICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb25cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBfYmVsb25nc1RvKGVsZW1lbnQsIGFuY2VzdG9yKSB7XG4gICAgICAgIGlmIChlbGVtZW50ID09PSBudWxsIHx8IGVsZW1lbnQgPT09IGRvY3VtZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZWxlbWVudCA9PT0gYW5jZXN0b3IpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIF9iZWxvbmdzVG8oZWxlbWVudC5wYXJlbnROb2RlLCBhbmNlc3Rvcik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gTW91c2V0cmFwKHRhcmdldEVsZW1lbnQpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIHRhcmdldEVsZW1lbnQgPSB0YXJnZXRFbGVtZW50IHx8IGRvY3VtZW50O1xuXG4gICAgICAgIGlmICghKHNlbGYgaW5zdGFuY2VvZiBNb3VzZXRyYXApKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IE1vdXNldHJhcCh0YXJnZXRFbGVtZW50KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBlbGVtZW50IHRvIGF0dGFjaCBrZXkgZXZlbnRzIHRvXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHtFbGVtZW50fVxuICAgICAgICAgKi9cbiAgICAgICAgc2VsZi50YXJnZXQgPSB0YXJnZXRFbGVtZW50O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBhIGxpc3Qgb2YgYWxsIHRoZSBjYWxsYmFja3Mgc2V0dXAgdmlhIE1vdXNldHJhcC5iaW5kKClcbiAgICAgICAgICpcbiAgICAgICAgICogQHR5cGUge09iamVjdH1cbiAgICAgICAgICovXG4gICAgICAgIHNlbGYuX2NhbGxiYWNrcyA9IHt9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBkaXJlY3QgbWFwIG9mIHN0cmluZyBjb21iaW5hdGlvbnMgdG8gY2FsbGJhY2tzIHVzZWQgZm9yIHRyaWdnZXIoKVxuICAgICAgICAgKlxuICAgICAgICAgKiBAdHlwZSB7T2JqZWN0fVxuICAgICAgICAgKi9cbiAgICAgICAgc2VsZi5fZGlyZWN0TWFwID0ge307XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGtlZXBzIHRyYWNrIG9mIHdoYXQgbGV2ZWwgZWFjaCBzZXF1ZW5jZSBpcyBhdCBzaW5jZSBtdWx0aXBsZVxuICAgICAgICAgKiBzZXF1ZW5jZXMgY2FuIHN0YXJ0IG91dCB3aXRoIHRoZSBzYW1lIHNlcXVlbmNlXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHtPYmplY3R9XG4gICAgICAgICAqL1xuICAgICAgICB2YXIgX3NlcXVlbmNlTGV2ZWxzID0ge307XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHZhcmlhYmxlIHRvIHN0b3JlIHRoZSBzZXRUaW1lb3V0IGNhbGxcbiAgICAgICAgICpcbiAgICAgICAgICogQHR5cGUge251bGx8bnVtYmVyfVxuICAgICAgICAgKi9cbiAgICAgICAgdmFyIF9yZXNldFRpbWVyO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiB0ZW1wb3Jhcnkgc3RhdGUgd2hlcmUgd2Ugd2lsbCBpZ25vcmUgdGhlIG5leHQga2V5dXBcbiAgICAgICAgICpcbiAgICAgICAgICogQHR5cGUge2Jvb2xlYW58c3RyaW5nfVxuICAgICAgICAgKi9cbiAgICAgICAgdmFyIF9pZ25vcmVOZXh0S2V5dXAgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogdGVtcG9yYXJ5IHN0YXRlIHdoZXJlIHdlIHdpbGwgaWdub3JlIHRoZSBuZXh0IGtleXByZXNzXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgdmFyIF9pZ25vcmVOZXh0S2V5cHJlc3MgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogYXJlIHdlIGN1cnJlbnRseSBpbnNpZGUgb2YgYSBzZXF1ZW5jZT9cbiAgICAgICAgICogdHlwZSBvZiBhY3Rpb24gKFwia2V5dXBcIiBvciBcImtleWRvd25cIiBvciBcImtleXByZXNzXCIpIG9yIGZhbHNlXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHtib29sZWFufHN0cmluZ31cbiAgICAgICAgICovXG4gICAgICAgIHZhciBfbmV4dEV4cGVjdGVkQWN0aW9uID0gZmFsc2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJlc2V0cyBhbGwgc2VxdWVuY2UgY291bnRlcnMgZXhjZXB0IGZvciB0aGUgb25lcyBwYXNzZWQgaW5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGRvTm90UmVzZXRcbiAgICAgICAgICogQHJldHVybnMgdm9pZFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gX3Jlc2V0U2VxdWVuY2VzKGRvTm90UmVzZXQpIHtcbiAgICAgICAgICAgIGRvTm90UmVzZXQgPSBkb05vdFJlc2V0IHx8IHt9O1xuXG4gICAgICAgICAgICB2YXIgYWN0aXZlU2VxdWVuY2VzID0gZmFsc2UsXG4gICAgICAgICAgICAgICAga2V5O1xuXG4gICAgICAgICAgICBmb3IgKGtleSBpbiBfc2VxdWVuY2VMZXZlbHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoZG9Ob3RSZXNldFtrZXldKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZVNlcXVlbmNlcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfc2VxdWVuY2VMZXZlbHNba2V5XSA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghYWN0aXZlU2VxdWVuY2VzKSB7XG4gICAgICAgICAgICAgICAgX25leHRFeHBlY3RlZEFjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGZpbmRzIGFsbCBjYWxsYmFja3MgdGhhdCBtYXRjaCBiYXNlZCBvbiB0aGUga2V5Y29kZSwgbW9kaWZpZXJzLFxuICAgICAgICAgKiBhbmQgYWN0aW9uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjaGFyYWN0ZXJcbiAgICAgICAgICogQHBhcmFtIHtBcnJheX0gbW9kaWZpZXJzXG4gICAgICAgICAqIEBwYXJhbSB7RXZlbnR8T2JqZWN0fSBlXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gc2VxdWVuY2VOYW1lIC0gbmFtZSBvZiB0aGUgc2VxdWVuY2Ugd2UgYXJlIGxvb2tpbmcgZm9yXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gY29tYmluYXRpb25cbiAgICAgICAgICogQHBhcmFtIHtudW1iZXI9fSBsZXZlbFxuICAgICAgICAgKiBAcmV0dXJucyB7QXJyYXl9XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfZ2V0TWF0Y2hlcyhjaGFyYWN0ZXIsIG1vZGlmaWVycywgZSwgc2VxdWVuY2VOYW1lLCBjb21iaW5hdGlvbiwgbGV2ZWwpIHtcbiAgICAgICAgICAgIHZhciBpO1xuICAgICAgICAgICAgdmFyIGNhbGxiYWNrO1xuICAgICAgICAgICAgdmFyIG1hdGNoZXMgPSBbXTtcbiAgICAgICAgICAgIHZhciBhY3Rpb24gPSBlLnR5cGU7XG5cbiAgICAgICAgICAgIC8vIGlmIHRoZXJlIGFyZSBubyBldmVudHMgcmVsYXRlZCB0byB0aGlzIGtleWNvZGVcbiAgICAgICAgICAgIGlmICghc2VsZi5fY2FsbGJhY2tzW2NoYXJhY3Rlcl0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGlmIGEgbW9kaWZpZXIga2V5IGlzIGNvbWluZyB1cCBvbiBpdHMgb3duIHdlIHNob3VsZCBhbGxvdyBpdFxuICAgICAgICAgICAgaWYgKGFjdGlvbiA9PSAna2V5dXAnICYmIF9pc01vZGlmaWVyKGNoYXJhY3RlcikpIHtcbiAgICAgICAgICAgICAgICBtb2RpZmllcnMgPSBbY2hhcmFjdGVyXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gbG9vcCB0aHJvdWdoIGFsbCBjYWxsYmFja3MgZm9yIHRoZSBrZXkgdGhhdCB3YXMgcHJlc3NlZFxuICAgICAgICAgICAgLy8gYW5kIHNlZSBpZiBhbnkgb2YgdGhlbSBtYXRjaFxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNlbGYuX2NhbGxiYWNrc1tjaGFyYWN0ZXJdLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2sgPSBzZWxmLl9jYWxsYmFja3NbY2hhcmFjdGVyXVtpXTtcblxuICAgICAgICAgICAgICAgIC8vIGlmIGEgc2VxdWVuY2UgbmFtZSBpcyBub3Qgc3BlY2lmaWVkLCBidXQgdGhpcyBpcyBhIHNlcXVlbmNlIGF0XG4gICAgICAgICAgICAgICAgLy8gdGhlIHdyb25nIGxldmVsIHRoZW4gbW92ZSBvbnRvIHRoZSBuZXh0IG1hdGNoXG4gICAgICAgICAgICAgICAgaWYgKCFzZXF1ZW5jZU5hbWUgJiYgY2FsbGJhY2suc2VxICYmIF9zZXF1ZW5jZUxldmVsc1tjYWxsYmFjay5zZXFdICE9IGNhbGxiYWNrLmxldmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBhY3Rpb24gd2UgYXJlIGxvb2tpbmcgZm9yIGRvZXNuJ3QgbWF0Y2ggdGhlIGFjdGlvbiB3ZSBnb3RcbiAgICAgICAgICAgICAgICAvLyB0aGVuIHdlIHNob3VsZCBrZWVwIGdvaW5nXG4gICAgICAgICAgICAgICAgaWYgKGFjdGlvbiAhPSBjYWxsYmFjay5hY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhIGtleXByZXNzIGV2ZW50IGFuZCB0aGUgbWV0YSBrZXkgYW5kIGNvbnRyb2wga2V5XG4gICAgICAgICAgICAgICAgLy8gYXJlIG5vdCBwcmVzc2VkIHRoYXQgbWVhbnMgdGhhdCB3ZSBuZWVkIHRvIG9ubHkgbG9vayBhdCB0aGVcbiAgICAgICAgICAgICAgICAvLyBjaGFyYWN0ZXIsIG90aGVyd2lzZSBjaGVjayB0aGUgbW9kaWZpZXJzIGFzIHdlbGxcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vIGNocm9tZSB3aWxsIG5vdCBmaXJlIGEga2V5cHJlc3MgaWYgbWV0YSBvciBjb250cm9sIGlzIGRvd25cbiAgICAgICAgICAgICAgICAvLyBzYWZhcmkgd2lsbCBmaXJlIGEga2V5cHJlc3MgaWYgbWV0YSBvciBtZXRhK3NoaWZ0IGlzIGRvd25cbiAgICAgICAgICAgICAgICAvLyBmaXJlZm94IHdpbGwgZmlyZSBhIGtleXByZXNzIGlmIG1ldGEgb3IgY29udHJvbCBpcyBkb3duXG4gICAgICAgICAgICAgICAgaWYgKChhY3Rpb24gPT0gJ2tleXByZXNzJyAmJiAhZS5tZXRhS2V5ICYmICFlLmN0cmxLZXkpIHx8IF9tb2RpZmllcnNNYXRjaChtb2RpZmllcnMsIGNhbGxiYWNrLm1vZGlmaWVycykpIHtcblxuICAgICAgICAgICAgICAgICAgICAvLyB3aGVuIHlvdSBiaW5kIGEgY29tYmluYXRpb24gb3Igc2VxdWVuY2UgYSBzZWNvbmQgdGltZSBpdFxuICAgICAgICAgICAgICAgICAgICAvLyBzaG91bGQgb3ZlcndyaXRlIHRoZSBmaXJzdCBvbmUuICBpZiBhIHNlcXVlbmNlTmFtZSBvclxuICAgICAgICAgICAgICAgICAgICAvLyBjb21iaW5hdGlvbiBpcyBzcGVjaWZpZWQgaW4gdGhpcyBjYWxsIGl0IGRvZXMganVzdCB0aGF0XG4gICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgIC8vIEB0b2RvIG1ha2UgZGVsZXRpbmcgaXRzIG93biBtZXRob2Q/XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWxldGVDb21ibyA9ICFzZXF1ZW5jZU5hbWUgJiYgY2FsbGJhY2suY29tYm8gPT0gY29tYmluYXRpb247XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWxldGVTZXF1ZW5jZSA9IHNlcXVlbmNlTmFtZSAmJiBjYWxsYmFjay5zZXEgPT0gc2VxdWVuY2VOYW1lICYmIGNhbGxiYWNrLmxldmVsID09IGxldmVsO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGVsZXRlQ29tYm8gfHwgZGVsZXRlU2VxdWVuY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2NhbGxiYWNrc1tjaGFyYWN0ZXJdLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoZXMucHVzaChjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbWF0Y2hlcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBhY3R1YWxseSBjYWxscyB0aGUgY2FsbGJhY2sgZnVuY3Rpb25cbiAgICAgICAgICpcbiAgICAgICAgICogaWYgeW91ciBjYWxsYmFjayBmdW5jdGlvbiByZXR1cm5zIGZhbHNlIHRoaXMgd2lsbCB1c2UgdGhlIGpxdWVyeVxuICAgICAgICAgKiBjb252ZW50aW9uIC0gcHJldmVudCBkZWZhdWx0IGFuZCBzdG9wIHByb3BvZ2F0aW9uIG9uIHRoZSBldmVudFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICAgICAgICAgKiBAcGFyYW0ge0V2ZW50fSBlXG4gICAgICAgICAqIEByZXR1cm5zIHZvaWRcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9maXJlQ2FsbGJhY2soY2FsbGJhY2ssIGUsIGNvbWJvLCBzZXF1ZW5jZSkge1xuXG4gICAgICAgICAgICAvLyBpZiB0aGlzIGV2ZW50IHNob3VsZCBub3QgaGFwcGVuIHN0b3AgaGVyZVxuICAgICAgICAgICAgaWYgKHNlbGYuc3RvcENhbGxiYWNrKGUsIGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudCwgY29tYm8sIHNlcXVlbmNlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKGUsIGNvbWJvKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBfcHJldmVudERlZmF1bHQoZSk7XG4gICAgICAgICAgICAgICAgX3N0b3BQcm9wYWdhdGlvbihlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBoYW5kbGVzIGEgY2hhcmFjdGVyIGtleSBldmVudFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2hhcmFjdGVyXG4gICAgICAgICAqIEBwYXJhbSB7QXJyYXl9IG1vZGlmaWVyc1xuICAgICAgICAgKiBAcGFyYW0ge0V2ZW50fSBlXG4gICAgICAgICAqIEByZXR1cm5zIHZvaWRcbiAgICAgICAgICovXG4gICAgICAgIHNlbGYuX2hhbmRsZUtleSA9IGZ1bmN0aW9uKGNoYXJhY3RlciwgbW9kaWZpZXJzLCBlKSB7XG4gICAgICAgICAgICB2YXIgY2FsbGJhY2tzID0gX2dldE1hdGNoZXMoY2hhcmFjdGVyLCBtb2RpZmllcnMsIGUpO1xuICAgICAgICAgICAgdmFyIGk7XG4gICAgICAgICAgICB2YXIgZG9Ob3RSZXNldCA9IHt9O1xuICAgICAgICAgICAgdmFyIG1heExldmVsID0gMDtcbiAgICAgICAgICAgIHZhciBwcm9jZXNzZWRTZXF1ZW5jZUNhbGxiYWNrID0gZmFsc2U7XG5cbiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSB0aGUgbWF4TGV2ZWwgZm9yIHNlcXVlbmNlcyBzbyB3ZSBjYW4gb25seSBleGVjdXRlIHRoZSBsb25nZXN0IGNhbGxiYWNrIHNlcXVlbmNlXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2FsbGJhY2tzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrc1tpXS5zZXEpIHtcbiAgICAgICAgICAgICAgICAgICAgbWF4TGV2ZWwgPSBNYXRoLm1heChtYXhMZXZlbCwgY2FsbGJhY2tzW2ldLmxldmVsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGxvb3AgdGhyb3VnaCBtYXRjaGluZyBjYWxsYmFja3MgZm9yIHRoaXMga2V5IGV2ZW50XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2FsbGJhY2tzLmxlbmd0aDsgKytpKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBmaXJlIGZvciBhbGwgc2VxdWVuY2UgY2FsbGJhY2tzXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBpcyBiZWNhdXNlIGlmIGZvciBleGFtcGxlIHlvdSBoYXZlIG11bHRpcGxlIHNlcXVlbmNlc1xuICAgICAgICAgICAgICAgIC8vIGJvdW5kIHN1Y2ggYXMgXCJnIGlcIiBhbmQgXCJnIHRcIiB0aGV5IGJvdGggbmVlZCB0byBmaXJlIHRoZVxuICAgICAgICAgICAgICAgIC8vIGNhbGxiYWNrIGZvciBtYXRjaGluZyBnIGNhdXNlIG90aGVyd2lzZSB5b3UgY2FuIG9ubHkgZXZlclxuICAgICAgICAgICAgICAgIC8vIG1hdGNoIHRoZSBmaXJzdCBvbmVcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2tzW2ldLnNlcSkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIG9ubHkgZmlyZSBjYWxsYmFja3MgZm9yIHRoZSBtYXhMZXZlbCB0byBwcmV2ZW50XG4gICAgICAgICAgICAgICAgICAgIC8vIHN1YnNlcXVlbmNlcyBmcm9tIGFsc28gZmlyaW5nXG4gICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgIC8vIGZvciBleGFtcGxlICdhIG9wdGlvbiBiJyBzaG91bGQgbm90IGNhdXNlICdvcHRpb24gYicgdG8gZmlyZVxuICAgICAgICAgICAgICAgICAgICAvLyBldmVuIHRob3VnaCAnb3B0aW9uIGInIGlzIHBhcnQgb2YgdGhlIG90aGVyIHNlcXVlbmNlXG4gICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgIC8vIGFueSBzZXF1ZW5jZXMgdGhhdCBkbyBub3QgbWF0Y2ggaGVyZSB3aWxsIGJlIGRpc2NhcmRlZFxuICAgICAgICAgICAgICAgICAgICAvLyBiZWxvdyBieSB0aGUgX3Jlc2V0U2VxdWVuY2VzIGNhbGxcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrc1tpXS5sZXZlbCAhPSBtYXhMZXZlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZWRTZXF1ZW5jZUNhbGxiYWNrID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBrZWVwIGEgbGlzdCBvZiB3aGljaCBzZXF1ZW5jZXMgd2VyZSBtYXRjaGVzIGZvciBsYXRlclxuICAgICAgICAgICAgICAgICAgICBkb05vdFJlc2V0W2NhbGxiYWNrc1tpXS5zZXFdID0gMTtcbiAgICAgICAgICAgICAgICAgICAgX2ZpcmVDYWxsYmFjayhjYWxsYmFja3NbaV0uY2FsbGJhY2ssIGUsIGNhbGxiYWNrc1tpXS5jb21ibywgY2FsbGJhY2tzW2ldLnNlcSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlIHdlcmUgbm8gc2VxdWVuY2UgbWF0Y2hlcyBidXQgd2UgYXJlIHN0aWxsIGhlcmVcbiAgICAgICAgICAgICAgICAvLyB0aGF0IG1lYW5zIHRoaXMgaXMgYSByZWd1bGFyIG1hdGNoIHNvIHdlIHNob3VsZCBmaXJlIHRoYXRcbiAgICAgICAgICAgICAgICBpZiAoIXByb2Nlc3NlZFNlcXVlbmNlQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgX2ZpcmVDYWxsYmFjayhjYWxsYmFja3NbaV0uY2FsbGJhY2ssIGUsIGNhbGxiYWNrc1tpXS5jb21ibyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBpZiB0aGUga2V5IHlvdSBwcmVzc2VkIG1hdGNoZXMgdGhlIHR5cGUgb2Ygc2VxdWVuY2Ugd2l0aG91dFxuICAgICAgICAgICAgLy8gYmVpbmcgYSBtb2RpZmllciAoaWUgXCJrZXl1cFwiIG9yIFwia2V5cHJlc3NcIikgdGhlbiB3ZSBzaG91bGRcbiAgICAgICAgICAgIC8vIHJlc2V0IGFsbCBzZXF1ZW5jZXMgdGhhdCB3ZXJlIG5vdCBtYXRjaGVkIGJ5IHRoaXMgZXZlbnRcbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyB0aGlzIGlzIHNvLCBmb3IgZXhhbXBsZSwgaWYgeW91IGhhdmUgdGhlIHNlcXVlbmNlIFwiaCBhIHRcIiBhbmQgeW91XG4gICAgICAgICAgICAvLyB0eXBlIFwiaCBlIGEgciB0XCIgaXQgZG9lcyBub3QgbWF0Y2guICBpbiB0aGlzIGNhc2UgdGhlIFwiZVwiIHdpbGxcbiAgICAgICAgICAgIC8vIGNhdXNlIHRoZSBzZXF1ZW5jZSB0byByZXNldFxuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIC8vIG1vZGlmaWVyIGtleXMgYXJlIGlnbm9yZWQgYmVjYXVzZSB5b3UgY2FuIGhhdmUgYSBzZXF1ZW5jZVxuICAgICAgICAgICAgLy8gdGhhdCBjb250YWlucyBtb2RpZmllcnMgc3VjaCBhcyBcImVudGVyIGN0cmwrc3BhY2VcIiBhbmQgaW4gbW9zdFxuICAgICAgICAgICAgLy8gY2FzZXMgdGhlIG1vZGlmaWVyIGtleSB3aWxsIGJlIHByZXNzZWQgYmVmb3JlIHRoZSBuZXh0IGtleVxuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIC8vIGFsc28gaWYgeW91IGhhdmUgYSBzZXF1ZW5jZSBzdWNoIGFzIFwiY3RybCtiIGFcIiB0aGVuIHByZXNzaW5nIHRoZVxuICAgICAgICAgICAgLy8gXCJiXCIga2V5IHdpbGwgdHJpZ2dlciBhIFwia2V5cHJlc3NcIiBhbmQgYSBcImtleWRvd25cIlxuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIC8vIHRoZSBcImtleWRvd25cIiBpcyBleHBlY3RlZCB3aGVuIHRoZXJlIGlzIGEgbW9kaWZpZXIsIGJ1dCB0aGVcbiAgICAgICAgICAgIC8vIFwia2V5cHJlc3NcIiBlbmRzIHVwIG1hdGNoaW5nIHRoZSBfbmV4dEV4cGVjdGVkQWN0aW9uIHNpbmNlIGl0IG9jY3Vyc1xuICAgICAgICAgICAgLy8gYWZ0ZXIgYW5kIHRoYXQgY2F1c2VzIHRoZSBzZXF1ZW5jZSB0byByZXNldFxuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIC8vIHdlIGlnbm9yZSBrZXlwcmVzc2VzIGluIGEgc2VxdWVuY2UgdGhhdCBkaXJlY3RseSBmb2xsb3cgYSBrZXlkb3duXG4gICAgICAgICAgICAvLyBmb3IgdGhlIHNhbWUgY2hhcmFjdGVyXG4gICAgICAgICAgICB2YXIgaWdub3JlVGhpc0tleXByZXNzID0gZS50eXBlID09ICdrZXlwcmVzcycgJiYgX2lnbm9yZU5leHRLZXlwcmVzcztcbiAgICAgICAgICAgIGlmIChlLnR5cGUgPT0gX25leHRFeHBlY3RlZEFjdGlvbiAmJiAhX2lzTW9kaWZpZXIoY2hhcmFjdGVyKSAmJiAhaWdub3JlVGhpc0tleXByZXNzKSB7XG4gICAgICAgICAgICAgICAgX3Jlc2V0U2VxdWVuY2VzKGRvTm90UmVzZXQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfaWdub3JlTmV4dEtleXByZXNzID0gcHJvY2Vzc2VkU2VxdWVuY2VDYWxsYmFjayAmJiBlLnR5cGUgPT0gJ2tleWRvd24nO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBoYW5kbGVzIGEga2V5ZG93biBldmVudFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0ge0V2ZW50fSBlXG4gICAgICAgICAqIEByZXR1cm5zIHZvaWRcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9oYW5kbGVLZXlFdmVudChlKSB7XG5cbiAgICAgICAgICAgIC8vIG5vcm1hbGl6ZSBlLndoaWNoIGZvciBrZXkgZXZlbnRzXG4gICAgICAgICAgICAvLyBAc2VlIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNDI4NTYyNy9qYXZhc2NyaXB0LWtleWNvZGUtdnMtY2hhcmNvZGUtdXR0ZXItY29uZnVzaW9uXG4gICAgICAgICAgICBpZiAodHlwZW9mIGUud2hpY2ggIT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgZS53aGljaCA9IGUua2V5Q29kZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGNoYXJhY3RlciA9IF9jaGFyYWN0ZXJGcm9tRXZlbnQoZSk7XG5cbiAgICAgICAgICAgIC8vIG5vIGNoYXJhY3RlciBmb3VuZCB0aGVuIHN0b3BcbiAgICAgICAgICAgIGlmICghY2hhcmFjdGVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBuZWVkIHRvIHVzZSA9PT0gZm9yIHRoZSBjaGFyYWN0ZXIgY2hlY2sgYmVjYXVzZSB0aGUgY2hhcmFjdGVyIGNhbiBiZSAwXG4gICAgICAgICAgICBpZiAoZS50eXBlID09ICdrZXl1cCcgJiYgX2lnbm9yZU5leHRLZXl1cCA9PT0gY2hhcmFjdGVyKSB7XG4gICAgICAgICAgICAgICAgX2lnbm9yZU5leHRLZXl1cCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc2VsZi5oYW5kbGVLZXkoY2hhcmFjdGVyLCBfZXZlbnRNb2RpZmllcnMoZSksIGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNhbGxlZCB0byBzZXQgYSAxIHNlY29uZCB0aW1lb3V0IG9uIHRoZSBzcGVjaWZpZWQgc2VxdWVuY2VcbiAgICAgICAgICpcbiAgICAgICAgICogdGhpcyBpcyBzbyBhZnRlciBlYWNoIGtleSBwcmVzcyBpbiB0aGUgc2VxdWVuY2UgeW91IGhhdmUgMSBzZWNvbmRcbiAgICAgICAgICogdG8gcHJlc3MgdGhlIG5leHQga2V5IGJlZm9yZSB5b3UgaGF2ZSB0byBzdGFydCBvdmVyXG4gICAgICAgICAqXG4gICAgICAgICAqIEByZXR1cm5zIHZvaWRcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9yZXNldFNlcXVlbmNlVGltZXIoKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQoX3Jlc2V0VGltZXIpO1xuICAgICAgICAgICAgX3Jlc2V0VGltZXIgPSBzZXRUaW1lb3V0KF9yZXNldFNlcXVlbmNlcywgMTAwMCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogYmluZHMgYSBrZXkgc2VxdWVuY2UgdG8gYW4gZXZlbnRcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGNvbWJvIC0gY29tYm8gc3BlY2lmaWVkIGluIGJpbmQgY2FsbFxuICAgICAgICAgKiBAcGFyYW0ge0FycmF5fSBrZXlzXG4gICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gYWN0aW9uXG4gICAgICAgICAqIEByZXR1cm5zIHZvaWRcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9iaW5kU2VxdWVuY2UoY29tYm8sIGtleXMsIGNhbGxiYWNrLCBhY3Rpb24pIHtcblxuICAgICAgICAgICAgLy8gc3RhcnQgb2ZmIGJ5IGFkZGluZyBhIHNlcXVlbmNlIGxldmVsIHJlY29yZCBmb3IgdGhpcyBjb21iaW5hdGlvblxuICAgICAgICAgICAgLy8gYW5kIHNldHRpbmcgdGhlIGxldmVsIHRvIDBcbiAgICAgICAgICAgIF9zZXF1ZW5jZUxldmVsc1tjb21ib10gPSAwO1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIGNhbGxiYWNrIHRvIGluY3JlYXNlIHRoZSBzZXF1ZW5jZSBsZXZlbCBmb3IgdGhpcyBzZXF1ZW5jZSBhbmQgcmVzZXRcbiAgICAgICAgICAgICAqIGFsbCBvdGhlciBzZXF1ZW5jZXMgdGhhdCB3ZXJlIGFjdGl2ZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuZXh0QWN0aW9uXG4gICAgICAgICAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIF9pbmNyZWFzZVNlcXVlbmNlKG5leHRBY3Rpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIF9uZXh0RXhwZWN0ZWRBY3Rpb24gPSBuZXh0QWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICArK19zZXF1ZW5jZUxldmVsc1tjb21ib107XG4gICAgICAgICAgICAgICAgICAgIF9yZXNldFNlcXVlbmNlVGltZXIoKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIHdyYXBzIHRoZSBzcGVjaWZpZWQgY2FsbGJhY2sgaW5zaWRlIG9mIGFub3RoZXIgZnVuY3Rpb24gaW4gb3JkZXJcbiAgICAgICAgICAgICAqIHRvIHJlc2V0IGFsbCBzZXF1ZW5jZSBjb3VudGVycyBhcyBzb29uIGFzIHRoaXMgc2VxdWVuY2UgaXMgZG9uZVxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBwYXJhbSB7RXZlbnR9IGVcbiAgICAgICAgICAgICAqIEByZXR1cm5zIHZvaWRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gX2NhbGxiYWNrQW5kUmVzZXQoZSkge1xuICAgICAgICAgICAgICAgIF9maXJlQ2FsbGJhY2soY2FsbGJhY2ssIGUsIGNvbWJvKTtcblxuICAgICAgICAgICAgICAgIC8vIHdlIHNob3VsZCBpZ25vcmUgdGhlIG5leHQga2V5IHVwIGlmIHRoZSBhY3Rpb24gaXMga2V5IGRvd25cbiAgICAgICAgICAgICAgICAvLyBvciBrZXlwcmVzcy4gIHRoaXMgaXMgc28gaWYgeW91IGZpbmlzaCBhIHNlcXVlbmNlIGFuZFxuICAgICAgICAgICAgICAgIC8vIHJlbGVhc2UgdGhlIGtleSB0aGUgZmluYWwga2V5IHdpbGwgbm90IHRyaWdnZXIgYSBrZXl1cFxuICAgICAgICAgICAgICAgIGlmIChhY3Rpb24gIT09ICdrZXl1cCcpIHtcbiAgICAgICAgICAgICAgICAgICAgX2lnbm9yZU5leHRLZXl1cCA9IF9jaGFyYWN0ZXJGcm9tRXZlbnQoZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gd2VpcmQgcmFjZSBjb25kaXRpb24gaWYgYSBzZXF1ZW5jZSBlbmRzIHdpdGggdGhlIGtleVxuICAgICAgICAgICAgICAgIC8vIGFub3RoZXIgc2VxdWVuY2UgYmVnaW5zIHdpdGhcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KF9yZXNldFNlcXVlbmNlcywgMTApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBsb29wIHRocm91Z2gga2V5cyBvbmUgYXQgYSB0aW1lIGFuZCBiaW5kIHRoZSBhcHByb3ByaWF0ZSBjYWxsYmFja1xuICAgICAgICAgICAgLy8gZnVuY3Rpb24uICBmb3IgYW55IGtleSBsZWFkaW5nIHVwIHRvIHRoZSBmaW5hbCBvbmUgaXQgc2hvdWxkXG4gICAgICAgICAgICAvLyBpbmNyZWFzZSB0aGUgc2VxdWVuY2UuIGFmdGVyIHRoZSBmaW5hbCwgaXQgc2hvdWxkIHJlc2V0IGFsbCBzZXF1ZW5jZXNcbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyBpZiBhbiBhY3Rpb24gaXMgc3BlY2lmaWVkIGluIHRoZSBvcmlnaW5hbCBiaW5kIGNhbGwgdGhlbiB0aGF0IHdpbGxcbiAgICAgICAgICAgIC8vIGJlIHVzZWQgdGhyb3VnaG91dC4gIG90aGVyd2lzZSB3ZSB3aWxsIHBhc3MgdGhlIGFjdGlvbiB0aGF0IHRoZVxuICAgICAgICAgICAgLy8gbmV4dCBrZXkgaW4gdGhlIHNlcXVlbmNlIHNob3VsZCBtYXRjaC4gIHRoaXMgYWxsb3dzIGEgc2VxdWVuY2VcbiAgICAgICAgICAgIC8vIHRvIG1peCBhbmQgbWF0Y2gga2V5cHJlc3MgYW5kIGtleWRvd24gZXZlbnRzIGRlcGVuZGluZyBvbiB3aGljaFxuICAgICAgICAgICAgLy8gb25lcyBhcmUgYmV0dGVyIHN1aXRlZCB0byB0aGUga2V5IHByb3ZpZGVkXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICB2YXIgaXNGaW5hbCA9IGkgKyAxID09PSBrZXlzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB2YXIgd3JhcHBlZENhbGxiYWNrID0gaXNGaW5hbCA/IF9jYWxsYmFja0FuZFJlc2V0IDogX2luY3JlYXNlU2VxdWVuY2UoYWN0aW9uIHx8IF9nZXRLZXlJbmZvKGtleXNbaSArIDFdKS5hY3Rpb24pO1xuICAgICAgICAgICAgICAgIF9iaW5kU2luZ2xlKGtleXNbaV0sIHdyYXBwZWRDYWxsYmFjaywgYWN0aW9uLCBjb21ibywgaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogYmluZHMgYSBzaW5nbGUga2V5Ym9hcmQgY29tYmluYXRpb25cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGNvbWJpbmF0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gYWN0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gc2VxdWVuY2VOYW1lIC0gbmFtZSBvZiBzZXF1ZW5jZSBpZiBwYXJ0IG9mIHNlcXVlbmNlXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyPX0gbGV2ZWwgLSB3aGF0IHBhcnQgb2YgdGhlIHNlcXVlbmNlIHRoZSBjb21tYW5kIGlzXG4gICAgICAgICAqIEByZXR1cm5zIHZvaWRcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9iaW5kU2luZ2xlKGNvbWJpbmF0aW9uLCBjYWxsYmFjaywgYWN0aW9uLCBzZXF1ZW5jZU5hbWUsIGxldmVsKSB7XG5cbiAgICAgICAgICAgIC8vIHN0b3JlIGEgZGlyZWN0IG1hcHBlZCByZWZlcmVuY2UgZm9yIHVzZSB3aXRoIE1vdXNldHJhcC50cmlnZ2VyXG4gICAgICAgICAgICBzZWxmLl9kaXJlY3RNYXBbY29tYmluYXRpb24gKyAnOicgKyBhY3Rpb25dID0gY2FsbGJhY2s7XG5cbiAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSBtdWx0aXBsZSBzcGFjZXMgaW4gYSByb3cgYmVjb21lIGEgc2luZ2xlIHNwYWNlXG4gICAgICAgICAgICBjb21iaW5hdGlvbiA9IGNvbWJpbmF0aW9uLnJlcGxhY2UoL1xccysvZywgJyAnKTtcblxuICAgICAgICAgICAgdmFyIHNlcXVlbmNlID0gY29tYmluYXRpb24uc3BsaXQoJyAnKTtcbiAgICAgICAgICAgIHZhciBpbmZvO1xuXG4gICAgICAgICAgICAvLyBpZiB0aGlzIHBhdHRlcm4gaXMgYSBzZXF1ZW5jZSBvZiBrZXlzIHRoZW4gcnVuIHRocm91Z2ggdGhpcyBtZXRob2RcbiAgICAgICAgICAgIC8vIHRvIHJlcHJvY2VzcyBlYWNoIHBhdHRlcm4gb25lIGtleSBhdCBhIHRpbWVcbiAgICAgICAgICAgIGlmIChzZXF1ZW5jZS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgX2JpbmRTZXF1ZW5jZShjb21iaW5hdGlvbiwgc2VxdWVuY2UsIGNhbGxiYWNrLCBhY3Rpb24pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaW5mbyA9IF9nZXRLZXlJbmZvKGNvbWJpbmF0aW9uLCBhY3Rpb24pO1xuXG4gICAgICAgICAgICAvLyBtYWtlIHN1cmUgdG8gaW5pdGlhbGl6ZSBhcnJheSBpZiB0aGlzIGlzIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgICAgICAvLyBhIGNhbGxiYWNrIGlzIGFkZGVkIGZvciB0aGlzIGtleVxuICAgICAgICAgICAgc2VsZi5fY2FsbGJhY2tzW2luZm8ua2V5XSA9IHNlbGYuX2NhbGxiYWNrc1tpbmZvLmtleV0gfHwgW107XG5cbiAgICAgICAgICAgIC8vIHJlbW92ZSBhbiBleGlzdGluZyBtYXRjaCBpZiB0aGVyZSBpcyBvbmVcbiAgICAgICAgICAgIF9nZXRNYXRjaGVzKGluZm8ua2V5LCBpbmZvLm1vZGlmaWVycywge3R5cGU6IGluZm8uYWN0aW9ufSwgc2VxdWVuY2VOYW1lLCBjb21iaW5hdGlvbiwgbGV2ZWwpO1xuXG4gICAgICAgICAgICAvLyBhZGQgdGhpcyBjYWxsIGJhY2sgdG8gdGhlIGFycmF5XG4gICAgICAgICAgICAvLyBpZiBpdCBpcyBhIHNlcXVlbmNlIHB1dCBpdCBhdCB0aGUgYmVnaW5uaW5nXG4gICAgICAgICAgICAvLyBpZiBub3QgcHV0IGl0IGF0IHRoZSBlbmRcbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyB0aGlzIGlzIGltcG9ydGFudCBiZWNhdXNlIHRoZSB3YXkgdGhlc2UgYXJlIHByb2Nlc3NlZCBleHBlY3RzXG4gICAgICAgICAgICAvLyB0aGUgc2VxdWVuY2Ugb25lcyB0byBjb21lIGZpcnN0XG4gICAgICAgICAgICBzZWxmLl9jYWxsYmFja3NbaW5mby5rZXldW3NlcXVlbmNlTmFtZSA/ICd1bnNoaWZ0JyA6ICdwdXNoJ10oe1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBjYWxsYmFjayxcbiAgICAgICAgICAgICAgICBtb2RpZmllcnM6IGluZm8ubW9kaWZpZXJzLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogaW5mby5hY3Rpb24sXG4gICAgICAgICAgICAgICAgc2VxOiBzZXF1ZW5jZU5hbWUsXG4gICAgICAgICAgICAgICAgbGV2ZWw6IGxldmVsLFxuICAgICAgICAgICAgICAgIGNvbWJvOiBjb21iaW5hdGlvblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogYmluZHMgbXVsdGlwbGUgY29tYmluYXRpb25zIHRvIHRoZSBzYW1lIGNhbGxiYWNrXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7QXJyYXl9IGNvbWJpbmF0aW9uc1xuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ3x1bmRlZmluZWR9IGFjdGlvblxuICAgICAgICAgKiBAcmV0dXJucyB2b2lkXG4gICAgICAgICAqL1xuICAgICAgICBzZWxmLl9iaW5kTXVsdGlwbGUgPSBmdW5jdGlvbihjb21iaW5hdGlvbnMsIGNhbGxiYWNrLCBhY3Rpb24pIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29tYmluYXRpb25zLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgX2JpbmRTaW5nbGUoY29tYmluYXRpb25zW2ldLCBjYWxsYmFjaywgYWN0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzdGFydCFcbiAgICAgICAgX2FkZEV2ZW50KHRhcmdldEVsZW1lbnQsICdrZXlwcmVzcycsIF9oYW5kbGVLZXlFdmVudCk7XG4gICAgICAgIF9hZGRFdmVudCh0YXJnZXRFbGVtZW50LCAna2V5ZG93bicsIF9oYW5kbGVLZXlFdmVudCk7XG4gICAgICAgIF9hZGRFdmVudCh0YXJnZXRFbGVtZW50LCAna2V5dXAnLCBfaGFuZGxlS2V5RXZlbnQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGJpbmRzIGFuIGV2ZW50IHRvIG1vdXNldHJhcFxuICAgICAqXG4gICAgICogY2FuIGJlIGEgc2luZ2xlIGtleSwgYSBjb21iaW5hdGlvbiBvZiBrZXlzIHNlcGFyYXRlZCB3aXRoICssXG4gICAgICogYW4gYXJyYXkgb2Yga2V5cywgb3IgYSBzZXF1ZW5jZSBvZiBrZXlzIHNlcGFyYXRlZCBieSBzcGFjZXNcbiAgICAgKlxuICAgICAqIGJlIHN1cmUgdG8gbGlzdCB0aGUgbW9kaWZpZXIga2V5cyBmaXJzdCB0byBtYWtlIHN1cmUgdGhhdCB0aGVcbiAgICAgKiBjb3JyZWN0IGtleSBlbmRzIHVwIGdldHRpbmcgYm91bmQgKHRoZSBsYXN0IGtleSBpbiB0aGUgcGF0dGVybilcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfEFycmF5fSBrZXlzXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tcbiAgICAgKiBAcGFyYW0ge3N0cmluZz19IGFjdGlvbiAtICdrZXlwcmVzcycsICdrZXlkb3duJywgb3IgJ2tleXVwJ1xuICAgICAqIEByZXR1cm5zIHZvaWRcbiAgICAgKi9cbiAgICBNb3VzZXRyYXAucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbihrZXlzLCBjYWxsYmFjaywgYWN0aW9uKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAga2V5cyA9IGtleXMgaW5zdGFuY2VvZiBBcnJheSA/IGtleXMgOiBba2V5c107XG4gICAgICAgIHNlbGYuX2JpbmRNdWx0aXBsZS5jYWxsKHNlbGYsIGtleXMsIGNhbGxiYWNrLCBhY3Rpb24pO1xuICAgICAgICByZXR1cm4gc2VsZjtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogdW5iaW5kcyBhbiBldmVudCB0byBtb3VzZXRyYXBcbiAgICAgKlxuICAgICAqIHRoZSB1bmJpbmRpbmcgc2V0cyB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gb2YgdGhlIHNwZWNpZmllZCBrZXkgY29tYm9cbiAgICAgKiB0byBhbiBlbXB0eSBmdW5jdGlvbiBhbmQgZGVsZXRlcyB0aGUgY29ycmVzcG9uZGluZyBrZXkgaW4gdGhlXG4gICAgICogX2RpcmVjdE1hcCBkaWN0LlxuICAgICAqXG4gICAgICogVE9ETzogYWN0dWFsbHkgcmVtb3ZlIHRoaXMgZnJvbSB0aGUgX2NhbGxiYWNrcyBkaWN0aW9uYXJ5IGluc3RlYWRcbiAgICAgKiBvZiBiaW5kaW5nIGFuIGVtcHR5IGZ1bmN0aW9uXG4gICAgICpcbiAgICAgKiB0aGUga2V5Y29tYm8rYWN0aW9uIGhhcyB0byBiZSBleGFjdGx5IHRoZSBzYW1lIGFzXG4gICAgICogaXQgd2FzIGRlZmluZWQgaW4gdGhlIGJpbmQgbWV0aG9kXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xBcnJheX0ga2V5c1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhY3Rpb25cbiAgICAgKiBAcmV0dXJucyB2b2lkXG4gICAgICovXG4gICAgTW91c2V0cmFwLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbihrZXlzLCBhY3Rpb24pIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICByZXR1cm4gc2VsZi5iaW5kLmNhbGwoc2VsZiwga2V5cywgZnVuY3Rpb24oKSB7fSwgYWN0aW9uKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogdHJpZ2dlcnMgYW4gZXZlbnQgdGhhdCBoYXMgYWxyZWFkeSBiZWVuIGJvdW5kXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5c1xuICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gYWN0aW9uXG4gICAgICogQHJldHVybnMgdm9pZFxuICAgICAqL1xuICAgIE1vdXNldHJhcC5wcm90b3R5cGUudHJpZ2dlciA9IGZ1bmN0aW9uKGtleXMsIGFjdGlvbikge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIGlmIChzZWxmLl9kaXJlY3RNYXBba2V5cyArICc6JyArIGFjdGlvbl0pIHtcbiAgICAgICAgICAgIHNlbGYuX2RpcmVjdE1hcFtrZXlzICsgJzonICsgYWN0aW9uXSh7fSwga2V5cyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlbGY7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIHJlc2V0cyB0aGUgbGlicmFyeSBiYWNrIHRvIGl0cyBpbml0aWFsIHN0YXRlLiAgdGhpcyBpcyB1c2VmdWxcbiAgICAgKiBpZiB5b3Ugd2FudCB0byBjbGVhciBvdXQgdGhlIGN1cnJlbnQga2V5Ym9hcmQgc2hvcnRjdXRzIGFuZCBiaW5kXG4gICAgICogbmV3IG9uZXMgLSBmb3IgZXhhbXBsZSBpZiB5b3Ugc3dpdGNoIHRvIGFub3RoZXIgcGFnZVxuICAgICAqXG4gICAgICogQHJldHVybnMgdm9pZFxuICAgICAqL1xuICAgIE1vdXNldHJhcC5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBzZWxmLl9jYWxsYmFja3MgPSB7fTtcbiAgICAgICAgc2VsZi5fZGlyZWN0TWFwID0ge307XG4gICAgICAgIHJldHVybiBzZWxmO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBzaG91bGQgd2Ugc3RvcCB0aGlzIGV2ZW50IGJlZm9yZSBmaXJpbmcgb2ZmIGNhbGxiYWNrc1xuICAgICAqXG4gICAgICogQHBhcmFtIHtFdmVudH0gZVxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudFxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICovXG4gICAgTW91c2V0cmFwLnByb3RvdHlwZS5zdG9wQ2FsbGJhY2sgPSBmdW5jdGlvbihlLCBlbGVtZW50KSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICAvLyBpZiB0aGUgZWxlbWVudCBoYXMgdGhlIGNsYXNzIFwibW91c2V0cmFwXCIgdGhlbiBubyBuZWVkIHRvIHN0b3BcbiAgICAgICAgaWYgKCgnICcgKyBlbGVtZW50LmNsYXNzTmFtZSArICcgJykuaW5kZXhPZignIG1vdXNldHJhcCAnKSA+IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoX2JlbG9uZ3NUbyhlbGVtZW50LCBzZWxmLnRhcmdldCkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHN0b3AgZm9yIGlucHV0LCBzZWxlY3QsIGFuZCB0ZXh0YXJlYVxuICAgICAgICByZXR1cm4gZWxlbWVudC50YWdOYW1lID09ICdJTlBVVCcgfHwgZWxlbWVudC50YWdOYW1lID09ICdTRUxFQ1QnIHx8IGVsZW1lbnQudGFnTmFtZSA9PSAnVEVYVEFSRUEnIHx8IGVsZW1lbnQuaXNDb250ZW50RWRpdGFibGU7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGV4cG9zZXMgX2hhbmRsZUtleSBwdWJsaWNseSBzbyBpdCBjYW4gYmUgb3ZlcndyaXR0ZW4gYnkgZXh0ZW5zaW9uc1xuICAgICAqL1xuICAgIE1vdXNldHJhcC5wcm90b3R5cGUuaGFuZGxlS2V5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHNlbGYuX2hhbmRsZUtleS5hcHBseShzZWxmLCBhcmd1bWVudHMpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBhbGxvdyBjdXN0b20ga2V5IG1hcHBpbmdzXG4gICAgICovXG4gICAgTW91c2V0cmFwLmFkZEtleWNvZGVzID0gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBvYmplY3QpIHtcbiAgICAgICAgICAgIGlmIChvYmplY3QuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgIF9NQVBba2V5XSA9IG9iamVjdFtrZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIF9SRVZFUlNFX01BUCA9IG51bGw7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEluaXQgdGhlIGdsb2JhbCBtb3VzZXRyYXAgZnVuY3Rpb25zXG4gICAgICpcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBuZWVkZWQgdG8gYWxsb3cgdGhlIGdsb2JhbCBtb3VzZXRyYXAgZnVuY3Rpb25zIHRvIHdvcmtcbiAgICAgKiBub3cgdGhhdCBtb3VzZXRyYXAgaXMgYSBjb25zdHJ1Y3RvciBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBNb3VzZXRyYXAuaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZG9jdW1lbnRNb3VzZXRyYXAgPSBNb3VzZXRyYXAoZG9jdW1lbnQpO1xuICAgICAgICBmb3IgKHZhciBtZXRob2QgaW4gZG9jdW1lbnRNb3VzZXRyYXApIHtcbiAgICAgICAgICAgIGlmIChtZXRob2QuY2hhckF0KDApICE9PSAnXycpIHtcbiAgICAgICAgICAgICAgICBNb3VzZXRyYXBbbWV0aG9kXSA9IChmdW5jdGlvbihtZXRob2QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50TW91c2V0cmFwW21ldGhvZF0uYXBwbHkoZG9jdW1lbnRNb3VzZXRyYXAsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSAobWV0aG9kKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgTW91c2V0cmFwLmluaXQoKTtcblxuICAgIC8vIGV4cG9zZSBtb3VzZXRyYXAgdG8gdGhlIGdsb2JhbCBvYmplY3RcbiAgICB3aW5kb3cuTW91c2V0cmFwID0gTW91c2V0cmFwO1xuXG4gICAgLy8gZXhwb3NlIGFzIGEgY29tbW9uIGpzIG1vZHVsZVxuICAgIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IE1vdXNldHJhcDtcbiAgICB9XG5cbiAgICAvLyBleHBvc2UgbW91c2V0cmFwIGFzIGFuIEFNRCBtb2R1bGVcbiAgICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIGRlZmluZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBNb3VzZXRyYXA7XG4gICAgICAgIH0pO1xuICAgIH1cbn0pICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IG51bGwsIHR5cGVvZiAgd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IGRvY3VtZW50IDogbnVsbCk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9tb3VzZXRyYXAvbW91c2V0cmFwLmpzXG4gKiogbW9kdWxlIGlkID0gMTVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsImV4cG9ydCBjbGFzcyBCYXNlVmlld1ZNIHtcbiAgZW50aXR5ID0ge307XG5cbiAgY29uc3RydWN0b3Ioc2FpbHMsIHJvdXRlciwgZXZlbnRBZ2dyZWdhdG9yLCBjb25maWcpIHtcbiAgICB0aGlzLnNhaWxzID0gc2FpbHM7XG4gICAgdGhpcy5yb3V0ZXIgPSByb3V0ZXI7XG4gICAgdGhpcy5iYXNlQ3RybFVybCA9IGNvbmZpZy5iYXNlQ3RybFVybDtcbiAgICB0aGlzLmVhID0gZXZlbnRBZ2dyZWdhdG9yO1xuICB9XG5cbiAgc3VibWl0KCkge1xuICAgIHRoaXMuc2FpbHMucHV0KGAke3RoaXMuYmFzZUN0cmxVcmx9JHt0aGlzLmVudGl0eS5pZH1gLCB0aGlzLmVudGl0eSlcbiAgICAgIC50aGVuKGRhdGEgPT4gdGhpcy5yb3V0ZXIubmF2aWdhdGUoJycpKTtcbiAgfVxuXG4gIGRlbGV0ZUVudGl0eSgpIHtcbiAgICBpZiAoY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIHJlbW92ZT8nKSkge1xuICAgICAgdGhpcy5zYWlscy5kZWxldGUoYCR7dGhpcy5iYXNlQ3RybFVybH0ke3RoaXMuZW50aXR5LmlkfWApXG4gICAgICAgIC50aGVuKGRhdGEgPT4gdGhpcy5yb3V0ZXIubmF2aWdhdGUoJycpKTtcbiAgICB9XG4gIH1cbiAgYXR0YWNoZWQoKXtcbiAgICB0aGlzLmVhLnB1Ymxpc2goJ0luRWRpdE1vZGUnLHRydWUpO1xuICB9XG4gIGRldGFjaGVkKCl7XG4gICAgdGhpcy5lYS5wdWJsaXNoKCdJbkVkaXRNb2RlJyxmYWxzZSk7XG4gIH1cbiAgYWN0aXZhdGUocGFyYW1zKSB7XG4gICAgcmV0dXJuIHRoaXMuc2FpbHMuZ2V0KGAke3RoaXMuYmFzZUN0cmxVcmx9JHt0aGlzLmdldElkUGFyYW0ocGFyYW1zKX1gKS50aGVuKChyZXMpID0+IHtcbiAgICAgIHRoaXMuZW50aXR5ID0gcmVzLmJvZHk7XG4gICAgfSkuY2F0Y2goKHJlcykgPT4ge1xuICAgICAgY29uc29sZS5sb2cocmVzKTtcbiAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKCcnKVxuICAgIH0pO1xuICB9XG5cbiAgZ2V0SWRQYXJhbShwYXJhbXMpe1xuICAgIHJldHVybiBwYXJhbXMuaWQgIFxuICB9XG4gIFxufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvQmFzZUNydWRPcGVyYXRpb25zL0Jhc2VWaWV3Vk0uanNcbiAqKi8iLCJpbXBvcnQgJ21vdXNldHJhcCc7XG5pbXBvcnQge2luamVjdH0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuaW1wb3J0IHsgRXZlbnRBZ2dyZWdhdG9yIH0gZnJvbSAnYXVyZWxpYS1ldmVudC1hZ2dyZWdhdG9yJztcbmltcG9ydCB7U2FpbHNTb2NrZXRDbGllbnR9IGZyb20gJ2F1cmVsaWEtc2FpbHMtc29ja2V0LWNsaWVudCc7XG5cbkBpbmplY3QoRXZlbnRBZ2dyZWdhdG9yLCBTYWlsc1NvY2tldENsaWVudClcbmV4cG9ydCBjbGFzcyBBcHAge1xuICBjb25maWd1cmVSb3V0ZXIoY29uZmlnLCByb3V0ZXIpIHtcbiAgICBjb25maWcudGl0bGUgPSAnaVEnO1xuICAgIGNvbmZpZy5tYXAoW1xuICAgICAgeyByb3V0ZTogWycnLCAnd2VsY29tZSddLCAgICAgbmFtZTogJ3dlbGNvbWUnLCAgICAgICAgICBtb2R1bGVJZDogJ2hvbWUvd2VsY29tZScsICAgICAgICAgICAgICAgICBuYXY6IHRydWUsIHRpdGxlOiAnV2VsY29tZScgLCAgICAgICAgICAgICAgICBzZXR0aW5nczp7aWNvbjonaG9tZSd9fSxcbiAgICAgIHsgcm91dGU6ICd0ZXN0JywgICAgICAgICAgICAgIG5hbWU6ICd0ZXN0JywgICAgICAgICAgICAgbW9kdWxlSWQ6ICd0ZXN0L3dlbGNvbWUnLCAgICAgICAgICAgICAgICAgbmF2OiB0cnVlLCB0aXRsZTogJ0NvbXBvbmVudHMgUGxheWdyb3VuZCcgLCAgc2V0dGluZ3M6e2ljb246J2NvZGUnfX0sXG4gICAgICB7IHJvdXRlOiAnUXVlc3Rpb25DYXRlZ29yaWVzJyxuYW1lOiAncXVlc3Rpb25DYXRlZ29yeScsIG1vZHVsZUlkOiAncXVlc3Rpb25DYXRlZ29yeS9jaGlsZC1yb3V0ZXInLG5hdjogdHJ1ZSwgdGl0bGU6ICdRdWVzdGlvbiBDYXRlZ29yaWVzJywgICAgIHNldHRpbmdzOntpY29uOid0YWcnIH19LFxuICAgICAgeyByb3V0ZTogJ1F1ZXN0aW9uVHlwZXMnLCAgICAgbmFtZTogJ3F1ZXN0aW9uVHlwZScsICAgICBtb2R1bGVJZDogJ3F1ZXN0aW9uVHlwZS9jaGlsZC1yb3V0ZXInLCAgICBuYXY6IHRydWUsIHRpdGxlOiAnUXVlc3Rpb24gVHlwZXMnLCAgICAgICAgICBzZXR0aW5nczp7aWNvbjonZGlhbW9uZCd9fSxcbiAgICAgIHsgcm91dGU6ICdRdWVzdGlvbktpbmRzJywgICAgIG5hbWU6ICdxdWVzdGlvbktpbmQnLCAgICAgbW9kdWxlSWQ6ICdxdWVzdGlvbktpbmQvY2hpbGQtcm91dGVyJywgICAgbmF2OiB0cnVlLCB0aXRsZTogJ1F1ZXN0aW9uIEtpbmRzJywgICAgICAgICAgc2V0dGluZ3M6e2ljb246J2FzdGVyaXNrJ319LFxuICAgICAgeyByb3V0ZTogJ1F1ZXN0aW9ucycsICAgICAgICAgbmFtZTogJ3F1ZXN0aW9uJywgICAgICAgICBtb2R1bGVJZDogJ3F1ZXN0aW9uL2NoaWxkLXJvdXRlcicsICAgICAgICBuYXY6IHRydWUsIHRpdGxlOiAnUXVlc3Rpb25zJywgICAgICAgICAgICAgICBzZXR0aW5nczp7aWNvbjonbGlzdCd9fSxcbiAgICAgIHsgcm91dGU6ICdVc2VycycsICAgICAgICAgICAgIG5hbWU6ICd1c2VyJywgICAgICAgICAgICAgbW9kdWxlSWQ6ICd1c2Vycy9jaGlsZC1yb3V0ZXInLCAgICAgICAgICAgbmF2OiB0cnVlLCB0aXRsZTogJ1VzZXJzJywgICAgICAgICAgICAgICAgICAgc2V0dGluZ3M6e2ljb246J3VzZXJzJ319LFxuICAgICAgeyByb3V0ZTogJ2xvZ2luJywgICAgICAgICAgICAgbmFtZTogJ2xvZ2luJywgICAgICAgICAgICBtb2R1bGVJZDogJ2F1dGgvaW5kZXgnLCAgICAgICAgICAgICAgICAgICBuYXY6IGZhbHNlLHRpdGxlOiAnTG9naW4nIH1cbiAgICBdKTtcblxuICAgIHRoaXMucm91dGVyID0gcm91dGVyO1xuICAgIE1vdXNldHJhcC5iaW5kKCd3JywgICBmdW5jdGlvbigpIHsgd2luZG93LmxvY2F0aW9uID0gXCIjXCI7IH0pO1xuICAgIE1vdXNldHJhcC5iaW5kKCdxIHQnLCBmdW5jdGlvbigpIHsgd2luZG93LmxvY2F0aW9uID0gXCIjUXVlc3Rpb25UeXBlc1wiOyB9KTtcbiAgICBNb3VzZXRyYXAuYmluZCgncSBuJywgZnVuY3Rpb24oKSB7IHdpbmRvdy5sb2NhdGlvbiA9IFwiI1F1ZXN0aW9uc1wiOyB9KTtcbiAgICBNb3VzZXRyYXAuYmluZCgncSBjJywgZnVuY3Rpb24oKSB7IHdpbmRvdy5sb2NhdGlvbiA9IFwiI1F1ZXN0aW9uQ2F0ZWdvcmllc1wiOyB9KTtcbiAgICBNb3VzZXRyYXAuYmluZCgncSBrJywgZnVuY3Rpb24oKSB7IHdpbmRvdy5sb2NhdGlvbiA9IFwiI1F1ZXN0aW9uS2luZHNcIjsgfSk7XG5cbiAgfVxuICBjb25zdHJ1Y3RvcihldmVudEFnZ3JlZ2F0b3IsIHNhaWxzKSB7XG4gICAgdGhpcy5lYSA9IGV2ZW50QWdncmVnYXRvcjtcbiAgICB0aGlzLnNhaWxzID0gc2FpbHM7XG4gIH1cblxuICBsb2dvdXQoKXtcbiAgICB0aGlzLnNhaWxzLmdldCgnL2xvZ291dCcpLnRoZW4oICgpPT4ge1xuICAgICAgdGhpcy51c2VyID1udWxsO1xuICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoJy9sb2dpbicpO1xuICAgIH0pLmNhdGNoKChyZXMpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgfSk7XG4gIH1cblxuICBhdHRhY2hlZCgpe1xuICAgICQoXCJhLnNpZGViYXItdG9nZ2xlXCIpLm9uKCdjbGljaycsZnVuY3Rpb24oKSB7XG4gICAgICAkKCcudWkuc2lkZWJhcicpLnNpZGViYXIoJ3RvZ2dsZScpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5zYWlscy5nZXQoJy9xdWVzdGlvbnMvY3VycmVudFVzZXInKS50aGVuKChyZXMpID0+IHtcbiAgICAgIHRoaXMudXNlciA9IHJlcy5ib2R5LnVzZXI7XG4gICAgfSkuY2F0Y2goKHJlcykgPT4ge1xuICAgICAgaWYocmVzLnN0YXR1c0NvZGU9PT00MDMpe1xuICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShcIi9sb2dpblwiKVxuICAgICAgfWVsc2V7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLnN1YnNjcmliZXIgPSB0aGlzLmVhLnN1YnNjcmliZSgndWVyQXV0aGVudGljYXRlZCcsIHJlc3BvbnNlID0+IHtcbiAgICAgIHRoaXMudXNlciA9IHJlc3BvbnNlO1xuICAgIH0pO1xuICB9XG5cbiAgZGV0YWNoZWQoKSB7XG4gICAgdGhpcy5zdWJzY3JpYmVyLmRpc3Bvc2UoKTtcbiAgfVxufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvYXBwLmpzXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5Mb2dNYW5hZ2VyID0gZXhwb3J0cy5GcmFtZXdvcmtDb25maWd1cmF0aW9uID0gZXhwb3J0cy5BdXJlbGlhID0gdW5kZWZpbmVkO1xuXG52YXIgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uID0gcmVxdWlyZSgnYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbicpO1xuXG5PYmplY3Qua2V5cyhfYXVyZWxpYURlcGVuZGVuY3lJbmplY3Rpb24pLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICBpZiAoa2V5ID09PSBcImRlZmF1bHRcIiB8fCBrZXkgPT09IFwiX19lc01vZHVsZVwiKSByZXR1cm47XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIF9hdXJlbGlhRGVwZW5kZW5jeUluamVjdGlvbltrZXldO1xuICAgIH1cbiAgfSk7XG59KTtcblxudmFyIF9hdXJlbGlhQmluZGluZyA9IHJlcXVpcmUoJ2F1cmVsaWEtYmluZGluZycpO1xuXG5PYmplY3Qua2V5cyhfYXVyZWxpYUJpbmRpbmcpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICBpZiAoa2V5ID09PSBcImRlZmF1bHRcIiB8fCBrZXkgPT09IFwiX19lc01vZHVsZVwiKSByZXR1cm47XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIF9hdXJlbGlhQmluZGluZ1trZXldO1xuICAgIH1cbiAgfSk7XG59KTtcblxudmFyIF9hdXJlbGlhTWV0YWRhdGEgPSByZXF1aXJlKCdhdXJlbGlhLW1ldGFkYXRhJyk7XG5cbk9iamVjdC5rZXlzKF9hdXJlbGlhTWV0YWRhdGEpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICBpZiAoa2V5ID09PSBcImRlZmF1bHRcIiB8fCBrZXkgPT09IFwiX19lc01vZHVsZVwiKSByZXR1cm47XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIF9hdXJlbGlhTWV0YWRhdGFba2V5XTtcbiAgICB9XG4gIH0pO1xufSk7XG5cbnZhciBfYXVyZWxpYVRlbXBsYXRpbmcgPSByZXF1aXJlKCdhdXJlbGlhLXRlbXBsYXRpbmcnKTtcblxuT2JqZWN0LmtleXMoX2F1cmVsaWFUZW1wbGF0aW5nKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgaWYgKGtleSA9PT0gXCJkZWZhdWx0XCIgfHwga2V5ID09PSBcIl9fZXNNb2R1bGVcIikgcmV0dXJuO1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiBfYXVyZWxpYVRlbXBsYXRpbmdba2V5XTtcbiAgICB9XG4gIH0pO1xufSk7XG5cbnZhciBfYXVyZWxpYUxvYWRlciA9IHJlcXVpcmUoJ2F1cmVsaWEtbG9hZGVyJyk7XG5cbk9iamVjdC5rZXlzKF9hdXJlbGlhTG9hZGVyKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgaWYgKGtleSA9PT0gXCJkZWZhdWx0XCIgfHwga2V5ID09PSBcIl9fZXNNb2R1bGVcIikgcmV0dXJuO1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiBfYXVyZWxpYUxvYWRlcltrZXldO1xuICAgIH1cbiAgfSk7XG59KTtcblxudmFyIF9hdXJlbGlhVGFza1F1ZXVlID0gcmVxdWlyZSgnYXVyZWxpYS10YXNrLXF1ZXVlJyk7XG5cbk9iamVjdC5rZXlzKF9hdXJlbGlhVGFza1F1ZXVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgaWYgKGtleSA9PT0gXCJkZWZhdWx0XCIgfHwga2V5ID09PSBcIl9fZXNNb2R1bGVcIikgcmV0dXJuO1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiBfYXVyZWxpYVRhc2tRdWV1ZVtrZXldO1xuICAgIH1cbiAgfSk7XG59KTtcblxudmFyIF9hdXJlbGlhUGF0aCA9IHJlcXVpcmUoJ2F1cmVsaWEtcGF0aCcpO1xuXG5PYmplY3Qua2V5cyhfYXVyZWxpYVBhdGgpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICBpZiAoa2V5ID09PSBcImRlZmF1bHRcIiB8fCBrZXkgPT09IFwiX19lc01vZHVsZVwiKSByZXR1cm47XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIF9hdXJlbGlhUGF0aFtrZXldO1xuICAgIH1cbiAgfSk7XG59KTtcblxudmFyIF9hdXJlbGlhUGFsID0gcmVxdWlyZSgnYXVyZWxpYS1wYWwnKTtcblxuT2JqZWN0LmtleXMoX2F1cmVsaWFQYWwpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICBpZiAoa2V5ID09PSBcImRlZmF1bHRcIiB8fCBrZXkgPT09IFwiX19lc01vZHVsZVwiKSByZXR1cm47XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIF9hdXJlbGlhUGFsW2tleV07XG4gICAgfVxuICB9KTtcbn0pO1xuXG52YXIgX2F1cmVsaWFMb2dnaW5nID0gcmVxdWlyZSgnYXVyZWxpYS1sb2dnaW5nJyk7XG5cbnZhciBUaGVMb2dNYW5hZ2VyID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX2F1cmVsaWFMb2dnaW5nKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09iai5kZWZhdWx0ID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gcHJldmVudEFjdGlvbmxlc3NGb3JtU3VibWl0KCkge1xuICBfYXVyZWxpYVBhbC5ET00uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGV2dCkge1xuICAgIHZhciB0YXJnZXQgPSBldnQudGFyZ2V0O1xuICAgIHZhciBhY3Rpb24gPSB0YXJnZXQuYWN0aW9uO1xuXG4gICAgaWYgKHRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdmb3JtJyAmJiAhYWN0aW9uKSB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH0pO1xufVxuXG52YXIgQXVyZWxpYSA9IGV4cG9ydHMuQXVyZWxpYSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQXVyZWxpYShsb2FkZXIsIGNvbnRhaW5lciwgcmVzb3VyY2VzKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEF1cmVsaWEpO1xuXG4gICAgdGhpcy5sb2FkZXIgPSBsb2FkZXIgfHwgbmV3IF9hdXJlbGlhUGFsLlBMQVRGT1JNLkxvYWRlcigpO1xuICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyIHx8IG5ldyBfYXVyZWxpYURlcGVuZGVuY3lJbmplY3Rpb24uQ29udGFpbmVyKCkubWFrZUdsb2JhbCgpO1xuICAgIHRoaXMucmVzb3VyY2VzID0gcmVzb3VyY2VzIHx8IG5ldyBfYXVyZWxpYVRlbXBsYXRpbmcuVmlld1Jlc291cmNlcygpO1xuICAgIHRoaXMudXNlID0gbmV3IEZyYW1ld29ya0NvbmZpZ3VyYXRpb24odGhpcyk7XG4gICAgdGhpcy5sb2dnZXIgPSBUaGVMb2dNYW5hZ2VyLmdldExvZ2dlcignYXVyZWxpYScpO1xuICAgIHRoaXMuaG9zdENvbmZpZ3VyZWQgPSBmYWxzZTtcbiAgICB0aGlzLmhvc3QgPSBudWxsO1xuXG4gICAgdGhpcy51c2UuaW5zdGFuY2UoQXVyZWxpYSwgdGhpcyk7XG4gICAgdGhpcy51c2UuaW5zdGFuY2UoX2F1cmVsaWFMb2FkZXIuTG9hZGVyLCB0aGlzLmxvYWRlcik7XG4gICAgdGhpcy51c2UuaW5zdGFuY2UoX2F1cmVsaWFUZW1wbGF0aW5nLlZpZXdSZXNvdXJjZXMsIHRoaXMucmVzb3VyY2VzKTtcbiAgfVxuXG4gIEF1cmVsaWEucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcyk7XG4gICAgfVxuXG4gICAgdGhpcy5zdGFydGVkID0gdHJ1ZTtcbiAgICB0aGlzLmxvZ2dlci5pbmZvKCdBdXJlbGlhIFN0YXJ0aW5nJyk7XG5cbiAgICByZXR1cm4gdGhpcy51c2UuYXBwbHkoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgIHByZXZlbnRBY3Rpb25sZXNzRm9ybVN1Ym1pdCgpO1xuXG4gICAgICBpZiAoIV90aGlzLmNvbnRhaW5lci5oYXNSZXNvbHZlcihfYXVyZWxpYVRlbXBsYXRpbmcuQmluZGluZ0xhbmd1YWdlKSkge1xuICAgICAgICB2YXIgbWVzc2FnZSA9ICdZb3UgbXVzdCBjb25maWd1cmUgQXVyZWxpYSB3aXRoIGEgQmluZGluZ0xhbmd1YWdlIGltcGxlbWVudGF0aW9uLic7XG4gICAgICAgIF90aGlzLmxvZ2dlci5lcnJvcihtZXNzYWdlKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKG1lc3NhZ2UpO1xuICAgICAgfVxuXG4gICAgICBfdGhpcy5sb2dnZXIuaW5mbygnQXVyZWxpYSBTdGFydGVkJyk7XG4gICAgICB2YXIgZXZ0ID0gX2F1cmVsaWFQYWwuRE9NLmNyZWF0ZUN1c3RvbUV2ZW50KCdhdXJlbGlhLXN0YXJ0ZWQnLCB7IGJ1YmJsZXM6IHRydWUsIGNhbmNlbGFibGU6IHRydWUgfSk7XG4gICAgICBfYXVyZWxpYVBhbC5ET00uZGlzcGF0Y2hFdmVudChldnQpO1xuICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH0pO1xuICB9O1xuXG4gIEF1cmVsaWEucHJvdG90eXBlLmVuaGFuY2UgPSBmdW5jdGlvbiBlbmhhbmNlKCkge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgdmFyIGJpbmRpbmdDb250ZXh0ID0gYXJndW1lbnRzLmxlbmd0aCA8PSAwIHx8IGFyZ3VtZW50c1swXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMF07XG4gICAgdmFyIGFwcGxpY2F0aW9uSG9zdCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IG51bGwgOiBhcmd1bWVudHNbMV07XG5cbiAgICB0aGlzLl9jb25maWd1cmVIb3N0KGFwcGxpY2F0aW9uSG9zdCB8fCBfYXVyZWxpYVBhbC5ET00ucXVlcnlTZWxlY3RvckFsbCgnYm9keScpWzBdKTtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgdmFyIGVuZ2luZSA9IF90aGlzMi5jb250YWluZXIuZ2V0KF9hdXJlbGlhVGVtcGxhdGluZy5UZW1wbGF0aW5nRW5naW5lKTtcbiAgICAgIF90aGlzMi5yb290ID0gZW5naW5lLmVuaGFuY2UoeyBjb250YWluZXI6IF90aGlzMi5jb250YWluZXIsIGVsZW1lbnQ6IF90aGlzMi5ob3N0LCByZXNvdXJjZXM6IF90aGlzMi5yZXNvdXJjZXMsIGJpbmRpbmdDb250ZXh0OiBiaW5kaW5nQ29udGV4dCB9KTtcbiAgICAgIF90aGlzMi5yb290LmF0dGFjaGVkKCk7XG4gICAgICBfdGhpczIuX29uQXVyZWxpYUNvbXBvc2VkKCk7XG4gICAgICByZXR1cm4gX3RoaXMyO1xuICAgIH0pO1xuICB9O1xuXG4gIEF1cmVsaWEucHJvdG90eXBlLnNldFJvb3QgPSBmdW5jdGlvbiBzZXRSb290KCkge1xuICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgdmFyIHJvb3QgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyAnYXBwJyA6IGFyZ3VtZW50c1swXTtcbiAgICB2YXIgYXBwbGljYXRpb25Ib3N0ID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IGFyZ3VtZW50c1sxXTtcblxuICAgIHZhciBpbnN0cnVjdGlvbiA9IHt9O1xuXG4gICAgaWYgKHRoaXMucm9vdCAmJiB0aGlzLnJvb3Qudmlld01vZGVsICYmIHRoaXMucm9vdC52aWV3TW9kZWwucm91dGVyKSB7XG4gICAgICB0aGlzLnJvb3Qudmlld01vZGVsLnJvdXRlci5kZWFjdGl2YXRlKCk7XG4gICAgICB0aGlzLnJvb3Qudmlld01vZGVsLnJvdXRlci5yZXNldCgpO1xuICAgIH1cblxuICAgIHRoaXMuX2NvbmZpZ3VyZUhvc3QoYXBwbGljYXRpb25Ib3N0KTtcblxuICAgIHZhciBlbmdpbmUgPSB0aGlzLmNvbnRhaW5lci5nZXQoX2F1cmVsaWFUZW1wbGF0aW5nLlRlbXBsYXRpbmdFbmdpbmUpO1xuICAgIHZhciB0cmFuc2FjdGlvbiA9IHRoaXMuY29udGFpbmVyLmdldChfYXVyZWxpYVRlbXBsYXRpbmcuQ29tcG9zaXRpb25UcmFuc2FjdGlvbik7XG4gICAgZGVsZXRlIHRyYW5zYWN0aW9uLmluaXRpYWxDb21wb3NpdGlvbjtcblxuICAgIGluc3RydWN0aW9uLnZpZXdNb2RlbCA9IHJvb3Q7XG4gICAgaW5zdHJ1Y3Rpb24uY29udGFpbmVyID0gaW5zdHJ1Y3Rpb24uY2hpbGRDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcjtcbiAgICBpbnN0cnVjdGlvbi52aWV3U2xvdCA9IHRoaXMuaG9zdFNsb3Q7XG4gICAgaW5zdHJ1Y3Rpb24uaG9zdCA9IHRoaXMuaG9zdDtcblxuICAgIHJldHVybiBlbmdpbmUuY29tcG9zZShpbnN0cnVjdGlvbikudGhlbihmdW5jdGlvbiAocikge1xuICAgICAgX3RoaXMzLnJvb3QgPSByO1xuICAgICAgaW5zdHJ1Y3Rpb24udmlld1Nsb3QuYXR0YWNoZWQoKTtcbiAgICAgIF90aGlzMy5fb25BdXJlbGlhQ29tcG9zZWQoKTtcbiAgICAgIHJldHVybiBfdGhpczM7XG4gICAgfSk7XG4gIH07XG5cbiAgQXVyZWxpYS5wcm90b3R5cGUuX2NvbmZpZ3VyZUhvc3QgPSBmdW5jdGlvbiBfY29uZmlndXJlSG9zdChhcHBsaWNhdGlvbkhvc3QpIHtcbiAgICBpZiAodGhpcy5ob3N0Q29uZmlndXJlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhcHBsaWNhdGlvbkhvc3QgPSBhcHBsaWNhdGlvbkhvc3QgfHwgdGhpcy5ob3N0O1xuXG4gICAgaWYgKCFhcHBsaWNhdGlvbkhvc3QgfHwgdHlwZW9mIGFwcGxpY2F0aW9uSG9zdCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRoaXMuaG9zdCA9IF9hdXJlbGlhUGFsLkRPTS5nZXRFbGVtZW50QnlJZChhcHBsaWNhdGlvbkhvc3QgfHwgJ2FwcGxpY2F0aW9uSG9zdCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmhvc3QgPSBhcHBsaWNhdGlvbkhvc3Q7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmhvc3QpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYXBwbGljYXRpb25Ib3N0IHdhcyBzcGVjaWZpZWQuJyk7XG4gICAgfVxuXG4gICAgdGhpcy5ob3N0Q29uZmlndXJlZCA9IHRydWU7XG4gICAgdGhpcy5ob3N0LmF1cmVsaWEgPSB0aGlzO1xuICAgIHRoaXMuaG9zdFNsb3QgPSBuZXcgX2F1cmVsaWFUZW1wbGF0aW5nLlZpZXdTbG90KHRoaXMuaG9zdCwgdHJ1ZSk7XG4gICAgdGhpcy5ob3N0U2xvdC50cmFuc2Zvcm1DaGlsZE5vZGVzSW50b1ZpZXcoKTtcbiAgICB0aGlzLmNvbnRhaW5lci5yZWdpc3Rlckluc3RhbmNlKF9hdXJlbGlhUGFsLkRPTS5ib3VuZGFyeSwgdGhpcy5ob3N0KTtcbiAgfTtcblxuICBBdXJlbGlhLnByb3RvdHlwZS5fb25BdXJlbGlhQ29tcG9zZWQgPSBmdW5jdGlvbiBfb25BdXJlbGlhQ29tcG9zZWQoKSB7XG4gICAgdmFyIGV2dCA9IF9hdXJlbGlhUGFsLkRPTS5jcmVhdGVDdXN0b21FdmVudCgnYXVyZWxpYS1jb21wb3NlZCcsIHsgYnViYmxlczogdHJ1ZSwgY2FuY2VsYWJsZTogdHJ1ZSB9KTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBfYXVyZWxpYVBhbC5ET00uZGlzcGF0Y2hFdmVudChldnQpO1xuICAgIH0sIDEpO1xuICB9O1xuXG4gIHJldHVybiBBdXJlbGlhO1xufSgpO1xuXG52YXIgbG9nZ2VyID0gVGhlTG9nTWFuYWdlci5nZXRMb2dnZXIoJ2F1cmVsaWEnKTtcbnZhciBleHRQYXR0ZXJuID0gL1xcLlteLy5dKyQvO1xuXG5mdW5jdGlvbiBydW5UYXNrcyhjb25maWcsIHRhc2tzKSB7XG4gIHZhciBjdXJyZW50ID0gdm9pZCAwO1xuICB2YXIgbmV4dCA9IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgaWYgKGN1cnJlbnQgPSB0YXNrcy5zaGlmdCgpKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGN1cnJlbnQoY29uZmlnKSkudGhlbihuZXh0KTtcbiAgICB9XG5cbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gIH07XG5cbiAgcmV0dXJuIG5leHQoKTtcbn1cblxuZnVuY3Rpb24gbG9hZFBsdWdpbihjb25maWcsIGxvYWRlciwgaW5mbykge1xuICBsb2dnZXIuZGVidWcoJ0xvYWRpbmcgcGx1Z2luICcgKyBpbmZvLm1vZHVsZUlkICsgJy4nKTtcbiAgY29uZmlnLnJlc291cmNlc1JlbGF0aXZlVG8gPSBpbmZvLnJlc291cmNlc1JlbGF0aXZlVG87XG5cbiAgdmFyIGlkID0gaW5mby5tb2R1bGVJZDtcblxuICBpZiAoaW5mby5yZXNvdXJjZXNSZWxhdGl2ZVRvLmxlbmd0aCA+IDEpIHtcbiAgICByZXR1cm4gbG9hZGVyLm5vcm1hbGl6ZShpbmZvLm1vZHVsZUlkLCBpbmZvLnJlc291cmNlc1JlbGF0aXZlVG9bMV0pLnRoZW4oZnVuY3Rpb24gKG5vcm1hbGl6ZWRJZCkge1xuICAgICAgcmV0dXJuIF9sb2FkUGx1Z2luKG5vcm1hbGl6ZWRJZCk7XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gX2xvYWRQbHVnaW4oaWQpO1xuXG4gIGZ1bmN0aW9uIF9sb2FkUGx1Z2luKG1vZHVsZUlkKSB7XG4gICAgcmV0dXJuIGxvYWRlci5sb2FkTW9kdWxlKG1vZHVsZUlkKS50aGVuKGZ1bmN0aW9uIChtKSB7XG4gICAgICBpZiAoJ2NvbmZpZ3VyZScgaW4gbSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG0uY29uZmlndXJlKGNvbmZpZywgaW5mby5jb25maWcgfHwge30pKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjb25maWcucmVzb3VyY2VzUmVsYXRpdmVUbyA9IG51bGw7XG4gICAgICAgICAgbG9nZ2VyLmRlYnVnKCdDb25maWd1cmVkIHBsdWdpbiAnICsgaW5mby5tb2R1bGVJZCArICcuJyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25maWcucmVzb3VyY2VzUmVsYXRpdmVUbyA9IG51bGw7XG4gICAgICBsb2dnZXIuZGVidWcoJ0xvYWRlZCBwbHVnaW4gJyArIGluZm8ubW9kdWxlSWQgKyAnLicpO1xuICAgIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIGxvYWRSZXNvdXJjZXMoYXVyZWxpYSwgcmVzb3VyY2VzVG9Mb2FkLCBhcHBSZXNvdXJjZXMpIHtcbiAgdmFyIHZpZXdFbmdpbmUgPSBhdXJlbGlhLmNvbnRhaW5lci5nZXQoX2F1cmVsaWFUZW1wbGF0aW5nLlZpZXdFbmdpbmUpO1xuXG4gIHJldHVybiBQcm9taXNlLmFsbChPYmplY3Qua2V5cyhyZXNvdXJjZXNUb0xvYWQpLm1hcChmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBfbm9ybWFsaXplKHJlc291cmNlc1RvTG9hZFtuXSk7XG4gIH0pKS50aGVuKGZ1bmN0aW9uIChsb2Fkcykge1xuICAgIHZhciBuYW1lcyA9IFtdO1xuICAgIHZhciBpbXBvcnRJZHMgPSBbXTtcblxuICAgIGxvYWRzLmZvckVhY2goZnVuY3Rpb24gKGwpIHtcbiAgICAgIG5hbWVzLnB1c2godW5kZWZpbmVkKTtcbiAgICAgIGltcG9ydElkcy5wdXNoKGwuaW1wb3J0SWQpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHZpZXdFbmdpbmUuaW1wb3J0Vmlld1Jlc291cmNlcyhpbXBvcnRJZHMsIG5hbWVzLCBhcHBSZXNvdXJjZXMpO1xuICB9KTtcblxuICBmdW5jdGlvbiBfbm9ybWFsaXplKGxvYWQpIHtcbiAgICB2YXIgbW9kdWxlSWQgPSBsb2FkLm1vZHVsZUlkO1xuICAgIHZhciBleHQgPSBnZXRFeHQobW9kdWxlSWQpO1xuXG4gICAgaWYgKGlzT3RoZXJSZXNvdXJjZShtb2R1bGVJZCkpIHtcbiAgICAgIG1vZHVsZUlkID0gcmVtb3ZlRXh0KG1vZHVsZUlkKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYXVyZWxpYS5sb2FkZXIubm9ybWFsaXplKG1vZHVsZUlkLCBsb2FkLnJlbGF0aXZlVG8pLnRoZW4oZnVuY3Rpb24gKG5vcm1hbGl6ZWQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6IGxvYWQubW9kdWxlSWQsXG4gICAgICAgIGltcG9ydElkOiBpc090aGVyUmVzb3VyY2UobG9hZC5tb2R1bGVJZCkgPyBhZGRPcmlnaW5hbEV4dChub3JtYWxpemVkLCBleHQpIDogbm9ybWFsaXplZFxuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzT3RoZXJSZXNvdXJjZShuYW1lKSB7XG4gICAgdmFyIGV4dCA9IGdldEV4dChuYW1lKTtcbiAgICBpZiAoIWV4dCkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChleHQgPT09ICcnKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKGV4dCA9PT0gJy5qcycgfHwgZXh0ID09PSAnLnRzJykgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlRXh0KG5hbWUpIHtcbiAgICByZXR1cm4gbmFtZS5yZXBsYWNlKGV4dFBhdHRlcm4sICcnKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFkZE9yaWdpbmFsRXh0KG5vcm1hbGl6ZWQsIGV4dCkge1xuICAgIHJldHVybiByZW1vdmVFeHQobm9ybWFsaXplZCkgKyAnLicgKyBleHQ7XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0RXh0KG5hbWUpIHtcbiAgdmFyIG1hdGNoID0gbmFtZS5tYXRjaChleHRQYXR0ZXJuKTtcbiAgaWYgKG1hdGNoICYmIG1hdGNoLmxlbmd0aCA+IDApIHtcbiAgICByZXR1cm4gbWF0Y2hbMF0uc3BsaXQoJy4nKVsxXTtcbiAgfVxufVxuXG5mdW5jdGlvbiBhc3NlcnRQcm9jZXNzZWQocGx1Z2lucykge1xuICBpZiAocGx1Z2lucy5wcm9jZXNzZWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgY29uZmlnIGluc3RhbmNlIGhhcyBhbHJlYWR5IGJlZW4gYXBwbGllZC4gVG8gbG9hZCBtb3JlIHBsdWdpbnMgb3IgZ2xvYmFsIHJlc291cmNlcywgY3JlYXRlIGEgbmV3IEZyYW1ld29ya0NvbmZpZ3VyYXRpb24gaW5zdGFuY2UuJyk7XG4gIH1cbn1cblxudmFyIEZyYW1ld29ya0NvbmZpZ3VyYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEZyYW1ld29ya0NvbmZpZ3VyYXRpb24oYXVyZWxpYSkge1xuICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZyYW1ld29ya0NvbmZpZ3VyYXRpb24pO1xuXG4gICAgdGhpcy5hdXJlbGlhID0gYXVyZWxpYTtcbiAgICB0aGlzLmNvbnRhaW5lciA9IGF1cmVsaWEuY29udGFpbmVyO1xuICAgIHRoaXMuaW5mbyA9IFtdO1xuICAgIHRoaXMucHJvY2Vzc2VkID0gZmFsc2U7XG4gICAgdGhpcy5wcmVUYXNrcyA9IFtdO1xuICAgIHRoaXMucG9zdFRhc2tzID0gW107XG4gICAgdGhpcy5yZXNvdXJjZXNUb0xvYWQgPSB7fTtcbiAgICB0aGlzLnByZVRhc2soZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGF1cmVsaWEubG9hZGVyLm5vcm1hbGl6ZSgnYXVyZWxpYS1ib290c3RyYXBwZXInKS50aGVuKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiBfdGhpczQuYm9vdHN0cmFwcGVyTmFtZSA9IG5hbWU7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICB0aGlzLnBvc3RUYXNrKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBsb2FkUmVzb3VyY2VzKGF1cmVsaWEsIF90aGlzNC5yZXNvdXJjZXNUb0xvYWQsIGF1cmVsaWEucmVzb3VyY2VzKTtcbiAgICB9KTtcbiAgfVxuXG4gIEZyYW1ld29ya0NvbmZpZ3VyYXRpb24ucHJvdG90eXBlLmluc3RhbmNlID0gZnVuY3Rpb24gaW5zdGFuY2UodHlwZSwgX2luc3RhbmNlKSB7XG4gICAgdGhpcy5jb250YWluZXIucmVnaXN0ZXJJbnN0YW5jZSh0eXBlLCBfaW5zdGFuY2UpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIEZyYW1ld29ya0NvbmZpZ3VyYXRpb24ucHJvdG90eXBlLnNpbmdsZXRvbiA9IGZ1bmN0aW9uIHNpbmdsZXRvbih0eXBlLCBpbXBsZW1lbnRhdGlvbikge1xuICAgIHRoaXMuY29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uKHR5cGUsIGltcGxlbWVudGF0aW9uKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBGcmFtZXdvcmtDb25maWd1cmF0aW9uLnByb3RvdHlwZS50cmFuc2llbnQgPSBmdW5jdGlvbiB0cmFuc2llbnQodHlwZSwgaW1wbGVtZW50YXRpb24pIHtcbiAgICB0aGlzLmNvbnRhaW5lci5yZWdpc3RlclRyYW5zaWVudCh0eXBlLCBpbXBsZW1lbnRhdGlvbik7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgRnJhbWV3b3JrQ29uZmlndXJhdGlvbi5wcm90b3R5cGUucHJlVGFzayA9IGZ1bmN0aW9uIHByZVRhc2sodGFzaykge1xuICAgIGFzc2VydFByb2Nlc3NlZCh0aGlzKTtcbiAgICB0aGlzLnByZVRhc2tzLnB1c2godGFzayk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgRnJhbWV3b3JrQ29uZmlndXJhdGlvbi5wcm90b3R5cGUucG9zdFRhc2sgPSBmdW5jdGlvbiBwb3N0VGFzayh0YXNrKSB7XG4gICAgYXNzZXJ0UHJvY2Vzc2VkKHRoaXMpO1xuICAgIHRoaXMucG9zdFRhc2tzLnB1c2godGFzayk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgRnJhbWV3b3JrQ29uZmlndXJhdGlvbi5wcm90b3R5cGUuZmVhdHVyZSA9IGZ1bmN0aW9uIGZlYXR1cmUocGx1Z2luLCBjb25maWcpIHtcbiAgICBpZiAoZ2V0RXh0KHBsdWdpbikpIHtcbiAgICAgIHJldHVybiB0aGlzLnBsdWdpbih7IG1vZHVsZUlkOiBwbHVnaW4sIHJlc291cmNlc1JlbGF0aXZlVG86IFtwbHVnaW4sICcnXSwgY29uZmlnOiBjb25maWcgfHwge30gfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucGx1Z2luKHsgbW9kdWxlSWQ6IHBsdWdpbiArICcvaW5kZXgnLCByZXNvdXJjZXNSZWxhdGl2ZVRvOiBbcGx1Z2luLCAnJ10sIGNvbmZpZzogY29uZmlnIHx8IHt9IH0pO1xuICB9O1xuXG4gIEZyYW1ld29ya0NvbmZpZ3VyYXRpb24ucHJvdG90eXBlLmdsb2JhbFJlc291cmNlcyA9IGZ1bmN0aW9uIGdsb2JhbFJlc291cmNlcyhyZXNvdXJjZXMpIHtcbiAgICBhc3NlcnRQcm9jZXNzZWQodGhpcyk7XG5cbiAgICB2YXIgdG9BZGQgPSBBcnJheS5pc0FycmF5KHJlc291cmNlcykgPyByZXNvdXJjZXMgOiBhcmd1bWVudHM7XG4gICAgdmFyIHJlc291cmNlID0gdm9pZCAwO1xuICAgIHZhciBwYXRoID0gdm9pZCAwO1xuICAgIHZhciByZXNvdXJjZXNSZWxhdGl2ZVRvID0gdGhpcy5yZXNvdXJjZXNSZWxhdGl2ZVRvIHx8IFsnJywgJyddO1xuXG4gICAgZm9yICh2YXIgaSA9IDAsIGlpID0gdG9BZGQubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgcmVzb3VyY2UgPSB0b0FkZFtpXTtcbiAgICAgIGlmICh0eXBlb2YgcmVzb3VyY2UgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCByZXNvdXJjZSBwYXRoIFsnICsgcmVzb3VyY2UgKyAnXS4gUmVzb3VyY2VzIG11c3QgYmUgc3BlY2lmaWVkIGFzIHJlbGF0aXZlIG1vZHVsZSBJRHMuJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciBwYXJlbnQgPSByZXNvdXJjZXNSZWxhdGl2ZVRvWzBdO1xuICAgICAgdmFyIGdyYW5kUGFyZW50ID0gcmVzb3VyY2VzUmVsYXRpdmVUb1sxXTtcbiAgICAgIHZhciBuYW1lID0gcmVzb3VyY2U7XG5cbiAgICAgIGlmIChyZXNvdXJjZS5zdGFydHNXaXRoKCcuLycpICYmIHBhcmVudCAhPT0gJycpIHtcbiAgICAgICAgbmFtZSA9IHBhcmVudCArIHJlc291cmNlLnN1YnN0cigxKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5yZXNvdXJjZXNUb0xvYWRbbmFtZV0gPSB7IG1vZHVsZUlkOiBuYW1lLCByZWxhdGl2ZVRvOiBncmFuZFBhcmVudCB9O1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIEZyYW1ld29ya0NvbmZpZ3VyYXRpb24ucHJvdG90eXBlLmdsb2JhbE5hbWUgPSBmdW5jdGlvbiBnbG9iYWxOYW1lKHJlc291cmNlUGF0aCwgbmV3TmFtZSkge1xuICAgIGFzc2VydFByb2Nlc3NlZCh0aGlzKTtcbiAgICB0aGlzLnJlc291cmNlc1RvTG9hZFtyZXNvdXJjZVBhdGhdID0geyBtb2R1bGVJZDogbmV3TmFtZSwgcmVsYXRpdmVUbzogJycgfTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBGcmFtZXdvcmtDb25maWd1cmF0aW9uLnByb3RvdHlwZS5wbHVnaW4gPSBmdW5jdGlvbiBwbHVnaW4oX3BsdWdpbiwgY29uZmlnKSB7XG4gICAgYXNzZXJ0UHJvY2Vzc2VkKHRoaXMpO1xuXG4gICAgaWYgKHR5cGVvZiBfcGx1Z2luID09PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIHRoaXMucGx1Z2luKHsgbW9kdWxlSWQ6IF9wbHVnaW4sIHJlc291cmNlc1JlbGF0aXZlVG86IFtfcGx1Z2luLCAnJ10sIGNvbmZpZzogY29uZmlnIHx8IHt9IH0pO1xuICAgIH1cblxuICAgIHRoaXMuaW5mby5wdXNoKF9wbHVnaW4pO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIEZyYW1ld29ya0NvbmZpZ3VyYXRpb24ucHJvdG90eXBlLl9hZGROb3JtYWxpemVkUGx1Z2luID0gZnVuY3Rpb24gX2FkZE5vcm1hbGl6ZWRQbHVnaW4obmFtZSwgY29uZmlnKSB7XG4gICAgdmFyIF90aGlzNSA9IHRoaXM7XG5cbiAgICB2YXIgcGx1Z2luID0geyBtb2R1bGVJZDogbmFtZSwgcmVzb3VyY2VzUmVsYXRpdmVUbzogW25hbWUsICcnXSwgY29uZmlnOiBjb25maWcgfHwge30gfTtcbiAgICB0aGlzLnBsdWdpbihwbHVnaW4pO1xuXG4gICAgdGhpcy5wcmVUYXNrKGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciByZWxhdGl2ZVRvID0gW25hbWUsIF90aGlzNS5ib290c3RyYXBwZXJOYW1lXTtcbiAgICAgIHBsdWdpbi5tb2R1bGVJZCA9IG5hbWU7XG4gICAgICBwbHVnaW4ucmVzb3VyY2VzUmVsYXRpdmVUbyA9IHJlbGF0aXZlVG87XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBGcmFtZXdvcmtDb25maWd1cmF0aW9uLnByb3RvdHlwZS5kZWZhdWx0QmluZGluZ0xhbmd1YWdlID0gZnVuY3Rpb24gZGVmYXVsdEJpbmRpbmdMYW5ndWFnZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fYWRkTm9ybWFsaXplZFBsdWdpbignYXVyZWxpYS10ZW1wbGF0aW5nLWJpbmRpbmcnKTtcbiAgfTtcblxuICBGcmFtZXdvcmtDb25maWd1cmF0aW9uLnByb3RvdHlwZS5yb3V0ZXIgPSBmdW5jdGlvbiByb3V0ZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2FkZE5vcm1hbGl6ZWRQbHVnaW4oJ2F1cmVsaWEtdGVtcGxhdGluZy1yb3V0ZXInKTtcbiAgfTtcblxuICBGcmFtZXdvcmtDb25maWd1cmF0aW9uLnByb3RvdHlwZS5oaXN0b3J5ID0gZnVuY3Rpb24gaGlzdG9yeSgpIHtcbiAgICByZXR1cm4gdGhpcy5fYWRkTm9ybWFsaXplZFBsdWdpbignYXVyZWxpYS1oaXN0b3J5LWJyb3dzZXInKTtcbiAgfTtcblxuICBGcmFtZXdvcmtDb25maWd1cmF0aW9uLnByb3RvdHlwZS5kZWZhdWx0UmVzb3VyY2VzID0gZnVuY3Rpb24gZGVmYXVsdFJlc291cmNlcygpIHtcbiAgICByZXR1cm4gdGhpcy5fYWRkTm9ybWFsaXplZFBsdWdpbignYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcycpO1xuICB9O1xuXG4gIEZyYW1ld29ya0NvbmZpZ3VyYXRpb24ucHJvdG90eXBlLmV2ZW50QWdncmVnYXRvciA9IGZ1bmN0aW9uIGV2ZW50QWdncmVnYXRvcigpIHtcbiAgICByZXR1cm4gdGhpcy5fYWRkTm9ybWFsaXplZFBsdWdpbignYXVyZWxpYS1ldmVudC1hZ2dyZWdhdG9yJyk7XG4gIH07XG5cbiAgRnJhbWV3b3JrQ29uZmlndXJhdGlvbi5wcm90b3R5cGUuc3RhbmRhcmRDb25maWd1cmF0aW9uID0gZnVuY3Rpb24gc3RhbmRhcmRDb25maWd1cmF0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmRlZmF1bHRCaW5kaW5nTGFuZ3VhZ2UoKS5kZWZhdWx0UmVzb3VyY2VzKCkuaGlzdG9yeSgpLnJvdXRlcigpLmV2ZW50QWdncmVnYXRvcigpO1xuICB9O1xuXG4gIEZyYW1ld29ya0NvbmZpZ3VyYXRpb24ucHJvdG90eXBlLmRldmVsb3BtZW50TG9nZ2luZyA9IGZ1bmN0aW9uIGRldmVsb3BtZW50TG9nZ2luZygpIHtcbiAgICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICAgIHRoaXMucHJlVGFzayhmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gX3RoaXM2LmF1cmVsaWEubG9hZGVyLm5vcm1hbGl6ZSgnYXVyZWxpYS1sb2dnaW5nLWNvbnNvbGUnLCBfdGhpczYuYm9vdHN0cmFwcGVyTmFtZSkudGhlbihmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gX3RoaXM2LmF1cmVsaWEubG9hZGVyLmxvYWRNb2R1bGUobmFtZSkudGhlbihmdW5jdGlvbiAobSkge1xuICAgICAgICAgIFRoZUxvZ01hbmFnZXIuYWRkQXBwZW5kZXIobmV3IG0uQ29uc29sZUFwcGVuZGVyKCkpO1xuICAgICAgICAgIFRoZUxvZ01hbmFnZXIuc2V0TGV2ZWwoVGhlTG9nTWFuYWdlci5sb2dMZXZlbC5kZWJ1Zyk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBGcmFtZXdvcmtDb25maWd1cmF0aW9uLnByb3RvdHlwZS5hcHBseSA9IGZ1bmN0aW9uIGFwcGx5KCkge1xuICAgIHZhciBfdGhpczcgPSB0aGlzO1xuXG4gICAgaWYgKHRoaXMucHJvY2Vzc2VkKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJ1blRhc2tzKHRoaXMsIHRoaXMucHJlVGFza3MpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGxvYWRlciA9IF90aGlzNy5hdXJlbGlhLmxvYWRlcjtcbiAgICAgIHZhciBpbmZvID0gX3RoaXM3LmluZm87XG4gICAgICB2YXIgY3VycmVudCA9IHZvaWQgMDtcblxuICAgICAgdmFyIG5leHQgPSBmdW5jdGlvbiBuZXh0KCkge1xuICAgICAgICBpZiAoY3VycmVudCA9IGluZm8uc2hpZnQoKSkge1xuICAgICAgICAgIHJldHVybiBsb2FkUGx1Z2luKF90aGlzNywgbG9hZGVyLCBjdXJyZW50KS50aGVuKG5leHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgX3RoaXM3LnByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiBuZXh0KCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBydW5UYXNrcyhfdGhpczcsIF90aGlzNy5wb3N0VGFza3MpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIEZyYW1ld29ya0NvbmZpZ3VyYXRpb247XG59KCk7XG5cbmV4cG9ydHMuRnJhbWV3b3JrQ29uZmlndXJhdGlvbiA9IEZyYW1ld29ya0NvbmZpZ3VyYXRpb247XG52YXIgTG9nTWFuYWdlciA9IGV4cG9ydHMuTG9nTWFuYWdlciA9IFRoZUxvZ01hbmFnZXI7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLWZyYW1ld29yay9kaXN0L2NvbW1vbmpzL2F1cmVsaWEtZnJhbWV3b3JrLmpzXG4gKiogbW9kdWxlIGlkID0gMThcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuQ29udGFpbmVyID0gZXhwb3J0cy5JbnZvY2F0aW9uSGFuZGxlciA9IGV4cG9ydHMuX2VtcHR5UGFyYW1ldGVycyA9IGV4cG9ydHMuU2luZ2xldG9uUmVnaXN0cmF0aW9uID0gZXhwb3J0cy5UcmFuc2llbnRSZWdpc3RyYXRpb24gPSBleHBvcnRzLkZhY3RvcnlJbnZva2VyID0gZXhwb3J0cy5GYWN0b3J5ID0gZXhwb3J0cy5TdHJhdGVneVJlc29sdmVyID0gZXhwb3J0cy5QYXJlbnQgPSBleHBvcnRzLk9wdGlvbmFsID0gZXhwb3J0cy5BbGwgPSBleHBvcnRzLkxhenkgPSBleHBvcnRzLnJlc29sdmVyID0gdW5kZWZpbmVkO1xuXG52YXIgX2RlYywgX2NsYXNzLCBfZGVjMiwgX2NsYXNzMiwgX2RlYzMsIF9jbGFzczMsIF9kZWM0LCBfY2xhc3M0LCBfZGVjNSwgX2NsYXNzNSwgX2RlYzYsIF9jbGFzczYsIF9jbGFzc0ludm9rZXJzO1xuXG5leHBvcnRzLmludm9rZXIgPSBpbnZva2VyO1xuZXhwb3J0cy5mYWN0b3J5ID0gZmFjdG9yeTtcbmV4cG9ydHMucmVnaXN0cmF0aW9uID0gcmVnaXN0cmF0aW9uO1xuZXhwb3J0cy50cmFuc2llbnQgPSB0cmFuc2llbnQ7XG5leHBvcnRzLnNpbmdsZXRvbiA9IHNpbmdsZXRvbjtcbmV4cG9ydHMuYXV0b2luamVjdCA9IGF1dG9pbmplY3Q7XG5leHBvcnRzLmluamVjdCA9IGluamVjdDtcblxudmFyIF9hdXJlbGlhTWV0YWRhdGEgPSByZXF1aXJlKCdhdXJlbGlhLW1ldGFkYXRhJyk7XG5cbnZhciBfYXVyZWxpYVBhbCA9IHJlcXVpcmUoJ2F1cmVsaWEtcGFsJyk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciByZXNvbHZlciA9IGV4cG9ydHMucmVzb2x2ZXIgPSBfYXVyZWxpYU1ldGFkYXRhLnByb3RvY29sLmNyZWF0ZSgnYXVyZWxpYTpyZXNvbHZlcicsIGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgaWYgKCEodHlwZW9mIHRhcmdldC5nZXQgPT09ICdmdW5jdGlvbicpKSB7XG4gICAgcmV0dXJuICdSZXNvbHZlcnMgbXVzdCBpbXBsZW1lbnQ6IGdldChjb250YWluZXI6IENvbnRhaW5lciwga2V5OiBhbnkpOiBhbnknO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59KTtcblxudmFyIExhenkgPSBleHBvcnRzLkxhenkgPSAoX2RlYyA9IHJlc29sdmVyKCksIF9kZWMoX2NsYXNzID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBMYXp5KGtleSkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMYXp5KTtcblxuICAgIHRoaXMuX2tleSA9IGtleTtcbiAgfVxuXG4gIExhenkucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIGdldChjb250YWluZXIpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBjb250YWluZXIuZ2V0KF90aGlzLl9rZXkpO1xuICAgIH07XG4gIH07XG5cbiAgTGF6eS5vZiA9IGZ1bmN0aW9uIG9mKGtleSkge1xuICAgIHJldHVybiBuZXcgTGF6eShrZXkpO1xuICB9O1xuXG4gIHJldHVybiBMYXp5O1xufSgpKSB8fCBfY2xhc3MpO1xudmFyIEFsbCA9IGV4cG9ydHMuQWxsID0gKF9kZWMyID0gcmVzb2x2ZXIoKSwgX2RlYzIoX2NsYXNzMiA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQWxsKGtleSkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBbGwpO1xuXG4gICAgdGhpcy5fa2V5ID0ga2V5O1xuICB9XG5cbiAgQWxsLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiBnZXQoY29udGFpbmVyKSB7XG4gICAgcmV0dXJuIGNvbnRhaW5lci5nZXRBbGwodGhpcy5fa2V5KTtcbiAgfTtcblxuICBBbGwub2YgPSBmdW5jdGlvbiBvZihrZXkpIHtcbiAgICByZXR1cm4gbmV3IEFsbChrZXkpO1xuICB9O1xuXG4gIHJldHVybiBBbGw7XG59KCkpIHx8IF9jbGFzczIpO1xudmFyIE9wdGlvbmFsID0gZXhwb3J0cy5PcHRpb25hbCA9IChfZGVjMyA9IHJlc29sdmVyKCksIF9kZWMzKF9jbGFzczMgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIE9wdGlvbmFsKGtleSkge1xuICAgIHZhciBjaGVja1BhcmVudCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzFdO1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE9wdGlvbmFsKTtcblxuICAgIHRoaXMuX2tleSA9IGtleTtcbiAgICB0aGlzLl9jaGVja1BhcmVudCA9IGNoZWNrUGFyZW50O1xuICB9XG5cbiAgT3B0aW9uYWwucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIGdldChjb250YWluZXIpIHtcbiAgICBpZiAoY29udGFpbmVyLmhhc1Jlc29sdmVyKHRoaXMuX2tleSwgdGhpcy5fY2hlY2tQYXJlbnQpKSB7XG4gICAgICByZXR1cm4gY29udGFpbmVyLmdldCh0aGlzLl9rZXkpO1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIE9wdGlvbmFsLm9mID0gZnVuY3Rpb24gb2Yoa2V5KSB7XG4gICAgdmFyIGNoZWNrUGFyZW50ID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gZmFsc2UgOiBhcmd1bWVudHNbMV07XG5cbiAgICByZXR1cm4gbmV3IE9wdGlvbmFsKGtleSwgY2hlY2tQYXJlbnQpO1xuICB9O1xuXG4gIHJldHVybiBPcHRpb25hbDtcbn0oKSkgfHwgX2NsYXNzMyk7XG52YXIgUGFyZW50ID0gZXhwb3J0cy5QYXJlbnQgPSAoX2RlYzQgPSByZXNvbHZlcigpLCBfZGVjNChfY2xhc3M0ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBQYXJlbnQoa2V5KSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBhcmVudCk7XG5cbiAgICB0aGlzLl9rZXkgPSBrZXk7XG4gIH1cblxuICBQYXJlbnQucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIGdldChjb250YWluZXIpIHtcbiAgICByZXR1cm4gY29udGFpbmVyLnBhcmVudCA/IGNvbnRhaW5lci5wYXJlbnQuZ2V0KHRoaXMuX2tleSkgOiBudWxsO1xuICB9O1xuXG4gIFBhcmVudC5vZiA9IGZ1bmN0aW9uIG9mKGtleSkge1xuICAgIHJldHVybiBuZXcgUGFyZW50KGtleSk7XG4gIH07XG5cbiAgcmV0dXJuIFBhcmVudDtcbn0oKSkgfHwgX2NsYXNzNCk7XG52YXIgU3RyYXRlZ3lSZXNvbHZlciA9IGV4cG9ydHMuU3RyYXRlZ3lSZXNvbHZlciA9IChfZGVjNSA9IHJlc29sdmVyKCksIF9kZWM1KF9jbGFzczUgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFN0cmF0ZWd5UmVzb2x2ZXIoc3RyYXRlZ3ksIHN0YXRlKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN0cmF0ZWd5UmVzb2x2ZXIpO1xuXG4gICAgdGhpcy5zdHJhdGVneSA9IHN0cmF0ZWd5O1xuICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcbiAgfVxuXG4gIFN0cmF0ZWd5UmVzb2x2ZXIucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIGdldChjb250YWluZXIsIGtleSkge1xuICAgIHN3aXRjaCAodGhpcy5zdHJhdGVneSkge1xuICAgICAgY2FzZSAwOlxuICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZTtcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgdmFyIHNpbmdsZXRvbiA9IGNvbnRhaW5lci5pbnZva2UodGhpcy5zdGF0ZSk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBzaW5nbGV0b247XG4gICAgICAgIHRoaXMuc3RyYXRlZ3kgPSAwO1xuICAgICAgICByZXR1cm4gc2luZ2xldG9uO1xuICAgICAgY2FzZSAyOlxuICAgICAgICByZXR1cm4gY29udGFpbmVyLmludm9rZSh0aGlzLnN0YXRlKTtcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhdGUoY29udGFpbmVyLCBrZXksIHRoaXMpO1xuICAgICAgY2FzZSA0OlxuICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZVswXS5nZXQoY29udGFpbmVyLCBrZXkpO1xuICAgICAgY2FzZSA1OlxuICAgICAgICByZXR1cm4gY29udGFpbmVyLmdldCh0aGlzLnN0YXRlKTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBzdHJhdGVneTogJyArIHRoaXMuc3RyYXRlZ3kpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gU3RyYXRlZ3lSZXNvbHZlcjtcbn0oKSkgfHwgX2NsYXNzNSk7XG52YXIgRmFjdG9yeSA9IGV4cG9ydHMuRmFjdG9yeSA9IChfZGVjNiA9IHJlc29sdmVyKCksIF9kZWM2KF9jbGFzczYgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEZhY3Rvcnkoa2V5KSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZhY3RvcnkpO1xuXG4gICAgdGhpcy5fa2V5ID0ga2V5O1xuICB9XG5cbiAgRmFjdG9yeS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gZ2V0KGNvbnRhaW5lcikge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCByZXN0ID0gQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICAgIHJlc3RbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjb250YWluZXIuaW52b2tlKF90aGlzMi5fa2V5LCByZXN0KTtcbiAgICB9O1xuICB9O1xuXG4gIEZhY3Rvcnkub2YgPSBmdW5jdGlvbiBvZihrZXkpIHtcbiAgICByZXR1cm4gbmV3IEZhY3Rvcnkoa2V5KTtcbiAgfTtcblxuICByZXR1cm4gRmFjdG9yeTtcbn0oKSkgfHwgX2NsYXNzNik7XG5mdW5jdGlvbiBpbnZva2VyKHZhbHVlKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5kZWZpbmUoX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5pbnZva2VyLCB2YWx1ZSwgdGFyZ2V0KTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gZmFjdG9yeShwb3RlbnRpYWxUYXJnZXQpIHtcbiAgdmFyIGRlY28gPSBmdW5jdGlvbiBkZWNvKHRhcmdldCkge1xuICAgIF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEuZGVmaW5lKF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEuaW52b2tlciwgRmFjdG9yeUludm9rZXIuaW5zdGFuY2UsIHRhcmdldCk7XG4gIH07XG5cbiAgcmV0dXJuIHBvdGVudGlhbFRhcmdldCA/IGRlY28ocG90ZW50aWFsVGFyZ2V0KSA6IGRlY287XG59XG5cbnZhciBGYWN0b3J5SW52b2tlciA9IGV4cG9ydHMuRmFjdG9yeUludm9rZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEZhY3RvcnlJbnZva2VyKCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGYWN0b3J5SW52b2tlcik7XG4gIH1cblxuICBGYWN0b3J5SW52b2tlci5wcm90b3R5cGUuaW52b2tlID0gZnVuY3Rpb24gaW52b2tlKGNvbnRhaW5lciwgZm4sIGRlcGVuZGVuY2llcykge1xuICAgIHZhciBpID0gZGVwZW5kZW5jaWVzLmxlbmd0aDtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShpKTtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIGFyZ3NbaV0gPSBjb250YWluZXIuZ2V0KGRlcGVuZGVuY2llc1tpXSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZuLmFwcGx5KHVuZGVmaW5lZCwgYXJncyk7XG4gIH07XG5cbiAgRmFjdG9yeUludm9rZXIucHJvdG90eXBlLmludm9rZVdpdGhEeW5hbWljRGVwZW5kZW5jaWVzID0gZnVuY3Rpb24gaW52b2tlV2l0aER5bmFtaWNEZXBlbmRlbmNpZXMoY29udGFpbmVyLCBmbiwgc3RhdGljRGVwZW5kZW5jaWVzLCBkeW5hbWljRGVwZW5kZW5jaWVzKSB7XG4gICAgdmFyIGkgPSBzdGF0aWNEZXBlbmRlbmNpZXMubGVuZ3RoO1xuICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGkpO1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgYXJnc1tpXSA9IGNvbnRhaW5lci5nZXQoc3RhdGljRGVwZW5kZW5jaWVzW2ldKTtcbiAgICB9XG5cbiAgICBpZiAoZHluYW1pY0RlcGVuZGVuY2llcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBhcmdzID0gYXJncy5jb25jYXQoZHluYW1pY0RlcGVuZGVuY2llcyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZuLmFwcGx5KHVuZGVmaW5lZCwgYXJncyk7XG4gIH07XG5cbiAgcmV0dXJuIEZhY3RvcnlJbnZva2VyO1xufSgpO1xuXG5GYWN0b3J5SW52b2tlci5pbnN0YW5jZSA9IG5ldyBGYWN0b3J5SW52b2tlcigpO1xuXG5mdW5jdGlvbiByZWdpc3RyYXRpb24odmFsdWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICBfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLmRlZmluZShfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLnJlZ2lzdHJhdGlvbiwgdmFsdWUsIHRhcmdldCk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHRyYW5zaWVudChrZXkpIHtcbiAgcmV0dXJuIHJlZ2lzdHJhdGlvbihuZXcgVHJhbnNpZW50UmVnaXN0cmF0aW9uKGtleSkpO1xufVxuXG5mdW5jdGlvbiBzaW5nbGV0b24oa2V5T3JSZWdpc3RlckluQ2hpbGQpIHtcbiAgdmFyIHJlZ2lzdGVySW5DaGlsZCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzFdO1xuXG4gIHJldHVybiByZWdpc3RyYXRpb24obmV3IFNpbmdsZXRvblJlZ2lzdHJhdGlvbihrZXlPclJlZ2lzdGVySW5DaGlsZCwgcmVnaXN0ZXJJbkNoaWxkKSk7XG59XG5cbnZhciBUcmFuc2llbnRSZWdpc3RyYXRpb24gPSBleHBvcnRzLlRyYW5zaWVudFJlZ2lzdHJhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gVHJhbnNpZW50UmVnaXN0cmF0aW9uKGtleSkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUcmFuc2llbnRSZWdpc3RyYXRpb24pO1xuXG4gICAgdGhpcy5fa2V5ID0ga2V5O1xuICB9XG5cbiAgVHJhbnNpZW50UmVnaXN0cmF0aW9uLnByb3RvdHlwZS5yZWdpc3RlclJlc29sdmVyID0gZnVuY3Rpb24gcmVnaXN0ZXJSZXNvbHZlcihjb250YWluZXIsIGtleSwgZm4pIHtcbiAgICB2YXIgcmVzb2x2ZXIgPSBuZXcgU3RyYXRlZ3lSZXNvbHZlcigyLCBmbik7XG4gICAgY29udGFpbmVyLnJlZ2lzdGVyUmVzb2x2ZXIodGhpcy5fa2V5IHx8IGtleSwgcmVzb2x2ZXIpO1xuICAgIHJldHVybiByZXNvbHZlcjtcbiAgfTtcblxuICByZXR1cm4gVHJhbnNpZW50UmVnaXN0cmF0aW9uO1xufSgpO1xuXG52YXIgU2luZ2xldG9uUmVnaXN0cmF0aW9uID0gZXhwb3J0cy5TaW5nbGV0b25SZWdpc3RyYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFNpbmdsZXRvblJlZ2lzdHJhdGlvbihrZXlPclJlZ2lzdGVySW5DaGlsZCkge1xuICAgIHZhciByZWdpc3RlckluQ2hpbGQgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IGFyZ3VtZW50c1sxXTtcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTaW5nbGV0b25SZWdpc3RyYXRpb24pO1xuXG4gICAgaWYgKHR5cGVvZiBrZXlPclJlZ2lzdGVySW5DaGlsZCA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICB0aGlzLl9yZWdpc3RlckluQ2hpbGQgPSBrZXlPclJlZ2lzdGVySW5DaGlsZDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fa2V5ID0ga2V5T3JSZWdpc3RlckluQ2hpbGQ7XG4gICAgICB0aGlzLl9yZWdpc3RlckluQ2hpbGQgPSByZWdpc3RlckluQ2hpbGQ7XG4gICAgfVxuICB9XG5cbiAgU2luZ2xldG9uUmVnaXN0cmF0aW9uLnByb3RvdHlwZS5yZWdpc3RlclJlc29sdmVyID0gZnVuY3Rpb24gcmVnaXN0ZXJSZXNvbHZlcihjb250YWluZXIsIGtleSwgZm4pIHtcbiAgICB2YXIgcmVzb2x2ZXIgPSBuZXcgU3RyYXRlZ3lSZXNvbHZlcigxLCBmbik7XG5cbiAgICBpZiAodGhpcy5fcmVnaXN0ZXJJbkNoaWxkKSB7XG4gICAgICBjb250YWluZXIucmVnaXN0ZXJSZXNvbHZlcih0aGlzLl9rZXkgfHwga2V5LCByZXNvbHZlcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnRhaW5lci5yb290LnJlZ2lzdGVyUmVzb2x2ZXIodGhpcy5fa2V5IHx8IGtleSwgcmVzb2x2ZXIpO1xuICAgIH1cblxuICAgIHJldHVybiByZXNvbHZlcjtcbiAgfTtcblxuICByZXR1cm4gU2luZ2xldG9uUmVnaXN0cmF0aW9uO1xufSgpO1xuXG52YXIgYmFkS2V5RXJyb3IgPSAna2V5L3ZhbHVlIGNhbm5vdCBiZSBudWxsIG9yIHVuZGVmaW5lZC4gQXJlIHlvdSB0cnlpbmcgdG8gaW5qZWN0L3JlZ2lzdGVyIHNvbWV0aGluZyB0aGF0IGRvZXNuXFwndCBleGlzdCB3aXRoIERJPyc7XG52YXIgX2VtcHR5UGFyYW1ldGVycyA9IGV4cG9ydHMuX2VtcHR5UGFyYW1ldGVycyA9IE9iamVjdC5mcmVlemUoW10pO1xuXG5fYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLnJlZ2lzdHJhdGlvbiA9ICdhdXJlbGlhOnJlZ2lzdHJhdGlvbic7XG5fYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLmludm9rZXIgPSAnYXVyZWxpYTppbnZva2VyJztcblxudmFyIHJlc29sdmVyRGVjb3JhdGVzID0gcmVzb2x2ZXIuZGVjb3JhdGVzO1xuXG52YXIgSW52b2NhdGlvbkhhbmRsZXIgPSBleHBvcnRzLkludm9jYXRpb25IYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBJbnZvY2F0aW9uSGFuZGxlcihmbiwgaW52b2tlciwgZGVwZW5kZW5jaWVzKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEludm9jYXRpb25IYW5kbGVyKTtcblxuICAgIHRoaXMuZm4gPSBmbjtcbiAgICB0aGlzLmludm9rZXIgPSBpbnZva2VyO1xuICAgIHRoaXMuZGVwZW5kZW5jaWVzID0gZGVwZW5kZW5jaWVzO1xuICB9XG5cbiAgSW52b2NhdGlvbkhhbmRsZXIucHJvdG90eXBlLmludm9rZSA9IGZ1bmN0aW9uIGludm9rZShjb250YWluZXIsIGR5bmFtaWNEZXBlbmRlbmNpZXMpIHtcbiAgICByZXR1cm4gZHluYW1pY0RlcGVuZGVuY2llcyAhPT0gdW5kZWZpbmVkID8gdGhpcy5pbnZva2VyLmludm9rZVdpdGhEeW5hbWljRGVwZW5kZW5jaWVzKGNvbnRhaW5lciwgdGhpcy5mbiwgdGhpcy5kZXBlbmRlbmNpZXMsIGR5bmFtaWNEZXBlbmRlbmNpZXMpIDogdGhpcy5pbnZva2VyLmludm9rZShjb250YWluZXIsIHRoaXMuZm4sIHRoaXMuZGVwZW5kZW5jaWVzKTtcbiAgfTtcblxuICByZXR1cm4gSW52b2NhdGlvbkhhbmRsZXI7XG59KCk7XG5cbmZ1bmN0aW9uIGludm9rZVdpdGhEeW5hbWljRGVwZW5kZW5jaWVzKGNvbnRhaW5lciwgZm4sIHN0YXRpY0RlcGVuZGVuY2llcywgZHluYW1pY0RlcGVuZGVuY2llcykge1xuICB2YXIgaSA9IHN0YXRpY0RlcGVuZGVuY2llcy5sZW5ndGg7XG4gIHZhciBhcmdzID0gbmV3IEFycmF5KGkpO1xuXG4gIHdoaWxlIChpLS0pIHtcbiAgICBhcmdzW2ldID0gY29udGFpbmVyLmdldChzdGF0aWNEZXBlbmRlbmNpZXNbaV0pO1xuICB9XG5cbiAgaWYgKGR5bmFtaWNEZXBlbmRlbmNpZXMgIT09IHVuZGVmaW5lZCkge1xuICAgIGFyZ3MgPSBhcmdzLmNvbmNhdChkeW5hbWljRGVwZW5kZW5jaWVzKTtcbiAgfVxuXG4gIHJldHVybiBSZWZsZWN0LmNvbnN0cnVjdChmbiwgYXJncyk7XG59XG5cbnZhciBjbGFzc0ludm9rZXJzID0gKF9jbGFzc0ludm9rZXJzID0ge30sIF9jbGFzc0ludm9rZXJzWzBdID0ge1xuICBpbnZva2U6IGZ1bmN0aW9uIGludm9rZShjb250YWluZXIsIFR5cGUpIHtcbiAgICByZXR1cm4gbmV3IFR5cGUoKTtcbiAgfSxcblxuICBpbnZva2VXaXRoRHluYW1pY0RlcGVuZGVuY2llczogaW52b2tlV2l0aER5bmFtaWNEZXBlbmRlbmNpZXNcbn0sIF9jbGFzc0ludm9rZXJzWzFdID0ge1xuICBpbnZva2U6IGZ1bmN0aW9uIGludm9rZShjb250YWluZXIsIFR5cGUsIGRlcHMpIHtcbiAgICByZXR1cm4gbmV3IFR5cGUoY29udGFpbmVyLmdldChkZXBzWzBdKSk7XG4gIH0sXG5cbiAgaW52b2tlV2l0aER5bmFtaWNEZXBlbmRlbmNpZXM6IGludm9rZVdpdGhEeW5hbWljRGVwZW5kZW5jaWVzXG59LCBfY2xhc3NJbnZva2Vyc1syXSA9IHtcbiAgaW52b2tlOiBmdW5jdGlvbiBpbnZva2UoY29udGFpbmVyLCBUeXBlLCBkZXBzKSB7XG4gICAgcmV0dXJuIG5ldyBUeXBlKGNvbnRhaW5lci5nZXQoZGVwc1swXSksIGNvbnRhaW5lci5nZXQoZGVwc1sxXSkpO1xuICB9LFxuXG4gIGludm9rZVdpdGhEeW5hbWljRGVwZW5kZW5jaWVzOiBpbnZva2VXaXRoRHluYW1pY0RlcGVuZGVuY2llc1xufSwgX2NsYXNzSW52b2tlcnNbM10gPSB7XG4gIGludm9rZTogZnVuY3Rpb24gaW52b2tlKGNvbnRhaW5lciwgVHlwZSwgZGVwcykge1xuICAgIHJldHVybiBuZXcgVHlwZShjb250YWluZXIuZ2V0KGRlcHNbMF0pLCBjb250YWluZXIuZ2V0KGRlcHNbMV0pLCBjb250YWluZXIuZ2V0KGRlcHNbMl0pKTtcbiAgfSxcblxuICBpbnZva2VXaXRoRHluYW1pY0RlcGVuZGVuY2llczogaW52b2tlV2l0aER5bmFtaWNEZXBlbmRlbmNpZXNcbn0sIF9jbGFzc0ludm9rZXJzWzRdID0ge1xuICBpbnZva2U6IGZ1bmN0aW9uIGludm9rZShjb250YWluZXIsIFR5cGUsIGRlcHMpIHtcbiAgICByZXR1cm4gbmV3IFR5cGUoY29udGFpbmVyLmdldChkZXBzWzBdKSwgY29udGFpbmVyLmdldChkZXBzWzFdKSwgY29udGFpbmVyLmdldChkZXBzWzJdKSwgY29udGFpbmVyLmdldChkZXBzWzNdKSk7XG4gIH0sXG5cbiAgaW52b2tlV2l0aER5bmFtaWNEZXBlbmRlbmNpZXM6IGludm9rZVdpdGhEeW5hbWljRGVwZW5kZW5jaWVzXG59LCBfY2xhc3NJbnZva2Vyc1s1XSA9IHtcbiAgaW52b2tlOiBmdW5jdGlvbiBpbnZva2UoY29udGFpbmVyLCBUeXBlLCBkZXBzKSB7XG4gICAgcmV0dXJuIG5ldyBUeXBlKGNvbnRhaW5lci5nZXQoZGVwc1swXSksIGNvbnRhaW5lci5nZXQoZGVwc1sxXSksIGNvbnRhaW5lci5nZXQoZGVwc1syXSksIGNvbnRhaW5lci5nZXQoZGVwc1szXSksIGNvbnRhaW5lci5nZXQoZGVwc1s0XSkpO1xuICB9LFxuXG4gIGludm9rZVdpdGhEeW5hbWljRGVwZW5kZW5jaWVzOiBpbnZva2VXaXRoRHluYW1pY0RlcGVuZGVuY2llc1xufSwgX2NsYXNzSW52b2tlcnMuZmFsbGJhY2sgPSB7XG4gIGludm9rZTogaW52b2tlV2l0aER5bmFtaWNEZXBlbmRlbmNpZXMsXG4gIGludm9rZVdpdGhEeW5hbWljRGVwZW5kZW5jaWVzOiBpbnZva2VXaXRoRHluYW1pY0RlcGVuZGVuY2llc1xufSwgX2NsYXNzSW52b2tlcnMpO1xuXG5mdW5jdGlvbiBnZXREZXBlbmRlbmNpZXMoZikge1xuICBpZiAoIWYuaGFzT3duUHJvcGVydHkoJ2luamVjdCcpKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBmLmluamVjdCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiBmLmluamVjdCgpO1xuICB9XG5cbiAgcmV0dXJuIGYuaW5qZWN0O1xufVxuXG52YXIgQ29udGFpbmVyID0gZXhwb3J0cy5Db250YWluZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIENvbnRhaW5lcihjb25maWd1cmF0aW9uKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENvbnRhaW5lcik7XG5cbiAgICBpZiAoY29uZmlndXJhdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25maWd1cmF0aW9uID0ge307XG4gICAgfVxuXG4gICAgdGhpcy5fY29uZmlndXJhdGlvbiA9IGNvbmZpZ3VyYXRpb247XG4gICAgdGhpcy5fb25IYW5kbGVyQ3JlYXRlZCA9IGNvbmZpZ3VyYXRpb24ub25IYW5kbGVyQ3JlYXRlZDtcbiAgICB0aGlzLl9oYW5kbGVycyA9IGNvbmZpZ3VyYXRpb24uaGFuZGxlcnMgfHwgKGNvbmZpZ3VyYXRpb24uaGFuZGxlcnMgPSBuZXcgTWFwKCkpO1xuICAgIHRoaXMuX3Jlc29sdmVycyA9IG5ldyBNYXAoKTtcbiAgICB0aGlzLnJvb3QgPSB0aGlzO1xuICAgIHRoaXMucGFyZW50ID0gbnVsbDtcbiAgfVxuXG4gIENvbnRhaW5lci5wcm90b3R5cGUubWFrZUdsb2JhbCA9IGZ1bmN0aW9uIG1ha2VHbG9iYWwoKSB7XG4gICAgQ29udGFpbmVyLmluc3RhbmNlID0gdGhpcztcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBDb250YWluZXIucHJvdG90eXBlLnNldEhhbmRsZXJDcmVhdGVkQ2FsbGJhY2sgPSBmdW5jdGlvbiBzZXRIYW5kbGVyQ3JlYXRlZENhbGxiYWNrKG9uSGFuZGxlckNyZWF0ZWQpIHtcbiAgICB0aGlzLl9vbkhhbmRsZXJDcmVhdGVkID0gb25IYW5kbGVyQ3JlYXRlZDtcbiAgICB0aGlzLl9jb25maWd1cmF0aW9uLm9uSGFuZGxlckNyZWF0ZWQgPSBvbkhhbmRsZXJDcmVhdGVkO1xuICB9O1xuXG4gIENvbnRhaW5lci5wcm90b3R5cGUucmVnaXN0ZXJJbnN0YW5jZSA9IGZ1bmN0aW9uIHJlZ2lzdGVySW5zdGFuY2Uoa2V5LCBpbnN0YW5jZSkge1xuICAgIHRoaXMucmVnaXN0ZXJSZXNvbHZlcihrZXksIG5ldyBTdHJhdGVneVJlc29sdmVyKDAsIGluc3RhbmNlID09PSB1bmRlZmluZWQgPyBrZXkgOiBpbnN0YW5jZSkpO1xuICB9O1xuXG4gIENvbnRhaW5lci5wcm90b3R5cGUucmVnaXN0ZXJTaW5nbGV0b24gPSBmdW5jdGlvbiByZWdpc3RlclNpbmdsZXRvbihrZXksIGZuKSB7XG4gICAgdGhpcy5yZWdpc3RlclJlc29sdmVyKGtleSwgbmV3IFN0cmF0ZWd5UmVzb2x2ZXIoMSwgZm4gPT09IHVuZGVmaW5lZCA/IGtleSA6IGZuKSk7XG4gIH07XG5cbiAgQ29udGFpbmVyLnByb3RvdHlwZS5yZWdpc3RlclRyYW5zaWVudCA9IGZ1bmN0aW9uIHJlZ2lzdGVyVHJhbnNpZW50KGtleSwgZm4pIHtcbiAgICB0aGlzLnJlZ2lzdGVyUmVzb2x2ZXIoa2V5LCBuZXcgU3RyYXRlZ3lSZXNvbHZlcigyLCBmbiA9PT0gdW5kZWZpbmVkID8ga2V5IDogZm4pKTtcbiAgfTtcblxuICBDb250YWluZXIucHJvdG90eXBlLnJlZ2lzdGVySGFuZGxlciA9IGZ1bmN0aW9uIHJlZ2lzdGVySGFuZGxlcihrZXksIGhhbmRsZXIpIHtcbiAgICB0aGlzLnJlZ2lzdGVyUmVzb2x2ZXIoa2V5LCBuZXcgU3RyYXRlZ3lSZXNvbHZlcigzLCBoYW5kbGVyKSk7XG4gIH07XG5cbiAgQ29udGFpbmVyLnByb3RvdHlwZS5yZWdpc3RlckFsaWFzID0gZnVuY3Rpb24gcmVnaXN0ZXJBbGlhcyhvcmlnaW5hbEtleSwgYWxpYXNLZXkpIHtcbiAgICB0aGlzLnJlZ2lzdGVyUmVzb2x2ZXIoYWxpYXNLZXksIG5ldyBTdHJhdGVneVJlc29sdmVyKDUsIG9yaWdpbmFsS2V5KSk7XG4gIH07XG5cbiAgQ29udGFpbmVyLnByb3RvdHlwZS5yZWdpc3RlclJlc29sdmVyID0gZnVuY3Rpb24gcmVnaXN0ZXJSZXNvbHZlcihrZXksIHJlc29sdmVyKSB7XG4gICAgaWYgKGtleSA9PT0gbnVsbCB8fCBrZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGJhZEtleUVycm9yKTtcbiAgICB9XG5cbiAgICB2YXIgYWxsUmVzb2x2ZXJzID0gdGhpcy5fcmVzb2x2ZXJzO1xuICAgIHZhciByZXN1bHQgPSBhbGxSZXNvbHZlcnMuZ2V0KGtleSk7XG5cbiAgICBpZiAocmVzdWx0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGFsbFJlc29sdmVycy5zZXQoa2V5LCByZXNvbHZlcik7XG4gICAgfSBlbHNlIGlmIChyZXN1bHQuc3RyYXRlZ3kgPT09IDQpIHtcbiAgICAgIHJlc3VsdC5zdGF0ZS5wdXNoKHJlc29sdmVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYWxsUmVzb2x2ZXJzLnNldChrZXksIG5ldyBTdHJhdGVneVJlc29sdmVyKDQsIFtyZXN1bHQsIHJlc29sdmVyXSkpO1xuICAgIH1cbiAgfTtcblxuICBDb250YWluZXIucHJvdG90eXBlLmF1dG9SZWdpc3RlciA9IGZ1bmN0aW9uIGF1dG9SZWdpc3Rlcihmbiwga2V5KSB7XG4gICAgdmFyIHJlc29sdmVyID0gdm9pZCAwO1xuXG4gICAgaWYgKHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdmFyIF9yZWdpc3RyYXRpb24gPSBfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLmdldChfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLnJlZ2lzdHJhdGlvbiwgZm4pO1xuXG4gICAgICBpZiAoX3JlZ2lzdHJhdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJlc29sdmVyID0gbmV3IFN0cmF0ZWd5UmVzb2x2ZXIoMSwgZm4pO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyUmVzb2x2ZXIoa2V5ID09PSB1bmRlZmluZWQgPyBmbiA6IGtleSwgcmVzb2x2ZXIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzb2x2ZXIgPSBfcmVnaXN0cmF0aW9uLnJlZ2lzdGVyUmVzb2x2ZXIodGhpcywga2V5ID09PSB1bmRlZmluZWQgPyBmbiA6IGtleSwgZm4pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXNvbHZlciA9IG5ldyBTdHJhdGVneVJlc29sdmVyKDAsIGZuKTtcbiAgICAgIHRoaXMucmVnaXN0ZXJSZXNvbHZlcihrZXkgPT09IHVuZGVmaW5lZCA/IGZuIDoga2V5LCByZXNvbHZlcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc29sdmVyO1xuICB9O1xuXG4gIENvbnRhaW5lci5wcm90b3R5cGUuYXV0b1JlZ2lzdGVyQWxsID0gZnVuY3Rpb24gYXV0b1JlZ2lzdGVyQWxsKGZucykge1xuICAgIHZhciBpID0gZm5zLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICB0aGlzLmF1dG9SZWdpc3RlcihmbnNbaV0pO1xuICAgIH1cbiAgfTtcblxuICBDb250YWluZXIucHJvdG90eXBlLnVucmVnaXN0ZXIgPSBmdW5jdGlvbiB1bnJlZ2lzdGVyKGtleSkge1xuICAgIHRoaXMuX3Jlc29sdmVycy5kZWxldGUoa2V5KTtcbiAgfTtcblxuICBDb250YWluZXIucHJvdG90eXBlLmhhc1Jlc29sdmVyID0gZnVuY3Rpb24gaGFzUmVzb2x2ZXIoa2V5KSB7XG4gICAgdmFyIGNoZWNrUGFyZW50ID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gZmFsc2UgOiBhcmd1bWVudHNbMV07XG5cbiAgICBpZiAoa2V5ID09PSBudWxsIHx8IGtleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYmFkS2V5RXJyb3IpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLl9yZXNvbHZlcnMuaGFzKGtleSkgfHwgY2hlY2tQYXJlbnQgJiYgdGhpcy5wYXJlbnQgIT09IG51bGwgJiYgdGhpcy5wYXJlbnQuaGFzUmVzb2x2ZXIoa2V5LCBjaGVja1BhcmVudCk7XG4gIH07XG5cbiAgQ29udGFpbmVyLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiBnZXQoa2V5KSB7XG4gICAgaWYgKGtleSA9PT0gbnVsbCB8fCBrZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGJhZEtleUVycm9yKTtcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09PSBDb250YWluZXIpIHtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGlmIChyZXNvbHZlckRlY29yYXRlcyhrZXkpKSB7XG4gICAgICByZXR1cm4ga2V5LmdldCh0aGlzLCBrZXkpO1xuICAgIH1cblxuICAgIHZhciByZXNvbHZlciA9IHRoaXMuX3Jlc29sdmVycy5nZXQoa2V5KTtcblxuICAgIGlmIChyZXNvbHZlciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAodGhpcy5wYXJlbnQgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXV0b1JlZ2lzdGVyKGtleSkuZ2V0KHRoaXMsIGtleSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLnBhcmVudC5fZ2V0KGtleSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc29sdmVyLmdldCh0aGlzLCBrZXkpO1xuICB9O1xuXG4gIENvbnRhaW5lci5wcm90b3R5cGUuX2dldCA9IGZ1bmN0aW9uIF9nZXQoa2V5KSB7XG4gICAgdmFyIHJlc29sdmVyID0gdGhpcy5fcmVzb2x2ZXJzLmdldChrZXkpO1xuXG4gICAgaWYgKHJlc29sdmVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmICh0aGlzLnBhcmVudCA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hdXRvUmVnaXN0ZXIoa2V5KS5nZXQodGhpcywga2V5KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMucGFyZW50Ll9nZXQoa2V5KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzb2x2ZXIuZ2V0KHRoaXMsIGtleSk7XG4gIH07XG5cbiAgQ29udGFpbmVyLnByb3RvdHlwZS5nZXRBbGwgPSBmdW5jdGlvbiBnZXRBbGwoa2V5KSB7XG4gICAgaWYgKGtleSA9PT0gbnVsbCB8fCBrZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGJhZEtleUVycm9yKTtcbiAgICB9XG5cbiAgICB2YXIgcmVzb2x2ZXIgPSB0aGlzLl9yZXNvbHZlcnMuZ2V0KGtleSk7XG5cbiAgICBpZiAocmVzb2x2ZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKHRoaXMucGFyZW50ID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBfZW1wdHlQYXJhbWV0ZXJzO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5wYXJlbnQuZ2V0QWxsKGtleSk7XG4gICAgfVxuXG4gICAgaWYgKHJlc29sdmVyLnN0cmF0ZWd5ID09PSA0KSB7XG4gICAgICB2YXIgc3RhdGUgPSByZXNvbHZlci5zdGF0ZTtcbiAgICAgIHZhciBpID0gc3RhdGUubGVuZ3RoO1xuICAgICAgdmFyIHJlc3VsdHMgPSBuZXcgQXJyYXkoaSk7XG5cbiAgICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgcmVzdWx0c1tpXSA9IHN0YXRlW2ldLmdldCh0aGlzLCBrZXkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVzdWx0cztcbiAgICB9XG5cbiAgICByZXR1cm4gW3Jlc29sdmVyLmdldCh0aGlzLCBrZXkpXTtcbiAgfTtcblxuICBDb250YWluZXIucHJvdG90eXBlLmNyZWF0ZUNoaWxkID0gZnVuY3Rpb24gY3JlYXRlQ2hpbGQoKSB7XG4gICAgdmFyIGNoaWxkID0gbmV3IENvbnRhaW5lcih0aGlzLl9jb25maWd1cmF0aW9uKTtcbiAgICBjaGlsZC5yb290ID0gdGhpcy5yb290O1xuICAgIGNoaWxkLnBhcmVudCA9IHRoaXM7XG4gICAgcmV0dXJuIGNoaWxkO1xuICB9O1xuXG4gIENvbnRhaW5lci5wcm90b3R5cGUuaW52b2tlID0gZnVuY3Rpb24gaW52b2tlKGZuLCBkeW5hbWljRGVwZW5kZW5jaWVzKSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciBfaGFuZGxlciA9IHRoaXMuX2hhbmRsZXJzLmdldChmbik7XG5cbiAgICAgIGlmIChfaGFuZGxlciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIF9oYW5kbGVyID0gdGhpcy5fY3JlYXRlSW52b2NhdGlvbkhhbmRsZXIoZm4pO1xuICAgICAgICB0aGlzLl9oYW5kbGVycy5zZXQoZm4sIF9oYW5kbGVyKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIF9oYW5kbGVyLmludm9rZSh0aGlzLCBkeW5hbWljRGVwZW5kZW5jaWVzKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aHJvdyBuZXcgX2F1cmVsaWFQYWwuQWdncmVnYXRlRXJyb3IoJ0Vycm9yIGludm9raW5nICcgKyBmbi5uYW1lICsgJy4gQ2hlY2sgdGhlIGlubmVyIGVycm9yIGZvciBkZXRhaWxzLicsIGUsIHRydWUpO1xuICAgIH1cbiAgfTtcblxuICBDb250YWluZXIucHJvdG90eXBlLl9jcmVhdGVJbnZvY2F0aW9uSGFuZGxlciA9IGZ1bmN0aW9uIF9jcmVhdGVJbnZvY2F0aW9uSGFuZGxlcihmbikge1xuICAgIHZhciBkZXBlbmRlbmNpZXMgPSB2b2lkIDA7XG5cbiAgICBpZiAoZm4uaW5qZWN0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGRlcGVuZGVuY2llcyA9IF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEuZ2V0T3duKF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEucGFyYW1UeXBlcywgZm4pIHx8IF9lbXB0eVBhcmFtZXRlcnM7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRlcGVuZGVuY2llcyA9IFtdO1xuICAgICAgdmFyIGN0b3IgPSBmbjtcbiAgICAgIHdoaWxlICh0eXBlb2YgY3RvciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB2YXIgX2RlcGVuZGVuY2llcztcblxuICAgICAgICAoX2RlcGVuZGVuY2llcyA9IGRlcGVuZGVuY2llcykucHVzaC5hcHBseShfZGVwZW5kZW5jaWVzLCBnZXREZXBlbmRlbmNpZXMoY3RvcikpO1xuICAgICAgICBjdG9yID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKGN0b3IpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBpbnZva2VyID0gX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5nZXRPd24oX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5pbnZva2VyLCBmbikgfHwgY2xhc3NJbnZva2Vyc1tkZXBlbmRlbmNpZXMubGVuZ3RoXSB8fCBjbGFzc0ludm9rZXJzLmZhbGxiYWNrO1xuXG4gICAgdmFyIGhhbmRsZXIgPSBuZXcgSW52b2NhdGlvbkhhbmRsZXIoZm4sIGludm9rZXIsIGRlcGVuZGVuY2llcyk7XG4gICAgcmV0dXJuIHRoaXMuX29uSGFuZGxlckNyZWF0ZWQgIT09IHVuZGVmaW5lZCA/IHRoaXMuX29uSGFuZGxlckNyZWF0ZWQoaGFuZGxlcikgOiBoYW5kbGVyO1xuICB9O1xuXG4gIHJldHVybiBDb250YWluZXI7XG59KCk7XG5cbmZ1bmN0aW9uIGF1dG9pbmplY3QocG90ZW50aWFsVGFyZ2V0KSB7XG4gIHZhciBkZWNvID0gZnVuY3Rpb24gZGVjbyh0YXJnZXQpIHtcbiAgICB0YXJnZXQuaW5qZWN0ID0gX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5nZXRPd24oX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5wYXJhbVR5cGVzLCB0YXJnZXQpIHx8IF9lbXB0eVBhcmFtZXRlcnM7XG4gIH07XG5cbiAgcmV0dXJuIHBvdGVudGlhbFRhcmdldCA/IGRlY28ocG90ZW50aWFsVGFyZ2V0KSA6IGRlY287XG59XG5cbmZ1bmN0aW9uIGluamVjdCgpIHtcbiAgZm9yICh2YXIgX2xlbjIgPSBhcmd1bWVudHMubGVuZ3RoLCByZXN0ID0gQXJyYXkoX2xlbjIpLCBfa2V5MiA9IDA7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHtcbiAgICByZXN0W19rZXkyXSA9IGFyZ3VtZW50c1tfa2V5Ml07XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5LCBkZXNjcmlwdG9yKSB7XG4gICAgaWYgKGRlc2NyaXB0b3IpIHtcbiAgICAgIHZhciBfZm4gPSBkZXNjcmlwdG9yLnZhbHVlO1xuICAgICAgX2ZuLmluamVjdCA9IHJlc3Q7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRhcmdldC5pbmplY3QgPSByZXN0O1xuICAgIH1cbiAgfTtcbn1cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLWRlcGVuZGVuY3ktaW5qZWN0aW9uL2Rpc3QvY29tbW9uanMvYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbi5qc1xuICoqIG1vZHVsZSBpZCA9IDE5XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmdldFNldE9ic2VydmVyID0gZXhwb3J0cy5CaW5kaW5nRW5naW5lID0gZXhwb3J0cy5OYW1lRXhwcmVzc2lvbiA9IGV4cG9ydHMuTGlzdGVuZXIgPSBleHBvcnRzLkxpc3RlbmVyRXhwcmVzc2lvbiA9IGV4cG9ydHMuQmluZGluZ0JlaGF2aW9yUmVzb3VyY2UgPSBleHBvcnRzLlZhbHVlQ29udmVydGVyUmVzb3VyY2UgPSBleHBvcnRzLkNhbGwgPSBleHBvcnRzLkNhbGxFeHByZXNzaW9uID0gZXhwb3J0cy5CaW5kaW5nID0gZXhwb3J0cy5CaW5kaW5nRXhwcmVzc2lvbiA9IGV4cG9ydHMuT2JqZWN0T2JzZXJ2YXRpb25BZGFwdGVyID0gZXhwb3J0cy5PYnNlcnZlckxvY2F0b3IgPSBleHBvcnRzLlNWR0FuYWx5emVyID0gZXhwb3J0cy5wcmVzZW50YXRpb25BdHRyaWJ1dGVzID0gZXhwb3J0cy5wcmVzZW50YXRpb25FbGVtZW50cyA9IGV4cG9ydHMuZWxlbWVudHMgPSBleHBvcnRzLkNvbXB1dGVkRXhwcmVzc2lvbiA9IGV4cG9ydHMuQ2xhc3NPYnNlcnZlciA9IGV4cG9ydHMuU2VsZWN0VmFsdWVPYnNlcnZlciA9IGV4cG9ydHMuQ2hlY2tlZE9ic2VydmVyID0gZXhwb3J0cy5WYWx1ZUF0dHJpYnV0ZU9ic2VydmVyID0gZXhwb3J0cy5TdHlsZU9ic2VydmVyID0gZXhwb3J0cy5EYXRhQXR0cmlidXRlT2JzZXJ2ZXIgPSBleHBvcnRzLmRhdGFBdHRyaWJ1dGVBY2Nlc3NvciA9IGV4cG9ydHMuWExpbmtBdHRyaWJ1dGVPYnNlcnZlciA9IGV4cG9ydHMuU2V0dGVyT2JzZXJ2ZXIgPSBleHBvcnRzLlByaW1pdGl2ZU9ic2VydmVyID0gZXhwb3J0cy5wcm9wZXJ0eUFjY2Vzc29yID0gZXhwb3J0cy5EaXJ0eUNoZWNrUHJvcGVydHkgPSBleHBvcnRzLkRpcnR5Q2hlY2tlciA9IGV4cG9ydHMuRXZlbnRNYW5hZ2VyID0gZXhwb3J0cy5nZXRNYXBPYnNlcnZlciA9IGV4cG9ydHMuUGFyc2VySW1wbGVtZW50YXRpb24gPSBleHBvcnRzLlBhcnNlciA9IGV4cG9ydHMuU2Nhbm5lciA9IGV4cG9ydHMuTGV4ZXIgPSBleHBvcnRzLlRva2VuID0gZXhwb3J0cy5iaW5kaW5nTW9kZSA9IGV4cG9ydHMuRXhwcmVzc2lvbkNsb25lciA9IGV4cG9ydHMuVW5wYXJzZXIgPSBleHBvcnRzLkxpdGVyYWxPYmplY3QgPSBleHBvcnRzLkxpdGVyYWxBcnJheSA9IGV4cG9ydHMuTGl0ZXJhbFN0cmluZyA9IGV4cG9ydHMuTGl0ZXJhbFByaW1pdGl2ZSA9IGV4cG9ydHMuUHJlZml4Tm90ID0gZXhwb3J0cy5CaW5hcnkgPSBleHBvcnRzLkNhbGxGdW5jdGlvbiA9IGV4cG9ydHMuQ2FsbE1lbWJlciA9IGV4cG9ydHMuQ2FsbFNjb3BlID0gZXhwb3J0cy5BY2Nlc3NLZXllZCA9IGV4cG9ydHMuQWNjZXNzTWVtYmVyID0gZXhwb3J0cy5BY2Nlc3NTY29wZSA9IGV4cG9ydHMuQWNjZXNzVGhpcyA9IGV4cG9ydHMuQ29uZGl0aW9uYWwgPSBleHBvcnRzLkFzc2lnbiA9IGV4cG9ydHMuVmFsdWVDb252ZXJ0ZXIgPSBleHBvcnRzLkJpbmRpbmdCZWhhdmlvciA9IGV4cG9ydHMuQ2hhaW4gPSBleHBvcnRzLkV4cHJlc3Npb24gPSBleHBvcnRzLmdldEFycmF5T2JzZXJ2ZXIgPSBleHBvcnRzLkNvbGxlY3Rpb25MZW5ndGhPYnNlcnZlciA9IGV4cG9ydHMuTW9kaWZ5Q29sbGVjdGlvbk9ic2VydmVyID0gZXhwb3J0cy5FeHByZXNzaW9uT2JzZXJ2ZXIgPSBleHBvcnRzLnNvdXJjZUNvbnRleHQgPSB1bmRlZmluZWQ7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2RlYywgX2RlYzIsIF9jbGFzcywgX2RlYzMsIF9jbGFzczIsIF9kZWM0LCBfY2xhc3MzLCBfZGVjNSwgX2NsYXNzNSwgX2RlYzYsIF9jbGFzczcsIF9kZWM3LCBfY2xhc3M4LCBfZGVjOCwgX2NsYXNzOSwgX2RlYzksIF9jbGFzczEwLCBfY2xhc3MxMSwgX3RlbXAsIF9kZWMxMCwgX2NsYXNzMTIsIF9jbGFzczEzLCBfdGVtcDI7XG5cbmV4cG9ydHMuY2FtZWxDYXNlID0gY2FtZWxDYXNlO1xuZXhwb3J0cy5jcmVhdGVPdmVycmlkZUNvbnRleHQgPSBjcmVhdGVPdmVycmlkZUNvbnRleHQ7XG5leHBvcnRzLmdldENvbnRleHRGb3IgPSBnZXRDb250ZXh0Rm9yO1xuZXhwb3J0cy5jcmVhdGVTY29wZUZvclRlc3QgPSBjcmVhdGVTY29wZUZvclRlc3Q7XG5leHBvcnRzLmNvbm5lY3RhYmxlID0gY29ubmVjdGFibGU7XG5leHBvcnRzLmVucXVldWVCaW5kaW5nQ29ubmVjdCA9IGVucXVldWVCaW5kaW5nQ29ubmVjdDtcbmV4cG9ydHMuc3Vic2NyaWJlckNvbGxlY3Rpb24gPSBzdWJzY3JpYmVyQ29sbGVjdGlvbjtcbmV4cG9ydHMuY2FsY1NwbGljZXMgPSBjYWxjU3BsaWNlcztcbmV4cG9ydHMubWVyZ2VTcGxpY2UgPSBtZXJnZVNwbGljZTtcbmV4cG9ydHMucHJvamVjdEFycmF5U3BsaWNlcyA9IHByb2plY3RBcnJheVNwbGljZXM7XG5leHBvcnRzLmdldENoYW5nZVJlY29yZHMgPSBnZXRDaGFuZ2VSZWNvcmRzO1xuZXhwb3J0cy5jbG9uZUV4cHJlc3Npb24gPSBjbG9uZUV4cHJlc3Npb247XG5leHBvcnRzLmhhc0RlY2xhcmVkRGVwZW5kZW5jaWVzID0gaGFzRGVjbGFyZWREZXBlbmRlbmNpZXM7XG5leHBvcnRzLmRlY2xhcmVQcm9wZXJ0eURlcGVuZGVuY2llcyA9IGRlY2xhcmVQcm9wZXJ0eURlcGVuZGVuY2llcztcbmV4cG9ydHMuY29tcHV0ZWRGcm9tID0gY29tcHV0ZWRGcm9tO1xuZXhwb3J0cy5jcmVhdGVDb21wdXRlZE9ic2VydmVyID0gY3JlYXRlQ29tcHV0ZWRPYnNlcnZlcjtcbmV4cG9ydHMudmFsdWVDb252ZXJ0ZXIgPSB2YWx1ZUNvbnZlcnRlcjtcbmV4cG9ydHMuYmluZGluZ0JlaGF2aW9yID0gYmluZGluZ0JlaGF2aW9yO1xuZXhwb3J0cy5vYnNlcnZhYmxlID0gb2JzZXJ2YWJsZTtcblxudmFyIF9hdXJlbGlhTG9nZ2luZyA9IHJlcXVpcmUoJ2F1cmVsaWEtbG9nZ2luZycpO1xuXG52YXIgTG9nTWFuYWdlciA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9hdXJlbGlhTG9nZ2luZyk7XG5cbnZhciBfYXVyZWxpYVBhbCA9IHJlcXVpcmUoJ2F1cmVsaWEtcGFsJyk7XG5cbnZhciBfYXVyZWxpYVRhc2tRdWV1ZSA9IHJlcXVpcmUoJ2F1cmVsaWEtdGFzay1xdWV1ZScpO1xuXG52YXIgX2F1cmVsaWFNZXRhZGF0YSA9IHJlcXVpcmUoJ2F1cmVsaWEtbWV0YWRhdGEnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09iai5kZWZhdWx0ID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG5cblxudmFyIG1hcCA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cbmZ1bmN0aW9uIGNhbWVsQ2FzZShuYW1lKSB7XG4gIGlmIChuYW1lIGluIG1hcCkge1xuICAgIHJldHVybiBtYXBbbmFtZV07XG4gIH1cbiAgdmFyIHJlc3VsdCA9IG5hbWUuY2hhckF0KDApLnRvTG93ZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpLnJlcGxhY2UoL1tfLi1dKFxcd3wkKS9nLCBmdW5jdGlvbiAoXywgeCkge1xuICAgIHJldHVybiB4LnRvVXBwZXJDYXNlKCk7XG4gIH0pO1xuICBtYXBbbmFtZV0gPSByZXN1bHQ7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZU92ZXJyaWRlQ29udGV4dChiaW5kaW5nQ29udGV4dCwgcGFyZW50T3ZlcnJpZGVDb250ZXh0KSB7XG4gIHJldHVybiB7XG4gICAgYmluZGluZ0NvbnRleHQ6IGJpbmRpbmdDb250ZXh0LFxuICAgIHBhcmVudE92ZXJyaWRlQ29udGV4dDogcGFyZW50T3ZlcnJpZGVDb250ZXh0IHx8IG51bGxcbiAgfTtcbn1cblxuZnVuY3Rpb24gZ2V0Q29udGV4dEZvcihuYW1lLCBzY29wZSwgYW5jZXN0b3IpIHtcbiAgdmFyIG9jID0gc2NvcGUub3ZlcnJpZGVDb250ZXh0O1xuXG4gIGlmIChhbmNlc3Rvcikge1xuICAgIHdoaWxlIChhbmNlc3RvciAmJiBvYykge1xuICAgICAgYW5jZXN0b3ItLTtcbiAgICAgIG9jID0gb2MucGFyZW50T3ZlcnJpZGVDb250ZXh0O1xuICAgIH1cbiAgICBpZiAoYW5jZXN0b3IgfHwgIW9jKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gbmFtZSBpbiBvYyA/IG9jIDogb2MuYmluZGluZ0NvbnRleHQ7XG4gIH1cblxuICB3aGlsZSAob2MgJiYgIShuYW1lIGluIG9jKSAmJiAhKG9jLmJpbmRpbmdDb250ZXh0ICYmIG5hbWUgaW4gb2MuYmluZGluZ0NvbnRleHQpKSB7XG4gICAgb2MgPSBvYy5wYXJlbnRPdmVycmlkZUNvbnRleHQ7XG4gIH1cbiAgaWYgKG9jKSB7XG4gICAgcmV0dXJuIG5hbWUgaW4gb2MgPyBvYyA6IG9jLmJpbmRpbmdDb250ZXh0O1xuICB9XG5cbiAgcmV0dXJuIHNjb3BlLmJpbmRpbmdDb250ZXh0IHx8IHNjb3BlLm92ZXJyaWRlQ29udGV4dDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlU2NvcGVGb3JUZXN0KGJpbmRpbmdDb250ZXh0LCBwYXJlbnRCaW5kaW5nQ29udGV4dCkge1xuICBpZiAocGFyZW50QmluZGluZ0NvbnRleHQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYmluZGluZ0NvbnRleHQ6IGJpbmRpbmdDb250ZXh0LFxuICAgICAgb3ZlcnJpZGVDb250ZXh0OiBjcmVhdGVPdmVycmlkZUNvbnRleHQoYmluZGluZ0NvbnRleHQsIGNyZWF0ZU92ZXJyaWRlQ29udGV4dChwYXJlbnRCaW5kaW5nQ29udGV4dCkpXG4gICAgfTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGJpbmRpbmdDb250ZXh0OiBiaW5kaW5nQ29udGV4dCxcbiAgICBvdmVycmlkZUNvbnRleHQ6IGNyZWF0ZU92ZXJyaWRlQ29udGV4dChiaW5kaW5nQ29udGV4dClcbiAgfTtcbn1cblxudmFyIHNvdXJjZUNvbnRleHQgPSBleHBvcnRzLnNvdXJjZUNvbnRleHQgPSAnQmluZGluZzpzb3VyY2UnO1xudmFyIHNsb3ROYW1lcyA9IFtdO1xudmFyIHZlcnNpb25TbG90TmFtZXMgPSBbXTtcblxuZm9yICh2YXIgaSA9IDA7IGkgPCAxMDA7IGkrKykge1xuICBzbG90TmFtZXMucHVzaCgnX29ic2VydmVyJyArIGkpO1xuICB2ZXJzaW9uU2xvdE5hbWVzLnB1c2goJ19vYnNlcnZlclZlcnNpb24nICsgaSk7XG59XG5cbmZ1bmN0aW9uIGFkZE9ic2VydmVyKG9ic2VydmVyKSB7XG4gIHZhciBvYnNlcnZlclNsb3RzID0gdGhpcy5fb2JzZXJ2ZXJTbG90cyA9PT0gdW5kZWZpbmVkID8gMCA6IHRoaXMuX29ic2VydmVyU2xvdHM7XG4gIHZhciBpID0gb2JzZXJ2ZXJTbG90cztcbiAgd2hpbGUgKGktLSAmJiB0aGlzW3Nsb3ROYW1lc1tpXV0gIT09IG9ic2VydmVyKSB7fVxuICBpZiAoaSA9PT0gLTEpIHtcbiAgICBpID0gMDtcbiAgICB3aGlsZSAodGhpc1tzbG90TmFtZXNbaV1dKSB7XG4gICAgICBpKys7XG4gICAgfVxuICAgIHRoaXNbc2xvdE5hbWVzW2ldXSA9IG9ic2VydmVyO1xuICAgIG9ic2VydmVyLnN1YnNjcmliZShzb3VyY2VDb250ZXh0LCB0aGlzKTtcblxuICAgIGlmIChpID09PSBvYnNlcnZlclNsb3RzKSB7XG4gICAgICB0aGlzLl9vYnNlcnZlclNsb3RzID0gaSArIDE7XG4gICAgfVxuICB9XG5cbiAgaWYgKHRoaXMuX3ZlcnNpb24gPT09IHVuZGVmaW5lZCkge1xuICAgIHRoaXMuX3ZlcnNpb24gPSAwO1xuICB9XG4gIHRoaXNbdmVyc2lvblNsb3ROYW1lc1tpXV0gPSB0aGlzLl92ZXJzaW9uO1xufVxuXG5mdW5jdGlvbiBvYnNlcnZlUHJvcGVydHkob2JqLCBwcm9wZXJ0eU5hbWUpIHtcbiAgdmFyIG9ic2VydmVyID0gdGhpcy5vYnNlcnZlckxvY2F0b3IuZ2V0T2JzZXJ2ZXIob2JqLCBwcm9wZXJ0eU5hbWUpO1xuICBhZGRPYnNlcnZlci5jYWxsKHRoaXMsIG9ic2VydmVyKTtcbn1cblxuZnVuY3Rpb24gb2JzZXJ2ZUFycmF5KGFycmF5KSB7XG4gIHZhciBvYnNlcnZlciA9IHRoaXMub2JzZXJ2ZXJMb2NhdG9yLmdldEFycmF5T2JzZXJ2ZXIoYXJyYXkpO1xuICBhZGRPYnNlcnZlci5jYWxsKHRoaXMsIG9ic2VydmVyKTtcbn1cblxuZnVuY3Rpb24gdW5vYnNlcnZlKGFsbCkge1xuICB2YXIgaSA9IHRoaXMuX29ic2VydmVyU2xvdHM7XG4gIHdoaWxlIChpLS0pIHtcbiAgICBpZiAoYWxsIHx8IHRoaXNbdmVyc2lvblNsb3ROYW1lc1tpXV0gIT09IHRoaXMuX3ZlcnNpb24pIHtcbiAgICAgIHZhciBvYnNlcnZlciA9IHRoaXNbc2xvdE5hbWVzW2ldXTtcbiAgICAgIHRoaXNbc2xvdE5hbWVzW2ldXSA9IG51bGw7XG4gICAgICBpZiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgb2JzZXJ2ZXIudW5zdWJzY3JpYmUoc291cmNlQ29udGV4dCwgdGhpcyk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGNvbm5lY3RhYmxlKCkge1xuICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgIHRhcmdldC5wcm90b3R5cGUub2JzZXJ2ZVByb3BlcnR5ID0gb2JzZXJ2ZVByb3BlcnR5O1xuICAgIHRhcmdldC5wcm90b3R5cGUub2JzZXJ2ZUFycmF5ID0gb2JzZXJ2ZUFycmF5O1xuICAgIHRhcmdldC5wcm90b3R5cGUudW5vYnNlcnZlID0gdW5vYnNlcnZlO1xuICAgIHRhcmdldC5wcm90b3R5cGUuYWRkT2JzZXJ2ZXIgPSBhZGRPYnNlcnZlcjtcbiAgfTtcbn1cblxudmFyIGJpbmRpbmdzID0gbmV3IE1hcCgpO1xudmFyIG1pbmltdW1JbW1lZGlhdGUgPSAxMDA7XG52YXIgZnJhbWVCdWRnZXQgPSAxNTtcblxudmFyIGlzRmx1c2hSZXF1ZXN0ZWQgPSBmYWxzZTtcbnZhciBpbW1lZGlhdGUgPSAwO1xuXG5mdW5jdGlvbiBmbHVzaChhbmltYXRpb25GcmFtZVN0YXJ0KSB7XG4gIHZhciBpID0gMDtcbiAgdmFyIGtleXMgPSBiaW5kaW5ncy5rZXlzKCk7XG4gIHZhciBpdGVtID0gdm9pZCAwO1xuXG4gIHdoaWxlIChpdGVtID0ga2V5cy5uZXh0KCkpIHtcbiAgICBpZiAoaXRlbS5kb25lKSB7XG4gICAgICBicmVhaztcbiAgICB9XG5cbiAgICB2YXIgYmluZGluZyA9IGl0ZW0udmFsdWU7XG4gICAgYmluZGluZ3MuZGVsZXRlKGJpbmRpbmcpO1xuICAgIGJpbmRpbmcuY29ubmVjdCh0cnVlKTtcbiAgICBpKys7XG5cbiAgICBpZiAoaSAlIDEwMCA9PT0gMCAmJiBfYXVyZWxpYVBhbC5QTEFURk9STS5wZXJmb3JtYW5jZS5ub3coKSAtIGFuaW1hdGlvbkZyYW1lU3RhcnQgPiBmcmFtZUJ1ZGdldCkge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgaWYgKGJpbmRpbmdzLnNpemUpIHtcbiAgICBfYXVyZWxpYVBhbC5QTEFURk9STS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZmx1c2gpO1xuICB9IGVsc2Uge1xuICAgIGlzRmx1c2hSZXF1ZXN0ZWQgPSBmYWxzZTtcbiAgICBpbW1lZGlhdGUgPSAwO1xuICB9XG59XG5cbmZ1bmN0aW9uIGVucXVldWVCaW5kaW5nQ29ubmVjdChiaW5kaW5nKSB7XG4gIGlmIChpbW1lZGlhdGUgPCBtaW5pbXVtSW1tZWRpYXRlKSB7XG4gICAgaW1tZWRpYXRlKys7XG4gICAgYmluZGluZy5jb25uZWN0KGZhbHNlKTtcbiAgfSBlbHNlIHtcbiAgICBiaW5kaW5ncy5zZXQoYmluZGluZyk7XG4gIH1cbiAgaWYgKCFpc0ZsdXNoUmVxdWVzdGVkKSB7XG4gICAgaXNGbHVzaFJlcXVlc3RlZCA9IHRydWU7XG4gICAgX2F1cmVsaWFQYWwuUExBVEZPUk0ucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZsdXNoKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBhZGRTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gIGlmICh0aGlzLmhhc1N1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlmICghdGhpcy5fY29udGV4dDApIHtcbiAgICB0aGlzLl9jb250ZXh0MCA9IGNvbnRleHQ7XG4gICAgdGhpcy5fY2FsbGFibGUwID0gY2FsbGFibGU7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgaWYgKCF0aGlzLl9jb250ZXh0MSkge1xuICAgIHRoaXMuX2NvbnRleHQxID0gY29udGV4dDtcbiAgICB0aGlzLl9jYWxsYWJsZTEgPSBjYWxsYWJsZTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAoIXRoaXMuX2NvbnRleHQyKSB7XG4gICAgdGhpcy5fY29udGV4dDIgPSBjb250ZXh0O1xuICAgIHRoaXMuX2NhbGxhYmxlMiA9IGNhbGxhYmxlO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGlmICghdGhpcy5fY29udGV4dHNSZXN0KSB7XG4gICAgdGhpcy5fY29udGV4dHNSZXN0ID0gW2NvbnRleHRdO1xuICAgIHRoaXMuX2NhbGxhYmxlc1Jlc3QgPSBbY2FsbGFibGVdO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHRoaXMuX2NvbnRleHRzUmVzdC5wdXNoKGNvbnRleHQpO1xuICB0aGlzLl9jYWxsYWJsZXNSZXN0LnB1c2goY2FsbGFibGUpO1xuICByZXR1cm4gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gcmVtb3ZlU3Vic2NyaWJlcihjb250ZXh0LCBjYWxsYWJsZSkge1xuICBpZiAodGhpcy5fY29udGV4dDAgPT09IGNvbnRleHQgJiYgdGhpcy5fY2FsbGFibGUwID09PSBjYWxsYWJsZSkge1xuICAgIHRoaXMuX2NvbnRleHQwID0gbnVsbDtcbiAgICB0aGlzLl9jYWxsYWJsZTAgPSBudWxsO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGlmICh0aGlzLl9jb250ZXh0MSA9PT0gY29udGV4dCAmJiB0aGlzLl9jYWxsYWJsZTEgPT09IGNhbGxhYmxlKSB7XG4gICAgdGhpcy5fY29udGV4dDEgPSBudWxsO1xuICAgIHRoaXMuX2NhbGxhYmxlMSA9IG51bGw7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgaWYgKHRoaXMuX2NvbnRleHQyID09PSBjb250ZXh0ICYmIHRoaXMuX2NhbGxhYmxlMiA9PT0gY2FsbGFibGUpIHtcbiAgICB0aGlzLl9jb250ZXh0MiA9IG51bGw7XG4gICAgdGhpcy5fY2FsbGFibGUyID0gbnVsbDtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICB2YXIgcmVzdCA9IHRoaXMuX2NvbnRleHRzUmVzdDtcbiAgdmFyIGluZGV4ID0gdm9pZCAwO1xuICBpZiAoIXJlc3QgfHwgIXJlc3QubGVuZ3RoIHx8IChpbmRleCA9IHJlc3QuaW5kZXhPZihjb250ZXh0KSkgPT09IC0xIHx8IHRoaXMuX2NhbGxhYmxlc1Jlc3RbaW5kZXhdICE9PSBjYWxsYWJsZSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXN0LnNwbGljZShpbmRleCwgMSk7XG4gIHRoaXMuX2NhbGxhYmxlc1Jlc3Quc3BsaWNlKGluZGV4LCAxKTtcbiAgcmV0dXJuIHRydWU7XG59XG5cbnZhciBhcnJheVBvb2wxID0gW107XG52YXIgYXJyYXlQb29sMiA9IFtdO1xudmFyIHBvb2xVdGlsaXphdGlvbiA9IFtdO1xuXG5mdW5jdGlvbiBjYWxsU3Vic2NyaWJlcnMobmV3VmFsdWUsIG9sZFZhbHVlKSB7XG4gIHZhciBjb250ZXh0MCA9IHRoaXMuX2NvbnRleHQwO1xuICB2YXIgY2FsbGFibGUwID0gdGhpcy5fY2FsbGFibGUwO1xuICB2YXIgY29udGV4dDEgPSB0aGlzLl9jb250ZXh0MTtcbiAgdmFyIGNhbGxhYmxlMSA9IHRoaXMuX2NhbGxhYmxlMTtcbiAgdmFyIGNvbnRleHQyID0gdGhpcy5fY29udGV4dDI7XG4gIHZhciBjYWxsYWJsZTIgPSB0aGlzLl9jYWxsYWJsZTI7XG4gIHZhciBsZW5ndGggPSB0aGlzLl9jb250ZXh0c1Jlc3QgPyB0aGlzLl9jb250ZXh0c1Jlc3QubGVuZ3RoIDogMDtcbiAgdmFyIGNvbnRleHRzUmVzdCA9IHZvaWQgMDtcbiAgdmFyIGNhbGxhYmxlc1Jlc3QgPSB2b2lkIDA7XG4gIHZhciBwb29sSW5kZXggPSB2b2lkIDA7XG4gIHZhciBpID0gdm9pZCAwO1xuICBpZiAobGVuZ3RoKSB7XG4gICAgcG9vbEluZGV4ID0gcG9vbFV0aWxpemF0aW9uLmxlbmd0aDtcbiAgICB3aGlsZSAocG9vbEluZGV4LS0gJiYgcG9vbFV0aWxpemF0aW9uW3Bvb2xJbmRleF0pIHt9XG4gICAgaWYgKHBvb2xJbmRleCA8IDApIHtcbiAgICAgIHBvb2xJbmRleCA9IHBvb2xVdGlsaXphdGlvbi5sZW5ndGg7XG4gICAgICBjb250ZXh0c1Jlc3QgPSBbXTtcbiAgICAgIGNhbGxhYmxlc1Jlc3QgPSBbXTtcbiAgICAgIHBvb2xVdGlsaXphdGlvbi5wdXNoKHRydWUpO1xuICAgICAgYXJyYXlQb29sMS5wdXNoKGNvbnRleHRzUmVzdCk7XG4gICAgICBhcnJheVBvb2wyLnB1c2goY2FsbGFibGVzUmVzdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBvb2xVdGlsaXphdGlvbltwb29sSW5kZXhdID0gdHJ1ZTtcbiAgICAgIGNvbnRleHRzUmVzdCA9IGFycmF5UG9vbDFbcG9vbEluZGV4XTtcbiAgICAgIGNhbGxhYmxlc1Jlc3QgPSBhcnJheVBvb2wyW3Bvb2xJbmRleF07XG4gICAgfVxuXG4gICAgaSA9IGxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICBjb250ZXh0c1Jlc3RbaV0gPSB0aGlzLl9jb250ZXh0c1Jlc3RbaV07XG4gICAgICBjYWxsYWJsZXNSZXN0W2ldID0gdGhpcy5fY2FsbGFibGVzUmVzdFtpXTtcbiAgICB9XG4gIH1cblxuICBpZiAoY29udGV4dDApIHtcbiAgICBpZiAoY2FsbGFibGUwKSB7XG4gICAgICBjYWxsYWJsZTAuY2FsbChjb250ZXh0MCwgbmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29udGV4dDAobmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgICB9XG4gIH1cbiAgaWYgKGNvbnRleHQxKSB7XG4gICAgaWYgKGNhbGxhYmxlMSkge1xuICAgICAgY2FsbGFibGUxLmNhbGwoY29udGV4dDEsIG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnRleHQxKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgfVxuICB9XG4gIGlmIChjb250ZXh0Mikge1xuICAgIGlmIChjYWxsYWJsZTIpIHtcbiAgICAgIGNhbGxhYmxlMi5jYWxsKGNvbnRleHQyLCBuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb250ZXh0MihuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgIH1cbiAgfVxuICBpZiAobGVuZ3RoKSB7XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgY2FsbGFibGUgPSBjYWxsYWJsZXNSZXN0W2ldO1xuICAgICAgdmFyIGNvbnRleHQgPSBjb250ZXh0c1Jlc3RbaV07XG4gICAgICBpZiAoY2FsbGFibGUpIHtcbiAgICAgICAgY2FsbGFibGUuY2FsbChjb250ZXh0LCBuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29udGV4dChuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgfVxuICAgICAgY29udGV4dHNSZXN0W2ldID0gbnVsbDtcbiAgICAgIGNhbGxhYmxlc1Jlc3RbaV0gPSBudWxsO1xuICAgIH1cbiAgICBwb29sVXRpbGl6YXRpb25bcG9vbEluZGV4XSA9IGZhbHNlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhc1N1YnNjcmliZXJzKCkge1xuICByZXR1cm4gISEodGhpcy5fY29udGV4dDAgfHwgdGhpcy5fY29udGV4dDEgfHwgdGhpcy5fY29udGV4dDIgfHwgdGhpcy5fY29udGV4dHNSZXN0ICYmIHRoaXMuX2NvbnRleHRzUmVzdC5sZW5ndGgpO1xufVxuXG5mdW5jdGlvbiBoYXNTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gIHZhciBoYXMgPSB0aGlzLl9jb250ZXh0MCA9PT0gY29udGV4dCAmJiB0aGlzLl9jYWxsYWJsZTAgPT09IGNhbGxhYmxlIHx8IHRoaXMuX2NvbnRleHQxID09PSBjb250ZXh0ICYmIHRoaXMuX2NhbGxhYmxlMSA9PT0gY2FsbGFibGUgfHwgdGhpcy5fY29udGV4dDIgPT09IGNvbnRleHQgJiYgdGhpcy5fY2FsbGFibGUyID09PSBjYWxsYWJsZTtcbiAgaWYgKGhhcykge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHZhciBpbmRleCA9IHZvaWQgMDtcbiAgdmFyIGNvbnRleHRzID0gdGhpcy5fY29udGV4dHNSZXN0O1xuICBpZiAoIWNvbnRleHRzIHx8IChpbmRleCA9IGNvbnRleHRzLmxlbmd0aCkgPT09IDApIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgdmFyIGNhbGxhYmxlcyA9IHRoaXMuX2NhbGxhYmxlc1Jlc3Q7XG4gIHdoaWxlIChpbmRleC0tKSB7XG4gICAgaWYgKGNvbnRleHRzW2luZGV4XSA9PT0gY29udGV4dCAmJiBjYWxsYWJsZXNbaW5kZXhdID09PSBjYWxsYWJsZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gc3Vic2NyaWJlckNvbGxlY3Rpb24oKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgdGFyZ2V0LnByb3RvdHlwZS5hZGRTdWJzY3JpYmVyID0gYWRkU3Vic2NyaWJlcjtcbiAgICB0YXJnZXQucHJvdG90eXBlLnJlbW92ZVN1YnNjcmliZXIgPSByZW1vdmVTdWJzY3JpYmVyO1xuICAgIHRhcmdldC5wcm90b3R5cGUuY2FsbFN1YnNjcmliZXJzID0gY2FsbFN1YnNjcmliZXJzO1xuICAgIHRhcmdldC5wcm90b3R5cGUuaGFzU3Vic2NyaWJlcnMgPSBoYXNTdWJzY3JpYmVycztcbiAgICB0YXJnZXQucHJvdG90eXBlLmhhc1N1YnNjcmliZXIgPSBoYXNTdWJzY3JpYmVyO1xuICB9O1xufVxuXG52YXIgRXhwcmVzc2lvbk9ic2VydmVyID0gZXhwb3J0cy5FeHByZXNzaW9uT2JzZXJ2ZXIgPSAoX2RlYyA9IGNvbm5lY3RhYmxlKCksIF9kZWMyID0gc3Vic2NyaWJlckNvbGxlY3Rpb24oKSwgX2RlYyhfY2xhc3MgPSBfZGVjMihfY2xhc3MgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEV4cHJlc3Npb25PYnNlcnZlcihzY29wZSwgZXhwcmVzc2lvbiwgb2JzZXJ2ZXJMb2NhdG9yLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICBcblxuICAgIHRoaXMuc2NvcGUgPSBzY29wZTtcbiAgICB0aGlzLmV4cHJlc3Npb24gPSBleHByZXNzaW9uO1xuICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xuICAgIHRoaXMubG9va3VwRnVuY3Rpb25zID0gbG9va3VwRnVuY3Rpb25zO1xuICB9XG5cbiAgRXhwcmVzc2lvbk9ic2VydmVyLnByb3RvdHlwZS5nZXRWYWx1ZSA9IGZ1bmN0aW9uIGdldFZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLmV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zY29wZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICB9O1xuXG4gIEV4cHJlc3Npb25PYnNlcnZlci5wcm90b3R5cGUuc2V0VmFsdWUgPSBmdW5jdGlvbiBzZXRWYWx1ZShuZXdWYWx1ZSkge1xuICAgIHRoaXMuZXhwcmVzc2lvbi5hc3NpZ24odGhpcy5zY29wZSwgbmV3VmFsdWUpO1xuICB9O1xuXG4gIEV4cHJlc3Npb25PYnNlcnZlci5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gc3Vic2NyaWJlKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIGlmICghdGhpcy5oYXNTdWJzY3JpYmVycygpKSB7XG4gICAgICB0aGlzLm9sZFZhbHVlID0gdGhpcy5leHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc2NvcGUsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICAgIHRoaXMuZXhwcmVzc2lvbi5jb25uZWN0KHRoaXMsIHRoaXMuc2NvcGUpO1xuICAgIH1cbiAgICB0aGlzLmFkZFN1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxICYmIGNvbnRleHQgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZGlzcG9zZTogZnVuY3Rpb24gZGlzcG9zZSgpIHtcbiAgICAgICAgICBfdGhpcy51bnN1YnNjcmliZShjb250ZXh0LCBjYWxsYWJsZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9O1xuXG4gIEV4cHJlc3Npb25PYnNlcnZlci5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiB1bnN1YnNjcmliZShjb250ZXh0LCBjYWxsYWJsZSkge1xuICAgIGlmICh0aGlzLnJlbW92ZVN1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpICYmICF0aGlzLmhhc1N1YnNjcmliZXJzKCkpIHtcbiAgICAgIHRoaXMudW5vYnNlcnZlKHRydWUpO1xuICAgICAgdGhpcy5vbGRWYWx1ZSA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH07XG5cbiAgRXhwcmVzc2lvbk9ic2VydmVyLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gY2FsbCgpIHtcbiAgICB2YXIgbmV3VmFsdWUgPSB0aGlzLmV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zY29wZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICAgIHZhciBvbGRWYWx1ZSA9IHRoaXMub2xkVmFsdWU7XG4gICAgaWYgKG5ld1ZhbHVlICE9PSBvbGRWYWx1ZSkge1xuICAgICAgdGhpcy5vbGRWYWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgdGhpcy5jYWxsU3Vic2NyaWJlcnMobmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgICB9XG4gICAgdGhpcy5fdmVyc2lvbisrO1xuICAgIHRoaXMuZXhwcmVzc2lvbi5jb25uZWN0KHRoaXMsIHRoaXMuc2NvcGUpO1xuICAgIHRoaXMudW5vYnNlcnZlKGZhbHNlKTtcbiAgfTtcblxuICByZXR1cm4gRXhwcmVzc2lvbk9ic2VydmVyO1xufSgpKSB8fCBfY2xhc3MpIHx8IF9jbGFzcyk7XG5cblxuZnVuY3Rpb24gaXNJbmRleChzKSB7XG4gIHJldHVybiArcyA9PT0gcyA+Pj4gMDtcbn1cblxuZnVuY3Rpb24gdG9OdW1iZXIocykge1xuICByZXR1cm4gK3M7XG59XG5cbmZ1bmN0aW9uIG5ld1NwbGljZShpbmRleCwgcmVtb3ZlZCwgYWRkZWRDb3VudCkge1xuICByZXR1cm4ge1xuICAgIGluZGV4OiBpbmRleCxcbiAgICByZW1vdmVkOiByZW1vdmVkLFxuICAgIGFkZGVkQ291bnQ6IGFkZGVkQ291bnRcbiAgfTtcbn1cblxudmFyIEVESVRfTEVBVkUgPSAwO1xudmFyIEVESVRfVVBEQVRFID0gMTtcbnZhciBFRElUX0FERCA9IDI7XG52YXIgRURJVF9ERUxFVEUgPSAzO1xuXG5mdW5jdGlvbiBBcnJheVNwbGljZSgpIHt9XG5cbkFycmF5U3BsaWNlLnByb3RvdHlwZSA9IHtcbiAgY2FsY0VkaXREaXN0YW5jZXM6IGZ1bmN0aW9uIGNhbGNFZGl0RGlzdGFuY2VzKGN1cnJlbnQsIGN1cnJlbnRTdGFydCwgY3VycmVudEVuZCwgb2xkLCBvbGRTdGFydCwgb2xkRW5kKSB7XG4gICAgdmFyIHJvd0NvdW50ID0gb2xkRW5kIC0gb2xkU3RhcnQgKyAxO1xuICAgIHZhciBjb2x1bW5Db3VudCA9IGN1cnJlbnRFbmQgLSBjdXJyZW50U3RhcnQgKyAxO1xuICAgIHZhciBkaXN0YW5jZXMgPSBuZXcgQXJyYXkocm93Q291bnQpO1xuICAgIHZhciBub3J0aCA9IHZvaWQgMDtcbiAgICB2YXIgd2VzdCA9IHZvaWQgMDtcblxuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCByb3dDb3VudDsgKytfaSkge1xuICAgICAgZGlzdGFuY2VzW19pXSA9IG5ldyBBcnJheShjb2x1bW5Db3VudCk7XG4gICAgICBkaXN0YW5jZXNbX2ldWzBdID0gX2k7XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBjb2x1bW5Db3VudDsgKytqKSB7XG4gICAgICBkaXN0YW5jZXNbMF1bal0gPSBqO1xuICAgIH1cblxuICAgIGZvciAodmFyIF9pMiA9IDE7IF9pMiA8IHJvd0NvdW50OyArK19pMikge1xuICAgICAgZm9yICh2YXIgX2ogPSAxOyBfaiA8IGNvbHVtbkNvdW50OyArK19qKSB7XG4gICAgICAgIGlmICh0aGlzLmVxdWFscyhjdXJyZW50W2N1cnJlbnRTdGFydCArIF9qIC0gMV0sIG9sZFtvbGRTdGFydCArIF9pMiAtIDFdKSkge1xuICAgICAgICAgIGRpc3RhbmNlc1tfaTJdW19qXSA9IGRpc3RhbmNlc1tfaTIgLSAxXVtfaiAtIDFdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5vcnRoID0gZGlzdGFuY2VzW19pMiAtIDFdW19qXSArIDE7XG4gICAgICAgICAgd2VzdCA9IGRpc3RhbmNlc1tfaTJdW19qIC0gMV0gKyAxO1xuICAgICAgICAgIGRpc3RhbmNlc1tfaTJdW19qXSA9IG5vcnRoIDwgd2VzdCA/IG5vcnRoIDogd2VzdDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBkaXN0YW5jZXM7XG4gIH0sXG5cbiAgc3BsaWNlT3BlcmF0aW9uc0Zyb21FZGl0RGlzdGFuY2VzOiBmdW5jdGlvbiBzcGxpY2VPcGVyYXRpb25zRnJvbUVkaXREaXN0YW5jZXMoZGlzdGFuY2VzKSB7XG4gICAgdmFyIGkgPSBkaXN0YW5jZXMubGVuZ3RoIC0gMTtcbiAgICB2YXIgaiA9IGRpc3RhbmNlc1swXS5sZW5ndGggLSAxO1xuICAgIHZhciBjdXJyZW50ID0gZGlzdGFuY2VzW2ldW2pdO1xuICAgIHZhciBlZGl0cyA9IFtdO1xuICAgIHdoaWxlIChpID4gMCB8fCBqID4gMCkge1xuICAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgZWRpdHMucHVzaChFRElUX0FERCk7XG4gICAgICAgIGotLTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBpZiAoaiA9PT0gMCkge1xuICAgICAgICBlZGl0cy5wdXNoKEVESVRfREVMRVRFKTtcbiAgICAgICAgaS0tO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIHZhciBub3J0aFdlc3QgPSBkaXN0YW5jZXNbaSAtIDFdW2ogLSAxXTtcbiAgICAgIHZhciB3ZXN0ID0gZGlzdGFuY2VzW2kgLSAxXVtqXTtcbiAgICAgIHZhciBub3J0aCA9IGRpc3RhbmNlc1tpXVtqIC0gMV07XG5cbiAgICAgIHZhciBtaW4gPSB2b2lkIDA7XG4gICAgICBpZiAod2VzdCA8IG5vcnRoKSB7XG4gICAgICAgIG1pbiA9IHdlc3QgPCBub3J0aFdlc3QgPyB3ZXN0IDogbm9ydGhXZXN0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbWluID0gbm9ydGggPCBub3J0aFdlc3QgPyBub3J0aCA6IG5vcnRoV2VzdDtcbiAgICAgIH1cblxuICAgICAgaWYgKG1pbiA9PT0gbm9ydGhXZXN0KSB7XG4gICAgICAgIGlmIChub3J0aFdlc3QgPT09IGN1cnJlbnQpIHtcbiAgICAgICAgICBlZGl0cy5wdXNoKEVESVRfTEVBVkUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVkaXRzLnB1c2goRURJVF9VUERBVEUpO1xuICAgICAgICAgIGN1cnJlbnQgPSBub3J0aFdlc3Q7XG4gICAgICAgIH1cbiAgICAgICAgaS0tO1xuICAgICAgICBqLS07XG4gICAgICB9IGVsc2UgaWYgKG1pbiA9PT0gd2VzdCkge1xuICAgICAgICBlZGl0cy5wdXNoKEVESVRfREVMRVRFKTtcbiAgICAgICAgaS0tO1xuICAgICAgICBjdXJyZW50ID0gd2VzdDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVkaXRzLnB1c2goRURJVF9BREQpO1xuICAgICAgICBqLS07XG4gICAgICAgIGN1cnJlbnQgPSBub3J0aDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBlZGl0cy5yZXZlcnNlKCk7XG4gICAgcmV0dXJuIGVkaXRzO1xuICB9LFxuXG4gIGNhbGNTcGxpY2VzOiBmdW5jdGlvbiBjYWxjU3BsaWNlcyhjdXJyZW50LCBjdXJyZW50U3RhcnQsIGN1cnJlbnRFbmQsIG9sZCwgb2xkU3RhcnQsIG9sZEVuZCkge1xuICAgIHZhciBwcmVmaXhDb3VudCA9IDA7XG4gICAgdmFyIHN1ZmZpeENvdW50ID0gMDtcblxuICAgIHZhciBtaW5MZW5ndGggPSBNYXRoLm1pbihjdXJyZW50RW5kIC0gY3VycmVudFN0YXJ0LCBvbGRFbmQgLSBvbGRTdGFydCk7XG4gICAgaWYgKGN1cnJlbnRTdGFydCA9PT0gMCAmJiBvbGRTdGFydCA9PT0gMCkge1xuICAgICAgcHJlZml4Q291bnQgPSB0aGlzLnNoYXJlZFByZWZpeChjdXJyZW50LCBvbGQsIG1pbkxlbmd0aCk7XG4gICAgfVxuXG4gICAgaWYgKGN1cnJlbnRFbmQgPT09IGN1cnJlbnQubGVuZ3RoICYmIG9sZEVuZCA9PT0gb2xkLmxlbmd0aCkge1xuICAgICAgc3VmZml4Q291bnQgPSB0aGlzLnNoYXJlZFN1ZmZpeChjdXJyZW50LCBvbGQsIG1pbkxlbmd0aCAtIHByZWZpeENvdW50KTtcbiAgICB9XG5cbiAgICBjdXJyZW50U3RhcnQgKz0gcHJlZml4Q291bnQ7XG4gICAgb2xkU3RhcnQgKz0gcHJlZml4Q291bnQ7XG4gICAgY3VycmVudEVuZCAtPSBzdWZmaXhDb3VudDtcbiAgICBvbGRFbmQgLT0gc3VmZml4Q291bnQ7XG5cbiAgICBpZiAoY3VycmVudEVuZCAtIGN1cnJlbnRTdGFydCA9PT0gMCAmJiBvbGRFbmQgLSBvbGRTdGFydCA9PT0gMCkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIGlmIChjdXJyZW50U3RhcnQgPT09IGN1cnJlbnRFbmQpIHtcbiAgICAgIHZhciBfc3BsaWNlID0gbmV3U3BsaWNlKGN1cnJlbnRTdGFydCwgW10sIDApO1xuICAgICAgd2hpbGUgKG9sZFN0YXJ0IDwgb2xkRW5kKSB7XG4gICAgICAgIF9zcGxpY2UucmVtb3ZlZC5wdXNoKG9sZFtvbGRTdGFydCsrXSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBbX3NwbGljZV07XG4gICAgfSBlbHNlIGlmIChvbGRTdGFydCA9PT0gb2xkRW5kKSB7XG4gICAgICByZXR1cm4gW25ld1NwbGljZShjdXJyZW50U3RhcnQsIFtdLCBjdXJyZW50RW5kIC0gY3VycmVudFN0YXJ0KV07XG4gICAgfVxuXG4gICAgdmFyIG9wcyA9IHRoaXMuc3BsaWNlT3BlcmF0aW9uc0Zyb21FZGl0RGlzdGFuY2VzKHRoaXMuY2FsY0VkaXREaXN0YW5jZXMoY3VycmVudCwgY3VycmVudFN0YXJ0LCBjdXJyZW50RW5kLCBvbGQsIG9sZFN0YXJ0LCBvbGRFbmQpKTtcblxuICAgIHZhciBzcGxpY2UgPSB1bmRlZmluZWQ7XG4gICAgdmFyIHNwbGljZXMgPSBbXTtcbiAgICB2YXIgaW5kZXggPSBjdXJyZW50U3RhcnQ7XG4gICAgdmFyIG9sZEluZGV4ID0gb2xkU3RhcnQ7XG4gICAgZm9yICh2YXIgX2kzID0gMDsgX2kzIDwgb3BzLmxlbmd0aDsgKytfaTMpIHtcbiAgICAgIHN3aXRjaCAob3BzW19pM10pIHtcbiAgICAgICAgY2FzZSBFRElUX0xFQVZFOlxuICAgICAgICAgIGlmIChzcGxpY2UpIHtcbiAgICAgICAgICAgIHNwbGljZXMucHVzaChzcGxpY2UpO1xuICAgICAgICAgICAgc3BsaWNlID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgb2xkSW5kZXgrKztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBFRElUX1VQREFURTpcbiAgICAgICAgICBpZiAoIXNwbGljZSkge1xuICAgICAgICAgICAgc3BsaWNlID0gbmV3U3BsaWNlKGluZGV4LCBbXSwgMCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgc3BsaWNlLmFkZGVkQ291bnQrKztcbiAgICAgICAgICBpbmRleCsrO1xuXG4gICAgICAgICAgc3BsaWNlLnJlbW92ZWQucHVzaChvbGRbb2xkSW5kZXhdKTtcbiAgICAgICAgICBvbGRJbmRleCsrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEVESVRfQUREOlxuICAgICAgICAgIGlmICghc3BsaWNlKSB7XG4gICAgICAgICAgICBzcGxpY2UgPSBuZXdTcGxpY2UoaW5kZXgsIFtdLCAwKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBzcGxpY2UuYWRkZWRDb3VudCsrO1xuICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgRURJVF9ERUxFVEU6XG4gICAgICAgICAgaWYgKCFzcGxpY2UpIHtcbiAgICAgICAgICAgIHNwbGljZSA9IG5ld1NwbGljZShpbmRleCwgW10sIDApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHNwbGljZS5yZW1vdmVkLnB1c2gob2xkW29sZEluZGV4XSk7XG4gICAgICAgICAgb2xkSW5kZXgrKztcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoc3BsaWNlKSB7XG4gICAgICBzcGxpY2VzLnB1c2goc3BsaWNlKTtcbiAgICB9XG4gICAgcmV0dXJuIHNwbGljZXM7XG4gIH0sXG5cbiAgc2hhcmVkUHJlZml4OiBmdW5jdGlvbiBzaGFyZWRQcmVmaXgoY3VycmVudCwgb2xkLCBzZWFyY2hMZW5ndGgpIHtcbiAgICBmb3IgKHZhciBfaTQgPSAwOyBfaTQgPCBzZWFyY2hMZW5ndGg7ICsrX2k0KSB7XG4gICAgICBpZiAoIXRoaXMuZXF1YWxzKGN1cnJlbnRbX2k0XSwgb2xkW19pNF0pKSB7XG4gICAgICAgIHJldHVybiBfaTQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHNlYXJjaExlbmd0aDtcbiAgfSxcblxuICBzaGFyZWRTdWZmaXg6IGZ1bmN0aW9uIHNoYXJlZFN1ZmZpeChjdXJyZW50LCBvbGQsIHNlYXJjaExlbmd0aCkge1xuICAgIHZhciBpbmRleDEgPSBjdXJyZW50Lmxlbmd0aDtcbiAgICB2YXIgaW5kZXgyID0gb2xkLmxlbmd0aDtcbiAgICB2YXIgY291bnQgPSAwO1xuICAgIHdoaWxlIChjb3VudCA8IHNlYXJjaExlbmd0aCAmJiB0aGlzLmVxdWFscyhjdXJyZW50Wy0taW5kZXgxXSwgb2xkWy0taW5kZXgyXSkpIHtcbiAgICAgIGNvdW50Kys7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvdW50O1xuICB9LFxuXG4gIGNhbGN1bGF0ZVNwbGljZXM6IGZ1bmN0aW9uIGNhbGN1bGF0ZVNwbGljZXMoY3VycmVudCwgcHJldmlvdXMpIHtcbiAgICByZXR1cm4gdGhpcy5jYWxjU3BsaWNlcyhjdXJyZW50LCAwLCBjdXJyZW50Lmxlbmd0aCwgcHJldmlvdXMsIDAsIHByZXZpb3VzLmxlbmd0aCk7XG4gIH0sXG5cbiAgZXF1YWxzOiBmdW5jdGlvbiBlcXVhbHMoY3VycmVudFZhbHVlLCBwcmV2aW91c1ZhbHVlKSB7XG4gICAgcmV0dXJuIGN1cnJlbnRWYWx1ZSA9PT0gcHJldmlvdXNWYWx1ZTtcbiAgfVxufTtcblxudmFyIGFycmF5U3BsaWNlID0gbmV3IEFycmF5U3BsaWNlKCk7XG5cbmZ1bmN0aW9uIGNhbGNTcGxpY2VzKGN1cnJlbnQsIGN1cnJlbnRTdGFydCwgY3VycmVudEVuZCwgb2xkLCBvbGRTdGFydCwgb2xkRW5kKSB7XG4gIHJldHVybiBhcnJheVNwbGljZS5jYWxjU3BsaWNlcyhjdXJyZW50LCBjdXJyZW50U3RhcnQsIGN1cnJlbnRFbmQsIG9sZCwgb2xkU3RhcnQsIG9sZEVuZCk7XG59XG5cbmZ1bmN0aW9uIGludGVyc2VjdChzdGFydDEsIGVuZDEsIHN0YXJ0MiwgZW5kMikge1xuICBpZiAoZW5kMSA8IHN0YXJ0MiB8fCBlbmQyIDwgc3RhcnQxKSB7XG4gICAgcmV0dXJuIC0xO1xuICB9XG5cbiAgaWYgKGVuZDEgPT09IHN0YXJ0MiB8fCBlbmQyID09PSBzdGFydDEpIHtcbiAgICByZXR1cm4gMDtcbiAgfVxuXG4gIGlmIChzdGFydDEgPCBzdGFydDIpIHtcbiAgICBpZiAoZW5kMSA8IGVuZDIpIHtcbiAgICAgIHJldHVybiBlbmQxIC0gc3RhcnQyO1xuICAgIH1cblxuICAgIHJldHVybiBlbmQyIC0gc3RhcnQyO1xuICB9XG5cbiAgaWYgKGVuZDIgPCBlbmQxKSB7XG4gICAgcmV0dXJuIGVuZDIgLSBzdGFydDE7XG4gIH1cblxuICByZXR1cm4gZW5kMSAtIHN0YXJ0MTtcbn1cblxuZnVuY3Rpb24gbWVyZ2VTcGxpY2Uoc3BsaWNlcywgaW5kZXgsIHJlbW92ZWQsIGFkZGVkQ291bnQpIHtcbiAgdmFyIHNwbGljZSA9IG5ld1NwbGljZShpbmRleCwgcmVtb3ZlZCwgYWRkZWRDb3VudCk7XG5cbiAgdmFyIGluc2VydGVkID0gZmFsc2U7XG4gIHZhciBpbnNlcnRpb25PZmZzZXQgPSAwO1xuXG4gIGZvciAodmFyIF9pNSA9IDA7IF9pNSA8IHNwbGljZXMubGVuZ3RoOyBfaTUrKykge1xuICAgIHZhciBjdXJyZW50ID0gc3BsaWNlc1tfaTVdO1xuICAgIGN1cnJlbnQuaW5kZXggKz0gaW5zZXJ0aW9uT2Zmc2V0O1xuXG4gICAgaWYgKGluc2VydGVkKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICB2YXIgaW50ZXJzZWN0Q291bnQgPSBpbnRlcnNlY3Qoc3BsaWNlLmluZGV4LCBzcGxpY2UuaW5kZXggKyBzcGxpY2UucmVtb3ZlZC5sZW5ndGgsIGN1cnJlbnQuaW5kZXgsIGN1cnJlbnQuaW5kZXggKyBjdXJyZW50LmFkZGVkQ291bnQpO1xuXG4gICAgaWYgKGludGVyc2VjdENvdW50ID49IDApIHtcblxuICAgICAgc3BsaWNlcy5zcGxpY2UoX2k1LCAxKTtcbiAgICAgIF9pNS0tO1xuXG4gICAgICBpbnNlcnRpb25PZmZzZXQgLT0gY3VycmVudC5hZGRlZENvdW50IC0gY3VycmVudC5yZW1vdmVkLmxlbmd0aDtcblxuICAgICAgc3BsaWNlLmFkZGVkQ291bnQgKz0gY3VycmVudC5hZGRlZENvdW50IC0gaW50ZXJzZWN0Q291bnQ7XG4gICAgICB2YXIgZGVsZXRlQ291bnQgPSBzcGxpY2UucmVtb3ZlZC5sZW5ndGggKyBjdXJyZW50LnJlbW92ZWQubGVuZ3RoIC0gaW50ZXJzZWN0Q291bnQ7XG5cbiAgICAgIGlmICghc3BsaWNlLmFkZGVkQ291bnQgJiYgIWRlbGV0ZUNvdW50KSB7XG4gICAgICAgIGluc2VydGVkID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBjdXJyZW50UmVtb3ZlZCA9IGN1cnJlbnQucmVtb3ZlZDtcblxuICAgICAgICBpZiAoc3BsaWNlLmluZGV4IDwgY3VycmVudC5pbmRleCkge1xuICAgICAgICAgIHZhciBwcmVwZW5kID0gc3BsaWNlLnJlbW92ZWQuc2xpY2UoMCwgY3VycmVudC5pbmRleCAtIHNwbGljZS5pbmRleCk7XG4gICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkocHJlcGVuZCwgY3VycmVudFJlbW92ZWQpO1xuICAgICAgICAgIGN1cnJlbnRSZW1vdmVkID0gcHJlcGVuZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzcGxpY2UuaW5kZXggKyBzcGxpY2UucmVtb3ZlZC5sZW5ndGggPiBjdXJyZW50LmluZGV4ICsgY3VycmVudC5hZGRlZENvdW50KSB7XG4gICAgICAgICAgdmFyIGFwcGVuZCA9IHNwbGljZS5yZW1vdmVkLnNsaWNlKGN1cnJlbnQuaW5kZXggKyBjdXJyZW50LmFkZGVkQ291bnQgLSBzcGxpY2UuaW5kZXgpO1xuICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KGN1cnJlbnRSZW1vdmVkLCBhcHBlbmQpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3BsaWNlLnJlbW92ZWQgPSBjdXJyZW50UmVtb3ZlZDtcbiAgICAgICAgaWYgKGN1cnJlbnQuaW5kZXggPCBzcGxpY2UuaW5kZXgpIHtcbiAgICAgICAgICBzcGxpY2UuaW5kZXggPSBjdXJyZW50LmluZGV4O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChzcGxpY2UuaW5kZXggPCBjdXJyZW50LmluZGV4KSB7XG5cbiAgICAgIGluc2VydGVkID0gdHJ1ZTtcblxuICAgICAgc3BsaWNlcy5zcGxpY2UoX2k1LCAwLCBzcGxpY2UpO1xuICAgICAgX2k1Kys7XG5cbiAgICAgIHZhciBvZmZzZXQgPSBzcGxpY2UuYWRkZWRDb3VudCAtIHNwbGljZS5yZW1vdmVkLmxlbmd0aDtcbiAgICAgIGN1cnJlbnQuaW5kZXggKz0gb2Zmc2V0O1xuICAgICAgaW5zZXJ0aW9uT2Zmc2V0ICs9IG9mZnNldDtcbiAgICB9XG4gIH1cblxuICBpZiAoIWluc2VydGVkKSB7XG4gICAgc3BsaWNlcy5wdXNoKHNwbGljZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlSW5pdGlhbFNwbGljZXMoYXJyYXksIGNoYW5nZVJlY29yZHMpIHtcbiAgdmFyIHNwbGljZXMgPSBbXTtcblxuICBmb3IgKHZhciBfaTYgPSAwOyBfaTYgPCBjaGFuZ2VSZWNvcmRzLmxlbmd0aDsgX2k2KyspIHtcbiAgICB2YXIgcmVjb3JkID0gY2hhbmdlUmVjb3Jkc1tfaTZdO1xuICAgIHN3aXRjaCAocmVjb3JkLnR5cGUpIHtcbiAgICAgIGNhc2UgJ3NwbGljZSc6XG4gICAgICAgIG1lcmdlU3BsaWNlKHNwbGljZXMsIHJlY29yZC5pbmRleCwgcmVjb3JkLnJlbW92ZWQuc2xpY2UoKSwgcmVjb3JkLmFkZGVkQ291bnQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICBjYXNlICd1cGRhdGUnOlxuICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgaWYgKCFpc0luZGV4KHJlY29yZC5uYW1lKSkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGluZGV4ID0gdG9OdW1iZXIocmVjb3JkLm5hbWUpO1xuICAgICAgICBpZiAoaW5kZXggPCAwKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBtZXJnZVNwbGljZShzcGxpY2VzLCBpbmRleCwgW3JlY29yZC5vbGRWYWx1ZV0sIHJlY29yZC50eXBlID09PSAnZGVsZXRlJyA/IDAgOiAxKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBjb25zb2xlLmVycm9yKCdVbmV4cGVjdGVkIHJlY29yZCB0eXBlOiAnICsgSlNPTi5zdHJpbmdpZnkocmVjb3JkKSk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBzcGxpY2VzO1xufVxuXG5mdW5jdGlvbiBwcm9qZWN0QXJyYXlTcGxpY2VzKGFycmF5LCBjaGFuZ2VSZWNvcmRzKSB7XG4gIHZhciBzcGxpY2VzID0gW107XG5cbiAgY3JlYXRlSW5pdGlhbFNwbGljZXMoYXJyYXksIGNoYW5nZVJlY29yZHMpLmZvckVhY2goZnVuY3Rpb24gKHNwbGljZSkge1xuICAgIGlmIChzcGxpY2UuYWRkZWRDb3VudCA9PT0gMSAmJiBzcGxpY2UucmVtb3ZlZC5sZW5ndGggPT09IDEpIHtcbiAgICAgIGlmIChzcGxpY2UucmVtb3ZlZFswXSAhPT0gYXJyYXlbc3BsaWNlLmluZGV4XSkge1xuICAgICAgICBzcGxpY2VzLnB1c2goc3BsaWNlKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHNwbGljZXMgPSBzcGxpY2VzLmNvbmNhdChjYWxjU3BsaWNlcyhhcnJheSwgc3BsaWNlLmluZGV4LCBzcGxpY2UuaW5kZXggKyBzcGxpY2UuYWRkZWRDb3VudCwgc3BsaWNlLnJlbW92ZWQsIDAsIHNwbGljZS5yZW1vdmVkLmxlbmd0aCkpO1xuICB9KTtcblxuICByZXR1cm4gc3BsaWNlcztcbn1cblxuZnVuY3Rpb24gbmV3UmVjb3JkKHR5cGUsIG9iamVjdCwga2V5LCBvbGRWYWx1ZSkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IHR5cGUsXG4gICAgb2JqZWN0OiBvYmplY3QsXG4gICAga2V5OiBrZXksXG4gICAgb2xkVmFsdWU6IG9sZFZhbHVlXG4gIH07XG59XG5cbmZ1bmN0aW9uIGdldENoYW5nZVJlY29yZHMobWFwKSB7XG4gIHZhciBlbnRyaWVzID0gbmV3IEFycmF5KG1hcC5zaXplKTtcbiAgdmFyIGtleXMgPSBtYXAua2V5cygpO1xuICB2YXIgaSA9IDA7XG4gIHZhciBpdGVtID0gdm9pZCAwO1xuXG4gIHdoaWxlIChpdGVtID0ga2V5cy5uZXh0KCkpIHtcbiAgICBpZiAoaXRlbS5kb25lKSB7XG4gICAgICBicmVhaztcbiAgICB9XG5cbiAgICBlbnRyaWVzW2ldID0gbmV3UmVjb3JkKCdhZGRlZCcsIG1hcCwgaXRlbS52YWx1ZSk7XG4gICAgaSsrO1xuICB9XG5cbiAgcmV0dXJuIGVudHJpZXM7XG59XG5cbnZhciBNb2RpZnlDb2xsZWN0aW9uT2JzZXJ2ZXIgPSBleHBvcnRzLk1vZGlmeUNvbGxlY3Rpb25PYnNlcnZlciA9IChfZGVjMyA9IHN1YnNjcmliZXJDb2xsZWN0aW9uKCksIF9kZWMzKF9jbGFzczIgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIE1vZGlmeUNvbGxlY3Rpb25PYnNlcnZlcih0YXNrUXVldWUsIGNvbGxlY3Rpb24pIHtcbiAgICBcblxuICAgIHRoaXMudGFza1F1ZXVlID0gdGFza1F1ZXVlO1xuICAgIHRoaXMucXVldWVkID0gZmFsc2U7XG4gICAgdGhpcy5jaGFuZ2VSZWNvcmRzID0gbnVsbDtcbiAgICB0aGlzLm9sZENvbGxlY3Rpb24gPSBudWxsO1xuICAgIHRoaXMuY29sbGVjdGlvbiA9IGNvbGxlY3Rpb247XG4gICAgdGhpcy5sZW5ndGhQcm9wZXJ0eU5hbWUgPSBjb2xsZWN0aW9uIGluc3RhbmNlb2YgTWFwIHx8IGNvbGxlY3Rpb24gaW5zdGFuY2VvZiBTZXQgPyAnc2l6ZScgOiAnbGVuZ3RoJztcbiAgfVxuXG4gIE1vZGlmeUNvbGxlY3Rpb25PYnNlcnZlci5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gc3Vic2NyaWJlKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gICAgdGhpcy5hZGRTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKTtcbiAgfTtcblxuICBNb2RpZnlDb2xsZWN0aW9uT2JzZXJ2ZXIucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gdW5zdWJzY3JpYmUoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgICB0aGlzLnJlbW92ZVN1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpO1xuICB9O1xuXG4gIE1vZGlmeUNvbGxlY3Rpb25PYnNlcnZlci5wcm90b3R5cGUuYWRkQ2hhbmdlUmVjb3JkID0gZnVuY3Rpb24gYWRkQ2hhbmdlUmVjb3JkKGNoYW5nZVJlY29yZCkge1xuICAgIGlmICghdGhpcy5oYXNTdWJzY3JpYmVycygpICYmICF0aGlzLmxlbmd0aE9ic2VydmVyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGNoYW5nZVJlY29yZC50eXBlID09PSAnc3BsaWNlJykge1xuICAgICAgdmFyIGluZGV4ID0gY2hhbmdlUmVjb3JkLmluZGV4O1xuICAgICAgdmFyIGFycmF5TGVuZ3RoID0gY2hhbmdlUmVjb3JkLm9iamVjdC5sZW5ndGg7XG4gICAgICBpZiAoaW5kZXggPiBhcnJheUxlbmd0aCkge1xuICAgICAgICBpbmRleCA9IGFycmF5TGVuZ3RoIC0gY2hhbmdlUmVjb3JkLmFkZGVkQ291bnQ7XG4gICAgICB9IGVsc2UgaWYgKGluZGV4IDwgMCkge1xuICAgICAgICBpbmRleCA9IGFycmF5TGVuZ3RoICsgY2hhbmdlUmVjb3JkLnJlbW92ZWQubGVuZ3RoICsgaW5kZXggLSBjaGFuZ2VSZWNvcmQuYWRkZWRDb3VudDtcbiAgICAgIH1cbiAgICAgIGlmIChpbmRleCA8IDApIHtcbiAgICAgICAgaW5kZXggPSAwO1xuICAgICAgfVxuICAgICAgY2hhbmdlUmVjb3JkLmluZGV4ID0gaW5kZXg7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY2hhbmdlUmVjb3JkcyA9PT0gbnVsbCkge1xuICAgICAgdGhpcy5jaGFuZ2VSZWNvcmRzID0gW2NoYW5nZVJlY29yZF07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY2hhbmdlUmVjb3Jkcy5wdXNoKGNoYW5nZVJlY29yZCk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLnF1ZXVlZCkge1xuICAgICAgdGhpcy5xdWV1ZWQgPSB0cnVlO1xuICAgICAgdGhpcy50YXNrUXVldWUucXVldWVNaWNyb1Rhc2sodGhpcyk7XG4gICAgfVxuICB9O1xuXG4gIE1vZGlmeUNvbGxlY3Rpb25PYnNlcnZlci5wcm90b3R5cGUuZmx1c2hDaGFuZ2VSZWNvcmRzID0gZnVuY3Rpb24gZmx1c2hDaGFuZ2VSZWNvcmRzKCkge1xuICAgIGlmICh0aGlzLmNoYW5nZVJlY29yZHMgJiYgdGhpcy5jaGFuZ2VSZWNvcmRzLmxlbmd0aCB8fCB0aGlzLm9sZENvbGxlY3Rpb24pIHtcbiAgICAgIHRoaXMuY2FsbCgpO1xuICAgIH1cbiAgfTtcblxuICBNb2RpZnlDb2xsZWN0aW9uT2JzZXJ2ZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gcmVzZXQob2xkQ29sbGVjdGlvbikge1xuICAgIHRoaXMub2xkQ29sbGVjdGlvbiA9IG9sZENvbGxlY3Rpb247XG5cbiAgICBpZiAodGhpcy5oYXNTdWJzY3JpYmVycygpICYmICF0aGlzLnF1ZXVlZCkge1xuICAgICAgdGhpcy5xdWV1ZWQgPSB0cnVlO1xuICAgICAgdGhpcy50YXNrUXVldWUucXVldWVNaWNyb1Rhc2sodGhpcyk7XG4gICAgfVxuICB9O1xuXG4gIE1vZGlmeUNvbGxlY3Rpb25PYnNlcnZlci5wcm90b3R5cGUuZ2V0TGVuZ3RoT2JzZXJ2ZXIgPSBmdW5jdGlvbiBnZXRMZW5ndGhPYnNlcnZlcigpIHtcbiAgICByZXR1cm4gdGhpcy5sZW5ndGhPYnNlcnZlciB8fCAodGhpcy5sZW5ndGhPYnNlcnZlciA9IG5ldyBDb2xsZWN0aW9uTGVuZ3RoT2JzZXJ2ZXIodGhpcy5jb2xsZWN0aW9uKSk7XG4gIH07XG5cbiAgTW9kaWZ5Q29sbGVjdGlvbk9ic2VydmVyLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gY2FsbCgpIHtcbiAgICB2YXIgY2hhbmdlUmVjb3JkcyA9IHRoaXMuY2hhbmdlUmVjb3JkcztcbiAgICB2YXIgb2xkQ29sbGVjdGlvbiA9IHRoaXMub2xkQ29sbGVjdGlvbjtcbiAgICB2YXIgcmVjb3JkcyA9IHZvaWQgMDtcblxuICAgIHRoaXMucXVldWVkID0gZmFsc2U7XG4gICAgdGhpcy5jaGFuZ2VSZWNvcmRzID0gW107XG4gICAgdGhpcy5vbGRDb2xsZWN0aW9uID0gbnVsbDtcblxuICAgIGlmICh0aGlzLmhhc1N1YnNjcmliZXJzKCkpIHtcbiAgICAgIGlmIChvbGRDb2xsZWN0aW9uKSB7XG4gICAgICAgIGlmICh0aGlzLmNvbGxlY3Rpb24gaW5zdGFuY2VvZiBNYXAgfHwgdGhpcy5jb2xsZWN0aW9uIGluc3RhbmNlb2YgU2V0KSB7XG4gICAgICAgICAgcmVjb3JkcyA9IGdldENoYW5nZVJlY29yZHMob2xkQ29sbGVjdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVjb3JkcyA9IGNhbGNTcGxpY2VzKHRoaXMuY29sbGVjdGlvbiwgMCwgdGhpcy5jb2xsZWN0aW9uLmxlbmd0aCwgb2xkQ29sbGVjdGlvbiwgMCwgb2xkQ29sbGVjdGlvbi5sZW5ndGgpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodGhpcy5jb2xsZWN0aW9uIGluc3RhbmNlb2YgTWFwIHx8IHRoaXMuY29sbGVjdGlvbiBpbnN0YW5jZW9mIFNldCkge1xuICAgICAgICAgIHJlY29yZHMgPSBjaGFuZ2VSZWNvcmRzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlY29yZHMgPSBwcm9qZWN0QXJyYXlTcGxpY2VzKHRoaXMuY29sbGVjdGlvbiwgY2hhbmdlUmVjb3Jkcyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGhpcy5jYWxsU3Vic2NyaWJlcnMocmVjb3Jkcyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMubGVuZ3RoT2JzZXJ2ZXIpIHtcbiAgICAgIHRoaXMubGVuZ3RoT2JzZXJ2ZXIuY2FsbCh0aGlzLmNvbGxlY3Rpb25bdGhpcy5sZW5ndGhQcm9wZXJ0eU5hbWVdKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIE1vZGlmeUNvbGxlY3Rpb25PYnNlcnZlcjtcbn0oKSkgfHwgX2NsYXNzMik7XG52YXIgQ29sbGVjdGlvbkxlbmd0aE9ic2VydmVyID0gZXhwb3J0cy5Db2xsZWN0aW9uTGVuZ3RoT2JzZXJ2ZXIgPSAoX2RlYzQgPSBzdWJzY3JpYmVyQ29sbGVjdGlvbigpLCBfZGVjNChfY2xhc3MzID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBDb2xsZWN0aW9uTGVuZ3RoT2JzZXJ2ZXIoY29sbGVjdGlvbikge1xuICAgIFxuXG4gICAgdGhpcy5jb2xsZWN0aW9uID0gY29sbGVjdGlvbjtcbiAgICB0aGlzLmxlbmd0aFByb3BlcnR5TmFtZSA9IGNvbGxlY3Rpb24gaW5zdGFuY2VvZiBNYXAgfHwgY29sbGVjdGlvbiBpbnN0YW5jZW9mIFNldCA/ICdzaXplJyA6ICdsZW5ndGgnO1xuICAgIHRoaXMuY3VycmVudFZhbHVlID0gY29sbGVjdGlvblt0aGlzLmxlbmd0aFByb3BlcnR5TmFtZV07XG4gIH1cblxuICBDb2xsZWN0aW9uTGVuZ3RoT2JzZXJ2ZXIucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gZ2V0VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29sbGVjdGlvblt0aGlzLmxlbmd0aFByb3BlcnR5TmFtZV07XG4gIH07XG5cbiAgQ29sbGVjdGlvbkxlbmd0aE9ic2VydmVyLnByb3RvdHlwZS5zZXRWYWx1ZSA9IGZ1bmN0aW9uIHNldFZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgdGhpcy5jb2xsZWN0aW9uW3RoaXMubGVuZ3RoUHJvcGVydHlOYW1lXSA9IG5ld1ZhbHVlO1xuICB9O1xuXG4gIENvbGxlY3Rpb25MZW5ndGhPYnNlcnZlci5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gc3Vic2NyaWJlKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gICAgdGhpcy5hZGRTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKTtcbiAgfTtcblxuICBDb2xsZWN0aW9uTGVuZ3RoT2JzZXJ2ZXIucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gdW5zdWJzY3JpYmUoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgICB0aGlzLnJlbW92ZVN1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpO1xuICB9O1xuXG4gIENvbGxlY3Rpb25MZW5ndGhPYnNlcnZlci5wcm90b3R5cGUuY2FsbCA9IGZ1bmN0aW9uIGNhbGwobmV3VmFsdWUpIHtcbiAgICB2YXIgb2xkVmFsdWUgPSB0aGlzLmN1cnJlbnRWYWx1ZTtcbiAgICB0aGlzLmNhbGxTdWJzY3JpYmVycyhuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgIHRoaXMuY3VycmVudFZhbHVlID0gbmV3VmFsdWU7XG4gIH07XG5cbiAgcmV0dXJuIENvbGxlY3Rpb25MZW5ndGhPYnNlcnZlcjtcbn0oKSkgfHwgX2NsYXNzMyk7XG5cbnZhciBwb3AgPSBBcnJheS5wcm90b3R5cGUucG9wO1xudmFyIHB1c2ggPSBBcnJheS5wcm90b3R5cGUucHVzaDtcbnZhciByZXZlcnNlID0gQXJyYXkucHJvdG90eXBlLnJldmVyc2U7XG52YXIgc2hpZnQgPSBBcnJheS5wcm90b3R5cGUuc2hpZnQ7XG52YXIgc29ydCA9IEFycmF5LnByb3RvdHlwZS5zb3J0O1xudmFyIHNwbGljZSA9IEFycmF5LnByb3RvdHlwZS5zcGxpY2U7XG52YXIgdW5zaGlmdCA9IEFycmF5LnByb3RvdHlwZS51bnNoaWZ0O1xuXG5BcnJheS5wcm90b3R5cGUucG9wID0gZnVuY3Rpb24gKCkge1xuICB2YXIgbm90RW1wdHkgPSB0aGlzLmxlbmd0aCA+IDA7XG4gIHZhciBtZXRob2RDYWxsUmVzdWx0ID0gcG9wLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIGlmIChub3RFbXB0eSAmJiB0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fX2FycmF5X29ic2VydmVyX18uYWRkQ2hhbmdlUmVjb3JkKHtcbiAgICAgIHR5cGU6ICdkZWxldGUnLFxuICAgICAgb2JqZWN0OiB0aGlzLFxuICAgICAgbmFtZTogdGhpcy5sZW5ndGgsXG4gICAgICBvbGRWYWx1ZTogbWV0aG9kQ2FsbFJlc3VsdFxuICAgIH0pO1xuICB9XG4gIHJldHVybiBtZXRob2RDYWxsUmVzdWx0O1xufTtcblxuQXJyYXkucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBtZXRob2RDYWxsUmVzdWx0ID0gcHVzaC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICBpZiAodGhpcy5fX2FycmF5X29ic2VydmVyX18gIT09IHVuZGVmaW5lZCkge1xuICAgIHRoaXMuX19hcnJheV9vYnNlcnZlcl9fLmFkZENoYW5nZVJlY29yZCh7XG4gICAgICB0eXBlOiAnc3BsaWNlJyxcbiAgICAgIG9iamVjdDogdGhpcyxcbiAgICAgIGluZGV4OiB0aGlzLmxlbmd0aCAtIGFyZ3VtZW50cy5sZW5ndGgsXG4gICAgICByZW1vdmVkOiBbXSxcbiAgICAgIGFkZGVkQ291bnQ6IGFyZ3VtZW50cy5sZW5ndGhcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gbWV0aG9kQ2FsbFJlc3VsdDtcbn07XG5cbkFycmF5LnByb3RvdHlwZS5yZXZlcnNlID0gZnVuY3Rpb24gKCkge1xuICB2YXIgb2xkQXJyYXkgPSB2b2lkIDA7XG4gIGlmICh0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fX2FycmF5X29ic2VydmVyX18uZmx1c2hDaGFuZ2VSZWNvcmRzKCk7XG4gICAgb2xkQXJyYXkgPSB0aGlzLnNsaWNlKCk7XG4gIH1cbiAgdmFyIG1ldGhvZENhbGxSZXN1bHQgPSByZXZlcnNlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIGlmICh0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fX2FycmF5X29ic2VydmVyX18ucmVzZXQob2xkQXJyYXkpO1xuICB9XG4gIHJldHVybiBtZXRob2RDYWxsUmVzdWx0O1xufTtcblxuQXJyYXkucHJvdG90eXBlLnNoaWZ0ID0gZnVuY3Rpb24gKCkge1xuICB2YXIgbm90RW1wdHkgPSB0aGlzLmxlbmd0aCA+IDA7XG4gIHZhciBtZXRob2RDYWxsUmVzdWx0ID0gc2hpZnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgaWYgKG5vdEVtcHR5ICYmIHRoaXMuX19hcnJheV9vYnNlcnZlcl9fICE9PSB1bmRlZmluZWQpIHtcbiAgICB0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXy5hZGRDaGFuZ2VSZWNvcmQoe1xuICAgICAgdHlwZTogJ2RlbGV0ZScsXG4gICAgICBvYmplY3Q6IHRoaXMsXG4gICAgICBuYW1lOiAwLFxuICAgICAgb2xkVmFsdWU6IG1ldGhvZENhbGxSZXN1bHRcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gbWV0aG9kQ2FsbFJlc3VsdDtcbn07XG5cbkFycmF5LnByb3RvdHlwZS5zb3J0ID0gZnVuY3Rpb24gKCkge1xuICB2YXIgb2xkQXJyYXkgPSB2b2lkIDA7XG4gIGlmICh0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fX2FycmF5X29ic2VydmVyX18uZmx1c2hDaGFuZ2VSZWNvcmRzKCk7XG4gICAgb2xkQXJyYXkgPSB0aGlzLnNsaWNlKCk7XG4gIH1cbiAgdmFyIG1ldGhvZENhbGxSZXN1bHQgPSBzb3J0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIGlmICh0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fX2FycmF5X29ic2VydmVyX18ucmVzZXQob2xkQXJyYXkpO1xuICB9XG4gIHJldHVybiBtZXRob2RDYWxsUmVzdWx0O1xufTtcblxuQXJyYXkucHJvdG90eXBlLnNwbGljZSA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIG1ldGhvZENhbGxSZXN1bHQgPSBzcGxpY2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgaWYgKHRoaXMuX19hcnJheV9vYnNlcnZlcl9fICE9PSB1bmRlZmluZWQpIHtcbiAgICB0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXy5hZGRDaGFuZ2VSZWNvcmQoe1xuICAgICAgdHlwZTogJ3NwbGljZScsXG4gICAgICBvYmplY3Q6IHRoaXMsXG4gICAgICBpbmRleDogYXJndW1lbnRzWzBdLFxuICAgICAgcmVtb3ZlZDogbWV0aG9kQ2FsbFJlc3VsdCxcbiAgICAgIGFkZGVkQ291bnQ6IGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzLmxlbmd0aCAtIDIgOiAwXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIG1ldGhvZENhbGxSZXN1bHQ7XG59O1xuXG5BcnJheS5wcm90b3R5cGUudW5zaGlmdCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIG1ldGhvZENhbGxSZXN1bHQgPSB1bnNoaWZ0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIGlmICh0aGlzLl9fYXJyYXlfb2JzZXJ2ZXJfXyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fX2FycmF5X29ic2VydmVyX18uYWRkQ2hhbmdlUmVjb3JkKHtcbiAgICAgIHR5cGU6ICdzcGxpY2UnLFxuICAgICAgb2JqZWN0OiB0aGlzLFxuICAgICAgaW5kZXg6IDAsXG4gICAgICByZW1vdmVkOiBbXSxcbiAgICAgIGFkZGVkQ291bnQ6IGFyZ3VtZW50cy5sZW5ndGhcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gbWV0aG9kQ2FsbFJlc3VsdDtcbn07XG5cbmZ1bmN0aW9uIF9nZXRBcnJheU9ic2VydmVyKHRhc2tRdWV1ZSwgYXJyYXkpIHtcbiAgcmV0dXJuIE1vZGlmeUFycmF5T2JzZXJ2ZXIuZm9yKHRhc2tRdWV1ZSwgYXJyYXkpO1xufVxuXG5leHBvcnRzLmdldEFycmF5T2JzZXJ2ZXIgPSBfZ2V0QXJyYXlPYnNlcnZlcjtcblxudmFyIE1vZGlmeUFycmF5T2JzZXJ2ZXIgPSBmdW5jdGlvbiAoX01vZGlmeUNvbGxlY3Rpb25PYnNlKSB7XG4gIF9pbmhlcml0cyhNb2RpZnlBcnJheU9ic2VydmVyLCBfTW9kaWZ5Q29sbGVjdGlvbk9ic2UpO1xuXG4gIGZ1bmN0aW9uIE1vZGlmeUFycmF5T2JzZXJ2ZXIodGFza1F1ZXVlLCBhcnJheSkge1xuICAgIFxuXG4gICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9Nb2RpZnlDb2xsZWN0aW9uT2JzZS5jYWxsKHRoaXMsIHRhc2tRdWV1ZSwgYXJyYXkpKTtcbiAgfVxuXG4gIE1vZGlmeUFycmF5T2JzZXJ2ZXIuZm9yID0gZnVuY3Rpb24gX2Zvcih0YXNrUXVldWUsIGFycmF5KSB7XG4gICAgaWYgKCEoJ19fYXJyYXlfb2JzZXJ2ZXJfXycgaW4gYXJyYXkpKSB7XG4gICAgICB2YXIgb2JzZXJ2ZXIgPSBNb2RpZnlBcnJheU9ic2VydmVyLmNyZWF0ZSh0YXNrUXVldWUsIGFycmF5KTtcbiAgICAgIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkoYXJyYXksICdfX2FycmF5X29ic2VydmVyX18nLCB7IHZhbHVlOiBvYnNlcnZlciwgZW51bWVyYWJsZTogZmFsc2UsIGNvbmZpZ3VyYWJsZTogZmFsc2UgfSk7XG4gICAgfVxuICAgIHJldHVybiBhcnJheS5fX2FycmF5X29ic2VydmVyX187XG4gIH07XG5cbiAgTW9kaWZ5QXJyYXlPYnNlcnZlci5jcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUodGFza1F1ZXVlLCBhcnJheSkge1xuICAgIHZhciBvYnNlcnZlciA9IG5ldyBNb2RpZnlBcnJheU9ic2VydmVyKHRhc2tRdWV1ZSwgYXJyYXkpO1xuICAgIHJldHVybiBvYnNlcnZlcjtcbiAgfTtcblxuICByZXR1cm4gTW9kaWZ5QXJyYXlPYnNlcnZlcjtcbn0oTW9kaWZ5Q29sbGVjdGlvbk9ic2VydmVyKTtcblxudmFyIEV4cHJlc3Npb24gPSBleHBvcnRzLkV4cHJlc3Npb24gPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEV4cHJlc3Npb24oKSB7XG4gICAgXG5cbiAgICB0aGlzLmlzQ2hhaW4gPSBmYWxzZTtcbiAgICB0aGlzLmlzQXNzaWduYWJsZSA9IGZhbHNlO1xuICB9XG5cbiAgRXhwcmVzc2lvbi5wcm90b3R5cGUuZXZhbHVhdGUgPSBmdW5jdGlvbiBldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zLCBhcmdzKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdCaW5kaW5nIGV4cHJlc3Npb24gXCInICsgdGhpcyArICdcIiBjYW5ub3QgYmUgZXZhbHVhdGVkLicpO1xuICB9O1xuXG4gIEV4cHJlc3Npb24ucHJvdG90eXBlLmFzc2lnbiA9IGZ1bmN0aW9uIGFzc2lnbihzY29wZSwgdmFsdWUsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHRocm93IG5ldyBFcnJvcignQmluZGluZyBleHByZXNzaW9uIFwiJyArIHRoaXMgKyAnXCIgY2Fubm90IGJlIGFzc2lnbmVkIHRvLicpO1xuICB9O1xuXG4gIEV4cHJlc3Npb24ucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIFVucGFyc2VyLnVucGFyc2UodGhpcyk7XG4gIH07XG5cbiAgcmV0dXJuIEV4cHJlc3Npb247XG59KCk7XG5cbnZhciBDaGFpbiA9IGV4cG9ydHMuQ2hhaW4gPSBmdW5jdGlvbiAoX0V4cHJlc3Npb24pIHtcbiAgX2luaGVyaXRzKENoYWluLCBfRXhwcmVzc2lvbik7XG5cbiAgZnVuY3Rpb24gQ2hhaW4oZXhwcmVzc2lvbnMpIHtcbiAgICBcblxuICAgIHZhciBfdGhpczMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfRXhwcmVzc2lvbi5jYWxsKHRoaXMpKTtcblxuICAgIF90aGlzMy5leHByZXNzaW9ucyA9IGV4cHJlc3Npb25zO1xuICAgIF90aGlzMy5pc0NoYWluID0gdHJ1ZTtcbiAgICByZXR1cm4gX3RoaXMzO1xuICB9XG5cbiAgQ2hhaW4ucHJvdG90eXBlLmV2YWx1YXRlID0gZnVuY3Rpb24gZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHZhciByZXN1bHQgPSB2b2lkIDA7XG4gICAgdmFyIGV4cHJlc3Npb25zID0gdGhpcy5leHByZXNzaW9ucztcbiAgICB2YXIgbGFzdCA9IHZvaWQgMDtcblxuICAgIGZvciAodmFyIF9pNyA9IDAsIGxlbmd0aCA9IGV4cHJlc3Npb25zLmxlbmd0aDsgX2k3IDwgbGVuZ3RoOyArK19pNykge1xuICAgICAgbGFzdCA9IGV4cHJlc3Npb25zW19pN10uZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucyk7XG5cbiAgICAgIGlmIChsYXN0ICE9PSBudWxsKSB7XG4gICAgICAgIHJlc3VsdCA9IGxhc3Q7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBDaGFpbi5wcm90b3R5cGUuYWNjZXB0ID0gZnVuY3Rpb24gYWNjZXB0KHZpc2l0b3IpIHtcbiAgICByZXR1cm4gdmlzaXRvci52aXNpdENoYWluKHRoaXMpO1xuICB9O1xuXG4gIHJldHVybiBDaGFpbjtcbn0oRXhwcmVzc2lvbik7XG5cbnZhciBCaW5kaW5nQmVoYXZpb3IgPSBleHBvcnRzLkJpbmRpbmdCZWhhdmlvciA9IGZ1bmN0aW9uIChfRXhwcmVzc2lvbjIpIHtcbiAgX2luaGVyaXRzKEJpbmRpbmdCZWhhdmlvciwgX0V4cHJlc3Npb24yKTtcblxuICBmdW5jdGlvbiBCaW5kaW5nQmVoYXZpb3IoZXhwcmVzc2lvbiwgbmFtZSwgYXJncykge1xuICAgIFxuXG4gICAgdmFyIF90aGlzNCA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9FeHByZXNzaW9uMi5jYWxsKHRoaXMpKTtcblxuICAgIF90aGlzNC5leHByZXNzaW9uID0gZXhwcmVzc2lvbjtcbiAgICBfdGhpczQubmFtZSA9IG5hbWU7XG4gICAgX3RoaXM0LmFyZ3MgPSBhcmdzO1xuICAgIHJldHVybiBfdGhpczQ7XG4gIH1cblxuICBCaW5kaW5nQmVoYXZpb3IucHJvdG90eXBlLmV2YWx1YXRlID0gZnVuY3Rpb24gZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHJldHVybiB0aGlzLmV4cHJlc3Npb24uZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gIH07XG5cbiAgQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS5hc3NpZ24gPSBmdW5jdGlvbiBhc3NpZ24oc2NvcGUsIHZhbHVlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICByZXR1cm4gdGhpcy5leHByZXNzaW9uLmFzc2lnbihzY29wZSwgdmFsdWUsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gIH07XG5cbiAgQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS5hY2NlcHQgPSBmdW5jdGlvbiBhY2NlcHQodmlzaXRvcikge1xuICAgIHJldHVybiB2aXNpdG9yLnZpc2l0QmluZGluZ0JlaGF2aW9yKHRoaXMpO1xuICB9O1xuXG4gIEJpbmRpbmdCZWhhdmlvci5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uIGNvbm5lY3QoYmluZGluZywgc2NvcGUpIHtcbiAgICB0aGlzLmV4cHJlc3Npb24uY29ubmVjdChiaW5kaW5nLCBzY29wZSk7XG4gIH07XG5cbiAgQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gYmluZChiaW5kaW5nLCBzY29wZSwgbG9va3VwRnVuY3Rpb25zKSB7XG4gICAgaWYgKHRoaXMuZXhwcmVzc2lvbi5leHByZXNzaW9uICYmIHRoaXMuZXhwcmVzc2lvbi5iaW5kKSB7XG4gICAgICB0aGlzLmV4cHJlc3Npb24uYmluZChiaW5kaW5nLCBzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgICB9XG4gICAgdmFyIGJlaGF2aW9yID0gbG9va3VwRnVuY3Rpb25zLmJpbmRpbmdCZWhhdmlvcnModGhpcy5uYW1lKTtcbiAgICBpZiAoIWJlaGF2aW9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIEJpbmRpbmdCZWhhdmlvciBuYW1lZCBcIicgKyB0aGlzLm5hbWUgKyAnXCIgd2FzIGZvdW5kIScpO1xuICAgIH1cbiAgICB2YXIgYmVoYXZpb3JLZXkgPSAnYmVoYXZpb3ItJyArIHRoaXMubmFtZTtcbiAgICBpZiAoYmluZGluZ1tiZWhhdmlvcktleV0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQSBiaW5kaW5nIGJlaGF2aW9yIG5hbWVkIFwiJyArIHRoaXMubmFtZSArICdcIiBoYXMgYWxyZWFkeSBiZWVuIGFwcGxpZWQgdG8gXCInICsgdGhpcy5leHByZXNzaW9uICsgJ1wiJyk7XG4gICAgfVxuICAgIGJpbmRpbmdbYmVoYXZpb3JLZXldID0gYmVoYXZpb3I7XG4gICAgYmVoYXZpb3IuYmluZC5hcHBseShiZWhhdmlvciwgW2JpbmRpbmcsIHNjb3BlXS5jb25jYXQoZXZhbExpc3Qoc2NvcGUsIHRoaXMuYXJncywgYmluZGluZy5sb29rdXBGdW5jdGlvbnMpKSk7XG4gIH07XG5cbiAgQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiB1bmJpbmQoYmluZGluZywgc2NvcGUpIHtcbiAgICB2YXIgYmVoYXZpb3JLZXkgPSAnYmVoYXZpb3ItJyArIHRoaXMubmFtZTtcbiAgICBiaW5kaW5nW2JlaGF2aW9yS2V5XS51bmJpbmQoYmluZGluZywgc2NvcGUpO1xuICAgIGJpbmRpbmdbYmVoYXZpb3JLZXldID0gbnVsbDtcbiAgICBpZiAodGhpcy5leHByZXNzaW9uLmV4cHJlc3Npb24gJiYgdGhpcy5leHByZXNzaW9uLnVuYmluZCkge1xuICAgICAgdGhpcy5leHByZXNzaW9uLnVuYmluZChiaW5kaW5nLCBzY29wZSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBCaW5kaW5nQmVoYXZpb3I7XG59KEV4cHJlc3Npb24pO1xuXG52YXIgVmFsdWVDb252ZXJ0ZXIgPSBleHBvcnRzLlZhbHVlQ29udmVydGVyID0gZnVuY3Rpb24gKF9FeHByZXNzaW9uMykge1xuICBfaW5oZXJpdHMoVmFsdWVDb252ZXJ0ZXIsIF9FeHByZXNzaW9uMyk7XG5cbiAgZnVuY3Rpb24gVmFsdWVDb252ZXJ0ZXIoZXhwcmVzc2lvbiwgbmFtZSwgYXJncywgYWxsQXJncykge1xuICAgIFxuXG4gICAgdmFyIF90aGlzNSA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9FeHByZXNzaW9uMy5jYWxsKHRoaXMpKTtcblxuICAgIF90aGlzNS5leHByZXNzaW9uID0gZXhwcmVzc2lvbjtcbiAgICBfdGhpczUubmFtZSA9IG5hbWU7XG4gICAgX3RoaXM1LmFyZ3MgPSBhcmdzO1xuICAgIF90aGlzNS5hbGxBcmdzID0gYWxsQXJncztcbiAgICByZXR1cm4gX3RoaXM1O1xuICB9XG5cbiAgVmFsdWVDb252ZXJ0ZXIucHJvdG90eXBlLmV2YWx1YXRlID0gZnVuY3Rpb24gZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHZhciBjb252ZXJ0ZXIgPSBsb29rdXBGdW5jdGlvbnMudmFsdWVDb252ZXJ0ZXJzKHRoaXMubmFtZSk7XG4gICAgaWYgKCFjb252ZXJ0ZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gVmFsdWVDb252ZXJ0ZXIgbmFtZWQgXCInICsgdGhpcy5uYW1lICsgJ1wiIHdhcyBmb3VuZCEnKTtcbiAgICB9XG5cbiAgICBpZiAoJ3RvVmlldycgaW4gY29udmVydGVyKSB7XG4gICAgICByZXR1cm4gY29udmVydGVyLnRvVmlldy5hcHBseShjb252ZXJ0ZXIsIGV2YWxMaXN0KHNjb3BlLCB0aGlzLmFsbEFyZ3MsIGxvb2t1cEZ1bmN0aW9ucykpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmFsbEFyZ3NbMF0uZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gIH07XG5cbiAgVmFsdWVDb252ZXJ0ZXIucHJvdG90eXBlLmFzc2lnbiA9IGZ1bmN0aW9uIGFzc2lnbihzY29wZSwgdmFsdWUsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHZhciBjb252ZXJ0ZXIgPSBsb29rdXBGdW5jdGlvbnMudmFsdWVDb252ZXJ0ZXJzKHRoaXMubmFtZSk7XG4gICAgaWYgKCFjb252ZXJ0ZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gVmFsdWVDb252ZXJ0ZXIgbmFtZWQgXCInICsgdGhpcy5uYW1lICsgJ1wiIHdhcyBmb3VuZCEnKTtcbiAgICB9XG5cbiAgICBpZiAoJ2Zyb21WaWV3JyBpbiBjb252ZXJ0ZXIpIHtcbiAgICAgIHZhbHVlID0gY29udmVydGVyLmZyb21WaWV3LmFwcGx5KGNvbnZlcnRlciwgW3ZhbHVlXS5jb25jYXQoZXZhbExpc3Qoc2NvcGUsIHRoaXMuYXJncywgbG9va3VwRnVuY3Rpb25zKSkpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmFsbEFyZ3NbMF0uYXNzaWduKHNjb3BlLCB2YWx1ZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgfTtcblxuICBWYWx1ZUNvbnZlcnRlci5wcm90b3R5cGUuYWNjZXB0ID0gZnVuY3Rpb24gYWNjZXB0KHZpc2l0b3IpIHtcbiAgICByZXR1cm4gdmlzaXRvci52aXNpdFZhbHVlQ29udmVydGVyKHRoaXMpO1xuICB9O1xuXG4gIFZhbHVlQ29udmVydGVyLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gY29ubmVjdChiaW5kaW5nLCBzY29wZSkge1xuICAgIHZhciBleHByZXNzaW9ucyA9IHRoaXMuYWxsQXJncztcbiAgICB2YXIgaSA9IGV4cHJlc3Npb25zLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICBleHByZXNzaW9uc1tpXS5jb25uZWN0KGJpbmRpbmcsIHNjb3BlKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIFZhbHVlQ29udmVydGVyO1xufShFeHByZXNzaW9uKTtcblxudmFyIEFzc2lnbiA9IGV4cG9ydHMuQXNzaWduID0gZnVuY3Rpb24gKF9FeHByZXNzaW9uNCkge1xuICBfaW5oZXJpdHMoQXNzaWduLCBfRXhwcmVzc2lvbjQpO1xuXG4gIGZ1bmN0aW9uIEFzc2lnbih0YXJnZXQsIHZhbHVlKSB7XG4gICAgXG5cbiAgICB2YXIgX3RoaXM2ID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX0V4cHJlc3Npb240LmNhbGwodGhpcykpO1xuXG4gICAgX3RoaXM2LnRhcmdldCA9IHRhcmdldDtcbiAgICBfdGhpczYudmFsdWUgPSB2YWx1ZTtcbiAgICByZXR1cm4gX3RoaXM2O1xuICB9XG5cbiAgQXNzaWduLnByb3RvdHlwZS5ldmFsdWF0ZSA9IGZ1bmN0aW9uIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICByZXR1cm4gdGhpcy50YXJnZXQuYXNzaWduKHNjb3BlLCB0aGlzLnZhbHVlLmV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpKTtcbiAgfTtcblxuICBBc3NpZ24ucHJvdG90eXBlLmFjY2VwdCA9IGZ1bmN0aW9uIGFjY2VwdCh2aXN0b3IpIHtcbiAgICB2aXN0b3IudmlzaXRBc3NpZ24odGhpcyk7XG4gIH07XG5cbiAgQXNzaWduLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gY29ubmVjdChiaW5kaW5nLCBzY29wZSkge307XG5cbiAgcmV0dXJuIEFzc2lnbjtcbn0oRXhwcmVzc2lvbik7XG5cbnZhciBDb25kaXRpb25hbCA9IGV4cG9ydHMuQ29uZGl0aW9uYWwgPSBmdW5jdGlvbiAoX0V4cHJlc3Npb241KSB7XG4gIF9pbmhlcml0cyhDb25kaXRpb25hbCwgX0V4cHJlc3Npb241KTtcblxuICBmdW5jdGlvbiBDb25kaXRpb25hbChjb25kaXRpb24sIHllcywgbm8pIHtcbiAgICBcblxuICAgIHZhciBfdGhpczcgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfRXhwcmVzc2lvbjUuY2FsbCh0aGlzKSk7XG5cbiAgICBfdGhpczcuY29uZGl0aW9uID0gY29uZGl0aW9uO1xuICAgIF90aGlzNy55ZXMgPSB5ZXM7XG4gICAgX3RoaXM3Lm5vID0gbm87XG4gICAgcmV0dXJuIF90aGlzNztcbiAgfVxuXG4gIENvbmRpdGlvbmFsLnByb3RvdHlwZS5ldmFsdWF0ZSA9IGZ1bmN0aW9uIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICByZXR1cm4gISF0aGlzLmNvbmRpdGlvbi5ldmFsdWF0ZShzY29wZSkgPyB0aGlzLnllcy5ldmFsdWF0ZShzY29wZSkgOiB0aGlzLm5vLmV2YWx1YXRlKHNjb3BlKTtcbiAgfTtcblxuICBDb25kaXRpb25hbC5wcm90b3R5cGUuYWNjZXB0ID0gZnVuY3Rpb24gYWNjZXB0KHZpc2l0b3IpIHtcbiAgICByZXR1cm4gdmlzaXRvci52aXNpdENvbmRpdGlvbmFsKHRoaXMpO1xuICB9O1xuXG4gIENvbmRpdGlvbmFsLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gY29ubmVjdChiaW5kaW5nLCBzY29wZSkge1xuICAgIHRoaXMuY29uZGl0aW9uLmNvbm5lY3QoYmluZGluZywgc2NvcGUpO1xuICAgIGlmICh0aGlzLmNvbmRpdGlvbi5ldmFsdWF0ZShzY29wZSkpIHtcbiAgICAgIHRoaXMueWVzLmNvbm5lY3QoYmluZGluZywgc2NvcGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm5vLmNvbm5lY3QoYmluZGluZywgc2NvcGUpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gQ29uZGl0aW9uYWw7XG59KEV4cHJlc3Npb24pO1xuXG52YXIgQWNjZXNzVGhpcyA9IGV4cG9ydHMuQWNjZXNzVGhpcyA9IGZ1bmN0aW9uIChfRXhwcmVzc2lvbjYpIHtcbiAgX2luaGVyaXRzKEFjY2Vzc1RoaXMsIF9FeHByZXNzaW9uNik7XG5cbiAgZnVuY3Rpb24gQWNjZXNzVGhpcyhhbmNlc3Rvcikge1xuICAgIFxuXG4gICAgdmFyIF90aGlzOCA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9FeHByZXNzaW9uNi5jYWxsKHRoaXMpKTtcblxuICAgIF90aGlzOC5hbmNlc3RvciA9IGFuY2VzdG9yO1xuICAgIHJldHVybiBfdGhpczg7XG4gIH1cblxuICBBY2Nlc3NUaGlzLnByb3RvdHlwZS5ldmFsdWF0ZSA9IGZ1bmN0aW9uIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICB2YXIgb2MgPSBzY29wZS5vdmVycmlkZUNvbnRleHQ7XG4gICAgdmFyIGkgPSB0aGlzLmFuY2VzdG9yO1xuICAgIHdoaWxlIChpLS0gJiYgb2MpIHtcbiAgICAgIG9jID0gb2MucGFyZW50T3ZlcnJpZGVDb250ZXh0O1xuICAgIH1cbiAgICByZXR1cm4gaSA8IDEgJiYgb2MgPyBvYy5iaW5kaW5nQ29udGV4dCA6IHVuZGVmaW5lZDtcbiAgfTtcblxuICBBY2Nlc3NUaGlzLnByb3RvdHlwZS5hY2NlcHQgPSBmdW5jdGlvbiBhY2NlcHQodmlzaXRvcikge1xuICAgIHJldHVybiB2aXNpdG9yLnZpc2l0QWNjZXNzVGhpcyh0aGlzKTtcbiAgfTtcblxuICBBY2Nlc3NUaGlzLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gY29ubmVjdChiaW5kaW5nLCBzY29wZSkge307XG5cbiAgcmV0dXJuIEFjY2Vzc1RoaXM7XG59KEV4cHJlc3Npb24pO1xuXG52YXIgQWNjZXNzU2NvcGUgPSBleHBvcnRzLkFjY2Vzc1Njb3BlID0gZnVuY3Rpb24gKF9FeHByZXNzaW9uNykge1xuICBfaW5oZXJpdHMoQWNjZXNzU2NvcGUsIF9FeHByZXNzaW9uNyk7XG5cbiAgZnVuY3Rpb24gQWNjZXNzU2NvcGUobmFtZSwgYW5jZXN0b3IpIHtcbiAgICBcblxuICAgIHZhciBfdGhpczkgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfRXhwcmVzc2lvbjcuY2FsbCh0aGlzKSk7XG5cbiAgICBfdGhpczkubmFtZSA9IG5hbWU7XG4gICAgX3RoaXM5LmFuY2VzdG9yID0gYW5jZXN0b3I7XG4gICAgX3RoaXM5LmlzQXNzaWduYWJsZSA9IHRydWU7XG4gICAgcmV0dXJuIF90aGlzOTtcbiAgfVxuXG4gIEFjY2Vzc1Njb3BlLnByb3RvdHlwZS5ldmFsdWF0ZSA9IGZ1bmN0aW9uIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICB2YXIgY29udGV4dCA9IGdldENvbnRleHRGb3IodGhpcy5uYW1lLCBzY29wZSwgdGhpcy5hbmNlc3Rvcik7XG4gICAgcmV0dXJuIGNvbnRleHRbdGhpcy5uYW1lXTtcbiAgfTtcblxuICBBY2Nlc3NTY29wZS5wcm90b3R5cGUuYXNzaWduID0gZnVuY3Rpb24gYXNzaWduKHNjb3BlLCB2YWx1ZSkge1xuICAgIHZhciBjb250ZXh0ID0gZ2V0Q29udGV4dEZvcih0aGlzLm5hbWUsIHNjb3BlLCB0aGlzLmFuY2VzdG9yKTtcbiAgICByZXR1cm4gY29udGV4dCA/IGNvbnRleHRbdGhpcy5uYW1lXSA9IHZhbHVlIDogdW5kZWZpbmVkO1xuICB9O1xuXG4gIEFjY2Vzc1Njb3BlLnByb3RvdHlwZS5hY2NlcHQgPSBmdW5jdGlvbiBhY2NlcHQodmlzaXRvcikge1xuICAgIHJldHVybiB2aXNpdG9yLnZpc2l0QWNjZXNzU2NvcGUodGhpcyk7XG4gIH07XG5cbiAgQWNjZXNzU2NvcGUucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbiBjb25uZWN0KGJpbmRpbmcsIHNjb3BlKSB7XG4gICAgdmFyIGNvbnRleHQgPSBnZXRDb250ZXh0Rm9yKHRoaXMubmFtZSwgc2NvcGUsIHRoaXMuYW5jZXN0b3IpO1xuICAgIGJpbmRpbmcub2JzZXJ2ZVByb3BlcnR5KGNvbnRleHQsIHRoaXMubmFtZSk7XG4gIH07XG5cbiAgcmV0dXJuIEFjY2Vzc1Njb3BlO1xufShFeHByZXNzaW9uKTtcblxudmFyIEFjY2Vzc01lbWJlciA9IGV4cG9ydHMuQWNjZXNzTWVtYmVyID0gZnVuY3Rpb24gKF9FeHByZXNzaW9uOCkge1xuICBfaW5oZXJpdHMoQWNjZXNzTWVtYmVyLCBfRXhwcmVzc2lvbjgpO1xuXG4gIGZ1bmN0aW9uIEFjY2Vzc01lbWJlcihvYmplY3QsIG5hbWUpIHtcbiAgICBcblxuICAgIHZhciBfdGhpczEwID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX0V4cHJlc3Npb244LmNhbGwodGhpcykpO1xuXG4gICAgX3RoaXMxMC5vYmplY3QgPSBvYmplY3Q7XG4gICAgX3RoaXMxMC5uYW1lID0gbmFtZTtcbiAgICBfdGhpczEwLmlzQXNzaWduYWJsZSA9IHRydWU7XG4gICAgcmV0dXJuIF90aGlzMTA7XG4gIH1cblxuICBBY2Nlc3NNZW1iZXIucHJvdG90eXBlLmV2YWx1YXRlID0gZnVuY3Rpb24gZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHZhciBpbnN0YW5jZSA9IHRoaXMub2JqZWN0LmV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpO1xuICAgIHJldHVybiBpbnN0YW5jZSA9PT0gbnVsbCB8fCBpbnN0YW5jZSA9PT0gdW5kZWZpbmVkID8gaW5zdGFuY2UgOiBpbnN0YW5jZVt0aGlzLm5hbWVdO1xuICB9O1xuXG4gIEFjY2Vzc01lbWJlci5wcm90b3R5cGUuYXNzaWduID0gZnVuY3Rpb24gYXNzaWduKHNjb3BlLCB2YWx1ZSkge1xuICAgIHZhciBpbnN0YW5jZSA9IHRoaXMub2JqZWN0LmV2YWx1YXRlKHNjb3BlKTtcblxuICAgIGlmIChpbnN0YW5jZSA9PT0gbnVsbCB8fCBpbnN0YW5jZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBpbnN0YW5jZSA9IHt9O1xuICAgICAgdGhpcy5vYmplY3QuYXNzaWduKHNjb3BlLCBpbnN0YW5jZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGluc3RhbmNlW3RoaXMubmFtZV0gPSB2YWx1ZTtcbiAgfTtcblxuICBBY2Nlc3NNZW1iZXIucHJvdG90eXBlLmFjY2VwdCA9IGZ1bmN0aW9uIGFjY2VwdCh2aXNpdG9yKSB7XG4gICAgcmV0dXJuIHZpc2l0b3IudmlzaXRBY2Nlc3NNZW1iZXIodGhpcyk7XG4gIH07XG5cbiAgQWNjZXNzTWVtYmVyLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gY29ubmVjdChiaW5kaW5nLCBzY29wZSkge1xuICAgIHRoaXMub2JqZWN0LmNvbm5lY3QoYmluZGluZywgc2NvcGUpO1xuICAgIHZhciBvYmogPSB0aGlzLm9iamVjdC5ldmFsdWF0ZShzY29wZSk7XG4gICAgaWYgKG9iaikge1xuICAgICAgYmluZGluZy5vYnNlcnZlUHJvcGVydHkob2JqLCB0aGlzLm5hbWUpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gQWNjZXNzTWVtYmVyO1xufShFeHByZXNzaW9uKTtcblxudmFyIEFjY2Vzc0tleWVkID0gZXhwb3J0cy5BY2Nlc3NLZXllZCA9IGZ1bmN0aW9uIChfRXhwcmVzc2lvbjkpIHtcbiAgX2luaGVyaXRzKEFjY2Vzc0tleWVkLCBfRXhwcmVzc2lvbjkpO1xuXG4gIGZ1bmN0aW9uIEFjY2Vzc0tleWVkKG9iamVjdCwga2V5KSB7XG4gICAgXG5cbiAgICB2YXIgX3RoaXMxMSA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9FeHByZXNzaW9uOS5jYWxsKHRoaXMpKTtcblxuICAgIF90aGlzMTEub2JqZWN0ID0gb2JqZWN0O1xuICAgIF90aGlzMTEua2V5ID0ga2V5O1xuICAgIF90aGlzMTEuaXNBc3NpZ25hYmxlID0gdHJ1ZTtcbiAgICByZXR1cm4gX3RoaXMxMTtcbiAgfVxuXG4gIEFjY2Vzc0tleWVkLnByb3RvdHlwZS5ldmFsdWF0ZSA9IGZ1bmN0aW9uIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICB2YXIgaW5zdGFuY2UgPSB0aGlzLm9iamVjdC5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgICB2YXIgbG9va3VwID0gdGhpcy5rZXkuZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgcmV0dXJuIGdldEtleWVkKGluc3RhbmNlLCBsb29rdXApO1xuICB9O1xuXG4gIEFjY2Vzc0tleWVkLnByb3RvdHlwZS5hc3NpZ24gPSBmdW5jdGlvbiBhc3NpZ24oc2NvcGUsIHZhbHVlKSB7XG4gICAgdmFyIGluc3RhbmNlID0gdGhpcy5vYmplY3QuZXZhbHVhdGUoc2NvcGUpO1xuICAgIHZhciBsb29rdXAgPSB0aGlzLmtleS5ldmFsdWF0ZShzY29wZSk7XG4gICAgcmV0dXJuIHNldEtleWVkKGluc3RhbmNlLCBsb29rdXAsIHZhbHVlKTtcbiAgfTtcblxuICBBY2Nlc3NLZXllZC5wcm90b3R5cGUuYWNjZXB0ID0gZnVuY3Rpb24gYWNjZXB0KHZpc2l0b3IpIHtcbiAgICByZXR1cm4gdmlzaXRvci52aXNpdEFjY2Vzc0tleWVkKHRoaXMpO1xuICB9O1xuXG4gIEFjY2Vzc0tleWVkLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gY29ubmVjdChiaW5kaW5nLCBzY29wZSkge1xuICAgIHRoaXMub2JqZWN0LmNvbm5lY3QoYmluZGluZywgc2NvcGUpO1xuICAgIHZhciBvYmogPSB0aGlzLm9iamVjdC5ldmFsdWF0ZShzY29wZSk7XG4gICAgaWYgKG9iaiBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgICAgdGhpcy5rZXkuY29ubmVjdChiaW5kaW5nLCBzY29wZSk7XG4gICAgICB2YXIga2V5ID0gdGhpcy5rZXkuZXZhbHVhdGUoc2NvcGUpO1xuXG4gICAgICBpZiAoa2V5ICE9PSBudWxsICYmIGtleSAhPT0gdW5kZWZpbmVkICYmICEoQXJyYXkuaXNBcnJheShvYmopICYmIHR5cGVvZiBrZXkgPT09ICdudW1iZXInKSkge1xuICAgICAgICBiaW5kaW5nLm9ic2VydmVQcm9wZXJ0eShvYmosIGtleSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBBY2Nlc3NLZXllZDtcbn0oRXhwcmVzc2lvbik7XG5cbnZhciBDYWxsU2NvcGUgPSBleHBvcnRzLkNhbGxTY29wZSA9IGZ1bmN0aW9uIChfRXhwcmVzc2lvbjEwKSB7XG4gIF9pbmhlcml0cyhDYWxsU2NvcGUsIF9FeHByZXNzaW9uMTApO1xuXG4gIGZ1bmN0aW9uIENhbGxTY29wZShuYW1lLCBhcmdzLCBhbmNlc3Rvcikge1xuICAgIFxuXG4gICAgdmFyIF90aGlzMTIgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfRXhwcmVzc2lvbjEwLmNhbGwodGhpcykpO1xuXG4gICAgX3RoaXMxMi5uYW1lID0gbmFtZTtcbiAgICBfdGhpczEyLmFyZ3MgPSBhcmdzO1xuICAgIF90aGlzMTIuYW5jZXN0b3IgPSBhbmNlc3RvcjtcbiAgICByZXR1cm4gX3RoaXMxMjtcbiAgfVxuXG4gIENhbGxTY29wZS5wcm90b3R5cGUuZXZhbHVhdGUgPSBmdW5jdGlvbiBldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zLCBtdXN0RXZhbHVhdGUpIHtcbiAgICB2YXIgYXJncyA9IGV2YWxMaXN0KHNjb3BlLCB0aGlzLmFyZ3MsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgdmFyIGNvbnRleHQgPSBnZXRDb250ZXh0Rm9yKHRoaXMubmFtZSwgc2NvcGUsIHRoaXMuYW5jZXN0b3IpO1xuICAgIHZhciBmdW5jID0gZ2V0RnVuY3Rpb24oY29udGV4dCwgdGhpcy5uYW1lLCBtdXN0RXZhbHVhdGUpO1xuICAgIGlmIChmdW5jKSB7XG4gICAgICByZXR1cm4gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfTtcblxuICBDYWxsU2NvcGUucHJvdG90eXBlLmFjY2VwdCA9IGZ1bmN0aW9uIGFjY2VwdCh2aXNpdG9yKSB7XG4gICAgcmV0dXJuIHZpc2l0b3IudmlzaXRDYWxsU2NvcGUodGhpcyk7XG4gIH07XG5cbiAgQ2FsbFNjb3BlLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gY29ubmVjdChiaW5kaW5nLCBzY29wZSkge1xuICAgIHZhciBhcmdzID0gdGhpcy5hcmdzO1xuICAgIHZhciBpID0gYXJncy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgYXJnc1tpXS5jb25uZWN0KGJpbmRpbmcsIHNjb3BlKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIENhbGxTY29wZTtcbn0oRXhwcmVzc2lvbik7XG5cbnZhciBDYWxsTWVtYmVyID0gZXhwb3J0cy5DYWxsTWVtYmVyID0gZnVuY3Rpb24gKF9FeHByZXNzaW9uMTEpIHtcbiAgX2luaGVyaXRzKENhbGxNZW1iZXIsIF9FeHByZXNzaW9uMTEpO1xuXG4gIGZ1bmN0aW9uIENhbGxNZW1iZXIob2JqZWN0LCBuYW1lLCBhcmdzKSB7XG4gICAgXG5cbiAgICB2YXIgX3RoaXMxMyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9FeHByZXNzaW9uMTEuY2FsbCh0aGlzKSk7XG5cbiAgICBfdGhpczEzLm9iamVjdCA9IG9iamVjdDtcbiAgICBfdGhpczEzLm5hbWUgPSBuYW1lO1xuICAgIF90aGlzMTMuYXJncyA9IGFyZ3M7XG4gICAgcmV0dXJuIF90aGlzMTM7XG4gIH1cblxuICBDYWxsTWVtYmVyLnByb3RvdHlwZS5ldmFsdWF0ZSA9IGZ1bmN0aW9uIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMsIG11c3RFdmFsdWF0ZSkge1xuICAgIHZhciBpbnN0YW5jZSA9IHRoaXMub2JqZWN0LmV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpO1xuICAgIHZhciBhcmdzID0gZXZhbExpc3Qoc2NvcGUsIHRoaXMuYXJncywgbG9va3VwRnVuY3Rpb25zKTtcbiAgICB2YXIgZnVuYyA9IGdldEZ1bmN0aW9uKGluc3RhbmNlLCB0aGlzLm5hbWUsIG11c3RFdmFsdWF0ZSk7XG4gICAgaWYgKGZ1bmMpIHtcbiAgICAgIHJldHVybiBmdW5jLmFwcGx5KGluc3RhbmNlLCBhcmdzKTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfTtcblxuICBDYWxsTWVtYmVyLnByb3RvdHlwZS5hY2NlcHQgPSBmdW5jdGlvbiBhY2NlcHQodmlzaXRvcikge1xuICAgIHJldHVybiB2aXNpdG9yLnZpc2l0Q2FsbE1lbWJlcih0aGlzKTtcbiAgfTtcblxuICBDYWxsTWVtYmVyLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gY29ubmVjdChiaW5kaW5nLCBzY29wZSkge1xuICAgIHRoaXMub2JqZWN0LmNvbm5lY3QoYmluZGluZywgc2NvcGUpO1xuICAgIHZhciBvYmogPSB0aGlzLm9iamVjdC5ldmFsdWF0ZShzY29wZSk7XG4gICAgaWYgKGdldEZ1bmN0aW9uKG9iaiwgdGhpcy5uYW1lLCBmYWxzZSkpIHtcbiAgICAgIHZhciBhcmdzID0gdGhpcy5hcmdzO1xuICAgICAgdmFyIF9pOCA9IGFyZ3MubGVuZ3RoO1xuICAgICAgd2hpbGUgKF9pOC0tKSB7XG4gICAgICAgIGFyZ3NbX2k4XS5jb25uZWN0KGJpbmRpbmcsIHNjb3BlKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIENhbGxNZW1iZXI7XG59KEV4cHJlc3Npb24pO1xuXG52YXIgQ2FsbEZ1bmN0aW9uID0gZXhwb3J0cy5DYWxsRnVuY3Rpb24gPSBmdW5jdGlvbiAoX0V4cHJlc3Npb24xMikge1xuICBfaW5oZXJpdHMoQ2FsbEZ1bmN0aW9uLCBfRXhwcmVzc2lvbjEyKTtcblxuICBmdW5jdGlvbiBDYWxsRnVuY3Rpb24oZnVuYywgYXJncykge1xuICAgIFxuXG4gICAgdmFyIF90aGlzMTQgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfRXhwcmVzc2lvbjEyLmNhbGwodGhpcykpO1xuXG4gICAgX3RoaXMxNC5mdW5jID0gZnVuYztcbiAgICBfdGhpczE0LmFyZ3MgPSBhcmdzO1xuICAgIHJldHVybiBfdGhpczE0O1xuICB9XG5cbiAgQ2FsbEZ1bmN0aW9uLnByb3RvdHlwZS5ldmFsdWF0ZSA9IGZ1bmN0aW9uIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMsIG11c3RFdmFsdWF0ZSkge1xuICAgIHZhciBmdW5jID0gdGhpcy5mdW5jLmV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpO1xuICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkobnVsbCwgZXZhbExpc3Qoc2NvcGUsIHRoaXMuYXJncywgbG9va3VwRnVuY3Rpb25zKSk7XG4gICAgfVxuICAgIGlmICghbXVzdEV2YWx1YXRlICYmIChmdW5jID09PSBudWxsIHx8IGZ1bmMgPT09IHVuZGVmaW5lZCkpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcih0aGlzLmZ1bmMgKyAnIGlzIG5vdCBhIGZ1bmN0aW9uJyk7XG4gIH07XG5cbiAgQ2FsbEZ1bmN0aW9uLnByb3RvdHlwZS5hY2NlcHQgPSBmdW5jdGlvbiBhY2NlcHQodmlzaXRvcikge1xuICAgIHJldHVybiB2aXNpdG9yLnZpc2l0Q2FsbEZ1bmN0aW9uKHRoaXMpO1xuICB9O1xuXG4gIENhbGxGdW5jdGlvbi5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uIGNvbm5lY3QoYmluZGluZywgc2NvcGUpIHtcbiAgICB0aGlzLmZ1bmMuY29ubmVjdChiaW5kaW5nLCBzY29wZSk7XG4gICAgdmFyIGZ1bmMgPSB0aGlzLmZ1bmMuZXZhbHVhdGUoc2NvcGUpO1xuICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdmFyIGFyZ3MgPSB0aGlzLmFyZ3M7XG4gICAgICB2YXIgX2k5ID0gYXJncy5sZW5ndGg7XG4gICAgICB3aGlsZSAoX2k5LS0pIHtcbiAgICAgICAgYXJnc1tfaTldLmNvbm5lY3QoYmluZGluZywgc2NvcGUpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICByZXR1cm4gQ2FsbEZ1bmN0aW9uO1xufShFeHByZXNzaW9uKTtcblxudmFyIEJpbmFyeSA9IGV4cG9ydHMuQmluYXJ5ID0gZnVuY3Rpb24gKF9FeHByZXNzaW9uMTMpIHtcbiAgX2luaGVyaXRzKEJpbmFyeSwgX0V4cHJlc3Npb24xMyk7XG5cbiAgZnVuY3Rpb24gQmluYXJ5KG9wZXJhdGlvbiwgbGVmdCwgcmlnaHQpIHtcbiAgICBcblxuICAgIHZhciBfdGhpczE1ID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX0V4cHJlc3Npb24xMy5jYWxsKHRoaXMpKTtcblxuICAgIF90aGlzMTUub3BlcmF0aW9uID0gb3BlcmF0aW9uO1xuICAgIF90aGlzMTUubGVmdCA9IGxlZnQ7XG4gICAgX3RoaXMxNS5yaWdodCA9IHJpZ2h0O1xuICAgIHJldHVybiBfdGhpczE1O1xuICB9XG5cbiAgQmluYXJ5LnByb3RvdHlwZS5ldmFsdWF0ZSA9IGZ1bmN0aW9uIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICB2YXIgbGVmdCA9IHRoaXMubGVmdC5ldmFsdWF0ZShzY29wZSk7XG5cbiAgICBzd2l0Y2ggKHRoaXMub3BlcmF0aW9uKSB7XG4gICAgICBjYXNlICcmJic6XG4gICAgICAgIHJldHVybiBsZWZ0ICYmIHRoaXMucmlnaHQuZXZhbHVhdGUoc2NvcGUpO1xuICAgICAgY2FzZSAnfHwnOlxuICAgICAgICByZXR1cm4gbGVmdCB8fCB0aGlzLnJpZ2h0LmV2YWx1YXRlKHNjb3BlKTtcbiAgICB9XG5cbiAgICB2YXIgcmlnaHQgPSB0aGlzLnJpZ2h0LmV2YWx1YXRlKHNjb3BlKTtcblxuICAgIHN3aXRjaCAodGhpcy5vcGVyYXRpb24pIHtcbiAgICAgIGNhc2UgJz09JzpcbiAgICAgICAgcmV0dXJuIGxlZnQgPT0gcmlnaHQ7XG4gICAgICBjYXNlICc9PT0nOlxuICAgICAgICByZXR1cm4gbGVmdCA9PT0gcmlnaHQ7XG4gICAgICBjYXNlICchPSc6XG4gICAgICAgIHJldHVybiBsZWZ0ICE9IHJpZ2h0O1xuICAgICAgY2FzZSAnIT09JzpcbiAgICAgICAgcmV0dXJuIGxlZnQgIT09IHJpZ2h0O1xuICAgIH1cblxuICAgIGlmIChsZWZ0ID09PSBudWxsIHx8IHJpZ2h0ID09PSBudWxsIHx8IGxlZnQgPT09IHVuZGVmaW5lZCB8fCByaWdodCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBzd2l0Y2ggKHRoaXMub3BlcmF0aW9uKSB7XG4gICAgICAgIGNhc2UgJysnOlxuICAgICAgICAgIGlmIChsZWZ0ICE9PSBudWxsICYmIGxlZnQgIT09IHVuZGVmaW5lZCkgcmV0dXJuIGxlZnQ7XG4gICAgICAgICAgaWYgKHJpZ2h0ICE9PSBudWxsICYmIHJpZ2h0ICE9PSB1bmRlZmluZWQpIHJldHVybiByaWdodDtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgY2FzZSAnLSc6XG4gICAgICAgICAgaWYgKGxlZnQgIT09IG51bGwgJiYgbGVmdCAhPT0gdW5kZWZpbmVkKSByZXR1cm4gbGVmdDtcbiAgICAgICAgICBpZiAocmlnaHQgIT09IG51bGwgJiYgcmlnaHQgIT09IHVuZGVmaW5lZCkgcmV0dXJuIDAgLSByaWdodDtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgc3dpdGNoICh0aGlzLm9wZXJhdGlvbikge1xuICAgICAgY2FzZSAnKyc6XG4gICAgICAgIHJldHVybiBhdXRvQ29udmVydEFkZChsZWZ0LCByaWdodCk7XG4gICAgICBjYXNlICctJzpcbiAgICAgICAgcmV0dXJuIGxlZnQgLSByaWdodDtcbiAgICAgIGNhc2UgJyonOlxuICAgICAgICByZXR1cm4gbGVmdCAqIHJpZ2h0O1xuICAgICAgY2FzZSAnLyc6XG4gICAgICAgIHJldHVybiBsZWZ0IC8gcmlnaHQ7XG4gICAgICBjYXNlICclJzpcbiAgICAgICAgcmV0dXJuIGxlZnQgJSByaWdodDtcbiAgICAgIGNhc2UgJzwnOlxuICAgICAgICByZXR1cm4gbGVmdCA8IHJpZ2h0O1xuICAgICAgY2FzZSAnPic6XG4gICAgICAgIHJldHVybiBsZWZ0ID4gcmlnaHQ7XG4gICAgICBjYXNlICc8PSc6XG4gICAgICAgIHJldHVybiBsZWZ0IDw9IHJpZ2h0O1xuICAgICAgY2FzZSAnPj0nOlxuICAgICAgICByZXR1cm4gbGVmdCA+PSByaWdodDtcbiAgICAgIGNhc2UgJ14nOlxuICAgICAgICByZXR1cm4gbGVmdCBeIHJpZ2h0O1xuICAgIH1cblxuICAgIHRocm93IG5ldyBFcnJvcignSW50ZXJuYWwgZXJyb3IgWycgKyB0aGlzLm9wZXJhdGlvbiArICddIG5vdCBoYW5kbGVkJyk7XG4gIH07XG5cbiAgQmluYXJ5LnByb3RvdHlwZS5hY2NlcHQgPSBmdW5jdGlvbiBhY2NlcHQodmlzaXRvcikge1xuICAgIHJldHVybiB2aXNpdG9yLnZpc2l0QmluYXJ5KHRoaXMpO1xuICB9O1xuXG4gIEJpbmFyeS5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uIGNvbm5lY3QoYmluZGluZywgc2NvcGUpIHtcbiAgICB0aGlzLmxlZnQuY29ubmVjdChiaW5kaW5nLCBzY29wZSk7XG4gICAgdmFyIGxlZnQgPSB0aGlzLmxlZnQuZXZhbHVhdGUoc2NvcGUpO1xuICAgIGlmICh0aGlzLm9wZXJhdGlvbiA9PT0gJyYmJyAmJiAhbGVmdCB8fCB0aGlzLm9wZXJhdGlvbiA9PT0gJ3x8JyAmJiBsZWZ0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMucmlnaHQuY29ubmVjdChiaW5kaW5nLCBzY29wZSk7XG4gIH07XG5cbiAgcmV0dXJuIEJpbmFyeTtcbn0oRXhwcmVzc2lvbik7XG5cbnZhciBQcmVmaXhOb3QgPSBleHBvcnRzLlByZWZpeE5vdCA9IGZ1bmN0aW9uIChfRXhwcmVzc2lvbjE0KSB7XG4gIF9pbmhlcml0cyhQcmVmaXhOb3QsIF9FeHByZXNzaW9uMTQpO1xuXG4gIGZ1bmN0aW9uIFByZWZpeE5vdChvcGVyYXRpb24sIGV4cHJlc3Npb24pIHtcbiAgICBcblxuICAgIHZhciBfdGhpczE2ID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX0V4cHJlc3Npb24xNC5jYWxsKHRoaXMpKTtcblxuICAgIF90aGlzMTYub3BlcmF0aW9uID0gb3BlcmF0aW9uO1xuICAgIF90aGlzMTYuZXhwcmVzc2lvbiA9IGV4cHJlc3Npb247XG4gICAgcmV0dXJuIF90aGlzMTY7XG4gIH1cblxuICBQcmVmaXhOb3QucHJvdG90eXBlLmV2YWx1YXRlID0gZnVuY3Rpb24gZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHJldHVybiAhdGhpcy5leHByZXNzaW9uLmV2YWx1YXRlKHNjb3BlKTtcbiAgfTtcblxuICBQcmVmaXhOb3QucHJvdG90eXBlLmFjY2VwdCA9IGZ1bmN0aW9uIGFjY2VwdCh2aXNpdG9yKSB7XG4gICAgcmV0dXJuIHZpc2l0b3IudmlzaXRQcmVmaXgodGhpcyk7XG4gIH07XG5cbiAgUHJlZml4Tm90LnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gY29ubmVjdChiaW5kaW5nLCBzY29wZSkge1xuICAgIHRoaXMuZXhwcmVzc2lvbi5jb25uZWN0KGJpbmRpbmcsIHNjb3BlKTtcbiAgfTtcblxuICByZXR1cm4gUHJlZml4Tm90O1xufShFeHByZXNzaW9uKTtcblxudmFyIExpdGVyYWxQcmltaXRpdmUgPSBleHBvcnRzLkxpdGVyYWxQcmltaXRpdmUgPSBmdW5jdGlvbiAoX0V4cHJlc3Npb24xNSkge1xuICBfaW5oZXJpdHMoTGl0ZXJhbFByaW1pdGl2ZSwgX0V4cHJlc3Npb24xNSk7XG5cbiAgZnVuY3Rpb24gTGl0ZXJhbFByaW1pdGl2ZSh2YWx1ZSkge1xuICAgIFxuXG4gICAgdmFyIF90aGlzMTcgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfRXhwcmVzc2lvbjE1LmNhbGwodGhpcykpO1xuXG4gICAgX3RoaXMxNy52YWx1ZSA9IHZhbHVlO1xuICAgIHJldHVybiBfdGhpczE3O1xuICB9XG5cbiAgTGl0ZXJhbFByaW1pdGl2ZS5wcm90b3R5cGUuZXZhbHVhdGUgPSBmdW5jdGlvbiBldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gIH07XG5cbiAgTGl0ZXJhbFByaW1pdGl2ZS5wcm90b3R5cGUuYWNjZXB0ID0gZnVuY3Rpb24gYWNjZXB0KHZpc2l0b3IpIHtcbiAgICByZXR1cm4gdmlzaXRvci52aXNpdExpdGVyYWxQcmltaXRpdmUodGhpcyk7XG4gIH07XG5cbiAgTGl0ZXJhbFByaW1pdGl2ZS5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uIGNvbm5lY3QoYmluZGluZywgc2NvcGUpIHt9O1xuXG4gIHJldHVybiBMaXRlcmFsUHJpbWl0aXZlO1xufShFeHByZXNzaW9uKTtcblxudmFyIExpdGVyYWxTdHJpbmcgPSBleHBvcnRzLkxpdGVyYWxTdHJpbmcgPSBmdW5jdGlvbiAoX0V4cHJlc3Npb24xNikge1xuICBfaW5oZXJpdHMoTGl0ZXJhbFN0cmluZywgX0V4cHJlc3Npb24xNik7XG5cbiAgZnVuY3Rpb24gTGl0ZXJhbFN0cmluZyh2YWx1ZSkge1xuICAgIFxuXG4gICAgdmFyIF90aGlzMTggPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfRXhwcmVzc2lvbjE2LmNhbGwodGhpcykpO1xuXG4gICAgX3RoaXMxOC52YWx1ZSA9IHZhbHVlO1xuICAgIHJldHVybiBfdGhpczE4O1xuICB9XG5cbiAgTGl0ZXJhbFN0cmluZy5wcm90b3R5cGUuZXZhbHVhdGUgPSBmdW5jdGlvbiBldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gIH07XG5cbiAgTGl0ZXJhbFN0cmluZy5wcm90b3R5cGUuYWNjZXB0ID0gZnVuY3Rpb24gYWNjZXB0KHZpc2l0b3IpIHtcbiAgICByZXR1cm4gdmlzaXRvci52aXNpdExpdGVyYWxTdHJpbmcodGhpcyk7XG4gIH07XG5cbiAgTGl0ZXJhbFN0cmluZy5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uIGNvbm5lY3QoYmluZGluZywgc2NvcGUpIHt9O1xuXG4gIHJldHVybiBMaXRlcmFsU3RyaW5nO1xufShFeHByZXNzaW9uKTtcblxudmFyIExpdGVyYWxBcnJheSA9IGV4cG9ydHMuTGl0ZXJhbEFycmF5ID0gZnVuY3Rpb24gKF9FeHByZXNzaW9uMTcpIHtcbiAgX2luaGVyaXRzKExpdGVyYWxBcnJheSwgX0V4cHJlc3Npb24xNyk7XG5cbiAgZnVuY3Rpb24gTGl0ZXJhbEFycmF5KGVsZW1lbnRzKSB7XG4gICAgXG5cbiAgICB2YXIgX3RoaXMxOSA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9FeHByZXNzaW9uMTcuY2FsbCh0aGlzKSk7XG5cbiAgICBfdGhpczE5LmVsZW1lbnRzID0gZWxlbWVudHM7XG4gICAgcmV0dXJuIF90aGlzMTk7XG4gIH1cblxuICBMaXRlcmFsQXJyYXkucHJvdG90eXBlLmV2YWx1YXRlID0gZnVuY3Rpb24gZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHZhciBlbGVtZW50cyA9IHRoaXMuZWxlbWVudHM7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuXG4gICAgZm9yICh2YXIgX2kxMCA9IDAsIGxlbmd0aCA9IGVsZW1lbnRzLmxlbmd0aDsgX2kxMCA8IGxlbmd0aDsgKytfaTEwKSB7XG4gICAgICByZXN1bHRbX2kxMF0gPSBlbGVtZW50c1tfaTEwXS5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIExpdGVyYWxBcnJheS5wcm90b3R5cGUuYWNjZXB0ID0gZnVuY3Rpb24gYWNjZXB0KHZpc2l0b3IpIHtcbiAgICByZXR1cm4gdmlzaXRvci52aXNpdExpdGVyYWxBcnJheSh0aGlzKTtcbiAgfTtcblxuICBMaXRlcmFsQXJyYXkucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbiBjb25uZWN0KGJpbmRpbmcsIHNjb3BlKSB7XG4gICAgdmFyIGxlbmd0aCA9IHRoaXMuZWxlbWVudHMubGVuZ3RoO1xuICAgIGZvciAodmFyIF9pMTEgPSAwOyBfaTExIDwgbGVuZ3RoOyBfaTExKyspIHtcbiAgICAgIHRoaXMuZWxlbWVudHNbX2kxMV0uY29ubmVjdChiaW5kaW5nLCBzY29wZSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBMaXRlcmFsQXJyYXk7XG59KEV4cHJlc3Npb24pO1xuXG52YXIgTGl0ZXJhbE9iamVjdCA9IGV4cG9ydHMuTGl0ZXJhbE9iamVjdCA9IGZ1bmN0aW9uIChfRXhwcmVzc2lvbjE4KSB7XG4gIF9pbmhlcml0cyhMaXRlcmFsT2JqZWN0LCBfRXhwcmVzc2lvbjE4KTtcblxuICBmdW5jdGlvbiBMaXRlcmFsT2JqZWN0KGtleXMsIHZhbHVlcykge1xuICAgIFxuXG4gICAgdmFyIF90aGlzMjAgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfRXhwcmVzc2lvbjE4LmNhbGwodGhpcykpO1xuXG4gICAgX3RoaXMyMC5rZXlzID0ga2V5cztcbiAgICBfdGhpczIwLnZhbHVlcyA9IHZhbHVlcztcbiAgICByZXR1cm4gX3RoaXMyMDtcbiAgfVxuXG4gIExpdGVyYWxPYmplY3QucHJvdG90eXBlLmV2YWx1YXRlID0gZnVuY3Rpb24gZXZhbHVhdGUoc2NvcGUsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIHZhciBpbnN0YW5jZSA9IHt9O1xuICAgIHZhciBrZXlzID0gdGhpcy5rZXlzO1xuICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlcztcblxuICAgIGZvciAodmFyIF9pMTIgPSAwLCBsZW5ndGggPSBrZXlzLmxlbmd0aDsgX2kxMiA8IGxlbmd0aDsgKytfaTEyKSB7XG4gICAgICBpbnN0YW5jZVtrZXlzW19pMTJdXSA9IHZhbHVlc1tfaTEyXS5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgICB9XG5cbiAgICByZXR1cm4gaW5zdGFuY2U7XG4gIH07XG5cbiAgTGl0ZXJhbE9iamVjdC5wcm90b3R5cGUuYWNjZXB0ID0gZnVuY3Rpb24gYWNjZXB0KHZpc2l0b3IpIHtcbiAgICByZXR1cm4gdmlzaXRvci52aXNpdExpdGVyYWxPYmplY3QodGhpcyk7XG4gIH07XG5cbiAgTGl0ZXJhbE9iamVjdC5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uIGNvbm5lY3QoYmluZGluZywgc2NvcGUpIHtcbiAgICB2YXIgbGVuZ3RoID0gdGhpcy5rZXlzLmxlbmd0aDtcbiAgICBmb3IgKHZhciBfaTEzID0gMDsgX2kxMyA8IGxlbmd0aDsgX2kxMysrKSB7XG4gICAgICB0aGlzLnZhbHVlc1tfaTEzXS5jb25uZWN0KGJpbmRpbmcsIHNjb3BlKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIExpdGVyYWxPYmplY3Q7XG59KEV4cHJlc3Npb24pO1xuXG52YXIgZXZhbExpc3RDYWNoZSA9IFtbXSwgWzBdLCBbMCwgMF0sIFswLCAwLCAwXSwgWzAsIDAsIDAsIDBdLCBbMCwgMCwgMCwgMCwgMF1dO1xuXG5mdW5jdGlvbiBldmFsTGlzdChzY29wZSwgbGlzdCwgbG9va3VwRnVuY3Rpb25zKSB7XG4gIHZhciBsZW5ndGggPSBsaXN0Lmxlbmd0aDtcblxuICBmb3IgKHZhciBjYWNoZUxlbmd0aCA9IGV2YWxMaXN0Q2FjaGUubGVuZ3RoOyBjYWNoZUxlbmd0aCA8PSBsZW5ndGg7ICsrY2FjaGVMZW5ndGgpIHtcbiAgICBldmFsTGlzdENhY2hlLnB1c2goW10pO1xuICB9XG5cbiAgdmFyIHJlc3VsdCA9IGV2YWxMaXN0Q2FjaGVbbGVuZ3RoXTtcblxuICBmb3IgKHZhciBfaTE0ID0gMDsgX2kxNCA8IGxlbmd0aDsgKytfaTE0KSB7XG4gICAgcmVzdWx0W19pMTRdID0gbGlzdFtfaTE0XS5ldmFsdWF0ZShzY29wZSwgbG9va3VwRnVuY3Rpb25zKTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmZ1bmN0aW9uIGF1dG9Db252ZXJ0QWRkKGEsIGIpIHtcbiAgaWYgKGEgIT09IG51bGwgJiYgYiAhPT0gbnVsbCkge1xuICAgIGlmICh0eXBlb2YgYSA9PT0gJ3N0cmluZycgJiYgdHlwZW9mIGIgIT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4gYSArIGIudG9TdHJpbmcoKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGEgIT09ICdzdHJpbmcnICYmIHR5cGVvZiBiID09PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIGEudG9TdHJpbmcoKSArIGI7XG4gICAgfVxuXG4gICAgcmV0dXJuIGEgKyBiO1xuICB9XG5cbiAgaWYgKGEgIT09IG51bGwpIHtcbiAgICByZXR1cm4gYTtcbiAgfVxuXG4gIGlmIChiICE9PSBudWxsKSB7XG4gICAgcmV0dXJuIGI7XG4gIH1cblxuICByZXR1cm4gMDtcbn1cblxuZnVuY3Rpb24gZ2V0RnVuY3Rpb24ob2JqLCBuYW1lLCBtdXN0RXhpc3QpIHtcbiAgdmFyIGZ1bmMgPSBvYmogPT09IG51bGwgfHwgb2JqID09PSB1bmRlZmluZWQgPyBudWxsIDogb2JqW25hbWVdO1xuICBpZiAodHlwZW9mIGZ1bmMgPT09ICdmdW5jdGlvbicpIHtcbiAgICByZXR1cm4gZnVuYztcbiAgfVxuICBpZiAoIW11c3RFeGlzdCAmJiAoZnVuYyA9PT0gbnVsbCB8fCBmdW5jID09PSB1bmRlZmluZWQpKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKG5hbWUgKyAnIGlzIG5vdCBhIGZ1bmN0aW9uJyk7XG59XG5cbmZ1bmN0aW9uIGdldEtleWVkKG9iaiwga2V5KSB7XG4gIGlmIChBcnJheS5pc0FycmF5KG9iaikpIHtcbiAgICByZXR1cm4gb2JqW3BhcnNlSW50KGtleSwgMTApXTtcbiAgfSBlbHNlIGlmIChvYmopIHtcbiAgICByZXR1cm4gb2JqW2tleV07XG4gIH0gZWxzZSBpZiAob2JqID09PSBudWxsIHx8IG9iaiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIHJldHVybiBvYmpba2V5XTtcbn1cblxuZnVuY3Rpb24gc2V0S2V5ZWQob2JqLCBrZXksIHZhbHVlKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KG9iaikpIHtcbiAgICB2YXIgaW5kZXggPSBwYXJzZUludChrZXksIDEwKTtcblxuICAgIGlmIChvYmoubGVuZ3RoIDw9IGluZGV4KSB7XG4gICAgICBvYmoubGVuZ3RoID0gaW5kZXggKyAxO1xuICAgIH1cblxuICAgIG9ialtpbmRleF0gPSB2YWx1ZTtcbiAgfSBlbHNlIHtcbiAgICBvYmpba2V5XSA9IHZhbHVlO1xuICB9XG5cbiAgcmV0dXJuIHZhbHVlO1xufVxuXG52YXIgVW5wYXJzZXIgPSBleHBvcnRzLlVucGFyc2VyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBVbnBhcnNlcihidWZmZXIpIHtcbiAgICBcblxuICAgIHRoaXMuYnVmZmVyID0gYnVmZmVyO1xuICB9XG5cbiAgVW5wYXJzZXIudW5wYXJzZSA9IGZ1bmN0aW9uIHVucGFyc2UoZXhwcmVzc2lvbikge1xuICAgIHZhciBidWZmZXIgPSBbXTtcbiAgICB2YXIgdmlzaXRvciA9IG5ldyBVbnBhcnNlcihidWZmZXIpO1xuXG4gICAgZXhwcmVzc2lvbi5hY2NlcHQodmlzaXRvcik7XG5cbiAgICByZXR1cm4gYnVmZmVyLmpvaW4oJycpO1xuICB9O1xuXG4gIFVucGFyc2VyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIHdyaXRlKHRleHQpIHtcbiAgICB0aGlzLmJ1ZmZlci5wdXNoKHRleHQpO1xuICB9O1xuXG4gIFVucGFyc2VyLnByb3RvdHlwZS53cml0ZUFyZ3MgPSBmdW5jdGlvbiB3cml0ZUFyZ3MoYXJncykge1xuICAgIHRoaXMud3JpdGUoJygnKTtcblxuICAgIGZvciAodmFyIF9pMTUgPSAwLCBsZW5ndGggPSBhcmdzLmxlbmd0aDsgX2kxNSA8IGxlbmd0aDsgKytfaTE1KSB7XG4gICAgICBpZiAoX2kxNSAhPT0gMCkge1xuICAgICAgICB0aGlzLndyaXRlKCcsJyk7XG4gICAgICB9XG5cbiAgICAgIGFyZ3NbX2kxNV0uYWNjZXB0KHRoaXMpO1xuICAgIH1cblxuICAgIHRoaXMud3JpdGUoJyknKTtcbiAgfTtcblxuICBVbnBhcnNlci5wcm90b3R5cGUudmlzaXRDaGFpbiA9IGZ1bmN0aW9uIHZpc2l0Q2hhaW4oY2hhaW4pIHtcbiAgICB2YXIgZXhwcmVzc2lvbnMgPSBjaGFpbi5leHByZXNzaW9ucztcblxuICAgIGZvciAodmFyIF9pMTYgPSAwLCBsZW5ndGggPSBleHByZXNzaW9uLmxlbmd0aDsgX2kxNiA8IGxlbmd0aDsgKytfaTE2KSB7XG4gICAgICBpZiAoX2kxNiAhPT0gMCkge1xuICAgICAgICB0aGlzLndyaXRlKCc7Jyk7XG4gICAgICB9XG5cbiAgICAgIGV4cHJlc3Npb25zW19pMTZdLmFjY2VwdCh0aGlzKTtcbiAgICB9XG4gIH07XG5cbiAgVW5wYXJzZXIucHJvdG90eXBlLnZpc2l0QmluZGluZ0JlaGF2aW9yID0gZnVuY3Rpb24gdmlzaXRCaW5kaW5nQmVoYXZpb3IoYmVoYXZpb3IpIHtcbiAgICB2YXIgYXJncyA9IGJlaGF2aW9yLmFyZ3M7XG5cbiAgICBiZWhhdmlvci5leHByZXNzaW9uLmFjY2VwdCh0aGlzKTtcbiAgICB0aGlzLndyaXRlKCcmJyArIGJlaGF2aW9yLm5hbWUpO1xuXG4gICAgZm9yICh2YXIgX2kxNyA9IDAsIGxlbmd0aCA9IGFyZ3MubGVuZ3RoOyBfaTE3IDwgbGVuZ3RoOyArK19pMTcpIHtcbiAgICAgIHRoaXMud3JpdGUoJzonKTtcbiAgICAgIGFyZ3NbX2kxN10uYWNjZXB0KHRoaXMpO1xuICAgIH1cbiAgfTtcblxuICBVbnBhcnNlci5wcm90b3R5cGUudmlzaXRWYWx1ZUNvbnZlcnRlciA9IGZ1bmN0aW9uIHZpc2l0VmFsdWVDb252ZXJ0ZXIoY29udmVydGVyKSB7XG4gICAgdmFyIGFyZ3MgPSBjb252ZXJ0ZXIuYXJncztcblxuICAgIGNvbnZlcnRlci5leHByZXNzaW9uLmFjY2VwdCh0aGlzKTtcbiAgICB0aGlzLndyaXRlKCd8JyArIGNvbnZlcnRlci5uYW1lKTtcblxuICAgIGZvciAodmFyIF9pMTggPSAwLCBsZW5ndGggPSBhcmdzLmxlbmd0aDsgX2kxOCA8IGxlbmd0aDsgKytfaTE4KSB7XG4gICAgICB0aGlzLndyaXRlKCc6Jyk7XG4gICAgICBhcmdzW19pMThdLmFjY2VwdCh0aGlzKTtcbiAgICB9XG4gIH07XG5cbiAgVW5wYXJzZXIucHJvdG90eXBlLnZpc2l0QXNzaWduID0gZnVuY3Rpb24gdmlzaXRBc3NpZ24oYXNzaWduKSB7XG4gICAgYXNzaWduLnRhcmdldC5hY2NlcHQodGhpcyk7XG4gICAgdGhpcy53cml0ZSgnPScpO1xuICAgIGFzc2lnbi52YWx1ZS5hY2NlcHQodGhpcyk7XG4gIH07XG5cbiAgVW5wYXJzZXIucHJvdG90eXBlLnZpc2l0Q29uZGl0aW9uYWwgPSBmdW5jdGlvbiB2aXNpdENvbmRpdGlvbmFsKGNvbmRpdGlvbmFsKSB7XG4gICAgY29uZGl0aW9uYWwuY29uZGl0aW9uLmFjY2VwdCh0aGlzKTtcbiAgICB0aGlzLndyaXRlKCc/Jyk7XG4gICAgY29uZGl0aW9uYWwueWVzLmFjY2VwdCh0aGlzKTtcbiAgICB0aGlzLndyaXRlKCc6Jyk7XG4gICAgY29uZGl0aW9uYWwubm8uYWNjZXB0KHRoaXMpO1xuICB9O1xuXG4gIFVucGFyc2VyLnByb3RvdHlwZS52aXNpdEFjY2Vzc1RoaXMgPSBmdW5jdGlvbiB2aXNpdEFjY2Vzc1RoaXMoYWNjZXNzKSB7XG4gICAgaWYgKGFjY2Vzcy5hbmNlc3RvciA9PT0gMCkge1xuICAgICAgdGhpcy53cml0ZSgnJHRoaXMnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy53cml0ZSgnJHBhcmVudCcpO1xuICAgIHZhciBpID0gYWNjZXNzLmFuY2VzdG9yIC0gMTtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICB0aGlzLndyaXRlKCcuJHBhcmVudCcpO1xuICAgIH1cbiAgfTtcblxuICBVbnBhcnNlci5wcm90b3R5cGUudmlzaXRBY2Nlc3NTY29wZSA9IGZ1bmN0aW9uIHZpc2l0QWNjZXNzU2NvcGUoYWNjZXNzKSB7XG4gICAgdmFyIGkgPSBhY2Nlc3MuYW5jZXN0b3I7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgdGhpcy53cml0ZSgnJHBhcmVudC4nKTtcbiAgICB9XG4gICAgdGhpcy53cml0ZShhY2Nlc3MubmFtZSk7XG4gIH07XG5cbiAgVW5wYXJzZXIucHJvdG90eXBlLnZpc2l0QWNjZXNzTWVtYmVyID0gZnVuY3Rpb24gdmlzaXRBY2Nlc3NNZW1iZXIoYWNjZXNzKSB7XG4gICAgYWNjZXNzLm9iamVjdC5hY2NlcHQodGhpcyk7XG4gICAgdGhpcy53cml0ZSgnLicgKyBhY2Nlc3MubmFtZSk7XG4gIH07XG5cbiAgVW5wYXJzZXIucHJvdG90eXBlLnZpc2l0QWNjZXNzS2V5ZWQgPSBmdW5jdGlvbiB2aXNpdEFjY2Vzc0tleWVkKGFjY2Vzcykge1xuICAgIGFjY2Vzcy5vYmplY3QuYWNjZXB0KHRoaXMpO1xuICAgIHRoaXMud3JpdGUoJ1snKTtcbiAgICBhY2Nlc3Mua2V5LmFjY2VwdCh0aGlzKTtcbiAgICB0aGlzLndyaXRlKCddJyk7XG4gIH07XG5cbiAgVW5wYXJzZXIucHJvdG90eXBlLnZpc2l0Q2FsbFNjb3BlID0gZnVuY3Rpb24gdmlzaXRDYWxsU2NvcGUoY2FsbCkge1xuICAgIHZhciBpID0gY2FsbC5hbmNlc3RvcjtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICB0aGlzLndyaXRlKCckcGFyZW50LicpO1xuICAgIH1cbiAgICB0aGlzLndyaXRlKGNhbGwubmFtZSk7XG4gICAgdGhpcy53cml0ZUFyZ3MoY2FsbC5hcmdzKTtcbiAgfTtcblxuICBVbnBhcnNlci5wcm90b3R5cGUudmlzaXRDYWxsRnVuY3Rpb24gPSBmdW5jdGlvbiB2aXNpdENhbGxGdW5jdGlvbihjYWxsKSB7XG4gICAgY2FsbC5mdW5jLmFjY2VwdCh0aGlzKTtcbiAgICB0aGlzLndyaXRlQXJncyhjYWxsLmFyZ3MpO1xuICB9O1xuXG4gIFVucGFyc2VyLnByb3RvdHlwZS52aXNpdENhbGxNZW1iZXIgPSBmdW5jdGlvbiB2aXNpdENhbGxNZW1iZXIoY2FsbCkge1xuICAgIGNhbGwub2JqZWN0LmFjY2VwdCh0aGlzKTtcbiAgICB0aGlzLndyaXRlKCcuJyArIGNhbGwubmFtZSk7XG4gICAgdGhpcy53cml0ZUFyZ3MoY2FsbC5hcmdzKTtcbiAgfTtcblxuICBVbnBhcnNlci5wcm90b3R5cGUudmlzaXRQcmVmaXggPSBmdW5jdGlvbiB2aXNpdFByZWZpeChwcmVmaXgpIHtcbiAgICB0aGlzLndyaXRlKCcoJyArIHByZWZpeC5vcGVyYXRpb24pO1xuICAgIHByZWZpeC5leHByZXNzaW9uLmFjY2VwdCh0aGlzKTtcbiAgICB0aGlzLndyaXRlKCcpJyk7XG4gIH07XG5cbiAgVW5wYXJzZXIucHJvdG90eXBlLnZpc2l0QmluYXJ5ID0gZnVuY3Rpb24gdmlzaXRCaW5hcnkoYmluYXJ5KSB7XG4gICAgYmluYXJ5LmxlZnQuYWNjZXB0KHRoaXMpO1xuICAgIHRoaXMud3JpdGUoYmluYXJ5Lm9wZXJhdGlvbik7XG4gICAgYmluYXJ5LnJpZ2h0LmFjY2VwdCh0aGlzKTtcbiAgfTtcblxuICBVbnBhcnNlci5wcm90b3R5cGUudmlzaXRMaXRlcmFsUHJpbWl0aXZlID0gZnVuY3Rpb24gdmlzaXRMaXRlcmFsUHJpbWl0aXZlKGxpdGVyYWwpIHtcbiAgICB0aGlzLndyaXRlKCcnICsgbGl0ZXJhbC52YWx1ZSk7XG4gIH07XG5cbiAgVW5wYXJzZXIucHJvdG90eXBlLnZpc2l0TGl0ZXJhbEFycmF5ID0gZnVuY3Rpb24gdmlzaXRMaXRlcmFsQXJyYXkobGl0ZXJhbCkge1xuICAgIHZhciBlbGVtZW50cyA9IGxpdGVyYWwuZWxlbWVudHM7XG5cbiAgICB0aGlzLndyaXRlKCdbJyk7XG5cbiAgICBmb3IgKHZhciBfaTE5ID0gMCwgbGVuZ3RoID0gZWxlbWVudHMubGVuZ3RoOyBfaTE5IDwgbGVuZ3RoOyArK19pMTkpIHtcbiAgICAgIGlmIChfaTE5ICE9PSAwKSB7XG4gICAgICAgIHRoaXMud3JpdGUoJywnKTtcbiAgICAgIH1cblxuICAgICAgZWxlbWVudHNbX2kxOV0uYWNjZXB0KHRoaXMpO1xuICAgIH1cblxuICAgIHRoaXMud3JpdGUoJ10nKTtcbiAgfTtcblxuICBVbnBhcnNlci5wcm90b3R5cGUudmlzaXRMaXRlcmFsT2JqZWN0ID0gZnVuY3Rpb24gdmlzaXRMaXRlcmFsT2JqZWN0KGxpdGVyYWwpIHtcbiAgICB2YXIga2V5cyA9IGxpdGVyYWwua2V5cztcbiAgICB2YXIgdmFsdWVzID0gbGl0ZXJhbC52YWx1ZXM7XG5cbiAgICB0aGlzLndyaXRlKCd7Jyk7XG5cbiAgICBmb3IgKHZhciBfaTIwID0gMCwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7IF9pMjAgPCBsZW5ndGg7ICsrX2kyMCkge1xuICAgICAgaWYgKF9pMjAgIT09IDApIHtcbiAgICAgICAgdGhpcy53cml0ZSgnLCcpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLndyaXRlKCdcXCcnICsga2V5c1tfaTIwXSArICdcXCc6Jyk7XG4gICAgICB2YWx1ZXNbX2kyMF0uYWNjZXB0KHRoaXMpO1xuICAgIH1cblxuICAgIHRoaXMud3JpdGUoJ30nKTtcbiAgfTtcblxuICBVbnBhcnNlci5wcm90b3R5cGUudmlzaXRMaXRlcmFsU3RyaW5nID0gZnVuY3Rpb24gdmlzaXRMaXRlcmFsU3RyaW5nKGxpdGVyYWwpIHtcbiAgICB2YXIgZXNjYXBlZCA9IGxpdGVyYWwudmFsdWUucmVwbGFjZSgvJy9nLCBcIlxcJ1wiKTtcbiAgICB0aGlzLndyaXRlKCdcXCcnICsgZXNjYXBlZCArICdcXCcnKTtcbiAgfTtcblxuICByZXR1cm4gVW5wYXJzZXI7XG59KCk7XG5cbnZhciBFeHByZXNzaW9uQ2xvbmVyID0gZXhwb3J0cy5FeHByZXNzaW9uQ2xvbmVyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBFeHByZXNzaW9uQ2xvbmVyKCkge1xuICAgIFxuICB9XG5cbiAgRXhwcmVzc2lvbkNsb25lci5wcm90b3R5cGUuY2xvbmVFeHByZXNzaW9uQXJyYXkgPSBmdW5jdGlvbiBjbG9uZUV4cHJlc3Npb25BcnJheShhcnJheSkge1xuICAgIHZhciBjbG9uZWRBcnJheSA9IFtdO1xuICAgIHZhciBpID0gYXJyYXkubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIGNsb25lZEFycmF5W2ldID0gYXJyYXlbaV0uYWNjZXB0KHRoaXMpO1xuICAgIH1cbiAgICByZXR1cm4gY2xvbmVkQXJyYXk7XG4gIH07XG5cbiAgRXhwcmVzc2lvbkNsb25lci5wcm90b3R5cGUudmlzaXRDaGFpbiA9IGZ1bmN0aW9uIHZpc2l0Q2hhaW4oY2hhaW4pIHtcbiAgICByZXR1cm4gbmV3IENoYWluKHRoaXMuY2xvbmVFeHByZXNzaW9uQXJyYXkoY2hhaW4uZXhwcmVzc2lvbnMpKTtcbiAgfTtcblxuICBFeHByZXNzaW9uQ2xvbmVyLnByb3RvdHlwZS52aXNpdEJpbmRpbmdCZWhhdmlvciA9IGZ1bmN0aW9uIHZpc2l0QmluZGluZ0JlaGF2aW9yKGJlaGF2aW9yKSB7XG4gICAgcmV0dXJuIG5ldyBCaW5kaW5nQmVoYXZpb3IoYmVoYXZpb3IuZXhwcmVzc2lvbi5hY2NlcHQodGhpcyksIGJlaGF2aW9yLm5hbWUsIHRoaXMuY2xvbmVFeHByZXNzaW9uQXJyYXkoYmVoYXZpb3IuYXJncykpO1xuICB9O1xuXG4gIEV4cHJlc3Npb25DbG9uZXIucHJvdG90eXBlLnZpc2l0VmFsdWVDb252ZXJ0ZXIgPSBmdW5jdGlvbiB2aXNpdFZhbHVlQ29udmVydGVyKGNvbnZlcnRlcikge1xuICAgIHJldHVybiBuZXcgVmFsdWVDb252ZXJ0ZXIoY29udmVydGVyLmV4cHJlc3Npb24uYWNjZXB0KHRoaXMpLCBjb252ZXJ0ZXIubmFtZSwgdGhpcy5jbG9uZUV4cHJlc3Npb25BcnJheShjb252ZXJ0ZXIuYXJncykpO1xuICB9O1xuXG4gIEV4cHJlc3Npb25DbG9uZXIucHJvdG90eXBlLnZpc2l0QXNzaWduID0gZnVuY3Rpb24gdmlzaXRBc3NpZ24oYXNzaWduKSB7XG4gICAgcmV0dXJuIG5ldyBBc3NpZ24oYXNzaWduLnRhcmdldC5hY2NlcHQodGhpcyksIGFzc2lnbi52YWx1ZS5hY2NlcHQodGhpcykpO1xuICB9O1xuXG4gIEV4cHJlc3Npb25DbG9uZXIucHJvdG90eXBlLnZpc2l0Q29uZGl0aW9uYWwgPSBmdW5jdGlvbiB2aXNpdENvbmRpdGlvbmFsKGNvbmRpdGlvbmFsKSB7XG4gICAgcmV0dXJuIG5ldyBDb25kaXRpb25hbChjb25kaXRpb25hbC5jb25kaXRpb24uYWNjZXB0KHRoaXMpLCBjb25kaXRpb25hbC55ZXMuYWNjZXB0KHRoaXMpLCBjb25kaXRpb25hbC5uby5hY2NlcHQodGhpcykpO1xuICB9O1xuXG4gIEV4cHJlc3Npb25DbG9uZXIucHJvdG90eXBlLnZpc2l0QWNjZXNzVGhpcyA9IGZ1bmN0aW9uIHZpc2l0QWNjZXNzVGhpcyhhY2Nlc3MpIHtcbiAgICByZXR1cm4gbmV3IEFjY2Vzc1RoaXMoYWNjZXNzLmFuY2VzdG9yKTtcbiAgfTtcblxuICBFeHByZXNzaW9uQ2xvbmVyLnByb3RvdHlwZS52aXNpdEFjY2Vzc1Njb3BlID0gZnVuY3Rpb24gdmlzaXRBY2Nlc3NTY29wZShhY2Nlc3MpIHtcbiAgICByZXR1cm4gbmV3IEFjY2Vzc1Njb3BlKGFjY2Vzcy5uYW1lLCBhY2Nlc3MuYW5jZXN0b3IpO1xuICB9O1xuXG4gIEV4cHJlc3Npb25DbG9uZXIucHJvdG90eXBlLnZpc2l0QWNjZXNzTWVtYmVyID0gZnVuY3Rpb24gdmlzaXRBY2Nlc3NNZW1iZXIoYWNjZXNzKSB7XG4gICAgcmV0dXJuIG5ldyBBY2Nlc3NNZW1iZXIoYWNjZXNzLm9iamVjdC5hY2NlcHQodGhpcyksIGFjY2Vzcy5uYW1lKTtcbiAgfTtcblxuICBFeHByZXNzaW9uQ2xvbmVyLnByb3RvdHlwZS52aXNpdEFjY2Vzc0tleWVkID0gZnVuY3Rpb24gdmlzaXRBY2Nlc3NLZXllZChhY2Nlc3MpIHtcbiAgICByZXR1cm4gbmV3IEFjY2Vzc0tleWVkKGFjY2Vzcy5vYmplY3QuYWNjZXB0KHRoaXMpLCBhY2Nlc3Mua2V5LmFjY2VwdCh0aGlzKSk7XG4gIH07XG5cbiAgRXhwcmVzc2lvbkNsb25lci5wcm90b3R5cGUudmlzaXRDYWxsU2NvcGUgPSBmdW5jdGlvbiB2aXNpdENhbGxTY29wZShjYWxsKSB7XG4gICAgcmV0dXJuIG5ldyBDYWxsU2NvcGUoY2FsbC5uYW1lLCB0aGlzLmNsb25lRXhwcmVzc2lvbkFycmF5KGNhbGwuYXJncyksIGNhbGwuYW5jZXN0b3IpO1xuICB9O1xuXG4gIEV4cHJlc3Npb25DbG9uZXIucHJvdG90eXBlLnZpc2l0Q2FsbEZ1bmN0aW9uID0gZnVuY3Rpb24gdmlzaXRDYWxsRnVuY3Rpb24oY2FsbCkge1xuICAgIHJldHVybiBuZXcgQ2FsbEZ1bmN0aW9uKGNhbGwuZnVuYy5hY2NlcHQodGhpcyksIHRoaXMuY2xvbmVFeHByZXNzaW9uQXJyYXkoY2FsbC5hcmdzKSk7XG4gIH07XG5cbiAgRXhwcmVzc2lvbkNsb25lci5wcm90b3R5cGUudmlzaXRDYWxsTWVtYmVyID0gZnVuY3Rpb24gdmlzaXRDYWxsTWVtYmVyKGNhbGwpIHtcbiAgICByZXR1cm4gbmV3IENhbGxNZW1iZXIoY2FsbC5vYmplY3QuYWNjZXB0KHRoaXMpLCBjYWxsLm5hbWUsIHRoaXMuY2xvbmVFeHByZXNzaW9uQXJyYXkoY2FsbC5hcmdzKSk7XG4gIH07XG5cbiAgRXhwcmVzc2lvbkNsb25lci5wcm90b3R5cGUudmlzaXRQcmVmaXggPSBmdW5jdGlvbiB2aXNpdFByZWZpeChwcmVmaXgpIHtcbiAgICByZXR1cm4gbmV3IFByZWZpeE5vdChwcmVmaXgub3BlcmF0aW9uLCBwcmVmaXguZXhwcmVzc2lvbi5hY2NlcHQodGhpcykpO1xuICB9O1xuXG4gIEV4cHJlc3Npb25DbG9uZXIucHJvdG90eXBlLnZpc2l0QmluYXJ5ID0gZnVuY3Rpb24gdmlzaXRCaW5hcnkoYmluYXJ5KSB7XG4gICAgcmV0dXJuIG5ldyBCaW5hcnkoYmluYXJ5Lm9wZXJhdGlvbiwgYmluYXJ5LmxlZnQuYWNjZXB0KHRoaXMpLCBiaW5hcnkucmlnaHQuYWNjZXB0KHRoaXMpKTtcbiAgfTtcblxuICBFeHByZXNzaW9uQ2xvbmVyLnByb3RvdHlwZS52aXNpdExpdGVyYWxQcmltaXRpdmUgPSBmdW5jdGlvbiB2aXNpdExpdGVyYWxQcmltaXRpdmUobGl0ZXJhbCkge1xuICAgIHJldHVybiBuZXcgTGl0ZXJhbFByaW1pdGl2ZShsaXRlcmFsKTtcbiAgfTtcblxuICBFeHByZXNzaW9uQ2xvbmVyLnByb3RvdHlwZS52aXNpdExpdGVyYWxBcnJheSA9IGZ1bmN0aW9uIHZpc2l0TGl0ZXJhbEFycmF5KGxpdGVyYWwpIHtcbiAgICByZXR1cm4gbmV3IExpdGVyYWxBcnJheSh0aGlzLmNsb25lRXhwcmVzc2lvbkFycmF5KGxpdGVyYWwuZWxlbWVudHMpKTtcbiAgfTtcblxuICBFeHByZXNzaW9uQ2xvbmVyLnByb3RvdHlwZS52aXNpdExpdGVyYWxPYmplY3QgPSBmdW5jdGlvbiB2aXNpdExpdGVyYWxPYmplY3QobGl0ZXJhbCkge1xuICAgIHJldHVybiBuZXcgTGl0ZXJhbE9iamVjdChsaXRlcmFsLmtleXMsIHRoaXMuY2xvbmVFeHByZXNzaW9uQXJyYXkobGl0ZXJhbC52YWx1ZXMpKTtcbiAgfTtcblxuICBFeHByZXNzaW9uQ2xvbmVyLnByb3RvdHlwZS52aXNpdExpdGVyYWxTdHJpbmcgPSBmdW5jdGlvbiB2aXNpdExpdGVyYWxTdHJpbmcobGl0ZXJhbCkge1xuICAgIHJldHVybiBuZXcgTGl0ZXJhbFN0cmluZyhsaXRlcmFsLnZhbHVlKTtcbiAgfTtcblxuICByZXR1cm4gRXhwcmVzc2lvbkNsb25lcjtcbn0oKTtcblxuZnVuY3Rpb24gY2xvbmVFeHByZXNzaW9uKGV4cHJlc3Npb24pIHtcbiAgdmFyIHZpc2l0b3IgPSBuZXcgRXhwcmVzc2lvbkNsb25lcigpO1xuICByZXR1cm4gZXhwcmVzc2lvbi5hY2NlcHQodmlzaXRvcik7XG59XG5cbnZhciBiaW5kaW5nTW9kZSA9IGV4cG9ydHMuYmluZGluZ01vZGUgPSB7XG4gIG9uZVRpbWU6IDAsXG4gIG9uZVdheTogMSxcbiAgdHdvV2F5OiAyXG59O1xuXG52YXIgVG9rZW4gPSBleHBvcnRzLlRva2VuID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBUb2tlbihpbmRleCwgdGV4dCkge1xuICAgIFxuXG4gICAgdGhpcy5pbmRleCA9IGluZGV4O1xuICAgIHRoaXMudGV4dCA9IHRleHQ7XG4gIH1cblxuICBUb2tlbi5wcm90b3R5cGUud2l0aE9wID0gZnVuY3Rpb24gd2l0aE9wKG9wKSB7XG4gICAgdGhpcy5vcEtleSA9IG9wO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIFRva2VuLnByb3RvdHlwZS53aXRoR2V0dGVyU2V0dGVyID0gZnVuY3Rpb24gd2l0aEdldHRlclNldHRlcihrZXkpIHtcbiAgICB0aGlzLmtleSA9IGtleTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBUb2tlbi5wcm90b3R5cGUud2l0aFZhbHVlID0gZnVuY3Rpb24gd2l0aFZhbHVlKHZhbHVlKSB7XG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIFRva2VuLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICAgIHJldHVybiAnVG9rZW4oJyArIHRoaXMudGV4dCArICcpJztcbiAgfTtcblxuICByZXR1cm4gVG9rZW47XG59KCk7XG5cbnZhciBMZXhlciA9IGV4cG9ydHMuTGV4ZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIExleGVyKCkge1xuICAgIFxuICB9XG5cbiAgTGV4ZXIucHJvdG90eXBlLmxleCA9IGZ1bmN0aW9uIGxleCh0ZXh0KSB7XG4gICAgdmFyIHNjYW5uZXIgPSBuZXcgU2Nhbm5lcih0ZXh0KTtcbiAgICB2YXIgdG9rZW5zID0gW107XG4gICAgdmFyIHRva2VuID0gc2Nhbm5lci5zY2FuVG9rZW4oKTtcblxuICAgIHdoaWxlICh0b2tlbikge1xuICAgICAgdG9rZW5zLnB1c2godG9rZW4pO1xuICAgICAgdG9rZW4gPSBzY2FubmVyLnNjYW5Ub2tlbigpO1xuICAgIH1cblxuICAgIHJldHVybiB0b2tlbnM7XG4gIH07XG5cbiAgcmV0dXJuIExleGVyO1xufSgpO1xuXG52YXIgU2Nhbm5lciA9IGV4cG9ydHMuU2Nhbm5lciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gU2Nhbm5lcihpbnB1dCkge1xuICAgIFxuXG4gICAgdGhpcy5pbnB1dCA9IGlucHV0O1xuICAgIHRoaXMubGVuZ3RoID0gaW5wdXQubGVuZ3RoO1xuICAgIHRoaXMucGVlayA9IDA7XG4gICAgdGhpcy5pbmRleCA9IC0xO1xuXG4gICAgdGhpcy5hZHZhbmNlKCk7XG4gIH1cblxuICBTY2FubmVyLnByb3RvdHlwZS5zY2FuVG9rZW4gPSBmdW5jdGlvbiBzY2FuVG9rZW4oKSB7XG4gICAgd2hpbGUgKHRoaXMucGVlayA8PSAkU1BBQ0UpIHtcbiAgICAgIGlmICgrK3RoaXMuaW5kZXggPj0gdGhpcy5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5wZWVrID0gJEVPRjtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIHRoaXMucGVlayA9IHRoaXMuaW5wdXQuY2hhckNvZGVBdCh0aGlzLmluZGV4KTtcbiAgICB9XG5cbiAgICBpZiAoaXNJZGVudGlmaWVyU3RhcnQodGhpcy5wZWVrKSkge1xuICAgICAgcmV0dXJuIHRoaXMuc2NhbklkZW50aWZpZXIoKTtcbiAgICB9XG5cbiAgICBpZiAoaXNEaWdpdCh0aGlzLnBlZWspKSB7XG4gICAgICByZXR1cm4gdGhpcy5zY2FuTnVtYmVyKHRoaXMuaW5kZXgpO1xuICAgIH1cblxuICAgIHZhciBzdGFydCA9IHRoaXMuaW5kZXg7XG5cbiAgICBzd2l0Y2ggKHRoaXMucGVlaykge1xuICAgICAgY2FzZSAkUEVSSU9EOlxuICAgICAgICB0aGlzLmFkdmFuY2UoKTtcbiAgICAgICAgcmV0dXJuIGlzRGlnaXQodGhpcy5wZWVrKSA/IHRoaXMuc2Nhbk51bWJlcihzdGFydCkgOiBuZXcgVG9rZW4oc3RhcnQsICcuJyk7XG4gICAgICBjYXNlICRMUEFSRU46XG4gICAgICBjYXNlICRSUEFSRU46XG4gICAgICBjYXNlICRMQlJBQ0U6XG4gICAgICBjYXNlICRSQlJBQ0U6XG4gICAgICBjYXNlICRMQlJBQ0tFVDpcbiAgICAgIGNhc2UgJFJCUkFDS0VUOlxuICAgICAgY2FzZSAkQ09NTUE6XG4gICAgICBjYXNlICRDT0xPTjpcbiAgICAgIGNhc2UgJFNFTUlDT0xPTjpcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NhbkNoYXJhY3RlcihzdGFydCwgU3RyaW5nLmZyb21DaGFyQ29kZSh0aGlzLnBlZWspKTtcbiAgICAgIGNhc2UgJFNROlxuICAgICAgY2FzZSAkRFE6XG4gICAgICAgIHJldHVybiB0aGlzLnNjYW5TdHJpbmcoKTtcbiAgICAgIGNhc2UgJFBMVVM6XG4gICAgICBjYXNlICRNSU5VUzpcbiAgICAgIGNhc2UgJFNUQVI6XG4gICAgICBjYXNlICRTTEFTSDpcbiAgICAgIGNhc2UgJFBFUkNFTlQ6XG4gICAgICBjYXNlICRDQVJFVDpcbiAgICAgIGNhc2UgJFFVRVNUSU9OOlxuICAgICAgICByZXR1cm4gdGhpcy5zY2FuT3BlcmF0b3Ioc3RhcnQsIFN0cmluZy5mcm9tQ2hhckNvZGUodGhpcy5wZWVrKSk7XG4gICAgICBjYXNlICRMVDpcbiAgICAgIGNhc2UgJEdUOlxuICAgICAgY2FzZSAkQkFORzpcbiAgICAgIGNhc2UgJEVROlxuICAgICAgICByZXR1cm4gdGhpcy5zY2FuQ29tcGxleE9wZXJhdG9yKHN0YXJ0LCAkRVEsIFN0cmluZy5mcm9tQ2hhckNvZGUodGhpcy5wZWVrKSwgJz0nKTtcbiAgICAgIGNhc2UgJEFNUEVSU0FORDpcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NhbkNvbXBsZXhPcGVyYXRvcihzdGFydCwgJEFNUEVSU0FORCwgJyYnLCAnJicpO1xuICAgICAgY2FzZSAkQkFSOlxuICAgICAgICByZXR1cm4gdGhpcy5zY2FuQ29tcGxleE9wZXJhdG9yKHN0YXJ0LCAkQkFSLCAnfCcsICd8Jyk7XG4gICAgICBjYXNlICROQlNQOlxuICAgICAgICB3aGlsZSAoaXNXaGl0ZXNwYWNlKHRoaXMucGVlaykpIHtcbiAgICAgICAgICB0aGlzLmFkdmFuY2UoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLnNjYW5Ub2tlbigpO1xuICAgIH1cblxuICAgIHZhciBjaGFyYWN0ZXIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHRoaXMucGVlayk7XG4gICAgdGhpcy5lcnJvcignVW5leHBlY3RlZCBjaGFyYWN0ZXIgWycgKyBjaGFyYWN0ZXIgKyAnXScpO1xuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIFNjYW5uZXIucHJvdG90eXBlLnNjYW5DaGFyYWN0ZXIgPSBmdW5jdGlvbiBzY2FuQ2hhcmFjdGVyKHN0YXJ0LCB0ZXh0KSB7XG4gICAgYXNzZXJ0KHRoaXMucGVlayA9PT0gdGV4dC5jaGFyQ29kZUF0KDApKTtcbiAgICB0aGlzLmFkdmFuY2UoKTtcbiAgICByZXR1cm4gbmV3IFRva2VuKHN0YXJ0LCB0ZXh0KTtcbiAgfTtcblxuICBTY2FubmVyLnByb3RvdHlwZS5zY2FuT3BlcmF0b3IgPSBmdW5jdGlvbiBzY2FuT3BlcmF0b3Ioc3RhcnQsIHRleHQpIHtcbiAgICBhc3NlcnQodGhpcy5wZWVrID09PSB0ZXh0LmNoYXJDb2RlQXQoMCkpO1xuICAgIGFzc2VydChPUEVSQVRPUlMuaW5kZXhPZih0ZXh0KSAhPT0gLTEpO1xuICAgIHRoaXMuYWR2YW5jZSgpO1xuICAgIHJldHVybiBuZXcgVG9rZW4oc3RhcnQsIHRleHQpLndpdGhPcCh0ZXh0KTtcbiAgfTtcblxuICBTY2FubmVyLnByb3RvdHlwZS5zY2FuQ29tcGxleE9wZXJhdG9yID0gZnVuY3Rpb24gc2NhbkNvbXBsZXhPcGVyYXRvcihzdGFydCwgY29kZSwgb25lLCB0d28pIHtcbiAgICBhc3NlcnQodGhpcy5wZWVrID09PSBvbmUuY2hhckNvZGVBdCgwKSk7XG4gICAgdGhpcy5hZHZhbmNlKCk7XG5cbiAgICB2YXIgdGV4dCA9IG9uZTtcblxuICAgIGlmICh0aGlzLnBlZWsgPT09IGNvZGUpIHtcbiAgICAgIHRoaXMuYWR2YW5jZSgpO1xuICAgICAgdGV4dCArPSB0d287XG4gICAgfVxuXG4gICAgaWYgKHRoaXMucGVlayA9PT0gY29kZSkge1xuICAgICAgdGhpcy5hZHZhbmNlKCk7XG4gICAgICB0ZXh0ICs9IHR3bztcbiAgICB9XG5cbiAgICBhc3NlcnQoT1BFUkFUT1JTLmluZGV4T2YodGV4dCkgIT09IC0xKTtcblxuICAgIHJldHVybiBuZXcgVG9rZW4oc3RhcnQsIHRleHQpLndpdGhPcCh0ZXh0KTtcbiAgfTtcblxuICBTY2FubmVyLnByb3RvdHlwZS5zY2FuSWRlbnRpZmllciA9IGZ1bmN0aW9uIHNjYW5JZGVudGlmaWVyKCkge1xuICAgIGFzc2VydChpc0lkZW50aWZpZXJTdGFydCh0aGlzLnBlZWspKTtcbiAgICB2YXIgc3RhcnQgPSB0aGlzLmluZGV4O1xuXG4gICAgdGhpcy5hZHZhbmNlKCk7XG5cbiAgICB3aGlsZSAoaXNJZGVudGlmaWVyUGFydCh0aGlzLnBlZWspKSB7XG4gICAgICB0aGlzLmFkdmFuY2UoKTtcbiAgICB9XG5cbiAgICB2YXIgdGV4dCA9IHRoaXMuaW5wdXQuc3Vic3RyaW5nKHN0YXJ0LCB0aGlzLmluZGV4KTtcbiAgICB2YXIgcmVzdWx0ID0gbmV3IFRva2VuKHN0YXJ0LCB0ZXh0KTtcblxuICAgIGlmIChPUEVSQVRPUlMuaW5kZXhPZih0ZXh0KSAhPT0gLTEpIHtcbiAgICAgIHJlc3VsdC53aXRoT3AodGV4dCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdC53aXRoR2V0dGVyU2V0dGVyKHRleHQpO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgU2Nhbm5lci5wcm90b3R5cGUuc2Nhbk51bWJlciA9IGZ1bmN0aW9uIHNjYW5OdW1iZXIoc3RhcnQpIHtcbiAgICBhc3NlcnQoaXNEaWdpdCh0aGlzLnBlZWspKTtcbiAgICB2YXIgc2ltcGxlID0gdGhpcy5pbmRleCA9PT0gc3RhcnQ7XG4gICAgdGhpcy5hZHZhbmNlKCk7XG5cbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgaWYgKGlzRGlnaXQodGhpcy5wZWVrKSkge30gZWxzZSBpZiAodGhpcy5wZWVrID09PSAkUEVSSU9EKSB7XG4gICAgICAgICAgc2ltcGxlID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNFeHBvbmVudFN0YXJ0KHRoaXMucGVlaykpIHtcbiAgICAgICAgICB0aGlzLmFkdmFuY2UoKTtcblxuICAgICAgICAgIGlmIChpc0V4cG9uZW50U2lnbih0aGlzLnBlZWspKSB7XG4gICAgICAgICAgICB0aGlzLmFkdmFuY2UoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoIWlzRGlnaXQodGhpcy5wZWVrKSkge1xuICAgICAgICAgICAgdGhpcy5lcnJvcignSW52YWxpZCBleHBvbmVudCcsIC0xKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBzaW1wbGUgPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICB0aGlzLmFkdmFuY2UoKTtcbiAgICB9XG5cbiAgICB2YXIgdGV4dCA9IHRoaXMuaW5wdXQuc3Vic3RyaW5nKHN0YXJ0LCB0aGlzLmluZGV4KTtcbiAgICB2YXIgdmFsdWUgPSBzaW1wbGUgPyBwYXJzZUludCh0ZXh0LCAxMCkgOiBwYXJzZUZsb2F0KHRleHQpO1xuICAgIHJldHVybiBuZXcgVG9rZW4oc3RhcnQsIHRleHQpLndpdGhWYWx1ZSh2YWx1ZSk7XG4gIH07XG5cbiAgU2Nhbm5lci5wcm90b3R5cGUuc2NhblN0cmluZyA9IGZ1bmN0aW9uIHNjYW5TdHJpbmcoKSB7XG4gICAgYXNzZXJ0KHRoaXMucGVlayA9PT0gJFNRIHx8IHRoaXMucGVlayA9PT0gJERRKTtcblxuICAgIHZhciBzdGFydCA9IHRoaXMuaW5kZXg7XG4gICAgdmFyIHF1b3RlID0gdGhpcy5wZWVrO1xuXG4gICAgdGhpcy5hZHZhbmNlKCk7XG5cbiAgICB2YXIgYnVmZmVyID0gdm9pZCAwO1xuICAgIHZhciBtYXJrZXIgPSB0aGlzLmluZGV4O1xuXG4gICAgd2hpbGUgKHRoaXMucGVlayAhPT0gcXVvdGUpIHtcbiAgICAgIGlmICh0aGlzLnBlZWsgPT09ICRCQUNLU0xBU0gpIHtcbiAgICAgICAgaWYgKCFidWZmZXIpIHtcbiAgICAgICAgICBidWZmZXIgPSBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGJ1ZmZlci5wdXNoKHRoaXMuaW5wdXQuc3Vic3RyaW5nKG1hcmtlciwgdGhpcy5pbmRleCkpO1xuICAgICAgICB0aGlzLmFkdmFuY2UoKTtcblxuICAgICAgICB2YXIgX3VuZXNjYXBlZCA9IHZvaWQgMDtcblxuICAgICAgICBpZiAodGhpcy5wZWVrID09PSAkdSkge1xuICAgICAgICAgIHZhciBoZXggPSB0aGlzLmlucHV0LnN1YnN0cmluZyh0aGlzLmluZGV4ICsgMSwgdGhpcy5pbmRleCArIDUpO1xuXG4gICAgICAgICAgaWYgKCEvW0EtWjAtOV17NH0vLnRlc3QoaGV4KSkge1xuICAgICAgICAgICAgdGhpcy5lcnJvcignSW52YWxpZCB1bmljb2RlIGVzY2FwZSBbXFxcXHUnICsgaGV4ICsgJ10nKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBfdW5lc2NhcGVkID0gcGFyc2VJbnQoaGV4LCAxNik7XG5cbiAgICAgICAgICBmb3IgKHZhciBfaTIxID0gMDsgX2kyMSA8IDU7ICsrX2kyMSkge1xuICAgICAgICAgICAgdGhpcy5hZHZhbmNlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF91bmVzY2FwZWQgPSB1bmVzY2FwZSh0aGlzLnBlZWspO1xuICAgICAgICAgIHRoaXMuYWR2YW5jZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgYnVmZmVyLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShfdW5lc2NhcGVkKSk7XG4gICAgICAgIG1hcmtlciA9IHRoaXMuaW5kZXg7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMucGVlayA9PT0gJEVPRikge1xuICAgICAgICB0aGlzLmVycm9yKCdVbnRlcm1pbmF0ZWQgcXVvdGUnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuYWR2YW5jZSgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBsYXN0ID0gdGhpcy5pbnB1dC5zdWJzdHJpbmcobWFya2VyLCB0aGlzLmluZGV4KTtcbiAgICB0aGlzLmFkdmFuY2UoKTtcbiAgICB2YXIgdGV4dCA9IHRoaXMuaW5wdXQuc3Vic3RyaW5nKHN0YXJ0LCB0aGlzLmluZGV4KTtcblxuICAgIHZhciB1bmVzY2FwZWQgPSBsYXN0O1xuXG4gICAgaWYgKGJ1ZmZlciAhPT0gbnVsbCAmJiBidWZmZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgYnVmZmVyLnB1c2gobGFzdCk7XG4gICAgICB1bmVzY2FwZWQgPSBidWZmZXIuam9pbignJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBUb2tlbihzdGFydCwgdGV4dCkud2l0aFZhbHVlKHVuZXNjYXBlZCk7XG4gIH07XG5cbiAgU2Nhbm5lci5wcm90b3R5cGUuYWR2YW5jZSA9IGZ1bmN0aW9uIGFkdmFuY2UoKSB7XG4gICAgaWYgKCsrdGhpcy5pbmRleCA+PSB0aGlzLmxlbmd0aCkge1xuICAgICAgdGhpcy5wZWVrID0gJEVPRjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5wZWVrID0gdGhpcy5pbnB1dC5jaGFyQ29kZUF0KHRoaXMuaW5kZXgpO1xuICAgIH1cbiAgfTtcblxuICBTY2FubmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIGVycm9yKG1lc3NhZ2UpIHtcbiAgICB2YXIgb2Zmc2V0ID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gMCA6IGFyZ3VtZW50c1sxXTtcblxuICAgIHZhciBwb3NpdGlvbiA9IHRoaXMuaW5kZXggKyBvZmZzZXQ7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdMZXhlciBFcnJvcjogJyArIG1lc3NhZ2UgKyAnIGF0IGNvbHVtbiAnICsgcG9zaXRpb24gKyAnIGluIGV4cHJlc3Npb24gWycgKyB0aGlzLmlucHV0ICsgJ10nKTtcbiAgfTtcblxuICByZXR1cm4gU2Nhbm5lcjtcbn0oKTtcblxudmFyIE9QRVJBVE9SUyA9IFsndW5kZWZpbmVkJywgJ251bGwnLCAndHJ1ZScsICdmYWxzZScsICcrJywgJy0nLCAnKicsICcvJywgJyUnLCAnXicsICc9JywgJz09JywgJz09PScsICchPScsICchPT0nLCAnPCcsICc+JywgJzw9JywgJz49JywgJyYmJywgJ3x8JywgJyYnLCAnfCcsICchJywgJz8nXTtcblxudmFyICRFT0YgPSAwO1xudmFyICRUQUIgPSA5O1xudmFyICRMRiA9IDEwO1xudmFyICRWVEFCID0gMTE7XG52YXIgJEZGID0gMTI7XG52YXIgJENSID0gMTM7XG52YXIgJFNQQUNFID0gMzI7XG52YXIgJEJBTkcgPSAzMztcbnZhciAkRFEgPSAzNDtcbnZhciAkJCA9IDM2O1xudmFyICRQRVJDRU5UID0gMzc7XG52YXIgJEFNUEVSU0FORCA9IDM4O1xudmFyICRTUSA9IDM5O1xudmFyICRMUEFSRU4gPSA0MDtcbnZhciAkUlBBUkVOID0gNDE7XG52YXIgJFNUQVIgPSA0MjtcbnZhciAkUExVUyA9IDQzO1xudmFyICRDT01NQSA9IDQ0O1xudmFyICRNSU5VUyA9IDQ1O1xudmFyICRQRVJJT0QgPSA0NjtcbnZhciAkU0xBU0ggPSA0NztcbnZhciAkQ09MT04gPSA1ODtcbnZhciAkU0VNSUNPTE9OID0gNTk7XG52YXIgJExUID0gNjA7XG52YXIgJEVRID0gNjE7XG52YXIgJEdUID0gNjI7XG52YXIgJFFVRVNUSU9OID0gNjM7XG5cbnZhciAkMCA9IDQ4O1xudmFyICQ5ID0gNTc7XG5cbnZhciAkQSA9IDY1O1xudmFyICRFID0gNjk7XG52YXIgJFogPSA5MDtcblxudmFyICRMQlJBQ0tFVCA9IDkxO1xudmFyICRCQUNLU0xBU0ggPSA5MjtcbnZhciAkUkJSQUNLRVQgPSA5MztcbnZhciAkQ0FSRVQgPSA5NDtcbnZhciAkXyA9IDk1O1xuXG52YXIgJGEgPSA5NztcbnZhciAkZSA9IDEwMTtcbnZhciAkZiA9IDEwMjtcbnZhciAkbiA9IDExMDtcbnZhciAkciA9IDExNDtcbnZhciAkdCA9IDExNjtcbnZhciAkdSA9IDExNztcbnZhciAkdiA9IDExODtcbnZhciAkeiA9IDEyMjtcblxudmFyICRMQlJBQ0UgPSAxMjM7XG52YXIgJEJBUiA9IDEyNDtcbnZhciAkUkJSQUNFID0gMTI1O1xudmFyICROQlNQID0gMTYwO1xuXG5mdW5jdGlvbiBpc1doaXRlc3BhY2UoY29kZSkge1xuICByZXR1cm4gY29kZSA+PSAkVEFCICYmIGNvZGUgPD0gJFNQQUNFIHx8IGNvZGUgPT09ICROQlNQO1xufVxuXG5mdW5jdGlvbiBpc0lkZW50aWZpZXJTdGFydChjb2RlKSB7XG4gIHJldHVybiAkYSA8PSBjb2RlICYmIGNvZGUgPD0gJHogfHwgJEEgPD0gY29kZSAmJiBjb2RlIDw9ICRaIHx8IGNvZGUgPT09ICRfIHx8IGNvZGUgPT09ICQkO1xufVxuXG5mdW5jdGlvbiBpc0lkZW50aWZpZXJQYXJ0KGNvZGUpIHtcbiAgcmV0dXJuICRhIDw9IGNvZGUgJiYgY29kZSA8PSAkeiB8fCAkQSA8PSBjb2RlICYmIGNvZGUgPD0gJFogfHwgJDAgPD0gY29kZSAmJiBjb2RlIDw9ICQ5IHx8IGNvZGUgPT09ICRfIHx8IGNvZGUgPT09ICQkO1xufVxuXG5mdW5jdGlvbiBpc0RpZ2l0KGNvZGUpIHtcbiAgcmV0dXJuICQwIDw9IGNvZGUgJiYgY29kZSA8PSAkOTtcbn1cblxuZnVuY3Rpb24gaXNFeHBvbmVudFN0YXJ0KGNvZGUpIHtcbiAgcmV0dXJuIGNvZGUgPT09ICRlIHx8IGNvZGUgPT09ICRFO1xufVxuXG5mdW5jdGlvbiBpc0V4cG9uZW50U2lnbihjb2RlKSB7XG4gIHJldHVybiBjb2RlID09PSAkTUlOVVMgfHwgY29kZSA9PT0gJFBMVVM7XG59XG5cbmZ1bmN0aW9uIHVuZXNjYXBlKGNvZGUpIHtcbiAgc3dpdGNoIChjb2RlKSB7XG4gICAgY2FzZSAkbjpcbiAgICAgIHJldHVybiAkTEY7XG4gICAgY2FzZSAkZjpcbiAgICAgIHJldHVybiAkRkY7XG4gICAgY2FzZSAkcjpcbiAgICAgIHJldHVybiAkQ1I7XG4gICAgY2FzZSAkdDpcbiAgICAgIHJldHVybiAkVEFCO1xuICAgIGNhc2UgJHY6XG4gICAgICByZXR1cm4gJFZUQUI7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBjb2RlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGFzc2VydChjb25kaXRpb24sIG1lc3NhZ2UpIHtcbiAgaWYgKCFjb25kaXRpb24pIHtcbiAgICB0aHJvdyBtZXNzYWdlIHx8ICdBc3NlcnRpb24gZmFpbGVkJztcbiAgfVxufVxuXG52YXIgRU9GID0gbmV3IFRva2VuKC0xLCBudWxsKTtcblxudmFyIFBhcnNlciA9IGV4cG9ydHMuUGFyc2VyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBQYXJzZXIoKSB7XG4gICAgXG5cbiAgICB0aGlzLmNhY2hlID0ge307XG4gICAgdGhpcy5sZXhlciA9IG5ldyBMZXhlcigpO1xuICB9XG5cbiAgUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIHBhcnNlKGlucHV0KSB7XG4gICAgaW5wdXQgPSBpbnB1dCB8fCAnJztcblxuICAgIHJldHVybiB0aGlzLmNhY2hlW2lucHV0XSB8fCAodGhpcy5jYWNoZVtpbnB1dF0gPSBuZXcgUGFyc2VySW1wbGVtZW50YXRpb24odGhpcy5sZXhlciwgaW5wdXQpLnBhcnNlQ2hhaW4oKSk7XG4gIH07XG5cbiAgcmV0dXJuIFBhcnNlcjtcbn0oKTtcblxudmFyIFBhcnNlckltcGxlbWVudGF0aW9uID0gZXhwb3J0cy5QYXJzZXJJbXBsZW1lbnRhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUGFyc2VySW1wbGVtZW50YXRpb24obGV4ZXIsIGlucHV0KSB7XG4gICAgXG5cbiAgICB0aGlzLmluZGV4ID0gMDtcbiAgICB0aGlzLmlucHV0ID0gaW5wdXQ7XG4gICAgdGhpcy50b2tlbnMgPSBsZXhlci5sZXgoaW5wdXQpO1xuICB9XG5cbiAgUGFyc2VySW1wbGVtZW50YXRpb24ucHJvdG90eXBlLnBhcnNlQ2hhaW4gPSBmdW5jdGlvbiBwYXJzZUNoYWluKCkge1xuICAgIHZhciBpc0NoYWluID0gZmFsc2U7XG4gICAgdmFyIGV4cHJlc3Npb25zID0gW107XG5cbiAgICB3aGlsZSAodGhpcy5vcHRpb25hbCgnOycpKSB7XG4gICAgICBpc0NoYWluID0gdHJ1ZTtcbiAgICB9XG5cbiAgICB3aGlsZSAodGhpcy5pbmRleCA8IHRoaXMudG9rZW5zLmxlbmd0aCkge1xuICAgICAgaWYgKHRoaXMucGVlay50ZXh0ID09PSAnKScgfHwgdGhpcy5wZWVrLnRleHQgPT09ICd9JyB8fCB0aGlzLnBlZWsudGV4dCA9PT0gJ10nKSB7XG4gICAgICAgIHRoaXMuZXJyb3IoJ1VuY29uc3VtZWQgdG9rZW4gJyArIHRoaXMucGVlay50ZXh0KTtcbiAgICAgIH1cblxuICAgICAgdmFyIGV4cHIgPSB0aGlzLnBhcnNlQmluZGluZ0JlaGF2aW9yKCk7XG4gICAgICBleHByZXNzaW9ucy5wdXNoKGV4cHIpO1xuXG4gICAgICB3aGlsZSAodGhpcy5vcHRpb25hbCgnOycpKSB7XG4gICAgICAgIGlzQ2hhaW4gPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAoaXNDaGFpbikge1xuICAgICAgICB0aGlzLmVycm9yKCdNdWx0aXBsZSBleHByZXNzaW9ucyBhcmUgbm90IGFsbG93ZWQuJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGV4cHJlc3Npb25zLmxlbmd0aCA9PT0gMSA/IGV4cHJlc3Npb25zWzBdIDogbmV3IENoYWluKGV4cHJlc3Npb25zKTtcbiAgfTtcblxuICBQYXJzZXJJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUucGFyc2VCaW5kaW5nQmVoYXZpb3IgPSBmdW5jdGlvbiBwYXJzZUJpbmRpbmdCZWhhdmlvcigpIHtcbiAgICB2YXIgcmVzdWx0ID0gdGhpcy5wYXJzZVZhbHVlQ29udmVydGVyKCk7XG5cbiAgICB3aGlsZSAodGhpcy5vcHRpb25hbCgnJicpKSB7XG4gICAgICB2YXIgbmFtZSA9IHRoaXMucGVlay50ZXh0O1xuICAgICAgdmFyIGFyZ3MgPSBbXTtcblxuICAgICAgdGhpcy5hZHZhbmNlKCk7XG5cbiAgICAgIHdoaWxlICh0aGlzLm9wdGlvbmFsKCc6JykpIHtcbiAgICAgICAgYXJncy5wdXNoKHRoaXMucGFyc2VFeHByZXNzaW9uKCkpO1xuICAgICAgfVxuXG4gICAgICByZXN1bHQgPSBuZXcgQmluZGluZ0JlaGF2aW9yKHJlc3VsdCwgbmFtZSwgYXJncyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBQYXJzZXJJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUucGFyc2VWYWx1ZUNvbnZlcnRlciA9IGZ1bmN0aW9uIHBhcnNlVmFsdWVDb252ZXJ0ZXIoKSB7XG4gICAgdmFyIHJlc3VsdCA9IHRoaXMucGFyc2VFeHByZXNzaW9uKCk7XG5cbiAgICB3aGlsZSAodGhpcy5vcHRpb25hbCgnfCcpKSB7XG4gICAgICB2YXIgbmFtZSA9IHRoaXMucGVlay50ZXh0O1xuICAgICAgdmFyIGFyZ3MgPSBbXTtcblxuICAgICAgdGhpcy5hZHZhbmNlKCk7XG5cbiAgICAgIHdoaWxlICh0aGlzLm9wdGlvbmFsKCc6JykpIHtcbiAgICAgICAgYXJncy5wdXNoKHRoaXMucGFyc2VFeHByZXNzaW9uKCkpO1xuICAgICAgfVxuXG4gICAgICByZXN1bHQgPSBuZXcgVmFsdWVDb252ZXJ0ZXIocmVzdWx0LCBuYW1lLCBhcmdzLCBbcmVzdWx0XS5jb25jYXQoYXJncykpO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgUGFyc2VySW1wbGVtZW50YXRpb24ucHJvdG90eXBlLnBhcnNlRXhwcmVzc2lvbiA9IGZ1bmN0aW9uIHBhcnNlRXhwcmVzc2lvbigpIHtcbiAgICB2YXIgc3RhcnQgPSB0aGlzLnBlZWsuaW5kZXg7XG4gICAgdmFyIHJlc3VsdCA9IHRoaXMucGFyc2VDb25kaXRpb25hbCgpO1xuXG4gICAgd2hpbGUgKHRoaXMucGVlay50ZXh0ID09PSAnPScpIHtcbiAgICAgIGlmICghcmVzdWx0LmlzQXNzaWduYWJsZSkge1xuICAgICAgICB2YXIgZW5kID0gdGhpcy5pbmRleCA8IHRoaXMudG9rZW5zLmxlbmd0aCA/IHRoaXMucGVlay5pbmRleCA6IHRoaXMuaW5wdXQubGVuZ3RoO1xuICAgICAgICB2YXIgX2V4cHJlc3Npb24gPSB0aGlzLmlucHV0LnN1YnN0cmluZyhzdGFydCwgZW5kKTtcblxuICAgICAgICB0aGlzLmVycm9yKCdFeHByZXNzaW9uICcgKyBfZXhwcmVzc2lvbiArICcgaXMgbm90IGFzc2lnbmFibGUnKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5leHBlY3QoJz0nKTtcbiAgICAgIHJlc3VsdCA9IG5ldyBBc3NpZ24ocmVzdWx0LCB0aGlzLnBhcnNlQ29uZGl0aW9uYWwoKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBQYXJzZXJJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUucGFyc2VDb25kaXRpb25hbCA9IGZ1bmN0aW9uIHBhcnNlQ29uZGl0aW9uYWwoKSB7XG4gICAgdmFyIHN0YXJ0ID0gdGhpcy5wZWVrLmluZGV4O1xuICAgIHZhciByZXN1bHQgPSB0aGlzLnBhcnNlTG9naWNhbE9yKCk7XG5cbiAgICBpZiAodGhpcy5vcHRpb25hbCgnPycpKSB7XG4gICAgICB2YXIgeWVzID0gdGhpcy5wYXJzZUV4cHJlc3Npb24oKTtcblxuICAgICAgaWYgKCF0aGlzLm9wdGlvbmFsKCc6JykpIHtcbiAgICAgICAgdmFyIGVuZCA9IHRoaXMuaW5kZXggPCB0aGlzLnRva2Vucy5sZW5ndGggPyB0aGlzLnBlZWsuaW5kZXggOiB0aGlzLmlucHV0Lmxlbmd0aDtcbiAgICAgICAgdmFyIF9leHByZXNzaW9uMiA9IHRoaXMuaW5wdXQuc3Vic3RyaW5nKHN0YXJ0LCBlbmQpO1xuXG4gICAgICAgIHRoaXMuZXJyb3IoJ0NvbmRpdGlvbmFsIGV4cHJlc3Npb24gJyArIF9leHByZXNzaW9uMiArICcgcmVxdWlyZXMgYWxsIDMgZXhwcmVzc2lvbnMnKTtcbiAgICAgIH1cblxuICAgICAgdmFyIG5vID0gdGhpcy5wYXJzZUV4cHJlc3Npb24oKTtcbiAgICAgIHJlc3VsdCA9IG5ldyBDb25kaXRpb25hbChyZXN1bHQsIHllcywgbm8pO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgUGFyc2VySW1wbGVtZW50YXRpb24ucHJvdG90eXBlLnBhcnNlTG9naWNhbE9yID0gZnVuY3Rpb24gcGFyc2VMb2dpY2FsT3IoKSB7XG4gICAgdmFyIHJlc3VsdCA9IHRoaXMucGFyc2VMb2dpY2FsQW5kKCk7XG5cbiAgICB3aGlsZSAodGhpcy5vcHRpb25hbCgnfHwnKSkge1xuICAgICAgcmVzdWx0ID0gbmV3IEJpbmFyeSgnfHwnLCByZXN1bHQsIHRoaXMucGFyc2VMb2dpY2FsQW5kKCkpO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgUGFyc2VySW1wbGVtZW50YXRpb24ucHJvdG90eXBlLnBhcnNlTG9naWNhbEFuZCA9IGZ1bmN0aW9uIHBhcnNlTG9naWNhbEFuZCgpIHtcbiAgICB2YXIgcmVzdWx0ID0gdGhpcy5wYXJzZUVxdWFsaXR5KCk7XG5cbiAgICB3aGlsZSAodGhpcy5vcHRpb25hbCgnJiYnKSkge1xuICAgICAgcmVzdWx0ID0gbmV3IEJpbmFyeSgnJiYnLCByZXN1bHQsIHRoaXMucGFyc2VFcXVhbGl0eSgpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIFBhcnNlckltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5wYXJzZUVxdWFsaXR5ID0gZnVuY3Rpb24gcGFyc2VFcXVhbGl0eSgpIHtcbiAgICB2YXIgcmVzdWx0ID0gdGhpcy5wYXJzZVJlbGF0aW9uYWwoKTtcblxuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICBpZiAodGhpcy5vcHRpb25hbCgnPT0nKSkge1xuICAgICAgICByZXN1bHQgPSBuZXcgQmluYXJ5KCc9PScsIHJlc3VsdCwgdGhpcy5wYXJzZVJlbGF0aW9uYWwoKSk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9uYWwoJyE9JykpIHtcbiAgICAgICAgcmVzdWx0ID0gbmV3IEJpbmFyeSgnIT0nLCByZXN1bHQsIHRoaXMucGFyc2VSZWxhdGlvbmFsKCkpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbmFsKCc9PT0nKSkge1xuICAgICAgICByZXN1bHQgPSBuZXcgQmluYXJ5KCc9PT0nLCByZXN1bHQsIHRoaXMucGFyc2VSZWxhdGlvbmFsKCkpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbmFsKCchPT0nKSkge1xuICAgICAgICByZXN1bHQgPSBuZXcgQmluYXJ5KCchPT0nLCByZXN1bHQsIHRoaXMucGFyc2VSZWxhdGlvbmFsKCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgUGFyc2VySW1wbGVtZW50YXRpb24ucHJvdG90eXBlLnBhcnNlUmVsYXRpb25hbCA9IGZ1bmN0aW9uIHBhcnNlUmVsYXRpb25hbCgpIHtcbiAgICB2YXIgcmVzdWx0ID0gdGhpcy5wYXJzZUFkZGl0aXZlKCk7XG5cbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgaWYgKHRoaXMub3B0aW9uYWwoJzwnKSkge1xuICAgICAgICByZXN1bHQgPSBuZXcgQmluYXJ5KCc8JywgcmVzdWx0LCB0aGlzLnBhcnNlQWRkaXRpdmUoKSk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9uYWwoJz4nKSkge1xuICAgICAgICByZXN1bHQgPSBuZXcgQmluYXJ5KCc+JywgcmVzdWx0LCB0aGlzLnBhcnNlQWRkaXRpdmUoKSk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9uYWwoJzw9JykpIHtcbiAgICAgICAgcmVzdWx0ID0gbmV3IEJpbmFyeSgnPD0nLCByZXN1bHQsIHRoaXMucGFyc2VBZGRpdGl2ZSgpKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25hbCgnPj0nKSkge1xuICAgICAgICByZXN1bHQgPSBuZXcgQmluYXJ5KCc+PScsIHJlc3VsdCwgdGhpcy5wYXJzZUFkZGl0aXZlKCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgUGFyc2VySW1wbGVtZW50YXRpb24ucHJvdG90eXBlLnBhcnNlQWRkaXRpdmUgPSBmdW5jdGlvbiBwYXJzZUFkZGl0aXZlKCkge1xuICAgIHZhciByZXN1bHQgPSB0aGlzLnBhcnNlTXVsdGlwbGljYXRpdmUoKTtcblxuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICBpZiAodGhpcy5vcHRpb25hbCgnKycpKSB7XG4gICAgICAgIHJlc3VsdCA9IG5ldyBCaW5hcnkoJysnLCByZXN1bHQsIHRoaXMucGFyc2VNdWx0aXBsaWNhdGl2ZSgpKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25hbCgnLScpKSB7XG4gICAgICAgIHJlc3VsdCA9IG5ldyBCaW5hcnkoJy0nLCByZXN1bHQsIHRoaXMucGFyc2VNdWx0aXBsaWNhdGl2ZSgpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIFBhcnNlckltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5wYXJzZU11bHRpcGxpY2F0aXZlID0gZnVuY3Rpb24gcGFyc2VNdWx0aXBsaWNhdGl2ZSgpIHtcbiAgICB2YXIgcmVzdWx0ID0gdGhpcy5wYXJzZVByZWZpeCgpO1xuXG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgIGlmICh0aGlzLm9wdGlvbmFsKCcqJykpIHtcbiAgICAgICAgcmVzdWx0ID0gbmV3IEJpbmFyeSgnKicsIHJlc3VsdCwgdGhpcy5wYXJzZVByZWZpeCgpKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25hbCgnJScpKSB7XG4gICAgICAgIHJlc3VsdCA9IG5ldyBCaW5hcnkoJyUnLCByZXN1bHQsIHRoaXMucGFyc2VQcmVmaXgoKSk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9uYWwoJy8nKSkge1xuICAgICAgICByZXN1bHQgPSBuZXcgQmluYXJ5KCcvJywgcmVzdWx0LCB0aGlzLnBhcnNlUHJlZml4KCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgUGFyc2VySW1wbGVtZW50YXRpb24ucHJvdG90eXBlLnBhcnNlUHJlZml4ID0gZnVuY3Rpb24gcGFyc2VQcmVmaXgoKSB7XG4gICAgaWYgKHRoaXMub3B0aW9uYWwoJysnKSkge1xuICAgICAgcmV0dXJuIHRoaXMucGFyc2VQcmVmaXgoKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9uYWwoJy0nKSkge1xuICAgICAgICByZXR1cm4gbmV3IEJpbmFyeSgnLScsIG5ldyBMaXRlcmFsUHJpbWl0aXZlKDApLCB0aGlzLnBhcnNlUHJlZml4KCkpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbmFsKCchJykpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcmVmaXhOb3QoJyEnLCB0aGlzLnBhcnNlUHJlZml4KCkpO1xuICAgICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucGFyc2VBY2Nlc3NPckNhbGxNZW1iZXIoKTtcbiAgfTtcblxuICBQYXJzZXJJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUucGFyc2VBY2Nlc3NPckNhbGxNZW1iZXIgPSBmdW5jdGlvbiBwYXJzZUFjY2Vzc09yQ2FsbE1lbWJlcigpIHtcbiAgICB2YXIgcmVzdWx0ID0gdGhpcy5wYXJzZVByaW1hcnkoKTtcblxuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICBpZiAodGhpcy5vcHRpb25hbCgnLicpKSB7XG4gICAgICAgIHZhciBuYW1lID0gdGhpcy5wZWVrLnRleHQ7XG5cbiAgICAgICAgdGhpcy5hZHZhbmNlKCk7XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9uYWwoJygnKSkge1xuICAgICAgICAgIHZhciBhcmdzID0gdGhpcy5wYXJzZUV4cHJlc3Npb25MaXN0KCcpJyk7XG4gICAgICAgICAgdGhpcy5leHBlY3QoJyknKTtcbiAgICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgQWNjZXNzVGhpcykge1xuICAgICAgICAgICAgcmVzdWx0ID0gbmV3IENhbGxTY29wZShuYW1lLCBhcmdzLCByZXN1bHQuYW5jZXN0b3IpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQgPSBuZXcgQ2FsbE1lbWJlcihyZXN1bHQsIG5hbWUsIGFyZ3MpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgQWNjZXNzVGhpcykge1xuICAgICAgICAgICAgcmVzdWx0ID0gbmV3IEFjY2Vzc1Njb3BlKG5hbWUsIHJlc3VsdC5hbmNlc3Rvcik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBBY2Nlc3NNZW1iZXIocmVzdWx0LCBuYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25hbCgnWycpKSB7XG4gICAgICAgIHZhciBrZXkgPSB0aGlzLnBhcnNlRXhwcmVzc2lvbigpO1xuICAgICAgICB0aGlzLmV4cGVjdCgnXScpO1xuICAgICAgICByZXN1bHQgPSBuZXcgQWNjZXNzS2V5ZWQocmVzdWx0LCBrZXkpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbmFsKCcoJykpIHtcbiAgICAgICAgdmFyIF9hcmdzID0gdGhpcy5wYXJzZUV4cHJlc3Npb25MaXN0KCcpJyk7XG4gICAgICAgIHRoaXMuZXhwZWN0KCcpJyk7XG4gICAgICAgIHJlc3VsdCA9IG5ldyBDYWxsRnVuY3Rpb24ocmVzdWx0LCBfYXJncyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBQYXJzZXJJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUucGFyc2VQcmltYXJ5ID0gZnVuY3Rpb24gcGFyc2VQcmltYXJ5KCkge1xuICAgIGlmICh0aGlzLm9wdGlvbmFsKCcoJykpIHtcbiAgICAgIHZhciByZXN1bHQgPSB0aGlzLnBhcnNlRXhwcmVzc2lvbigpO1xuICAgICAgdGhpcy5leHBlY3QoJyknKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbmFsKCdudWxsJykpIHtcbiAgICAgIHJldHVybiBuZXcgTGl0ZXJhbFByaW1pdGl2ZShudWxsKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9uYWwoJ3VuZGVmaW5lZCcpKSB7XG4gICAgICByZXR1cm4gbmV3IExpdGVyYWxQcmltaXRpdmUodW5kZWZpbmVkKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9uYWwoJ3RydWUnKSkge1xuICAgICAgcmV0dXJuIG5ldyBMaXRlcmFsUHJpbWl0aXZlKHRydWUpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25hbCgnZmFsc2UnKSkge1xuICAgICAgcmV0dXJuIG5ldyBMaXRlcmFsUHJpbWl0aXZlKGZhbHNlKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9uYWwoJ1snKSkge1xuICAgICAgdmFyIGVsZW1lbnRzID0gdGhpcy5wYXJzZUV4cHJlc3Npb25MaXN0KCddJyk7XG4gICAgICB0aGlzLmV4cGVjdCgnXScpO1xuICAgICAgcmV0dXJuIG5ldyBMaXRlcmFsQXJyYXkoZWxlbWVudHMpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5wZWVrLnRleHQgPT09ICd7Jykge1xuICAgICAgcmV0dXJuIHRoaXMucGFyc2VPYmplY3QoKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMucGVlay5rZXkgIT09IG51bGwgJiYgdGhpcy5wZWVrLmtleSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gdGhpcy5wYXJzZUFjY2Vzc09yQ2FsbFNjb3BlKCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnBlZWsudmFsdWUgIT09IG51bGwgJiYgdGhpcy5wZWVrLnZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHZhciB2YWx1ZSA9IHRoaXMucGVlay52YWx1ZTtcbiAgICAgIHRoaXMuYWR2YW5jZSgpO1xuICAgICAgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgPyBuZXcgTGl0ZXJhbFN0cmluZyh2YWx1ZSkgOiBuZXcgTGl0ZXJhbFByaW1pdGl2ZSh2YWx1ZSk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmluZGV4ID49IHRoaXMudG9rZW5zLmxlbmd0aCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmV4cGVjdGVkIGVuZCBvZiBleHByZXNzaW9uOiAnICsgdGhpcy5pbnB1dCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZXJyb3IoJ1VuZXhwZWN0ZWQgdG9rZW4gJyArIHRoaXMucGVlay50ZXh0KTtcbiAgICB9XG4gIH07XG5cbiAgUGFyc2VySW1wbGVtZW50YXRpb24ucHJvdG90eXBlLnBhcnNlQWNjZXNzT3JDYWxsU2NvcGUgPSBmdW5jdGlvbiBwYXJzZUFjY2Vzc09yQ2FsbFNjb3BlKCkge1xuICAgIHZhciBuYW1lID0gdGhpcy5wZWVrLmtleTtcblxuICAgIHRoaXMuYWR2YW5jZSgpO1xuXG4gICAgaWYgKG5hbWUgPT09ICckdGhpcycpIHtcbiAgICAgIHJldHVybiBuZXcgQWNjZXNzVGhpcygwKTtcbiAgICB9XG5cbiAgICB2YXIgYW5jZXN0b3IgPSAwO1xuICAgIHdoaWxlIChuYW1lID09PSAnJHBhcmVudCcpIHtcbiAgICAgIGFuY2VzdG9yKys7XG4gICAgICBpZiAodGhpcy5vcHRpb25hbCgnLicpKSB7XG4gICAgICAgIG5hbWUgPSB0aGlzLnBlZWsua2V5O1xuICAgICAgICB0aGlzLmFkdmFuY2UoKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5wZWVrID09PSBFT0YgfHwgdGhpcy5wZWVrLnRleHQgPT09ICcoJyB8fCB0aGlzLnBlZWsudGV4dCA9PT0gJ1snIHx8IHRoaXMucGVlay50ZXh0ID09PSAnfScpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBY2Nlc3NUaGlzKGFuY2VzdG9yKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZXJyb3IoJ1VuZXhwZWN0ZWQgdG9rZW4gJyArIHRoaXMucGVlay50ZXh0KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5vcHRpb25hbCgnKCcpKSB7XG4gICAgICB2YXIgYXJncyA9IHRoaXMucGFyc2VFeHByZXNzaW9uTGlzdCgnKScpO1xuICAgICAgdGhpcy5leHBlY3QoJyknKTtcbiAgICAgIHJldHVybiBuZXcgQ2FsbFNjb3BlKG5hbWUsIGFyZ3MsIGFuY2VzdG9yKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IEFjY2Vzc1Njb3BlKG5hbWUsIGFuY2VzdG9yKTtcbiAgfTtcblxuICBQYXJzZXJJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUucGFyc2VPYmplY3QgPSBmdW5jdGlvbiBwYXJzZU9iamVjdCgpIHtcbiAgICB2YXIga2V5cyA9IFtdO1xuICAgIHZhciB2YWx1ZXMgPSBbXTtcblxuICAgIHRoaXMuZXhwZWN0KCd7Jyk7XG5cbiAgICBpZiAodGhpcy5wZWVrLnRleHQgIT09ICd9Jykge1xuICAgICAgZG8ge1xuICAgICAgICB2YXIgcGVlayA9IHRoaXMucGVlaztcbiAgICAgICAgdmFyIHZhbHVlID0gcGVlay52YWx1ZTtcbiAgICAgICAga2V5cy5wdXNoKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgPyB2YWx1ZSA6IHBlZWsudGV4dCk7XG5cbiAgICAgICAgdGhpcy5hZHZhbmNlKCk7XG4gICAgICAgIGlmIChwZWVrLmtleSAmJiAodGhpcy5wZWVrLnRleHQgPT09ICcsJyB8fCB0aGlzLnBlZWsudGV4dCA9PT0gJ30nKSkge1xuICAgICAgICAgIC0tdGhpcy5pbmRleDtcbiAgICAgICAgICB2YWx1ZXMucHVzaCh0aGlzLnBhcnNlQWNjZXNzT3JDYWxsU2NvcGUoKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5leHBlY3QoJzonKTtcbiAgICAgICAgICB2YWx1ZXMucHVzaCh0aGlzLnBhcnNlRXhwcmVzc2lvbigpKTtcbiAgICAgICAgfVxuICAgICAgfSB3aGlsZSAodGhpcy5vcHRpb25hbCgnLCcpKTtcbiAgICB9XG5cbiAgICB0aGlzLmV4cGVjdCgnfScpO1xuXG4gICAgcmV0dXJuIG5ldyBMaXRlcmFsT2JqZWN0KGtleXMsIHZhbHVlcyk7XG4gIH07XG5cbiAgUGFyc2VySW1wbGVtZW50YXRpb24ucHJvdG90eXBlLnBhcnNlRXhwcmVzc2lvbkxpc3QgPSBmdW5jdGlvbiBwYXJzZUV4cHJlc3Npb25MaXN0KHRlcm1pbmF0b3IpIHtcbiAgICB2YXIgcmVzdWx0ID0gW107XG5cbiAgICBpZiAodGhpcy5wZWVrLnRleHQgIT09IHRlcm1pbmF0b3IpIHtcbiAgICAgIGRvIHtcbiAgICAgICAgcmVzdWx0LnB1c2godGhpcy5wYXJzZUV4cHJlc3Npb24oKSk7XG4gICAgICB9IHdoaWxlICh0aGlzLm9wdGlvbmFsKCcsJykpO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgUGFyc2VySW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9wdGlvbmFsID0gZnVuY3Rpb24gb3B0aW9uYWwodGV4dCkge1xuICAgIGlmICh0aGlzLnBlZWsudGV4dCA9PT0gdGV4dCkge1xuICAgICAgdGhpcy5hZHZhbmNlKCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgUGFyc2VySW1wbGVtZW50YXRpb24ucHJvdG90eXBlLmV4cGVjdCA9IGZ1bmN0aW9uIGV4cGVjdCh0ZXh0KSB7XG4gICAgaWYgKHRoaXMucGVlay50ZXh0ID09PSB0ZXh0KSB7XG4gICAgICB0aGlzLmFkdmFuY2UoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5lcnJvcignTWlzc2luZyBleHBlY3RlZCAnICsgdGV4dCk7XG4gICAgfVxuICB9O1xuXG4gIFBhcnNlckltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5hZHZhbmNlID0gZnVuY3Rpb24gYWR2YW5jZSgpIHtcbiAgICB0aGlzLmluZGV4Kys7XG4gIH07XG5cbiAgUGFyc2VySW1wbGVtZW50YXRpb24ucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gZXJyb3IobWVzc2FnZSkge1xuICAgIHZhciBsb2NhdGlvbiA9IHRoaXMuaW5kZXggPCB0aGlzLnRva2Vucy5sZW5ndGggPyAnYXQgY29sdW1uICcgKyAodGhpcy50b2tlbnNbdGhpcy5pbmRleF0uaW5kZXggKyAxKSArICcgaW4nIDogJ2F0IHRoZSBlbmQgb2YgdGhlIGV4cHJlc3Npb24nO1xuXG4gICAgdGhyb3cgbmV3IEVycm9yKCdQYXJzZXIgRXJyb3I6ICcgKyBtZXNzYWdlICsgJyAnICsgbG9jYXRpb24gKyAnIFsnICsgdGhpcy5pbnB1dCArICddJyk7XG4gIH07XG5cbiAgX2NyZWF0ZUNsYXNzKFBhcnNlckltcGxlbWVudGF0aW9uLCBbe1xuICAgIGtleTogJ3BlZWsnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuaW5kZXggPCB0aGlzLnRva2Vucy5sZW5ndGggPyB0aGlzLnRva2Vuc1t0aGlzLmluZGV4XSA6IEVPRjtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gUGFyc2VySW1wbGVtZW50YXRpb247XG59KCk7XG5cbnZhciBtYXBQcm90byA9IE1hcC5wcm90b3R5cGU7XG5cbmZ1bmN0aW9uIF9nZXRNYXBPYnNlcnZlcih0YXNrUXVldWUsIG1hcCkge1xuICByZXR1cm4gTW9kaWZ5TWFwT2JzZXJ2ZXIuZm9yKHRhc2tRdWV1ZSwgbWFwKTtcbn1cblxuZXhwb3J0cy5nZXRNYXBPYnNlcnZlciA9IF9nZXRNYXBPYnNlcnZlcjtcblxudmFyIE1vZGlmeU1hcE9ic2VydmVyID0gZnVuY3Rpb24gKF9Nb2RpZnlDb2xsZWN0aW9uT2JzZTIpIHtcbiAgX2luaGVyaXRzKE1vZGlmeU1hcE9ic2VydmVyLCBfTW9kaWZ5Q29sbGVjdGlvbk9ic2UyKTtcblxuICBmdW5jdGlvbiBNb2RpZnlNYXBPYnNlcnZlcih0YXNrUXVldWUsIG1hcCkge1xuICAgIFxuXG4gICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9Nb2RpZnlDb2xsZWN0aW9uT2JzZTIuY2FsbCh0aGlzLCB0YXNrUXVldWUsIG1hcCkpO1xuICB9XG5cbiAgTW9kaWZ5TWFwT2JzZXJ2ZXIuZm9yID0gZnVuY3Rpb24gX2Zvcih0YXNrUXVldWUsIG1hcCkge1xuICAgIGlmICghKCdfX21hcF9vYnNlcnZlcl9fJyBpbiBtYXApKSB7XG4gICAgICB2YXIgb2JzZXJ2ZXIgPSBNb2RpZnlNYXBPYnNlcnZlci5jcmVhdGUodGFza1F1ZXVlLCBtYXApO1xuICAgICAgUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eShtYXAsICdfX21hcF9vYnNlcnZlcl9fJywgeyB2YWx1ZTogb2JzZXJ2ZXIsIGVudW1lcmFibGU6IGZhbHNlLCBjb25maWd1cmFibGU6IGZhbHNlIH0pO1xuICAgIH1cbiAgICByZXR1cm4gbWFwLl9fbWFwX29ic2VydmVyX187XG4gIH07XG5cbiAgTW9kaWZ5TWFwT2JzZXJ2ZXIuY3JlYXRlID0gZnVuY3Rpb24gY3JlYXRlKHRhc2tRdWV1ZSwgbWFwKSB7XG4gICAgdmFyIG9ic2VydmVyID0gbmV3IE1vZGlmeU1hcE9ic2VydmVyKHRhc2tRdWV1ZSwgbWFwKTtcblxuICAgIHZhciBwcm90byA9IG1hcFByb3RvO1xuICAgIGlmIChwcm90by5hZGQgIT09IG1hcC5hZGQgfHwgcHJvdG8uZGVsZXRlICE9PSBtYXAuZGVsZXRlIHx8IHByb3RvLmNsZWFyICE9PSBtYXAuY2xlYXIpIHtcbiAgICAgIHByb3RvID0ge1xuICAgICAgICBhZGQ6IG1hcC5hZGQsXG4gICAgICAgIGRlbGV0ZTogbWFwLmRlbGV0ZSxcbiAgICAgICAgY2xlYXI6IG1hcC5jbGVhclxuICAgICAgfTtcbiAgICB9XG5cbiAgICBtYXAuc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGhhc1ZhbHVlID0gbWFwLmhhcyhhcmd1bWVudHNbMF0pO1xuICAgICAgdmFyIHR5cGUgPSBoYXNWYWx1ZSA/ICd1cGRhdGUnIDogJ2FkZCc7XG4gICAgICB2YXIgb2xkVmFsdWUgPSBtYXAuZ2V0KGFyZ3VtZW50c1swXSk7XG4gICAgICB2YXIgbWV0aG9kQ2FsbFJlc3VsdCA9IHByb3RvLnNldC5hcHBseShtYXAsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAoIWhhc1ZhbHVlIHx8IG9sZFZhbHVlICE9PSBtYXAuZ2V0KGFyZ3VtZW50c1swXSkpIHtcbiAgICAgICAgb2JzZXJ2ZXIuYWRkQ2hhbmdlUmVjb3JkKHtcbiAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgIG9iamVjdDogbWFwLFxuICAgICAgICAgIGtleTogYXJndW1lbnRzWzBdLFxuICAgICAgICAgIG9sZFZhbHVlOiBvbGRWYWx1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBtZXRob2RDYWxsUmVzdWx0O1xuICAgIH07XG5cbiAgICBtYXAuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGhhc1ZhbHVlID0gbWFwLmhhcyhhcmd1bWVudHNbMF0pO1xuICAgICAgdmFyIG9sZFZhbHVlID0gbWFwLmdldChhcmd1bWVudHNbMF0pO1xuICAgICAgdmFyIG1ldGhvZENhbGxSZXN1bHQgPSBwcm90by5kZWxldGUuYXBwbHkobWFwLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKGhhc1ZhbHVlKSB7XG4gICAgICAgIG9ic2VydmVyLmFkZENoYW5nZVJlY29yZCh7XG4gICAgICAgICAgdHlwZTogJ2RlbGV0ZScsXG4gICAgICAgICAgb2JqZWN0OiBtYXAsXG4gICAgICAgICAga2V5OiBhcmd1bWVudHNbMF0sXG4gICAgICAgICAgb2xkVmFsdWU6IG9sZFZhbHVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1ldGhvZENhbGxSZXN1bHQ7XG4gICAgfTtcblxuICAgIG1hcC5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBtZXRob2RDYWxsUmVzdWx0ID0gcHJvdG8uY2xlYXIuYXBwbHkobWFwLCBhcmd1bWVudHMpO1xuICAgICAgb2JzZXJ2ZXIuYWRkQ2hhbmdlUmVjb3JkKHtcbiAgICAgICAgdHlwZTogJ2NsZWFyJyxcbiAgICAgICAgb2JqZWN0OiBtYXBcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG1ldGhvZENhbGxSZXN1bHQ7XG4gICAgfTtcblxuICAgIHJldHVybiBvYnNlcnZlcjtcbiAgfTtcblxuICByZXR1cm4gTW9kaWZ5TWFwT2JzZXJ2ZXI7XG59KE1vZGlmeUNvbGxlY3Rpb25PYnNlcnZlcik7XG5cbmZ1bmN0aW9uIGZpbmRPcmlnaW5hbEV2ZW50VGFyZ2V0KGV2ZW50KSB7XG4gIHJldHVybiBldmVudC5wYXRoICYmIGV2ZW50LnBhdGhbMF0gfHwgZXZlbnQuZGVlcFBhdGggJiYgZXZlbnQuZGVlcFBhdGhbMF0gfHwgZXZlbnQudGFyZ2V0O1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxlZ2F0ZWRFdmVudChldmVudCkge1xuICB2YXIgdGFyZ2V0ID0gZmluZE9yaWdpbmFsRXZlbnRUYXJnZXQoZXZlbnQpO1xuICB2YXIgY2FsbGJhY2sgPSB2b2lkIDA7XG5cbiAgd2hpbGUgKHRhcmdldCAmJiAhY2FsbGJhY2spIHtcbiAgICBpZiAodGFyZ2V0LmRlbGVnYXRlZENhbGxiYWNrcykge1xuICAgICAgY2FsbGJhY2sgPSB0YXJnZXQuZGVsZWdhdGVkQ2FsbGJhY2tzW2V2ZW50LnR5cGVdO1xuICAgIH1cblxuICAgIGlmICghY2FsbGJhY2spIHtcbiAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlO1xuICAgIH1cbiAgfVxuXG4gIGlmIChjYWxsYmFjaykge1xuICAgIGNhbGxiYWNrKGV2ZW50KTtcbiAgfVxufVxuXG52YXIgRGVsZWdhdGVIYW5kbGVyRW50cnkgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIERlbGVnYXRlSGFuZGxlckVudHJ5KGV2ZW50TmFtZSkge1xuICAgIFxuXG4gICAgdGhpcy5ldmVudE5hbWUgPSBldmVudE5hbWU7XG4gICAgdGhpcy5jb3VudCA9IDA7XG4gIH1cblxuICBEZWxlZ2F0ZUhhbmRsZXJFbnRyeS5wcm90b3R5cGUuaW5jcmVtZW50ID0gZnVuY3Rpb24gaW5jcmVtZW50KCkge1xuICAgIHRoaXMuY291bnQrKztcblxuICAgIGlmICh0aGlzLmNvdW50ID09PSAxKSB7XG4gICAgICBfYXVyZWxpYVBhbC5ET00uYWRkRXZlbnRMaXN0ZW5lcih0aGlzLmV2ZW50TmFtZSwgaGFuZGxlRGVsZWdhdGVkRXZlbnQsIGZhbHNlKTtcbiAgICB9XG4gIH07XG5cbiAgRGVsZWdhdGVIYW5kbGVyRW50cnkucHJvdG90eXBlLmRlY3JlbWVudCA9IGZ1bmN0aW9uIGRlY3JlbWVudCgpIHtcbiAgICB0aGlzLmNvdW50LS07XG5cbiAgICBpZiAodGhpcy5jb3VudCA9PT0gMCkge1xuICAgICAgX2F1cmVsaWFQYWwuRE9NLnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5ldmVudE5hbWUsIGhhbmRsZURlbGVnYXRlZEV2ZW50KTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIERlbGVnYXRlSGFuZGxlckVudHJ5O1xufSgpO1xuXG52YXIgRGVmYXVsdEV2ZW50U3RyYXRlZ3kgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIERlZmF1bHRFdmVudFN0cmF0ZWd5KCkge1xuICAgIFxuXG4gICAgdGhpcy5kZWxlZ2F0ZWRIYW5kbGVycyA9IFtdO1xuICB9XG5cbiAgRGVmYXVsdEV2ZW50U3RyYXRlZ3kucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIHN1YnNjcmliZSh0YXJnZXQsIHRhcmdldEV2ZW50LCBjYWxsYmFjaywgZGVsZWdhdGUpIHtcbiAgICB2YXIgX3RoaXMyMiA9IHRoaXM7XG5cbiAgICBpZiAoZGVsZWdhdGUpIHtcbiAgICAgIHZhciBfcmV0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZGVsZWdhdGVkSGFuZGxlcnMgPSBfdGhpczIyLmRlbGVnYXRlZEhhbmRsZXJzO1xuICAgICAgICB2YXIgaGFuZGxlckVudHJ5ID0gZGVsZWdhdGVkSGFuZGxlcnNbdGFyZ2V0RXZlbnRdIHx8IChkZWxlZ2F0ZWRIYW5kbGVyc1t0YXJnZXRFdmVudF0gPSBuZXcgRGVsZWdhdGVIYW5kbGVyRW50cnkodGFyZ2V0RXZlbnQpKTtcbiAgICAgICAgdmFyIGRlbGVnYXRlZENhbGxiYWNrcyA9IHRhcmdldC5kZWxlZ2F0ZWRDYWxsYmFja3MgfHwgKHRhcmdldC5kZWxlZ2F0ZWRDYWxsYmFja3MgPSB7fSk7XG5cbiAgICAgICAgaGFuZGxlckVudHJ5LmluY3JlbWVudCgpO1xuICAgICAgICBkZWxlZ2F0ZWRDYWxsYmFja3NbdGFyZ2V0RXZlbnRdID0gY2FsbGJhY2s7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB2OiBmdW5jdGlvbiB2KCkge1xuICAgICAgICAgICAgaGFuZGxlckVudHJ5LmRlY3JlbWVudCgpO1xuICAgICAgICAgICAgZGVsZWdhdGVkQ2FsbGJhY2tzW3RhcmdldEV2ZW50XSA9IG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSgpO1xuXG4gICAgICBpZiAoKHR5cGVvZiBfcmV0ID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihfcmV0KSkgPT09IFwib2JqZWN0XCIpIHJldHVybiBfcmV0LnY7XG4gICAgfVxuXG4gICAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIodGFyZ2V0RXZlbnQsIGNhbGxiYWNrLCBmYWxzZSk7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgdGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIodGFyZ2V0RXZlbnQsIGNhbGxiYWNrKTtcbiAgICB9O1xuICB9O1xuXG4gIHJldHVybiBEZWZhdWx0RXZlbnRTdHJhdGVneTtcbn0oKTtcblxudmFyIEV2ZW50TWFuYWdlciA9IGV4cG9ydHMuRXZlbnRNYW5hZ2VyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBFdmVudE1hbmFnZXIoKSB7XG4gICAgXG5cbiAgICB0aGlzLmVsZW1lbnRIYW5kbGVyTG9va3VwID0ge307XG4gICAgdGhpcy5ldmVudFN0cmF0ZWd5TG9va3VwID0ge307XG5cbiAgICB0aGlzLnJlZ2lzdGVyRWxlbWVudENvbmZpZyh7XG4gICAgICB0YWdOYW1lOiAnaW5wdXQnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICB2YWx1ZTogWydjaGFuZ2UnLCAnaW5wdXQnXSxcbiAgICAgICAgY2hlY2tlZDogWydjaGFuZ2UnLCAnaW5wdXQnXSxcbiAgICAgICAgZmlsZXM6IFsnY2hhbmdlJywgJ2lucHV0J11cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMucmVnaXN0ZXJFbGVtZW50Q29uZmlnKHtcbiAgICAgIHRhZ05hbWU6ICd0ZXh0YXJlYScsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHZhbHVlOiBbJ2NoYW5nZScsICdpbnB1dCddXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLnJlZ2lzdGVyRWxlbWVudENvbmZpZyh7XG4gICAgICB0YWdOYW1lOiAnc2VsZWN0JyxcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgdmFsdWU6IFsnY2hhbmdlJ11cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMucmVnaXN0ZXJFbGVtZW50Q29uZmlnKHtcbiAgICAgIHRhZ05hbWU6ICdjb250ZW50IGVkaXRhYmxlJyxcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgdmFsdWU6IFsnY2hhbmdlJywgJ2lucHV0JywgJ2JsdXInLCAna2V5dXAnLCAncGFzdGUnXVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5yZWdpc3RlckVsZW1lbnRDb25maWcoe1xuICAgICAgdGFnTmFtZTogJ3Njcm9sbGFibGUgZWxlbWVudCcsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHNjcm9sbFRvcDogWydzY3JvbGwnXSxcbiAgICAgICAgc2Nyb2xsTGVmdDogWydzY3JvbGwnXVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5kZWZhdWx0RXZlbnRTdHJhdGVneSA9IG5ldyBEZWZhdWx0RXZlbnRTdHJhdGVneSgpO1xuICB9XG5cbiAgRXZlbnRNYW5hZ2VyLnByb3RvdHlwZS5yZWdpc3RlckVsZW1lbnRDb25maWcgPSBmdW5jdGlvbiByZWdpc3RlckVsZW1lbnRDb25maWcoY29uZmlnKSB7XG4gICAgdmFyIHRhZ05hbWUgPSBjb25maWcudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIHZhciBwcm9wZXJ0aWVzID0gY29uZmlnLnByb3BlcnRpZXM7XG4gICAgdmFyIHByb3BlcnR5TmFtZSA9IHZvaWQgMDtcblxuICAgIHRoaXMuZWxlbWVudEhhbmRsZXJMb29rdXBbdGFnTmFtZV0gPSB7fTtcblxuICAgIGZvciAocHJvcGVydHlOYW1lIGluIHByb3BlcnRpZXMpIHtcbiAgICAgIGlmIChwcm9wZXJ0aWVzLmhhc093blByb3BlcnR5KHByb3BlcnR5TmFtZSkpIHtcbiAgICAgICAgdGhpcy5yZWdpc3RlckVsZW1lbnRQcm9wZXJ0eUNvbmZpZyh0YWdOYW1lLCBwcm9wZXJ0eU5hbWUsIHByb3BlcnRpZXNbcHJvcGVydHlOYW1lXSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIEV2ZW50TWFuYWdlci5wcm90b3R5cGUucmVnaXN0ZXJFbGVtZW50UHJvcGVydHlDb25maWcgPSBmdW5jdGlvbiByZWdpc3RlckVsZW1lbnRQcm9wZXJ0eUNvbmZpZyh0YWdOYW1lLCBwcm9wZXJ0eU5hbWUsIGV2ZW50cykge1xuICAgIHRoaXMuZWxlbWVudEhhbmRsZXJMb29rdXBbdGFnTmFtZV1bcHJvcGVydHlOYW1lXSA9IHRoaXMuY3JlYXRlRWxlbWVudEhhbmRsZXIoZXZlbnRzKTtcbiAgfTtcblxuICBFdmVudE1hbmFnZXIucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnRIYW5kbGVyID0gZnVuY3Rpb24gY3JlYXRlRWxlbWVudEhhbmRsZXIoZXZlbnRzKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1YnNjcmliZTogZnVuY3Rpb24gc3Vic2NyaWJlKHRhcmdldCwgY2FsbGJhY2spIHtcbiAgICAgICAgZXZlbnRzLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZUV2ZW50KSB7XG4gICAgICAgICAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoY2hhbmdlRXZlbnQsIGNhbGxiYWNrLCBmYWxzZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgZXZlbnRzLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZUV2ZW50KSB7XG4gICAgICAgICAgICB0YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihjaGFuZ2VFdmVudCwgY2FsbGJhY2spO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH07XG4gIH07XG5cbiAgRXZlbnRNYW5hZ2VyLnByb3RvdHlwZS5yZWdpc3RlckVsZW1lbnRIYW5kbGVyID0gZnVuY3Rpb24gcmVnaXN0ZXJFbGVtZW50SGFuZGxlcih0YWdOYW1lLCBoYW5kbGVyKSB7XG4gICAgdGhpcy5lbGVtZW50SGFuZGxlckxvb2t1cFt0YWdOYW1lLnRvTG93ZXJDYXNlKCldID0gaGFuZGxlcjtcbiAgfTtcblxuICBFdmVudE1hbmFnZXIucHJvdG90eXBlLnJlZ2lzdGVyRXZlbnRTdHJhdGVneSA9IGZ1bmN0aW9uIHJlZ2lzdGVyRXZlbnRTdHJhdGVneShldmVudE5hbWUsIHN0cmF0ZWd5KSB7XG4gICAgdGhpcy5ldmVudFN0cmF0ZWd5TG9va3VwW2V2ZW50TmFtZV0gPSBzdHJhdGVneTtcbiAgfTtcblxuICBFdmVudE1hbmFnZXIucHJvdG90eXBlLmdldEVsZW1lbnRIYW5kbGVyID0gZnVuY3Rpb24gZ2V0RWxlbWVudEhhbmRsZXIodGFyZ2V0LCBwcm9wZXJ0eU5hbWUpIHtcbiAgICB2YXIgdGFnTmFtZSA9IHZvaWQgMDtcbiAgICB2YXIgbG9va3VwID0gdGhpcy5lbGVtZW50SGFuZGxlckxvb2t1cDtcblxuICAgIGlmICh0YXJnZXQudGFnTmFtZSkge1xuICAgICAgdGFnTmFtZSA9IHRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgIGlmIChsb29rdXBbdGFnTmFtZV0gJiYgbG9va3VwW3RhZ05hbWVdW3Byb3BlcnR5TmFtZV0pIHtcbiAgICAgICAgcmV0dXJuIGxvb2t1cFt0YWdOYW1lXVtwcm9wZXJ0eU5hbWVdO1xuICAgICAgfVxuXG4gICAgICBpZiAocHJvcGVydHlOYW1lID09PSAndGV4dENvbnRlbnQnIHx8IHByb3BlcnR5TmFtZSA9PT0gJ2lubmVySFRNTCcpIHtcbiAgICAgICAgcmV0dXJuIGxvb2t1cFsnY29udGVudCBlZGl0YWJsZSddLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICBpZiAocHJvcGVydHlOYW1lID09PSAnc2Nyb2xsVG9wJyB8fCBwcm9wZXJ0eU5hbWUgPT09ICdzY3JvbGxMZWZ0Jykge1xuICAgICAgICByZXR1cm4gbG9va3VwWydzY3JvbGxhYmxlIGVsZW1lbnQnXVtwcm9wZXJ0eU5hbWVdO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIEV2ZW50TWFuYWdlci5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXIodGFyZ2V0LCB0YXJnZXRFdmVudCwgY2FsbGJhY2ssIGRlbGVnYXRlKSB7XG4gICAgcmV0dXJuICh0aGlzLmV2ZW50U3RyYXRlZ3lMb29rdXBbdGFyZ2V0RXZlbnRdIHx8IHRoaXMuZGVmYXVsdEV2ZW50U3RyYXRlZ3kpLnN1YnNjcmliZSh0YXJnZXQsIHRhcmdldEV2ZW50LCBjYWxsYmFjaywgZGVsZWdhdGUpO1xuICB9O1xuXG4gIHJldHVybiBFdmVudE1hbmFnZXI7XG59KCk7XG5cbnZhciBEaXJ0eUNoZWNrZXIgPSBleHBvcnRzLkRpcnR5Q2hlY2tlciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gRGlydHlDaGVja2VyKCkge1xuICAgIFxuXG4gICAgdGhpcy50cmFja2VkID0gW107XG4gICAgdGhpcy5jaGVja0RlbGF5ID0gMTIwO1xuICB9XG5cbiAgRGlydHlDaGVja2VyLnByb3RvdHlwZS5hZGRQcm9wZXJ0eSA9IGZ1bmN0aW9uIGFkZFByb3BlcnR5KHByb3BlcnR5KSB7XG4gICAgdmFyIHRyYWNrZWQgPSB0aGlzLnRyYWNrZWQ7XG5cbiAgICB0cmFja2VkLnB1c2gocHJvcGVydHkpO1xuXG4gICAgaWYgKHRyYWNrZWQubGVuZ3RoID09PSAxKSB7XG4gICAgICB0aGlzLnNjaGVkdWxlRGlydHlDaGVjaygpO1xuICAgIH1cbiAgfTtcblxuICBEaXJ0eUNoZWNrZXIucHJvdG90eXBlLnJlbW92ZVByb3BlcnR5ID0gZnVuY3Rpb24gcmVtb3ZlUHJvcGVydHkocHJvcGVydHkpIHtcbiAgICB2YXIgdHJhY2tlZCA9IHRoaXMudHJhY2tlZDtcbiAgICB0cmFja2VkLnNwbGljZSh0cmFja2VkLmluZGV4T2YocHJvcGVydHkpLCAxKTtcbiAgfTtcblxuICBEaXJ0eUNoZWNrZXIucHJvdG90eXBlLnNjaGVkdWxlRGlydHlDaGVjayA9IGZ1bmN0aW9uIHNjaGVkdWxlRGlydHlDaGVjaygpIHtcbiAgICB2YXIgX3RoaXMyMyA9IHRoaXM7XG5cbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBfdGhpczIzLmNoZWNrKCk7XG4gICAgfSwgdGhpcy5jaGVja0RlbGF5KTtcbiAgfTtcblxuICBEaXJ0eUNoZWNrZXIucHJvdG90eXBlLmNoZWNrID0gZnVuY3Rpb24gY2hlY2soKSB7XG4gICAgdmFyIHRyYWNrZWQgPSB0aGlzLnRyYWNrZWQ7XG4gICAgdmFyIGkgPSB0cmFja2VkLmxlbmd0aDtcblxuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIHZhciBjdXJyZW50ID0gdHJhY2tlZFtpXTtcblxuICAgICAgaWYgKGN1cnJlbnQuaXNEaXJ0eSgpKSB7XG4gICAgICAgIGN1cnJlbnQuY2FsbCgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0cmFja2VkLmxlbmd0aCkge1xuICAgICAgdGhpcy5zY2hlZHVsZURpcnR5Q2hlY2soKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIERpcnR5Q2hlY2tlcjtcbn0oKTtcblxudmFyIERpcnR5Q2hlY2tQcm9wZXJ0eSA9IGV4cG9ydHMuRGlydHlDaGVja1Byb3BlcnR5ID0gKF9kZWM1ID0gc3Vic2NyaWJlckNvbGxlY3Rpb24oKSwgX2RlYzUoX2NsYXNzNSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gRGlydHlDaGVja1Byb3BlcnR5KGRpcnR5Q2hlY2tlciwgb2JqLCBwcm9wZXJ0eU5hbWUpIHtcbiAgICBcblxuICAgIHRoaXMuZGlydHlDaGVja2VyID0gZGlydHlDaGVja2VyO1xuICAgIHRoaXMub2JqID0gb2JqO1xuICAgIHRoaXMucHJvcGVydHlOYW1lID0gcHJvcGVydHlOYW1lO1xuICB9XG5cbiAgRGlydHlDaGVja1Byb3BlcnR5LnByb3RvdHlwZS5nZXRWYWx1ZSA9IGZ1bmN0aW9uIGdldFZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLm9ialt0aGlzLnByb3BlcnR5TmFtZV07XG4gIH07XG5cbiAgRGlydHlDaGVja1Byb3BlcnR5LnByb3RvdHlwZS5zZXRWYWx1ZSA9IGZ1bmN0aW9uIHNldFZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgdGhpcy5vYmpbdGhpcy5wcm9wZXJ0eU5hbWVdID0gbmV3VmFsdWU7XG4gIH07XG5cbiAgRGlydHlDaGVja1Byb3BlcnR5LnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gY2FsbCgpIHtcbiAgICB2YXIgb2xkVmFsdWUgPSB0aGlzLm9sZFZhbHVlO1xuICAgIHZhciBuZXdWYWx1ZSA9IHRoaXMuZ2V0VmFsdWUoKTtcblxuICAgIHRoaXMuY2FsbFN1YnNjcmliZXJzKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG5cbiAgICB0aGlzLm9sZFZhbHVlID0gbmV3VmFsdWU7XG4gIH07XG5cbiAgRGlydHlDaGVja1Byb3BlcnR5LnByb3RvdHlwZS5pc0RpcnR5ID0gZnVuY3Rpb24gaXNEaXJ0eSgpIHtcbiAgICByZXR1cm4gdGhpcy5vbGRWYWx1ZSAhPT0gdGhpcy5vYmpbdGhpcy5wcm9wZXJ0eU5hbWVdO1xuICB9O1xuXG4gIERpcnR5Q2hlY2tQcm9wZXJ0eS5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gc3Vic2NyaWJlKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gICAgaWYgKCF0aGlzLmhhc1N1YnNjcmliZXJzKCkpIHtcbiAgICAgIHRoaXMub2xkVmFsdWUgPSB0aGlzLmdldFZhbHVlKCk7XG4gICAgICB0aGlzLmRpcnR5Q2hlY2tlci5hZGRQcm9wZXJ0eSh0aGlzKTtcbiAgICB9XG4gICAgdGhpcy5hZGRTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKTtcbiAgfTtcblxuICBEaXJ0eUNoZWNrUHJvcGVydHkucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gdW5zdWJzY3JpYmUoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgICBpZiAodGhpcy5yZW1vdmVTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKSAmJiAhdGhpcy5oYXNTdWJzY3JpYmVycygpKSB7XG4gICAgICB0aGlzLmRpcnR5Q2hlY2tlci5yZW1vdmVQcm9wZXJ0eSh0aGlzKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIERpcnR5Q2hlY2tQcm9wZXJ0eTtcbn0oKSkgfHwgX2NsYXNzNSk7XG5cblxudmFyIGxvZ2dlciA9IExvZ01hbmFnZXIuZ2V0TG9nZ2VyKCdwcm9wZXJ0eS1vYnNlcnZhdGlvbicpO1xuXG52YXIgcHJvcGVydHlBY2Nlc3NvciA9IGV4cG9ydHMucHJvcGVydHlBY2Nlc3NvciA9IHtcbiAgZ2V0VmFsdWU6IGZ1bmN0aW9uIGdldFZhbHVlKG9iaiwgcHJvcGVydHlOYW1lKSB7XG4gICAgcmV0dXJuIG9ialtwcm9wZXJ0eU5hbWVdO1xuICB9LFxuICBzZXRWYWx1ZTogZnVuY3Rpb24gc2V0VmFsdWUodmFsdWUsIG9iaiwgcHJvcGVydHlOYW1lKSB7XG4gICAgb2JqW3Byb3BlcnR5TmFtZV0gPSB2YWx1ZTtcbiAgfVxufTtcblxudmFyIFByaW1pdGl2ZU9ic2VydmVyID0gZXhwb3J0cy5QcmltaXRpdmVPYnNlcnZlciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUHJpbWl0aXZlT2JzZXJ2ZXIocHJpbWl0aXZlLCBwcm9wZXJ0eU5hbWUpIHtcbiAgICBcblxuICAgIHRoaXMuZG9Ob3RDYWNoZSA9IHRydWU7XG5cbiAgICB0aGlzLnByaW1pdGl2ZSA9IHByaW1pdGl2ZTtcbiAgICB0aGlzLnByb3BlcnR5TmFtZSA9IHByb3BlcnR5TmFtZTtcbiAgfVxuXG4gIFByaW1pdGl2ZU9ic2VydmVyLnByb3RvdHlwZS5nZXRWYWx1ZSA9IGZ1bmN0aW9uIGdldFZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLnByaW1pdGl2ZVt0aGlzLnByb3BlcnR5TmFtZV07XG4gIH07XG5cbiAgUHJpbWl0aXZlT2JzZXJ2ZXIucHJvdG90eXBlLnNldFZhbHVlID0gZnVuY3Rpb24gc2V0VmFsdWUoKSB7XG4gICAgdmFyIHR5cGUgPSBfdHlwZW9mKHRoaXMucHJpbWl0aXZlKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSAnICsgdGhpcy5wcm9wZXJ0eU5hbWUgKyAnIHByb3BlcnR5IG9mIGEgJyArIHR5cGUgKyAnICgnICsgdGhpcy5wcmltaXRpdmUgKyAnKSBjYW5ub3QgYmUgYXNzaWduZWQuJyk7XG4gIH07XG5cbiAgUHJpbWl0aXZlT2JzZXJ2ZXIucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIHN1YnNjcmliZSgpIHt9O1xuXG4gIFByaW1pdGl2ZU9ic2VydmVyLnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uIHVuc3Vic2NyaWJlKCkge307XG5cbiAgcmV0dXJuIFByaW1pdGl2ZU9ic2VydmVyO1xufSgpO1xuXG52YXIgU2V0dGVyT2JzZXJ2ZXIgPSBleHBvcnRzLlNldHRlck9ic2VydmVyID0gKF9kZWM2ID0gc3Vic2NyaWJlckNvbGxlY3Rpb24oKSwgX2RlYzYoX2NsYXNzNyA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gU2V0dGVyT2JzZXJ2ZXIodGFza1F1ZXVlLCBvYmosIHByb3BlcnR5TmFtZSkge1xuICAgIFxuXG4gICAgdGhpcy50YXNrUXVldWUgPSB0YXNrUXVldWU7XG4gICAgdGhpcy5vYmogPSBvYmo7XG4gICAgdGhpcy5wcm9wZXJ0eU5hbWUgPSBwcm9wZXJ0eU5hbWU7XG4gICAgdGhpcy5xdWV1ZWQgPSBmYWxzZTtcbiAgICB0aGlzLm9ic2VydmluZyA9IGZhbHNlO1xuICB9XG5cbiAgU2V0dGVyT2JzZXJ2ZXIucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gZ2V0VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMub2JqW3RoaXMucHJvcGVydHlOYW1lXTtcbiAgfTtcblxuICBTZXR0ZXJPYnNlcnZlci5wcm90b3R5cGUuc2V0VmFsdWUgPSBmdW5jdGlvbiBzZXRWYWx1ZShuZXdWYWx1ZSkge1xuICAgIHRoaXMub2JqW3RoaXMucHJvcGVydHlOYW1lXSA9IG5ld1ZhbHVlO1xuICB9O1xuXG4gIFNldHRlck9ic2VydmVyLnByb3RvdHlwZS5nZXR0ZXJWYWx1ZSA9IGZ1bmN0aW9uIGdldHRlclZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnRWYWx1ZTtcbiAgfTtcblxuICBTZXR0ZXJPYnNlcnZlci5wcm90b3R5cGUuc2V0dGVyVmFsdWUgPSBmdW5jdGlvbiBzZXR0ZXJWYWx1ZShuZXdWYWx1ZSkge1xuICAgIHZhciBvbGRWYWx1ZSA9IHRoaXMuY3VycmVudFZhbHVlO1xuXG4gICAgaWYgKG9sZFZhbHVlICE9PSBuZXdWYWx1ZSkge1xuICAgICAgaWYgKCF0aGlzLnF1ZXVlZCkge1xuICAgICAgICB0aGlzLm9sZFZhbHVlID0gb2xkVmFsdWU7XG4gICAgICAgIHRoaXMucXVldWVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50YXNrUXVldWUucXVldWVNaWNyb1Rhc2sodGhpcyk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuY3VycmVudFZhbHVlID0gbmV3VmFsdWU7XG4gICAgfVxuICB9O1xuXG4gIFNldHRlck9ic2VydmVyLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gY2FsbCgpIHtcbiAgICB2YXIgb2xkVmFsdWUgPSB0aGlzLm9sZFZhbHVlO1xuICAgIHZhciBuZXdWYWx1ZSA9IHRoaXMuY3VycmVudFZhbHVlO1xuXG4gICAgdGhpcy5xdWV1ZWQgPSBmYWxzZTtcblxuICAgIHRoaXMuY2FsbFN1YnNjcmliZXJzKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gIH07XG5cbiAgU2V0dGVyT2JzZXJ2ZXIucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIHN1YnNjcmliZShjb250ZXh0LCBjYWxsYWJsZSkge1xuICAgIGlmICghdGhpcy5vYnNlcnZpbmcpIHtcbiAgICAgIHRoaXMuY29udmVydFByb3BlcnR5KCk7XG4gICAgfVxuICAgIHRoaXMuYWRkU3Vic2NyaWJlcihjb250ZXh0LCBjYWxsYWJsZSk7XG4gIH07XG5cbiAgU2V0dGVyT2JzZXJ2ZXIucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gdW5zdWJzY3JpYmUoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgICB0aGlzLnJlbW92ZVN1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpO1xuICB9O1xuXG4gIFNldHRlck9ic2VydmVyLnByb3RvdHlwZS5jb252ZXJ0UHJvcGVydHkgPSBmdW5jdGlvbiBjb252ZXJ0UHJvcGVydHkoKSB7XG4gICAgdGhpcy5vYnNlcnZpbmcgPSB0cnVlO1xuICAgIHRoaXMuY3VycmVudFZhbHVlID0gdGhpcy5vYmpbdGhpcy5wcm9wZXJ0eU5hbWVdO1xuICAgIHRoaXMuc2V0VmFsdWUgPSB0aGlzLnNldHRlclZhbHVlO1xuICAgIHRoaXMuZ2V0VmFsdWUgPSB0aGlzLmdldHRlclZhbHVlO1xuXG4gICAgaWYgKCFSZWZsZWN0LmRlZmluZVByb3BlcnR5KHRoaXMub2JqLCB0aGlzLnByb3BlcnR5TmFtZSwge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgZW51bWVyYWJsZTogdGhpcy5wcm9wZXJ0eU5hbWUgaW4gdGhpcy5vYmogPyB0aGlzLm9iai5wcm9wZXJ0eUlzRW51bWVyYWJsZSh0aGlzLnByb3BlcnR5TmFtZSkgOiB0cnVlLFxuICAgICAgZ2V0OiB0aGlzLmdldFZhbHVlLmJpbmQodGhpcyksXG4gICAgICBzZXQ6IHRoaXMuc2V0VmFsdWUuYmluZCh0aGlzKVxuICAgIH0pKSB7XG4gICAgICBsb2dnZXIud2FybignQ2Fubm90IG9ic2VydmUgcHJvcGVydHkgXFwnJyArIHRoaXMucHJvcGVydHlOYW1lICsgJ1xcJyBvZiBvYmplY3QnLCB0aGlzLm9iaik7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBTZXR0ZXJPYnNlcnZlcjtcbn0oKSkgfHwgX2NsYXNzNyk7XG5cbnZhciBYTGlua0F0dHJpYnV0ZU9ic2VydmVyID0gZXhwb3J0cy5YTGlua0F0dHJpYnV0ZU9ic2VydmVyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBYTGlua0F0dHJpYnV0ZU9ic2VydmVyKGVsZW1lbnQsIHByb3BlcnR5TmFtZSwgYXR0cmlidXRlTmFtZSkge1xuICAgIFxuXG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLnByb3BlcnR5TmFtZSA9IHByb3BlcnR5TmFtZTtcbiAgICB0aGlzLmF0dHJpYnV0ZU5hbWUgPSBhdHRyaWJ1dGVOYW1lO1xuICB9XG5cbiAgWExpbmtBdHRyaWJ1dGVPYnNlcnZlci5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiBnZXRWYWx1ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZU5TKCdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJywgdGhpcy5hdHRyaWJ1dGVOYW1lKTtcbiAgfTtcblxuICBYTGlua0F0dHJpYnV0ZU9ic2VydmVyLnByb3RvdHlwZS5zZXRWYWx1ZSA9IGZ1bmN0aW9uIHNldFZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGVOUygnaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycsIHRoaXMuYXR0cmlidXRlTmFtZSwgbmV3VmFsdWUpO1xuICB9O1xuXG4gIFhMaW5rQXR0cmlidXRlT2JzZXJ2ZXIucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIHN1YnNjcmliZSgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ09ic2VydmF0aW9uIG9mIGEgXCInICsgdGhpcy5lbGVtZW50Lm5vZGVOYW1lICsgJ1wiIGVsZW1lbnRcXCdzIFwiJyArIHRoaXMucHJvcGVydHlOYW1lICsgJ1wiIHByb3BlcnR5IGlzIG5vdCBzdXBwb3J0ZWQuJyk7XG4gIH07XG5cbiAgcmV0dXJuIFhMaW5rQXR0cmlidXRlT2JzZXJ2ZXI7XG59KCk7XG5cbnZhciBkYXRhQXR0cmlidXRlQWNjZXNzb3IgPSBleHBvcnRzLmRhdGFBdHRyaWJ1dGVBY2Nlc3NvciA9IHtcbiAgZ2V0VmFsdWU6IGZ1bmN0aW9uIGdldFZhbHVlKG9iaiwgcHJvcGVydHlOYW1lKSB7XG4gICAgcmV0dXJuIG9iai5nZXRBdHRyaWJ1dGUocHJvcGVydHlOYW1lKTtcbiAgfSxcbiAgc2V0VmFsdWU6IGZ1bmN0aW9uIHNldFZhbHVlKHZhbHVlLCBvYmosIHByb3BlcnR5TmFtZSkge1xuICAgIHJldHVybiBvYmouc2V0QXR0cmlidXRlKHByb3BlcnR5TmFtZSwgdmFsdWUpO1xuICB9XG59O1xuXG52YXIgRGF0YUF0dHJpYnV0ZU9ic2VydmVyID0gZXhwb3J0cy5EYXRhQXR0cmlidXRlT2JzZXJ2ZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIERhdGFBdHRyaWJ1dGVPYnNlcnZlcihlbGVtZW50LCBwcm9wZXJ0eU5hbWUpIHtcbiAgICBcblxuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgdGhpcy5wcm9wZXJ0eU5hbWUgPSBwcm9wZXJ0eU5hbWU7XG4gIH1cblxuICBEYXRhQXR0cmlidXRlT2JzZXJ2ZXIucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gZ2V0VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUodGhpcy5wcm9wZXJ0eU5hbWUpO1xuICB9O1xuXG4gIERhdGFBdHRyaWJ1dGVPYnNlcnZlci5wcm90b3R5cGUuc2V0VmFsdWUgPSBmdW5jdGlvbiBzZXRWYWx1ZShuZXdWYWx1ZSkge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKHRoaXMucHJvcGVydHlOYW1lLCBuZXdWYWx1ZSk7XG4gIH07XG5cbiAgRGF0YUF0dHJpYnV0ZU9ic2VydmVyLnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbiBzdWJzY3JpYmUoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdPYnNlcnZhdGlvbiBvZiBhIFwiJyArIHRoaXMuZWxlbWVudC5ub2RlTmFtZSArICdcIiBlbGVtZW50XFwncyBcIicgKyB0aGlzLnByb3BlcnR5TmFtZSArICdcIiBwcm9wZXJ0eSBpcyBub3Qgc3VwcG9ydGVkLicpO1xuICB9O1xuXG4gIHJldHVybiBEYXRhQXR0cmlidXRlT2JzZXJ2ZXI7XG59KCk7XG5cbnZhciBTdHlsZU9ic2VydmVyID0gZXhwb3J0cy5TdHlsZU9ic2VydmVyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBTdHlsZU9ic2VydmVyKGVsZW1lbnQsIHByb3BlcnR5TmFtZSkge1xuICAgIFxuXG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLnByb3BlcnR5TmFtZSA9IHByb3BlcnR5TmFtZTtcblxuICAgIHRoaXMuc3R5bGVzID0gbnVsbDtcbiAgICB0aGlzLnZlcnNpb24gPSAwO1xuICB9XG5cbiAgU3R5bGVPYnNlcnZlci5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiBnZXRWYWx1ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50LnN0eWxlLmNzc1RleHQ7XG4gIH07XG5cbiAgU3R5bGVPYnNlcnZlci5wcm90b3R5cGUuc2V0VmFsdWUgPSBmdW5jdGlvbiBzZXRWYWx1ZShuZXdWYWx1ZSkge1xuICAgIHZhciBzdHlsZXMgPSB0aGlzLnN0eWxlcyB8fCB7fTtcbiAgICB2YXIgc3R5bGUgPSB2b2lkIDA7XG4gICAgdmFyIHZlcnNpb24gPSB0aGlzLnZlcnNpb247XG5cbiAgICBpZiAobmV3VmFsdWUgIT09IG51bGwgJiYgbmV3VmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKG5ld1ZhbHVlIGluc3RhbmNlb2YgT2JqZWN0KSB7XG4gICAgICAgIGZvciAoc3R5bGUgaW4gbmV3VmFsdWUpIHtcbiAgICAgICAgICBpZiAobmV3VmFsdWUuaGFzT3duUHJvcGVydHkoc3R5bGUpKSB7XG4gICAgICAgICAgICBzdHlsZXNbc3R5bGVdID0gdmVyc2lvbjtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZVtzdHlsZV0gPSBuZXdWYWx1ZVtzdHlsZV07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKG5ld1ZhbHVlLmxlbmd0aCkge1xuICAgICAgICB2YXIgcGFpcnMgPSBuZXdWYWx1ZS5zcGxpdCgvKD86O3w6KD8hXFwvKSlcXHMqLyk7XG4gICAgICAgIGZvciAodmFyIF9pMjIgPSAwLCBsZW5ndGggPSBwYWlycy5sZW5ndGg7IF9pMjIgPCBsZW5ndGg7IF9pMjIrKykge1xuICAgICAgICAgIHN0eWxlID0gcGFpcnNbX2kyMl0udHJpbSgpO1xuICAgICAgICAgIGlmICghc3R5bGUpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHN0eWxlc1tzdHlsZV0gPSB2ZXJzaW9uO1xuXG4gICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlW3N0eWxlXSA9IHBhaXJzWysrX2kyMl07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnN0eWxlcyA9IHN0eWxlcztcbiAgICB0aGlzLnZlcnNpb24gKz0gMTtcblxuICAgIGlmICh2ZXJzaW9uID09PSAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmVyc2lvbiAtPSAxO1xuICAgIGZvciAoc3R5bGUgaW4gc3R5bGVzKSB7XG4gICAgICBpZiAoIXN0eWxlcy5oYXNPd25Qcm9wZXJ0eShzdHlsZSkgfHwgc3R5bGVzW3N0eWxlXSAhPT0gdmVyc2lvbikge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5lbGVtZW50LnN0eWxlW3N0eWxlXSA9ICcnO1xuICAgIH1cbiAgfTtcblxuICBTdHlsZU9ic2VydmVyLnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbiBzdWJzY3JpYmUoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdPYnNlcnZhdGlvbiBvZiBhIFwiJyArIHRoaXMuZWxlbWVudC5ub2RlTmFtZSArICdcIiBlbGVtZW50XFwncyBcIicgKyB0aGlzLnByb3BlcnR5TmFtZSArICdcIiBwcm9wZXJ0eSBpcyBub3Qgc3VwcG9ydGVkLicpO1xuICB9O1xuXG4gIHJldHVybiBTdHlsZU9ic2VydmVyO1xufSgpO1xuXG52YXIgVmFsdWVBdHRyaWJ1dGVPYnNlcnZlciA9IGV4cG9ydHMuVmFsdWVBdHRyaWJ1dGVPYnNlcnZlciA9IChfZGVjNyA9IHN1YnNjcmliZXJDb2xsZWN0aW9uKCksIF9kZWM3KF9jbGFzczggPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFZhbHVlQXR0cmlidXRlT2JzZXJ2ZXIoZWxlbWVudCwgcHJvcGVydHlOYW1lLCBoYW5kbGVyKSB7XG4gICAgXG5cbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMucHJvcGVydHlOYW1lID0gcHJvcGVydHlOYW1lO1xuICAgIHRoaXMuaGFuZGxlciA9IGhhbmRsZXI7XG4gICAgaWYgKHByb3BlcnR5TmFtZSA9PT0gJ2ZpbGVzJykge1xuICAgICAgdGhpcy5zZXRWYWx1ZSA9IGZ1bmN0aW9uICgpIHt9O1xuICAgIH1cbiAgfVxuXG4gIFZhbHVlQXR0cmlidXRlT2JzZXJ2ZXIucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gZ2V0VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudFt0aGlzLnByb3BlcnR5TmFtZV07XG4gIH07XG5cbiAgVmFsdWVBdHRyaWJ1dGVPYnNlcnZlci5wcm90b3R5cGUuc2V0VmFsdWUgPSBmdW5jdGlvbiBzZXRWYWx1ZShuZXdWYWx1ZSkge1xuICAgIG5ld1ZhbHVlID0gbmV3VmFsdWUgPT09IHVuZGVmaW5lZCB8fCBuZXdWYWx1ZSA9PT0gbnVsbCA/ICcnIDogbmV3VmFsdWU7XG4gICAgaWYgKHRoaXMuZWxlbWVudFt0aGlzLnByb3BlcnR5TmFtZV0gIT09IG5ld1ZhbHVlKSB7XG4gICAgICB0aGlzLmVsZW1lbnRbdGhpcy5wcm9wZXJ0eU5hbWVdID0gbmV3VmFsdWU7XG4gICAgICB0aGlzLm5vdGlmeSgpO1xuICAgIH1cbiAgfTtcblxuICBWYWx1ZUF0dHJpYnV0ZU9ic2VydmVyLnByb3RvdHlwZS5ub3RpZnkgPSBmdW5jdGlvbiBub3RpZnkoKSB7XG4gICAgdmFyIG9sZFZhbHVlID0gdGhpcy5vbGRWYWx1ZTtcbiAgICB2YXIgbmV3VmFsdWUgPSB0aGlzLmdldFZhbHVlKCk7XG5cbiAgICB0aGlzLmNhbGxTdWJzY3JpYmVycyhuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuXG4gICAgdGhpcy5vbGRWYWx1ZSA9IG5ld1ZhbHVlO1xuICB9O1xuXG4gIFZhbHVlQXR0cmlidXRlT2JzZXJ2ZXIucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIHN1YnNjcmliZShjb250ZXh0LCBjYWxsYWJsZSkge1xuICAgIGlmICghdGhpcy5oYXNTdWJzY3JpYmVycygpKSB7XG4gICAgICB0aGlzLm9sZFZhbHVlID0gdGhpcy5nZXRWYWx1ZSgpO1xuICAgICAgdGhpcy5kaXNwb3NlSGFuZGxlciA9IHRoaXMuaGFuZGxlci5zdWJzY3JpYmUodGhpcy5lbGVtZW50LCB0aGlzLm5vdGlmeS5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICB0aGlzLmFkZFN1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpO1xuICB9O1xuXG4gIFZhbHVlQXR0cmlidXRlT2JzZXJ2ZXIucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gdW5zdWJzY3JpYmUoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgICBpZiAodGhpcy5yZW1vdmVTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKSAmJiAhdGhpcy5oYXNTdWJzY3JpYmVycygpKSB7XG4gICAgICB0aGlzLmRpc3Bvc2VIYW5kbGVyKCk7XG4gICAgICB0aGlzLmRpc3Bvc2VIYW5kbGVyID0gbnVsbDtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIFZhbHVlQXR0cmlidXRlT2JzZXJ2ZXI7XG59KCkpIHx8IF9jbGFzczgpO1xuXG5cbnZhciBjaGVja2VkQXJyYXlDb250ZXh0ID0gJ0NoZWNrZWRPYnNlcnZlcjphcnJheSc7XG52YXIgY2hlY2tlZFZhbHVlQ29udGV4dCA9ICdDaGVja2VkT2JzZXJ2ZXI6dmFsdWUnO1xuXG52YXIgQ2hlY2tlZE9ic2VydmVyID0gZXhwb3J0cy5DaGVja2VkT2JzZXJ2ZXIgPSAoX2RlYzggPSBzdWJzY3JpYmVyQ29sbGVjdGlvbigpLCBfZGVjOChfY2xhc3M5ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBDaGVja2VkT2JzZXJ2ZXIoZWxlbWVudCwgaGFuZGxlciwgb2JzZXJ2ZXJMb2NhdG9yKSB7XG4gICAgXG5cbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMuaGFuZGxlciA9IGhhbmRsZXI7XG4gICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XG4gIH1cblxuICBDaGVja2VkT2JzZXJ2ZXIucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gZ2V0VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gIH07XG5cbiAgQ2hlY2tlZE9ic2VydmVyLnByb3RvdHlwZS5zZXRWYWx1ZSA9IGZ1bmN0aW9uIHNldFZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgaWYgKHRoaXMudmFsdWUgPT09IG5ld1ZhbHVlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuYXJyYXlPYnNlcnZlcikge1xuICAgICAgdGhpcy5hcnJheU9ic2VydmVyLnVuc3Vic2NyaWJlKGNoZWNrZWRBcnJheUNvbnRleHQsIHRoaXMpO1xuICAgICAgdGhpcy5hcnJheU9ic2VydmVyID0gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5lbGVtZW50LnR5cGUgPT09ICdjaGVja2JveCcgJiYgQXJyYXkuaXNBcnJheShuZXdWYWx1ZSkpIHtcbiAgICAgIHRoaXMuYXJyYXlPYnNlcnZlciA9IHRoaXMub2JzZXJ2ZXJMb2NhdG9yLmdldEFycmF5T2JzZXJ2ZXIobmV3VmFsdWUpO1xuICAgICAgdGhpcy5hcnJheU9ic2VydmVyLnN1YnNjcmliZShjaGVja2VkQXJyYXlDb250ZXh0LCB0aGlzKTtcbiAgICB9XG5cbiAgICB0aGlzLm9sZFZhbHVlID0gdGhpcy52YWx1ZTtcbiAgICB0aGlzLnZhbHVlID0gbmV3VmFsdWU7XG4gICAgdGhpcy5zeW5jaHJvbml6ZUVsZW1lbnQoKTtcbiAgICB0aGlzLm5vdGlmeSgpO1xuXG4gICAgaWYgKCF0aGlzLmluaXRpYWxTeW5jKSB7XG4gICAgICB0aGlzLmluaXRpYWxTeW5jID0gdHJ1ZTtcbiAgICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yLnRhc2tRdWV1ZS5xdWV1ZU1pY3JvVGFzayh0aGlzKTtcbiAgICB9XG4gIH07XG5cbiAgQ2hlY2tlZE9ic2VydmVyLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gY2FsbChjb250ZXh0LCBzcGxpY2VzKSB7XG4gICAgdGhpcy5zeW5jaHJvbml6ZUVsZW1lbnQoKTtcblxuICAgIGlmICghdGhpcy52YWx1ZU9ic2VydmVyICYmICh0aGlzLnZhbHVlT2JzZXJ2ZXIgPSB0aGlzLmVsZW1lbnQuX19vYnNlcnZlcnNfXy5tb2RlbCB8fCB0aGlzLmVsZW1lbnQuX19vYnNlcnZlcnNfXy52YWx1ZSkpIHtcbiAgICAgIHRoaXMudmFsdWVPYnNlcnZlci5zdWJzY3JpYmUoY2hlY2tlZFZhbHVlQ29udGV4dCwgdGhpcyk7XG4gICAgfVxuICB9O1xuXG4gIENoZWNrZWRPYnNlcnZlci5wcm90b3R5cGUuc3luY2hyb25pemVFbGVtZW50ID0gZnVuY3Rpb24gc3luY2hyb25pemVFbGVtZW50KCkge1xuICAgIHZhciB2YWx1ZSA9IHRoaXMudmFsdWU7XG4gICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQ7XG4gICAgdmFyIGVsZW1lbnRWYWx1ZSA9IGVsZW1lbnQuaGFzT3duUHJvcGVydHkoJ21vZGVsJykgPyBlbGVtZW50Lm1vZGVsIDogZWxlbWVudC52YWx1ZTtcbiAgICB2YXIgaXNSYWRpbyA9IGVsZW1lbnQudHlwZSA9PT0gJ3JhZGlvJztcbiAgICB2YXIgbWF0Y2hlciA9IGVsZW1lbnQubWF0Y2hlciB8fCBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgcmV0dXJuIGEgPT09IGI7XG4gICAgfTtcblxuICAgIGVsZW1lbnQuY2hlY2tlZCA9IGlzUmFkaW8gJiYgISFtYXRjaGVyKHZhbHVlLCBlbGVtZW50VmFsdWUpIHx8ICFpc1JhZGlvICYmIHZhbHVlID09PSB0cnVlIHx8ICFpc1JhZGlvICYmIEFycmF5LmlzQXJyYXkodmFsdWUpICYmICEhdmFsdWUuZmluZChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgcmV0dXJuICEhbWF0Y2hlcihpdGVtLCBlbGVtZW50VmFsdWUpO1xuICAgIH0pO1xuICB9O1xuXG4gIENoZWNrZWRPYnNlcnZlci5wcm90b3R5cGUuc3luY2hyb25pemVWYWx1ZSA9IGZ1bmN0aW9uIHN5bmNocm9uaXplVmFsdWUoKSB7XG4gICAgdmFyIHZhbHVlID0gdGhpcy52YWx1ZTtcbiAgICB2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudDtcbiAgICB2YXIgZWxlbWVudFZhbHVlID0gZWxlbWVudC5oYXNPd25Qcm9wZXJ0eSgnbW9kZWwnKSA/IGVsZW1lbnQubW9kZWwgOiBlbGVtZW50LnZhbHVlO1xuICAgIHZhciBpbmRleCA9IHZvaWQgMDtcbiAgICB2YXIgbWF0Y2hlciA9IGVsZW1lbnQubWF0Y2hlciB8fCBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgcmV0dXJuIGEgPT09IGI7XG4gICAgfTtcblxuICAgIGlmIChlbGVtZW50LnR5cGUgPT09ICdjaGVja2JveCcpIHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICBpbmRleCA9IHZhbHVlLmZpbmRJbmRleChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgIHJldHVybiAhIW1hdGNoZXIoaXRlbSwgZWxlbWVudFZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChlbGVtZW50LmNoZWNrZWQgJiYgaW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgdmFsdWUucHVzaChlbGVtZW50VmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKCFlbGVtZW50LmNoZWNrZWQgJiYgaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgdmFsdWUuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFsdWUgPSBlbGVtZW50LmNoZWNrZWQ7XG4gICAgfSBlbHNlIGlmIChlbGVtZW50LmNoZWNrZWQpIHtcbiAgICAgIHZhbHVlID0gZWxlbWVudFZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5vbGRWYWx1ZSA9IHRoaXMudmFsdWU7XG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIHRoaXMubm90aWZ5KCk7XG4gIH07XG5cbiAgQ2hlY2tlZE9ic2VydmVyLnByb3RvdHlwZS5ub3RpZnkgPSBmdW5jdGlvbiBub3RpZnkoKSB7XG4gICAgdmFyIG9sZFZhbHVlID0gdGhpcy5vbGRWYWx1ZTtcbiAgICB2YXIgbmV3VmFsdWUgPSB0aGlzLnZhbHVlO1xuXG4gICAgdGhpcy5jYWxsU3Vic2NyaWJlcnMobmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgfTtcblxuICBDaGVja2VkT2JzZXJ2ZXIucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIHN1YnNjcmliZShjb250ZXh0LCBjYWxsYWJsZSkge1xuICAgIGlmICghdGhpcy5oYXNTdWJzY3JpYmVycygpKSB7XG4gICAgICB0aGlzLmRpc3Bvc2VIYW5kbGVyID0gdGhpcy5oYW5kbGVyLnN1YnNjcmliZSh0aGlzLmVsZW1lbnQsIHRoaXMuc3luY2hyb25pemVWYWx1ZS5iaW5kKHRoaXMsIGZhbHNlKSk7XG4gICAgfVxuICAgIHRoaXMuYWRkU3Vic2NyaWJlcihjb250ZXh0LCBjYWxsYWJsZSk7XG4gIH07XG5cbiAgQ2hlY2tlZE9ic2VydmVyLnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uIHVuc3Vic2NyaWJlKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gICAgaWYgKHRoaXMucmVtb3ZlU3Vic2NyaWJlcihjb250ZXh0LCBjYWxsYWJsZSkgJiYgIXRoaXMuaGFzU3Vic2NyaWJlcnMoKSkge1xuICAgICAgdGhpcy5kaXNwb3NlSGFuZGxlcigpO1xuICAgICAgdGhpcy5kaXNwb3NlSGFuZGxlciA9IG51bGw7XG4gICAgfVxuICB9O1xuXG4gIENoZWNrZWRPYnNlcnZlci5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gdW5iaW5kKCkge1xuICAgIGlmICh0aGlzLmFycmF5T2JzZXJ2ZXIpIHtcbiAgICAgIHRoaXMuYXJyYXlPYnNlcnZlci51bnN1YnNjcmliZShjaGVja2VkQXJyYXlDb250ZXh0LCB0aGlzKTtcbiAgICAgIHRoaXMuYXJyYXlPYnNlcnZlciA9IG51bGw7XG4gICAgfVxuICAgIGlmICh0aGlzLnZhbHVlT2JzZXJ2ZXIpIHtcbiAgICAgIHRoaXMudmFsdWVPYnNlcnZlci51bnN1YnNjcmliZShjaGVja2VkVmFsdWVDb250ZXh0LCB0aGlzKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIENoZWNrZWRPYnNlcnZlcjtcbn0oKSkgfHwgX2NsYXNzOSk7XG5cblxudmFyIHNlbGVjdEFycmF5Q29udGV4dCA9ICdTZWxlY3RWYWx1ZU9ic2VydmVyOmFycmF5JztcblxudmFyIFNlbGVjdFZhbHVlT2JzZXJ2ZXIgPSBleHBvcnRzLlNlbGVjdFZhbHVlT2JzZXJ2ZXIgPSAoX2RlYzkgPSBzdWJzY3JpYmVyQ29sbGVjdGlvbigpLCBfZGVjOShfY2xhc3MxMCA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gU2VsZWN0VmFsdWVPYnNlcnZlcihlbGVtZW50LCBoYW5kbGVyLCBvYnNlcnZlckxvY2F0b3IpIHtcbiAgICBcblxuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgdGhpcy5oYW5kbGVyID0gaGFuZGxlcjtcbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcbiAgfVxuXG4gIFNlbGVjdFZhbHVlT2JzZXJ2ZXIucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gZ2V0VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gIH07XG5cbiAgU2VsZWN0VmFsdWVPYnNlcnZlci5wcm90b3R5cGUuc2V0VmFsdWUgPSBmdW5jdGlvbiBzZXRWYWx1ZShuZXdWYWx1ZSkge1xuICAgIGlmIChuZXdWYWx1ZSAhPT0gbnVsbCAmJiBuZXdWYWx1ZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuZWxlbWVudC5tdWx0aXBsZSAmJiAhQXJyYXkuaXNBcnJheShuZXdWYWx1ZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignT25seSBudWxsIG9yIEFycmF5IGluc3RhbmNlcyBjYW4gYmUgYm91bmQgdG8gYSBtdWx0aS1zZWxlY3QuJyk7XG4gICAgfVxuICAgIGlmICh0aGlzLnZhbHVlID09PSBuZXdWYWx1ZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmFycmF5T2JzZXJ2ZXIpIHtcbiAgICAgIHRoaXMuYXJyYXlPYnNlcnZlci51bnN1YnNjcmliZShzZWxlY3RBcnJheUNvbnRleHQsIHRoaXMpO1xuICAgICAgdGhpcy5hcnJheU9ic2VydmVyID0gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAoQXJyYXkuaXNBcnJheShuZXdWYWx1ZSkpIHtcbiAgICAgIHRoaXMuYXJyYXlPYnNlcnZlciA9IHRoaXMub2JzZXJ2ZXJMb2NhdG9yLmdldEFycmF5T2JzZXJ2ZXIobmV3VmFsdWUpO1xuICAgICAgdGhpcy5hcnJheU9ic2VydmVyLnN1YnNjcmliZShzZWxlY3RBcnJheUNvbnRleHQsIHRoaXMpO1xuICAgIH1cblxuICAgIHRoaXMub2xkVmFsdWUgPSB0aGlzLnZhbHVlO1xuICAgIHRoaXMudmFsdWUgPSBuZXdWYWx1ZTtcbiAgICB0aGlzLnN5bmNocm9uaXplT3B0aW9ucygpO1xuICAgIHRoaXMubm90aWZ5KCk7XG5cbiAgICBpZiAoIXRoaXMuaW5pdGlhbFN5bmMpIHtcbiAgICAgIHRoaXMuaW5pdGlhbFN5bmMgPSB0cnVlO1xuICAgICAgdGhpcy5vYnNlcnZlckxvY2F0b3IudGFza1F1ZXVlLnF1ZXVlTWljcm9UYXNrKHRoaXMpO1xuICAgIH1cbiAgfTtcblxuICBTZWxlY3RWYWx1ZU9ic2VydmVyLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gY2FsbChjb250ZXh0LCBzcGxpY2VzKSB7XG4gICAgdGhpcy5zeW5jaHJvbml6ZU9wdGlvbnMoKTtcbiAgfTtcblxuICBTZWxlY3RWYWx1ZU9ic2VydmVyLnByb3RvdHlwZS5zeW5jaHJvbml6ZU9wdGlvbnMgPSBmdW5jdGlvbiBzeW5jaHJvbml6ZU9wdGlvbnMoKSB7XG4gICAgdmFyIHZhbHVlID0gdGhpcy52YWx1ZTtcbiAgICB2YXIgY2xlYXIgPSB2b2lkIDA7XG4gICAgdmFyIGlzQXJyYXkgPSB2b2lkIDA7XG5cbiAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgY2xlYXIgPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgIGlzQXJyYXkgPSB0cnVlO1xuICAgIH1cblxuICAgIHZhciBvcHRpb25zID0gdGhpcy5lbGVtZW50Lm9wdGlvbnM7XG4gICAgdmFyIGkgPSBvcHRpb25zLmxlbmd0aDtcbiAgICB2YXIgbWF0Y2hlciA9IHRoaXMuZWxlbWVudC5tYXRjaGVyIHx8IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICByZXR1cm4gYSA9PT0gYjtcbiAgICB9O1xuXG4gICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoKSB7XG4gICAgICB2YXIgb3B0aW9uID0gb3B0aW9ucy5pdGVtKGkpO1xuICAgICAgaWYgKGNsZWFyKSB7XG4gICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gJ2NvbnRpbnVlJztcbiAgICAgIH1cbiAgICAgIHZhciBvcHRpb25WYWx1ZSA9IG9wdGlvbi5oYXNPd25Qcm9wZXJ0eSgnbW9kZWwnKSA/IG9wdGlvbi5tb2RlbCA6IG9wdGlvbi52YWx1ZTtcbiAgICAgIGlmIChpc0FycmF5KSB7XG4gICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9ICEhdmFsdWUuZmluZChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgIHJldHVybiAhIW1hdGNoZXIob3B0aW9uVmFsdWUsIGl0ZW0pO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuICdjb250aW51ZSc7XG4gICAgICB9XG4gICAgICBvcHRpb24uc2VsZWN0ZWQgPSAhIW1hdGNoZXIob3B0aW9uVmFsdWUsIHZhbHVlKTtcbiAgICB9O1xuXG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgdmFyIF9yZXQyID0gX2xvb3AoKTtcblxuICAgICAgaWYgKF9yZXQyID09PSAnY29udGludWUnKSBjb250aW51ZTtcbiAgICB9XG4gIH07XG5cbiAgU2VsZWN0VmFsdWVPYnNlcnZlci5wcm90b3R5cGUuc3luY2hyb25pemVWYWx1ZSA9IGZ1bmN0aW9uIHN5bmNocm9uaXplVmFsdWUoKSB7XG4gICAgdmFyIF90aGlzMjQgPSB0aGlzO1xuXG4gICAgdmFyIG9wdGlvbnMgPSB0aGlzLmVsZW1lbnQub3B0aW9ucztcbiAgICB2YXIgY291bnQgPSAwO1xuICAgIHZhciB2YWx1ZSA9IFtdO1xuXG4gICAgZm9yICh2YXIgX2kyMyA9IDAsIGlpID0gb3B0aW9ucy5sZW5ndGg7IF9pMjMgPCBpaTsgX2kyMysrKSB7XG4gICAgICB2YXIgX29wdGlvbiA9IG9wdGlvbnMuaXRlbShfaTIzKTtcbiAgICAgIGlmICghX29wdGlvbi5zZWxlY3RlZCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIHZhbHVlLnB1c2goX29wdGlvbi5oYXNPd25Qcm9wZXJ0eSgnbW9kZWwnKSA/IF9vcHRpb24ubW9kZWwgOiBfb3B0aW9uLnZhbHVlKTtcbiAgICAgIGNvdW50Kys7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZWxlbWVudC5tdWx0aXBsZSkge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy52YWx1ZSkpIHtcbiAgICAgICAgdmFyIF9yZXQzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBtYXRjaGVyID0gX3RoaXMyNC5lbGVtZW50Lm1hdGNoZXIgfHwgZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIHJldHVybiBhID09PSBiO1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICB2YXIgaSA9IDA7XG5cbiAgICAgICAgICB2YXIgX2xvb3AyID0gZnVuY3Rpb24gX2xvb3AyKCkge1xuICAgICAgICAgICAgdmFyIGEgPSBfdGhpczI0LnZhbHVlW2ldO1xuICAgICAgICAgICAgaWYgKHZhbHVlLmZpbmRJbmRleChmdW5jdGlvbiAoYikge1xuICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hlcihhLCBiKTtcbiAgICAgICAgICAgIH0pID09PSAtMSkge1xuICAgICAgICAgICAgICBfdGhpczI0LnZhbHVlLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgd2hpbGUgKGkgPCBfdGhpczI0LnZhbHVlLmxlbmd0aCkge1xuICAgICAgICAgICAgX2xvb3AyKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaSA9IDA7XG5cbiAgICAgICAgICB2YXIgX2xvb3AzID0gZnVuY3Rpb24gX2xvb3AzKCkge1xuICAgICAgICAgICAgdmFyIGEgPSB2YWx1ZVtpXTtcbiAgICAgICAgICAgIGlmIChfdGhpczI0LnZhbHVlLmZpbmRJbmRleChmdW5jdGlvbiAoYikge1xuICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hlcihhLCBiKTtcbiAgICAgICAgICAgIH0pID09PSAtMSkge1xuICAgICAgICAgICAgICBfdGhpczI0LnZhbHVlLnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpKys7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHdoaWxlIChpIDwgdmFsdWUubGVuZ3RoKSB7XG4gICAgICAgICAgICBfbG9vcDMoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHY6IHZvaWQgMFxuICAgICAgICAgIH07XG4gICAgICAgIH0oKTtcblxuICAgICAgICBpZiAoKHR5cGVvZiBfcmV0MyA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoX3JldDMpKSA9PT0gXCJvYmplY3RcIikgcmV0dXJuIF9yZXQzLnY7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGNvdW50ID09PSAwKSB7XG4gICAgICAgICAgdmFsdWUgPSBudWxsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhbHVlID0gdmFsdWVbMF07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgIGlmICh2YWx1ZSAhPT0gdGhpcy52YWx1ZSkge1xuICAgICAgdGhpcy5vbGRWYWx1ZSA9IHRoaXMudmFsdWU7XG4gICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICB0aGlzLm5vdGlmeSgpO1xuICAgIH1cbiAgfTtcblxuICBTZWxlY3RWYWx1ZU9ic2VydmVyLnByb3RvdHlwZS5ub3RpZnkgPSBmdW5jdGlvbiBub3RpZnkoKSB7XG4gICAgdmFyIG9sZFZhbHVlID0gdGhpcy5vbGRWYWx1ZTtcbiAgICB2YXIgbmV3VmFsdWUgPSB0aGlzLnZhbHVlO1xuXG4gICAgdGhpcy5jYWxsU3Vic2NyaWJlcnMobmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgfTtcblxuICBTZWxlY3RWYWx1ZU9ic2VydmVyLnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbiBzdWJzY3JpYmUoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgICBpZiAoIXRoaXMuaGFzU3Vic2NyaWJlcnMoKSkge1xuICAgICAgdGhpcy5kaXNwb3NlSGFuZGxlciA9IHRoaXMuaGFuZGxlci5zdWJzY3JpYmUodGhpcy5lbGVtZW50LCB0aGlzLnN5bmNocm9uaXplVmFsdWUuYmluZCh0aGlzLCBmYWxzZSkpO1xuICAgIH1cbiAgICB0aGlzLmFkZFN1YnNjcmliZXIoY29udGV4dCwgY2FsbGFibGUpO1xuICB9O1xuXG4gIFNlbGVjdFZhbHVlT2JzZXJ2ZXIucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gdW5zdWJzY3JpYmUoY29udGV4dCwgY2FsbGFibGUpIHtcbiAgICBpZiAodGhpcy5yZW1vdmVTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKSAmJiAhdGhpcy5oYXNTdWJzY3JpYmVycygpKSB7XG4gICAgICB0aGlzLmRpc3Bvc2VIYW5kbGVyKCk7XG4gICAgICB0aGlzLmRpc3Bvc2VIYW5kbGVyID0gbnVsbDtcbiAgICB9XG4gIH07XG5cbiAgU2VsZWN0VmFsdWVPYnNlcnZlci5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIGJpbmQoKSB7XG4gICAgdmFyIF90aGlzMjUgPSB0aGlzO1xuXG4gICAgdGhpcy5kb21PYnNlcnZlciA9IF9hdXJlbGlhUGFsLkRPTS5jcmVhdGVNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzMjUuc3luY2hyb25pemVPcHRpb25zKCk7XG4gICAgICBfdGhpczI1LnN5bmNocm9uaXplVmFsdWUoKTtcbiAgICB9KTtcbiAgICB0aGlzLmRvbU9ic2VydmVyLm9ic2VydmUodGhpcy5lbGVtZW50LCB7IGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZSB9KTtcbiAgfTtcblxuICBTZWxlY3RWYWx1ZU9ic2VydmVyLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiB1bmJpbmQoKSB7XG4gICAgdGhpcy5kb21PYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgdGhpcy5kb21PYnNlcnZlciA9IG51bGw7XG5cbiAgICBpZiAodGhpcy5hcnJheU9ic2VydmVyKSB7XG4gICAgICB0aGlzLmFycmF5T2JzZXJ2ZXIudW5zdWJzY3JpYmUoc2VsZWN0QXJyYXlDb250ZXh0LCB0aGlzKTtcbiAgICAgIHRoaXMuYXJyYXlPYnNlcnZlciA9IG51bGw7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBTZWxlY3RWYWx1ZU9ic2VydmVyO1xufSgpKSB8fCBfY2xhc3MxMCk7XG5cbnZhciBDbGFzc09ic2VydmVyID0gZXhwb3J0cy5DbGFzc09ic2VydmVyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBDbGFzc09ic2VydmVyKGVsZW1lbnQpIHtcbiAgICBcblxuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgdGhpcy5kb05vdENhY2hlID0gdHJ1ZTtcbiAgICB0aGlzLnZhbHVlID0gJyc7XG4gICAgdGhpcy52ZXJzaW9uID0gMDtcbiAgfVxuXG4gIENsYXNzT2JzZXJ2ZXIucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gZ2V0VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gIH07XG5cbiAgQ2xhc3NPYnNlcnZlci5wcm90b3R5cGUuc2V0VmFsdWUgPSBmdW5jdGlvbiBzZXRWYWx1ZShuZXdWYWx1ZSkge1xuICAgIHZhciBuYW1lSW5kZXggPSB0aGlzLm5hbWVJbmRleCB8fCB7fTtcbiAgICB2YXIgdmVyc2lvbiA9IHRoaXMudmVyc2lvbjtcbiAgICB2YXIgbmFtZXMgPSB2b2lkIDA7XG4gICAgdmFyIG5hbWUgPSB2b2lkIDA7XG5cbiAgICBpZiAobmV3VmFsdWUgIT09IG51bGwgJiYgbmV3VmFsdWUgIT09IHVuZGVmaW5lZCAmJiBuZXdWYWx1ZS5sZW5ndGgpIHtcbiAgICAgIG5hbWVzID0gbmV3VmFsdWUuc3BsaXQoL1xccysvKTtcbiAgICAgIGZvciAodmFyIF9pMjQgPSAwLCBsZW5ndGggPSBuYW1lcy5sZW5ndGg7IF9pMjQgPCBsZW5ndGg7IF9pMjQrKykge1xuICAgICAgICBuYW1lID0gbmFtZXNbX2kyNF07XG4gICAgICAgIGlmIChuYW1lID09PSAnJykge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIG5hbWVJbmRleFtuYW1lXSA9IHZlcnNpb247XG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKG5hbWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMudmFsdWUgPSBuZXdWYWx1ZTtcbiAgICB0aGlzLm5hbWVJbmRleCA9IG5hbWVJbmRleDtcbiAgICB0aGlzLnZlcnNpb24gKz0gMTtcblxuICAgIGlmICh2ZXJzaW9uID09PSAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmVyc2lvbiAtPSAxO1xuICAgIGZvciAobmFtZSBpbiBuYW1lSW5kZXgpIHtcbiAgICAgIGlmICghbmFtZUluZGV4Lmhhc093blByb3BlcnR5KG5hbWUpIHx8IG5hbWVJbmRleFtuYW1lXSAhPT0gdmVyc2lvbikge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKG5hbWUpO1xuICAgIH1cbiAgfTtcblxuICBDbGFzc09ic2VydmVyLnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbiBzdWJzY3JpYmUoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdPYnNlcnZhdGlvbiBvZiBhIFwiJyArIHRoaXMuZWxlbWVudC5ub2RlTmFtZSArICdcIiBlbGVtZW50XFwncyBcImNsYXNzXCIgcHJvcGVydHkgaXMgbm90IHN1cHBvcnRlZC4nKTtcbiAgfTtcblxuICByZXR1cm4gQ2xhc3NPYnNlcnZlcjtcbn0oKTtcblxuZnVuY3Rpb24gaGFzRGVjbGFyZWREZXBlbmRlbmNpZXMoZGVzY3JpcHRvcikge1xuICByZXR1cm4gISEoZGVzY3JpcHRvciAmJiBkZXNjcmlwdG9yLmdldCAmJiBkZXNjcmlwdG9yLmdldC5kZXBlbmRlbmNpZXMpO1xufVxuXG5mdW5jdGlvbiBkZWNsYXJlUHJvcGVydHlEZXBlbmRlbmNpZXMoY3RvciwgcHJvcGVydHlOYW1lLCBkZXBlbmRlbmNpZXMpIHtcbiAgdmFyIGRlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGN0b3IucHJvdG90eXBlLCBwcm9wZXJ0eU5hbWUpO1xuICBkZXNjcmlwdG9yLmdldC5kZXBlbmRlbmNpZXMgPSBkZXBlbmRlbmNpZXM7XG59XG5cbmZ1bmN0aW9uIGNvbXB1dGVkRnJvbSgpIHtcbiAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIHJlc3QgPSBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICByZXN0W19rZXldID0gYXJndW1lbnRzW19rZXldO1xuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcikge1xuICAgIGRlc2NyaXB0b3IuZ2V0LmRlcGVuZGVuY2llcyA9IHJlc3Q7XG4gICAgcmV0dXJuIGRlc2NyaXB0b3I7XG4gIH07XG59XG5cbnZhciBDb21wdXRlZEV4cHJlc3Npb24gPSBleHBvcnRzLkNvbXB1dGVkRXhwcmVzc2lvbiA9IGZ1bmN0aW9uIChfRXhwcmVzc2lvbjE5KSB7XG4gIF9pbmhlcml0cyhDb21wdXRlZEV4cHJlc3Npb24sIF9FeHByZXNzaW9uMTkpO1xuXG4gIGZ1bmN0aW9uIENvbXB1dGVkRXhwcmVzc2lvbihuYW1lLCBkZXBlbmRlbmNpZXMpIHtcbiAgICBcblxuICAgIHZhciBfdGhpczI2ID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX0V4cHJlc3Npb24xOS5jYWxsKHRoaXMpKTtcblxuICAgIF90aGlzMjYubmFtZSA9IG5hbWU7XG4gICAgX3RoaXMyNi5kZXBlbmRlbmNpZXMgPSBkZXBlbmRlbmNpZXM7XG4gICAgX3RoaXMyNi5pc0Fzc2lnbmFibGUgPSB0cnVlO1xuICAgIHJldHVybiBfdGhpczI2O1xuICB9XG5cbiAgQ29tcHV0ZWRFeHByZXNzaW9uLnByb3RvdHlwZS5ldmFsdWF0ZSA9IGZ1bmN0aW9uIGV2YWx1YXRlKHNjb3BlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICByZXR1cm4gc2NvcGUuYmluZGluZ0NvbnRleHRbdGhpcy5uYW1lXTtcbiAgfTtcblxuICBDb21wdXRlZEV4cHJlc3Npb24ucHJvdG90eXBlLmFzc2lnbiA9IGZ1bmN0aW9uIGFzc2lnbihzY29wZSwgdmFsdWUpIHtcbiAgICBzY29wZS5iaW5kaW5nQ29udGV4dFt0aGlzLm5hbWVdID0gdmFsdWU7XG4gIH07XG5cbiAgQ29tcHV0ZWRFeHByZXNzaW9uLnByb3RvdHlwZS5hY2NlcHQgPSBmdW5jdGlvbiBhY2NlcHQodmlzaXRvcikge1xuICAgIHRocm93IG5ldyBFcnJvcignbm90IGltcGxlbWVudGVkJyk7XG4gIH07XG5cbiAgQ29tcHV0ZWRFeHByZXNzaW9uLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gY29ubmVjdChiaW5kaW5nLCBzY29wZSkge1xuICAgIHZhciBkZXBlbmRlbmNpZXMgPSB0aGlzLmRlcGVuZGVuY2llcztcbiAgICB2YXIgaSA9IGRlcGVuZGVuY2llcy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgZGVwZW5kZW5jaWVzW2ldLmNvbm5lY3QoYmluZGluZywgc2NvcGUpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gQ29tcHV0ZWRFeHByZXNzaW9uO1xufShFeHByZXNzaW9uKTtcblxuZnVuY3Rpb24gY3JlYXRlQ29tcHV0ZWRPYnNlcnZlcihvYmosIHByb3BlcnR5TmFtZSwgZGVzY3JpcHRvciwgb2JzZXJ2ZXJMb2NhdG9yKSB7XG4gIHZhciBkZXBlbmRlbmNpZXMgPSBkZXNjcmlwdG9yLmdldC5kZXBlbmRlbmNpZXM7XG4gIGlmICghKGRlcGVuZGVuY2llcyBpbnN0YW5jZW9mIENvbXB1dGVkRXhwcmVzc2lvbikpIHtcbiAgICB2YXIgX2kyNSA9IGRlcGVuZGVuY2llcy5sZW5ndGg7XG4gICAgd2hpbGUgKF9pMjUtLSkge1xuICAgICAgZGVwZW5kZW5jaWVzW19pMjVdID0gb2JzZXJ2ZXJMb2NhdG9yLnBhcnNlci5wYXJzZShkZXBlbmRlbmNpZXNbX2kyNV0pO1xuICAgIH1cbiAgICBkZXBlbmRlbmNpZXMgPSBkZXNjcmlwdG9yLmdldC5kZXBlbmRlbmNpZXMgPSBuZXcgQ29tcHV0ZWRFeHByZXNzaW9uKHByb3BlcnR5TmFtZSwgZGVwZW5kZW5jaWVzKTtcbiAgfVxuXG4gIHZhciBzY29wZSA9IHsgYmluZGluZ0NvbnRleHQ6IG9iaiwgb3ZlcnJpZGVDb250ZXh0OiBjcmVhdGVPdmVycmlkZUNvbnRleHQob2JqKSB9O1xuICByZXR1cm4gbmV3IEV4cHJlc3Npb25PYnNlcnZlcihzY29wZSwgZGVwZW5kZW5jaWVzLCBvYnNlcnZlckxvY2F0b3IpO1xufVxuXG52YXIgZWxlbWVudHMgPSBleHBvcnRzLmVsZW1lbnRzID0ge1xuICBhOiBbJ2NsYXNzJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd0YXJnZXQnLCAndHJhbnNmb3JtJywgJ3hsaW5rOmFjdHVhdGUnLCAneGxpbms6YXJjcm9sZScsICd4bGluazpocmVmJywgJ3hsaW5rOnJvbGUnLCAneGxpbms6c2hvdycsICd4bGluazp0aXRsZScsICd4bGluazp0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICBhbHRHbHlwaDogWydjbGFzcycsICdkeCcsICdkeScsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2Zvcm1hdCcsICdnbHlwaFJlZicsICdpZCcsICdvbmFjdGl2YXRlJywgJ29uY2xpY2snLCAnb25mb2N1c2luJywgJ29uZm9jdXNvdXQnLCAnb25sb2FkJywgJ29ubW91c2Vkb3duJywgJ29ubW91c2Vtb3ZlJywgJ29ubW91c2VvdXQnLCAnb25tb3VzZW92ZXInLCAnb25tb3VzZXVwJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3JvdGF0ZScsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd4JywgJ3hsaW5rOmFjdHVhdGUnLCAneGxpbms6YXJjcm9sZScsICd4bGluazpocmVmJywgJ3hsaW5rOnJvbGUnLCAneGxpbms6c2hvdycsICd4bGluazp0aXRsZScsICd4bGluazp0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gIGFsdEdseXBoRGVmOiBbJ2lkJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICBhbHRHbHlwaEl0ZW06IFsnaWQnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gIGFuaW1hdGU6IFsnYWNjdW11bGF0ZScsICdhZGRpdGl2ZScsICdhdHRyaWJ1dGVOYW1lJywgJ2F0dHJpYnV0ZVR5cGUnLCAnYmVnaW4nLCAnYnknLCAnY2FsY01vZGUnLCAnZHVyJywgJ2VuZCcsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2ZpbGwnLCAnZnJvbScsICdpZCcsICdrZXlTcGxpbmVzJywgJ2tleVRpbWVzJywgJ21heCcsICdtaW4nLCAnb25iZWdpbicsICdvbmVuZCcsICdvbmxvYWQnLCAnb25yZXBlYXQnLCAncmVwZWF0Q291bnQnLCAncmVwZWF0RHVyJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3Jlc3RhcnQnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndG8nLCAndmFsdWVzJywgJ3hsaW5rOmFjdHVhdGUnLCAneGxpbms6YXJjcm9sZScsICd4bGluazpocmVmJywgJ3hsaW5rOnJvbGUnLCAneGxpbms6c2hvdycsICd4bGluazp0aXRsZScsICd4bGluazp0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICBhbmltYXRlQ29sb3I6IFsnYWNjdW11bGF0ZScsICdhZGRpdGl2ZScsICdhdHRyaWJ1dGVOYW1lJywgJ2F0dHJpYnV0ZVR5cGUnLCAnYmVnaW4nLCAnYnknLCAnY2FsY01vZGUnLCAnZHVyJywgJ2VuZCcsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2ZpbGwnLCAnZnJvbScsICdpZCcsICdrZXlTcGxpbmVzJywgJ2tleVRpbWVzJywgJ21heCcsICdtaW4nLCAnb25iZWdpbicsICdvbmVuZCcsICdvbmxvYWQnLCAnb25yZXBlYXQnLCAncmVwZWF0Q291bnQnLCAncmVwZWF0RHVyJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3Jlc3RhcnQnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndG8nLCAndmFsdWVzJywgJ3hsaW5rOmFjdHVhdGUnLCAneGxpbms6YXJjcm9sZScsICd4bGluazpocmVmJywgJ3hsaW5rOnJvbGUnLCAneGxpbms6c2hvdycsICd4bGluazp0aXRsZScsICd4bGluazp0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICBhbmltYXRlTW90aW9uOiBbJ2FjY3VtdWxhdGUnLCAnYWRkaXRpdmUnLCAnYmVnaW4nLCAnYnknLCAnY2FsY01vZGUnLCAnZHVyJywgJ2VuZCcsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2ZpbGwnLCAnZnJvbScsICdpZCcsICdrZXlQb2ludHMnLCAna2V5U3BsaW5lcycsICdrZXlUaW1lcycsICdtYXgnLCAnbWluJywgJ29uYmVnaW4nLCAnb25lbmQnLCAnb25sb2FkJywgJ29ucmVwZWF0JywgJ29yaWdpbicsICdwYXRoJywgJ3JlcGVhdENvdW50JywgJ3JlcGVhdER1cicsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdyZXN0YXJ0JywgJ3JvdGF0ZScsICdzeXN0ZW1MYW5ndWFnZScsICd0bycsICd2YWx1ZXMnLCAneGxpbms6YWN0dWF0ZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gIGFuaW1hdGVUcmFuc2Zvcm06IFsnYWNjdW11bGF0ZScsICdhZGRpdGl2ZScsICdhdHRyaWJ1dGVOYW1lJywgJ2F0dHJpYnV0ZVR5cGUnLCAnYmVnaW4nLCAnYnknLCAnY2FsY01vZGUnLCAnZHVyJywgJ2VuZCcsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2ZpbGwnLCAnZnJvbScsICdpZCcsICdrZXlTcGxpbmVzJywgJ2tleVRpbWVzJywgJ21heCcsICdtaW4nLCAnb25iZWdpbicsICdvbmVuZCcsICdvbmxvYWQnLCAnb25yZXBlYXQnLCAncmVwZWF0Q291bnQnLCAncmVwZWF0RHVyJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3Jlc3RhcnQnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndG8nLCAndHlwZScsICd2YWx1ZXMnLCAneGxpbms6YWN0dWF0ZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gIGNpcmNsZTogWydjbGFzcycsICdjeCcsICdjeScsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ29uYWN0aXZhdGUnLCAnb25jbGljaycsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAncicsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd0cmFuc2Zvcm0nLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gIGNsaXBQYXRoOiBbJ2NsYXNzJywgJ2NsaXBQYXRoVW5pdHMnLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdpZCcsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd0cmFuc2Zvcm0nLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gICdjb2xvci1wcm9maWxlJzogWydpZCcsICdsb2NhbCcsICduYW1lJywgJ3JlbmRlcmluZy1pbnRlbnQnLCAneGxpbms6YWN0dWF0ZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gIGN1cnNvcjogWydleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3N5c3RlbUxhbmd1YWdlJywgJ3gnLCAneGxpbms6YWN0dWF0ZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgZGVmczogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ29uYWN0aXZhdGUnLCAnb25jbGljaycsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndHJhbnNmb3JtJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICBkZXNjOiBbJ2NsYXNzJywgJ2lkJywgJ3N0eWxlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICBlbGxpcHNlOiBbJ2NsYXNzJywgJ2N4JywgJ2N5JywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdyeCcsICdyeScsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd0cmFuc2Zvcm0nLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gIGZlQmxlbmQ6IFsnY2xhc3MnLCAnaGVpZ2h0JywgJ2lkJywgJ2luJywgJ2luMicsICdtb2RlJywgJ3Jlc3VsdCcsICdzdHlsZScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gIGZlQ29sb3JNYXRyaXg6IFsnY2xhc3MnLCAnaGVpZ2h0JywgJ2lkJywgJ2luJywgJ3Jlc3VsdCcsICdzdHlsZScsICd0eXBlJywgJ3ZhbHVlcycsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gIGZlQ29tcG9uZW50VHJhbnNmZXI6IFsnY2xhc3MnLCAnaGVpZ2h0JywgJ2lkJywgJ2luJywgJ3Jlc3VsdCcsICdzdHlsZScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gIGZlQ29tcG9zaXRlOiBbJ2NsYXNzJywgJ2hlaWdodCcsICdpZCcsICdpbicsICdpbjInLCAnazEnLCAnazInLCAnazMnLCAnazQnLCAnb3BlcmF0b3InLCAncmVzdWx0JywgJ3N0eWxlJywgJ3dpZHRoJywgJ3gnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgZmVDb252b2x2ZU1hdHJpeDogWydiaWFzJywgJ2NsYXNzJywgJ2Rpdmlzb3InLCAnZWRnZU1vZGUnLCAnaGVpZ2h0JywgJ2lkJywgJ2luJywgJ2tlcm5lbE1hdHJpeCcsICdrZXJuZWxVbml0TGVuZ3RoJywgJ29yZGVyJywgJ3ByZXNlcnZlQWxwaGEnLCAncmVzdWx0JywgJ3N0eWxlJywgJ3RhcmdldFgnLCAndGFyZ2V0WScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gIGZlRGlmZnVzZUxpZ2h0aW5nOiBbJ2NsYXNzJywgJ2RpZmZ1c2VDb25zdGFudCcsICdoZWlnaHQnLCAnaWQnLCAnaW4nLCAna2VybmVsVW5pdExlbmd0aCcsICdyZXN1bHQnLCAnc3R5bGUnLCAnc3VyZmFjZVNjYWxlJywgJ3dpZHRoJywgJ3gnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgZmVEaXNwbGFjZW1lbnRNYXA6IFsnY2xhc3MnLCAnaGVpZ2h0JywgJ2lkJywgJ2luJywgJ2luMicsICdyZXN1bHQnLCAnc2NhbGUnLCAnc3R5bGUnLCAnd2lkdGgnLCAneCcsICd4Q2hhbm5lbFNlbGVjdG9yJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5JywgJ3lDaGFubmVsU2VsZWN0b3InXSxcbiAgZmVEaXN0YW50TGlnaHQ6IFsnYXppbXV0aCcsICdlbGV2YXRpb24nLCAnaWQnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gIGZlRmxvb2Q6IFsnY2xhc3MnLCAnaGVpZ2h0JywgJ2lkJywgJ3Jlc3VsdCcsICdzdHlsZScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gIGZlRnVuY0E6IFsnYW1wbGl0dWRlJywgJ2V4cG9uZW50JywgJ2lkJywgJ2ludGVyY2VwdCcsICdvZmZzZXQnLCAnc2xvcGUnLCAndGFibGVWYWx1ZXMnLCAndHlwZScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgZmVGdW5jQjogWydhbXBsaXR1ZGUnLCAnZXhwb25lbnQnLCAnaWQnLCAnaW50ZXJjZXB0JywgJ29mZnNldCcsICdzbG9wZScsICd0YWJsZVZhbHVlcycsICd0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICBmZUZ1bmNHOiBbJ2FtcGxpdHVkZScsICdleHBvbmVudCcsICdpZCcsICdpbnRlcmNlcHQnLCAnb2Zmc2V0JywgJ3Nsb3BlJywgJ3RhYmxlVmFsdWVzJywgJ3R5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gIGZlRnVuY1I6IFsnYW1wbGl0dWRlJywgJ2V4cG9uZW50JywgJ2lkJywgJ2ludGVyY2VwdCcsICdvZmZzZXQnLCAnc2xvcGUnLCAndGFibGVWYWx1ZXMnLCAndHlwZScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgZmVHYXVzc2lhbkJsdXI6IFsnY2xhc3MnLCAnaGVpZ2h0JywgJ2lkJywgJ2luJywgJ3Jlc3VsdCcsICdzdGREZXZpYXRpb24nLCAnc3R5bGUnLCAnd2lkdGgnLCAneCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICBmZUltYWdlOiBbJ2NsYXNzJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaGVpZ2h0JywgJ2lkJywgJ3ByZXNlcnZlQXNwZWN0UmF0aW8nLCAncmVzdWx0JywgJ3N0eWxlJywgJ3dpZHRoJywgJ3gnLCAneGxpbms6YWN0dWF0ZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgZmVNZXJnZTogWydjbGFzcycsICdoZWlnaHQnLCAnaWQnLCAncmVzdWx0JywgJ3N0eWxlJywgJ3dpZHRoJywgJ3gnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgZmVNZXJnZU5vZGU6IFsnaWQnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gIGZlTW9ycGhvbG9neTogWydjbGFzcycsICdoZWlnaHQnLCAnaWQnLCAnaW4nLCAnb3BlcmF0b3InLCAncmFkaXVzJywgJ3Jlc3VsdCcsICdzdHlsZScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gIGZlT2Zmc2V0OiBbJ2NsYXNzJywgJ2R4JywgJ2R5JywgJ2hlaWdodCcsICdpZCcsICdpbicsICdyZXN1bHQnLCAnc3R5bGUnLCAnd2lkdGgnLCAneCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICBmZVBvaW50TGlnaHQ6IFsnaWQnLCAneCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneScsICd6J10sXG4gIGZlU3BlY3VsYXJMaWdodGluZzogWydjbGFzcycsICdoZWlnaHQnLCAnaWQnLCAnaW4nLCAna2VybmVsVW5pdExlbmd0aCcsICdyZXN1bHQnLCAnc3BlY3VsYXJDb25zdGFudCcsICdzcGVjdWxhckV4cG9uZW50JywgJ3N0eWxlJywgJ3N1cmZhY2VTY2FsZScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gIGZlU3BvdExpZ2h0OiBbJ2lkJywgJ2xpbWl0aW5nQ29uZUFuZ2xlJywgJ3BvaW50c0F0WCcsICdwb2ludHNBdFknLCAncG9pbnRzQXRaJywgJ3NwZWN1bGFyRXhwb25lbnQnLCAneCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneScsICd6J10sXG4gIGZlVGlsZTogWydjbGFzcycsICdoZWlnaHQnLCAnaWQnLCAnaW4nLCAncmVzdWx0JywgJ3N0eWxlJywgJ3dpZHRoJywgJ3gnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgZmVUdXJidWxlbmNlOiBbJ2Jhc2VGcmVxdWVuY3knLCAnY2xhc3MnLCAnaGVpZ2h0JywgJ2lkJywgJ251bU9jdGF2ZXMnLCAncmVzdWx0JywgJ3NlZWQnLCAnc3RpdGNoVGlsZXMnLCAnc3R5bGUnLCAndHlwZScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gIGZpbHRlcjogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2ZpbHRlclJlcycsICdmaWx0ZXJVbml0cycsICdoZWlnaHQnLCAnaWQnLCAncHJpbWl0aXZlVW5pdHMnLCAnc3R5bGUnLCAnd2lkdGgnLCAneCcsICd4bGluazphY3R1YXRlJywgJ3hsaW5rOmFyY3JvbGUnLCAneGxpbms6aHJlZicsICd4bGluazpyb2xlJywgJ3hsaW5rOnNob3cnLCAneGxpbms6dGl0bGUnLCAneGxpbms6dHlwZScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICBmb250OiBbJ2NsYXNzJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaG9yaXotYWR2LXgnLCAnaG9yaXotb3JpZ2luLXgnLCAnaG9yaXotb3JpZ2luLXknLCAnaWQnLCAnc3R5bGUnLCAndmVydC1hZHYteScsICd2ZXJ0LW9yaWdpbi14JywgJ3ZlcnQtb3JpZ2luLXknLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gICdmb250LWZhY2UnOiBbJ2FjY2VudC1oZWlnaHQnLCAnYWxwaGFiZXRpYycsICdhc2NlbnQnLCAnYmJveCcsICdjYXAtaGVpZ2h0JywgJ2Rlc2NlbnQnLCAnZm9udC1mYW1pbHknLCAnZm9udC1zaXplJywgJ2ZvbnQtc3RyZXRjaCcsICdmb250LXN0eWxlJywgJ2ZvbnQtdmFyaWFudCcsICdmb250LXdlaWdodCcsICdoYW5naW5nJywgJ2lkJywgJ2lkZW9ncmFwaGljJywgJ21hdGhlbWF0aWNhbCcsICdvdmVybGluZS1wb3NpdGlvbicsICdvdmVybGluZS10aGlja25lc3MnLCAncGFub3NlLTEnLCAnc2xvcGUnLCAnc3RlbWgnLCAnc3RlbXYnLCAnc3RyaWtldGhyb3VnaC1wb3NpdGlvbicsICdzdHJpa2V0aHJvdWdoLXRoaWNrbmVzcycsICd1bmRlcmxpbmUtcG9zaXRpb24nLCAndW5kZXJsaW5lLXRoaWNrbmVzcycsICd1bmljb2RlLXJhbmdlJywgJ3VuaXRzLXBlci1lbScsICd2LWFscGhhYmV0aWMnLCAndi1oYW5naW5nJywgJ3YtaWRlb2dyYXBoaWMnLCAndi1tYXRoZW1hdGljYWwnLCAnd2lkdGhzJywgJ3gtaGVpZ2h0JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAnZm9udC1mYWNlLWZvcm1hdCc6IFsnaWQnLCAnc3RyaW5nJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAnZm9udC1mYWNlLW5hbWUnOiBbJ2lkJywgJ25hbWUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gICdmb250LWZhY2Utc3JjJzogWydpZCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgJ2ZvbnQtZmFjZS11cmknOiBbJ2lkJywgJ3hsaW5rOmFjdHVhdGUnLCAneGxpbms6YXJjcm9sZScsICd4bGluazpocmVmJywgJ3hsaW5rOnJvbGUnLCAneGxpbms6c2hvdycsICd4bGluazp0aXRsZScsICd4bGluazp0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICBmb3JlaWduT2JqZWN0OiBbJ2NsYXNzJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaGVpZ2h0JywgJ2lkJywgJ29uYWN0aXZhdGUnLCAnb25jbGljaycsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndHJhbnNmb3JtJywgJ3dpZHRoJywgJ3gnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgZzogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ29uYWN0aXZhdGUnLCAnb25jbGljaycsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndHJhbnNmb3JtJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICBnbHlwaDogWydhcmFiaWMtZm9ybScsICdjbGFzcycsICdkJywgJ2dseXBoLW5hbWUnLCAnaG9yaXotYWR2LXgnLCAnaWQnLCAnbGFuZycsICdvcmllbnRhdGlvbicsICdzdHlsZScsICd1bmljb2RlJywgJ3ZlcnQtYWR2LXknLCAndmVydC1vcmlnaW4teCcsICd2ZXJ0LW9yaWdpbi15JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICBnbHlwaFJlZjogWydjbGFzcycsICdkeCcsICdkeScsICdmb3JtYXQnLCAnZ2x5cGhSZWYnLCAnaWQnLCAnc3R5bGUnLCAneCcsICd4bGluazphY3R1YXRlJywgJ3hsaW5rOmFyY3JvbGUnLCAneGxpbms6aHJlZicsICd4bGluazpyb2xlJywgJ3hsaW5rOnNob3cnLCAneGxpbms6dGl0bGUnLCAneGxpbms6dHlwZScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICBoa2VybjogWydnMScsICdnMicsICdpZCcsICdrJywgJ3UxJywgJ3UyJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICBpbWFnZTogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2hlaWdodCcsICdpZCcsICdvbmFjdGl2YXRlJywgJ29uY2xpY2snLCAnb25mb2N1c2luJywgJ29uZm9jdXNvdXQnLCAnb25sb2FkJywgJ29ubW91c2Vkb3duJywgJ29ubW91c2Vtb3ZlJywgJ29ubW91c2VvdXQnLCAnb25tb3VzZW92ZXInLCAnb25tb3VzZXVwJywgJ3ByZXNlcnZlQXNwZWN0UmF0aW8nLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndHJhbnNmb3JtJywgJ3dpZHRoJywgJ3gnLCAneGxpbms6YWN0dWF0ZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgbGluZTogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ29uYWN0aXZhdGUnLCAnb25jbGljaycsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndHJhbnNmb3JtJywgJ3gxJywgJ3gyJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5MScsICd5MiddLFxuICBsaW5lYXJHcmFkaWVudDogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2dyYWRpZW50VHJhbnNmb3JtJywgJ2dyYWRpZW50VW5pdHMnLCAnaWQnLCAnc3ByZWFkTWV0aG9kJywgJ3N0eWxlJywgJ3gxJywgJ3gyJywgJ3hsaW5rOmFyY3JvbGUnLCAneGxpbms6aHJlZicsICd4bGluazpyb2xlJywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3kxJywgJ3kyJ10sXG4gIG1hcmtlcjogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ21hcmtlckhlaWdodCcsICdtYXJrZXJVbml0cycsICdtYXJrZXJXaWR0aCcsICdvcmllbnQnLCAncHJlc2VydmVBc3BlY3RSYXRpbycsICdyZWZYJywgJ3JlZlknLCAnc3R5bGUnLCAndmlld0JveCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgbWFzazogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2hlaWdodCcsICdpZCcsICdtYXNrQ29udGVudFVuaXRzJywgJ21hc2tVbml0cycsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gIG1ldGFkYXRhOiBbJ2lkJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICAnbWlzc2luZy1nbHlwaCc6IFsnY2xhc3MnLCAnZCcsICdob3Jpei1hZHYteCcsICdpZCcsICdzdHlsZScsICd2ZXJ0LWFkdi15JywgJ3ZlcnQtb3JpZ2luLXgnLCAndmVydC1vcmlnaW4teScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgbXBhdGg6IFsnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdpZCcsICd4bGluazphY3R1YXRlJywgJ3hsaW5rOmFyY3JvbGUnLCAneGxpbms6aHJlZicsICd4bGluazpyb2xlJywgJ3hsaW5rOnNob3cnLCAneGxpbms6dGl0bGUnLCAneGxpbms6dHlwZScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgcGF0aDogWydjbGFzcycsICdkJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdwYXRoTGVuZ3RoJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3N0eWxlJywgJ3N5c3RlbUxhbmd1YWdlJywgJ3RyYW5zZm9ybScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgcGF0dGVybjogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2hlaWdodCcsICdpZCcsICdwYXR0ZXJuQ29udGVudFVuaXRzJywgJ3BhdHRlcm5UcmFuc2Zvcm0nLCAncGF0dGVyblVuaXRzJywgJ3ByZXNlcnZlQXNwZWN0UmF0aW8nLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndmlld0JveCcsICd3aWR0aCcsICd4JywgJ3hsaW5rOmFjdHVhdGUnLCAneGxpbms6YXJjcm9sZScsICd4bGluazpocmVmJywgJ3hsaW5rOnJvbGUnLCAneGxpbms6c2hvdycsICd4bGluazp0aXRsZScsICd4bGluazp0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gIHBvbHlnb246IFsnY2xhc3MnLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdpZCcsICdvbmFjdGl2YXRlJywgJ29uY2xpY2snLCAnb25mb2N1c2luJywgJ29uZm9jdXNvdXQnLCAnb25sb2FkJywgJ29ubW91c2Vkb3duJywgJ29ubW91c2Vtb3ZlJywgJ29ubW91c2VvdXQnLCAnb25tb3VzZW92ZXInLCAnb25tb3VzZXVwJywgJ3BvaW50cycsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd0cmFuc2Zvcm0nLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gIHBvbHlsaW5lOiBbJ2NsYXNzJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdwb2ludHMnLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAnc3R5bGUnLCAnc3lzdGVtTGFuZ3VhZ2UnLCAndHJhbnNmb3JtJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICByYWRpYWxHcmFkaWVudDogWydjbGFzcycsICdjeCcsICdjeScsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2Z4JywgJ2Z5JywgJ2dyYWRpZW50VHJhbnNmb3JtJywgJ2dyYWRpZW50VW5pdHMnLCAnaWQnLCAncicsICdzcHJlYWRNZXRob2QnLCAnc3R5bGUnLCAneGxpbms6YXJjcm9sZScsICd4bGluazpocmVmJywgJ3hsaW5rOnJvbGUnLCAneGxpbms6dGl0bGUnLCAneGxpbms6dHlwZScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgcmVjdDogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2hlaWdodCcsICdpZCcsICdvbmFjdGl2YXRlJywgJ29uY2xpY2snLCAnb25mb2N1c2luJywgJ29uZm9jdXNvdXQnLCAnb25sb2FkJywgJ29ubW91c2Vkb3duJywgJ29ubW91c2Vtb3ZlJywgJ29ubW91c2VvdXQnLCAnb25tb3VzZW92ZXInLCAnb25tb3VzZXVwJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3J4JywgJ3J5JywgJ3N0eWxlJywgJ3N5c3RlbUxhbmd1YWdlJywgJ3RyYW5zZm9ybScsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gIHNjcmlwdDogWydleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ3R5cGUnLCAneGxpbms6YWN0dWF0ZScsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gIHNldDogWydhdHRyaWJ1dGVOYW1lJywgJ2F0dHJpYnV0ZVR5cGUnLCAnYmVnaW4nLCAnZHVyJywgJ2VuZCcsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2ZpbGwnLCAnaWQnLCAnbWF4JywgJ21pbicsICdvbmJlZ2luJywgJ29uZW5kJywgJ29ubG9hZCcsICdvbnJlcGVhdCcsICdyZXBlYXRDb3VudCcsICdyZXBlYXREdXInLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAncmVzdGFydCcsICdzeXN0ZW1MYW5ndWFnZScsICd0bycsICd4bGluazphY3R1YXRlJywgJ3hsaW5rOmFyY3JvbGUnLCAneGxpbms6aHJlZicsICd4bGluazpyb2xlJywgJ3hsaW5rOnNob3cnLCAneGxpbms6dGl0bGUnLCAneGxpbms6dHlwZScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXSxcbiAgc3RvcDogWydjbGFzcycsICdpZCcsICdvZmZzZXQnLCAnc3R5bGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gIHN0eWxlOiBbJ2lkJywgJ21lZGlhJywgJ3RpdGxlJywgJ3R5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gIHN2ZzogWydiYXNlUHJvZmlsZScsICdjbGFzcycsICdjb250ZW50U2NyaXB0VHlwZScsICdjb250ZW50U3R5bGVUeXBlJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaGVpZ2h0JywgJ2lkJywgJ29uYWJvcnQnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZXJyb3InLCAnb25mb2N1c2luJywgJ29uZm9jdXNvdXQnLCAnb25sb2FkJywgJ29ubW91c2Vkb3duJywgJ29ubW91c2Vtb3ZlJywgJ29ubW91c2VvdXQnLCAnb25tb3VzZW92ZXInLCAnb25tb3VzZXVwJywgJ29ucmVzaXplJywgJ29uc2Nyb2xsJywgJ29udW5sb2FkJywgJ29uem9vbScsICdwcmVzZXJ2ZUFzcGVjdFJhdGlvJywgJ3JlcXVpcmVkRXh0ZW5zaW9ucycsICdyZXF1aXJlZEZlYXR1cmVzJywgJ3N0eWxlJywgJ3N5c3RlbUxhbmd1YWdlJywgJ3ZlcnNpb24nLCAndmlld0JveCcsICd3aWR0aCcsICd4JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5JywgJ3pvb21BbmRQYW4nXSxcbiAgc3dpdGNoOiBbJ2NsYXNzJywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd0cmFuc2Zvcm0nLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gIHN5bWJvbDogWydjbGFzcycsICdleHRlcm5hbFJlc291cmNlc1JlcXVpcmVkJywgJ2lkJywgJ29uYWN0aXZhdGUnLCAnb25jbGljaycsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAncHJlc2VydmVBc3BlY3RSYXRpbycsICdzdHlsZScsICd2aWV3Qm94JywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICB0ZXh0OiBbJ2NsYXNzJywgJ2R4JywgJ2R5JywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAnbGVuZ3RoQWRqdXN0JywgJ29uYWN0aXZhdGUnLCAnb25jbGljaycsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAncm90YXRlJywgJ3N0eWxlJywgJ3N5c3RlbUxhbmd1YWdlJywgJ3RleHRMZW5ndGgnLCAndHJhbnNmb3JtJywgJ3gnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3knXSxcbiAgdGV4dFBhdGg6IFsnY2xhc3MnLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdpZCcsICdsZW5ndGhBZGp1c3QnLCAnbWV0aG9kJywgJ29uYWN0aXZhdGUnLCAnb25jbGljaycsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAnc3BhY2luZycsICdzdGFydE9mZnNldCcsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd0ZXh0TGVuZ3RoJywgJ3hsaW5rOmFyY3JvbGUnLCAneGxpbms6aHJlZicsICd4bGluazpyb2xlJywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJ10sXG4gIHRpdGxlOiBbJ2NsYXNzJywgJ2lkJywgJ3N0eWxlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZSddLFxuICB0cmVmOiBbJ2NsYXNzJywgJ2R4JywgJ2R5JywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAnbGVuZ3RoQWRqdXN0JywgJ29uYWN0aXZhdGUnLCAnb25jbGljaycsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAncm90YXRlJywgJ3N0eWxlJywgJ3N5c3RlbUxhbmd1YWdlJywgJ3RleHRMZW5ndGgnLCAneCcsICd4bGluazphcmNyb2xlJywgJ3hsaW5rOmhyZWYnLCAneGxpbms6cm9sZScsICd4bGluazp0aXRsZScsICd4bGluazp0eXBlJywgJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScsICd5J10sXG4gIHRzcGFuOiBbJ2NsYXNzJywgJ2R4JywgJ2R5JywgJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAnbGVuZ3RoQWRqdXN0JywgJ29uYWN0aXZhdGUnLCAnb25jbGljaycsICdvbmZvY3VzaW4nLCAnb25mb2N1c291dCcsICdvbmxvYWQnLCAnb25tb3VzZWRvd24nLCAnb25tb3VzZW1vdmUnLCAnb25tb3VzZW91dCcsICdvbm1vdXNlb3ZlcicsICdvbm1vdXNldXAnLCAncmVxdWlyZWRFeHRlbnNpb25zJywgJ3JlcXVpcmVkRmVhdHVyZXMnLCAncm90YXRlJywgJ3N0eWxlJywgJ3N5c3RlbUxhbmd1YWdlJywgJ3RleHRMZW5ndGgnLCAneCcsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICB1c2U6IFsnY2xhc3MnLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdoZWlnaHQnLCAnaWQnLCAnb25hY3RpdmF0ZScsICdvbmNsaWNrJywgJ29uZm9jdXNpbicsICdvbmZvY3Vzb3V0JywgJ29ubG9hZCcsICdvbm1vdXNlZG93bicsICdvbm1vdXNlbW92ZScsICdvbm1vdXNlb3V0JywgJ29ubW91c2VvdmVyJywgJ29ubW91c2V1cCcsICdyZXF1aXJlZEV4dGVuc2lvbnMnLCAncmVxdWlyZWRGZWF0dXJlcycsICdzdHlsZScsICdzeXN0ZW1MYW5ndWFnZScsICd0cmFuc2Zvcm0nLCAnd2lkdGgnLCAneCcsICd4bGluazphY3R1YXRlJywgJ3hsaW5rOmFyY3JvbGUnLCAneGxpbms6aHJlZicsICd4bGluazpyb2xlJywgJ3hsaW5rOnNob3cnLCAneGxpbms6dGl0bGUnLCAneGxpbms6dHlwZScsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnLCAneSddLFxuICB2aWV3OiBbJ2V4dGVybmFsUmVzb3VyY2VzUmVxdWlyZWQnLCAnaWQnLCAncHJlc2VydmVBc3BlY3RSYXRpbycsICd2aWV3Qm94JywgJ3ZpZXdUYXJnZXQnLCAneG1sOmJhc2UnLCAneG1sOmxhbmcnLCAneG1sOnNwYWNlJywgJ3pvb21BbmRQYW4nXSxcbiAgdmtlcm46IFsnZzEnLCAnZzInLCAnaWQnLCAnaycsICd1MScsICd1MicsICd4bWw6YmFzZScsICd4bWw6bGFuZycsICd4bWw6c3BhY2UnXVxufTtcbnZhciBwcmVzZW50YXRpb25FbGVtZW50cyA9IGV4cG9ydHMucHJlc2VudGF0aW9uRWxlbWVudHMgPSB7XG4gICdhJzogdHJ1ZSxcbiAgJ2FsdEdseXBoJzogdHJ1ZSxcbiAgJ2FuaW1hdGUnOiB0cnVlLFxuICAnYW5pbWF0ZUNvbG9yJzogdHJ1ZSxcbiAgJ2NpcmNsZSc6IHRydWUsXG4gICdjbGlwUGF0aCc6IHRydWUsXG4gICdkZWZzJzogdHJ1ZSxcbiAgJ2VsbGlwc2UnOiB0cnVlLFxuICAnZmVCbGVuZCc6IHRydWUsXG4gICdmZUNvbG9yTWF0cml4JzogdHJ1ZSxcbiAgJ2ZlQ29tcG9uZW50VHJhbnNmZXInOiB0cnVlLFxuICAnZmVDb21wb3NpdGUnOiB0cnVlLFxuICAnZmVDb252b2x2ZU1hdHJpeCc6IHRydWUsXG4gICdmZURpZmZ1c2VMaWdodGluZyc6IHRydWUsXG4gICdmZURpc3BsYWNlbWVudE1hcCc6IHRydWUsXG4gICdmZUZsb29kJzogdHJ1ZSxcbiAgJ2ZlR2F1c3NpYW5CbHVyJzogdHJ1ZSxcbiAgJ2ZlSW1hZ2UnOiB0cnVlLFxuICAnZmVNZXJnZSc6IHRydWUsXG4gICdmZU1vcnBob2xvZ3knOiB0cnVlLFxuICAnZmVPZmZzZXQnOiB0cnVlLFxuICAnZmVTcGVjdWxhckxpZ2h0aW5nJzogdHJ1ZSxcbiAgJ2ZlVGlsZSc6IHRydWUsXG4gICdmZVR1cmJ1bGVuY2UnOiB0cnVlLFxuICAnZmlsdGVyJzogdHJ1ZSxcbiAgJ2ZvbnQnOiB0cnVlLFxuICAnZm9yZWlnbk9iamVjdCc6IHRydWUsXG4gICdnJzogdHJ1ZSxcbiAgJ2dseXBoJzogdHJ1ZSxcbiAgJ2dseXBoUmVmJzogdHJ1ZSxcbiAgJ2ltYWdlJzogdHJ1ZSxcbiAgJ2xpbmUnOiB0cnVlLFxuICAnbGluZWFyR3JhZGllbnQnOiB0cnVlLFxuICAnbWFya2VyJzogdHJ1ZSxcbiAgJ21hc2snOiB0cnVlLFxuICAnbWlzc2luZy1nbHlwaCc6IHRydWUsXG4gICdwYXRoJzogdHJ1ZSxcbiAgJ3BhdHRlcm4nOiB0cnVlLFxuICAncG9seWdvbic6IHRydWUsXG4gICdwb2x5bGluZSc6IHRydWUsXG4gICdyYWRpYWxHcmFkaWVudCc6IHRydWUsXG4gICdyZWN0JzogdHJ1ZSxcbiAgJ3N0b3AnOiB0cnVlLFxuICAnc3ZnJzogdHJ1ZSxcbiAgJ3N3aXRjaCc6IHRydWUsXG4gICdzeW1ib2wnOiB0cnVlLFxuICAndGV4dCc6IHRydWUsXG4gICd0ZXh0UGF0aCc6IHRydWUsXG4gICd0cmVmJzogdHJ1ZSxcbiAgJ3RzcGFuJzogdHJ1ZSxcbiAgJ3VzZSc6IHRydWVcbn07XG5cbnZhciBwcmVzZW50YXRpb25BdHRyaWJ1dGVzID0gZXhwb3J0cy5wcmVzZW50YXRpb25BdHRyaWJ1dGVzID0ge1xuICAnYWxpZ25tZW50LWJhc2VsaW5lJzogdHJ1ZSxcbiAgJ2Jhc2VsaW5lLXNoaWZ0JzogdHJ1ZSxcbiAgJ2NsaXAtcGF0aCc6IHRydWUsXG4gICdjbGlwLXJ1bGUnOiB0cnVlLFxuICAnY2xpcCc6IHRydWUsXG4gICdjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnMnOiB0cnVlLFxuICAnY29sb3ItaW50ZXJwb2xhdGlvbic6IHRydWUsXG4gICdjb2xvci1wcm9maWxlJzogdHJ1ZSxcbiAgJ2NvbG9yLXJlbmRlcmluZyc6IHRydWUsXG4gICdjb2xvcic6IHRydWUsXG4gICdjdXJzb3InOiB0cnVlLFxuICAnZGlyZWN0aW9uJzogdHJ1ZSxcbiAgJ2Rpc3BsYXknOiB0cnVlLFxuICAnZG9taW5hbnQtYmFzZWxpbmUnOiB0cnVlLFxuICAnZW5hYmxlLWJhY2tncm91bmQnOiB0cnVlLFxuICAnZmlsbC1vcGFjaXR5JzogdHJ1ZSxcbiAgJ2ZpbGwtcnVsZSc6IHRydWUsXG4gICdmaWxsJzogdHJ1ZSxcbiAgJ2ZpbHRlcic6IHRydWUsXG4gICdmbG9vZC1jb2xvcic6IHRydWUsXG4gICdmbG9vZC1vcGFjaXR5JzogdHJ1ZSxcbiAgJ2ZvbnQtZmFtaWx5JzogdHJ1ZSxcbiAgJ2ZvbnQtc2l6ZS1hZGp1c3QnOiB0cnVlLFxuICAnZm9udC1zaXplJzogdHJ1ZSxcbiAgJ2ZvbnQtc3RyZXRjaCc6IHRydWUsXG4gICdmb250LXN0eWxlJzogdHJ1ZSxcbiAgJ2ZvbnQtdmFyaWFudCc6IHRydWUsXG4gICdmb250LXdlaWdodCc6IHRydWUsXG4gICdnbHlwaC1vcmllbnRhdGlvbi1ob3Jpem9udGFsJzogdHJ1ZSxcbiAgJ2dseXBoLW9yaWVudGF0aW9uLXZlcnRpY2FsJzogdHJ1ZSxcbiAgJ2ltYWdlLXJlbmRlcmluZyc6IHRydWUsXG4gICdrZXJuaW5nJzogdHJ1ZSxcbiAgJ2xldHRlci1zcGFjaW5nJzogdHJ1ZSxcbiAgJ2xpZ2h0aW5nLWNvbG9yJzogdHJ1ZSxcbiAgJ21hcmtlci1lbmQnOiB0cnVlLFxuICAnbWFya2VyLW1pZCc6IHRydWUsXG4gICdtYXJrZXItc3RhcnQnOiB0cnVlLFxuICAnbWFzayc6IHRydWUsXG4gICdvcGFjaXR5JzogdHJ1ZSxcbiAgJ292ZXJmbG93JzogdHJ1ZSxcbiAgJ3BvaW50ZXItZXZlbnRzJzogdHJ1ZSxcbiAgJ3NoYXBlLXJlbmRlcmluZyc6IHRydWUsXG4gICdzdG9wLWNvbG9yJzogdHJ1ZSxcbiAgJ3N0b3Atb3BhY2l0eSc6IHRydWUsXG4gICdzdHJva2UtZGFzaGFycmF5JzogdHJ1ZSxcbiAgJ3N0cm9rZS1kYXNob2Zmc2V0JzogdHJ1ZSxcbiAgJ3N0cm9rZS1saW5lY2FwJzogdHJ1ZSxcbiAgJ3N0cm9rZS1saW5lam9pbic6IHRydWUsXG4gICdzdHJva2UtbWl0ZXJsaW1pdCc6IHRydWUsXG4gICdzdHJva2Utb3BhY2l0eSc6IHRydWUsXG4gICdzdHJva2Utd2lkdGgnOiB0cnVlLFxuICAnc3Ryb2tlJzogdHJ1ZSxcbiAgJ3RleHQtYW5jaG9yJzogdHJ1ZSxcbiAgJ3RleHQtZGVjb3JhdGlvbic6IHRydWUsXG4gICd0ZXh0LXJlbmRlcmluZyc6IHRydWUsXG4gICd1bmljb2RlLWJpZGknOiB0cnVlLFxuICAndmlzaWJpbGl0eSc6IHRydWUsXG4gICd3b3JkLXNwYWNpbmcnOiB0cnVlLFxuICAnd3JpdGluZy1tb2RlJzogdHJ1ZVxufTtcblxuZnVuY3Rpb24gY3JlYXRlRWxlbWVudChodG1sKSB7XG4gIHZhciBkaXYgPSBfYXVyZWxpYVBhbC5ET00uY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGRpdi5pbm5lckhUTUwgPSBodG1sO1xuICByZXR1cm4gZGl2LmZpcnN0Q2hpbGQ7XG59XG5cbnZhciBTVkdBbmFseXplciA9IGV4cG9ydHMuU1ZHQW5hbHl6ZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFNWR0FuYWx5emVyKCkge1xuICAgIFxuXG4gICAgaWYgKGNyZWF0ZUVsZW1lbnQoJzxzdmc+PGFsdEdseXBoIC8+PC9zdmc+JykuZmlyc3RFbGVtZW50Q2hpbGQubm9kZU5hbWUgPT09ICdhbHRnbHlwaCcgJiYgZWxlbWVudHMuYWx0R2x5cGgpIHtcbiAgICAgIGVsZW1lbnRzLmFsdGdseXBoID0gZWxlbWVudHMuYWx0R2x5cGg7XG4gICAgICBkZWxldGUgZWxlbWVudHMuYWx0R2x5cGg7XG4gICAgICBlbGVtZW50cy5hbHRnbHlwaGRlZiA9IGVsZW1lbnRzLmFsdEdseXBoRGVmO1xuICAgICAgZGVsZXRlIGVsZW1lbnRzLmFsdEdseXBoRGVmO1xuICAgICAgZWxlbWVudHMuYWx0Z2x5cGhpdGVtID0gZWxlbWVudHMuYWx0R2x5cGhJdGVtO1xuICAgICAgZGVsZXRlIGVsZW1lbnRzLmFsdEdseXBoSXRlbTtcbiAgICAgIGVsZW1lbnRzLmdseXBocmVmID0gZWxlbWVudHMuZ2x5cGhSZWY7XG4gICAgICBkZWxldGUgZWxlbWVudHMuZ2x5cGhSZWY7XG4gICAgfVxuICB9XG5cbiAgU1ZHQW5hbHl6ZXIucHJvdG90eXBlLmlzU3RhbmRhcmRTdmdBdHRyaWJ1dGUgPSBmdW5jdGlvbiBpc1N0YW5kYXJkU3ZnQXR0cmlidXRlKG5vZGVOYW1lLCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgcmV0dXJuIHByZXNlbnRhdGlvbkVsZW1lbnRzW25vZGVOYW1lXSAmJiBwcmVzZW50YXRpb25BdHRyaWJ1dGVzW2F0dHJpYnV0ZU5hbWVdIHx8IGVsZW1lbnRzW25vZGVOYW1lXSAmJiBlbGVtZW50c1tub2RlTmFtZV0uaW5kZXhPZihhdHRyaWJ1dGVOYW1lKSAhPT0gLTE7XG4gIH07XG5cbiAgcmV0dXJuIFNWR0FuYWx5emVyO1xufSgpO1xuXG52YXIgT2JzZXJ2ZXJMb2NhdG9yID0gZXhwb3J0cy5PYnNlcnZlckxvY2F0b3IgPSAoX3RlbXAgPSBfY2xhc3MxMSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gT2JzZXJ2ZXJMb2NhdG9yKHRhc2tRdWV1ZSwgZXZlbnRNYW5hZ2VyLCBkaXJ0eUNoZWNrZXIsIHN2Z0FuYWx5emVyLCBwYXJzZXIpIHtcbiAgICBcblxuICAgIHRoaXMudGFza1F1ZXVlID0gdGFza1F1ZXVlO1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyID0gZXZlbnRNYW5hZ2VyO1xuICAgIHRoaXMuZGlydHlDaGVja2VyID0gZGlydHlDaGVja2VyO1xuICAgIHRoaXMuc3ZnQW5hbHl6ZXIgPSBzdmdBbmFseXplcjtcbiAgICB0aGlzLnBhcnNlciA9IHBhcnNlcjtcbiAgICB0aGlzLmFkYXB0ZXJzID0gW107XG4gICAgdGhpcy5sb2dnZXIgPSBMb2dNYW5hZ2VyLmdldExvZ2dlcignb2JzZXJ2ZXItbG9jYXRvcicpO1xuICB9XG5cbiAgT2JzZXJ2ZXJMb2NhdG9yLnByb3RvdHlwZS5nZXRPYnNlcnZlciA9IGZ1bmN0aW9uIGdldE9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lKSB7XG4gICAgdmFyIG9ic2VydmVyc0xvb2t1cCA9IG9iai5fX29ic2VydmVyc19fO1xuICAgIHZhciBvYnNlcnZlciA9IHZvaWQgMDtcblxuICAgIGlmIChvYnNlcnZlcnNMb29rdXAgJiYgcHJvcGVydHlOYW1lIGluIG9ic2VydmVyc0xvb2t1cCkge1xuICAgICAgcmV0dXJuIG9ic2VydmVyc0xvb2t1cFtwcm9wZXJ0eU5hbWVdO1xuICAgIH1cblxuICAgIG9ic2VydmVyID0gdGhpcy5jcmVhdGVQcm9wZXJ0eU9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lKTtcblxuICAgIGlmICghb2JzZXJ2ZXIuZG9Ob3RDYWNoZSkge1xuICAgICAgaWYgKG9ic2VydmVyc0xvb2t1cCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG9ic2VydmVyc0xvb2t1cCA9IHRoaXMuZ2V0T3JDcmVhdGVPYnNlcnZlcnNMb29rdXAob2JqKTtcbiAgICAgIH1cblxuICAgICAgb2JzZXJ2ZXJzTG9va3VwW3Byb3BlcnR5TmFtZV0gPSBvYnNlcnZlcjtcbiAgICB9XG5cbiAgICByZXR1cm4gb2JzZXJ2ZXI7XG4gIH07XG5cbiAgT2JzZXJ2ZXJMb2NhdG9yLnByb3RvdHlwZS5nZXRPckNyZWF0ZU9ic2VydmVyc0xvb2t1cCA9IGZ1bmN0aW9uIGdldE9yQ3JlYXRlT2JzZXJ2ZXJzTG9va3VwKG9iaikge1xuICAgIHJldHVybiBvYmouX19vYnNlcnZlcnNfXyB8fCB0aGlzLmNyZWF0ZU9ic2VydmVyc0xvb2t1cChvYmopO1xuICB9O1xuXG4gIE9ic2VydmVyTG9jYXRvci5wcm90b3R5cGUuY3JlYXRlT2JzZXJ2ZXJzTG9va3VwID0gZnVuY3Rpb24gY3JlYXRlT2JzZXJ2ZXJzTG9va3VwKG9iaikge1xuICAgIHZhciB2YWx1ZSA9IHt9O1xuXG4gICAgaWYgKCFSZWZsZWN0LmRlZmluZVByb3BlcnR5KG9iaiwgJ19fb2JzZXJ2ZXJzX18nLCB7XG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICB2YWx1ZTogdmFsdWVcbiAgICB9KSkge1xuICAgICAgdGhpcy5sb2dnZXIud2FybignQ2Fubm90IGFkZCBvYnNlcnZlcnMgdG8gb2JqZWN0Jywgb2JqKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdmFsdWU7XG4gIH07XG5cbiAgT2JzZXJ2ZXJMb2NhdG9yLnByb3RvdHlwZS5hZGRBZGFwdGVyID0gZnVuY3Rpb24gYWRkQWRhcHRlcihhZGFwdGVyKSB7XG4gICAgdGhpcy5hZGFwdGVycy5wdXNoKGFkYXB0ZXIpO1xuICB9O1xuXG4gIE9ic2VydmVyTG9jYXRvci5wcm90b3R5cGUuZ2V0QWRhcHRlck9ic2VydmVyID0gZnVuY3Rpb24gZ2V0QWRhcHRlck9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lLCBkZXNjcmlwdG9yKSB7XG4gICAgZm9yICh2YXIgX2kyNiA9IDAsIGlpID0gdGhpcy5hZGFwdGVycy5sZW5ndGg7IF9pMjYgPCBpaTsgX2kyNisrKSB7XG4gICAgICB2YXIgYWRhcHRlciA9IHRoaXMuYWRhcHRlcnNbX2kyNl07XG4gICAgICB2YXIgb2JzZXJ2ZXIgPSBhZGFwdGVyLmdldE9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lLCBkZXNjcmlwdG9yKTtcbiAgICAgIGlmIChvYnNlcnZlcikge1xuICAgICAgICByZXR1cm4gb2JzZXJ2ZXI7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIE9ic2VydmVyTG9jYXRvci5wcm90b3R5cGUuY3JlYXRlUHJvcGVydHlPYnNlcnZlciA9IGZ1bmN0aW9uIGNyZWF0ZVByb3BlcnR5T2JzZXJ2ZXIob2JqLCBwcm9wZXJ0eU5hbWUpIHtcbiAgICB2YXIgZGVzY3JpcHRvciA9IHZvaWQgMDtcbiAgICB2YXIgaGFuZGxlciA9IHZvaWQgMDtcbiAgICB2YXIgeGxpbmtSZXN1bHQgPSB2b2lkIDA7XG5cbiAgICBpZiAoIShvYmogaW5zdGFuY2VvZiBPYmplY3QpKSB7XG4gICAgICByZXR1cm4gbmV3IFByaW1pdGl2ZU9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lKTtcbiAgICB9XG5cbiAgICBpZiAob2JqIGluc3RhbmNlb2YgX2F1cmVsaWFQYWwuRE9NLkVsZW1lbnQpIHtcbiAgICAgIGlmIChwcm9wZXJ0eU5hbWUgPT09ICdjbGFzcycpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDbGFzc09ic2VydmVyKG9iaik7XG4gICAgICB9XG4gICAgICBpZiAocHJvcGVydHlOYW1lID09PSAnc3R5bGUnIHx8IHByb3BlcnR5TmFtZSA9PT0gJ2NzcycpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTdHlsZU9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lKTtcbiAgICAgIH1cbiAgICAgIGhhbmRsZXIgPSB0aGlzLmV2ZW50TWFuYWdlci5nZXRFbGVtZW50SGFuZGxlcihvYmosIHByb3BlcnR5TmFtZSk7XG4gICAgICBpZiAocHJvcGVydHlOYW1lID09PSAndmFsdWUnICYmIG9iai50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdzZWxlY3QnKSB7XG4gICAgICAgIHJldHVybiBuZXcgU2VsZWN0VmFsdWVPYnNlcnZlcihvYmosIGhhbmRsZXIsIHRoaXMpO1xuICAgICAgfVxuICAgICAgaWYgKHByb3BlcnR5TmFtZSA9PT0gJ2NoZWNrZWQnICYmIG9iai50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdpbnB1dCcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDaGVja2VkT2JzZXJ2ZXIob2JqLCBoYW5kbGVyLCB0aGlzKTtcbiAgICAgIH1cbiAgICAgIGlmIChoYW5kbGVyKSB7XG4gICAgICAgIHJldHVybiBuZXcgVmFsdWVBdHRyaWJ1dGVPYnNlcnZlcihvYmosIHByb3BlcnR5TmFtZSwgaGFuZGxlcik7XG4gICAgICB9XG4gICAgICB4bGlua1Jlc3VsdCA9IC9eeGxpbms6KC4rKSQvLmV4ZWMocHJvcGVydHlOYW1lKTtcbiAgICAgIGlmICh4bGlua1Jlc3VsdCkge1xuICAgICAgICByZXR1cm4gbmV3IFhMaW5rQXR0cmlidXRlT2JzZXJ2ZXIob2JqLCBwcm9wZXJ0eU5hbWUsIHhsaW5rUmVzdWx0WzFdKTtcbiAgICAgIH1cbiAgICAgIGlmICgvXlxcdys6fF5kYXRhLXxeYXJpYS0vLnRlc3QocHJvcGVydHlOYW1lKSB8fCBvYmogaW5zdGFuY2VvZiBfYXVyZWxpYVBhbC5ET00uU1ZHRWxlbWVudCAmJiB0aGlzLnN2Z0FuYWx5emVyLmlzU3RhbmRhcmRTdmdBdHRyaWJ1dGUob2JqLm5vZGVOYW1lLCBwcm9wZXJ0eU5hbWUpKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF0YUF0dHJpYnV0ZU9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBkZXNjcmlwdG9yID0gT2JqZWN0LmdldFByb3BlcnR5RGVzY3JpcHRvcihvYmosIHByb3BlcnR5TmFtZSk7XG5cbiAgICBpZiAoaGFzRGVjbGFyZWREZXBlbmRlbmNpZXMoZGVzY3JpcHRvcikpIHtcbiAgICAgIHJldHVybiBjcmVhdGVDb21wdXRlZE9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lLCBkZXNjcmlwdG9yLCB0aGlzKTtcbiAgICB9XG5cbiAgICB2YXIgZXhpc3RpbmdHZXR0ZXJPclNldHRlciA9IHZvaWQgMDtcbiAgICBpZiAoZGVzY3JpcHRvciAmJiAoZXhpc3RpbmdHZXR0ZXJPclNldHRlciA9IGRlc2NyaXB0b3IuZ2V0IHx8IGRlc2NyaXB0b3Iuc2V0KSkge1xuICAgICAgaWYgKGV4aXN0aW5nR2V0dGVyT3JTZXR0ZXIuZ2V0T2JzZXJ2ZXIpIHtcbiAgICAgICAgcmV0dXJuIGV4aXN0aW5nR2V0dGVyT3JTZXR0ZXIuZ2V0T2JzZXJ2ZXIob2JqKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGFkYXB0ZXJPYnNlcnZlciA9IHRoaXMuZ2V0QWRhcHRlck9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lLCBkZXNjcmlwdG9yKTtcbiAgICAgIGlmIChhZGFwdGVyT2JzZXJ2ZXIpIHtcbiAgICAgICAgcmV0dXJuIGFkYXB0ZXJPYnNlcnZlcjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBuZXcgRGlydHlDaGVja1Byb3BlcnR5KHRoaXMuZGlydHlDaGVja2VyLCBvYmosIHByb3BlcnR5TmFtZSk7XG4gICAgfVxuXG4gICAgaWYgKG9iaiBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICBpZiAocHJvcGVydHlOYW1lID09PSAnbGVuZ3RoJykge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBcnJheU9ic2VydmVyKG9iaikuZ2V0TGVuZ3RoT2JzZXJ2ZXIoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5ldyBEaXJ0eUNoZWNrUHJvcGVydHkodGhpcy5kaXJ0eUNoZWNrZXIsIG9iaiwgcHJvcGVydHlOYW1lKTtcbiAgICB9IGVsc2UgaWYgKG9iaiBpbnN0YW5jZW9mIE1hcCkge1xuICAgICAgaWYgKHByb3BlcnR5TmFtZSA9PT0gJ3NpemUnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE1hcE9ic2VydmVyKG9iaikuZ2V0TGVuZ3RoT2JzZXJ2ZXIoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5ldyBEaXJ0eUNoZWNrUHJvcGVydHkodGhpcy5kaXJ0eUNoZWNrZXIsIG9iaiwgcHJvcGVydHlOYW1lKTtcbiAgICB9IGVsc2UgaWYgKG9iaiBpbnN0YW5jZW9mIFNldCkge1xuICAgICAgaWYgKHByb3BlcnR5TmFtZSA9PT0gJ3NpemUnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFNldE9ic2VydmVyKG9iaikuZ2V0TGVuZ3RoT2JzZXJ2ZXIoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5ldyBEaXJ0eUNoZWNrUHJvcGVydHkodGhpcy5kaXJ0eUNoZWNrZXIsIG9iaiwgcHJvcGVydHlOYW1lKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFNldHRlck9ic2VydmVyKHRoaXMudGFza1F1ZXVlLCBvYmosIHByb3BlcnR5TmFtZSk7XG4gIH07XG5cbiAgT2JzZXJ2ZXJMb2NhdG9yLnByb3RvdHlwZS5nZXRBY2Nlc3NvciA9IGZ1bmN0aW9uIGdldEFjY2Vzc29yKG9iaiwgcHJvcGVydHlOYW1lKSB7XG4gICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9hdXJlbGlhUGFsLkRPTS5FbGVtZW50KSB7XG4gICAgICBpZiAocHJvcGVydHlOYW1lID09PSAnY2xhc3MnIHx8IHByb3BlcnR5TmFtZSA9PT0gJ3N0eWxlJyB8fCBwcm9wZXJ0eU5hbWUgPT09ICdjc3MnIHx8IHByb3BlcnR5TmFtZSA9PT0gJ3ZhbHVlJyAmJiAob2JqLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2lucHV0JyB8fCBvYmoudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnc2VsZWN0JykgfHwgcHJvcGVydHlOYW1lID09PSAnY2hlY2tlZCcgJiYgb2JqLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2lucHV0JyB8fCBwcm9wZXJ0eU5hbWUgPT09ICdtb2RlbCcgJiYgb2JqLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2lucHV0JyB8fCAvXnhsaW5rOi4rJC8uZXhlYyhwcm9wZXJ0eU5hbWUpKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE9ic2VydmVyKG9iaiwgcHJvcGVydHlOYW1lKTtcbiAgICAgIH1cbiAgICAgIGlmICgvXlxcdys6fF5kYXRhLXxeYXJpYS0vLnRlc3QocHJvcGVydHlOYW1lKSB8fCBvYmogaW5zdGFuY2VvZiBfYXVyZWxpYVBhbC5ET00uU1ZHRWxlbWVudCAmJiB0aGlzLnN2Z0FuYWx5emVyLmlzU3RhbmRhcmRTdmdBdHRyaWJ1dGUob2JqLm5vZGVOYW1lLCBwcm9wZXJ0eU5hbWUpKSB7XG4gICAgICAgIHJldHVybiBkYXRhQXR0cmlidXRlQWNjZXNzb3I7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwcm9wZXJ0eUFjY2Vzc29yO1xuICB9O1xuXG4gIE9ic2VydmVyTG9jYXRvci5wcm90b3R5cGUuZ2V0QXJyYXlPYnNlcnZlciA9IGZ1bmN0aW9uIGdldEFycmF5T2JzZXJ2ZXIoYXJyYXkpIHtcbiAgICByZXR1cm4gX2dldEFycmF5T2JzZXJ2ZXIodGhpcy50YXNrUXVldWUsIGFycmF5KTtcbiAgfTtcblxuICBPYnNlcnZlckxvY2F0b3IucHJvdG90eXBlLmdldE1hcE9ic2VydmVyID0gZnVuY3Rpb24gZ2V0TWFwT2JzZXJ2ZXIobWFwKSB7XG4gICAgcmV0dXJuIF9nZXRNYXBPYnNlcnZlcih0aGlzLnRhc2tRdWV1ZSwgbWFwKTtcbiAgfTtcblxuICBPYnNlcnZlckxvY2F0b3IucHJvdG90eXBlLmdldFNldE9ic2VydmVyID0gZnVuY3Rpb24gZ2V0U2V0T2JzZXJ2ZXIoc2V0KSB7XG4gICAgcmV0dXJuIF9nZXRTZXRPYnNlcnZlcih0aGlzLnRhc2tRdWV1ZSwgc2V0KTtcbiAgfTtcblxuICByZXR1cm4gT2JzZXJ2ZXJMb2NhdG9yO1xufSgpLCBfY2xhc3MxMS5pbmplY3QgPSBbX2F1cmVsaWFUYXNrUXVldWUuVGFza1F1ZXVlLCBFdmVudE1hbmFnZXIsIERpcnR5Q2hlY2tlciwgU1ZHQW5hbHl6ZXIsIFBhcnNlcl0sIF90ZW1wKTtcblxudmFyIE9iamVjdE9ic2VydmF0aW9uQWRhcHRlciA9IGV4cG9ydHMuT2JqZWN0T2JzZXJ2YXRpb25BZGFwdGVyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBPYmplY3RPYnNlcnZhdGlvbkFkYXB0ZXIoKSB7XG4gICAgXG4gIH1cblxuICBPYmplY3RPYnNlcnZhdGlvbkFkYXB0ZXIucHJvdG90eXBlLmdldE9ic2VydmVyID0gZnVuY3Rpb24gZ2V0T2JzZXJ2ZXIob2JqZWN0LCBwcm9wZXJ0eU5hbWUsIGRlc2NyaXB0b3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0JpbmRpbmdBZGFwdGVycyBtdXN0IGltcGxlbWVudCBnZXRPYnNlcnZlcihvYmplY3QsIHByb3BlcnR5TmFtZSkuJyk7XG4gIH07XG5cbiAgcmV0dXJuIE9iamVjdE9ic2VydmF0aW9uQWRhcHRlcjtcbn0oKTtcblxudmFyIEJpbmRpbmdFeHByZXNzaW9uID0gZXhwb3J0cy5CaW5kaW5nRXhwcmVzc2lvbiA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQmluZGluZ0V4cHJlc3Npb24ob2JzZXJ2ZXJMb2NhdG9yLCB0YXJnZXRQcm9wZXJ0eSwgc291cmNlRXhwcmVzc2lvbiwgbW9kZSwgbG9va3VwRnVuY3Rpb25zLCBhdHRyaWJ1dGUpIHtcbiAgICBcblxuICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xuICAgIHRoaXMudGFyZ2V0UHJvcGVydHkgPSB0YXJnZXRQcm9wZXJ0eTtcbiAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24gPSBzb3VyY2VFeHByZXNzaW9uO1xuICAgIHRoaXMubW9kZSA9IG1vZGU7XG4gICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSBsb29rdXBGdW5jdGlvbnM7XG4gICAgdGhpcy5hdHRyaWJ1dGUgPSBhdHRyaWJ1dGU7XG4gICAgdGhpcy5kaXNjcmV0ZSA9IGZhbHNlO1xuICB9XG5cbiAgQmluZGluZ0V4cHJlc3Npb24ucHJvdG90eXBlLmNyZWF0ZUJpbmRpbmcgPSBmdW5jdGlvbiBjcmVhdGVCaW5kaW5nKHRhcmdldCkge1xuICAgIHJldHVybiBuZXcgQmluZGluZyh0aGlzLm9ic2VydmVyTG9jYXRvciwgdGhpcy5zb3VyY2VFeHByZXNzaW9uLCB0YXJnZXQsIHRoaXMudGFyZ2V0UHJvcGVydHksIHRoaXMubW9kZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICB9O1xuXG4gIHJldHVybiBCaW5kaW5nRXhwcmVzc2lvbjtcbn0oKTtcblxudmFyIHRhcmdldENvbnRleHQgPSAnQmluZGluZzp0YXJnZXQnO1xuXG52YXIgQmluZGluZyA9IGV4cG9ydHMuQmluZGluZyA9IChfZGVjMTAgPSBjb25uZWN0YWJsZSgpLCBfZGVjMTAoX2NsYXNzMTIgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEJpbmRpbmcob2JzZXJ2ZXJMb2NhdG9yLCBzb3VyY2VFeHByZXNzaW9uLCB0YXJnZXQsIHRhcmdldFByb3BlcnR5LCBtb2RlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICBcblxuICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xuICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbiA9IHNvdXJjZUV4cHJlc3Npb247XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy50YXJnZXRQcm9wZXJ0eSA9IHRhcmdldFByb3BlcnR5O1xuICAgIHRoaXMubW9kZSA9IG1vZGU7XG4gICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSBsb29rdXBGdW5jdGlvbnM7XG4gIH1cblxuICBCaW5kaW5nLnByb3RvdHlwZS51cGRhdGVUYXJnZXQgPSBmdW5jdGlvbiB1cGRhdGVUYXJnZXQodmFsdWUpIHtcbiAgICB0aGlzLnRhcmdldE9ic2VydmVyLnNldFZhbHVlKHZhbHVlLCB0aGlzLnRhcmdldCwgdGhpcy50YXJnZXRQcm9wZXJ0eSk7XG4gIH07XG5cbiAgQmluZGluZy5wcm90b3R5cGUudXBkYXRlU291cmNlID0gZnVuY3Rpb24gdXBkYXRlU291cmNlKHZhbHVlKSB7XG4gICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLmFzc2lnbih0aGlzLnNvdXJjZSwgdmFsdWUsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgfTtcblxuICBCaW5kaW5nLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gY2FsbChjb250ZXh0LCBuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICBpZiAoIXRoaXMuaXNCb3VuZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoY29udGV4dCA9PT0gc291cmNlQ29udGV4dCkge1xuICAgICAgb2xkVmFsdWUgPSB0aGlzLnRhcmdldE9ic2VydmVyLmdldFZhbHVlKHRoaXMudGFyZ2V0LCB0aGlzLnRhcmdldFByb3BlcnR5KTtcbiAgICAgIG5ld1ZhbHVlID0gdGhpcy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc291cmNlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgICBpZiAobmV3VmFsdWUgIT09IG9sZFZhbHVlKSB7XG4gICAgICAgIHRoaXMudXBkYXRlVGFyZ2V0KG5ld1ZhbHVlKTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm1vZGUgIT09IGJpbmRpbmdNb2RlLm9uZVRpbWUpIHtcbiAgICAgICAgdGhpcy5fdmVyc2lvbisrO1xuICAgICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24uY29ubmVjdCh0aGlzLCB0aGlzLnNvdXJjZSk7XG4gICAgICAgIHRoaXMudW5vYnNlcnZlKGZhbHNlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGNvbnRleHQgPT09IHRhcmdldENvbnRleHQpIHtcbiAgICAgIGlmIChuZXdWYWx1ZSAhPT0gdGhpcy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc291cmNlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucykpIHtcbiAgICAgICAgdGhpcy51cGRhdGVTb3VyY2UobmV3VmFsdWUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuZXhwZWN0ZWQgY2FsbCBjb250ZXh0ICcgKyBjb250ZXh0KTtcbiAgfTtcblxuICBCaW5kaW5nLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gYmluZChzb3VyY2UpIHtcbiAgICBpZiAodGhpcy5pc0JvdW5kKSB7XG4gICAgICBpZiAodGhpcy5zb3VyY2UgPT09IHNvdXJjZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLnVuYmluZCgpO1xuICAgIH1cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXG4gICAgaWYgKHRoaXMuc291cmNlRXhwcmVzc2lvbi5iaW5kKSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24uYmluZCh0aGlzLCBzb3VyY2UsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICB9XG5cbiAgICB2YXIgbW9kZSA9IHRoaXMubW9kZTtcbiAgICBpZiAoIXRoaXMudGFyZ2V0T2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBtZXRob2QgPSBtb2RlID09PSBiaW5kaW5nTW9kZS50d29XYXkgPyAnZ2V0T2JzZXJ2ZXInIDogJ2dldEFjY2Vzc29yJztcbiAgICAgIHRoaXMudGFyZ2V0T2JzZXJ2ZXIgPSB0aGlzLm9ic2VydmVyTG9jYXRvclttZXRob2RdKHRoaXMudGFyZ2V0LCB0aGlzLnRhcmdldFByb3BlcnR5KTtcbiAgICB9XG5cbiAgICBpZiAoJ2JpbmQnIGluIHRoaXMudGFyZ2V0T2JzZXJ2ZXIpIHtcbiAgICAgIHRoaXMudGFyZ2V0T2JzZXJ2ZXIuYmluZCgpO1xuICAgIH1cbiAgICB2YXIgdmFsdWUgPSB0aGlzLnNvdXJjZUV4cHJlc3Npb24uZXZhbHVhdGUoc291cmNlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgdGhpcy51cGRhdGVUYXJnZXQodmFsdWUpO1xuXG4gICAgaWYgKG1vZGUgPT09IGJpbmRpbmdNb2RlLm9uZVdheSkge1xuICAgICAgZW5xdWV1ZUJpbmRpbmdDb25uZWN0KHRoaXMpO1xuICAgIH0gZWxzZSBpZiAobW9kZSA9PT0gYmluZGluZ01vZGUudHdvV2F5KSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24uY29ubmVjdCh0aGlzLCBzb3VyY2UpO1xuICAgICAgdGhpcy50YXJnZXRPYnNlcnZlci5zdWJzY3JpYmUodGFyZ2V0Q29udGV4dCwgdGhpcyk7XG4gICAgfVxuICB9O1xuXG4gIEJpbmRpbmcucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uIHVuYmluZCgpIHtcbiAgICBpZiAoIXRoaXMuaXNCb3VuZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmlzQm91bmQgPSBmYWxzZTtcbiAgICBpZiAodGhpcy5zb3VyY2VFeHByZXNzaW9uLnVuYmluZCkge1xuICAgICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLnVuYmluZCh0aGlzLCB0aGlzLnNvdXJjZSk7XG4gICAgfVxuICAgIHRoaXMuc291cmNlID0gbnVsbDtcbiAgICBpZiAoJ3VuYmluZCcgaW4gdGhpcy50YXJnZXRPYnNlcnZlcikge1xuICAgICAgdGhpcy50YXJnZXRPYnNlcnZlci51bmJpbmQoKTtcbiAgICB9XG4gICAgaWYgKHRoaXMudGFyZ2V0T2JzZXJ2ZXIudW5zdWJzY3JpYmUpIHtcbiAgICAgIHRoaXMudGFyZ2V0T2JzZXJ2ZXIudW5zdWJzY3JpYmUodGFyZ2V0Q29udGV4dCwgdGhpcyk7XG4gICAgfVxuICAgIHRoaXMudW5vYnNlcnZlKHRydWUpO1xuICB9O1xuXG4gIEJpbmRpbmcucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbiBjb25uZWN0KGV2YWx1YXRlKSB7XG4gICAgaWYgKCF0aGlzLmlzQm91bmQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGV2YWx1YXRlKSB7XG4gICAgICB2YXIgdmFsdWUgPSB0aGlzLnNvdXJjZUV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zb3VyY2UsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICAgIHRoaXMudXBkYXRlVGFyZ2V0KHZhbHVlKTtcbiAgICB9XG4gICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLmNvbm5lY3QodGhpcywgdGhpcy5zb3VyY2UpO1xuICB9O1xuXG4gIHJldHVybiBCaW5kaW5nO1xufSgpKSB8fCBfY2xhc3MxMik7XG5cbnZhciBDYWxsRXhwcmVzc2lvbiA9IGV4cG9ydHMuQ2FsbEV4cHJlc3Npb24gPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIENhbGxFeHByZXNzaW9uKG9ic2VydmVyTG9jYXRvciwgdGFyZ2V0UHJvcGVydHksIHNvdXJjZUV4cHJlc3Npb24sIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIFxuXG4gICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XG4gICAgdGhpcy50YXJnZXRQcm9wZXJ0eSA9IHRhcmdldFByb3BlcnR5O1xuICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbiA9IHNvdXJjZUV4cHJlc3Npb247XG4gICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSBsb29rdXBGdW5jdGlvbnM7XG4gIH1cblxuICBDYWxsRXhwcmVzc2lvbi5wcm90b3R5cGUuY3JlYXRlQmluZGluZyA9IGZ1bmN0aW9uIGNyZWF0ZUJpbmRpbmcodGFyZ2V0KSB7XG4gICAgcmV0dXJuIG5ldyBDYWxsKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0aGlzLnNvdXJjZUV4cHJlc3Npb24sIHRhcmdldCwgdGhpcy50YXJnZXRQcm9wZXJ0eSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICB9O1xuXG4gIHJldHVybiBDYWxsRXhwcmVzc2lvbjtcbn0oKTtcblxudmFyIENhbGwgPSBleHBvcnRzLkNhbGwgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIENhbGwob2JzZXJ2ZXJMb2NhdG9yLCBzb3VyY2VFeHByZXNzaW9uLCB0YXJnZXQsIHRhcmdldFByb3BlcnR5LCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICBcblxuICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbiA9IHNvdXJjZUV4cHJlc3Npb247XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy50YXJnZXRQcm9wZXJ0eSA9IG9ic2VydmVyTG9jYXRvci5nZXRPYnNlcnZlcih0YXJnZXQsIHRhcmdldFByb3BlcnR5KTtcbiAgICB0aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IGxvb2t1cEZ1bmN0aW9ucztcbiAgfVxuXG4gIENhbGwucHJvdG90eXBlLmNhbGxTb3VyY2UgPSBmdW5jdGlvbiBjYWxsU291cmNlKCRldmVudCkge1xuICAgIHZhciBvdmVycmlkZUNvbnRleHQgPSB0aGlzLnNvdXJjZS5vdmVycmlkZUNvbnRleHQ7XG4gICAgT2JqZWN0LmFzc2lnbihvdmVycmlkZUNvbnRleHQsICRldmVudCk7XG4gICAgb3ZlcnJpZGVDb250ZXh0LiRldmVudCA9ICRldmVudDtcbiAgICB2YXIgbXVzdEV2YWx1YXRlID0gdHJ1ZTtcbiAgICB2YXIgcmVzdWx0ID0gdGhpcy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc291cmNlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucywgbXVzdEV2YWx1YXRlKTtcbiAgICBkZWxldGUgb3ZlcnJpZGVDb250ZXh0LiRldmVudDtcbiAgICBmb3IgKHZhciBwcm9wIGluICRldmVudCkge1xuICAgICAgZGVsZXRlIG92ZXJyaWRlQ29udGV4dFtwcm9wXTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBDYWxsLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gYmluZChzb3VyY2UpIHtcbiAgICB2YXIgX3RoaXMyNyA9IHRoaXM7XG5cbiAgICBpZiAodGhpcy5pc0JvdW5kKSB7XG4gICAgICBpZiAodGhpcy5zb3VyY2UgPT09IHNvdXJjZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLnVuYmluZCgpO1xuICAgIH1cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXG4gICAgaWYgKHRoaXMuc291cmNlRXhwcmVzc2lvbi5iaW5kKSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24uYmluZCh0aGlzLCBzb3VyY2UsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICB9XG4gICAgdGhpcy50YXJnZXRQcm9wZXJ0eS5zZXRWYWx1ZShmdW5jdGlvbiAoJGV2ZW50KSB7XG4gICAgICByZXR1cm4gX3RoaXMyNy5jYWxsU291cmNlKCRldmVudCk7XG4gICAgfSk7XG4gIH07XG5cbiAgQ2FsbC5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gdW5iaW5kKCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgIGlmICh0aGlzLnNvdXJjZUV4cHJlc3Npb24udW5iaW5kKSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24udW5iaW5kKHRoaXMsIHRoaXMuc291cmNlKTtcbiAgICB9XG4gICAgdGhpcy5zb3VyY2UgPSBudWxsO1xuICAgIHRoaXMudGFyZ2V0UHJvcGVydHkuc2V0VmFsdWUobnVsbCk7XG4gIH07XG5cbiAgcmV0dXJuIENhbGw7XG59KCk7XG5cbnZhciBWYWx1ZUNvbnZlcnRlclJlc291cmNlID0gZXhwb3J0cy5WYWx1ZUNvbnZlcnRlclJlc291cmNlID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBWYWx1ZUNvbnZlcnRlclJlc291cmNlKG5hbWUpIHtcbiAgICBcblxuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gIH1cblxuICBWYWx1ZUNvbnZlcnRlclJlc291cmNlLmNvbnZlbnRpb24gPSBmdW5jdGlvbiBjb252ZW50aW9uKG5hbWUpIHtcbiAgICBpZiAobmFtZS5lbmRzV2l0aCgnVmFsdWVDb252ZXJ0ZXInKSkge1xuICAgICAgcmV0dXJuIG5ldyBWYWx1ZUNvbnZlcnRlclJlc291cmNlKGNhbWVsQ2FzZShuYW1lLnN1YnN0cmluZygwLCBuYW1lLmxlbmd0aCAtIDE0KSkpO1xuICAgIH1cbiAgfTtcblxuICBWYWx1ZUNvbnZlcnRlclJlc291cmNlLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24gaW5pdGlhbGl6ZShjb250YWluZXIsIHRhcmdldCkge1xuICAgIHRoaXMuaW5zdGFuY2UgPSBjb250YWluZXIuZ2V0KHRhcmdldCk7XG4gIH07XG5cbiAgVmFsdWVDb252ZXJ0ZXJSZXNvdXJjZS5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbiByZWdpc3RlcihyZWdpc3RyeSwgbmFtZSkge1xuICAgIHJlZ2lzdHJ5LnJlZ2lzdGVyVmFsdWVDb252ZXJ0ZXIobmFtZSB8fCB0aGlzLm5hbWUsIHRoaXMuaW5zdGFuY2UpO1xuICB9O1xuXG4gIFZhbHVlQ29udmVydGVyUmVzb3VyY2UucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiBsb2FkKGNvbnRhaW5lciwgdGFyZ2V0KSB7fTtcblxuICByZXR1cm4gVmFsdWVDb252ZXJ0ZXJSZXNvdXJjZTtcbn0oKTtcblxuZnVuY3Rpb24gdmFsdWVDb252ZXJ0ZXIobmFtZU9yVGFyZ2V0KSB7XG4gIGlmIChuYW1lT3JUYXJnZXQgPT09IHVuZGVmaW5lZCB8fCB0eXBlb2YgbmFtZU9yVGFyZ2V0ID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICBfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLmRlZmluZShfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLnJlc291cmNlLCBuZXcgVmFsdWVDb252ZXJ0ZXJSZXNvdXJjZShuYW1lT3JUYXJnZXQpLCB0YXJnZXQpO1xuICAgIH07XG4gIH1cblxuICBfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLmRlZmluZShfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLnJlc291cmNlLCBuZXcgVmFsdWVDb252ZXJ0ZXJSZXNvdXJjZSgpLCBuYW1lT3JUYXJnZXQpO1xufVxuXG52YXIgQmluZGluZ0JlaGF2aW9yUmVzb3VyY2UgPSBleHBvcnRzLkJpbmRpbmdCZWhhdmlvclJlc291cmNlID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBCaW5kaW5nQmVoYXZpb3JSZXNvdXJjZShuYW1lKSB7XG4gICAgXG5cbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICB9XG5cbiAgQmluZGluZ0JlaGF2aW9yUmVzb3VyY2UuY29udmVudGlvbiA9IGZ1bmN0aW9uIGNvbnZlbnRpb24obmFtZSkge1xuICAgIGlmIChuYW1lLmVuZHNXaXRoKCdCaW5kaW5nQmVoYXZpb3InKSkge1xuICAgICAgcmV0dXJuIG5ldyBCaW5kaW5nQmVoYXZpb3JSZXNvdXJjZShjYW1lbENhc2UobmFtZS5zdWJzdHJpbmcoMCwgbmFtZS5sZW5ndGggLSAxNSkpKTtcbiAgICB9XG4gIH07XG5cbiAgQmluZGluZ0JlaGF2aW9yUmVzb3VyY2UucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiBpbml0aWFsaXplKGNvbnRhaW5lciwgdGFyZ2V0KSB7XG4gICAgdGhpcy5pbnN0YW5jZSA9IGNvbnRhaW5lci5nZXQodGFyZ2V0KTtcbiAgfTtcblxuICBCaW5kaW5nQmVoYXZpb3JSZXNvdXJjZS5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbiByZWdpc3RlcihyZWdpc3RyeSwgbmFtZSkge1xuICAgIHJlZ2lzdHJ5LnJlZ2lzdGVyQmluZGluZ0JlaGF2aW9yKG5hbWUgfHwgdGhpcy5uYW1lLCB0aGlzLmluc3RhbmNlKTtcbiAgfTtcblxuICBCaW5kaW5nQmVoYXZpb3JSZXNvdXJjZS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIGxvYWQoY29udGFpbmVyLCB0YXJnZXQpIHt9O1xuXG4gIHJldHVybiBCaW5kaW5nQmVoYXZpb3JSZXNvdXJjZTtcbn0oKTtcblxuZnVuY3Rpb24gYmluZGluZ0JlaGF2aW9yKG5hbWVPclRhcmdldCkge1xuICBpZiAobmFtZU9yVGFyZ2V0ID09PSB1bmRlZmluZWQgfHwgdHlwZW9mIG5hbWVPclRhcmdldCA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgICAgX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5kZWZpbmUoX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5yZXNvdXJjZSwgbmV3IEJpbmRpbmdCZWhhdmlvclJlc291cmNlKG5hbWVPclRhcmdldCksIHRhcmdldCk7XG4gICAgfTtcbiAgfVxuXG4gIF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEuZGVmaW5lKF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEucmVzb3VyY2UsIG5ldyBCaW5kaW5nQmVoYXZpb3JSZXNvdXJjZSgpLCBuYW1lT3JUYXJnZXQpO1xufVxuXG52YXIgTGlzdGVuZXJFeHByZXNzaW9uID0gZXhwb3J0cy5MaXN0ZW5lckV4cHJlc3Npb24gPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIExpc3RlbmVyRXhwcmVzc2lvbihldmVudE1hbmFnZXIsIHRhcmdldEV2ZW50LCBzb3VyY2VFeHByZXNzaW9uLCBkZWxlZ2F0ZSwgcHJldmVudERlZmF1bHQsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIFxuXG4gICAgdGhpcy5ldmVudE1hbmFnZXIgPSBldmVudE1hbmFnZXI7XG4gICAgdGhpcy50YXJnZXRFdmVudCA9IHRhcmdldEV2ZW50O1xuICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbiA9IHNvdXJjZUV4cHJlc3Npb247XG4gICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgIHRoaXMuZGlzY3JldGUgPSB0cnVlO1xuICAgIHRoaXMucHJldmVudERlZmF1bHQgPSBwcmV2ZW50RGVmYXVsdDtcbiAgICB0aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IGxvb2t1cEZ1bmN0aW9ucztcbiAgfVxuXG4gIExpc3RlbmVyRXhwcmVzc2lvbi5wcm90b3R5cGUuY3JlYXRlQmluZGluZyA9IGZ1bmN0aW9uIGNyZWF0ZUJpbmRpbmcodGFyZ2V0KSB7XG4gICAgcmV0dXJuIG5ldyBMaXN0ZW5lcih0aGlzLmV2ZW50TWFuYWdlciwgdGhpcy50YXJnZXRFdmVudCwgdGhpcy5kZWxlZ2F0ZSwgdGhpcy5zb3VyY2VFeHByZXNzaW9uLCB0YXJnZXQsIHRoaXMucHJldmVudERlZmF1bHQsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgfTtcblxuICByZXR1cm4gTGlzdGVuZXJFeHByZXNzaW9uO1xufSgpO1xuXG52YXIgTGlzdGVuZXIgPSBleHBvcnRzLkxpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBMaXN0ZW5lcihldmVudE1hbmFnZXIsIHRhcmdldEV2ZW50LCBkZWxlZ2F0ZSwgc291cmNlRXhwcmVzc2lvbiwgdGFyZ2V0LCBwcmV2ZW50RGVmYXVsdCwgbG9va3VwRnVuY3Rpb25zKSB7XG4gICAgXG5cbiAgICB0aGlzLmV2ZW50TWFuYWdlciA9IGV2ZW50TWFuYWdlcjtcbiAgICB0aGlzLnRhcmdldEV2ZW50ID0gdGFyZ2V0RXZlbnQ7XG4gICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xuICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbiA9IHNvdXJjZUV4cHJlc3Npb247XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy5wcmV2ZW50RGVmYXVsdCA9IHByZXZlbnREZWZhdWx0O1xuICAgIHRoaXMubG9va3VwRnVuY3Rpb25zID0gbG9va3VwRnVuY3Rpb25zO1xuICB9XG5cbiAgTGlzdGVuZXIucHJvdG90eXBlLmNhbGxTb3VyY2UgPSBmdW5jdGlvbiBjYWxsU291cmNlKGV2ZW50KSB7XG4gICAgdmFyIG92ZXJyaWRlQ29udGV4dCA9IHRoaXMuc291cmNlLm92ZXJyaWRlQ29udGV4dDtcbiAgICBvdmVycmlkZUNvbnRleHQuJGV2ZW50ID0gZXZlbnQ7XG4gICAgdmFyIG11c3RFdmFsdWF0ZSA9IHRydWU7XG4gICAgdmFyIHJlc3VsdCA9IHRoaXMuc291cmNlRXhwcmVzc2lvbi5ldmFsdWF0ZSh0aGlzLnNvdXJjZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMsIG11c3RFdmFsdWF0ZSk7XG4gICAgZGVsZXRlIG92ZXJyaWRlQ29udGV4dC4kZXZlbnQ7XG4gICAgaWYgKHJlc3VsdCAhPT0gdHJ1ZSAmJiB0aGlzLnByZXZlbnREZWZhdWx0KSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIExpc3RlbmVyLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gYmluZChzb3VyY2UpIHtcbiAgICB2YXIgX3RoaXMyOCA9IHRoaXM7XG5cbiAgICBpZiAodGhpcy5pc0JvdW5kKSB7XG4gICAgICBpZiAodGhpcy5zb3VyY2UgPT09IHNvdXJjZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLnVuYmluZCgpO1xuICAgIH1cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXG4gICAgaWYgKHRoaXMuc291cmNlRXhwcmVzc2lvbi5iaW5kKSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24uYmluZCh0aGlzLCBzb3VyY2UsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICB9XG4gICAgdGhpcy5fZGlzcG9zZUxpc3RlbmVyID0gdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLnRhcmdldCwgdGhpcy50YXJnZXRFdmVudCwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICByZXR1cm4gX3RoaXMyOC5jYWxsU291cmNlKGV2ZW50KTtcbiAgICB9LCB0aGlzLmRlbGVnYXRlKTtcbiAgfTtcblxuICBMaXN0ZW5lci5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gdW5iaW5kKCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgIGlmICh0aGlzLnNvdXJjZUV4cHJlc3Npb24udW5iaW5kKSB7XG4gICAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24udW5iaW5kKHRoaXMsIHRoaXMuc291cmNlKTtcbiAgICB9XG4gICAgdGhpcy5zb3VyY2UgPSBudWxsO1xuICAgIHRoaXMuX2Rpc3Bvc2VMaXN0ZW5lcigpO1xuICAgIHRoaXMuX2Rpc3Bvc2VMaXN0ZW5lciA9IG51bGw7XG4gIH07XG5cbiAgcmV0dXJuIExpc3RlbmVyO1xufSgpO1xuXG5mdW5jdGlvbiBnZXRBVShlbGVtZW50KSB7XG4gIHZhciBhdSA9IGVsZW1lbnQuYXU7XG5cbiAgaWYgKGF1ID09PSB1bmRlZmluZWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIEF1cmVsaWEgQVBJcyBhcmUgZGVmaW5lZCBmb3IgdGhlIHJlZmVyZW5jZWQgZWxlbWVudC4nKTtcbiAgfVxuXG4gIHJldHVybiBhdTtcbn1cblxudmFyIE5hbWVFeHByZXNzaW9uID0gZXhwb3J0cy5OYW1lRXhwcmVzc2lvbiA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gTmFtZUV4cHJlc3Npb24oc291cmNlRXhwcmVzc2lvbiwgYXBpTmFtZSwgbG9va3VwRnVuY3Rpb25zKSB7XG4gICAgXG5cbiAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24gPSBzb3VyY2VFeHByZXNzaW9uO1xuICAgIHRoaXMuYXBpTmFtZSA9IGFwaU5hbWU7XG4gICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSBsb29rdXBGdW5jdGlvbnM7XG4gICAgdGhpcy5kaXNjcmV0ZSA9IHRydWU7XG4gIH1cblxuICBOYW1lRXhwcmVzc2lvbi5wcm90b3R5cGUuY3JlYXRlQmluZGluZyA9IGZ1bmN0aW9uIGNyZWF0ZUJpbmRpbmcodGFyZ2V0KSB7XG4gICAgcmV0dXJuIG5ldyBOYW1lQmluZGVyKHRoaXMuc291cmNlRXhwcmVzc2lvbiwgTmFtZUV4cHJlc3Npb24ubG9jYXRlQVBJKHRhcmdldCwgdGhpcy5hcGlOYW1lKSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICB9O1xuXG4gIE5hbWVFeHByZXNzaW9uLmxvY2F0ZUFQSSA9IGZ1bmN0aW9uIGxvY2F0ZUFQSShlbGVtZW50LCBhcGlOYW1lKSB7XG4gICAgc3dpdGNoIChhcGlOYW1lKSB7XG4gICAgICBjYXNlICdlbGVtZW50JzpcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgICBjYXNlICdjb250cm9sbGVyJzpcbiAgICAgICAgcmV0dXJuIGdldEFVKGVsZW1lbnQpLmNvbnRyb2xsZXI7XG4gICAgICBjYXNlICd2aWV3LW1vZGVsJzpcbiAgICAgICAgcmV0dXJuIGdldEFVKGVsZW1lbnQpLmNvbnRyb2xsZXIudmlld01vZGVsO1xuICAgICAgY2FzZSAndmlldyc6XG4gICAgICAgIHJldHVybiBnZXRBVShlbGVtZW50KS5jb250cm9sbGVyLnZpZXc7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB2YXIgdGFyZ2V0ID0gZ2V0QVUoZWxlbWVudClbYXBpTmFtZV07XG5cbiAgICAgICAgaWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBdHRlbXB0ZWQgdG8gcmVmZXJlbmNlIFwiJyArIGFwaU5hbWUgKyAnXCIsIGJ1dCBpdCB3YXMgbm90IGZvdW5kIGFtb25nc3QgdGhlIHRhcmdldFxcJ3MgQVBJLicpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldC52aWV3TW9kZWw7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBOYW1lRXhwcmVzc2lvbjtcbn0oKTtcblxudmFyIE5hbWVCaW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIE5hbWVCaW5kZXIoc291cmNlRXhwcmVzc2lvbiwgdGFyZ2V0LCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICBcblxuICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbiA9IHNvdXJjZUV4cHJlc3Npb247XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSBsb29rdXBGdW5jdGlvbnM7XG4gIH1cblxuICBOYW1lQmluZGVyLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gYmluZChzb3VyY2UpIHtcbiAgICBpZiAodGhpcy5pc0JvdW5kKSB7XG4gICAgICBpZiAodGhpcy5zb3VyY2UgPT09IHNvdXJjZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLnVuYmluZCgpO1xuICAgIH1cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgIGlmICh0aGlzLnNvdXJjZUV4cHJlc3Npb24uYmluZCkge1xuICAgICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLmJpbmQodGhpcywgc291cmNlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgfVxuICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbi5hc3NpZ24odGhpcy5zb3VyY2UsIHRoaXMudGFyZ2V0LCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gIH07XG5cbiAgTmFtZUJpbmRlci5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gdW5iaW5kKCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbi5hc3NpZ24odGhpcy5zb3VyY2UsIG51bGwsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICBpZiAodGhpcy5zb3VyY2VFeHByZXNzaW9uLnVuYmluZCkge1xuICAgICAgdGhpcy5zb3VyY2VFeHByZXNzaW9uLnVuYmluZCh0aGlzLCB0aGlzLnNvdXJjZSk7XG4gICAgfVxuICAgIHRoaXMuc291cmNlID0gbnVsbDtcbiAgfTtcblxuICByZXR1cm4gTmFtZUJpbmRlcjtcbn0oKTtcblxudmFyIExvb2t1cEZ1bmN0aW9ucyA9IHtcbiAgYmluZGluZ0JlaGF2aW9yczogZnVuY3Rpb24gYmluZGluZ0JlaGF2aW9ycyhuYW1lKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH0sXG4gIHZhbHVlQ29udmVydGVyczogZnVuY3Rpb24gdmFsdWVDb252ZXJ0ZXJzKG5hbWUpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufTtcblxudmFyIEJpbmRpbmdFbmdpbmUgPSBleHBvcnRzLkJpbmRpbmdFbmdpbmUgPSAoX3RlbXAyID0gX2NsYXNzMTMgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEJpbmRpbmdFbmdpbmUob2JzZXJ2ZXJMb2NhdG9yLCBwYXJzZXIpIHtcbiAgICBcblxuICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xuICAgIHRoaXMucGFyc2VyID0gcGFyc2VyO1xuICB9XG5cbiAgQmluZGluZ0VuZ2luZS5wcm90b3R5cGUuY3JlYXRlQmluZGluZ0V4cHJlc3Npb24gPSBmdW5jdGlvbiBjcmVhdGVCaW5kaW5nRXhwcmVzc2lvbih0YXJnZXRQcm9wZXJ0eSwgc291cmNlRXhwcmVzc2lvbikge1xuICAgIHZhciBtb2RlID0gYXJndW1lbnRzLmxlbmd0aCA8PSAyIHx8IGFyZ3VtZW50c1syXSA9PT0gdW5kZWZpbmVkID8gYmluZGluZ01vZGUub25lV2F5IDogYXJndW1lbnRzWzJdO1xuICAgIHZhciBsb29rdXBGdW5jdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDMgfHwgYXJndW1lbnRzWzNdID09PSB1bmRlZmluZWQgPyBMb29rdXBGdW5jdGlvbnMgOiBhcmd1bWVudHNbM107XG5cbiAgICByZXR1cm4gbmV3IEJpbmRpbmdFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0YXJnZXRQcm9wZXJ0eSwgdGhpcy5wYXJzZXIucGFyc2Uoc291cmNlRXhwcmVzc2lvbiksIG1vZGUsIGxvb2t1cEZ1bmN0aW9ucyk7XG4gIH07XG5cbiAgQmluZGluZ0VuZ2luZS5wcm90b3R5cGUucHJvcGVydHlPYnNlcnZlciA9IGZ1bmN0aW9uIHByb3BlcnR5T2JzZXJ2ZXIob2JqLCBwcm9wZXJ0eU5hbWUpIHtcbiAgICB2YXIgX3RoaXMyOSA9IHRoaXM7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3Vic2NyaWJlOiBmdW5jdGlvbiBzdWJzY3JpYmUoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIG9ic2VydmVyID0gX3RoaXMyOS5vYnNlcnZlckxvY2F0b3IuZ2V0T2JzZXJ2ZXIob2JqLCBwcm9wZXJ0eU5hbWUpO1xuICAgICAgICBvYnNlcnZlci5zdWJzY3JpYmUoY2FsbGJhY2spO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGRpc3Bvc2U6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JzZXJ2ZXIudW5zdWJzY3JpYmUoY2FsbGJhY2spO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuXG4gIEJpbmRpbmdFbmdpbmUucHJvdG90eXBlLmNvbGxlY3Rpb25PYnNlcnZlciA9IGZ1bmN0aW9uIGNvbGxlY3Rpb25PYnNlcnZlcihjb2xsZWN0aW9uKSB7XG4gICAgdmFyIF90aGlzMzAgPSB0aGlzO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1YnNjcmliZTogZnVuY3Rpb24gc3Vic2NyaWJlKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBvYnNlcnZlciA9IHZvaWQgMDtcbiAgICAgICAgaWYgKGNvbGxlY3Rpb24gaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgIG9ic2VydmVyID0gX3RoaXMzMC5vYnNlcnZlckxvY2F0b3IuZ2V0QXJyYXlPYnNlcnZlcihjb2xsZWN0aW9uKTtcbiAgICAgICAgfSBlbHNlIGlmIChjb2xsZWN0aW9uIGluc3RhbmNlb2YgTWFwKSB7XG4gICAgICAgICAgb2JzZXJ2ZXIgPSBfdGhpczMwLm9ic2VydmVyTG9jYXRvci5nZXRNYXBPYnNlcnZlcihjb2xsZWN0aW9uKTtcbiAgICAgICAgfSBlbHNlIGlmIChjb2xsZWN0aW9uIGluc3RhbmNlb2YgU2V0KSB7XG4gICAgICAgICAgb2JzZXJ2ZXIgPSBfdGhpczMwLm9ic2VydmVyTG9jYXRvci5nZXRTZXRPYnNlcnZlcihjb2xsZWN0aW9uKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvbGxlY3Rpb24gbXVzdCBiZSBhbiBpbnN0YW5jZSBvZiBBcnJheSwgTWFwIG9yIFNldC4nKTtcbiAgICAgICAgfVxuICAgICAgICBvYnNlcnZlci5zdWJzY3JpYmUoY2FsbGJhY2spO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGRpc3Bvc2U6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JzZXJ2ZXIudW5zdWJzY3JpYmUoY2FsbGJhY2spO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuXG4gIEJpbmRpbmdFbmdpbmUucHJvdG90eXBlLmV4cHJlc3Npb25PYnNlcnZlciA9IGZ1bmN0aW9uIGV4cHJlc3Npb25PYnNlcnZlcihiaW5kaW5nQ29udGV4dCwgZXhwcmVzc2lvbikge1xuICAgIHZhciBzY29wZSA9IHsgYmluZGluZ0NvbnRleHQ6IGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQ6IGNyZWF0ZU92ZXJyaWRlQ29udGV4dChiaW5kaW5nQ29udGV4dCkgfTtcbiAgICByZXR1cm4gbmV3IEV4cHJlc3Npb25PYnNlcnZlcihzY29wZSwgdGhpcy5wYXJzZXIucGFyc2UoZXhwcmVzc2lvbiksIHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBMb29rdXBGdW5jdGlvbnMpO1xuICB9O1xuXG4gIEJpbmRpbmdFbmdpbmUucHJvdG90eXBlLnBhcnNlRXhwcmVzc2lvbiA9IGZ1bmN0aW9uIHBhcnNlRXhwcmVzc2lvbihleHByZXNzaW9uKSB7XG4gICAgcmV0dXJuIHRoaXMucGFyc2VyLnBhcnNlKGV4cHJlc3Npb24pO1xuICB9O1xuXG4gIEJpbmRpbmdFbmdpbmUucHJvdG90eXBlLnJlZ2lzdGVyQWRhcHRlciA9IGZ1bmN0aW9uIHJlZ2lzdGVyQWRhcHRlcihhZGFwdGVyKSB7XG4gICAgdGhpcy5vYnNlcnZlckxvY2F0b3IuYWRkQWRhcHRlcihhZGFwdGVyKTtcbiAgfTtcblxuICByZXR1cm4gQmluZGluZ0VuZ2luZTtcbn0oKSwgX2NsYXNzMTMuaW5qZWN0ID0gW09ic2VydmVyTG9jYXRvciwgUGFyc2VyXSwgX3RlbXAyKTtcblxuXG52YXIgc2V0UHJvdG8gPSBTZXQucHJvdG90eXBlO1xuXG5mdW5jdGlvbiBfZ2V0U2V0T2JzZXJ2ZXIodGFza1F1ZXVlLCBzZXQpIHtcbiAgcmV0dXJuIE1vZGlmeVNldE9ic2VydmVyLmZvcih0YXNrUXVldWUsIHNldCk7XG59XG5cbmV4cG9ydHMuZ2V0U2V0T2JzZXJ2ZXIgPSBfZ2V0U2V0T2JzZXJ2ZXI7XG5cbnZhciBNb2RpZnlTZXRPYnNlcnZlciA9IGZ1bmN0aW9uIChfTW9kaWZ5Q29sbGVjdGlvbk9ic2UzKSB7XG4gIF9pbmhlcml0cyhNb2RpZnlTZXRPYnNlcnZlciwgX01vZGlmeUNvbGxlY3Rpb25PYnNlMyk7XG5cbiAgZnVuY3Rpb24gTW9kaWZ5U2V0T2JzZXJ2ZXIodGFza1F1ZXVlLCBzZXQpIHtcbiAgICBcblxuICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfTW9kaWZ5Q29sbGVjdGlvbk9ic2UzLmNhbGwodGhpcywgdGFza1F1ZXVlLCBzZXQpKTtcbiAgfVxuXG4gIE1vZGlmeVNldE9ic2VydmVyLmZvciA9IGZ1bmN0aW9uIF9mb3IodGFza1F1ZXVlLCBzZXQpIHtcbiAgICBpZiAoISgnX19zZXRfb2JzZXJ2ZXJfXycgaW4gc2V0KSkge1xuICAgICAgdmFyIG9ic2VydmVyID0gTW9kaWZ5U2V0T2JzZXJ2ZXIuY3JlYXRlKHRhc2tRdWV1ZSwgc2V0KTtcbiAgICAgIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkoc2V0LCAnX19zZXRfb2JzZXJ2ZXJfXycsIHsgdmFsdWU6IG9ic2VydmVyLCBlbnVtZXJhYmxlOiBmYWxzZSwgY29uZmlndXJhYmxlOiBmYWxzZSB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHNldC5fX3NldF9vYnNlcnZlcl9fO1xuICB9O1xuXG4gIE1vZGlmeVNldE9ic2VydmVyLmNyZWF0ZSA9IGZ1bmN0aW9uIGNyZWF0ZSh0YXNrUXVldWUsIHNldCkge1xuICAgIHZhciBvYnNlcnZlciA9IG5ldyBNb2RpZnlTZXRPYnNlcnZlcih0YXNrUXVldWUsIHNldCk7XG5cbiAgICB2YXIgcHJvdG8gPSBzZXRQcm90bztcbiAgICBpZiAocHJvdG8uYWRkICE9PSBzZXQuYWRkIHx8IHByb3RvLmRlbGV0ZSAhPT0gc2V0LmRlbGV0ZSB8fCBwcm90by5jbGVhciAhPT0gc2V0LmNsZWFyKSB7XG4gICAgICBwcm90byA9IHtcbiAgICAgICAgYWRkOiBzZXQuYWRkLFxuICAgICAgICBkZWxldGU6IHNldC5kZWxldGUsXG4gICAgICAgIGNsZWFyOiBzZXQuY2xlYXJcbiAgICAgIH07XG4gICAgfVxuXG4gICAgc2V0LmFkZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0eXBlID0gJ2FkZCc7XG4gICAgICB2YXIgb2xkU2l6ZSA9IHNldC5zaXplO1xuICAgICAgdmFyIG1ldGhvZENhbGxSZXN1bHQgPSBwcm90by5hZGQuYXBwbHkoc2V0LCBhcmd1bWVudHMpO1xuICAgICAgdmFyIGhhc1ZhbHVlID0gc2V0LnNpemUgPT09IG9sZFNpemU7XG4gICAgICBpZiAoIWhhc1ZhbHVlKSB7XG4gICAgICAgIG9ic2VydmVyLmFkZENoYW5nZVJlY29yZCh7XG4gICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICBvYmplY3Q6IHNldCxcbiAgICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbShzZXQpLnBvcCgpXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1ldGhvZENhbGxSZXN1bHQ7XG4gICAgfTtcblxuICAgIHNldC5kZWxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgaGFzVmFsdWUgPSBzZXQuaGFzKGFyZ3VtZW50c1swXSk7XG4gICAgICB2YXIgbWV0aG9kQ2FsbFJlc3VsdCA9IHByb3RvLmRlbGV0ZS5hcHBseShzZXQsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAoaGFzVmFsdWUpIHtcbiAgICAgICAgb2JzZXJ2ZXIuYWRkQ2hhbmdlUmVjb3JkKHtcbiAgICAgICAgICB0eXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICBvYmplY3Q6IHNldCxcbiAgICAgICAgICB2YWx1ZTogYXJndW1lbnRzWzBdXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1ldGhvZENhbGxSZXN1bHQ7XG4gICAgfTtcblxuICAgIHNldC5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBtZXRob2RDYWxsUmVzdWx0ID0gcHJvdG8uY2xlYXIuYXBwbHkoc2V0LCBhcmd1bWVudHMpO1xuICAgICAgb2JzZXJ2ZXIuYWRkQ2hhbmdlUmVjb3JkKHtcbiAgICAgICAgdHlwZTogJ2NsZWFyJyxcbiAgICAgICAgb2JqZWN0OiBzZXRcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG1ldGhvZENhbGxSZXN1bHQ7XG4gICAgfTtcblxuICAgIHJldHVybiBvYnNlcnZlcjtcbiAgfTtcblxuICByZXR1cm4gTW9kaWZ5U2V0T2JzZXJ2ZXI7XG59KE1vZGlmeUNvbGxlY3Rpb25PYnNlcnZlcik7XG5cbmZ1bmN0aW9uIG9ic2VydmFibGUodGFyZ2V0T3JDb25maWcsIGtleSwgZGVzY3JpcHRvcikge1xuICB2YXIgZGVjbyA9IGZ1bmN0aW9uIGRlY28odGFyZ2V0LCBrZXkyLCBkZXNjcmlwdG9yMikge1xuICAgIHZhciBpbm5lclByb3BlcnR5TmFtZSA9ICdfJyArIGtleTI7XG4gICAgdmFyIGNhbGxiYWNrTmFtZSA9IHRhcmdldE9yQ29uZmlnICYmIHRhcmdldE9yQ29uZmlnLmNoYW5nZUhhbmRsZXIgfHwga2V5MiArICdDaGFuZ2VkJztcblxuICAgIHZhciBiYWJlbCA9IGRlc2NyaXB0b3IyICE9PSB1bmRlZmluZWQ7XG5cbiAgICBpZiAoYmFiZWwpIHtcbiAgICAgIGlmICh0eXBlb2YgZGVzY3JpcHRvcjIuaW5pdGlhbGl6ZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGFyZ2V0W2lubmVyUHJvcGVydHlOYW1lXSA9IGRlc2NyaXB0b3IyLmluaXRpYWxpemVyKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGRlc2NyaXB0b3IyID0ge307XG4gICAgfVxuXG4gICAgZGVsZXRlIGRlc2NyaXB0b3IyLndyaXRhYmxlO1xuICAgIGRlbGV0ZSBkZXNjcmlwdG9yMi5pbml0aWFsaXplcjtcblxuICAgIGRlc2NyaXB0b3IyLmdldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzW2lubmVyUHJvcGVydHlOYW1lXTtcbiAgICB9O1xuICAgIGRlc2NyaXB0b3IyLnNldCA9IGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xuICAgICAgdmFyIG9sZFZhbHVlID0gdGhpc1tpbm5lclByb3BlcnR5TmFtZV07XG4gICAgICB0aGlzW2lubmVyUHJvcGVydHlOYW1lXSA9IG5ld1ZhbHVlO1xuICAgICAgaWYgKHRoaXNbY2FsbGJhY2tOYW1lXSkge1xuICAgICAgICB0aGlzW2NhbGxiYWNrTmFtZV0obmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZGVzY3JpcHRvcjIuZ2V0LmRlcGVuZGVuY2llcyA9IFtpbm5lclByb3BlcnR5TmFtZV07XG5cbiAgICBpZiAoIWJhYmVsKSB7XG4gICAgICBSZWZsZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5MiwgZGVzY3JpcHRvcjIpO1xuICAgIH1cbiAgfTtcblxuICBpZiAoa2V5KSB7XG4gICAgdmFyIHRhcmdldCA9IHRhcmdldE9yQ29uZmlnO1xuICAgIHRhcmdldE9yQ29uZmlnID0gbnVsbDtcbiAgICByZXR1cm4gZGVjbyh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcik7XG4gIH1cblxuICByZXR1cm4gZGVjbztcbn1cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLWJpbmRpbmcvZGlzdC9jb21tb25qcy9hdXJlbGlhLWJpbmRpbmcuanNcbiAqKiBtb2R1bGUgaWQgPSAyMFxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5UYXNrUXVldWUgPSB1bmRlZmluZWQ7XG5cbnZhciBfYXVyZWxpYVBhbCA9IHJlcXVpcmUoJ2F1cmVsaWEtcGFsJyk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBoYXNTZXRJbW1lZGlhdGUgPSB0eXBlb2Ygc2V0SW1tZWRpYXRlID09PSAnZnVuY3Rpb24nO1xuXG5mdW5jdGlvbiBtYWtlUmVxdWVzdEZsdXNoRnJvbU11dGF0aW9uT2JzZXJ2ZXIoZmx1c2gpIHtcbiAgdmFyIHRvZ2dsZSA9IDE7XG4gIHZhciBvYnNlcnZlciA9IF9hdXJlbGlhUGFsLkRPTS5jcmVhdGVNdXRhdGlvbk9ic2VydmVyKGZsdXNoKTtcbiAgdmFyIG5vZGUgPSBfYXVyZWxpYVBhbC5ET00uY3JlYXRlVGV4dE5vZGUoJycpO1xuICBvYnNlcnZlci5vYnNlcnZlKG5vZGUsIHsgY2hhcmFjdGVyRGF0YTogdHJ1ZSB9KTtcbiAgcmV0dXJuIGZ1bmN0aW9uIHJlcXVlc3RGbHVzaCgpIHtcbiAgICB0b2dnbGUgPSAtdG9nZ2xlO1xuICAgIG5vZGUuZGF0YSA9IHRvZ2dsZTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gbWFrZVJlcXVlc3RGbHVzaEZyb21UaW1lcihmbHVzaCkge1xuICByZXR1cm4gZnVuY3Rpb24gcmVxdWVzdEZsdXNoKCkge1xuICAgIHZhciB0aW1lb3V0SGFuZGxlID0gc2V0VGltZW91dChoYW5kbGVGbHVzaFRpbWVyLCAwKTtcblxuICAgIHZhciBpbnRlcnZhbEhhbmRsZSA9IHNldEludGVydmFsKGhhbmRsZUZsdXNoVGltZXIsIDUwKTtcbiAgICBmdW5jdGlvbiBoYW5kbGVGbHVzaFRpbWVyKCkge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRIYW5kbGUpO1xuICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbEhhbmRsZSk7XG4gICAgICBmbHVzaCgpO1xuICAgIH1cbiAgfTtcbn1cblxuZnVuY3Rpb24gb25FcnJvcihlcnJvciwgdGFzaykge1xuICBpZiAoJ29uRXJyb3InIGluIHRhc2spIHtcbiAgICB0YXNrLm9uRXJyb3IoZXJyb3IpO1xuICB9IGVsc2UgaWYgKGhhc1NldEltbWVkaWF0ZSkge1xuICAgIHNldEltbWVkaWF0ZShmdW5jdGlvbiAoKSB7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH0sIDApO1xuICB9XG59XG5cbnZhciBUYXNrUXVldWUgPSBleHBvcnRzLlRhc2tRdWV1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gVGFza1F1ZXVlKCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGFza1F1ZXVlKTtcblxuICAgIHRoaXMubWljcm9UYXNrUXVldWUgPSBbXTtcbiAgICB0aGlzLm1pY3JvVGFza1F1ZXVlQ2FwYWNpdHkgPSAxMDI0O1xuICAgIHRoaXMudGFza1F1ZXVlID0gW107XG5cbiAgICBpZiAoX2F1cmVsaWFQYWwuRkVBVFVSRS5tdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgICB0aGlzLnJlcXVlc3RGbHVzaE1pY3JvVGFza1F1ZXVlID0gbWFrZVJlcXVlc3RGbHVzaEZyb21NdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF90aGlzLmZsdXNoTWljcm9UYXNrUXVldWUoKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlcXVlc3RGbHVzaE1pY3JvVGFza1F1ZXVlID0gbWFrZVJlcXVlc3RGbHVzaEZyb21UaW1lcihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfdGhpcy5mbHVzaE1pY3JvVGFza1F1ZXVlKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLnJlcXVlc3RGbHVzaFRhc2tRdWV1ZSA9IG1ha2VSZXF1ZXN0Rmx1c2hGcm9tVGltZXIoZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIF90aGlzLmZsdXNoVGFza1F1ZXVlKCk7XG4gICAgfSk7XG4gIH1cblxuICBUYXNrUXVldWUucHJvdG90eXBlLnF1ZXVlTWljcm9UYXNrID0gZnVuY3Rpb24gcXVldWVNaWNyb1Rhc2sodGFzaykge1xuICAgIGlmICh0aGlzLm1pY3JvVGFza1F1ZXVlLmxlbmd0aCA8IDEpIHtcbiAgICAgIHRoaXMucmVxdWVzdEZsdXNoTWljcm9UYXNrUXVldWUoKTtcbiAgICB9XG5cbiAgICB0aGlzLm1pY3JvVGFza1F1ZXVlLnB1c2godGFzayk7XG4gIH07XG5cbiAgVGFza1F1ZXVlLnByb3RvdHlwZS5xdWV1ZVRhc2sgPSBmdW5jdGlvbiBxdWV1ZVRhc2sodGFzaykge1xuICAgIGlmICh0aGlzLnRhc2tRdWV1ZS5sZW5ndGggPCAxKSB7XG4gICAgICB0aGlzLnJlcXVlc3RGbHVzaFRhc2tRdWV1ZSgpO1xuICAgIH1cblxuICAgIHRoaXMudGFza1F1ZXVlLnB1c2godGFzayk7XG4gIH07XG5cbiAgVGFza1F1ZXVlLnByb3RvdHlwZS5mbHVzaFRhc2tRdWV1ZSA9IGZ1bmN0aW9uIGZsdXNoVGFza1F1ZXVlKCkge1xuICAgIHZhciBxdWV1ZSA9IHRoaXMudGFza1F1ZXVlO1xuICAgIHZhciBpbmRleCA9IDA7XG4gICAgdmFyIHRhc2sgPSB2b2lkIDA7XG5cbiAgICB0aGlzLnRhc2tRdWV1ZSA9IFtdO1xuXG4gICAgdHJ5IHtcbiAgICAgIHdoaWxlIChpbmRleCA8IHF1ZXVlLmxlbmd0aCkge1xuICAgICAgICB0YXNrID0gcXVldWVbaW5kZXhdO1xuICAgICAgICB0YXNrLmNhbGwoKTtcbiAgICAgICAgaW5kZXgrKztcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgb25FcnJvcihlcnJvciwgdGFzayk7XG4gICAgfVxuICB9O1xuXG4gIFRhc2tRdWV1ZS5wcm90b3R5cGUuZmx1c2hNaWNyb1Rhc2tRdWV1ZSA9IGZ1bmN0aW9uIGZsdXNoTWljcm9UYXNrUXVldWUoKSB7XG4gICAgdmFyIHF1ZXVlID0gdGhpcy5taWNyb1Rhc2tRdWV1ZTtcbiAgICB2YXIgY2FwYWNpdHkgPSB0aGlzLm1pY3JvVGFza1F1ZXVlQ2FwYWNpdHk7XG4gICAgdmFyIGluZGV4ID0gMDtcbiAgICB2YXIgdGFzayA9IHZvaWQgMDtcblxuICAgIHRyeSB7XG4gICAgICB3aGlsZSAoaW5kZXggPCBxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgdGFzayA9IHF1ZXVlW2luZGV4XTtcbiAgICAgICAgdGFzay5jYWxsKCk7XG4gICAgICAgIGluZGV4Kys7XG5cbiAgICAgICAgaWYgKGluZGV4ID4gY2FwYWNpdHkpIHtcbiAgICAgICAgICBmb3IgKHZhciBzY2FuID0gMCwgbmV3TGVuZ3RoID0gcXVldWUubGVuZ3RoIC0gaW5kZXg7IHNjYW4gPCBuZXdMZW5ndGg7IHNjYW4rKykge1xuICAgICAgICAgICAgcXVldWVbc2Nhbl0gPSBxdWV1ZVtzY2FuICsgaW5kZXhdO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHF1ZXVlLmxlbmd0aCAtPSBpbmRleDtcbiAgICAgICAgICBpbmRleCA9IDA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgb25FcnJvcihlcnJvciwgdGFzayk7XG4gICAgfVxuXG4gICAgcXVldWUubGVuZ3RoID0gMDtcbiAgfTtcblxuICByZXR1cm4gVGFza1F1ZXVlO1xufSgpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGFzay1xdWV1ZS9kaXN0L2NvbW1vbmpzL2F1cmVsaWEtdGFzay1xdWV1ZS5qc1xuICoqIG1vZHVsZSBpZCA9IDIxXG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCJ2YXIgbmV4dFRpY2sgPSByZXF1aXJlKCdwcm9jZXNzL2Jyb3dzZXIuanMnKS5uZXh0VGljaztcbnZhciBhcHBseSA9IEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseTtcbnZhciBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcbnZhciBpbW1lZGlhdGVJZHMgPSB7fTtcbnZhciBuZXh0SW1tZWRpYXRlSWQgPSAwO1xuXG4vLyBET00gQVBJcywgZm9yIGNvbXBsZXRlbmVzc1xuXG5leHBvcnRzLnNldFRpbWVvdXQgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIG5ldyBUaW1lb3V0KGFwcGx5LmNhbGwoc2V0VGltZW91dCwgd2luZG93LCBhcmd1bWVudHMpLCBjbGVhclRpbWVvdXQpO1xufTtcbmV4cG9ydHMuc2V0SW50ZXJ2YWwgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIG5ldyBUaW1lb3V0KGFwcGx5LmNhbGwoc2V0SW50ZXJ2YWwsIHdpbmRvdywgYXJndW1lbnRzKSwgY2xlYXJJbnRlcnZhbCk7XG59O1xuZXhwb3J0cy5jbGVhclRpbWVvdXQgPVxuZXhwb3J0cy5jbGVhckludGVydmFsID0gZnVuY3Rpb24odGltZW91dCkgeyB0aW1lb3V0LmNsb3NlKCk7IH07XG5cbmZ1bmN0aW9uIFRpbWVvdXQoaWQsIGNsZWFyRm4pIHtcbiAgdGhpcy5faWQgPSBpZDtcbiAgdGhpcy5fY2xlYXJGbiA9IGNsZWFyRm47XG59XG5UaW1lb3V0LnByb3RvdHlwZS51bnJlZiA9IFRpbWVvdXQucHJvdG90eXBlLnJlZiA9IGZ1bmN0aW9uKCkge307XG5UaW1lb3V0LnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLl9jbGVhckZuLmNhbGwod2luZG93LCB0aGlzLl9pZCk7XG59O1xuXG4vLyBEb2VzIG5vdCBzdGFydCB0aGUgdGltZSwganVzdCBzZXRzIHVwIHRoZSBtZW1iZXJzIG5lZWRlZC5cbmV4cG9ydHMuZW5yb2xsID0gZnVuY3Rpb24oaXRlbSwgbXNlY3MpIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuICBpdGVtLl9pZGxlVGltZW91dCA9IG1zZWNzO1xufTtcblxuZXhwb3J0cy51bmVucm9sbCA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuICBpdGVtLl9pZGxlVGltZW91dCA9IC0xO1xufTtcblxuZXhwb3J0cy5fdW5yZWZBY3RpdmUgPSBleHBvcnRzLmFjdGl2ZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuXG4gIHZhciBtc2VjcyA9IGl0ZW0uX2lkbGVUaW1lb3V0O1xuICBpZiAobXNlY3MgPj0gMCkge1xuICAgIGl0ZW0uX2lkbGVUaW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uIG9uVGltZW91dCgpIHtcbiAgICAgIGlmIChpdGVtLl9vblRpbWVvdXQpXG4gICAgICAgIGl0ZW0uX29uVGltZW91dCgpO1xuICAgIH0sIG1zZWNzKTtcbiAgfVxufTtcblxuLy8gVGhhdCdzIG5vdCBob3cgbm9kZS5qcyBpbXBsZW1lbnRzIGl0IGJ1dCB0aGUgZXhwb3NlZCBhcGkgaXMgdGhlIHNhbWUuXG5leHBvcnRzLnNldEltbWVkaWF0ZSA9IHR5cGVvZiBzZXRJbW1lZGlhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHNldEltbWVkaWF0ZSA6IGZ1bmN0aW9uKGZuKSB7XG4gIHZhciBpZCA9IG5leHRJbW1lZGlhdGVJZCsrO1xuICB2YXIgYXJncyA9IGFyZ3VtZW50cy5sZW5ndGggPCAyID8gZmFsc2UgOiBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG5cbiAgaW1tZWRpYXRlSWRzW2lkXSA9IHRydWU7XG5cbiAgbmV4dFRpY2soZnVuY3Rpb24gb25OZXh0VGljaygpIHtcbiAgICBpZiAoaW1tZWRpYXRlSWRzW2lkXSkge1xuICAgICAgLy8gZm4uY2FsbCgpIGlzIGZhc3RlciBzbyB3ZSBvcHRpbWl6ZSBmb3IgdGhlIGNvbW1vbiB1c2UtY2FzZVxuICAgICAgLy8gQHNlZSBodHRwOi8vanNwZXJmLmNvbS9jYWxsLWFwcGx5LXNlZ3VcbiAgICAgIGlmIChhcmdzKSB7XG4gICAgICAgIGZuLmFwcGx5KG51bGwsIGFyZ3MpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm4uY2FsbChudWxsKTtcbiAgICAgIH1cbiAgICAgIC8vIFByZXZlbnQgaWRzIGZyb20gbGVha2luZ1xuICAgICAgZXhwb3J0cy5jbGVhckltbWVkaWF0ZShpZCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gaWQ7XG59O1xuXG5leHBvcnRzLmNsZWFySW1tZWRpYXRlID0gdHlwZW9mIGNsZWFySW1tZWRpYXRlID09PSBcImZ1bmN0aW9uXCIgPyBjbGVhckltbWVkaWF0ZSA6IGZ1bmN0aW9uKGlkKSB7XG4gIGRlbGV0ZSBpbW1lZGlhdGVJZHNbaWRdO1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi90aW1lcnMtYnJvd3NlcmlmeS9tYWluLmpzXG4gKiogbW9kdWxlIGlkID0gMjJcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxuXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBpZiAoIWRyYWluaW5nIHx8ICFjdXJyZW50UXVldWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBzZXRUaW1lb3V0KGRyYWluUXVldWUsIDApO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vcHJvY2Vzcy9icm93c2VyLmpzXG4gKiogbW9kdWxlIGlkID0gMjNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuVGVtcGxhdGluZ0VuZ2luZSA9IGV4cG9ydHMuRWxlbWVudENvbmZpZ1Jlc291cmNlID0gZXhwb3J0cy5Db21wb3NpdGlvbkVuZ2luZSA9IGV4cG9ydHMuSHRtbEJlaGF2aW9yUmVzb3VyY2UgPSBleHBvcnRzLkJpbmRhYmxlUHJvcGVydHkgPSBleHBvcnRzLkJlaGF2aW9yUHJvcGVydHlPYnNlcnZlciA9IGV4cG9ydHMuQ29udHJvbGxlciA9IGV4cG9ydHMuVmlld0VuZ2luZSA9IGV4cG9ydHMuTW9kdWxlQW5hbHl6ZXIgPSBleHBvcnRzLlJlc291cmNlRGVzY3JpcHRpb24gPSBleHBvcnRzLlJlc291cmNlTW9kdWxlID0gZXhwb3J0cy5WaWV3Q29tcGlsZXIgPSBleHBvcnRzLlZpZXdGYWN0b3J5ID0gZXhwb3J0cy5Cb3VuZFZpZXdGYWN0b3J5ID0gZXhwb3J0cy5WaWV3U2xvdCA9IGV4cG9ydHMuX0NvbnRlbnRTZWxlY3RvciA9IGV4cG9ydHMuVmlldyA9IGV4cG9ydHMuVmlld1Jlc291cmNlcyA9IGV4cG9ydHMuQmluZGluZ0xhbmd1YWdlID0gZXhwb3J0cy5WaWV3TG9jYXRvciA9IGV4cG9ydHMuSW5saW5lVmlld1N0cmF0ZWd5ID0gZXhwb3J0cy5UZW1wbGF0ZVJlZ2lzdHJ5Vmlld1N0cmF0ZWd5ID0gZXhwb3J0cy5Ob1ZpZXdTdHJhdGVneSA9IGV4cG9ydHMuQ29udmVudGlvbmFsVmlld1N0cmF0ZWd5ID0gZXhwb3J0cy5SZWxhdGl2ZVZpZXdTdHJhdGVneSA9IGV4cG9ydHMudmlld1N0cmF0ZWd5ID0gZXhwb3J0cy5UYXJnZXRJbnN0cnVjdGlvbiA9IGV4cG9ydHMuQmVoYXZpb3JJbnN0cnVjdGlvbiA9IGV4cG9ydHMuVmlld0NvbXBpbGVJbnN0cnVjdGlvbiA9IGV4cG9ydHMuUmVzb3VyY2VMb2FkQ29udGV4dCA9IGV4cG9ydHMuRWxlbWVudEV2ZW50cyA9IGV4cG9ydHMuQ29tcG9zaXRpb25UcmFuc2FjdGlvbiA9IGV4cG9ydHMuQW5pbWF0b3IgPSBleHBvcnRzLmFuaW1hdGlvbkV2ZW50ID0gdW5kZWZpbmVkO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2NsYXNzMywgX3RlbXAsIF9kZWMsIF9jbGFzczQsIF9kZWMyLCBfY2xhc3M1LCBfZGVjMywgX2NsYXNzNiwgX2RlYzQsIF9jbGFzczcsIF9kZWM1LCBfY2xhc3M4LCBfY2xhc3M5LCBfdGVtcDIsIF9jbGFzczExLCBfZGVjNiwgX2NsYXNzMTMsIF9kZWM3LCBfY2xhc3MxNCwgX2RlYzgsIF9jbGFzczE2LCBfZGVjOSwgX2NsYXNzMTcsIF9kZWMxMCwgX2NsYXNzMTg7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG5leHBvcnRzLl9oeXBoZW5hdGUgPSBfaHlwaGVuYXRlO1xuZXhwb3J0cy5jaGlsZHJlbiA9IGNoaWxkcmVuO1xuZXhwb3J0cy5jaGlsZCA9IGNoaWxkO1xuZXhwb3J0cy5yZXNvdXJjZSA9IHJlc291cmNlO1xuZXhwb3J0cy5iZWhhdmlvciA9IGJlaGF2aW9yO1xuZXhwb3J0cy5jdXN0b21FbGVtZW50ID0gY3VzdG9tRWxlbWVudDtcbmV4cG9ydHMuY3VzdG9tQXR0cmlidXRlID0gY3VzdG9tQXR0cmlidXRlO1xuZXhwb3J0cy50ZW1wbGF0ZUNvbnRyb2xsZXIgPSB0ZW1wbGF0ZUNvbnRyb2xsZXI7XG5leHBvcnRzLmJpbmRhYmxlID0gYmluZGFibGU7XG5leHBvcnRzLmR5bmFtaWNPcHRpb25zID0gZHluYW1pY09wdGlvbnM7XG5leHBvcnRzLnVzZVNoYWRvd0RPTSA9IHVzZVNoYWRvd0RPTTtcbmV4cG9ydHMucHJvY2Vzc0F0dHJpYnV0ZXMgPSBwcm9jZXNzQXR0cmlidXRlcztcbmV4cG9ydHMucHJvY2Vzc0NvbnRlbnQgPSBwcm9jZXNzQ29udGVudDtcbmV4cG9ydHMuY29udGFpbmVybGVzcyA9IGNvbnRhaW5lcmxlc3M7XG5leHBvcnRzLnVzZVZpZXdTdHJhdGVneSA9IHVzZVZpZXdTdHJhdGVneTtcbmV4cG9ydHMudXNlVmlldyA9IHVzZVZpZXc7XG5leHBvcnRzLmlubGluZVZpZXcgPSBpbmxpbmVWaWV3O1xuZXhwb3J0cy5ub1ZpZXcgPSBub1ZpZXc7XG5leHBvcnRzLmVsZW1lbnRDb25maWcgPSBlbGVtZW50Q29uZmlnO1xuXG52YXIgX2F1cmVsaWFMb2dnaW5nID0gcmVxdWlyZSgnYXVyZWxpYS1sb2dnaW5nJyk7XG5cbnZhciBMb2dNYW5hZ2VyID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX2F1cmVsaWFMb2dnaW5nKTtcblxudmFyIF9hdXJlbGlhUGFsID0gcmVxdWlyZSgnYXVyZWxpYS1wYWwnKTtcblxudmFyIF9hdXJlbGlhTWV0YWRhdGEgPSByZXF1aXJlKCdhdXJlbGlhLW1ldGFkYXRhJyk7XG5cbnZhciBfYXVyZWxpYVBhdGggPSByZXF1aXJlKCdhdXJlbGlhLXBhdGgnKTtcblxudmFyIF9hdXJlbGlhTG9hZGVyID0gcmVxdWlyZSgnYXVyZWxpYS1sb2FkZXInKTtcblxudmFyIF9hdXJlbGlhQmluZGluZyA9IHJlcXVpcmUoJ2F1cmVsaWEtYmluZGluZycpO1xuXG52YXIgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uID0gcmVxdWlyZSgnYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbicpO1xuXG52YXIgX2F1cmVsaWFUYXNrUXVldWUgPSByZXF1aXJlKCdhdXJlbGlhLXRhc2stcXVldWUnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09iai5kZWZhdWx0ID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIGFuaW1hdGlvbkV2ZW50ID0gZXhwb3J0cy5hbmltYXRpb25FdmVudCA9IHtcbiAgZW50ZXJCZWdpbjogJ2FuaW1hdGlvbjplbnRlcjpiZWdpbicsXG4gIGVudGVyQWN0aXZlOiAnYW5pbWF0aW9uOmVudGVyOmFjdGl2ZScsXG4gIGVudGVyRG9uZTogJ2FuaW1hdGlvbjplbnRlcjpkb25lJyxcbiAgZW50ZXJUaW1lb3V0OiAnYW5pbWF0aW9uOmVudGVyOnRpbWVvdXQnLFxuXG4gIGxlYXZlQmVnaW46ICdhbmltYXRpb246bGVhdmU6YmVnaW4nLFxuICBsZWF2ZUFjdGl2ZTogJ2FuaW1hdGlvbjpsZWF2ZTphY3RpdmUnLFxuICBsZWF2ZURvbmU6ICdhbmltYXRpb246bGVhdmU6ZG9uZScsXG4gIGxlYXZlVGltZW91dDogJ2FuaW1hdGlvbjpsZWF2ZTp0aW1lb3V0JyxcblxuICBzdGFnZ2VyTmV4dDogJ2FuaW1hdGlvbjpzdGFnZ2VyOm5leHQnLFxuXG4gIHJlbW92ZUNsYXNzQmVnaW46ICdhbmltYXRpb246cmVtb3ZlLWNsYXNzOmJlZ2luJyxcbiAgcmVtb3ZlQ2xhc3NBY3RpdmU6ICdhbmltYXRpb246cmVtb3ZlLWNsYXNzOmFjdGl2ZScsXG4gIHJlbW92ZUNsYXNzRG9uZTogJ2FuaW1hdGlvbjpyZW1vdmUtY2xhc3M6ZG9uZScsXG4gIHJlbW92ZUNsYXNzVGltZW91dDogJ2FuaW1hdGlvbjpyZW1vdmUtY2xhc3M6dGltZW91dCcsXG5cbiAgYWRkQ2xhc3NCZWdpbjogJ2FuaW1hdGlvbjphZGQtY2xhc3M6YmVnaW4nLFxuICBhZGRDbGFzc0FjdGl2ZTogJ2FuaW1hdGlvbjphZGQtY2xhc3M6YWN0aXZlJyxcbiAgYWRkQ2xhc3NEb25lOiAnYW5pbWF0aW9uOmFkZC1jbGFzczpkb25lJyxcbiAgYWRkQ2xhc3NUaW1lb3V0OiAnYW5pbWF0aW9uOmFkZC1jbGFzczp0aW1lb3V0JyxcblxuICBhbmltYXRlQmVnaW46ICdhbmltYXRpb246YW5pbWF0ZTpiZWdpbicsXG4gIGFuaW1hdGVBY3RpdmU6ICdhbmltYXRpb246YW5pbWF0ZTphY3RpdmUnLFxuICBhbmltYXRlRG9uZTogJ2FuaW1hdGlvbjphbmltYXRlOmRvbmUnLFxuICBhbmltYXRlVGltZW91dDogJ2FuaW1hdGlvbjphbmltYXRlOnRpbWVvdXQnLFxuXG4gIHNlcXVlbmNlQmVnaW46ICdhbmltYXRpb246c2VxdWVuY2U6YmVnaW4nLFxuICBzZXF1ZW5jZURvbmU6ICdhbmltYXRpb246c2VxdWVuY2U6ZG9uZSdcbn07XG5cbnZhciBBbmltYXRvciA9IGV4cG9ydHMuQW5pbWF0b3IgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEFuaW1hdG9yKCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBbmltYXRvcik7XG4gIH1cblxuICBBbmltYXRvci5wcm90b3R5cGUuZW50ZXIgPSBmdW5jdGlvbiBlbnRlcihlbGVtZW50KSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShmYWxzZSk7XG4gIH07XG5cbiAgQW5pbWF0b3IucHJvdG90eXBlLmxlYXZlID0gZnVuY3Rpb24gbGVhdmUoZWxlbWVudCkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZmFsc2UpO1xuICB9O1xuXG4gIEFuaW1hdG9yLnByb3RvdHlwZS5yZW1vdmVDbGFzcyA9IGZ1bmN0aW9uIHJlbW92ZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZmFsc2UpO1xuICB9O1xuXG4gIEFuaW1hdG9yLnByb3RvdHlwZS5hZGRDbGFzcyA9IGZ1bmN0aW9uIGFkZENsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZmFsc2UpO1xuICB9O1xuXG4gIEFuaW1hdG9yLnByb3RvdHlwZS5hbmltYXRlID0gZnVuY3Rpb24gYW5pbWF0ZShlbGVtZW50LCBjbGFzc05hbWUpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcbiAgfTtcblxuICBBbmltYXRvci5wcm90b3R5cGUucnVuU2VxdWVuY2UgPSBmdW5jdGlvbiBydW5TZXF1ZW5jZShhbmltYXRpb25zKSB7fTtcblxuICBBbmltYXRvci5wcm90b3R5cGUucmVnaXN0ZXJFZmZlY3QgPSBmdW5jdGlvbiByZWdpc3RlckVmZmVjdChlZmZlY3ROYW1lLCBwcm9wZXJ0aWVzKSB7fTtcblxuICBBbmltYXRvci5wcm90b3R5cGUudW5yZWdpc3RlckVmZmVjdCA9IGZ1bmN0aW9uIHVucmVnaXN0ZXJFZmZlY3QoZWZmZWN0TmFtZSkge307XG5cbiAgcmV0dXJuIEFuaW1hdG9yO1xufSgpO1xuXG52YXIgQ29tcG9zaXRpb25UcmFuc2FjdGlvbiA9IGV4cG9ydHMuQ29tcG9zaXRpb25UcmFuc2FjdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQ29tcG9zaXRpb25UcmFuc2FjdGlvbigpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29tcG9zaXRpb25UcmFuc2FjdGlvbik7XG5cbiAgICB0aGlzLl9vd25lcnNoaXBUb2tlbiA9IG51bGw7XG4gICAgdGhpcy5fY29tcG9zaXRpb25Db3VudCA9IDA7XG4gIH1cblxuICBDb21wb3NpdGlvblRyYW5zYWN0aW9uLnByb3RvdHlwZS50cnlDYXB0dXJlID0gZnVuY3Rpb24gdHJ5Q2FwdHVyZSgpIHtcbiAgICBpZiAodGhpcy5fb3duZXJzaGlwVG9rZW4gIT09IG51bGwpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLl9vd25lcnNoaXBUb2tlbiA9IHRoaXMuX2NyZWF0ZU93bmVyc2hpcFRva2VuKCk7XG4gIH07XG5cbiAgQ29tcG9zaXRpb25UcmFuc2FjdGlvbi5wcm90b3R5cGUuZW5saXN0ID0gZnVuY3Rpb24gZW5saXN0KCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgIHRoYXQuX2NvbXBvc2l0aW9uQ291bnQrKztcblxuICAgIHJldHVybiB7XG4gICAgICBkb25lOiBmdW5jdGlvbiBkb25lKCkge1xuICAgICAgICB0aGF0Ll9jb21wb3NpdGlvbkNvdW50LS07XG4gICAgICAgIHRoYXQuX3RyeUNvbXBsZXRlVHJhbnNhY3Rpb24oKTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuXG4gIENvbXBvc2l0aW9uVHJhbnNhY3Rpb24ucHJvdG90eXBlLl90cnlDb21wbGV0ZVRyYW5zYWN0aW9uID0gZnVuY3Rpb24gX3RyeUNvbXBsZXRlVHJhbnNhY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuX2NvbXBvc2l0aW9uQ291bnQgPD0gMCkge1xuICAgICAgdGhpcy5fY29tcG9zaXRpb25Db3VudCA9IDA7XG5cbiAgICAgIGlmICh0aGlzLl9vd25lcnNoaXBUb2tlbiAhPT0gbnVsbCkge1xuICAgICAgICB2YXIgY2FwdHVyZSA9IHRoaXMuX293bmVyc2hpcFRva2VuO1xuICAgICAgICB0aGlzLl9vd25lcnNoaXBUb2tlbiA9IG51bGw7XG4gICAgICAgIGNhcHR1cmUuX3Jlc29sdmUoKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgQ29tcG9zaXRpb25UcmFuc2FjdGlvbi5wcm90b3R5cGUuX2NyZWF0ZU93bmVyc2hpcFRva2VuID0gZnVuY3Rpb24gX2NyZWF0ZU93bmVyc2hpcFRva2VuKCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB2YXIgdG9rZW4gPSB7fTtcbiAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHRva2VuLl9yZXNvbHZlID0gcmVzb2x2ZTtcbiAgICB9KTtcblxuICAgIHRva2VuLndhaXRGb3JDb21wb3NpdGlvbkNvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMuX3RyeUNvbXBsZXRlVHJhbnNhY3Rpb24oKTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH07XG5cbiAgICByZXR1cm4gdG9rZW47XG4gIH07XG5cbiAgcmV0dXJuIENvbXBvc2l0aW9uVHJhbnNhY3Rpb247XG59KCk7XG5cbnZhciBjYXBpdGFsTWF0Y2hlciA9IC8oW0EtWl0pL2c7XG5cbmZ1bmN0aW9uIGFkZEh5cGhlbkFuZExvd2VyKGNoYXIpIHtcbiAgcmV0dXJuICctJyArIGNoYXIudG9Mb3dlckNhc2UoKTtcbn1cblxuZnVuY3Rpb24gX2h5cGhlbmF0ZShuYW1lKSB7XG4gIHJldHVybiAobmFtZS5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSArIG5hbWUuc2xpY2UoMSkpLnJlcGxhY2UoY2FwaXRhbE1hdGNoZXIsIGFkZEh5cGhlbkFuZExvd2VyKTtcbn1cblxudmFyIEVsZW1lbnRFdmVudHMgPSBleHBvcnRzLkVsZW1lbnRFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEVsZW1lbnRFdmVudHMoZWxlbWVudCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFbGVtZW50RXZlbnRzKTtcblxuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25zID0ge307XG4gIH1cblxuICBFbGVtZW50RXZlbnRzLnByb3RvdHlwZS5fZW5xdWV1ZUhhbmRsZXIgPSBmdW5jdGlvbiBfZW5xdWV1ZUhhbmRsZXIoaGFuZGxlcikge1xuICAgIHRoaXMuc3Vic2NyaXB0aW9uc1toYW5kbGVyLmV2ZW50TmFtZV0gPSB0aGlzLnN1YnNjcmlwdGlvbnNbaGFuZGxlci5ldmVudE5hbWVdIHx8IFtdO1xuICAgIHRoaXMuc3Vic2NyaXB0aW9uc1toYW5kbGVyLmV2ZW50TmFtZV0ucHVzaChoYW5kbGVyKTtcbiAgfTtcblxuICBFbGVtZW50RXZlbnRzLnByb3RvdHlwZS5fZGVxdWV1ZUhhbmRsZXIgPSBmdW5jdGlvbiBfZGVxdWV1ZUhhbmRsZXIoaGFuZGxlcikge1xuICAgIHZhciBpbmRleCA9IHZvaWQgMDtcbiAgICB2YXIgc3Vic2NyaXB0aW9ucyA9IHRoaXMuc3Vic2NyaXB0aW9uc1toYW5kbGVyLmV2ZW50TmFtZV07XG4gICAgaWYgKHN1YnNjcmlwdGlvbnMpIHtcbiAgICAgIGluZGV4ID0gc3Vic2NyaXB0aW9ucy5pbmRleE9mKGhhbmRsZXIpO1xuICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgc3Vic2NyaXB0aW9ucy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaGFuZGxlcjtcbiAgfTtcblxuICBFbGVtZW50RXZlbnRzLnByb3RvdHlwZS5wdWJsaXNoID0gZnVuY3Rpb24gcHVibGlzaChldmVudE5hbWUpIHtcbiAgICB2YXIgZGV0YWlsID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07XG4gICAgdmFyIGJ1YmJsZXMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDIgfHwgYXJndW1lbnRzWzJdID09PSB1bmRlZmluZWQgPyB0cnVlIDogYXJndW1lbnRzWzJdO1xuICAgIHZhciBjYW5jZWxhYmxlID0gYXJndW1lbnRzLmxlbmd0aCA8PSAzIHx8IGFyZ3VtZW50c1szXSA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6IGFyZ3VtZW50c1szXTtcblxuICAgIHZhciBldmVudCA9IF9hdXJlbGlhUGFsLkRPTS5jcmVhdGVDdXN0b21FdmVudChldmVudE5hbWUsIHsgY2FuY2VsYWJsZTogY2FuY2VsYWJsZSwgYnViYmxlczogYnViYmxlcywgZGV0YWlsOiBkZXRhaWwgfSk7XG4gICAgdGhpcy5lbGVtZW50LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICB9O1xuXG4gIEVsZW1lbnRFdmVudHMucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIHN1YnNjcmliZShldmVudE5hbWUsIGhhbmRsZXIpIHtcbiAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgIHZhciBidWJibGVzID0gYXJndW1lbnRzLmxlbmd0aCA8PSAyIHx8IGFyZ3VtZW50c1syXSA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6IGFyZ3VtZW50c1syXTtcblxuICAgIGlmIChoYW5kbGVyICYmIHR5cGVvZiBoYW5kbGVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBoYW5kbGVyLmV2ZW50TmFtZSA9IGV2ZW50TmFtZTtcbiAgICAgIGhhbmRsZXIuaGFuZGxlciA9IGhhbmRsZXI7XG4gICAgICBoYW5kbGVyLmJ1YmJsZXMgPSBidWJibGVzO1xuICAgICAgaGFuZGxlci5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpczIuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgaGFuZGxlciwgYnViYmxlcyk7XG4gICAgICAgIF90aGlzMi5fZGVxdWV1ZUhhbmRsZXIoaGFuZGxlcik7XG4gICAgICB9O1xuICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBoYW5kbGVyLCBidWJibGVzKTtcbiAgICAgIHRoaXMuX2VucXVldWVIYW5kbGVyKGhhbmRsZXIpO1xuICAgICAgcmV0dXJuIGhhbmRsZXI7XG4gICAgfVxuICB9O1xuXG4gIEVsZW1lbnRFdmVudHMucHJvdG90eXBlLnN1YnNjcmliZU9uY2UgPSBmdW5jdGlvbiBzdWJzY3JpYmVPbmNlKGV2ZW50TmFtZSwgaGFuZGxlcikge1xuICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgdmFyIGJ1YmJsZXMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDIgfHwgYXJndW1lbnRzWzJdID09PSB1bmRlZmluZWQgPyB0cnVlIDogYXJndW1lbnRzWzJdO1xuXG4gICAgaWYgKGhhbmRsZXIgJiYgdHlwZW9mIGhhbmRsZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHZhciBfcmV0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX2hhbmRsZXIgPSBmdW5jdGlvbiBfaGFuZGxlcihldmVudCkge1xuICAgICAgICAgIGhhbmRsZXIoZXZlbnQpO1xuICAgICAgICAgIF9oYW5kbGVyLmRpc3Bvc2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB2OiBfdGhpczMuc3Vic2NyaWJlKGV2ZW50TmFtZSwgX2hhbmRsZXIsIGJ1YmJsZXMpXG4gICAgICAgIH07XG4gICAgICB9KCk7XG5cbiAgICAgIGlmICgodHlwZW9mIF9yZXQgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKF9yZXQpKSA9PT0gXCJvYmplY3RcIikgcmV0dXJuIF9yZXQudjtcbiAgICB9XG4gIH07XG5cbiAgRWxlbWVudEV2ZW50cy5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uIGRpc3Bvc2UoZXZlbnROYW1lKSB7XG4gICAgaWYgKGV2ZW50TmFtZSAmJiB0eXBlb2YgZXZlbnROYW1lID09PSAnc3RyaW5nJykge1xuICAgICAgdmFyIHN1YnNjcmlwdGlvbnMgPSB0aGlzLnN1YnNjcmlwdGlvbnNbZXZlbnROYW1lXTtcbiAgICAgIGlmIChzdWJzY3JpcHRpb25zKSB7XG4gICAgICAgIHdoaWxlIChzdWJzY3JpcHRpb25zLmxlbmd0aCkge1xuICAgICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBzdWJzY3JpcHRpb25zLnBvcCgpO1xuICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5kaXNwb3NlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZGlzcG9zZUFsbCgpO1xuICAgIH1cbiAgfTtcblxuICBFbGVtZW50RXZlbnRzLnByb3RvdHlwZS5kaXNwb3NlQWxsID0gZnVuY3Rpb24gZGlzcG9zZUFsbCgpIHtcbiAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5zdWJzY3JpcHRpb25zKSB7XG4gICAgICB0aGlzLmRpc3Bvc2Uoa2V5KTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIEVsZW1lbnRFdmVudHM7XG59KCk7XG5cbnZhciBSZXNvdXJjZUxvYWRDb250ZXh0ID0gZXhwb3J0cy5SZXNvdXJjZUxvYWRDb250ZXh0ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBSZXNvdXJjZUxvYWRDb250ZXh0KCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSZXNvdXJjZUxvYWRDb250ZXh0KTtcblxuICAgIHRoaXMuZGVwZW5kZW5jaWVzID0ge307XG4gIH1cblxuICBSZXNvdXJjZUxvYWRDb250ZXh0LnByb3RvdHlwZS5hZGREZXBlbmRlbmN5ID0gZnVuY3Rpb24gYWRkRGVwZW5kZW5jeSh1cmwpIHtcbiAgICB0aGlzLmRlcGVuZGVuY2llc1t1cmxdID0gdHJ1ZTtcbiAgfTtcblxuICBSZXNvdXJjZUxvYWRDb250ZXh0LnByb3RvdHlwZS5oYXNEZXBlbmRlbmN5ID0gZnVuY3Rpb24gaGFzRGVwZW5kZW5jeSh1cmwpIHtcbiAgICByZXR1cm4gdXJsIGluIHRoaXMuZGVwZW5kZW5jaWVzO1xuICB9O1xuXG4gIHJldHVybiBSZXNvdXJjZUxvYWRDb250ZXh0O1xufSgpO1xuXG52YXIgVmlld0NvbXBpbGVJbnN0cnVjdGlvbiA9IGV4cG9ydHMuVmlld0NvbXBpbGVJbnN0cnVjdGlvbiA9IGZ1bmN0aW9uIFZpZXdDb21waWxlSW5zdHJ1Y3Rpb24oKSB7XG4gIHZhciB0YXJnZXRTaGFkb3dET00gPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IGFyZ3VtZW50c1swXTtcbiAgdmFyIGNvbXBpbGVTdXJyb2dhdGUgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IGFyZ3VtZW50c1sxXTtcblxuICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVmlld0NvbXBpbGVJbnN0cnVjdGlvbik7XG5cbiAgdGhpcy50YXJnZXRTaGFkb3dET00gPSB0YXJnZXRTaGFkb3dET007XG4gIHRoaXMuY29tcGlsZVN1cnJvZ2F0ZSA9IGNvbXBpbGVTdXJyb2dhdGU7XG4gIHRoaXMuYXNzb2NpYXRlZE1vZHVsZUlkID0gbnVsbDtcbn07XG5cblZpZXdDb21waWxlSW5zdHJ1Y3Rpb24ubm9ybWFsID0gbmV3IFZpZXdDb21waWxlSW5zdHJ1Y3Rpb24oKTtcblxudmFyIEJlaGF2aW9ySW5zdHJ1Y3Rpb24gPSBleHBvcnRzLkJlaGF2aW9ySW5zdHJ1Y3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gIEJlaGF2aW9ySW5zdHJ1Y3Rpb24uZW5oYW5jZSA9IGZ1bmN0aW9uIGVuaGFuY2UoKSB7XG4gICAgdmFyIGluc3RydWN0aW9uID0gbmV3IEJlaGF2aW9ySW5zdHJ1Y3Rpb24oKTtcbiAgICBpbnN0cnVjdGlvbi5lbmhhbmNlID0gdHJ1ZTtcbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XG4gIH07XG5cbiAgQmVoYXZpb3JJbnN0cnVjdGlvbi51bml0VGVzdCA9IGZ1bmN0aW9uIHVuaXRUZXN0KHR5cGUsIGF0dHJpYnV0ZXMpIHtcbiAgICB2YXIgaW5zdHJ1Y3Rpb24gPSBuZXcgQmVoYXZpb3JJbnN0cnVjdGlvbigpO1xuICAgIGluc3RydWN0aW9uLnR5cGUgPSB0eXBlO1xuICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzIHx8IHt9O1xuICAgIHJldHVybiBpbnN0cnVjdGlvbjtcbiAgfTtcblxuICBCZWhhdmlvckluc3RydWN0aW9uLmVsZW1lbnQgPSBmdW5jdGlvbiBlbGVtZW50KG5vZGUsIHR5cGUpIHtcbiAgICB2YXIgaW5zdHJ1Y3Rpb24gPSBuZXcgQmVoYXZpb3JJbnN0cnVjdGlvbigpO1xuICAgIGluc3RydWN0aW9uLnR5cGUgPSB0eXBlO1xuICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXMgPSB7fTtcbiAgICBpbnN0cnVjdGlvbi5hbmNob3JJc0NvbnRhaW5lciA9ICEobm9kZS5oYXNBdHRyaWJ1dGUoJ2NvbnRhaW5lcmxlc3MnKSB8fCB0eXBlLmNvbnRhaW5lcmxlc3MpO1xuICAgIGluc3RydWN0aW9uLmluaXRpYXRlZEJ5QmVoYXZpb3IgPSB0cnVlO1xuICAgIHJldHVybiBpbnN0cnVjdGlvbjtcbiAgfTtcblxuICBCZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZSA9IGZ1bmN0aW9uIGF0dHJpYnV0ZShhdHRyTmFtZSwgdHlwZSkge1xuICAgIHZhciBpbnN0cnVjdGlvbiA9IG5ldyBCZWhhdmlvckluc3RydWN0aW9uKCk7XG4gICAgaW5zdHJ1Y3Rpb24uYXR0ck5hbWUgPSBhdHRyTmFtZTtcbiAgICBpbnN0cnVjdGlvbi50eXBlID0gdHlwZSB8fCBudWxsO1xuICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXMgPSB7fTtcbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XG4gIH07XG5cbiAgQmVoYXZpb3JJbnN0cnVjdGlvbi5keW5hbWljID0gZnVuY3Rpb24gZHluYW1pYyhob3N0LCB2aWV3TW9kZWwsIHZpZXdGYWN0b3J5KSB7XG4gICAgdmFyIGluc3RydWN0aW9uID0gbmV3IEJlaGF2aW9ySW5zdHJ1Y3Rpb24oKTtcbiAgICBpbnN0cnVjdGlvbi5ob3N0ID0gaG9zdDtcbiAgICBpbnN0cnVjdGlvbi52aWV3TW9kZWwgPSB2aWV3TW9kZWw7XG4gICAgaW5zdHJ1Y3Rpb24udmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcbiAgICBpbnN0cnVjdGlvbi5pbmhlcml0QmluZGluZ0NvbnRleHQgPSB0cnVlO1xuICAgIHJldHVybiBpbnN0cnVjdGlvbjtcbiAgfTtcblxuICBmdW5jdGlvbiBCZWhhdmlvckluc3RydWN0aW9uKCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCZWhhdmlvckluc3RydWN0aW9uKTtcblxuICAgIHRoaXMuaW5pdGlhdGVkQnlCZWhhdmlvciA9IGZhbHNlO1xuICAgIHRoaXMuZW5oYW5jZSA9IGZhbHNlO1xuICAgIHRoaXMucGFydFJlcGxhY2VtZW50cyA9IG51bGw7XG4gICAgdGhpcy52aWV3RmFjdG9yeSA9IG51bGw7XG4gICAgdGhpcy5vcmlnaW5hbEF0dHJOYW1lID0gbnVsbDtcbiAgICB0aGlzLnNraXBDb250ZW50UHJvY2Vzc2luZyA9IGZhbHNlO1xuICAgIHRoaXMuY29udGVudEZhY3RvcnkgPSBudWxsO1xuICAgIHRoaXMudmlld01vZGVsID0gbnVsbDtcbiAgICB0aGlzLmFuY2hvcklzQ29udGFpbmVyID0gZmFsc2U7XG4gICAgdGhpcy5ob3N0ID0gbnVsbDtcbiAgICB0aGlzLmF0dHJpYnV0ZXMgPSBudWxsO1xuICAgIHRoaXMudHlwZSA9IG51bGw7XG4gICAgdGhpcy5hdHRyTmFtZSA9IG51bGw7XG4gICAgdGhpcy5pbmhlcml0QmluZGluZ0NvbnRleHQgPSBmYWxzZTtcbiAgfVxuXG4gIHJldHVybiBCZWhhdmlvckluc3RydWN0aW9uO1xufSgpO1xuXG5CZWhhdmlvckluc3RydWN0aW9uLm5vcm1hbCA9IG5ldyBCZWhhdmlvckluc3RydWN0aW9uKCk7XG5cbnZhciBUYXJnZXRJbnN0cnVjdGlvbiA9IGV4cG9ydHMuVGFyZ2V0SW5zdHJ1Y3Rpb24gPSAoX3RlbXAgPSBfY2xhc3MzID0gZnVuY3Rpb24gKCkge1xuICBUYXJnZXRJbnN0cnVjdGlvbi5jb250ZW50U2VsZWN0b3IgPSBmdW5jdGlvbiBjb250ZW50U2VsZWN0b3Iobm9kZSwgcGFyZW50SW5qZWN0b3JJZCkge1xuICAgIHZhciBpbnN0cnVjdGlvbiA9IG5ldyBUYXJnZXRJbnN0cnVjdGlvbigpO1xuICAgIGluc3RydWN0aW9uLnBhcmVudEluamVjdG9ySWQgPSBwYXJlbnRJbmplY3RvcklkO1xuICAgIGluc3RydWN0aW9uLmNvbnRlbnRTZWxlY3RvciA9IHRydWU7XG4gICAgaW5zdHJ1Y3Rpb24uc2VsZWN0b3IgPSBub2RlLmdldEF0dHJpYnV0ZSgnc2VsZWN0Jyk7XG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9O1xuXG4gIFRhcmdldEluc3RydWN0aW9uLmNvbnRlbnRFeHByZXNzaW9uID0gZnVuY3Rpb24gY29udGVudEV4cHJlc3Npb24oZXhwcmVzc2lvbikge1xuICAgIHZhciBpbnN0cnVjdGlvbiA9IG5ldyBUYXJnZXRJbnN0cnVjdGlvbigpO1xuICAgIGluc3RydWN0aW9uLmNvbnRlbnRFeHByZXNzaW9uID0gZXhwcmVzc2lvbjtcbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XG4gIH07XG5cbiAgVGFyZ2V0SW5zdHJ1Y3Rpb24ubGlmdGluZyA9IGZ1bmN0aW9uIGxpZnRpbmcocGFyZW50SW5qZWN0b3JJZCwgbGlmdGluZ0luc3RydWN0aW9uKSB7XG4gICAgdmFyIGluc3RydWN0aW9uID0gbmV3IFRhcmdldEluc3RydWN0aW9uKCk7XG4gICAgaW5zdHJ1Y3Rpb24ucGFyZW50SW5qZWN0b3JJZCA9IHBhcmVudEluamVjdG9ySWQ7XG4gICAgaW5zdHJ1Y3Rpb24uZXhwcmVzc2lvbnMgPSBUYXJnZXRJbnN0cnVjdGlvbi5ub0V4cHJlc3Npb25zO1xuICAgIGluc3RydWN0aW9uLmJlaGF2aW9ySW5zdHJ1Y3Rpb25zID0gW2xpZnRpbmdJbnN0cnVjdGlvbl07XG4gICAgaW5zdHJ1Y3Rpb24udmlld0ZhY3RvcnkgPSBsaWZ0aW5nSW5zdHJ1Y3Rpb24udmlld0ZhY3Rvcnk7XG4gICAgaW5zdHJ1Y3Rpb24ucHJvdmlkZXJzID0gW2xpZnRpbmdJbnN0cnVjdGlvbi50eXBlLnRhcmdldF07XG4gICAgaW5zdHJ1Y3Rpb24ubGlmdGluZyA9IHRydWU7XG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9O1xuXG4gIFRhcmdldEluc3RydWN0aW9uLm5vcm1hbCA9IGZ1bmN0aW9uIG5vcm1hbChpbmplY3RvcklkLCBwYXJlbnRJbmplY3RvcklkLCBwcm92aWRlcnMsIGJlaGF2aW9ySW5zdHJ1Y3Rpb25zLCBleHByZXNzaW9ucywgZWxlbWVudEluc3RydWN0aW9uKSB7XG4gICAgdmFyIGluc3RydWN0aW9uID0gbmV3IFRhcmdldEluc3RydWN0aW9uKCk7XG4gICAgaW5zdHJ1Y3Rpb24uaW5qZWN0b3JJZCA9IGluamVjdG9ySWQ7XG4gICAgaW5zdHJ1Y3Rpb24ucGFyZW50SW5qZWN0b3JJZCA9IHBhcmVudEluamVjdG9ySWQ7XG4gICAgaW5zdHJ1Y3Rpb24ucHJvdmlkZXJzID0gcHJvdmlkZXJzO1xuICAgIGluc3RydWN0aW9uLmJlaGF2aW9ySW5zdHJ1Y3Rpb25zID0gYmVoYXZpb3JJbnN0cnVjdGlvbnM7XG4gICAgaW5zdHJ1Y3Rpb24uZXhwcmVzc2lvbnMgPSBleHByZXNzaW9ucztcbiAgICBpbnN0cnVjdGlvbi5hbmNob3JJc0NvbnRhaW5lciA9IGVsZW1lbnRJbnN0cnVjdGlvbiA/IGVsZW1lbnRJbnN0cnVjdGlvbi5hbmNob3JJc0NvbnRhaW5lciA6IHRydWU7XG4gICAgaW5zdHJ1Y3Rpb24uZWxlbWVudEluc3RydWN0aW9uID0gZWxlbWVudEluc3RydWN0aW9uO1xuICAgIHJldHVybiBpbnN0cnVjdGlvbjtcbiAgfTtcblxuICBUYXJnZXRJbnN0cnVjdGlvbi5zdXJyb2dhdGUgPSBmdW5jdGlvbiBzdXJyb2dhdGUocHJvdmlkZXJzLCBiZWhhdmlvckluc3RydWN0aW9ucywgZXhwcmVzc2lvbnMsIHZhbHVlcykge1xuICAgIHZhciBpbnN0cnVjdGlvbiA9IG5ldyBUYXJnZXRJbnN0cnVjdGlvbigpO1xuICAgIGluc3RydWN0aW9uLmV4cHJlc3Npb25zID0gZXhwcmVzc2lvbnM7XG4gICAgaW5zdHJ1Y3Rpb24uYmVoYXZpb3JJbnN0cnVjdGlvbnMgPSBiZWhhdmlvckluc3RydWN0aW9ucztcbiAgICBpbnN0cnVjdGlvbi5wcm92aWRlcnMgPSBwcm92aWRlcnM7XG4gICAgaW5zdHJ1Y3Rpb24udmFsdWVzID0gdmFsdWVzO1xuICAgIHJldHVybiBpbnN0cnVjdGlvbjtcbiAgfTtcblxuICBmdW5jdGlvbiBUYXJnZXRJbnN0cnVjdGlvbigpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGFyZ2V0SW5zdHJ1Y3Rpb24pO1xuXG4gICAgdGhpcy5pbmplY3RvcklkID0gbnVsbDtcbiAgICB0aGlzLnBhcmVudEluamVjdG9ySWQgPSBudWxsO1xuXG4gICAgdGhpcy5jb250ZW50U2VsZWN0b3IgPSBmYWxzZTtcbiAgICB0aGlzLnNlbGVjdG9yID0gbnVsbDtcblxuICAgIHRoaXMuY29udGVudEV4cHJlc3Npb24gPSBudWxsO1xuXG4gICAgdGhpcy5leHByZXNzaW9ucyA9IG51bGw7XG4gICAgdGhpcy5iZWhhdmlvckluc3RydWN0aW9ucyA9IG51bGw7XG4gICAgdGhpcy5wcm92aWRlcnMgPSBudWxsO1xuXG4gICAgdGhpcy52aWV3RmFjdG9yeSA9IG51bGw7XG5cbiAgICB0aGlzLmFuY2hvcklzQ29udGFpbmVyID0gZmFsc2U7XG4gICAgdGhpcy5lbGVtZW50SW5zdHJ1Y3Rpb24gPSBudWxsO1xuICAgIHRoaXMubGlmdGluZyA9IGZhbHNlO1xuXG4gICAgdGhpcy52YWx1ZXMgPSBudWxsO1xuICB9XG5cbiAgcmV0dXJuIFRhcmdldEluc3RydWN0aW9uO1xufSgpLCBfY2xhc3MzLm5vRXhwcmVzc2lvbnMgPSBPYmplY3QuZnJlZXplKFtdKSwgX3RlbXApO1xudmFyIHZpZXdTdHJhdGVneSA9IGV4cG9ydHMudmlld1N0cmF0ZWd5ID0gX2F1cmVsaWFNZXRhZGF0YS5wcm90b2NvbC5jcmVhdGUoJ2F1cmVsaWE6dmlldy1zdHJhdGVneScsIHtcbiAgdmFsaWRhdGU6IGZ1bmN0aW9uIHZhbGlkYXRlKHRhcmdldCkge1xuICAgIGlmICghKHR5cGVvZiB0YXJnZXQubG9hZFZpZXdGYWN0b3J5ID09PSAnZnVuY3Rpb24nKSkge1xuICAgICAgcmV0dXJuICdWaWV3IHN0cmF0ZWdpZXMgbXVzdCBpbXBsZW1lbnQ6IGxvYWRWaWV3RmFjdG9yeSh2aWV3RW5naW5lOiBWaWV3RW5naW5lLCBjb21waWxlSW5zdHJ1Y3Rpb246IFZpZXdDb21waWxlSW5zdHJ1Y3Rpb24sIGxvYWRDb250ZXh0PzogUmVzb3VyY2VMb2FkQ29udGV4dCk6IFByb21pc2U8Vmlld0ZhY3Rvcnk+JztcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSxcbiAgY29tcG9zZTogZnVuY3Rpb24gY29tcG9zZSh0YXJnZXQpIHtcbiAgICBpZiAoISh0eXBlb2YgdGFyZ2V0Lm1ha2VSZWxhdGl2ZVRvID09PSAnZnVuY3Rpb24nKSkge1xuICAgICAgdGFyZ2V0Lm1ha2VSZWxhdGl2ZVRvID0gX2F1cmVsaWFQYWwuUExBVEZPUk0ubm9vcDtcbiAgICB9XG4gIH1cbn0pO1xuXG52YXIgUmVsYXRpdmVWaWV3U3RyYXRlZ3kgPSBleHBvcnRzLlJlbGF0aXZlVmlld1N0cmF0ZWd5ID0gKF9kZWMgPSB2aWV3U3RyYXRlZ3koKSwgX2RlYyhfY2xhc3M0ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBSZWxhdGl2ZVZpZXdTdHJhdGVneShwYXRoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlbGF0aXZlVmlld1N0cmF0ZWd5KTtcblxuICAgIHRoaXMucGF0aCA9IHBhdGg7XG4gICAgdGhpcy5hYnNvbHV0ZVBhdGggPSBudWxsO1xuICB9XG5cbiAgUmVsYXRpdmVWaWV3U3RyYXRlZ3kucHJvdG90eXBlLmxvYWRWaWV3RmFjdG9yeSA9IGZ1bmN0aW9uIGxvYWRWaWV3RmFjdG9yeSh2aWV3RW5naW5lLCBjb21waWxlSW5zdHJ1Y3Rpb24sIGxvYWRDb250ZXh0KSB7XG4gICAgaWYgKHRoaXMuYWJzb2x1dGVQYXRoID09PSBudWxsICYmIHRoaXMubW9kdWxlSWQpIHtcbiAgICAgIHRoaXMuYWJzb2x1dGVQYXRoID0gKDAsIF9hdXJlbGlhUGF0aC5yZWxhdGl2ZVRvRmlsZSkodGhpcy5wYXRoLCB0aGlzLm1vZHVsZUlkKTtcbiAgICB9XG5cbiAgICBjb21waWxlSW5zdHJ1Y3Rpb24uYXNzb2NpYXRlZE1vZHVsZUlkID0gdGhpcy5tb2R1bGVJZDtcbiAgICByZXR1cm4gdmlld0VuZ2luZS5sb2FkVmlld0ZhY3RvcnkodGhpcy5hYnNvbHV0ZVBhdGggfHwgdGhpcy5wYXRoLCBjb21waWxlSW5zdHJ1Y3Rpb24sIGxvYWRDb250ZXh0KTtcbiAgfTtcblxuICBSZWxhdGl2ZVZpZXdTdHJhdGVneS5wcm90b3R5cGUubWFrZVJlbGF0aXZlVG8gPSBmdW5jdGlvbiBtYWtlUmVsYXRpdmVUbyhmaWxlKSB7XG4gICAgaWYgKHRoaXMuYWJzb2x1dGVQYXRoID09PSBudWxsKSB7XG4gICAgICB0aGlzLmFic29sdXRlUGF0aCA9ICgwLCBfYXVyZWxpYVBhdGgucmVsYXRpdmVUb0ZpbGUpKHRoaXMucGF0aCwgZmlsZSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBSZWxhdGl2ZVZpZXdTdHJhdGVneTtcbn0oKSkgfHwgX2NsYXNzNCk7XG52YXIgQ29udmVudGlvbmFsVmlld1N0cmF0ZWd5ID0gZXhwb3J0cy5Db252ZW50aW9uYWxWaWV3U3RyYXRlZ3kgPSAoX2RlYzIgPSB2aWV3U3RyYXRlZ3koKSwgX2RlYzIoX2NsYXNzNSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQ29udmVudGlvbmFsVmlld1N0cmF0ZWd5KHZpZXdMb2NhdG9yLCBvcmlnaW4pIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29udmVudGlvbmFsVmlld1N0cmF0ZWd5KTtcblxuICAgIHRoaXMubW9kdWxlSWQgPSBvcmlnaW4ubW9kdWxlSWQ7XG4gICAgdGhpcy52aWV3VXJsID0gdmlld0xvY2F0b3IuY29udmVydE9yaWdpblRvVmlld1VybChvcmlnaW4pO1xuICB9XG5cbiAgQ29udmVudGlvbmFsVmlld1N0cmF0ZWd5LnByb3RvdHlwZS5sb2FkVmlld0ZhY3RvcnkgPSBmdW5jdGlvbiBsb2FkVmlld0ZhY3Rvcnkodmlld0VuZ2luZSwgY29tcGlsZUluc3RydWN0aW9uLCBsb2FkQ29udGV4dCkge1xuICAgIGNvbXBpbGVJbnN0cnVjdGlvbi5hc3NvY2lhdGVkTW9kdWxlSWQgPSB0aGlzLm1vZHVsZUlkO1xuICAgIHJldHVybiB2aWV3RW5naW5lLmxvYWRWaWV3RmFjdG9yeSh0aGlzLnZpZXdVcmwsIGNvbXBpbGVJbnN0cnVjdGlvbiwgbG9hZENvbnRleHQpO1xuICB9O1xuXG4gIHJldHVybiBDb252ZW50aW9uYWxWaWV3U3RyYXRlZ3k7XG59KCkpIHx8IF9jbGFzczUpO1xudmFyIE5vVmlld1N0cmF0ZWd5ID0gZXhwb3J0cy5Ob1ZpZXdTdHJhdGVneSA9IChfZGVjMyA9IHZpZXdTdHJhdGVneSgpLCBfZGVjMyhfY2xhc3M2ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBOb1ZpZXdTdHJhdGVneSgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTm9WaWV3U3RyYXRlZ3kpO1xuICB9XG5cbiAgTm9WaWV3U3RyYXRlZ3kucHJvdG90eXBlLmxvYWRWaWV3RmFjdG9yeSA9IGZ1bmN0aW9uIGxvYWRWaWV3RmFjdG9yeSh2aWV3RW5naW5lLCBjb21waWxlSW5zdHJ1Y3Rpb24sIGxvYWRDb250ZXh0KSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKTtcbiAgfTtcblxuICByZXR1cm4gTm9WaWV3U3RyYXRlZ3k7XG59KCkpIHx8IF9jbGFzczYpO1xudmFyIFRlbXBsYXRlUmVnaXN0cnlWaWV3U3RyYXRlZ3kgPSBleHBvcnRzLlRlbXBsYXRlUmVnaXN0cnlWaWV3U3RyYXRlZ3kgPSAoX2RlYzQgPSB2aWV3U3RyYXRlZ3koKSwgX2RlYzQoX2NsYXNzNyA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gVGVtcGxhdGVSZWdpc3RyeVZpZXdTdHJhdGVneShtb2R1bGVJZCwgZW50cnkpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGVtcGxhdGVSZWdpc3RyeVZpZXdTdHJhdGVneSk7XG5cbiAgICB0aGlzLm1vZHVsZUlkID0gbW9kdWxlSWQ7XG4gICAgdGhpcy5lbnRyeSA9IGVudHJ5O1xuICB9XG5cbiAgVGVtcGxhdGVSZWdpc3RyeVZpZXdTdHJhdGVneS5wcm90b3R5cGUubG9hZFZpZXdGYWN0b3J5ID0gZnVuY3Rpb24gbG9hZFZpZXdGYWN0b3J5KHZpZXdFbmdpbmUsIGNvbXBpbGVJbnN0cnVjdGlvbiwgbG9hZENvbnRleHQpIHtcbiAgICB2YXIgZW50cnkgPSB0aGlzLmVudHJ5O1xuXG4gICAgaWYgKGVudHJ5LmZhY3RvcnlJc1JlYWR5KSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGVudHJ5LmZhY3RvcnkpO1xuICAgIH1cblxuICAgIGNvbXBpbGVJbnN0cnVjdGlvbi5hc3NvY2lhdGVkTW9kdWxlSWQgPSB0aGlzLm1vZHVsZUlkO1xuICAgIHJldHVybiB2aWV3RW5naW5lLmxvYWRWaWV3RmFjdG9yeShlbnRyeSwgY29tcGlsZUluc3RydWN0aW9uLCBsb2FkQ29udGV4dCk7XG4gIH07XG5cbiAgcmV0dXJuIFRlbXBsYXRlUmVnaXN0cnlWaWV3U3RyYXRlZ3k7XG59KCkpIHx8IF9jbGFzczcpO1xudmFyIElubGluZVZpZXdTdHJhdGVneSA9IGV4cG9ydHMuSW5saW5lVmlld1N0cmF0ZWd5ID0gKF9kZWM1ID0gdmlld1N0cmF0ZWd5KCksIF9kZWM1KF9jbGFzczggPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIElubGluZVZpZXdTdHJhdGVneShtYXJrdXAsIGRlcGVuZGVuY2llcywgZGVwZW5kZW5jeUJhc2VVcmwpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSW5saW5lVmlld1N0cmF0ZWd5KTtcblxuICAgIHRoaXMubWFya3VwID0gbWFya3VwO1xuICAgIHRoaXMuZGVwZW5kZW5jaWVzID0gZGVwZW5kZW5jaWVzIHx8IG51bGw7XG4gICAgdGhpcy5kZXBlbmRlbmN5QmFzZVVybCA9IGRlcGVuZGVuY3lCYXNlVXJsIHx8ICcnO1xuICB9XG5cbiAgSW5saW5lVmlld1N0cmF0ZWd5LnByb3RvdHlwZS5sb2FkVmlld0ZhY3RvcnkgPSBmdW5jdGlvbiBsb2FkVmlld0ZhY3Rvcnkodmlld0VuZ2luZSwgY29tcGlsZUluc3RydWN0aW9uLCBsb2FkQ29udGV4dCkge1xuICAgIHZhciBlbnRyeSA9IHRoaXMuZW50cnk7XG4gICAgdmFyIGRlcGVuZGVuY2llcyA9IHRoaXMuZGVwZW5kZW5jaWVzO1xuXG4gICAgaWYgKGVudHJ5ICYmIGVudHJ5LmZhY3RvcnlJc1JlYWR5KSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGVudHJ5LmZhY3RvcnkpO1xuICAgIH1cblxuICAgIHRoaXMuZW50cnkgPSBlbnRyeSA9IG5ldyBfYXVyZWxpYUxvYWRlci5UZW1wbGF0ZVJlZ2lzdHJ5RW50cnkodGhpcy5tb2R1bGVJZCB8fCB0aGlzLmRlcGVuZGVuY3lCYXNlVXJsKTtcbiAgICBlbnRyeS50ZW1wbGF0ZSA9IF9hdXJlbGlhUGFsLkRPTS5jcmVhdGVUZW1wbGF0ZUZyb21NYXJrdXAodGhpcy5tYXJrdXApO1xuXG4gICAgaWYgKGRlcGVuZGVuY2llcyAhPT0gbnVsbCkge1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gZGVwZW5kZW5jaWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgdmFyIGN1cnJlbnQgPSBkZXBlbmRlbmNpZXNbaV07XG5cbiAgICAgICAgaWYgKHR5cGVvZiBjdXJyZW50ID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgY3VycmVudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGVudHJ5LmFkZERlcGVuZGVuY3koY3VycmVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZW50cnkuYWRkRGVwZW5kZW5jeShjdXJyZW50LmZyb20sIGN1cnJlbnQuYXMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29tcGlsZUluc3RydWN0aW9uLmFzc29jaWF0ZWRNb2R1bGVJZCA9IHRoaXMubW9kdWxlSWQ7XG4gICAgcmV0dXJuIHZpZXdFbmdpbmUubG9hZFZpZXdGYWN0b3J5KGVudHJ5LCBjb21waWxlSW5zdHJ1Y3Rpb24sIGxvYWRDb250ZXh0KTtcbiAgfTtcblxuICByZXR1cm4gSW5saW5lVmlld1N0cmF0ZWd5O1xufSgpKSB8fCBfY2xhc3M4KTtcbnZhciBWaWV3TG9jYXRvciA9IGV4cG9ydHMuVmlld0xvY2F0b3IgPSAoX3RlbXAyID0gX2NsYXNzOSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gVmlld0xvY2F0b3IoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpZXdMb2NhdG9yKTtcbiAgfVxuXG4gIFZpZXdMb2NhdG9yLnByb3RvdHlwZS5nZXRWaWV3U3RyYXRlZ3kgPSBmdW5jdGlvbiBnZXRWaWV3U3RyYXRlZ3kodmFsdWUpIHtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAoKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YodmFsdWUpKSA9PT0gJ29iamVjdCcgJiYgJ2dldFZpZXdTdHJhdGVneScgaW4gdmFsdWUpIHtcbiAgICAgIHZhciBfb3JpZ2luID0gX2F1cmVsaWFNZXRhZGF0YS5PcmlnaW4uZ2V0KHZhbHVlLmNvbnN0cnVjdG9yKTtcblxuICAgICAgdmFsdWUgPSB2YWx1ZS5nZXRWaWV3U3RyYXRlZ3koKTtcblxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdmFsdWUgPSBuZXcgUmVsYXRpdmVWaWV3U3RyYXRlZ3kodmFsdWUpO1xuICAgICAgfVxuXG4gICAgICB2aWV3U3RyYXRlZ3kuYXNzZXJ0KHZhbHVlKTtcblxuICAgICAgaWYgKF9vcmlnaW4pIHtcbiAgICAgICAgdmFsdWUubWFrZVJlbGF0aXZlVG8oX29yaWdpbi5tb2R1bGVJZCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgdmFsdWUgPSBuZXcgUmVsYXRpdmVWaWV3U3RyYXRlZ3kodmFsdWUpO1xuICAgIH1cblxuICAgIGlmICh2aWV3U3RyYXRlZ3kudmFsaWRhdGUodmFsdWUpKSB7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdmFsdWUgPSB2YWx1ZS5jb25zdHJ1Y3RvcjtcbiAgICB9XG5cbiAgICB2YXIgb3JpZ2luID0gX2F1cmVsaWFNZXRhZGF0YS5PcmlnaW4uZ2V0KHZhbHVlKTtcbiAgICB2YXIgc3RyYXRlZ3kgPSBfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLmdldChWaWV3TG9jYXRvci52aWV3U3RyYXRlZ3lNZXRhZGF0YUtleSwgdmFsdWUpO1xuXG4gICAgaWYgKCFzdHJhdGVneSkge1xuICAgICAgaWYgKCFvcmlnaW4pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgZGV0ZXJtaW50ZSBkZWZhdWx0IHZpZXcgc3RyYXRlZ3kgZm9yIG9iamVjdC4nLCB2YWx1ZSk7XG4gICAgICB9XG5cbiAgICAgIHN0cmF0ZWd5ID0gdGhpcy5jcmVhdGVGYWxsYmFja1ZpZXdTdHJhdGVneShvcmlnaW4pO1xuICAgIH0gZWxzZSBpZiAob3JpZ2luKSB7XG4gICAgICBzdHJhdGVneS5tb2R1bGVJZCA9IG9yaWdpbi5tb2R1bGVJZDtcbiAgICB9XG5cbiAgICByZXR1cm4gc3RyYXRlZ3k7XG4gIH07XG5cbiAgVmlld0xvY2F0b3IucHJvdG90eXBlLmNyZWF0ZUZhbGxiYWNrVmlld1N0cmF0ZWd5ID0gZnVuY3Rpb24gY3JlYXRlRmFsbGJhY2tWaWV3U3RyYXRlZ3kob3JpZ2luKSB7XG4gICAgcmV0dXJuIG5ldyBDb252ZW50aW9uYWxWaWV3U3RyYXRlZ3kodGhpcywgb3JpZ2luKTtcbiAgfTtcblxuICBWaWV3TG9jYXRvci5wcm90b3R5cGUuY29udmVydE9yaWdpblRvVmlld1VybCA9IGZ1bmN0aW9uIGNvbnZlcnRPcmlnaW5Ub1ZpZXdVcmwob3JpZ2luKSB7XG4gICAgdmFyIG1vZHVsZUlkID0gb3JpZ2luLm1vZHVsZUlkO1xuICAgIHZhciBpZCA9IG1vZHVsZUlkLmVuZHNXaXRoKCcuanMnKSB8fCBtb2R1bGVJZC5lbmRzV2l0aCgnLnRzJykgPyBtb2R1bGVJZC5zdWJzdHJpbmcoMCwgbW9kdWxlSWQubGVuZ3RoIC0gMykgOiBtb2R1bGVJZDtcbiAgICByZXR1cm4gaWQgKyAnLmh0bWwnO1xuICB9O1xuXG4gIHJldHVybiBWaWV3TG9jYXRvcjtcbn0oKSwgX2NsYXNzOS52aWV3U3RyYXRlZ3lNZXRhZGF0YUtleSA9ICdhdXJlbGlhOnZpZXctc3RyYXRlZ3knLCBfdGVtcDIpO1xuXG52YXIgQmluZGluZ0xhbmd1YWdlID0gZXhwb3J0cy5CaW5kaW5nTGFuZ3VhZ2UgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEJpbmRpbmdMYW5ndWFnZSgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQmluZGluZ0xhbmd1YWdlKTtcbiAgfVxuXG4gIEJpbmRpbmdMYW5ndWFnZS5wcm90b3R5cGUuaW5zcGVjdEF0dHJpYnV0ZSA9IGZ1bmN0aW9uIGluc3BlY3RBdHRyaWJ1dGUocmVzb3VyY2VzLCBlbGVtZW50TmFtZSwgYXR0ck5hbWUsIGF0dHJWYWx1ZSkge1xuICAgIHRocm93IG5ldyBFcnJvcignQSBCaW5kaW5nTGFuZ3VhZ2UgbXVzdCBpbXBsZW1lbnQgaW5zcGVjdEF0dHJpYnV0ZSguLi4pJyk7XG4gIH07XG5cbiAgQmluZGluZ0xhbmd1YWdlLnByb3RvdHlwZS5jcmVhdGVBdHRyaWJ1dGVJbnN0cnVjdGlvbiA9IGZ1bmN0aW9uIGNyZWF0ZUF0dHJpYnV0ZUluc3RydWN0aW9uKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbikge1xuICAgIHRocm93IG5ldyBFcnJvcignQSBCaW5kaW5nTGFuZ3VhZ2UgbXVzdCBpbXBsZW1lbnQgY3JlYXRlQXR0cmlidXRlSW5zdHJ1Y3Rpb24oLi4uKScpO1xuICB9O1xuXG4gIEJpbmRpbmdMYW5ndWFnZS5wcm90b3R5cGUuaW5zcGVjdFRleHRDb250ZW50ID0gZnVuY3Rpb24gaW5zcGVjdFRleHRDb250ZW50KHJlc291cmNlcywgdmFsdWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0EgQmluZGluZ0xhbmd1YWdlIG11c3QgaW1wbGVtZW50IGluc3BlY3RUZXh0Q29udGVudCguLi4pJyk7XG4gIH07XG5cbiAgcmV0dXJuIEJpbmRpbmdMYW5ndWFnZTtcbn0oKTtcblxuZnVuY3Rpb24gcmVnaXN0ZXIobG9va3VwLCBuYW1lLCByZXNvdXJjZSwgdHlwZSkge1xuICBpZiAoIW5hbWUpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgZXhpc3RpbmcgPSBsb29rdXBbbmFtZV07XG4gIGlmIChleGlzdGluZykge1xuICAgIGlmIChleGlzdGluZyAhPT0gcmVzb3VyY2UpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQXR0ZW1wdGVkIHRvIHJlZ2lzdGVyICcgKyB0eXBlICsgJyB3aGVuIG9uZSB3aXRoIHRoZSBzYW1lIG5hbWUgYWxyZWFkeSBleGlzdHMuIE5hbWU6ICcgKyBuYW1lICsgJy4nKTtcbiAgICB9XG5cbiAgICByZXR1cm47XG4gIH1cblxuICBsb29rdXBbbmFtZV0gPSByZXNvdXJjZTtcbn1cblxudmFyIFZpZXdSZXNvdXJjZXMgPSBleHBvcnRzLlZpZXdSZXNvdXJjZXMgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFZpZXdSZXNvdXJjZXMocGFyZW50LCB2aWV3VXJsKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpZXdSZXNvdXJjZXMpO1xuXG4gICAgdGhpcy5iaW5kaW5nTGFuZ3VhZ2UgPSBudWxsO1xuXG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQgfHwgbnVsbDtcbiAgICB0aGlzLmhhc1BhcmVudCA9IHRoaXMucGFyZW50ICE9PSBudWxsO1xuICAgIHRoaXMudmlld1VybCA9IHZpZXdVcmwgfHwgJyc7XG4gICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSB7XG4gICAgICB2YWx1ZUNvbnZlcnRlcnM6IHRoaXMuZ2V0VmFsdWVDb252ZXJ0ZXIuYmluZCh0aGlzKSxcbiAgICAgIGJpbmRpbmdCZWhhdmlvcnM6IHRoaXMuZ2V0QmluZGluZ0JlaGF2aW9yLmJpbmQodGhpcylcbiAgICB9O1xuICAgIHRoaXMuYXR0cmlidXRlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgdGhpcy5lbGVtZW50cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgdGhpcy52YWx1ZUNvbnZlcnRlcnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIHRoaXMuYmluZGluZ0JlaGF2aW9ycyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgdGhpcy5hdHRyaWJ1dGVNYXAgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIHRoaXMuYmVmb3JlQ29tcGlsZSA9IHRoaXMuYWZ0ZXJDb21waWxlID0gdGhpcy5iZWZvcmVDcmVhdGUgPSB0aGlzLmFmdGVyQ3JlYXRlID0gdGhpcy5iZWZvcmVCaW5kID0gdGhpcy5iZWZvcmVVbmJpbmQgPSBmYWxzZTtcbiAgfVxuXG4gIFZpZXdSZXNvdXJjZXMucHJvdG90eXBlLl90cnlBZGRIb29rID0gZnVuY3Rpb24gX3RyeUFkZEhvb2sob2JqLCBuYW1lKSB7XG4gICAgaWYgKHR5cGVvZiBvYmpbbmFtZV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHZhciBmdW5jID0gb2JqW25hbWVdLmJpbmQob2JqKTtcbiAgICAgIHZhciBjb3VudGVyID0gMTtcbiAgICAgIHZhciBjYWxsYmFja05hbWUgPSB2b2lkIDA7XG5cbiAgICAgIHdoaWxlICh0aGlzW2NhbGxiYWNrTmFtZSA9IG5hbWUgKyBjb3VudGVyLnRvU3RyaW5nKCldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY291bnRlcisrO1xuICAgICAgfVxuXG4gICAgICB0aGlzW25hbWVdID0gdHJ1ZTtcbiAgICAgIHRoaXNbY2FsbGJhY2tOYW1lXSA9IGZ1bmM7XG4gICAgfVxuICB9O1xuXG4gIFZpZXdSZXNvdXJjZXMucHJvdG90eXBlLl9pbnZva2VIb29rID0gZnVuY3Rpb24gX2ludm9rZUhvb2sobmFtZSwgb25lLCB0d28sIHRocmVlLCBmb3VyKSB7XG4gICAgaWYgKHRoaXMuaGFzUGFyZW50KSB7XG4gICAgICB0aGlzLnBhcmVudC5faW52b2tlSG9vayhuYW1lLCBvbmUsIHR3bywgdGhyZWUsIGZvdXIpO1xuICAgIH1cblxuICAgIGlmICh0aGlzW25hbWVdKSB7XG4gICAgICB0aGlzW25hbWUgKyAnMSddKG9uZSwgdHdvLCB0aHJlZSwgZm91cik7XG5cbiAgICAgIHZhciBjYWxsYmFja05hbWUgPSBuYW1lICsgJzInO1xuICAgICAgaWYgKHRoaXNbY2FsbGJhY2tOYW1lXSkge1xuICAgICAgICB0aGlzW2NhbGxiYWNrTmFtZV0ob25lLCB0d28sIHRocmVlLCBmb3VyKTtcblxuICAgICAgICBjYWxsYmFja05hbWUgPSBuYW1lICsgJzMnO1xuICAgICAgICBpZiAodGhpc1tjYWxsYmFja05hbWVdKSB7XG4gICAgICAgICAgdGhpc1tjYWxsYmFja05hbWVdKG9uZSwgdHdvLCB0aHJlZSwgZm91cik7XG5cbiAgICAgICAgICB2YXIgY291bnRlciA9IDQ7XG5cbiAgICAgICAgICB3aGlsZSAodGhpc1tjYWxsYmFja05hbWUgPSBuYW1lICsgY291bnRlci50b1N0cmluZygpXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzW2NhbGxiYWNrTmFtZV0ob25lLCB0d28sIHRocmVlLCBmb3VyKTtcbiAgICAgICAgICAgIGNvdW50ZXIrKztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgVmlld1Jlc291cmNlcy5wcm90b3R5cGUucmVnaXN0ZXJWaWV3RW5naW5lSG9va3MgPSBmdW5jdGlvbiByZWdpc3RlclZpZXdFbmdpbmVIb29rcyhob29rcykge1xuICAgIHRoaXMuX3RyeUFkZEhvb2soaG9va3MsICdiZWZvcmVDb21waWxlJyk7XG4gICAgdGhpcy5fdHJ5QWRkSG9vayhob29rcywgJ2FmdGVyQ29tcGlsZScpO1xuICAgIHRoaXMuX3RyeUFkZEhvb2soaG9va3MsICdiZWZvcmVDcmVhdGUnKTtcbiAgICB0aGlzLl90cnlBZGRIb29rKGhvb2tzLCAnYWZ0ZXJDcmVhdGUnKTtcbiAgICB0aGlzLl90cnlBZGRIb29rKGhvb2tzLCAnYmVmb3JlQmluZCcpO1xuICAgIHRoaXMuX3RyeUFkZEhvb2soaG9va3MsICdiZWZvcmVVbmJpbmQnKTtcbiAgfTtcblxuICBWaWV3UmVzb3VyY2VzLnByb3RvdHlwZS5nZXRCaW5kaW5nTGFuZ3VhZ2UgPSBmdW5jdGlvbiBnZXRCaW5kaW5nTGFuZ3VhZ2UoYmluZGluZ0xhbmd1YWdlRmFsbGJhY2spIHtcbiAgICByZXR1cm4gdGhpcy5iaW5kaW5nTGFuZ3VhZ2UgfHwgKHRoaXMuYmluZGluZ0xhbmd1YWdlID0gYmluZGluZ0xhbmd1YWdlRmFsbGJhY2spO1xuICB9O1xuXG4gIFZpZXdSZXNvdXJjZXMucHJvdG90eXBlLnBhdGNoSW5QYXJlbnQgPSBmdW5jdGlvbiBwYXRjaEluUGFyZW50KG5ld1BhcmVudCkge1xuICAgIHZhciBvcmlnaW5hbFBhcmVudCA9IHRoaXMucGFyZW50O1xuXG4gICAgdGhpcy5wYXJlbnQgPSBuZXdQYXJlbnQgfHwgbnVsbDtcbiAgICB0aGlzLmhhc1BhcmVudCA9IHRoaXMucGFyZW50ICE9PSBudWxsO1xuXG4gICAgaWYgKG5ld1BhcmVudC5wYXJlbnQgPT09IG51bGwpIHtcbiAgICAgIG5ld1BhcmVudC5wYXJlbnQgPSBvcmlnaW5hbFBhcmVudDtcbiAgICAgIG5ld1BhcmVudC5oYXNQYXJlbnQgPSBvcmlnaW5hbFBhcmVudCAhPT0gbnVsbDtcbiAgICB9XG4gIH07XG5cbiAgVmlld1Jlc291cmNlcy5wcm90b3R5cGUucmVsYXRpdmVUb1ZpZXcgPSBmdW5jdGlvbiByZWxhdGl2ZVRvVmlldyhwYXRoKSB7XG4gICAgcmV0dXJuICgwLCBfYXVyZWxpYVBhdGgucmVsYXRpdmVUb0ZpbGUpKHBhdGgsIHRoaXMudmlld1VybCk7XG4gIH07XG5cbiAgVmlld1Jlc291cmNlcy5wcm90b3R5cGUucmVnaXN0ZXJFbGVtZW50ID0gZnVuY3Rpb24gcmVnaXN0ZXJFbGVtZW50KHRhZ05hbWUsIGJlaGF2aW9yKSB7XG4gICAgcmVnaXN0ZXIodGhpcy5lbGVtZW50cywgdGFnTmFtZSwgYmVoYXZpb3IsICdhbiBFbGVtZW50Jyk7XG4gIH07XG5cbiAgVmlld1Jlc291cmNlcy5wcm90b3R5cGUuZ2V0RWxlbWVudCA9IGZ1bmN0aW9uIGdldEVsZW1lbnQodGFnTmFtZSkge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnRzW3RhZ05hbWVdIHx8ICh0aGlzLmhhc1BhcmVudCA/IHRoaXMucGFyZW50LmdldEVsZW1lbnQodGFnTmFtZSkgOiBudWxsKTtcbiAgfTtcblxuICBWaWV3UmVzb3VyY2VzLnByb3RvdHlwZS5tYXBBdHRyaWJ1dGUgPSBmdW5jdGlvbiBtYXBBdHRyaWJ1dGUoYXR0cmlidXRlKSB7XG4gICAgcmV0dXJuIHRoaXMuYXR0cmlidXRlTWFwW2F0dHJpYnV0ZV0gfHwgKHRoaXMuaGFzUGFyZW50ID8gdGhpcy5wYXJlbnQubWFwQXR0cmlidXRlKGF0dHJpYnV0ZSkgOiBudWxsKTtcbiAgfTtcblxuICBWaWV3UmVzb3VyY2VzLnByb3RvdHlwZS5yZWdpc3RlckF0dHJpYnV0ZSA9IGZ1bmN0aW9uIHJlZ2lzdGVyQXR0cmlidXRlKGF0dHJpYnV0ZSwgYmVoYXZpb3IsIGtub3duQXR0cmlidXRlKSB7XG4gICAgdGhpcy5hdHRyaWJ1dGVNYXBbYXR0cmlidXRlXSA9IGtub3duQXR0cmlidXRlO1xuICAgIHJlZ2lzdGVyKHRoaXMuYXR0cmlidXRlcywgYXR0cmlidXRlLCBiZWhhdmlvciwgJ2FuIEF0dHJpYnV0ZScpO1xuICB9O1xuXG4gIFZpZXdSZXNvdXJjZXMucHJvdG90eXBlLmdldEF0dHJpYnV0ZSA9IGZ1bmN0aW9uIGdldEF0dHJpYnV0ZShhdHRyaWJ1dGUpIHtcbiAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGVzW2F0dHJpYnV0ZV0gfHwgKHRoaXMuaGFzUGFyZW50ID8gdGhpcy5wYXJlbnQuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZSkgOiBudWxsKTtcbiAgfTtcblxuICBWaWV3UmVzb3VyY2VzLnByb3RvdHlwZS5yZWdpc3RlclZhbHVlQ29udmVydGVyID0gZnVuY3Rpb24gcmVnaXN0ZXJWYWx1ZUNvbnZlcnRlcihuYW1lLCB2YWx1ZUNvbnZlcnRlcikge1xuICAgIHJlZ2lzdGVyKHRoaXMudmFsdWVDb252ZXJ0ZXJzLCBuYW1lLCB2YWx1ZUNvbnZlcnRlciwgJ2EgVmFsdWVDb252ZXJ0ZXInKTtcbiAgfTtcblxuICBWaWV3UmVzb3VyY2VzLnByb3RvdHlwZS5nZXRWYWx1ZUNvbnZlcnRlciA9IGZ1bmN0aW9uIGdldFZhbHVlQ29udmVydGVyKG5hbWUpIHtcbiAgICByZXR1cm4gdGhpcy52YWx1ZUNvbnZlcnRlcnNbbmFtZV0gfHwgKHRoaXMuaGFzUGFyZW50ID8gdGhpcy5wYXJlbnQuZ2V0VmFsdWVDb252ZXJ0ZXIobmFtZSkgOiBudWxsKTtcbiAgfTtcblxuICBWaWV3UmVzb3VyY2VzLnByb3RvdHlwZS5yZWdpc3RlckJpbmRpbmdCZWhhdmlvciA9IGZ1bmN0aW9uIHJlZ2lzdGVyQmluZGluZ0JlaGF2aW9yKG5hbWUsIGJpbmRpbmdCZWhhdmlvcikge1xuICAgIHJlZ2lzdGVyKHRoaXMuYmluZGluZ0JlaGF2aW9ycywgbmFtZSwgYmluZGluZ0JlaGF2aW9yLCAnYSBCaW5kaW5nQmVoYXZpb3InKTtcbiAgfTtcblxuICBWaWV3UmVzb3VyY2VzLnByb3RvdHlwZS5nZXRCaW5kaW5nQmVoYXZpb3IgPSBmdW5jdGlvbiBnZXRCaW5kaW5nQmVoYXZpb3IobmFtZSkge1xuICAgIHJldHVybiB0aGlzLmJpbmRpbmdCZWhhdmlvcnNbbmFtZV0gfHwgKHRoaXMuaGFzUGFyZW50ID8gdGhpcy5wYXJlbnQuZ2V0QmluZGluZ0JlaGF2aW9yKG5hbWUpIDogbnVsbCk7XG4gIH07XG5cbiAgcmV0dXJuIFZpZXdSZXNvdXJjZXM7XG59KCk7XG5cbnZhciBWaWV3ID0gZXhwb3J0cy5WaWV3ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBWaWV3KGNvbnRhaW5lciwgdmlld0ZhY3RvcnksIGZyYWdtZW50LCBjb250cm9sbGVycywgYmluZGluZ3MsIGNoaWxkcmVuLCBjb250ZW50U2VsZWN0b3JzKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpZXcpO1xuXG4gICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG4gICAgdGhpcy52aWV3RmFjdG9yeSA9IHZpZXdGYWN0b3J5O1xuICAgIHRoaXMucmVzb3VyY2VzID0gdmlld0ZhY3RvcnkucmVzb3VyY2VzO1xuICAgIHRoaXMuZnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgICB0aGlzLmNvbnRyb2xsZXJzID0gY29udHJvbGxlcnM7XG4gICAgdGhpcy5iaW5kaW5ncyA9IGJpbmRpbmdzO1xuICAgIHRoaXMuY2hpbGRyZW4gPSBjaGlsZHJlbjtcbiAgICB0aGlzLmNvbnRlbnRTZWxlY3RvcnMgPSBjb250ZW50U2VsZWN0b3JzO1xuICAgIHRoaXMuZmlyc3RDaGlsZCA9IGZyYWdtZW50LmZpcnN0Q2hpbGQ7XG4gICAgdGhpcy5sYXN0Q2hpbGQgPSBmcmFnbWVudC5sYXN0Q2hpbGQ7XG4gICAgdGhpcy5mcm9tQ2FjaGUgPSBmYWxzZTtcbiAgICB0aGlzLmlzQm91bmQgPSBmYWxzZTtcbiAgICB0aGlzLmlzQXR0YWNoZWQgPSBmYWxzZTtcbiAgICB0aGlzLmZyb21DYWNoZSA9IGZhbHNlO1xuICAgIHRoaXMuYmluZGluZ0NvbnRleHQgPSBudWxsO1xuICAgIHRoaXMub3ZlcnJpZGVDb250ZXh0ID0gbnVsbDtcbiAgICB0aGlzLmNvbnRyb2xsZXIgPSBudWxsO1xuICAgIHRoaXMudmlld01vZGVsU2NvcGUgPSBudWxsO1xuICAgIHRoaXMuX2lzVXNlckNvbnRyb2xsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIFZpZXcucHJvdG90eXBlLnJldHVyblRvQ2FjaGUgPSBmdW5jdGlvbiByZXR1cm5Ub0NhY2hlKCkge1xuICAgIHRoaXMudmlld0ZhY3RvcnkucmV0dXJuVmlld1RvQ2FjaGUodGhpcyk7XG4gIH07XG5cbiAgVmlldy5wcm90b3R5cGUuY3JlYXRlZCA9IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7XG4gICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgdmFyIGlpID0gdm9pZCAwO1xuICAgIHZhciBjb250cm9sbGVycyA9IHRoaXMuY29udHJvbGxlcnM7XG5cbiAgICBmb3IgKGkgPSAwLCBpaSA9IGNvbnRyb2xsZXJzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGNvbnRyb2xsZXJzW2ldLmNyZWF0ZWQodGhpcyk7XG4gICAgfVxuICB9O1xuXG4gIFZpZXcucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiBiaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQsIF9zeXN0ZW1VcGRhdGUpIHtcbiAgICB2YXIgY29udHJvbGxlcnMgPSB2b2lkIDA7XG4gICAgdmFyIGJpbmRpbmdzID0gdm9pZCAwO1xuICAgIHZhciBjaGlsZHJlbiA9IHZvaWQgMDtcbiAgICB2YXIgaSA9IHZvaWQgMDtcbiAgICB2YXIgaWkgPSB2b2lkIDA7XG5cbiAgICBpZiAoX3N5c3RlbVVwZGF0ZSAmJiB0aGlzLl9pc1VzZXJDb250cm9sbGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNCb3VuZCkge1xuICAgICAgaWYgKHRoaXMuYmluZGluZ0NvbnRleHQgPT09IGJpbmRpbmdDb250ZXh0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy51bmJpbmQoKTtcbiAgICB9XG5cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuYmluZGluZ0NvbnRleHQgPSBiaW5kaW5nQ29udGV4dDtcbiAgICB0aGlzLm92ZXJyaWRlQ29udGV4dCA9IG92ZXJyaWRlQ29udGV4dCB8fCAoMCwgX2F1cmVsaWFCaW5kaW5nLmNyZWF0ZU92ZXJyaWRlQ29udGV4dCkoYmluZGluZ0NvbnRleHQpO1xuXG4gICAgdGhpcy5yZXNvdXJjZXMuX2ludm9rZUhvb2soJ2JlZm9yZUJpbmQnLCB0aGlzKTtcblxuICAgIGJpbmRpbmdzID0gdGhpcy5iaW5kaW5ncztcbiAgICBmb3IgKGkgPSAwLCBpaSA9IGJpbmRpbmdzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGJpbmRpbmdzW2ldLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMudmlld01vZGVsU2NvcGUgIT09IG51bGwpIHtcbiAgICAgIGJpbmRpbmdDb250ZXh0LmJpbmQodGhpcy52aWV3TW9kZWxTY29wZS5iaW5kaW5nQ29udGV4dCwgdGhpcy52aWV3TW9kZWxTY29wZS5vdmVycmlkZUNvbnRleHQpO1xuICAgICAgdGhpcy52aWV3TW9kZWxTY29wZSA9IG51bGw7XG4gICAgfVxuXG4gICAgY29udHJvbGxlcnMgPSB0aGlzLmNvbnRyb2xsZXJzO1xuICAgIGZvciAoaSA9IDAsIGlpID0gY29udHJvbGxlcnMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgY29udHJvbGxlcnNbaV0uYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47XG4gICAgZm9yIChpID0gMCwgaWkgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBjaGlsZHJlbltpXS5iaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQsIHRydWUpO1xuICAgIH1cbiAgfTtcblxuICBWaWV3LnByb3RvdHlwZS5hZGRCaW5kaW5nID0gZnVuY3Rpb24gYWRkQmluZGluZyhiaW5kaW5nKSB7XG4gICAgdGhpcy5iaW5kaW5ncy5wdXNoKGJpbmRpbmcpO1xuXG4gICAgaWYgKHRoaXMuaXNCb3VuZCkge1xuICAgICAgYmluZGluZy5iaW5kKHRoaXMpO1xuICAgIH1cbiAgfTtcblxuICBWaWV3LnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiB1bmJpbmQoKSB7XG4gICAgdmFyIGNvbnRyb2xsZXJzID0gdm9pZCAwO1xuICAgIHZhciBiaW5kaW5ncyA9IHZvaWQgMDtcbiAgICB2YXIgY2hpbGRyZW4gPSB2b2lkIDA7XG4gICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgdmFyIGlpID0gdm9pZCAwO1xuXG4gICAgaWYgKHRoaXMuaXNCb3VuZCkge1xuICAgICAgdGhpcy5pc0JvdW5kID0gZmFsc2U7XG4gICAgICB0aGlzLnJlc291cmNlcy5faW52b2tlSG9vaygnYmVmb3JlVW5iaW5kJywgdGhpcyk7XG5cbiAgICAgIGlmICh0aGlzLmNvbnRyb2xsZXIgIT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5jb250cm9sbGVyLnVuYmluZCgpO1xuICAgICAgfVxuXG4gICAgICBiaW5kaW5ncyA9IHRoaXMuYmluZGluZ3M7XG4gICAgICBmb3IgKGkgPSAwLCBpaSA9IGJpbmRpbmdzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgYmluZGluZ3NbaV0udW5iaW5kKCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnRyb2xsZXJzID0gdGhpcy5jb250cm9sbGVycztcbiAgICAgIGZvciAoaSA9IDAsIGlpID0gY29udHJvbGxlcnMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBjb250cm9sbGVyc1tpXS51bmJpbmQoKTtcbiAgICAgIH1cblxuICAgICAgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuO1xuICAgICAgZm9yIChpID0gMCwgaWkgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgIGNoaWxkcmVuW2ldLnVuYmluZCgpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmJpbmRpbmdDb250ZXh0ID0gbnVsbDtcbiAgICAgIHRoaXMub3ZlcnJpZGVDb250ZXh0ID0gbnVsbDtcbiAgICB9XG4gIH07XG5cbiAgVmlldy5wcm90b3R5cGUuaW5zZXJ0Tm9kZXNCZWZvcmUgPSBmdW5jdGlvbiBpbnNlcnROb2Rlc0JlZm9yZShyZWZOb2RlKSB7XG4gICAgdmFyIHBhcmVudCA9IHJlZk5vZGUucGFyZW50Tm9kZTtcbiAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKHRoaXMuZnJhZ21lbnQsIHJlZk5vZGUpO1xuICB9O1xuXG4gIFZpZXcucHJvdG90eXBlLmFwcGVuZE5vZGVzVG8gPSBmdW5jdGlvbiBhcHBlbmROb2Rlc1RvKHBhcmVudCkge1xuICAgIHBhcmVudC5hcHBlbmRDaGlsZCh0aGlzLmZyYWdtZW50KTtcbiAgfTtcblxuICBWaWV3LnByb3RvdHlwZS5yZW1vdmVOb2RlcyA9IGZ1bmN0aW9uIHJlbW92ZU5vZGVzKCkge1xuICAgIHZhciBzdGFydCA9IHRoaXMuZmlyc3RDaGlsZDtcbiAgICB2YXIgZW5kID0gdGhpcy5sYXN0Q2hpbGQ7XG4gICAgdmFyIGZyYWdtZW50ID0gdGhpcy5mcmFnbWVudDtcbiAgICB2YXIgbmV4dCA9IHZvaWQgMDtcbiAgICB2YXIgY3VycmVudCA9IHN0YXJ0O1xuICAgIHZhciBsb29wID0gdHJ1ZTtcblxuICAgIHdoaWxlIChsb29wKSB7XG4gICAgICBpZiAoY3VycmVudCA9PT0gZW5kKSB7XG4gICAgICAgIGxvb3AgPSBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgbmV4dCA9IGN1cnJlbnQubmV4dFNpYmxpbmc7XG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChjdXJyZW50KTtcbiAgICAgIGN1cnJlbnQgPSBuZXh0O1xuICAgIH1cbiAgfTtcblxuICBWaWV3LnByb3RvdHlwZS5hdHRhY2hlZCA9IGZ1bmN0aW9uIGF0dGFjaGVkKCkge1xuICAgIHZhciBjb250cm9sbGVycyA9IHZvaWQgMDtcbiAgICB2YXIgY2hpbGRyZW4gPSB2b2lkIDA7XG4gICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgdmFyIGlpID0gdm9pZCAwO1xuXG4gICAgaWYgKHRoaXMuaXNBdHRhY2hlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuaXNBdHRhY2hlZCA9IHRydWU7XG5cbiAgICBpZiAodGhpcy5jb250cm9sbGVyICE9PSBudWxsKSB7XG4gICAgICB0aGlzLmNvbnRyb2xsZXIuYXR0YWNoZWQoKTtcbiAgICB9XG5cbiAgICBjb250cm9sbGVycyA9IHRoaXMuY29udHJvbGxlcnM7XG4gICAgZm9yIChpID0gMCwgaWkgPSBjb250cm9sbGVycy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBjb250cm9sbGVyc1tpXS5hdHRhY2hlZCgpO1xuICAgIH1cblxuICAgIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjtcbiAgICBmb3IgKGkgPSAwLCBpaSA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGNoaWxkcmVuW2ldLmF0dGFjaGVkKCk7XG4gICAgfVxuICB9O1xuXG4gIFZpZXcucHJvdG90eXBlLmRldGFjaGVkID0gZnVuY3Rpb24gZGV0YWNoZWQoKSB7XG4gICAgdmFyIGNvbnRyb2xsZXJzID0gdm9pZCAwO1xuICAgIHZhciBjaGlsZHJlbiA9IHZvaWQgMDtcbiAgICB2YXIgaSA9IHZvaWQgMDtcbiAgICB2YXIgaWkgPSB2b2lkIDA7XG5cbiAgICBpZiAodGhpcy5pc0F0dGFjaGVkKSB7XG4gICAgICB0aGlzLmlzQXR0YWNoZWQgPSBmYWxzZTtcblxuICAgICAgaWYgKHRoaXMuY29udHJvbGxlciAhPT0gbnVsbCkge1xuICAgICAgICB0aGlzLmNvbnRyb2xsZXIuZGV0YWNoZWQoKTtcbiAgICAgIH1cblxuICAgICAgY29udHJvbGxlcnMgPSB0aGlzLmNvbnRyb2xsZXJzO1xuICAgICAgZm9yIChpID0gMCwgaWkgPSBjb250cm9sbGVycy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgIGNvbnRyb2xsZXJzW2ldLmRldGFjaGVkKCk7XG4gICAgICB9XG5cbiAgICAgIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjtcbiAgICAgIGZvciAoaSA9IDAsIGlpID0gY2hpbGRyZW4ubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBjaGlsZHJlbltpXS5kZXRhY2hlZCgpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICByZXR1cm4gVmlldztcbn0oKTtcblxudmFyIHBsYWNlaG9sZGVyID0gW107XG5cbmZ1bmN0aW9uIGZpbmRJbnNlcnRpb25Qb2ludChncm91cHMsIGluZGV4KSB7XG4gIHZhciBpbnNlcnRpb25Qb2ludCA9IHZvaWQgMDtcblxuICB3aGlsZSAoIWluc2VydGlvblBvaW50ICYmIGluZGV4ID49IDApIHtcbiAgICBpbnNlcnRpb25Qb2ludCA9IGdyb3Vwc1tpbmRleF1bMF07XG4gICAgaW5kZXgtLTtcbiAgfVxuXG4gIHJldHVybiBpbnNlcnRpb25Qb2ludDtcbn1cblxudmFyIF9Db250ZW50U2VsZWN0b3IgPSBleHBvcnRzLl9Db250ZW50U2VsZWN0b3IgPSBmdW5jdGlvbiAoKSB7XG4gIF9Db250ZW50U2VsZWN0b3IuYXBwbHlTZWxlY3RvcnMgPSBmdW5jdGlvbiBhcHBseVNlbGVjdG9ycyh2aWV3LCBjb250ZW50U2VsZWN0b3JzLCBjYWxsYmFjaykge1xuICAgIHZhciBjdXJyZW50Q2hpbGQgPSB2aWV3LmZyYWdtZW50LmZpcnN0Q2hpbGQ7XG4gICAgdmFyIGNvbnRlbnRNYXAgPSBuZXcgTWFwKCk7XG4gICAgdmFyIG5leHRTaWJsaW5nID0gdm9pZCAwO1xuICAgIHZhciBpID0gdm9pZCAwO1xuICAgIHZhciBpaSA9IHZvaWQgMDtcbiAgICB2YXIgY29udGVudFNlbGVjdG9yID0gdm9pZCAwO1xuXG4gICAgd2hpbGUgKGN1cnJlbnRDaGlsZCkge1xuICAgICAgbmV4dFNpYmxpbmcgPSBjdXJyZW50Q2hpbGQubmV4dFNpYmxpbmc7XG5cbiAgICAgIGlmIChjdXJyZW50Q2hpbGQuaXNDb250ZW50UHJvamVjdGlvblNvdXJjZSkge1xuICAgICAgICB2YXIgdmlld1Nsb3RTZWxlY3RvcnMgPSBjb250ZW50U2VsZWN0b3JzLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgIHJldHVybiB4LmNvcHlGb3JWaWV3U2xvdCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgY3VycmVudENoaWxkLnZpZXdTbG90Ll9pbnN0YWxsQ29udGVudFNlbGVjdG9ycyh2aWV3U2xvdFNlbGVjdG9ycyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IGNvbnRlbnRTZWxlY3RvcnMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgICAgIGNvbnRlbnRTZWxlY3RvciA9IGNvbnRlbnRTZWxlY3RvcnNbaV07XG4gICAgICAgICAgaWYgKGNvbnRlbnRTZWxlY3Rvci5tYXRjaGVzKGN1cnJlbnRDaGlsZCkpIHtcbiAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IGNvbnRlbnRNYXAuZ2V0KGNvbnRlbnRTZWxlY3Rvcik7XG4gICAgICAgICAgICBpZiAoIWVsZW1lbnRzKSB7XG4gICAgICAgICAgICAgIGVsZW1lbnRzID0gW107XG4gICAgICAgICAgICAgIGNvbnRlbnRNYXAuc2V0KGNvbnRlbnRTZWxlY3RvciwgZWxlbWVudHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBlbGVtZW50cy5wdXNoKGN1cnJlbnRDaGlsZCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY3VycmVudENoaWxkID0gbmV4dFNpYmxpbmc7XG4gICAgfVxuXG4gICAgZm9yIChpID0gMCwgaWkgPSBjb250ZW50U2VsZWN0b3JzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGNvbnRlbnRTZWxlY3RvciA9IGNvbnRlbnRTZWxlY3RvcnNbaV07XG4gICAgICBjYWxsYmFjayhjb250ZW50U2VsZWN0b3IsIGNvbnRlbnRNYXAuZ2V0KGNvbnRlbnRTZWxlY3RvcikgfHwgcGxhY2Vob2xkZXIpO1xuICAgIH1cbiAgfTtcblxuICBmdW5jdGlvbiBfQ29udGVudFNlbGVjdG9yKGFuY2hvciwgc2VsZWN0b3IpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgX0NvbnRlbnRTZWxlY3Rvcik7XG5cbiAgICB0aGlzLmFuY2hvciA9IGFuY2hvcjtcbiAgICB0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3I7XG4gICAgdGhpcy5hbGwgPSAhdGhpcy5zZWxlY3RvcjtcbiAgICB0aGlzLmdyb3VwcyA9IFtdO1xuICB9XG5cbiAgX0NvbnRlbnRTZWxlY3Rvci5wcm90b3R5cGUuY29weUZvclZpZXdTbG90ID0gZnVuY3Rpb24gY29weUZvclZpZXdTbG90KCkge1xuICAgIHJldHVybiBuZXcgX0NvbnRlbnRTZWxlY3Rvcih0aGlzLmFuY2hvciwgdGhpcy5zZWxlY3Rvcik7XG4gIH07XG5cbiAgX0NvbnRlbnRTZWxlY3Rvci5wcm90b3R5cGUubWF0Y2hlcyA9IGZ1bmN0aW9uIG1hdGNoZXMobm9kZSkge1xuICAgIHJldHVybiB0aGlzLmFsbCB8fCBub2RlLm5vZGVUeXBlID09PSAxICYmIG5vZGUubWF0Y2hlcyh0aGlzLnNlbGVjdG9yKTtcbiAgfTtcblxuICBfQ29udGVudFNlbGVjdG9yLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiBhZGQoZ3JvdXApIHtcbiAgICB2YXIgYW5jaG9yID0gdGhpcy5hbmNob3I7XG4gICAgdmFyIHBhcmVudCA9IGFuY2hvci5wYXJlbnROb2RlO1xuICAgIHZhciBpID0gdm9pZCAwO1xuICAgIHZhciBpaSA9IHZvaWQgMDtcblxuICAgIGZvciAoaSA9IDAsIGlpID0gZ3JvdXAubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShncm91cFtpXSwgYW5jaG9yKTtcbiAgICB9XG5cbiAgICB0aGlzLmdyb3Vwcy5wdXNoKGdyb3VwKTtcbiAgfTtcblxuICBfQ29udGVudFNlbGVjdG9yLnByb3RvdHlwZS5pbnNlcnQgPSBmdW5jdGlvbiBpbnNlcnQoaW5kZXgsIGdyb3VwKSB7XG4gICAgaWYgKGdyb3VwLmxlbmd0aCkge1xuICAgICAgdmFyIGFuY2hvciA9IGZpbmRJbnNlcnRpb25Qb2ludCh0aGlzLmdyb3VwcywgaW5kZXgpIHx8IHRoaXMuYW5jaG9yO1xuICAgICAgdmFyIHBhcmVudCA9IGFuY2hvci5wYXJlbnROb2RlO1xuICAgICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgICB2YXIgaWkgPSB2b2lkIDA7XG5cbiAgICAgIGZvciAoaSA9IDAsIGlpID0gZ3JvdXAubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKGdyb3VwW2ldLCBhbmNob3IpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZ3JvdXBzLnNwbGljZShpbmRleCwgMCwgZ3JvdXApO1xuICB9O1xuXG4gIF9Db250ZW50U2VsZWN0b3IucHJvdG90eXBlLnJlbW92ZUF0ID0gZnVuY3Rpb24gcmVtb3ZlQXQoaW5kZXgsIGZyYWdtZW50KSB7XG4gICAgdmFyIGdyb3VwID0gdGhpcy5ncm91cHNbaW5kZXhdO1xuICAgIHZhciBpID0gdm9pZCAwO1xuICAgIHZhciBpaSA9IHZvaWQgMDtcblxuICAgIGZvciAoaSA9IDAsIGlpID0gZ3JvdXAubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoZ3JvdXBbaV0pO1xuICAgIH1cblxuICAgIHRoaXMuZ3JvdXBzLnNwbGljZShpbmRleCwgMSk7XG4gIH07XG5cbiAgcmV0dXJuIF9Db250ZW50U2VsZWN0b3I7XG59KCk7XG5cbmZ1bmN0aW9uIGdldEFuaW1hdGFibGVFbGVtZW50KHZpZXcpIHtcbiAgdmFyIGZpcnN0Q2hpbGQgPSB2aWV3LmZpcnN0Q2hpbGQ7XG5cbiAgaWYgKGZpcnN0Q2hpbGQgIT09IG51bGwgJiYgZmlyc3RDaGlsZCAhPT0gdW5kZWZpbmVkICYmIGZpcnN0Q2hpbGQubm9kZVR5cGUgPT09IDgpIHtcbiAgICB2YXIgX2VsZW1lbnQgPSBfYXVyZWxpYVBhbC5ET00ubmV4dEVsZW1lbnRTaWJsaW5nKGZpcnN0Q2hpbGQpO1xuXG4gICAgaWYgKF9lbGVtZW50ICE9PSBudWxsICYmIF9lbGVtZW50ICE9PSB1bmRlZmluZWQgJiYgX2VsZW1lbnQubm9kZVR5cGUgPT09IDEgJiYgX2VsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdhdS1hbmltYXRlJykpIHtcbiAgICAgIHJldHVybiBfZWxlbWVudDtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cblxudmFyIFZpZXdTbG90ID0gZXhwb3J0cy5WaWV3U2xvdCA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gVmlld1Nsb3QoYW5jaG9yLCBhbmNob3JJc0NvbnRhaW5lcikge1xuICAgIHZhciBhbmltYXRvciA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMiB8fCBhcmd1bWVudHNbMl0gPT09IHVuZGVmaW5lZCA/IEFuaW1hdG9yLmluc3RhbmNlIDogYXJndW1lbnRzWzJdO1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpZXdTbG90KTtcblxuICAgIHRoaXMuYW5jaG9yID0gYW5jaG9yO1xuICAgIHRoaXMudmlld0FkZE1ldGhvZCA9IGFuY2hvcklzQ29udGFpbmVyID8gJ2FwcGVuZE5vZGVzVG8nIDogJ2luc2VydE5vZGVzQmVmb3JlJztcbiAgICB0aGlzLmJpbmRpbmdDb250ZXh0ID0gbnVsbDtcbiAgICB0aGlzLm92ZXJyaWRlQ29udGV4dCA9IG51bGw7XG4gICAgdGhpcy5hbmltYXRvciA9IGFuaW1hdG9yO1xuICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcbiAgICB0aGlzLmlzQm91bmQgPSBmYWxzZTtcbiAgICB0aGlzLmlzQXR0YWNoZWQgPSBmYWxzZTtcbiAgICB0aGlzLmNvbnRlbnRTZWxlY3RvcnMgPSBudWxsO1xuICAgIGFuY2hvci52aWV3U2xvdCA9IHRoaXM7XG4gICAgYW5jaG9yLmlzQ29udGVudFByb2plY3Rpb25Tb3VyY2UgPSBmYWxzZTtcbiAgfVxuXG4gIFZpZXdTbG90LnByb3RvdHlwZS50cmFuc2Zvcm1DaGlsZE5vZGVzSW50b1ZpZXcgPSBmdW5jdGlvbiB0cmFuc2Zvcm1DaGlsZE5vZGVzSW50b1ZpZXcoKSB7XG4gICAgdmFyIHBhcmVudCA9IHRoaXMuYW5jaG9yO1xuXG4gICAgdGhpcy5jaGlsZHJlbi5wdXNoKHtcbiAgICAgIGZyYWdtZW50OiBwYXJlbnQsXG4gICAgICBmaXJzdENoaWxkOiBwYXJlbnQuZmlyc3RDaGlsZCxcbiAgICAgIGxhc3RDaGlsZDogcGFyZW50Lmxhc3RDaGlsZCxcbiAgICAgIHJldHVyblRvQ2FjaGU6IGZ1bmN0aW9uIHJldHVyblRvQ2FjaGUoKSB7fSxcbiAgICAgIHJlbW92ZU5vZGVzOiBmdW5jdGlvbiByZW1vdmVOb2RlcygpIHtcbiAgICAgICAgdmFyIGxhc3QgPSB2b2lkIDA7XG5cbiAgICAgICAgd2hpbGUgKGxhc3QgPSBwYXJlbnQubGFzdENoaWxkKSB7XG4gICAgICAgICAgcGFyZW50LnJlbW92ZUNoaWxkKGxhc3QpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHt9LFxuICAgICAgYmluZDogZnVuY3Rpb24gYmluZCgpIHt9LFxuICAgICAgdW5iaW5kOiBmdW5jdGlvbiB1bmJpbmQoKSB7fSxcbiAgICAgIGF0dGFjaGVkOiBmdW5jdGlvbiBhdHRhY2hlZCgpIHt9LFxuICAgICAgZGV0YWNoZWQ6IGZ1bmN0aW9uIGRldGFjaGVkKCkge31cbiAgICB9KTtcbiAgfTtcblxuICBWaWV3U2xvdC5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIGJpbmQoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCkge1xuICAgIHZhciBpID0gdm9pZCAwO1xuICAgIHZhciBpaSA9IHZvaWQgMDtcbiAgICB2YXIgY2hpbGRyZW4gPSB2b2lkIDA7XG5cbiAgICBpZiAodGhpcy5pc0JvdW5kKSB7XG4gICAgICBpZiAodGhpcy5iaW5kaW5nQ29udGV4dCA9PT0gYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnVuYmluZCgpO1xuICAgIH1cblxuICAgIHRoaXMuaXNCb3VuZCA9IHRydWU7XG4gICAgdGhpcy5iaW5kaW5nQ29udGV4dCA9IGJpbmRpbmdDb250ZXh0ID0gYmluZGluZ0NvbnRleHQgfHwgdGhpcy5iaW5kaW5nQ29udGV4dDtcbiAgICB0aGlzLm92ZXJyaWRlQ29udGV4dCA9IG92ZXJyaWRlQ29udGV4dCA9IG92ZXJyaWRlQ29udGV4dCB8fCB0aGlzLm92ZXJyaWRlQ29udGV4dDtcblxuICAgIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjtcbiAgICBmb3IgKGkgPSAwLCBpaSA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGNoaWxkcmVuW2ldLmJpbmQoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCwgdHJ1ZSk7XG4gICAgfVxuICB9O1xuXG4gIFZpZXdTbG90LnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiB1bmJpbmQoKSB7XG4gICAgaWYgKHRoaXMuaXNCb3VuZCkge1xuICAgICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgICB2YXIgaWkgPSB2b2lkIDA7XG4gICAgICB2YXIgX2NoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjtcblxuICAgICAgdGhpcy5pc0JvdW5kID0gZmFsc2U7XG4gICAgICB0aGlzLmJpbmRpbmdDb250ZXh0ID0gbnVsbDtcbiAgICAgIHRoaXMub3ZlcnJpZGVDb250ZXh0ID0gbnVsbDtcblxuICAgICAgZm9yIChpID0gMCwgaWkgPSBfY2hpbGRyZW4ubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBfY2hpbGRyZW5baV0udW5iaW5kKCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIFZpZXdTbG90LnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiBhZGQodmlldykge1xuICAgIHZpZXdbdGhpcy52aWV3QWRkTWV0aG9kXSh0aGlzLmFuY2hvcik7XG4gICAgdGhpcy5jaGlsZHJlbi5wdXNoKHZpZXcpO1xuXG4gICAgaWYgKHRoaXMuaXNBdHRhY2hlZCkge1xuICAgICAgdmlldy5hdHRhY2hlZCgpO1xuXG4gICAgICB2YXIgYW5pbWF0YWJsZUVsZW1lbnQgPSBnZXRBbmltYXRhYmxlRWxlbWVudCh2aWV3KTtcbiAgICAgIGlmIChhbmltYXRhYmxlRWxlbWVudCAhPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hbmltYXRvci5lbnRlcihhbmltYXRhYmxlRWxlbWVudCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIFZpZXdTbG90LnByb3RvdHlwZS5pbnNlcnQgPSBmdW5jdGlvbiBpbnNlcnQoaW5kZXgsIHZpZXcpIHtcbiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuO1xuICAgIHZhciBsZW5ndGggPSBjaGlsZHJlbi5sZW5ndGg7XG5cbiAgICBpZiAoaW5kZXggPT09IDAgJiYgbGVuZ3RoID09PSAwIHx8IGluZGV4ID49IGxlbmd0aCkge1xuICAgICAgcmV0dXJuIHRoaXMuYWRkKHZpZXcpO1xuICAgIH1cblxuICAgIHZpZXcuaW5zZXJ0Tm9kZXNCZWZvcmUoY2hpbGRyZW5baW5kZXhdLmZpcnN0Q2hpbGQpO1xuICAgIGNoaWxkcmVuLnNwbGljZShpbmRleCwgMCwgdmlldyk7XG5cbiAgICBpZiAodGhpcy5pc0F0dGFjaGVkKSB7XG4gICAgICB2aWV3LmF0dGFjaGVkKCk7XG5cbiAgICAgIHZhciBhbmltYXRhYmxlRWxlbWVudCA9IGdldEFuaW1hdGFibGVFbGVtZW50KHZpZXcpO1xuICAgICAgaWYgKGFuaW1hdGFibGVFbGVtZW50ICE9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFuaW1hdG9yLmVudGVyKGFuaW1hdGFibGVFbGVtZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgVmlld1Nsb3QucHJvdG90eXBlLm1vdmUgPSBmdW5jdGlvbiBtb3ZlKHNvdXJjZUluZGV4LCB0YXJnZXRJbmRleCkge1xuICAgIGlmIChzb3VyY2VJbmRleCA9PT0gdGFyZ2V0SW5kZXgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuO1xuICAgIHZhciB2aWV3ID0gY2hpbGRyZW5bc291cmNlSW5kZXhdO1xuXG4gICAgdmlldy5yZW1vdmVOb2RlcygpO1xuICAgIHZpZXcuaW5zZXJ0Tm9kZXNCZWZvcmUoY2hpbGRyZW5bdGFyZ2V0SW5kZXhdLmZpcnN0Q2hpbGQpO1xuICAgIGNoaWxkcmVuLnNwbGljZShzb3VyY2VJbmRleCwgMSk7XG4gICAgY2hpbGRyZW4uc3BsaWNlKHRhcmdldEluZGV4LCAwLCB2aWV3KTtcbiAgfTtcblxuICBWaWV3U2xvdC5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKHZpZXcsIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pIHtcbiAgICByZXR1cm4gdGhpcy5yZW1vdmVBdCh0aGlzLmNoaWxkcmVuLmluZGV4T2YodmlldyksIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pO1xuICB9O1xuXG4gIFZpZXdTbG90LnByb3RvdHlwZS5yZW1vdmVNYW55ID0gZnVuY3Rpb24gcmVtb3ZlTWFueSh2aWV3c1RvUmVtb3ZlLCByZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKSB7XG4gICAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuO1xuICAgIHZhciBpaSA9IHZpZXdzVG9SZW1vdmUubGVuZ3RoO1xuICAgIHZhciBpID0gdm9pZCAwO1xuICAgIHZhciBybVByb21pc2VzID0gW107XG5cbiAgICB2aWV3c1RvUmVtb3ZlLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICBpZiAoc2tpcEFuaW1hdGlvbikge1xuICAgICAgICBjaGlsZC5yZW1vdmVOb2RlcygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBhbmltYXRhYmxlRWxlbWVudCA9IGdldEFuaW1hdGFibGVFbGVtZW50KGNoaWxkKTtcbiAgICAgIGlmIChhbmltYXRhYmxlRWxlbWVudCAhPT0gbnVsbCkge1xuICAgICAgICBybVByb21pc2VzLnB1c2goX3RoaXM0LmFuaW1hdG9yLmxlYXZlKGFuaW1hdGFibGVFbGVtZW50KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gY2hpbGQucmVtb3ZlTm9kZXMoKTtcbiAgICAgICAgfSkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2hpbGQucmVtb3ZlTm9kZXMoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHZhciByZW1vdmVBY3Rpb24gPSBmdW5jdGlvbiByZW1vdmVBY3Rpb24oKSB7XG4gICAgICBpZiAoX3RoaXM0LmlzQXR0YWNoZWQpIHtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgICB2aWV3c1RvUmVtb3ZlW2ldLmRldGFjaGVkKCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHJldHVyblRvQ2FjaGUpIHtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgICB2aWV3c1RvUmVtb3ZlW2ldLnJldHVyblRvQ2FjaGUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmb3IgKGkgPSAwOyBpIDwgaWk7ICsraSkge1xuICAgICAgICB2YXIgaW5kZXggPSBjaGlsZHJlbi5pbmRleE9mKHZpZXdzVG9SZW1vdmVbaV0pO1xuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgIGNoaWxkcmVuLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaWYgKHJtUHJvbWlzZXMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHJtUHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gcmVtb3ZlQWN0aW9uKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZW1vdmVBY3Rpb24oKTtcbiAgfTtcblxuICBWaWV3U2xvdC5wcm90b3R5cGUucmVtb3ZlQXQgPSBmdW5jdGlvbiByZW1vdmVBdChpbmRleCwgcmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbikge1xuICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgdmFyIHZpZXcgPSB0aGlzLmNoaWxkcmVuW2luZGV4XTtcblxuICAgIHZhciByZW1vdmVBY3Rpb24gPSBmdW5jdGlvbiByZW1vdmVBY3Rpb24oKSB7XG4gICAgICBpbmRleCA9IF90aGlzNS5jaGlsZHJlbi5pbmRleE9mKHZpZXcpO1xuICAgICAgdmlldy5yZW1vdmVOb2RlcygpO1xuICAgICAgX3RoaXM1LmNoaWxkcmVuLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICAgIGlmIChfdGhpczUuaXNBdHRhY2hlZCkge1xuICAgICAgICB2aWV3LmRldGFjaGVkKCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChyZXR1cm5Ub0NhY2hlKSB7XG4gICAgICAgIHZpZXcucmV0dXJuVG9DYWNoZSgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdmlldztcbiAgICB9O1xuXG4gICAgaWYgKCFza2lwQW5pbWF0aW9uKSB7XG4gICAgICB2YXIgYW5pbWF0YWJsZUVsZW1lbnQgPSBnZXRBbmltYXRhYmxlRWxlbWVudCh2aWV3KTtcbiAgICAgIGlmIChhbmltYXRhYmxlRWxlbWVudCAhPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hbmltYXRvci5sZWF2ZShhbmltYXRhYmxlRWxlbWVudCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIHJlbW92ZUFjdGlvbigpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVtb3ZlQWN0aW9uKCk7XG4gIH07XG5cbiAgVmlld1Nsb3QucHJvdG90eXBlLnJlbW92ZUFsbCA9IGZ1bmN0aW9uIHJlbW92ZUFsbChyZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKSB7XG4gICAgdmFyIF90aGlzNiA9IHRoaXM7XG5cbiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuO1xuICAgIHZhciBpaSA9IGNoaWxkcmVuLmxlbmd0aDtcbiAgICB2YXIgaSA9IHZvaWQgMDtcbiAgICB2YXIgcm1Qcm9taXNlcyA9IFtdO1xuXG4gICAgY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgIGlmIChza2lwQW5pbWF0aW9uKSB7XG4gICAgICAgIGNoaWxkLnJlbW92ZU5vZGVzKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIGFuaW1hdGFibGVFbGVtZW50ID0gZ2V0QW5pbWF0YWJsZUVsZW1lbnQoY2hpbGQpO1xuICAgICAgaWYgKGFuaW1hdGFibGVFbGVtZW50ICE9PSBudWxsKSB7XG4gICAgICAgIHJtUHJvbWlzZXMucHVzaChfdGhpczYuYW5pbWF0b3IubGVhdmUoYW5pbWF0YWJsZUVsZW1lbnQpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBjaGlsZC5yZW1vdmVOb2RlcygpO1xuICAgICAgICB9KSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjaGlsZC5yZW1vdmVOb2RlcygpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdmFyIHJlbW92ZUFjdGlvbiA9IGZ1bmN0aW9uIHJlbW92ZUFjdGlvbigpIHtcbiAgICAgIGlmIChfdGhpczYuaXNBdHRhY2hlZCkge1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaWk7ICsraSkge1xuICAgICAgICAgIGNoaWxkcmVuW2ldLmRldGFjaGVkKCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHJldHVyblRvQ2FjaGUpIHtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgICBjaGlsZHJlbltpXS5yZXR1cm5Ub0NhY2hlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgX3RoaXM2LmNoaWxkcmVuID0gW107XG4gICAgfTtcblxuICAgIGlmIChybVByb21pc2VzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChybVByb21pc2VzKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHJlbW92ZUFjdGlvbigpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVtb3ZlQWN0aW9uKCk7XG4gIH07XG5cbiAgVmlld1Nsb3QucHJvdG90eXBlLmF0dGFjaGVkID0gZnVuY3Rpb24gYXR0YWNoZWQoKSB7XG4gICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgdmFyIGlpID0gdm9pZCAwO1xuICAgIHZhciBjaGlsZHJlbiA9IHZvaWQgMDtcbiAgICB2YXIgY2hpbGQgPSB2b2lkIDA7XG5cbiAgICBpZiAodGhpcy5pc0F0dGFjaGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5pc0F0dGFjaGVkID0gdHJ1ZTtcblxuICAgIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjtcbiAgICBmb3IgKGkgPSAwLCBpaSA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGNoaWxkID0gY2hpbGRyZW5baV07XG4gICAgICBjaGlsZC5hdHRhY2hlZCgpO1xuXG4gICAgICB2YXIgX2VsZW1lbnQyID0gY2hpbGQuZmlyc3RDaGlsZCA/IF9hdXJlbGlhUGFsLkRPTS5uZXh0RWxlbWVudFNpYmxpbmcoY2hpbGQuZmlyc3RDaGlsZCkgOiBudWxsO1xuICAgICAgaWYgKGNoaWxkLmZpcnN0Q2hpbGQgJiYgY2hpbGQuZmlyc3RDaGlsZC5ub2RlVHlwZSA9PT0gOCAmJiBfZWxlbWVudDIgJiYgX2VsZW1lbnQyLm5vZGVUeXBlID09PSAxICYmIF9lbGVtZW50Mi5jbGFzc0xpc3QuY29udGFpbnMoJ2F1LWFuaW1hdGUnKSkge1xuICAgICAgICB0aGlzLmFuaW1hdG9yLmVudGVyKF9lbGVtZW50Mik7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIFZpZXdTbG90LnByb3RvdHlwZS5kZXRhY2hlZCA9IGZ1bmN0aW9uIGRldGFjaGVkKCkge1xuICAgIHZhciBpID0gdm9pZCAwO1xuICAgIHZhciBpaSA9IHZvaWQgMDtcbiAgICB2YXIgY2hpbGRyZW4gPSB2b2lkIDA7XG5cbiAgICBpZiAodGhpcy5pc0F0dGFjaGVkKSB7XG4gICAgICB0aGlzLmlzQXR0YWNoZWQgPSBmYWxzZTtcbiAgICAgIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjtcbiAgICAgIGZvciAoaSA9IDAsIGlpID0gY2hpbGRyZW4ubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBjaGlsZHJlbltpXS5kZXRhY2hlZCgpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBWaWV3U2xvdC5wcm90b3R5cGUuX2luc3RhbGxDb250ZW50U2VsZWN0b3JzID0gZnVuY3Rpb24gX2luc3RhbGxDb250ZW50U2VsZWN0b3JzKGNvbnRlbnRTZWxlY3RvcnMpIHtcbiAgICB0aGlzLmNvbnRlbnRTZWxlY3RvcnMgPSBjb250ZW50U2VsZWN0b3JzO1xuICAgIHRoaXMuYWRkID0gdGhpcy5fY29udGVudFNlbGVjdG9yQWRkO1xuICAgIHRoaXMuaW5zZXJ0ID0gdGhpcy5fY29udGVudFNlbGVjdG9ySW5zZXJ0O1xuICAgIHRoaXMucmVtb3ZlID0gdGhpcy5fY29udGVudFNlbGVjdG9yUmVtb3ZlO1xuICAgIHRoaXMucmVtb3ZlQXQgPSB0aGlzLl9jb250ZW50U2VsZWN0b3JSZW1vdmVBdDtcbiAgICB0aGlzLnJlbW92ZUFsbCA9IHRoaXMuX2NvbnRlbnRTZWxlY3RvclJlbW92ZUFsbDtcbiAgfTtcblxuICBWaWV3U2xvdC5wcm90b3R5cGUuX2NvbnRlbnRTZWxlY3RvckFkZCA9IGZ1bmN0aW9uIF9jb250ZW50U2VsZWN0b3JBZGQodmlldykge1xuICAgIF9Db250ZW50U2VsZWN0b3IuYXBwbHlTZWxlY3RvcnModmlldywgdGhpcy5jb250ZW50U2VsZWN0b3JzLCBmdW5jdGlvbiAoY29udGVudFNlbGVjdG9yLCBncm91cCkge1xuICAgICAgcmV0dXJuIGNvbnRlbnRTZWxlY3Rvci5hZGQoZ3JvdXApO1xuICAgIH0pO1xuXG4gICAgdGhpcy5jaGlsZHJlbi5wdXNoKHZpZXcpO1xuXG4gICAgaWYgKHRoaXMuaXNBdHRhY2hlZCkge1xuICAgICAgdmlldy5hdHRhY2hlZCgpO1xuICAgIH1cbiAgfTtcblxuICBWaWV3U2xvdC5wcm90b3R5cGUuX2NvbnRlbnRTZWxlY3Rvckluc2VydCA9IGZ1bmN0aW9uIF9jb250ZW50U2VsZWN0b3JJbnNlcnQoaW5kZXgsIHZpZXcpIHtcbiAgICBpZiAoaW5kZXggPT09IDAgJiYgIXRoaXMuY2hpbGRyZW4ubGVuZ3RoIHx8IGluZGV4ID49IHRoaXMuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICB0aGlzLmFkZCh2aWV3KTtcbiAgICB9IGVsc2Uge1xuICAgICAgX0NvbnRlbnRTZWxlY3Rvci5hcHBseVNlbGVjdG9ycyh2aWV3LCB0aGlzLmNvbnRlbnRTZWxlY3RvcnMsIGZ1bmN0aW9uIChjb250ZW50U2VsZWN0b3IsIGdyb3VwKSB7XG4gICAgICAgIHJldHVybiBjb250ZW50U2VsZWN0b3IuaW5zZXJ0KGluZGV4LCBncm91cCk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDAsIHZpZXcpO1xuXG4gICAgICBpZiAodGhpcy5pc0F0dGFjaGVkKSB7XG4gICAgICAgIHZpZXcuYXR0YWNoZWQoKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgVmlld1Nsb3QucHJvdG90eXBlLl9jb250ZW50U2VsZWN0b3JSZW1vdmUgPSBmdW5jdGlvbiBfY29udGVudFNlbGVjdG9yUmVtb3ZlKHZpZXcpIHtcbiAgICB2YXIgaW5kZXggPSB0aGlzLmNoaWxkcmVuLmluZGV4T2Yodmlldyk7XG4gICAgdmFyIGNvbnRlbnRTZWxlY3RvcnMgPSB0aGlzLmNvbnRlbnRTZWxlY3RvcnM7XG4gICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgdmFyIGlpID0gdm9pZCAwO1xuXG4gICAgZm9yIChpID0gMCwgaWkgPSBjb250ZW50U2VsZWN0b3JzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGNvbnRlbnRTZWxlY3RvcnNbaV0ucmVtb3ZlQXQoaW5kZXgsIHZpZXcuZnJhZ21lbnQpO1xuICAgIH1cblxuICAgIHRoaXMuY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAxKTtcblxuICAgIGlmICh0aGlzLmlzQXR0YWNoZWQpIHtcbiAgICAgIHZpZXcuZGV0YWNoZWQoKTtcbiAgICB9XG4gIH07XG5cbiAgVmlld1Nsb3QucHJvdG90eXBlLl9jb250ZW50U2VsZWN0b3JSZW1vdmVBdCA9IGZ1bmN0aW9uIF9jb250ZW50U2VsZWN0b3JSZW1vdmVBdChpbmRleCkge1xuICAgIHZhciB2aWV3ID0gdGhpcy5jaGlsZHJlbltpbmRleF07XG4gICAgdmFyIGNvbnRlbnRTZWxlY3RvcnMgPSB0aGlzLmNvbnRlbnRTZWxlY3RvcnM7XG4gICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgdmFyIGlpID0gdm9pZCAwO1xuXG4gICAgZm9yIChpID0gMCwgaWkgPSBjb250ZW50U2VsZWN0b3JzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGNvbnRlbnRTZWxlY3RvcnNbaV0ucmVtb3ZlQXQoaW5kZXgsIHZpZXcuZnJhZ21lbnQpO1xuICAgIH1cblxuICAgIHRoaXMuY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAxKTtcblxuICAgIGlmICh0aGlzLmlzQXR0YWNoZWQpIHtcbiAgICAgIHZpZXcuZGV0YWNoZWQoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdmlldztcbiAgfTtcblxuICBWaWV3U2xvdC5wcm90b3R5cGUuX2NvbnRlbnRTZWxlY3RvclJlbW92ZUFsbCA9IGZ1bmN0aW9uIF9jb250ZW50U2VsZWN0b3JSZW1vdmVBbGwoKSB7XG4gICAgdmFyIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjtcbiAgICB2YXIgY29udGVudFNlbGVjdG9ycyA9IHRoaXMuY29udGVudFNlbGVjdG9ycztcbiAgICB2YXIgaWkgPSBjaGlsZHJlbi5sZW5ndGg7XG4gICAgdmFyIGpqID0gY29udGVudFNlbGVjdG9ycy5sZW5ndGg7XG4gICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgdmFyIGogPSB2b2lkIDA7XG4gICAgdmFyIHZpZXcgPSB2b2lkIDA7XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwgaWk7ICsraSkge1xuICAgICAgdmlldyA9IGNoaWxkcmVuW2ldO1xuXG4gICAgICBmb3IgKGogPSAwOyBqIDwgamo7ICsraikge1xuICAgICAgICBjb250ZW50U2VsZWN0b3JzW2pdLnJlbW92ZUF0KDAsIHZpZXcuZnJhZ21lbnQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLmlzQXR0YWNoZWQpIHtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgIGNoaWxkcmVuW2ldLmRldGFjaGVkKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5jaGlsZHJlbiA9IFtdO1xuICB9O1xuXG4gIHJldHVybiBWaWV3U2xvdDtcbn0oKTtcblxudmFyIFByb3ZpZGVyUmVzb2x2ZXIgPSAoMCwgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uLnJlc29sdmVyKShfY2xhc3MxMSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUHJvdmlkZXJSZXNvbHZlcigpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUHJvdmlkZXJSZXNvbHZlcik7XG4gIH1cblxuICBQcm92aWRlclJlc29sdmVyLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiBnZXQoY29udGFpbmVyLCBrZXkpIHtcbiAgICB2YXIgaWQgPSBrZXkuX19wcm92aWRlcklkX187XG4gICAgcmV0dXJuIGlkIGluIGNvbnRhaW5lciA/IGNvbnRhaW5lcltpZF0gOiBjb250YWluZXJbaWRdID0gY29udGFpbmVyLmludm9rZShrZXkpO1xuICB9O1xuXG4gIHJldHVybiBQcm92aWRlclJlc29sdmVyO1xufSgpKSB8fCBfY2xhc3MxMTtcblxudmFyIHByb3ZpZGVyUmVzb2x2ZXJJbnN0YW5jZSA9IG5ldyBQcm92aWRlclJlc29sdmVyKCk7XG5cbmZ1bmN0aW9uIGVsZW1lbnRDb250YWluZXJHZXQoa2V5KSB7XG4gIGlmIChrZXkgPT09IF9hdXJlbGlhUGFsLkRPTS5FbGVtZW50KSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudDtcbiAgfVxuXG4gIGlmIChrZXkgPT09IEJvdW5kVmlld0ZhY3RvcnkpIHtcbiAgICBpZiAodGhpcy5ib3VuZFZpZXdGYWN0b3J5KSB7XG4gICAgICByZXR1cm4gdGhpcy5ib3VuZFZpZXdGYWN0b3J5O1xuICAgIH1cblxuICAgIHZhciBmYWN0b3J5ID0gdGhpcy5pbnN0cnVjdGlvbi52aWV3RmFjdG9yeTtcbiAgICB2YXIgX3BhcnRSZXBsYWNlbWVudHMgPSB0aGlzLnBhcnRSZXBsYWNlbWVudHM7XG5cbiAgICBpZiAoX3BhcnRSZXBsYWNlbWVudHMpIHtcbiAgICAgIGZhY3RvcnkgPSBfcGFydFJlcGxhY2VtZW50c1tmYWN0b3J5LnBhcnRdIHx8IGZhY3Rvcnk7XG4gICAgfVxuXG4gICAgdGhpcy5ib3VuZFZpZXdGYWN0b3J5ID0gbmV3IEJvdW5kVmlld0ZhY3RvcnkodGhpcywgZmFjdG9yeSwgX3BhcnRSZXBsYWNlbWVudHMpO1xuICAgIHJldHVybiB0aGlzLmJvdW5kVmlld0ZhY3Rvcnk7XG4gIH1cblxuICBpZiAoa2V5ID09PSBWaWV3U2xvdCkge1xuICAgIGlmICh0aGlzLnZpZXdTbG90ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMudmlld1Nsb3QgPSBuZXcgVmlld1Nsb3QodGhpcy5lbGVtZW50LCB0aGlzLmluc3RydWN0aW9uLmFuY2hvcklzQ29udGFpbmVyKTtcbiAgICAgIHRoaXMuZWxlbWVudC5pc0NvbnRlbnRQcm9qZWN0aW9uU291cmNlID0gdGhpcy5pbnN0cnVjdGlvbi5saWZ0aW5nO1xuICAgICAgdGhpcy5jaGlsZHJlbi5wdXNoKHRoaXMudmlld1Nsb3QpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnZpZXdTbG90O1xuICB9XG5cbiAgaWYgKGtleSA9PT0gRWxlbWVudEV2ZW50cykge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnRFdmVudHMgfHwgKHRoaXMuZWxlbWVudEV2ZW50cyA9IG5ldyBFbGVtZW50RXZlbnRzKHRoaXMuZWxlbWVudCkpO1xuICB9XG5cbiAgaWYgKGtleSA9PT0gQ29tcG9zaXRpb25UcmFuc2FjdGlvbikge1xuICAgIHJldHVybiB0aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb24gfHwgKHRoaXMuY29tcG9zaXRpb25UcmFuc2FjdGlvbiA9IHRoaXMucGFyZW50LmdldChrZXkpKTtcbiAgfVxuXG4gIGlmIChrZXkgPT09IFZpZXdSZXNvdXJjZXMpIHtcbiAgICByZXR1cm4gdGhpcy52aWV3UmVzb3VyY2VzO1xuICB9XG5cbiAgaWYgKGtleSA9PT0gVGFyZ2V0SW5zdHJ1Y3Rpb24pIHtcbiAgICByZXR1cm4gdGhpcy5pbnN0cnVjdGlvbjtcbiAgfVxuXG4gIHJldHVybiB0aGlzLnN1cGVyR2V0KGtleSk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnRDb250YWluZXIocGFyZW50LCBlbGVtZW50LCBpbnN0cnVjdGlvbiwgY2hpbGRyZW4sIHBhcnRSZXBsYWNlbWVudHMsIHJlc291cmNlcykge1xuICB2YXIgY29udGFpbmVyID0gcGFyZW50LmNyZWF0ZUNoaWxkKCk7XG4gIHZhciBwcm92aWRlcnMgPSB2b2lkIDA7XG4gIHZhciBpID0gdm9pZCAwO1xuXG4gIGNvbnRhaW5lci5lbGVtZW50ID0gZWxlbWVudDtcbiAgY29udGFpbmVyLmluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb247XG4gIGNvbnRhaW5lci5jaGlsZHJlbiA9IGNoaWxkcmVuO1xuICBjb250YWluZXIudmlld1Jlc291cmNlcyA9IHJlc291cmNlcztcbiAgY29udGFpbmVyLnBhcnRSZXBsYWNlbWVudHMgPSBwYXJ0UmVwbGFjZW1lbnRzO1xuXG4gIHByb3ZpZGVycyA9IGluc3RydWN0aW9uLnByb3ZpZGVycztcbiAgaSA9IHByb3ZpZGVycy5sZW5ndGg7XG5cbiAgd2hpbGUgKGktLSkge1xuICAgIGNvbnRhaW5lci5fcmVzb2x2ZXJzLnNldChwcm92aWRlcnNbaV0sIHByb3ZpZGVyUmVzb2x2ZXJJbnN0YW5jZSk7XG4gIH1cblxuICBjb250YWluZXIuc3VwZXJHZXQgPSBjb250YWluZXIuZ2V0O1xuICBjb250YWluZXIuZ2V0ID0gZWxlbWVudENvbnRhaW5lckdldDtcblxuICByZXR1cm4gY29udGFpbmVyO1xufVxuXG5mdW5jdGlvbiBtYWtlRWxlbWVudEludG9BbmNob3IoZWxlbWVudCwgZWxlbWVudEluc3RydWN0aW9uKSB7XG4gIHZhciBhbmNob3IgPSBfYXVyZWxpYVBhbC5ET00uY3JlYXRlQ29tbWVudCgnYW5jaG9yJyk7XG5cbiAgaWYgKGVsZW1lbnRJbnN0cnVjdGlvbikge1xuICAgIGFuY2hvci5oYXNBdHRyaWJ1dGUgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgcmV0dXJuIGVsZW1lbnQuaGFzQXR0cmlidXRlKG5hbWUpO1xuICAgIH07XG4gICAgYW5jaG9yLmdldEF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICByZXR1cm4gZWxlbWVudC5nZXRBdHRyaWJ1dGUobmFtZSk7XG4gICAgfTtcbiAgICBhbmNob3Iuc2V0QXR0cmlidXRlID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7XG4gICAgfTtcbiAgfVxuXG4gIF9hdXJlbGlhUGFsLkRPTS5yZXBsYWNlTm9kZShhbmNob3IsIGVsZW1lbnQpO1xuXG4gIHJldHVybiBhbmNob3I7XG59XG5cbmZ1bmN0aW9uIGFwcGx5SW5zdHJ1Y3Rpb25zKGNvbnRhaW5lcnMsIGVsZW1lbnQsIGluc3RydWN0aW9uLCBjb250cm9sbGVycywgYmluZGluZ3MsIGNoaWxkcmVuLCBjb250ZW50U2VsZWN0b3JzLCBwYXJ0UmVwbGFjZW1lbnRzLCByZXNvdXJjZXMpIHtcbiAgdmFyIGJlaGF2aW9ySW5zdHJ1Y3Rpb25zID0gaW5zdHJ1Y3Rpb24uYmVoYXZpb3JJbnN0cnVjdGlvbnM7XG4gIHZhciBleHByZXNzaW9ucyA9IGluc3RydWN0aW9uLmV4cHJlc3Npb25zO1xuICB2YXIgZWxlbWVudENvbnRhaW5lciA9IHZvaWQgMDtcbiAgdmFyIGkgPSB2b2lkIDA7XG4gIHZhciBpaSA9IHZvaWQgMDtcbiAgdmFyIGN1cnJlbnQgPSB2b2lkIDA7XG4gIHZhciBpbnN0YW5jZSA9IHZvaWQgMDtcblxuICBpZiAoaW5zdHJ1Y3Rpb24uY29udGVudEV4cHJlc3Npb24pIHtcbiAgICBiaW5kaW5ncy5wdXNoKGluc3RydWN0aW9uLmNvbnRlbnRFeHByZXNzaW9uLmNyZWF0ZUJpbmRpbmcoZWxlbWVudC5uZXh0U2libGluZykpO1xuICAgIGVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbGVtZW50KTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoaW5zdHJ1Y3Rpb24uY29udGVudFNlbGVjdG9yKSB7XG4gICAgdmFyIGNvbW1lbnRBbmNob3IgPSBfYXVyZWxpYVBhbC5ET00uY3JlYXRlQ29tbWVudCgnYW5jaG9yJyk7XG4gICAgX2F1cmVsaWFQYWwuRE9NLnJlcGxhY2VOb2RlKGNvbW1lbnRBbmNob3IsIGVsZW1lbnQpO1xuICAgIGNvbnRlbnRTZWxlY3RvcnMucHVzaChuZXcgX0NvbnRlbnRTZWxlY3Rvcihjb21tZW50QW5jaG9yLCBpbnN0cnVjdGlvbi5zZWxlY3RvcikpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChiZWhhdmlvckluc3RydWN0aW9ucy5sZW5ndGgpIHtcbiAgICBpZiAoIWluc3RydWN0aW9uLmFuY2hvcklzQ29udGFpbmVyKSB7XG4gICAgICBlbGVtZW50ID0gbWFrZUVsZW1lbnRJbnRvQW5jaG9yKGVsZW1lbnQsIGluc3RydWN0aW9uLmVsZW1lbnRJbnN0cnVjdGlvbik7XG4gICAgfVxuXG4gICAgY29udGFpbmVyc1tpbnN0cnVjdGlvbi5pbmplY3RvcklkXSA9IGVsZW1lbnRDb250YWluZXIgPSBjcmVhdGVFbGVtZW50Q29udGFpbmVyKGNvbnRhaW5lcnNbaW5zdHJ1Y3Rpb24ucGFyZW50SW5qZWN0b3JJZF0sIGVsZW1lbnQsIGluc3RydWN0aW9uLCBjaGlsZHJlbiwgcGFydFJlcGxhY2VtZW50cywgcmVzb3VyY2VzKTtcblxuICAgIGZvciAoaSA9IDAsIGlpID0gYmVoYXZpb3JJbnN0cnVjdGlvbnMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgY3VycmVudCA9IGJlaGF2aW9ySW5zdHJ1Y3Rpb25zW2ldO1xuICAgICAgaW5zdGFuY2UgPSBjdXJyZW50LnR5cGUuY3JlYXRlKGVsZW1lbnRDb250YWluZXIsIGN1cnJlbnQsIGVsZW1lbnQsIGJpbmRpbmdzKTtcblxuICAgICAgaWYgKGluc3RhbmNlLmNvbnRlbnRWaWV3KSB7XG4gICAgICAgIGNoaWxkcmVuLnB1c2goaW5zdGFuY2UuY29udGVudFZpZXcpO1xuICAgICAgfVxuXG4gICAgICBjb250cm9sbGVycy5wdXNoKGluc3RhbmNlKTtcbiAgICB9XG4gIH1cblxuICBmb3IgKGkgPSAwLCBpaSA9IGV4cHJlc3Npb25zLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICBiaW5kaW5ncy5wdXNoKGV4cHJlc3Npb25zW2ldLmNyZWF0ZUJpbmRpbmcoZWxlbWVudCkpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHN0eWxlU3RyaW5nVG9PYmplY3Qoc3R5bGUsIHRhcmdldCkge1xuICB2YXIgYXR0cmlidXRlcyA9IHN0eWxlLnNwbGl0KCc7Jyk7XG4gIHZhciBmaXJzdEluZGV4T2ZDb2xvbiA9IHZvaWQgMDtcbiAgdmFyIGkgPSB2b2lkIDA7XG4gIHZhciBjdXJyZW50ID0gdm9pZCAwO1xuICB2YXIga2V5ID0gdm9pZCAwO1xuICB2YXIgdmFsdWUgPSB2b2lkIDA7XG5cbiAgdGFyZ2V0ID0gdGFyZ2V0IHx8IHt9O1xuXG4gIGZvciAoaSA9IDA7IGkgPCBhdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgY3VycmVudCA9IGF0dHJpYnV0ZXNbaV07XG4gICAgZmlyc3RJbmRleE9mQ29sb24gPSBjdXJyZW50LmluZGV4T2YoJzonKTtcbiAgICBrZXkgPSBjdXJyZW50LnN1YnN0cmluZygwLCBmaXJzdEluZGV4T2ZDb2xvbikudHJpbSgpO1xuICAgIHZhbHVlID0gY3VycmVudC5zdWJzdHJpbmcoZmlyc3RJbmRleE9mQ29sb24gKyAxKS50cmltKCk7XG4gICAgdGFyZ2V0W2tleV0gPSB2YWx1ZTtcbiAgfVxuXG4gIHJldHVybiB0YXJnZXQ7XG59XG5cbmZ1bmN0aW9uIHN0eWxlT2JqZWN0VG9TdHJpbmcob2JqKSB7XG4gIHZhciByZXN1bHQgPSAnJztcblxuICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgcmVzdWx0ICs9IGtleSArICc6JyArIG9ialtrZXldICsgJzsnO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gYXBwbHlTdXJyb2dhdGVJbnN0cnVjdGlvbihjb250YWluZXIsIGVsZW1lbnQsIGluc3RydWN0aW9uLCBjb250cm9sbGVycywgYmluZGluZ3MsIGNoaWxkcmVuKSB7XG4gIHZhciBiZWhhdmlvckluc3RydWN0aW9ucyA9IGluc3RydWN0aW9uLmJlaGF2aW9ySW5zdHJ1Y3Rpb25zO1xuICB2YXIgZXhwcmVzc2lvbnMgPSBpbnN0cnVjdGlvbi5leHByZXNzaW9ucztcbiAgdmFyIHByb3ZpZGVycyA9IGluc3RydWN0aW9uLnByb3ZpZGVycztcbiAgdmFyIHZhbHVlcyA9IGluc3RydWN0aW9uLnZhbHVlcztcbiAgdmFyIGkgPSB2b2lkIDA7XG4gIHZhciBpaSA9IHZvaWQgMDtcbiAgdmFyIGN1cnJlbnQgPSB2b2lkIDA7XG4gIHZhciBpbnN0YW5jZSA9IHZvaWQgMDtcbiAgdmFyIGN1cnJlbnRBdHRyaWJ1dGVWYWx1ZSA9IHZvaWQgMDtcblxuICBpID0gcHJvdmlkZXJzLmxlbmd0aDtcbiAgd2hpbGUgKGktLSkge1xuICAgIGNvbnRhaW5lci5fcmVzb2x2ZXJzLnNldChwcm92aWRlcnNbaV0sIHByb3ZpZGVyUmVzb2x2ZXJJbnN0YW5jZSk7XG4gIH1cblxuICBmb3IgKHZhciBrZXkgaW4gdmFsdWVzKSB7XG4gICAgY3VycmVudEF0dHJpYnV0ZVZhbHVlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoa2V5KTtcblxuICAgIGlmIChjdXJyZW50QXR0cmlidXRlVmFsdWUpIHtcbiAgICAgIGlmIChrZXkgPT09ICdjbGFzcycpIHtcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgY3VycmVudEF0dHJpYnV0ZVZhbHVlICsgJyAnICsgdmFsdWVzW2tleV0pO1xuICAgICAgfSBlbHNlIGlmIChrZXkgPT09ICdzdHlsZScpIHtcbiAgICAgICAgdmFyIHN0eWxlT2JqZWN0ID0gc3R5bGVTdHJpbmdUb09iamVjdCh2YWx1ZXNba2V5XSk7XG4gICAgICAgIHN0eWxlU3RyaW5nVG9PYmplY3QoY3VycmVudEF0dHJpYnV0ZVZhbHVlLCBzdHlsZU9iamVjdCk7XG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdzdHlsZScsIHN0eWxlT2JqZWN0VG9TdHJpbmcoc3R5bGVPYmplY3QpKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShrZXksIHZhbHVlc1trZXldKTtcbiAgICAgIH1cbiAgfVxuXG4gIGlmIChiZWhhdmlvckluc3RydWN0aW9ucy5sZW5ndGgpIHtcbiAgICBmb3IgKGkgPSAwLCBpaSA9IGJlaGF2aW9ySW5zdHJ1Y3Rpb25zLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGN1cnJlbnQgPSBiZWhhdmlvckluc3RydWN0aW9uc1tpXTtcbiAgICAgIGluc3RhbmNlID0gY3VycmVudC50eXBlLmNyZWF0ZShjb250YWluZXIsIGN1cnJlbnQsIGVsZW1lbnQsIGJpbmRpbmdzKTtcblxuICAgICAgaWYgKGluc3RhbmNlLmNvbnRlbnRWaWV3KSB7XG4gICAgICAgIGNoaWxkcmVuLnB1c2goaW5zdGFuY2UuY29udGVudFZpZXcpO1xuICAgICAgfVxuXG4gICAgICBjb250cm9sbGVycy5wdXNoKGluc3RhbmNlKTtcbiAgICB9XG4gIH1cblxuICBmb3IgKGkgPSAwLCBpaSA9IGV4cHJlc3Npb25zLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICBiaW5kaW5ncy5wdXNoKGV4cHJlc3Npb25zW2ldLmNyZWF0ZUJpbmRpbmcoZWxlbWVudCkpO1xuICB9XG59XG5cbnZhciBCb3VuZFZpZXdGYWN0b3J5ID0gZXhwb3J0cy5Cb3VuZFZpZXdGYWN0b3J5ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBCb3VuZFZpZXdGYWN0b3J5KHBhcmVudENvbnRhaW5lciwgdmlld0ZhY3RvcnksIHBhcnRSZXBsYWNlbWVudHMpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQm91bmRWaWV3RmFjdG9yeSk7XG5cbiAgICB0aGlzLnBhcmVudENvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lcjtcbiAgICB0aGlzLnZpZXdGYWN0b3J5ID0gdmlld0ZhY3Rvcnk7XG4gICAgdGhpcy5mYWN0b3J5Q3JlYXRlSW5zdHJ1Y3Rpb24gPSB7IHBhcnRSZXBsYWNlbWVudHM6IHBhcnRSZXBsYWNlbWVudHMgfTtcbiAgfVxuXG4gIEJvdW5kVmlld0ZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uIGNyZWF0ZSgpIHtcbiAgICB2YXIgdmlldyA9IHRoaXMudmlld0ZhY3RvcnkuY3JlYXRlKHRoaXMucGFyZW50Q29udGFpbmVyLmNyZWF0ZUNoaWxkKCksIHRoaXMuZmFjdG9yeUNyZWF0ZUluc3RydWN0aW9uKTtcbiAgICB2aWV3Ll9pc1VzZXJDb250cm9sbGVkID0gdHJ1ZTtcbiAgICByZXR1cm4gdmlldztcbiAgfTtcblxuICBCb3VuZFZpZXdGYWN0b3J5LnByb3RvdHlwZS5zZXRDYWNoZVNpemUgPSBmdW5jdGlvbiBzZXRDYWNoZVNpemUoc2l6ZSwgZG9Ob3RPdmVycmlkZUlmQWxyZWFkeVNldCkge1xuICAgIHRoaXMudmlld0ZhY3Rvcnkuc2V0Q2FjaGVTaXplKHNpemUsIGRvTm90T3ZlcnJpZGVJZkFscmVhZHlTZXQpO1xuICB9O1xuXG4gIEJvdW5kVmlld0ZhY3RvcnkucHJvdG90eXBlLmdldENhY2hlZFZpZXcgPSBmdW5jdGlvbiBnZXRDYWNoZWRWaWV3KCkge1xuICAgIHJldHVybiB0aGlzLnZpZXdGYWN0b3J5LmdldENhY2hlZFZpZXcoKTtcbiAgfTtcblxuICBCb3VuZFZpZXdGYWN0b3J5LnByb3RvdHlwZS5yZXR1cm5WaWV3VG9DYWNoZSA9IGZ1bmN0aW9uIHJldHVyblZpZXdUb0NhY2hlKHZpZXcpIHtcbiAgICB0aGlzLnZpZXdGYWN0b3J5LnJldHVyblZpZXdUb0NhY2hlKHZpZXcpO1xuICB9O1xuXG4gIF9jcmVhdGVDbGFzcyhCb3VuZFZpZXdGYWN0b3J5LCBbe1xuICAgIGtleTogJ2lzQ2FjaGluZycsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy52aWV3RmFjdG9yeS5pc0NhY2hpbmc7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIEJvdW5kVmlld0ZhY3Rvcnk7XG59KCk7XG5cbnZhciBWaWV3RmFjdG9yeSA9IGV4cG9ydHMuVmlld0ZhY3RvcnkgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFZpZXdGYWN0b3J5KHRlbXBsYXRlLCBpbnN0cnVjdGlvbnMsIHJlc291cmNlcykge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBWaWV3RmFjdG9yeSk7XG5cbiAgICB0aGlzLmlzQ2FjaGluZyA9IGZhbHNlO1xuXG4gICAgdGhpcy50ZW1wbGF0ZSA9IHRlbXBsYXRlO1xuICAgIHRoaXMuaW5zdHJ1Y3Rpb25zID0gaW5zdHJ1Y3Rpb25zO1xuICAgIHRoaXMucmVzb3VyY2VzID0gcmVzb3VyY2VzO1xuICAgIHRoaXMuY2FjaGVTaXplID0gLTE7XG4gICAgdGhpcy5jYWNoZSA9IG51bGw7XG4gIH1cblxuICBWaWV3RmFjdG9yeS5wcm90b3R5cGUuc2V0Q2FjaGVTaXplID0gZnVuY3Rpb24gc2V0Q2FjaGVTaXplKHNpemUsIGRvTm90T3ZlcnJpZGVJZkFscmVhZHlTZXQpIHtcbiAgICBpZiAoc2l6ZSkge1xuICAgICAgaWYgKHNpemUgPT09ICcqJykge1xuICAgICAgICBzaXplID0gTnVtYmVyLk1BWF9WQUxVRTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHNpemUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHNpemUgPSBwYXJzZUludChzaXplLCAxMCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY2FjaGVTaXplID09PSAtMSB8fCAhZG9Ob3RPdmVycmlkZUlmQWxyZWFkeVNldCkge1xuICAgICAgdGhpcy5jYWNoZVNpemUgPSBzaXplO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmNhY2hlU2l6ZSA+IDApIHtcbiAgICAgIHRoaXMuY2FjaGUgPSBbXTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jYWNoZSA9IG51bGw7XG4gICAgfVxuXG4gICAgdGhpcy5pc0NhY2hpbmcgPSB0aGlzLmNhY2hlU2l6ZSA+IDA7XG4gIH07XG5cbiAgVmlld0ZhY3RvcnkucHJvdG90eXBlLmdldENhY2hlZFZpZXcgPSBmdW5jdGlvbiBnZXRDYWNoZWRWaWV3KCkge1xuICAgIHJldHVybiB0aGlzLmNhY2hlICE9PSBudWxsID8gdGhpcy5jYWNoZS5wb3AoKSB8fCBudWxsIDogbnVsbDtcbiAgfTtcblxuICBWaWV3RmFjdG9yeS5wcm90b3R5cGUucmV0dXJuVmlld1RvQ2FjaGUgPSBmdW5jdGlvbiByZXR1cm5WaWV3VG9DYWNoZSh2aWV3KSB7XG4gICAgaWYgKHZpZXcuaXNBdHRhY2hlZCkge1xuICAgICAgdmlldy5kZXRhY2hlZCgpO1xuICAgIH1cblxuICAgIGlmICh2aWV3LmlzQm91bmQpIHtcbiAgICAgIHZpZXcudW5iaW5kKCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY2FjaGUgIT09IG51bGwgJiYgdGhpcy5jYWNoZS5sZW5ndGggPCB0aGlzLmNhY2hlU2l6ZSkge1xuICAgICAgdmlldy5mcm9tQ2FjaGUgPSB0cnVlO1xuICAgICAgdGhpcy5jYWNoZS5wdXNoKHZpZXcpO1xuICAgIH1cbiAgfTtcblxuICBWaWV3RmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gY3JlYXRlKGNvbnRhaW5lciwgY3JlYXRlSW5zdHJ1Y3Rpb24sIGVsZW1lbnQpIHtcbiAgICBjcmVhdGVJbnN0cnVjdGlvbiA9IGNyZWF0ZUluc3RydWN0aW9uIHx8IEJlaGF2aW9ySW5zdHJ1Y3Rpb24ubm9ybWFsO1xuICAgIGVsZW1lbnQgPSBlbGVtZW50IHx8IG51bGw7XG5cbiAgICB2YXIgY2FjaGVkVmlldyA9IHRoaXMuZ2V0Q2FjaGVkVmlldygpO1xuICAgIGlmIChjYWNoZWRWaWV3ICE9PSBudWxsKSB7XG4gICAgICByZXR1cm4gY2FjaGVkVmlldztcbiAgICB9XG5cbiAgICB2YXIgZnJhZ21lbnQgPSBjcmVhdGVJbnN0cnVjdGlvbi5lbmhhbmNlID8gdGhpcy50ZW1wbGF0ZSA6IHRoaXMudGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xuICAgIHZhciBpbnN0cnVjdGFibGVzID0gZnJhZ21lbnQucXVlcnlTZWxlY3RvckFsbCgnLmF1LXRhcmdldCcpO1xuICAgIHZhciBpbnN0cnVjdGlvbnMgPSB0aGlzLmluc3RydWN0aW9ucztcbiAgICB2YXIgcmVzb3VyY2VzID0gdGhpcy5yZXNvdXJjZXM7XG4gICAgdmFyIGNvbnRyb2xsZXJzID0gW107XG4gICAgdmFyIGJpbmRpbmdzID0gW107XG4gICAgdmFyIGNoaWxkcmVuID0gW107XG4gICAgdmFyIGNvbnRlbnRTZWxlY3RvcnMgPSBbXTtcbiAgICB2YXIgY29udGFpbmVycyA9IHsgcm9vdDogY29udGFpbmVyIH07XG4gICAgdmFyIHBhcnRSZXBsYWNlbWVudHMgPSBjcmVhdGVJbnN0cnVjdGlvbi5wYXJ0UmVwbGFjZW1lbnRzO1xuICAgIHZhciBpID0gdm9pZCAwO1xuICAgIHZhciBpaSA9IHZvaWQgMDtcbiAgICB2YXIgdmlldyA9IHZvaWQgMDtcbiAgICB2YXIgaW5zdHJ1Y3RhYmxlID0gdm9pZCAwO1xuICAgIHZhciBpbnN0cnVjdGlvbiA9IHZvaWQgMDtcblxuICAgIHRoaXMucmVzb3VyY2VzLl9pbnZva2VIb29rKCdiZWZvcmVDcmVhdGUnLCB0aGlzLCBjb250YWluZXIsIGZyYWdtZW50LCBjcmVhdGVJbnN0cnVjdGlvbik7XG5cbiAgICBpZiAoZWxlbWVudCAhPT0gbnVsbCAmJiB0aGlzLnN1cnJvZ2F0ZUluc3RydWN0aW9uICE9PSBudWxsKSB7XG4gICAgICBhcHBseVN1cnJvZ2F0ZUluc3RydWN0aW9uKGNvbnRhaW5lciwgZWxlbWVudCwgdGhpcy5zdXJyb2dhdGVJbnN0cnVjdGlvbiwgY29udHJvbGxlcnMsIGJpbmRpbmdzLCBjaGlsZHJlbik7XG4gICAgfVxuXG4gICAgZm9yIChpID0gMCwgaWkgPSBpbnN0cnVjdGFibGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGluc3RydWN0YWJsZSA9IGluc3RydWN0YWJsZXNbaV07XG4gICAgICBpbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uc1tpbnN0cnVjdGFibGUuZ2V0QXR0cmlidXRlKCdhdS10YXJnZXQtaWQnKV07XG5cbiAgICAgIGFwcGx5SW5zdHJ1Y3Rpb25zKGNvbnRhaW5lcnMsIGluc3RydWN0YWJsZSwgaW5zdHJ1Y3Rpb24sIGNvbnRyb2xsZXJzLCBiaW5kaW5ncywgY2hpbGRyZW4sIGNvbnRlbnRTZWxlY3RvcnMsIHBhcnRSZXBsYWNlbWVudHMsIHJlc291cmNlcyk7XG4gICAgfVxuXG4gICAgdmlldyA9IG5ldyBWaWV3KGNvbnRhaW5lciwgdGhpcywgZnJhZ21lbnQsIGNvbnRyb2xsZXJzLCBiaW5kaW5ncywgY2hpbGRyZW4sIGNvbnRlbnRTZWxlY3RvcnMpO1xuXG4gICAgaWYgKCFjcmVhdGVJbnN0cnVjdGlvbi5pbml0aWF0ZWRCeUJlaGF2aW9yKSB7XG4gICAgICB2aWV3LmNyZWF0ZWQoKTtcbiAgICB9XG5cbiAgICB0aGlzLnJlc291cmNlcy5faW52b2tlSG9vaygnYWZ0ZXJDcmVhdGUnLCB2aWV3KTtcblxuICAgIHJldHVybiB2aWV3O1xuICB9O1xuXG4gIHJldHVybiBWaWV3RmFjdG9yeTtcbn0oKTtcblxudmFyIG5leHRJbmplY3RvcklkID0gMDtcbmZ1bmN0aW9uIGdldE5leHRJbmplY3RvcklkKCkge1xuICByZXR1cm4gKytuZXh0SW5qZWN0b3JJZDtcbn1cblxuZnVuY3Rpb24gY29uZmlndXJlUHJvcGVydGllcyhpbnN0cnVjdGlvbiwgcmVzb3VyY2VzKSB7XG4gIHZhciB0eXBlID0gaW5zdHJ1Y3Rpb24udHlwZTtcbiAgdmFyIGF0dHJOYW1lID0gaW5zdHJ1Y3Rpb24uYXR0ck5hbWU7XG4gIHZhciBhdHRyaWJ1dGVzID0gaW5zdHJ1Y3Rpb24uYXR0cmlidXRlcztcbiAgdmFyIHByb3BlcnR5ID0gdm9pZCAwO1xuICB2YXIga2V5ID0gdm9pZCAwO1xuICB2YXIgdmFsdWUgPSB2b2lkIDA7XG5cbiAgdmFyIGtub3duQXR0cmlidXRlID0gcmVzb3VyY2VzLm1hcEF0dHJpYnV0ZShhdHRyTmFtZSk7XG4gIGlmIChrbm93bkF0dHJpYnV0ZSAmJiBhdHRyTmFtZSBpbiBhdHRyaWJ1dGVzICYmIGtub3duQXR0cmlidXRlICE9PSBhdHRyTmFtZSkge1xuICAgIGF0dHJpYnV0ZXNba25vd25BdHRyaWJ1dGVdID0gYXR0cmlidXRlc1thdHRyTmFtZV07XG4gICAgZGVsZXRlIGF0dHJpYnV0ZXNbYXR0ck5hbWVdO1xuICB9XG5cbiAgZm9yIChrZXkgaW4gYXR0cmlidXRlcykge1xuICAgIHZhbHVlID0gYXR0cmlidXRlc1trZXldO1xuXG4gICAgaWYgKHZhbHVlICE9PSBudWxsICYmICh0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKHZhbHVlKSkgPT09ICdvYmplY3QnKSB7XG4gICAgICBwcm9wZXJ0eSA9IHR5cGUuYXR0cmlidXRlc1trZXldO1xuXG4gICAgICBpZiAocHJvcGVydHkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YWx1ZS50YXJnZXRQcm9wZXJ0eSA9IHByb3BlcnR5Lm5hbWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YWx1ZS50YXJnZXRQcm9wZXJ0eSA9IGtleTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxudmFyIGxhc3RBVVRhcmdldElEID0gMDtcbmZ1bmN0aW9uIGdldE5leHRBVVRhcmdldElEKCkge1xuICByZXR1cm4gKCsrbGFzdEFVVGFyZ2V0SUQpLnRvU3RyaW5nKCk7XG59XG5cbmZ1bmN0aW9uIG1ha2VJbnRvSW5zdHJ1Y3Rpb25UYXJnZXQoZWxlbWVudCkge1xuICB2YXIgdmFsdWUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnY2xhc3MnKTtcbiAgdmFyIGF1VGFyZ2V0SUQgPSBnZXROZXh0QVVUYXJnZXRJRCgpO1xuXG4gIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdjbGFzcycsIHZhbHVlID8gdmFsdWUgKz0gJyBhdS10YXJnZXQnIDogJ2F1LXRhcmdldCcpO1xuICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnYXUtdGFyZ2V0LWlkJywgYXVUYXJnZXRJRCk7XG5cbiAgcmV0dXJuIGF1VGFyZ2V0SUQ7XG59XG5cbnZhciBWaWV3Q29tcGlsZXIgPSBleHBvcnRzLlZpZXdDb21waWxlciA9IChfZGVjNiA9ICgwLCBfYXVyZWxpYURlcGVuZGVuY3lJbmplY3Rpb24uaW5qZWN0KShCaW5kaW5nTGFuZ3VhZ2UsIFZpZXdSZXNvdXJjZXMpLCBfZGVjNihfY2xhc3MxMyA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gVmlld0NvbXBpbGVyKGJpbmRpbmdMYW5ndWFnZSwgcmVzb3VyY2VzKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpZXdDb21waWxlcik7XG5cbiAgICB0aGlzLmJpbmRpbmdMYW5ndWFnZSA9IGJpbmRpbmdMYW5ndWFnZTtcbiAgICB0aGlzLnJlc291cmNlcyA9IHJlc291cmNlcztcbiAgfVxuXG4gIFZpZXdDb21waWxlci5wcm90b3R5cGUuY29tcGlsZSA9IGZ1bmN0aW9uIGNvbXBpbGUoc291cmNlLCByZXNvdXJjZXMsIGNvbXBpbGVJbnN0cnVjdGlvbikge1xuICAgIHJlc291cmNlcyA9IHJlc291cmNlcyB8fCB0aGlzLnJlc291cmNlcztcbiAgICBjb21waWxlSW5zdHJ1Y3Rpb24gPSBjb21waWxlSW5zdHJ1Y3Rpb24gfHwgVmlld0NvbXBpbGVJbnN0cnVjdGlvbi5ub3JtYWw7XG4gICAgc291cmNlID0gdHlwZW9mIHNvdXJjZSA9PT0gJ3N0cmluZycgPyBfYXVyZWxpYVBhbC5ET00uY3JlYXRlVGVtcGxhdGVGcm9tTWFya3VwKHNvdXJjZSkgOiBzb3VyY2U7XG5cbiAgICB2YXIgY29udGVudCA9IHZvaWQgMDtcbiAgICB2YXIgcGFydCA9IHZvaWQgMDtcbiAgICB2YXIgY2FjaGVTaXplID0gdm9pZCAwO1xuXG4gICAgaWYgKHNvdXJjZS5jb250ZW50KSB7XG4gICAgICBwYXJ0ID0gc291cmNlLmdldEF0dHJpYnV0ZSgncGFydCcpO1xuICAgICAgY2FjaGVTaXplID0gc291cmNlLmdldEF0dHJpYnV0ZSgndmlldy1jYWNoZScpO1xuICAgICAgY29udGVudCA9IF9hdXJlbGlhUGFsLkRPTS5hZG9wdE5vZGUoc291cmNlLmNvbnRlbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb250ZW50ID0gc291cmNlO1xuICAgIH1cblxuICAgIGNvbXBpbGVJbnN0cnVjdGlvbi50YXJnZXRTaGFkb3dET00gPSBjb21waWxlSW5zdHJ1Y3Rpb24udGFyZ2V0U2hhZG93RE9NICYmIF9hdXJlbGlhUGFsLkZFQVRVUkUuc2hhZG93RE9NO1xuICAgIHJlc291cmNlcy5faW52b2tlSG9vaygnYmVmb3JlQ29tcGlsZScsIGNvbnRlbnQsIHJlc291cmNlcywgY29tcGlsZUluc3RydWN0aW9uKTtcblxuICAgIHZhciBpbnN0cnVjdGlvbnMgPSB7fTtcbiAgICB0aGlzLl9jb21waWxlTm9kZShjb250ZW50LCByZXNvdXJjZXMsIGluc3RydWN0aW9ucywgc291cmNlLCAncm9vdCcsICFjb21waWxlSW5zdHJ1Y3Rpb24udGFyZ2V0U2hhZG93RE9NKTtcbiAgICBjb250ZW50Lmluc2VydEJlZm9yZShfYXVyZWxpYVBhbC5ET00uY3JlYXRlQ29tbWVudCgnPHZpZXc+JyksIGNvbnRlbnQuZmlyc3RDaGlsZCk7XG4gICAgY29udGVudC5hcHBlbmRDaGlsZChfYXVyZWxpYVBhbC5ET00uY3JlYXRlQ29tbWVudCgnPC92aWV3PicpKTtcblxuICAgIHZhciBmYWN0b3J5ID0gbmV3IFZpZXdGYWN0b3J5KGNvbnRlbnQsIGluc3RydWN0aW9ucywgcmVzb3VyY2VzKTtcblxuICAgIGZhY3Rvcnkuc3Vycm9nYXRlSW5zdHJ1Y3Rpb24gPSBjb21waWxlSW5zdHJ1Y3Rpb24uY29tcGlsZVN1cnJvZ2F0ZSA/IHRoaXMuX2NvbXBpbGVTdXJyb2dhdGUoc291cmNlLCByZXNvdXJjZXMpIDogbnVsbDtcbiAgICBmYWN0b3J5LnBhcnQgPSBwYXJ0O1xuXG4gICAgaWYgKGNhY2hlU2l6ZSkge1xuICAgICAgZmFjdG9yeS5zZXRDYWNoZVNpemUoY2FjaGVTaXplKTtcbiAgICB9XG5cbiAgICByZXNvdXJjZXMuX2ludm9rZUhvb2soJ2FmdGVyQ29tcGlsZScsIGZhY3RvcnkpO1xuXG4gICAgcmV0dXJuIGZhY3Rvcnk7XG4gIH07XG5cbiAgVmlld0NvbXBpbGVyLnByb3RvdHlwZS5fY29tcGlsZU5vZGUgPSBmdW5jdGlvbiBfY29tcGlsZU5vZGUobm9kZSwgcmVzb3VyY2VzLCBpbnN0cnVjdGlvbnMsIHBhcmVudE5vZGUsIHBhcmVudEluamVjdG9ySWQsIHRhcmdldExpZ2h0RE9NKSB7XG4gICAgc3dpdGNoIChub2RlLm5vZGVUeXBlKSB7XG4gICAgICBjYXNlIDE6XG4gICAgICAgIHJldHVybiB0aGlzLl9jb21waWxlRWxlbWVudChub2RlLCByZXNvdXJjZXMsIGluc3RydWN0aW9ucywgcGFyZW50Tm9kZSwgcGFyZW50SW5qZWN0b3JJZCwgdGFyZ2V0TGlnaHRET00pO1xuICAgICAgY2FzZSAzOlxuICAgICAgICB2YXIgZXhwcmVzc2lvbiA9IHJlc291cmNlcy5nZXRCaW5kaW5nTGFuZ3VhZ2UodGhpcy5iaW5kaW5nTGFuZ3VhZ2UpLmluc3BlY3RUZXh0Q29udGVudChyZXNvdXJjZXMsIG5vZGUud2hvbGVUZXh0KTtcbiAgICAgICAgaWYgKGV4cHJlc3Npb24pIHtcbiAgICAgICAgICB2YXIgbWFya2VyID0gX2F1cmVsaWFQYWwuRE9NLmNyZWF0ZUVsZW1lbnQoJ2F1LW1hcmtlcicpO1xuICAgICAgICAgIHZhciBhdVRhcmdldElEID0gbWFrZUludG9JbnN0cnVjdGlvblRhcmdldChtYXJrZXIpO1xuICAgICAgICAgIChub2RlLnBhcmVudE5vZGUgfHwgcGFyZW50Tm9kZSkuaW5zZXJ0QmVmb3JlKG1hcmtlciwgbm9kZSk7XG4gICAgICAgICAgbm9kZS50ZXh0Q29udGVudCA9ICcgJztcbiAgICAgICAgICBpbnN0cnVjdGlvbnNbYXVUYXJnZXRJRF0gPSBUYXJnZXRJbnN0cnVjdGlvbi5jb250ZW50RXhwcmVzc2lvbihleHByZXNzaW9uKTtcblxuICAgICAgICAgIHdoaWxlIChub2RlLm5leHRTaWJsaW5nICYmIG5vZGUubmV4dFNpYmxpbmcubm9kZVR5cGUgPT09IDMpIHtcbiAgICAgICAgICAgIChub2RlLnBhcmVudE5vZGUgfHwgcGFyZW50Tm9kZSkucmVtb3ZlQ2hpbGQobm9kZS5uZXh0U2libGluZyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHdoaWxlIChub2RlLm5leHRTaWJsaW5nICYmIG5vZGUubmV4dFNpYmxpbmcubm9kZVR5cGUgPT09IDMpIHtcbiAgICAgICAgICAgIG5vZGUgPSBub2RlLm5leHRTaWJsaW5nO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbm9kZS5uZXh0U2libGluZztcbiAgICAgIGNhc2UgMTE6XG4gICAgICAgIHZhciBjdXJyZW50Q2hpbGQgPSBub2RlLmZpcnN0Q2hpbGQ7XG4gICAgICAgIHdoaWxlIChjdXJyZW50Q2hpbGQpIHtcbiAgICAgICAgICBjdXJyZW50Q2hpbGQgPSB0aGlzLl9jb21waWxlTm9kZShjdXJyZW50Q2hpbGQsIHJlc291cmNlcywgaW5zdHJ1Y3Rpb25zLCBub2RlLCBwYXJlbnRJbmplY3RvcklkLCB0YXJnZXRMaWdodERPTSk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICByZXR1cm4gbm9kZS5uZXh0U2libGluZztcbiAgfTtcblxuICBWaWV3Q29tcGlsZXIucHJvdG90eXBlLl9jb21waWxlU3Vycm9nYXRlID0gZnVuY3Rpb24gX2NvbXBpbGVTdXJyb2dhdGUobm9kZSwgcmVzb3VyY2VzKSB7XG4gICAgdmFyIHRhZ05hbWUgPSBub2RlLnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbiAgICB2YXIgYXR0cmlidXRlcyA9IG5vZGUuYXR0cmlidXRlcztcbiAgICB2YXIgYmluZGluZ0xhbmd1YWdlID0gcmVzb3VyY2VzLmdldEJpbmRpbmdMYW5ndWFnZSh0aGlzLmJpbmRpbmdMYW5ndWFnZSk7XG4gICAgdmFyIGtub3duQXR0cmlidXRlID0gdm9pZCAwO1xuICAgIHZhciBwcm9wZXJ0eSA9IHZvaWQgMDtcbiAgICB2YXIgaW5zdHJ1Y3Rpb24gPSB2b2lkIDA7XG4gICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgdmFyIGlpID0gdm9pZCAwO1xuICAgIHZhciBhdHRyID0gdm9pZCAwO1xuICAgIHZhciBhdHRyTmFtZSA9IHZvaWQgMDtcbiAgICB2YXIgYXR0clZhbHVlID0gdm9pZCAwO1xuICAgIHZhciBpbmZvID0gdm9pZCAwO1xuICAgIHZhciB0eXBlID0gdm9pZCAwO1xuICAgIHZhciBleHByZXNzaW9ucyA9IFtdO1xuICAgIHZhciBleHByZXNzaW9uID0gdm9pZCAwO1xuICAgIHZhciBiZWhhdmlvckluc3RydWN0aW9ucyA9IFtdO1xuICAgIHZhciB2YWx1ZXMgPSB7fTtcbiAgICB2YXIgaGFzVmFsdWVzID0gZmFsc2U7XG4gICAgdmFyIHByb3ZpZGVycyA9IFtdO1xuXG4gICAgZm9yIChpID0gMCwgaWkgPSBhdHRyaWJ1dGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGF0dHIgPSBhdHRyaWJ1dGVzW2ldO1xuICAgICAgYXR0ck5hbWUgPSBhdHRyLm5hbWU7XG4gICAgICBhdHRyVmFsdWUgPSBhdHRyLnZhbHVlO1xuXG4gICAgICBpbmZvID0gYmluZGluZ0xhbmd1YWdlLmluc3BlY3RBdHRyaWJ1dGUocmVzb3VyY2VzLCB0YWdOYW1lLCBhdHRyTmFtZSwgYXR0clZhbHVlKTtcbiAgICAgIHR5cGUgPSByZXNvdXJjZXMuZ2V0QXR0cmlidXRlKGluZm8uYXR0ck5hbWUpO1xuXG4gICAgICBpZiAodHlwZSkge1xuICAgICAgICBrbm93bkF0dHJpYnV0ZSA9IHJlc291cmNlcy5tYXBBdHRyaWJ1dGUoaW5mby5hdHRyTmFtZSk7XG4gICAgICAgIGlmIChrbm93bkF0dHJpYnV0ZSkge1xuICAgICAgICAgIHByb3BlcnR5ID0gdHlwZS5hdHRyaWJ1dGVzW2tub3duQXR0cmlidXRlXTtcblxuICAgICAgICAgIGlmIChwcm9wZXJ0eSkge1xuICAgICAgICAgICAgaW5mby5kZWZhdWx0QmluZGluZ01vZGUgPSBwcm9wZXJ0eS5kZWZhdWx0QmluZGluZ01vZGU7XG5cbiAgICAgICAgICAgIGlmICghaW5mby5jb21tYW5kICYmICFpbmZvLmV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgICAgaW5mby5jb21tYW5kID0gcHJvcGVydHkuaGFzT3B0aW9ucyA/ICdvcHRpb25zJyA6IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGluc3RydWN0aW9uID0gYmluZGluZ0xhbmd1YWdlLmNyZWF0ZUF0dHJpYnV0ZUluc3RydWN0aW9uKHJlc291cmNlcywgbm9kZSwgaW5mbywgdW5kZWZpbmVkLCB0eXBlKTtcblxuICAgICAgaWYgKGluc3RydWN0aW9uKSB7XG4gICAgICAgIGlmIChpbnN0cnVjdGlvbi5hbHRlcmVkQXR0cikge1xuICAgICAgICAgIHR5cGUgPSByZXNvdXJjZXMuZ2V0QXR0cmlidXRlKGluc3RydWN0aW9uLmF0dHJOYW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpbnN0cnVjdGlvbi5kaXNjcmV0ZSkge1xuICAgICAgICAgIGV4cHJlc3Npb25zLnB1c2goaW5zdHJ1Y3Rpb24pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgICAgICBpbnN0cnVjdGlvbi50eXBlID0gdHlwZTtcbiAgICAgICAgICAgIGNvbmZpZ3VyZVByb3BlcnRpZXMoaW5zdHJ1Y3Rpb24sIHJlc291cmNlcyk7XG5cbiAgICAgICAgICAgIGlmICh0eXBlLmxpZnRzQ29udGVudCkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBjYW5ub3QgcGxhY2UgYSB0ZW1wbGF0ZSBjb250cm9sbGVyIG9uIGEgc3Vycm9nYXRlIGVsZW1lbnQuJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBiZWhhdmlvckluc3RydWN0aW9ucy5wdXNoKGluc3RydWN0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXhwcmVzc2lvbnMucHVzaChpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2luc3RydWN0aW9uLmF0dHJOYW1lXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodHlwZSkge1xuICAgICAgICAgIGluc3RydWN0aW9uID0gQmVoYXZpb3JJbnN0cnVjdGlvbi5hdHRyaWJ1dGUoYXR0ck5hbWUsIHR5cGUpO1xuICAgICAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbcmVzb3VyY2VzLm1hcEF0dHJpYnV0ZShhdHRyTmFtZSldID0gYXR0clZhbHVlO1xuXG4gICAgICAgICAgaWYgKHR5cGUubGlmdHNDb250ZW50KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBjYW5ub3QgcGxhY2UgYSB0ZW1wbGF0ZSBjb250cm9sbGVyIG9uIGEgc3Vycm9nYXRlIGVsZW1lbnQuJyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJlaGF2aW9ySW5zdHJ1Y3Rpb25zLnB1c2goaW5zdHJ1Y3Rpb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChhdHRyTmFtZSAhPT0gJ2lkJyAmJiBhdHRyTmFtZSAhPT0gJ3BhcnQnICYmIGF0dHJOYW1lICE9PSAncmVwbGFjZS1wYXJ0Jykge1xuICAgICAgICAgIGhhc1ZhbHVlcyA9IHRydWU7XG4gICAgICAgICAgdmFsdWVzW2F0dHJOYW1lXSA9IGF0dHJWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChleHByZXNzaW9ucy5sZW5ndGggfHwgYmVoYXZpb3JJbnN0cnVjdGlvbnMubGVuZ3RoIHx8IGhhc1ZhbHVlcykge1xuICAgICAgZm9yIChpID0gMCwgaWkgPSBiZWhhdmlvckluc3RydWN0aW9ucy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgIGluc3RydWN0aW9uID0gYmVoYXZpb3JJbnN0cnVjdGlvbnNbaV07XG4gICAgICAgIGluc3RydWN0aW9uLnR5cGUuY29tcGlsZSh0aGlzLCByZXNvdXJjZXMsIG5vZGUsIGluc3RydWN0aW9uKTtcbiAgICAgICAgcHJvdmlkZXJzLnB1c2goaW5zdHJ1Y3Rpb24udHlwZS50YXJnZXQpO1xuICAgICAgfVxuXG4gICAgICBmb3IgKGkgPSAwLCBpaSA9IGV4cHJlc3Npb25zLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25zW2ldO1xuICAgICAgICBpZiAoZXhwcmVzc2lvbi5hdHRyVG9SZW1vdmUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKGV4cHJlc3Npb24uYXR0clRvUmVtb3ZlKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gVGFyZ2V0SW5zdHJ1Y3Rpb24uc3Vycm9nYXRlKHByb3ZpZGVycywgYmVoYXZpb3JJbnN0cnVjdGlvbnMsIGV4cHJlc3Npb25zLCB2YWx1ZXMpO1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIFZpZXdDb21waWxlci5wcm90b3R5cGUuX2NvbXBpbGVFbGVtZW50ID0gZnVuY3Rpb24gX2NvbXBpbGVFbGVtZW50KG5vZGUsIHJlc291cmNlcywgaW5zdHJ1Y3Rpb25zLCBwYXJlbnROb2RlLCBwYXJlbnRJbmplY3RvcklkLCB0YXJnZXRMaWdodERPTSkge1xuICAgIHZhciB0YWdOYW1lID0gbm9kZS50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgdmFyIGF0dHJpYnV0ZXMgPSBub2RlLmF0dHJpYnV0ZXM7XG4gICAgdmFyIGV4cHJlc3Npb25zID0gW107XG4gICAgdmFyIGV4cHJlc3Npb24gPSB2b2lkIDA7XG4gICAgdmFyIGJlaGF2aW9ySW5zdHJ1Y3Rpb25zID0gW107XG4gICAgdmFyIHByb3ZpZGVycyA9IFtdO1xuICAgIHZhciBiaW5kaW5nTGFuZ3VhZ2UgPSByZXNvdXJjZXMuZ2V0QmluZGluZ0xhbmd1YWdlKHRoaXMuYmluZGluZ0xhbmd1YWdlKTtcbiAgICB2YXIgbGlmdGluZ0luc3RydWN0aW9uID0gdm9pZCAwO1xuICAgIHZhciB2aWV3RmFjdG9yeSA9IHZvaWQgMDtcbiAgICB2YXIgdHlwZSA9IHZvaWQgMDtcbiAgICB2YXIgZWxlbWVudEluc3RydWN0aW9uID0gdm9pZCAwO1xuICAgIHZhciBlbGVtZW50UHJvcGVydHkgPSB2b2lkIDA7XG4gICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgdmFyIGlpID0gdm9pZCAwO1xuICAgIHZhciBhdHRyID0gdm9pZCAwO1xuICAgIHZhciBhdHRyTmFtZSA9IHZvaWQgMDtcbiAgICB2YXIgYXR0clZhbHVlID0gdm9pZCAwO1xuICAgIHZhciBpbnN0cnVjdGlvbiA9IHZvaWQgMDtcbiAgICB2YXIgaW5mbyA9IHZvaWQgMDtcbiAgICB2YXIgcHJvcGVydHkgPSB2b2lkIDA7XG4gICAgdmFyIGtub3duQXR0cmlidXRlID0gdm9pZCAwO1xuICAgIHZhciBhdVRhcmdldElEID0gdm9pZCAwO1xuICAgIHZhciBpbmplY3RvcklkID0gdm9pZCAwO1xuXG4gICAgaWYgKHRhZ05hbWUgPT09ICdjb250ZW50Jykge1xuICAgICAgaWYgKHRhcmdldExpZ2h0RE9NKSB7XG4gICAgICAgIGF1VGFyZ2V0SUQgPSBtYWtlSW50b0luc3RydWN0aW9uVGFyZ2V0KG5vZGUpO1xuICAgICAgICBpbnN0cnVjdGlvbnNbYXVUYXJnZXRJRF0gPSBUYXJnZXRJbnN0cnVjdGlvbi5jb250ZW50U2VsZWN0b3Iobm9kZSwgcGFyZW50SW5qZWN0b3JJZCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbm9kZS5uZXh0U2libGluZztcbiAgICB9IGVsc2UgaWYgKHRhZ05hbWUgPT09ICd0ZW1wbGF0ZScpIHtcbiAgICAgIHZpZXdGYWN0b3J5ID0gdGhpcy5jb21waWxlKG5vZGUsIHJlc291cmNlcyk7XG4gICAgICB2aWV3RmFjdG9yeS5wYXJ0ID0gbm9kZS5nZXRBdHRyaWJ1dGUoJ3BhcnQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdHlwZSA9IHJlc291cmNlcy5nZXRFbGVtZW50KG5vZGUuZ2V0QXR0cmlidXRlKCdhcy1lbGVtZW50JykgfHwgdGFnTmFtZSk7XG4gICAgICBpZiAodHlwZSkge1xuICAgICAgICBlbGVtZW50SW5zdHJ1Y3Rpb24gPSBCZWhhdmlvckluc3RydWN0aW9uLmVsZW1lbnQobm9kZSwgdHlwZSk7XG4gICAgICAgIHR5cGUucHJvY2Vzc0F0dHJpYnV0ZXModGhpcywgcmVzb3VyY2VzLCBub2RlLCBhdHRyaWJ1dGVzLCBlbGVtZW50SW5zdHJ1Y3Rpb24pO1xuICAgICAgICBiZWhhdmlvckluc3RydWN0aW9ucy5wdXNoKGVsZW1lbnRJbnN0cnVjdGlvbik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChpID0gMCwgaWkgPSBhdHRyaWJ1dGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGF0dHIgPSBhdHRyaWJ1dGVzW2ldO1xuICAgICAgYXR0ck5hbWUgPSBhdHRyLm5hbWU7XG4gICAgICBhdHRyVmFsdWUgPSBhdHRyLnZhbHVlO1xuICAgICAgaW5mbyA9IGJpbmRpbmdMYW5ndWFnZS5pbnNwZWN0QXR0cmlidXRlKHJlc291cmNlcywgdGFnTmFtZSwgYXR0ck5hbWUsIGF0dHJWYWx1ZSk7XG4gICAgICB0eXBlID0gcmVzb3VyY2VzLmdldEF0dHJpYnV0ZShpbmZvLmF0dHJOYW1lKTtcbiAgICAgIGVsZW1lbnRQcm9wZXJ0eSA9IG51bGw7XG5cbiAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgIGtub3duQXR0cmlidXRlID0gcmVzb3VyY2VzLm1hcEF0dHJpYnV0ZShpbmZvLmF0dHJOYW1lKTtcbiAgICAgICAgaWYgKGtub3duQXR0cmlidXRlKSB7XG4gICAgICAgICAgcHJvcGVydHkgPSB0eXBlLmF0dHJpYnV0ZXNba25vd25BdHRyaWJ1dGVdO1xuXG4gICAgICAgICAgaWYgKHByb3BlcnR5KSB7XG4gICAgICAgICAgICBpbmZvLmRlZmF1bHRCaW5kaW5nTW9kZSA9IHByb3BlcnR5LmRlZmF1bHRCaW5kaW5nTW9kZTtcblxuICAgICAgICAgICAgaWYgKCFpbmZvLmNvbW1hbmQgJiYgIWluZm8uZXhwcmVzc2lvbikge1xuICAgICAgICAgICAgICBpbmZvLmNvbW1hbmQgPSBwcm9wZXJ0eS5oYXNPcHRpb25zID8gJ29wdGlvbnMnIDogbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoZWxlbWVudEluc3RydWN0aW9uKSB7XG4gICAgICAgICAgZWxlbWVudFByb3BlcnR5ID0gZWxlbWVudEluc3RydWN0aW9uLnR5cGUuYXR0cmlidXRlc1tpbmZvLmF0dHJOYW1lXTtcbiAgICAgICAgICBpZiAoZWxlbWVudFByb3BlcnR5KSB7XG4gICAgICAgICAgICBpbmZvLmRlZmF1bHRCaW5kaW5nTW9kZSA9IGVsZW1lbnRQcm9wZXJ0eS5kZWZhdWx0QmluZGluZ01vZGU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgIGlmIChlbGVtZW50UHJvcGVydHkpIHtcbiAgICAgICAgaW5zdHJ1Y3Rpb24gPSBiaW5kaW5nTGFuZ3VhZ2UuY3JlYXRlQXR0cmlidXRlSW5zdHJ1Y3Rpb24ocmVzb3VyY2VzLCBub2RlLCBpbmZvLCBlbGVtZW50SW5zdHJ1Y3Rpb24pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW5zdHJ1Y3Rpb24gPSBiaW5kaW5nTGFuZ3VhZ2UuY3JlYXRlQXR0cmlidXRlSW5zdHJ1Y3Rpb24ocmVzb3VyY2VzLCBub2RlLCBpbmZvLCB1bmRlZmluZWQsIHR5cGUpO1xuICAgICAgfVxuXG4gICAgICBpZiAoaW5zdHJ1Y3Rpb24pIHtcbiAgICAgICAgaWYgKGluc3RydWN0aW9uLmFsdGVyZWRBdHRyKSB7XG4gICAgICAgICAgdHlwZSA9IHJlc291cmNlcy5nZXRBdHRyaWJ1dGUoaW5zdHJ1Y3Rpb24uYXR0ck5hbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGluc3RydWN0aW9uLmRpc2NyZXRlKSB7XG4gICAgICAgICAgZXhwcmVzc2lvbnMucHVzaChpbnN0cnVjdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgICAgIGluc3RydWN0aW9uLnR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgY29uZmlndXJlUHJvcGVydGllcyhpbnN0cnVjdGlvbiwgcmVzb3VyY2VzKTtcblxuICAgICAgICAgICAgaWYgKHR5cGUubGlmdHNDb250ZW50KSB7XG4gICAgICAgICAgICAgIGluc3RydWN0aW9uLm9yaWdpbmFsQXR0ck5hbWUgPSBhdHRyTmFtZTtcbiAgICAgICAgICAgICAgbGlmdGluZ0luc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb247XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgYmVoYXZpb3JJbnN0cnVjdGlvbnMucHVzaChpbnN0cnVjdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50UHJvcGVydHkpIHtcbiAgICAgICAgICAgIGVsZW1lbnRJbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2luZm8uYXR0ck5hbWVdLnRhcmdldFByb3BlcnR5ID0gZWxlbWVudFByb3BlcnR5Lm5hbWU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGV4cHJlc3Npb25zLnB1c2goaW5zdHJ1Y3Rpb24uYXR0cmlidXRlc1tpbnN0cnVjdGlvbi5hdHRyTmFtZV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgICBpbnN0cnVjdGlvbiA9IEJlaGF2aW9ySW5zdHJ1Y3Rpb24uYXR0cmlidXRlKGF0dHJOYW1lLCB0eXBlKTtcbiAgICAgICAgICBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW3Jlc291cmNlcy5tYXBBdHRyaWJ1dGUoYXR0ck5hbWUpXSA9IGF0dHJWYWx1ZTtcblxuICAgICAgICAgIGlmICh0eXBlLmxpZnRzQ29udGVudCkge1xuICAgICAgICAgICAgaW5zdHJ1Y3Rpb24ub3JpZ2luYWxBdHRyTmFtZSA9IGF0dHJOYW1lO1xuICAgICAgICAgICAgbGlmdGluZ0luc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb247XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYmVoYXZpb3JJbnN0cnVjdGlvbnMucHVzaChpbnN0cnVjdGlvbik7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnRQcm9wZXJ0eSkge1xuICAgICAgICAgIGVsZW1lbnRJbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2F0dHJOYW1lXSA9IGF0dHJWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChsaWZ0aW5nSW5zdHJ1Y3Rpb24pIHtcbiAgICAgIGxpZnRpbmdJbnN0cnVjdGlvbi52aWV3RmFjdG9yeSA9IHZpZXdGYWN0b3J5O1xuICAgICAgbm9kZSA9IGxpZnRpbmdJbnN0cnVjdGlvbi50eXBlLmNvbXBpbGUodGhpcywgcmVzb3VyY2VzLCBub2RlLCBsaWZ0aW5nSW5zdHJ1Y3Rpb24sIHBhcmVudE5vZGUpO1xuICAgICAgYXVUYXJnZXRJRCA9IG1ha2VJbnRvSW5zdHJ1Y3Rpb25UYXJnZXQobm9kZSk7XG4gICAgICBpbnN0cnVjdGlvbnNbYXVUYXJnZXRJRF0gPSBUYXJnZXRJbnN0cnVjdGlvbi5saWZ0aW5nKHBhcmVudEluamVjdG9ySWQsIGxpZnRpbmdJbnN0cnVjdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChleHByZXNzaW9ucy5sZW5ndGggfHwgYmVoYXZpb3JJbnN0cnVjdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgIGluamVjdG9ySWQgPSBiZWhhdmlvckluc3RydWN0aW9ucy5sZW5ndGggPyBnZXROZXh0SW5qZWN0b3JJZCgpIDogZmFsc2U7XG5cbiAgICAgICAgZm9yIChpID0gMCwgaWkgPSBiZWhhdmlvckluc3RydWN0aW9ucy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgICAgaW5zdHJ1Y3Rpb24gPSBiZWhhdmlvckluc3RydWN0aW9uc1tpXTtcbiAgICAgICAgICBpbnN0cnVjdGlvbi50eXBlLmNvbXBpbGUodGhpcywgcmVzb3VyY2VzLCBub2RlLCBpbnN0cnVjdGlvbiwgcGFyZW50Tm9kZSk7XG4gICAgICAgICAgcHJvdmlkZXJzLnB1c2goaW5zdHJ1Y3Rpb24udHlwZS50YXJnZXQpO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChpID0gMCwgaWkgPSBleHByZXNzaW9ucy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgICAgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25zW2ldO1xuICAgICAgICAgIGlmIChleHByZXNzaW9uLmF0dHJUb1JlbW92ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShleHByZXNzaW9uLmF0dHJUb1JlbW92ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgYXVUYXJnZXRJRCA9IG1ha2VJbnRvSW5zdHJ1Y3Rpb25UYXJnZXQobm9kZSk7XG4gICAgICAgIGluc3RydWN0aW9uc1thdVRhcmdldElEXSA9IFRhcmdldEluc3RydWN0aW9uLm5vcm1hbChpbmplY3RvcklkLCBwYXJlbnRJbmplY3RvcklkLCBwcm92aWRlcnMsIGJlaGF2aW9ySW5zdHJ1Y3Rpb25zLCBleHByZXNzaW9ucywgZWxlbWVudEluc3RydWN0aW9uKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGVsZW1lbnRJbnN0cnVjdGlvbiAmJiBlbGVtZW50SW5zdHJ1Y3Rpb24uc2tpcENvbnRlbnRQcm9jZXNzaW5nKSB7XG4gICAgICAgIHJldHVybiBub2RlLm5leHRTaWJsaW5nO1xuICAgICAgfVxuXG4gICAgICB2YXIgY3VycmVudENoaWxkID0gbm9kZS5maXJzdENoaWxkO1xuICAgICAgd2hpbGUgKGN1cnJlbnRDaGlsZCkge1xuICAgICAgICBjdXJyZW50Q2hpbGQgPSB0aGlzLl9jb21waWxlTm9kZShjdXJyZW50Q2hpbGQsIHJlc291cmNlcywgaW5zdHJ1Y3Rpb25zLCBub2RlLCBpbmplY3RvcklkIHx8IHBhcmVudEluamVjdG9ySWQsIHRhcmdldExpZ2h0RE9NKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbm9kZS5uZXh0U2libGluZztcbiAgfTtcblxuICByZXR1cm4gVmlld0NvbXBpbGVyO1xufSgpKSB8fCBfY2xhc3MxMyk7XG5cbnZhciBSZXNvdXJjZU1vZHVsZSA9IGV4cG9ydHMuUmVzb3VyY2VNb2R1bGUgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFJlc291cmNlTW9kdWxlKG1vZHVsZUlkKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlc291cmNlTW9kdWxlKTtcblxuICAgIHRoaXMuaWQgPSBtb2R1bGVJZDtcbiAgICB0aGlzLm1vZHVsZUluc3RhbmNlID0gbnVsbDtcbiAgICB0aGlzLm1haW5SZXNvdXJjZSA9IG51bGw7XG4gICAgdGhpcy5yZXNvdXJjZXMgPSBudWxsO1xuICAgIHRoaXMudmlld1N0cmF0ZWd5ID0gbnVsbDtcbiAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICB0aGlzLm9uTG9hZGVkID0gbnVsbDtcbiAgfVxuXG4gIFJlc291cmNlTW9kdWxlLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24gaW5pdGlhbGl6ZShjb250YWluZXIpIHtcbiAgICB2YXIgY3VycmVudCA9IHRoaXMubWFpblJlc291cmNlO1xuICAgIHZhciByZXNvdXJjZXMgPSB0aGlzLnJlc291cmNlcztcbiAgICB2YXIgdnMgPSB0aGlzLnZpZXdTdHJhdGVneTtcblxuICAgIGlmICh0aGlzLmlzSW5pdGlhbGl6ZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuXG4gICAgaWYgKGN1cnJlbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY3VycmVudC5tZXRhZGF0YS52aWV3U3RyYXRlZ3kgPSB2cztcbiAgICAgIGN1cnJlbnQuaW5pdGlhbGl6ZShjb250YWluZXIpO1xuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHJlc291cmNlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBjdXJyZW50ID0gcmVzb3VyY2VzW2ldO1xuICAgICAgY3VycmVudC5tZXRhZGF0YS52aWV3U3RyYXRlZ3kgPSB2cztcbiAgICAgIGN1cnJlbnQuaW5pdGlhbGl6ZShjb250YWluZXIpO1xuICAgIH1cbiAgfTtcblxuICBSZXNvdXJjZU1vZHVsZS5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbiByZWdpc3RlcihyZWdpc3RyeSwgbmFtZSkge1xuICAgIHZhciBtYWluID0gdGhpcy5tYWluUmVzb3VyY2U7XG4gICAgdmFyIHJlc291cmNlcyA9IHRoaXMucmVzb3VyY2VzO1xuXG4gICAgaWYgKG1haW4gIT09IHVuZGVmaW5lZCkge1xuICAgICAgbWFpbi5yZWdpc3RlcihyZWdpc3RyeSwgbmFtZSk7XG4gICAgICBuYW1lID0gbnVsbDtcbiAgICB9XG5cbiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSByZXNvdXJjZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgcmVzb3VyY2VzW2ldLnJlZ2lzdGVyKHJlZ2lzdHJ5LCBuYW1lKTtcbiAgICAgIG5hbWUgPSBudWxsO1xuICAgIH1cbiAgfTtcblxuICBSZXNvdXJjZU1vZHVsZS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIGxvYWQoY29udGFpbmVyLCBsb2FkQ29udGV4dCkge1xuICAgIGlmICh0aGlzLm9uTG9hZGVkICE9PSBudWxsKSB7XG4gICAgICByZXR1cm4gdGhpcy5vbkxvYWRlZDtcbiAgICB9XG5cbiAgICB2YXIgbWFpbiA9IHRoaXMubWFpblJlc291cmNlO1xuICAgIHZhciByZXNvdXJjZXMgPSB0aGlzLnJlc291cmNlcztcbiAgICB2YXIgbG9hZHMgPSB2b2lkIDA7XG5cbiAgICBpZiAobWFpbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBsb2FkcyA9IG5ldyBBcnJheShyZXNvdXJjZXMubGVuZ3RoICsgMSk7XG4gICAgICBsb2Fkc1swXSA9IG1haW4ubG9hZChjb250YWluZXIsIGxvYWRDb250ZXh0KTtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHJlc291cmNlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgIGxvYWRzW2kgKyAxXSA9IHJlc291cmNlc1tpXS5sb2FkKGNvbnRhaW5lciwgbG9hZENvbnRleHQpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBsb2FkcyA9IG5ldyBBcnJheShyZXNvdXJjZXMubGVuZ3RoKTtcbiAgICAgIGZvciAodmFyIF9pID0gMCwgX2lpID0gcmVzb3VyY2VzLmxlbmd0aDsgX2kgPCBfaWk7ICsrX2kpIHtcbiAgICAgICAgbG9hZHNbX2ldID0gcmVzb3VyY2VzW19pXS5sb2FkKGNvbnRhaW5lciwgbG9hZENvbnRleHQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMub25Mb2FkZWQgPSBQcm9taXNlLmFsbChsb2Fkcyk7XG4gICAgcmV0dXJuIHRoaXMub25Mb2FkZWQ7XG4gIH07XG5cbiAgcmV0dXJuIFJlc291cmNlTW9kdWxlO1xufSgpO1xuXG52YXIgUmVzb3VyY2VEZXNjcmlwdGlvbiA9IGV4cG9ydHMuUmVzb3VyY2VEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUmVzb3VyY2VEZXNjcmlwdGlvbihrZXksIGV4cG9ydGVkVmFsdWUsIHJlc291cmNlVHlwZU1ldGEpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmVzb3VyY2VEZXNjcmlwdGlvbik7XG5cbiAgICBpZiAoIXJlc291cmNlVHlwZU1ldGEpIHtcbiAgICAgIHJlc291cmNlVHlwZU1ldGEgPSBfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLmdldChfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLnJlc291cmNlLCBleHBvcnRlZFZhbHVlKTtcblxuICAgICAgaWYgKCFyZXNvdXJjZVR5cGVNZXRhKSB7XG4gICAgICAgIHJlc291cmNlVHlwZU1ldGEgPSBuZXcgSHRtbEJlaGF2aW9yUmVzb3VyY2UoKTtcbiAgICAgICAgcmVzb3VyY2VUeXBlTWV0YS5lbGVtZW50TmFtZSA9IF9oeXBoZW5hdGUoa2V5KTtcbiAgICAgICAgX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5kZWZpbmUoX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5yZXNvdXJjZSwgcmVzb3VyY2VUeXBlTWV0YSwgZXhwb3J0ZWRWYWx1ZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHJlc291cmNlVHlwZU1ldGEgaW5zdGFuY2VvZiBIdG1sQmVoYXZpb3JSZXNvdXJjZSkge1xuICAgICAgaWYgKHJlc291cmNlVHlwZU1ldGEuZWxlbWVudE5hbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXNvdXJjZVR5cGVNZXRhLmVsZW1lbnROYW1lID0gX2h5cGhlbmF0ZShrZXkpO1xuICAgICAgfSBlbHNlIGlmIChyZXNvdXJjZVR5cGVNZXRhLmF0dHJpYnV0ZU5hbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXNvdXJjZVR5cGVNZXRhLmF0dHJpYnV0ZU5hbWUgPSBfaHlwaGVuYXRlKGtleSk7XG4gICAgICB9IGVsc2UgaWYgKHJlc291cmNlVHlwZU1ldGEuYXR0cmlidXRlTmFtZSA9PT0gbnVsbCAmJiByZXNvdXJjZVR5cGVNZXRhLmVsZW1lbnROYW1lID09PSBudWxsKSB7XG4gICAgICAgIEh0bWxCZWhhdmlvclJlc291cmNlLmNvbnZlbnRpb24oa2V5LCByZXNvdXJjZVR5cGVNZXRhKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKCFyZXNvdXJjZVR5cGVNZXRhLm5hbWUpIHtcbiAgICAgIHJlc291cmNlVHlwZU1ldGEubmFtZSA9IF9oeXBoZW5hdGUoa2V5KTtcbiAgICB9XG5cbiAgICB0aGlzLm1ldGFkYXRhID0gcmVzb3VyY2VUeXBlTWV0YTtcbiAgICB0aGlzLnZhbHVlID0gZXhwb3J0ZWRWYWx1ZTtcbiAgfVxuXG4gIFJlc291cmNlRGVzY3JpcHRpb24ucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiBpbml0aWFsaXplKGNvbnRhaW5lcikge1xuICAgIHRoaXMubWV0YWRhdGEuaW5pdGlhbGl6ZShjb250YWluZXIsIHRoaXMudmFsdWUpO1xuICB9O1xuXG4gIFJlc291cmNlRGVzY3JpcHRpb24ucHJvdG90eXBlLnJlZ2lzdGVyID0gZnVuY3Rpb24gcmVnaXN0ZXIocmVnaXN0cnksIG5hbWUpIHtcbiAgICB0aGlzLm1ldGFkYXRhLnJlZ2lzdGVyKHJlZ2lzdHJ5LCBuYW1lKTtcbiAgfTtcblxuICBSZXNvdXJjZURlc2NyaXB0aW9uLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gbG9hZChjb250YWluZXIsIGxvYWRDb250ZXh0KSB7XG4gICAgcmV0dXJuIHRoaXMubWV0YWRhdGEubG9hZChjb250YWluZXIsIHRoaXMudmFsdWUsIGxvYWRDb250ZXh0KTtcbiAgfTtcblxuICByZXR1cm4gUmVzb3VyY2VEZXNjcmlwdGlvbjtcbn0oKTtcblxudmFyIE1vZHVsZUFuYWx5emVyID0gZXhwb3J0cy5Nb2R1bGVBbmFseXplciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gTW9kdWxlQW5hbHl6ZXIoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1vZHVsZUFuYWx5emVyKTtcblxuICAgIHRoaXMuY2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICB9XG5cbiAgTW9kdWxlQW5hbHl6ZXIucHJvdG90eXBlLmdldEFuYWx5c2lzID0gZnVuY3Rpb24gZ2V0QW5hbHlzaXMobW9kdWxlSWQpIHtcbiAgICByZXR1cm4gdGhpcy5jYWNoZVttb2R1bGVJZF07XG4gIH07XG5cbiAgTW9kdWxlQW5hbHl6ZXIucHJvdG90eXBlLmFuYWx5emUgPSBmdW5jdGlvbiBhbmFseXplKG1vZHVsZUlkLCBtb2R1bGVJbnN0YW5jZSwgbWFpblJlc291cmNlS2V5KSB7XG4gICAgdmFyIG1haW5SZXNvdXJjZSA9IHZvaWQgMDtcbiAgICB2YXIgZmFsbGJhY2tWYWx1ZSA9IHZvaWQgMDtcbiAgICB2YXIgZmFsbGJhY2tLZXkgPSB2b2lkIDA7XG4gICAgdmFyIHJlc291cmNlVHlwZU1ldGEgPSB2b2lkIDA7XG4gICAgdmFyIGtleSA9IHZvaWQgMDtcbiAgICB2YXIgZXhwb3J0ZWRWYWx1ZSA9IHZvaWQgMDtcbiAgICB2YXIgcmVzb3VyY2VzID0gW107XG4gICAgdmFyIGNvbnZlbnRpb25hbCA9IHZvaWQgMDtcbiAgICB2YXIgdnMgPSB2b2lkIDA7XG4gICAgdmFyIHJlc291cmNlTW9kdWxlID0gdm9pZCAwO1xuXG4gICAgcmVzb3VyY2VNb2R1bGUgPSB0aGlzLmNhY2hlW21vZHVsZUlkXTtcbiAgICBpZiAocmVzb3VyY2VNb2R1bGUpIHtcbiAgICAgIHJldHVybiByZXNvdXJjZU1vZHVsZTtcbiAgICB9XG5cbiAgICByZXNvdXJjZU1vZHVsZSA9IG5ldyBSZXNvdXJjZU1vZHVsZShtb2R1bGVJZCk7XG4gICAgdGhpcy5jYWNoZVttb2R1bGVJZF0gPSByZXNvdXJjZU1vZHVsZTtcblxuICAgIGlmICh0eXBlb2YgbW9kdWxlSW5zdGFuY2UgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIG1vZHVsZUluc3RhbmNlID0geyAnZGVmYXVsdCc6IG1vZHVsZUluc3RhbmNlIH07XG4gICAgfVxuXG4gICAgaWYgKG1haW5SZXNvdXJjZUtleSkge1xuICAgICAgbWFpblJlc291cmNlID0gbmV3IFJlc291cmNlRGVzY3JpcHRpb24obWFpblJlc291cmNlS2V5LCBtb2R1bGVJbnN0YW5jZVttYWluUmVzb3VyY2VLZXldKTtcbiAgICB9XG5cbiAgICBmb3IgKGtleSBpbiBtb2R1bGVJbnN0YW5jZSkge1xuICAgICAgZXhwb3J0ZWRWYWx1ZSA9IG1vZHVsZUluc3RhbmNlW2tleV07XG5cbiAgICAgIGlmIChrZXkgPT09IG1haW5SZXNvdXJjZUtleSB8fCB0eXBlb2YgZXhwb3J0ZWRWYWx1ZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgcmVzb3VyY2VUeXBlTWV0YSA9IF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEuZ2V0KF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEucmVzb3VyY2UsIGV4cG9ydGVkVmFsdWUpO1xuXG4gICAgICBpZiAocmVzb3VyY2VUeXBlTWV0YSkge1xuICAgICAgICBpZiAocmVzb3VyY2VUeXBlTWV0YS5hdHRyaWJ1dGVOYW1lID09PSBudWxsICYmIHJlc291cmNlVHlwZU1ldGEuZWxlbWVudE5hbWUgPT09IG51bGwpIHtcbiAgICAgICAgICBIdG1sQmVoYXZpb3JSZXNvdXJjZS5jb252ZW50aW9uKGtleSwgcmVzb3VyY2VUeXBlTWV0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmVzb3VyY2VUeXBlTWV0YS5hdHRyaWJ1dGVOYW1lID09PSBudWxsICYmIHJlc291cmNlVHlwZU1ldGEuZWxlbWVudE5hbWUgPT09IG51bGwpIHtcbiAgICAgICAgICByZXNvdXJjZVR5cGVNZXRhLmVsZW1lbnROYW1lID0gX2h5cGhlbmF0ZShrZXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFtYWluUmVzb3VyY2UgJiYgcmVzb3VyY2VUeXBlTWV0YSBpbnN0YW5jZW9mIEh0bWxCZWhhdmlvclJlc291cmNlICYmIHJlc291cmNlVHlwZU1ldGEuZWxlbWVudE5hbWUgIT09IG51bGwpIHtcbiAgICAgICAgICBtYWluUmVzb3VyY2UgPSBuZXcgUmVzb3VyY2VEZXNjcmlwdGlvbihrZXksIGV4cG9ydGVkVmFsdWUsIHJlc291cmNlVHlwZU1ldGEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc291cmNlcy5wdXNoKG5ldyBSZXNvdXJjZURlc2NyaXB0aW9uKGtleSwgZXhwb3J0ZWRWYWx1ZSwgcmVzb3VyY2VUeXBlTWV0YSkpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHZpZXdTdHJhdGVneS5kZWNvcmF0ZXMoZXhwb3J0ZWRWYWx1ZSkpIHtcbiAgICAgICAgdnMgPSBleHBvcnRlZFZhbHVlO1xuICAgICAgfSBlbHNlIGlmIChleHBvcnRlZFZhbHVlIGluc3RhbmNlb2YgX2F1cmVsaWFMb2FkZXIuVGVtcGxhdGVSZWdpc3RyeUVudHJ5KSB7XG4gICAgICAgIHZzID0gbmV3IFRlbXBsYXRlUmVnaXN0cnlWaWV3U3RyYXRlZ3kobW9kdWxlSWQsIGV4cG9ydGVkVmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGNvbnZlbnRpb25hbCA9IEh0bWxCZWhhdmlvclJlc291cmNlLmNvbnZlbnRpb24oa2V5KSkge1xuICAgICAgICAgIGlmIChjb252ZW50aW9uYWwuZWxlbWVudE5hbWUgIT09IG51bGwgJiYgIW1haW5SZXNvdXJjZSkge1xuICAgICAgICAgICAgbWFpblJlc291cmNlID0gbmV3IFJlc291cmNlRGVzY3JpcHRpb24oa2V5LCBleHBvcnRlZFZhbHVlLCBjb252ZW50aW9uYWwpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXNvdXJjZXMucHVzaChuZXcgUmVzb3VyY2VEZXNjcmlwdGlvbihrZXksIGV4cG9ydGVkVmFsdWUsIGNvbnZlbnRpb25hbCkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEuZGVmaW5lKF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEucmVzb3VyY2UsIGNvbnZlbnRpb25hbCwgZXhwb3J0ZWRWYWx1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoY29udmVudGlvbmFsID0gX2F1cmVsaWFCaW5kaW5nLlZhbHVlQ29udmVydGVyUmVzb3VyY2UuY29udmVudGlvbihrZXkpKSB7XG4gICAgICAgICAgcmVzb3VyY2VzLnB1c2gobmV3IFJlc291cmNlRGVzY3JpcHRpb24oa2V5LCBleHBvcnRlZFZhbHVlLCBjb252ZW50aW9uYWwpKTtcbiAgICAgICAgICBfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLmRlZmluZShfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLnJlc291cmNlLCBjb252ZW50aW9uYWwsIGV4cG9ydGVkVmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKGNvbnZlbnRpb25hbCA9IF9hdXJlbGlhQmluZGluZy5CaW5kaW5nQmVoYXZpb3JSZXNvdXJjZS5jb252ZW50aW9uKGtleSkpIHtcbiAgICAgICAgICByZXNvdXJjZXMucHVzaChuZXcgUmVzb3VyY2VEZXNjcmlwdGlvbihrZXksIGV4cG9ydGVkVmFsdWUsIGNvbnZlbnRpb25hbCkpO1xuICAgICAgICAgIF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEuZGVmaW5lKF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEucmVzb3VyY2UsIGNvbnZlbnRpb25hbCwgZXhwb3J0ZWRWYWx1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoIWZhbGxiYWNrVmFsdWUpIHtcbiAgICAgICAgICBmYWxsYmFja1ZhbHVlID0gZXhwb3J0ZWRWYWx1ZTtcbiAgICAgICAgICBmYWxsYmFja0tleSA9IGtleTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghbWFpblJlc291cmNlICYmIGZhbGxiYWNrVmFsdWUpIHtcbiAgICAgIG1haW5SZXNvdXJjZSA9IG5ldyBSZXNvdXJjZURlc2NyaXB0aW9uKGZhbGxiYWNrS2V5LCBmYWxsYmFja1ZhbHVlKTtcbiAgICB9XG5cbiAgICByZXNvdXJjZU1vZHVsZS5tb2R1bGVJbnN0YW5jZSA9IG1vZHVsZUluc3RhbmNlO1xuICAgIHJlc291cmNlTW9kdWxlLm1haW5SZXNvdXJjZSA9IG1haW5SZXNvdXJjZTtcbiAgICByZXNvdXJjZU1vZHVsZS5yZXNvdXJjZXMgPSByZXNvdXJjZXM7XG4gICAgcmVzb3VyY2VNb2R1bGUudmlld1N0cmF0ZWd5ID0gdnM7XG5cbiAgICByZXR1cm4gcmVzb3VyY2VNb2R1bGU7XG4gIH07XG5cbiAgcmV0dXJuIE1vZHVsZUFuYWx5emVyO1xufSgpO1xuXG52YXIgbG9nZ2VyID0gTG9nTWFuYWdlci5nZXRMb2dnZXIoJ3RlbXBsYXRpbmcnKTtcblxuZnVuY3Rpb24gZW5zdXJlUmVnaXN0cnlFbnRyeShsb2FkZXIsIHVybE9yUmVnaXN0cnlFbnRyeSkge1xuICBpZiAodXJsT3JSZWdpc3RyeUVudHJ5IGluc3RhbmNlb2YgX2F1cmVsaWFMb2FkZXIuVGVtcGxhdGVSZWdpc3RyeUVudHJ5KSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh1cmxPclJlZ2lzdHJ5RW50cnkpO1xuICB9XG5cbiAgcmV0dXJuIGxvYWRlci5sb2FkVGVtcGxhdGUodXJsT3JSZWdpc3RyeUVudHJ5KTtcbn1cblxudmFyIFByb3h5Vmlld0ZhY3RvcnkgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFByb3h5Vmlld0ZhY3RvcnkocHJvbWlzZSkge1xuICAgIHZhciBfdGhpczcgPSB0aGlzO1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFByb3h5Vmlld0ZhY3RvcnkpO1xuXG4gICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uICh4KSB7XG4gICAgICByZXR1cm4gX3RoaXM3LnZpZXdGYWN0b3J5ID0geDtcbiAgICB9KTtcbiAgfVxuXG4gIFByb3h5Vmlld0ZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uIGNyZWF0ZShjb250YWluZXIsIGJpbmRpbmdDb250ZXh0LCBjcmVhdGVJbnN0cnVjdGlvbiwgZWxlbWVudCkge1xuICAgIHJldHVybiB0aGlzLnZpZXdGYWN0b3J5LmNyZWF0ZShjb250YWluZXIsIGJpbmRpbmdDb250ZXh0LCBjcmVhdGVJbnN0cnVjdGlvbiwgZWxlbWVudCk7XG4gIH07XG5cbiAgUHJveHlWaWV3RmFjdG9yeS5wcm90b3R5cGUuc2V0Q2FjaGVTaXplID0gZnVuY3Rpb24gc2V0Q2FjaGVTaXplKHNpemUsIGRvTm90T3ZlcnJpZGVJZkFscmVhZHlTZXQpIHtcbiAgICB0aGlzLnZpZXdGYWN0b3J5LnNldENhY2hlU2l6ZShzaXplLCBkb05vdE92ZXJyaWRlSWZBbHJlYWR5U2V0KTtcbiAgfTtcblxuICBQcm94eVZpZXdGYWN0b3J5LnByb3RvdHlwZS5nZXRDYWNoZWRWaWV3ID0gZnVuY3Rpb24gZ2V0Q2FjaGVkVmlldygpIHtcbiAgICByZXR1cm4gdGhpcy52aWV3RmFjdG9yeS5nZXRDYWNoZWRWaWV3KCk7XG4gIH07XG5cbiAgUHJveHlWaWV3RmFjdG9yeS5wcm90b3R5cGUucmV0dXJuVmlld1RvQ2FjaGUgPSBmdW5jdGlvbiByZXR1cm5WaWV3VG9DYWNoZSh2aWV3KSB7XG4gICAgdGhpcy52aWV3RmFjdG9yeS5yZXR1cm5WaWV3VG9DYWNoZSh2aWV3KTtcbiAgfTtcblxuICBfY3JlYXRlQ2xhc3MoUHJveHlWaWV3RmFjdG9yeSwgW3tcbiAgICBrZXk6ICdpc0NhY2hpbmcnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMudmlld0ZhY3RvcnkuaXNDYWNoaW5nO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBQcm94eVZpZXdGYWN0b3J5O1xufSgpO1xuXG52YXIgVmlld0VuZ2luZSA9IGV4cG9ydHMuVmlld0VuZ2luZSA9IChfZGVjNyA9ICgwLCBfYXVyZWxpYURlcGVuZGVuY3lJbmplY3Rpb24uaW5qZWN0KShfYXVyZWxpYUxvYWRlci5Mb2FkZXIsIF9hdXJlbGlhRGVwZW5kZW5jeUluamVjdGlvbi5Db250YWluZXIsIFZpZXdDb21waWxlciwgTW9kdWxlQW5hbHl6ZXIsIFZpZXdSZXNvdXJjZXMpLCBfZGVjNyhfY2xhc3MxNCA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gVmlld0VuZ2luZShsb2FkZXIsIGNvbnRhaW5lciwgdmlld0NvbXBpbGVyLCBtb2R1bGVBbmFseXplciwgYXBwUmVzb3VyY2VzKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpZXdFbmdpbmUpO1xuXG4gICAgdGhpcy5sb2FkZXIgPSBsb2FkZXI7XG4gICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG4gICAgdGhpcy52aWV3Q29tcGlsZXIgPSB2aWV3Q29tcGlsZXI7XG4gICAgdGhpcy5tb2R1bGVBbmFseXplciA9IG1vZHVsZUFuYWx5emVyO1xuICAgIHRoaXMuYXBwUmVzb3VyY2VzID0gYXBwUmVzb3VyY2VzO1xuICAgIHRoaXMuX3BsdWdpbk1hcCA9IHt9O1xuICB9XG5cbiAgVmlld0VuZ2luZS5wcm90b3R5cGUuYWRkUmVzb3VyY2VQbHVnaW4gPSBmdW5jdGlvbiBhZGRSZXNvdXJjZVBsdWdpbihleHRlbnNpb24sIGltcGxlbWVudGF0aW9uKSB7XG4gICAgdmFyIG5hbWUgPSBleHRlbnNpb24ucmVwbGFjZSgnLicsICcnKSArICctcmVzb3VyY2UtcGx1Z2luJztcbiAgICB0aGlzLl9wbHVnaW5NYXBbZXh0ZW5zaW9uXSA9IG5hbWU7XG4gICAgdGhpcy5sb2FkZXIuYWRkUGx1Z2luKG5hbWUsIGltcGxlbWVudGF0aW9uKTtcbiAgfTtcblxuICBWaWV3RW5naW5lLnByb3RvdHlwZS5sb2FkVmlld0ZhY3RvcnkgPSBmdW5jdGlvbiBsb2FkVmlld0ZhY3RvcnkodXJsT3JSZWdpc3RyeUVudHJ5LCBjb21waWxlSW5zdHJ1Y3Rpb24sIGxvYWRDb250ZXh0KSB7XG4gICAgdmFyIF90aGlzOCA9IHRoaXM7XG5cbiAgICBsb2FkQ29udGV4dCA9IGxvYWRDb250ZXh0IHx8IG5ldyBSZXNvdXJjZUxvYWRDb250ZXh0KCk7XG5cbiAgICByZXR1cm4gZW5zdXJlUmVnaXN0cnlFbnRyeSh0aGlzLmxvYWRlciwgdXJsT3JSZWdpc3RyeUVudHJ5KS50aGVuKGZ1bmN0aW9uIChyZWdpc3RyeUVudHJ5KSB7XG4gICAgICBpZiAocmVnaXN0cnlFbnRyeS5vblJlYWR5KSB7XG4gICAgICAgIGlmICghbG9hZENvbnRleHQuaGFzRGVwZW5kZW5jeSh1cmxPclJlZ2lzdHJ5RW50cnkpKSB7XG4gICAgICAgICAgbG9hZENvbnRleHQuYWRkRGVwZW5kZW5jeSh1cmxPclJlZ2lzdHJ5RW50cnkpO1xuICAgICAgICAgIHJldHVybiByZWdpc3RyeUVudHJ5Lm9uUmVhZHk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBQcm94eVZpZXdGYWN0b3J5KHJlZ2lzdHJ5RW50cnkub25SZWFkeSkpO1xuICAgICAgfVxuXG4gICAgICBsb2FkQ29udGV4dC5hZGREZXBlbmRlbmN5KHVybE9yUmVnaXN0cnlFbnRyeSk7XG5cbiAgICAgIHJlZ2lzdHJ5RW50cnkub25SZWFkeSA9IF90aGlzOC5sb2FkVGVtcGxhdGVSZXNvdXJjZXMocmVnaXN0cnlFbnRyeSwgY29tcGlsZUluc3RydWN0aW9uLCBsb2FkQ29udGV4dCkudGhlbihmdW5jdGlvbiAocmVzb3VyY2VzKSB7XG4gICAgICAgIHJlZ2lzdHJ5RW50cnkucmVzb3VyY2VzID0gcmVzb3VyY2VzO1xuICAgICAgICB2YXIgdmlld0ZhY3RvcnkgPSBfdGhpczgudmlld0NvbXBpbGVyLmNvbXBpbGUocmVnaXN0cnlFbnRyeS50ZW1wbGF0ZSwgcmVzb3VyY2VzLCBjb21waWxlSW5zdHJ1Y3Rpb24pO1xuICAgICAgICByZWdpc3RyeUVudHJ5LmZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcbiAgICAgICAgcmV0dXJuIHZpZXdGYWN0b3J5O1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiByZWdpc3RyeUVudHJ5Lm9uUmVhZHk7XG4gICAgfSk7XG4gIH07XG5cbiAgVmlld0VuZ2luZS5wcm90b3R5cGUubG9hZFRlbXBsYXRlUmVzb3VyY2VzID0gZnVuY3Rpb24gbG9hZFRlbXBsYXRlUmVzb3VyY2VzKHJlZ2lzdHJ5RW50cnksIGNvbXBpbGVJbnN0cnVjdGlvbiwgbG9hZENvbnRleHQpIHtcbiAgICB2YXIgcmVzb3VyY2VzID0gbmV3IFZpZXdSZXNvdXJjZXModGhpcy5hcHBSZXNvdXJjZXMsIHJlZ2lzdHJ5RW50cnkuYWRkcmVzcyk7XG4gICAgdmFyIGRlcGVuZGVuY2llcyA9IHJlZ2lzdHJ5RW50cnkuZGVwZW5kZW5jaWVzO1xuICAgIHZhciBpbXBvcnRJZHMgPSB2b2lkIDA7XG4gICAgdmFyIG5hbWVzID0gdm9pZCAwO1xuXG4gICAgY29tcGlsZUluc3RydWN0aW9uID0gY29tcGlsZUluc3RydWN0aW9uIHx8IFZpZXdDb21waWxlSW5zdHJ1Y3Rpb24ubm9ybWFsO1xuXG4gICAgaWYgKGRlcGVuZGVuY2llcy5sZW5ndGggPT09IDAgJiYgIWNvbXBpbGVJbnN0cnVjdGlvbi5hc3NvY2lhdGVkTW9kdWxlSWQpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzb3VyY2VzKTtcbiAgICB9XG5cbiAgICBpbXBvcnRJZHMgPSBkZXBlbmRlbmNpZXMubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICByZXR1cm4geC5zcmM7XG4gICAgfSk7XG4gICAgbmFtZXMgPSBkZXBlbmRlbmNpZXMubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICByZXR1cm4geC5uYW1lO1xuICAgIH0pO1xuICAgIGxvZ2dlci5kZWJ1ZygnaW1wb3J0aW5nIHJlc291cmNlcyBmb3IgJyArIHJlZ2lzdHJ5RW50cnkuYWRkcmVzcywgaW1wb3J0SWRzKTtcblxuICAgIHJldHVybiB0aGlzLmltcG9ydFZpZXdSZXNvdXJjZXMoaW1wb3J0SWRzLCBuYW1lcywgcmVzb3VyY2VzLCBjb21waWxlSW5zdHJ1Y3Rpb24sIGxvYWRDb250ZXh0KTtcbiAgfTtcblxuICBWaWV3RW5naW5lLnByb3RvdHlwZS5pbXBvcnRWaWV3TW9kZWxSZXNvdXJjZSA9IGZ1bmN0aW9uIGltcG9ydFZpZXdNb2RlbFJlc291cmNlKG1vZHVsZUltcG9ydCwgbW9kdWxlTWVtYmVyKSB7XG4gICAgdmFyIF90aGlzOSA9IHRoaXM7XG5cbiAgICByZXR1cm4gdGhpcy5sb2FkZXIubG9hZE1vZHVsZShtb2R1bGVJbXBvcnQpLnRoZW4oZnVuY3Rpb24gKHZpZXdNb2RlbE1vZHVsZSkge1xuICAgICAgdmFyIG5vcm1hbGl6ZWRJZCA9IF9hdXJlbGlhTWV0YWRhdGEuT3JpZ2luLmdldCh2aWV3TW9kZWxNb2R1bGUpLm1vZHVsZUlkO1xuICAgICAgdmFyIHJlc291cmNlTW9kdWxlID0gX3RoaXM5Lm1vZHVsZUFuYWx5emVyLmFuYWx5emUobm9ybWFsaXplZElkLCB2aWV3TW9kZWxNb2R1bGUsIG1vZHVsZU1lbWJlcik7XG5cbiAgICAgIGlmICghcmVzb3VyY2VNb2R1bGUubWFpblJlc291cmNlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gdmlldyBtb2RlbCBmb3VuZCBpbiBtb2R1bGUgXCInICsgbW9kdWxlSW1wb3J0ICsgJ1wiLicpO1xuICAgICAgfVxuXG4gICAgICByZXNvdXJjZU1vZHVsZS5pbml0aWFsaXplKF90aGlzOS5jb250YWluZXIpO1xuXG4gICAgICByZXR1cm4gcmVzb3VyY2VNb2R1bGUubWFpblJlc291cmNlO1xuICAgIH0pO1xuICB9O1xuXG4gIFZpZXdFbmdpbmUucHJvdG90eXBlLmltcG9ydFZpZXdSZXNvdXJjZXMgPSBmdW5jdGlvbiBpbXBvcnRWaWV3UmVzb3VyY2VzKG1vZHVsZUlkcywgbmFtZXMsIHJlc291cmNlcywgY29tcGlsZUluc3RydWN0aW9uLCBsb2FkQ29udGV4dCkge1xuICAgIHZhciBfdGhpczEwID0gdGhpcztcblxuICAgIGxvYWRDb250ZXh0ID0gbG9hZENvbnRleHQgfHwgbmV3IFJlc291cmNlTG9hZENvbnRleHQoKTtcbiAgICBjb21waWxlSW5zdHJ1Y3Rpb24gPSBjb21waWxlSW5zdHJ1Y3Rpb24gfHwgVmlld0NvbXBpbGVJbnN0cnVjdGlvbi5ub3JtYWw7XG5cbiAgICBtb2R1bGVJZHMgPSBtb2R1bGVJZHMubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICByZXR1cm4gX3RoaXMxMC5fYXBwbHlMb2FkZXJQbHVnaW4oeCk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcy5sb2FkZXIubG9hZEFsbE1vZHVsZXMobW9kdWxlSWRzKS50aGVuKGZ1bmN0aW9uIChpbXBvcnRzKSB7XG4gICAgICB2YXIgaSA9IHZvaWQgMDtcbiAgICAgIHZhciBpaSA9IHZvaWQgMDtcbiAgICAgIHZhciBhbmFseXNpcyA9IHZvaWQgMDtcbiAgICAgIHZhciBub3JtYWxpemVkSWQgPSB2b2lkIDA7XG4gICAgICB2YXIgY3VycmVudCA9IHZvaWQgMDtcbiAgICAgIHZhciBhc3NvY2lhdGVkTW9kdWxlID0gdm9pZCAwO1xuICAgICAgdmFyIGNvbnRhaW5lciA9IF90aGlzMTAuY29udGFpbmVyO1xuICAgICAgdmFyIG1vZHVsZUFuYWx5emVyID0gX3RoaXMxMC5tb2R1bGVBbmFseXplcjtcbiAgICAgIHZhciBhbGxBbmFseXNpcyA9IG5ldyBBcnJheShpbXBvcnRzLmxlbmd0aCk7XG5cbiAgICAgIGZvciAoaSA9IDAsIGlpID0gaW1wb3J0cy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgIGN1cnJlbnQgPSBpbXBvcnRzW2ldO1xuICAgICAgICBub3JtYWxpemVkSWQgPSBfYXVyZWxpYU1ldGFkYXRhLk9yaWdpbi5nZXQoY3VycmVudCkubW9kdWxlSWQ7XG5cbiAgICAgICAgYW5hbHlzaXMgPSBtb2R1bGVBbmFseXplci5hbmFseXplKG5vcm1hbGl6ZWRJZCwgY3VycmVudCk7XG4gICAgICAgIGFuYWx5c2lzLmluaXRpYWxpemUoY29udGFpbmVyKTtcbiAgICAgICAgYW5hbHlzaXMucmVnaXN0ZXIocmVzb3VyY2VzLCBuYW1lc1tpXSk7XG5cbiAgICAgICAgYWxsQW5hbHlzaXNbaV0gPSBhbmFseXNpcztcbiAgICAgIH1cblxuICAgICAgaWYgKGNvbXBpbGVJbnN0cnVjdGlvbi5hc3NvY2lhdGVkTW9kdWxlSWQpIHtcbiAgICAgICAgYXNzb2NpYXRlZE1vZHVsZSA9IG1vZHVsZUFuYWx5emVyLmdldEFuYWx5c2lzKGNvbXBpbGVJbnN0cnVjdGlvbi5hc3NvY2lhdGVkTW9kdWxlSWQpO1xuXG4gICAgICAgIGlmIChhc3NvY2lhdGVkTW9kdWxlKSB7XG4gICAgICAgICAgYXNzb2NpYXRlZE1vZHVsZS5yZWdpc3RlcihyZXNvdXJjZXMpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZvciAoaSA9IDAsIGlpID0gYWxsQW5hbHlzaXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBhbGxBbmFseXNpc1tpXSA9IGFsbEFuYWx5c2lzW2ldLmxvYWQoY29udGFpbmVyLCBsb2FkQ29udGV4dCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChhbGxBbmFseXNpcykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiByZXNvdXJjZXM7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBWaWV3RW5naW5lLnByb3RvdHlwZS5fYXBwbHlMb2FkZXJQbHVnaW4gPSBmdW5jdGlvbiBfYXBwbHlMb2FkZXJQbHVnaW4oaWQpIHtcbiAgICB2YXIgaW5kZXggPSBpZC5sYXN0SW5kZXhPZignLicpO1xuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgIHZhciBleHQgPSBpZC5zdWJzdHJpbmcoaW5kZXgpO1xuICAgICAgdmFyIHBsdWdpbk5hbWUgPSB0aGlzLl9wbHVnaW5NYXBbZXh0XTtcblxuICAgICAgaWYgKHBsdWdpbk5hbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gaWQ7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmxvYWRlci5hcHBseVBsdWdpblRvVXJsKGlkLCBwbHVnaW5OYW1lKTtcbiAgICB9XG5cbiAgICByZXR1cm4gaWQ7XG4gIH07XG5cbiAgcmV0dXJuIFZpZXdFbmdpbmU7XG59KCkpIHx8IF9jbGFzczE0KTtcblxudmFyIENvbnRyb2xsZXIgPSBleHBvcnRzLkNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIENvbnRyb2xsZXIoYmVoYXZpb3IsIGluc3RydWN0aW9uLCB2aWV3TW9kZWwsIGVsZW1lbnRFdmVudHMpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29udHJvbGxlcik7XG5cbiAgICB0aGlzLmJlaGF2aW9yID0gYmVoYXZpb3I7XG4gICAgdGhpcy5pbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uO1xuICAgIHRoaXMudmlld01vZGVsID0gdmlld01vZGVsO1xuICAgIHRoaXMuaXNBdHRhY2hlZCA9IGZhbHNlO1xuICAgIHRoaXMudmlldyA9IG51bGw7XG4gICAgdGhpcy5pc0JvdW5kID0gZmFsc2U7XG4gICAgdGhpcy5zY29wZSA9IG51bGw7XG4gICAgdGhpcy5lbGVtZW50RXZlbnRzID0gZWxlbWVudEV2ZW50cyB8fCBudWxsO1xuXG4gICAgdmFyIG9ic2VydmVyTG9va3VwID0gYmVoYXZpb3Iub2JzZXJ2ZXJMb2NhdG9yLmdldE9yQ3JlYXRlT2JzZXJ2ZXJzTG9va3VwKHZpZXdNb2RlbCk7XG4gICAgdmFyIGhhbmRsZXNCaW5kID0gYmVoYXZpb3IuaGFuZGxlc0JpbmQ7XG4gICAgdmFyIGF0dHJpYnV0ZXMgPSBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzO1xuICAgIHZhciBib3VuZFByb3BlcnRpZXMgPSB0aGlzLmJvdW5kUHJvcGVydGllcyA9IFtdO1xuICAgIHZhciBwcm9wZXJ0aWVzID0gYmVoYXZpb3IucHJvcGVydGllcztcbiAgICB2YXIgaSA9IHZvaWQgMDtcbiAgICB2YXIgaWkgPSB2b2lkIDA7XG5cbiAgICBiZWhhdmlvci5fZW5zdXJlUHJvcGVydGllc0RlZmluZWQodmlld01vZGVsLCBvYnNlcnZlckxvb2t1cCk7XG5cbiAgICBmb3IgKGkgPSAwLCBpaSA9IHByb3BlcnRpZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgcHJvcGVydGllc1tpXS5faW5pdGlhbGl6ZSh2aWV3TW9kZWwsIG9ic2VydmVyTG9va3VwLCBhdHRyaWJ1dGVzLCBoYW5kbGVzQmluZCwgYm91bmRQcm9wZXJ0aWVzKTtcbiAgICB9XG4gIH1cblxuICBDb250cm9sbGVyLnByb3RvdHlwZS5jcmVhdGVkID0gZnVuY3Rpb24gY3JlYXRlZChvd25pbmdWaWV3KSB7XG4gICAgaWYgKHRoaXMuYmVoYXZpb3IuaGFuZGxlc0NyZWF0ZWQpIHtcbiAgICAgIHRoaXMudmlld01vZGVsLmNyZWF0ZWQob3duaW5nVmlldywgdGhpcy52aWV3KTtcbiAgICB9XG4gIH07XG5cbiAgQ29udHJvbGxlci5wcm90b3R5cGUuYXV0b21hdGUgPSBmdW5jdGlvbiBhdXRvbWF0ZShvdmVycmlkZUNvbnRleHQsIG93bmluZ1ZpZXcpIHtcbiAgICB0aGlzLnZpZXcuYmluZGluZ0NvbnRleHQgPSB0aGlzLnZpZXdNb2RlbDtcbiAgICB0aGlzLnZpZXcub3ZlcnJpZGVDb250ZXh0ID0gb3ZlcnJpZGVDb250ZXh0IHx8ICgwLCBfYXVyZWxpYUJpbmRpbmcuY3JlYXRlT3ZlcnJpZGVDb250ZXh0KSh0aGlzLnZpZXdNb2RlbCk7XG4gICAgdGhpcy52aWV3Ll9pc1VzZXJDb250cm9sbGVkID0gdHJ1ZTtcblxuICAgIGlmICh0aGlzLmJlaGF2aW9yLmhhbmRsZXNDcmVhdGVkKSB7XG4gICAgICB0aGlzLnZpZXdNb2RlbC5jcmVhdGVkKG93bmluZ1ZpZXcgfHwgbnVsbCwgdGhpcy52aWV3KTtcbiAgICB9XG5cbiAgICB0aGlzLmJpbmQodGhpcy52aWV3KTtcbiAgfTtcblxuICBDb250cm9sbGVyLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gYmluZChzY29wZSkge1xuICAgIHZhciBza2lwU2VsZlN1YnNjcmliZXIgPSB0aGlzLmJlaGF2aW9yLmhhbmRsZXNCaW5kO1xuICAgIHZhciBib3VuZFByb3BlcnRpZXMgPSB0aGlzLmJvdW5kUHJvcGVydGllcztcbiAgICB2YXIgaSA9IHZvaWQgMDtcbiAgICB2YXIgaWkgPSB2b2lkIDA7XG4gICAgdmFyIHggPSB2b2lkIDA7XG4gICAgdmFyIG9ic2VydmVyID0gdm9pZCAwO1xuICAgIHZhciBzZWxmU3Vic2NyaWJlciA9IHZvaWQgMDtcblxuICAgIGlmICh0aGlzLmlzQm91bmQpIHtcbiAgICAgIGlmICh0aGlzLnNjb3BlID09PSBzY29wZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMudW5iaW5kKCk7XG4gICAgfVxuXG4gICAgdGhpcy5pc0JvdW5kID0gdHJ1ZTtcbiAgICB0aGlzLnNjb3BlID0gc2NvcGU7XG5cbiAgICBmb3IgKGkgPSAwLCBpaSA9IGJvdW5kUHJvcGVydGllcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICB4ID0gYm91bmRQcm9wZXJ0aWVzW2ldO1xuICAgICAgb2JzZXJ2ZXIgPSB4Lm9ic2VydmVyO1xuICAgICAgc2VsZlN1YnNjcmliZXIgPSBvYnNlcnZlci5zZWxmU3Vic2NyaWJlcjtcbiAgICAgIG9ic2VydmVyLnB1Ymxpc2hpbmcgPSBmYWxzZTtcblxuICAgICAgaWYgKHNraXBTZWxmU3Vic2NyaWJlcikge1xuICAgICAgICBvYnNlcnZlci5zZWxmU3Vic2NyaWJlciA9IG51bGw7XG4gICAgICB9XG5cbiAgICAgIHguYmluZGluZy5iaW5kKHNjb3BlKTtcbiAgICAgIG9ic2VydmVyLmNhbGwoKTtcblxuICAgICAgb2JzZXJ2ZXIucHVibGlzaGluZyA9IHRydWU7XG4gICAgICBvYnNlcnZlci5zZWxmU3Vic2NyaWJlciA9IHNlbGZTdWJzY3JpYmVyO1xuICAgIH1cblxuICAgIHZhciBvdmVycmlkZUNvbnRleHQgPSB2b2lkIDA7XG4gICAgaWYgKHRoaXMudmlldyAhPT0gbnVsbCkge1xuICAgICAgaWYgKHNraXBTZWxmU3Vic2NyaWJlcikge1xuICAgICAgICB0aGlzLnZpZXcudmlld01vZGVsU2NvcGUgPSBzY29wZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMudmlld01vZGVsID09PSBzY29wZS5vdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgb3ZlcnJpZGVDb250ZXh0ID0gc2NvcGUub3ZlcnJpZGVDb250ZXh0O1xuICAgICAgfSBlbHNlIGlmICh0aGlzLmluc3RydWN0aW9uLmluaGVyaXRCaW5kaW5nQ29udGV4dCkge1xuICAgICAgICAgIG92ZXJyaWRlQ29udGV4dCA9ICgwLCBfYXVyZWxpYUJpbmRpbmcuY3JlYXRlT3ZlcnJpZGVDb250ZXh0KSh0aGlzLnZpZXdNb2RlbCwgc2NvcGUub3ZlcnJpZGVDb250ZXh0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG92ZXJyaWRlQ29udGV4dCA9ICgwLCBfYXVyZWxpYUJpbmRpbmcuY3JlYXRlT3ZlcnJpZGVDb250ZXh0KSh0aGlzLnZpZXdNb2RlbCk7XG4gICAgICAgICAgICBvdmVycmlkZUNvbnRleHQuX19wYXJlbnRPdmVycmlkZUNvbnRleHQgPSBzY29wZS5vdmVycmlkZUNvbnRleHQ7XG4gICAgICAgICAgfVxuICAgICAgdGhpcy52aWV3LmJpbmQodGhpcy52aWV3TW9kZWwsIG92ZXJyaWRlQ29udGV4dCk7XG4gICAgfSBlbHNlIGlmIChza2lwU2VsZlN1YnNjcmliZXIpIHtcbiAgICAgIG92ZXJyaWRlQ29udGV4dCA9IHNjb3BlLm92ZXJyaWRlQ29udGV4dDtcblxuICAgICAgaWYgKHNjb3BlLm92ZXJyaWRlQ29udGV4dC5fX3BhcmVudE92ZXJyaWRlQ29udGV4dCAhPT0gdW5kZWZpbmVkICYmIHRoaXMudmlld01vZGVsLnZpZXdGYWN0b3J5ICYmIHRoaXMudmlld01vZGVsLnZpZXdGYWN0b3J5LmZhY3RvcnlDcmVhdGVJbnN0cnVjdGlvbi5wYXJ0UmVwbGFjZW1lbnRzKSB7XG4gICAgICAgIG92ZXJyaWRlQ29udGV4dCA9IE9iamVjdC5hc3NpZ24oe30sIHNjb3BlLm92ZXJyaWRlQ29udGV4dCk7XG4gICAgICAgIG92ZXJyaWRlQ29udGV4dC5wYXJlbnRPdmVycmlkZUNvbnRleHQgPSBzY29wZS5vdmVycmlkZUNvbnRleHQuX19wYXJlbnRPdmVycmlkZUNvbnRleHQ7XG4gICAgICB9XG4gICAgICB0aGlzLnZpZXdNb2RlbC5iaW5kKHNjb3BlLmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xuICAgIH1cbiAgfTtcblxuICBDb250cm9sbGVyLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiB1bmJpbmQoKSB7XG4gICAgaWYgKHRoaXMuaXNCb3VuZCkge1xuICAgICAgdmFyIGJvdW5kUHJvcGVydGllcyA9IHRoaXMuYm91bmRQcm9wZXJ0aWVzO1xuICAgICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgICB2YXIgaWkgPSB2b2lkIDA7XG5cbiAgICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgICAgdGhpcy5zY29wZSA9IG51bGw7XG5cbiAgICAgIGlmICh0aGlzLnZpZXcgIT09IG51bGwpIHtcbiAgICAgICAgdGhpcy52aWV3LnVuYmluZCgpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5iZWhhdmlvci5oYW5kbGVzVW5iaW5kKSB7XG4gICAgICAgIHRoaXMudmlld01vZGVsLnVuYmluZCgpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5lbGVtZW50RXZlbnRzICE9PSBudWxsKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudEV2ZW50cy5kaXNwb3NlQWxsKCk7XG4gICAgICB9XG5cbiAgICAgIGZvciAoaSA9IDAsIGlpID0gYm91bmRQcm9wZXJ0aWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgYm91bmRQcm9wZXJ0aWVzW2ldLmJpbmRpbmcudW5iaW5kKCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIENvbnRyb2xsZXIucHJvdG90eXBlLmF0dGFjaGVkID0gZnVuY3Rpb24gYXR0YWNoZWQoKSB7XG4gICAgaWYgKHRoaXMuaXNBdHRhY2hlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuaXNBdHRhY2hlZCA9IHRydWU7XG5cbiAgICBpZiAodGhpcy5iZWhhdmlvci5oYW5kbGVzQXR0YWNoZWQpIHtcbiAgICAgIHRoaXMudmlld01vZGVsLmF0dGFjaGVkKCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMudmlldyAhPT0gbnVsbCkge1xuICAgICAgdGhpcy52aWV3LmF0dGFjaGVkKCk7XG4gICAgfVxuICB9O1xuXG4gIENvbnRyb2xsZXIucHJvdG90eXBlLmRldGFjaGVkID0gZnVuY3Rpb24gZGV0YWNoZWQoKSB7XG4gICAgaWYgKHRoaXMuaXNBdHRhY2hlZCkge1xuICAgICAgdGhpcy5pc0F0dGFjaGVkID0gZmFsc2U7XG5cbiAgICAgIGlmICh0aGlzLnZpZXcgIT09IG51bGwpIHtcbiAgICAgICAgdGhpcy52aWV3LmRldGFjaGVkKCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmJlaGF2aW9yLmhhbmRsZXNEZXRhY2hlZCkge1xuICAgICAgICB0aGlzLnZpZXdNb2RlbC5kZXRhY2hlZCgpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICByZXR1cm4gQ29udHJvbGxlcjtcbn0oKTtcblxudmFyIEJlaGF2aW9yUHJvcGVydHlPYnNlcnZlciA9IGV4cG9ydHMuQmVoYXZpb3JQcm9wZXJ0eU9ic2VydmVyID0gKF9kZWM4ID0gKDAsIF9hdXJlbGlhQmluZGluZy5zdWJzY3JpYmVyQ29sbGVjdGlvbikoKSwgX2RlYzgoX2NsYXNzMTYgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEJlaGF2aW9yUHJvcGVydHlPYnNlcnZlcih0YXNrUXVldWUsIG9iaiwgcHJvcGVydHlOYW1lLCBzZWxmU3Vic2NyaWJlciwgaW5pdGlhbFZhbHVlKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJlaGF2aW9yUHJvcGVydHlPYnNlcnZlcik7XG5cbiAgICB0aGlzLnRhc2tRdWV1ZSA9IHRhc2tRdWV1ZTtcbiAgICB0aGlzLm9iaiA9IG9iajtcbiAgICB0aGlzLnByb3BlcnR5TmFtZSA9IHByb3BlcnR5TmFtZTtcbiAgICB0aGlzLm5vdHF1ZXVlZCA9IHRydWU7XG4gICAgdGhpcy5wdWJsaXNoaW5nID0gZmFsc2U7XG4gICAgdGhpcy5zZWxmU3Vic2NyaWJlciA9IHNlbGZTdWJzY3JpYmVyO1xuICAgIHRoaXMuY3VycmVudFZhbHVlID0gdGhpcy5vbGRWYWx1ZSA9IGluaXRpYWxWYWx1ZTtcbiAgfVxuXG4gIEJlaGF2aW9yUHJvcGVydHlPYnNlcnZlci5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiBnZXRWYWx1ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50VmFsdWU7XG4gIH07XG5cbiAgQmVoYXZpb3JQcm9wZXJ0eU9ic2VydmVyLnByb3RvdHlwZS5zZXRWYWx1ZSA9IGZ1bmN0aW9uIHNldFZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgdmFyIG9sZFZhbHVlID0gdGhpcy5jdXJyZW50VmFsdWU7XG5cbiAgICBpZiAob2xkVmFsdWUgIT09IG5ld1ZhbHVlKSB7XG4gICAgICBpZiAodGhpcy5wdWJsaXNoaW5nICYmIHRoaXMubm90cXVldWVkKSB7XG4gICAgICAgIHRoaXMubm90cXVldWVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMudGFza1F1ZXVlLnF1ZXVlTWljcm9UYXNrKHRoaXMpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLm9sZFZhbHVlID0gb2xkVmFsdWU7XG4gICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IG5ld1ZhbHVlO1xuICAgIH1cbiAgfTtcblxuICBCZWhhdmlvclByb3BlcnR5T2JzZXJ2ZXIucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbiBjYWxsKCkge1xuICAgIHZhciBvbGRWYWx1ZSA9IHRoaXMub2xkVmFsdWU7XG4gICAgdmFyIG5ld1ZhbHVlID0gdGhpcy5jdXJyZW50VmFsdWU7XG5cbiAgICB0aGlzLm5vdHF1ZXVlZCA9IHRydWU7XG5cbiAgICBpZiAobmV3VmFsdWUgPT09IG9sZFZhbHVlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc2VsZlN1YnNjcmliZXIpIHtcbiAgICAgIHRoaXMuc2VsZlN1YnNjcmliZXIobmV3VmFsdWUsIG9sZFZhbHVlKTtcbiAgICB9XG5cbiAgICB0aGlzLmNhbGxTdWJzY3JpYmVycyhuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgIHRoaXMub2xkVmFsdWUgPSBuZXdWYWx1ZTtcbiAgfTtcblxuICBCZWhhdmlvclByb3BlcnR5T2JzZXJ2ZXIucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIHN1YnNjcmliZShjb250ZXh0LCBjYWxsYWJsZSkge1xuICAgIHRoaXMuYWRkU3Vic2NyaWJlcihjb250ZXh0LCBjYWxsYWJsZSk7XG4gIH07XG5cbiAgQmVoYXZpb3JQcm9wZXJ0eU9ic2VydmVyLnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uIHVuc3Vic2NyaWJlKGNvbnRleHQsIGNhbGxhYmxlKSB7XG4gICAgdGhpcy5yZW1vdmVTdWJzY3JpYmVyKGNvbnRleHQsIGNhbGxhYmxlKTtcbiAgfTtcblxuICByZXR1cm4gQmVoYXZpb3JQcm9wZXJ0eU9ic2VydmVyO1xufSgpKSB8fCBfY2xhc3MxNik7XG5cblxuZnVuY3Rpb24gZ2V0T2JzZXJ2ZXIoYmVoYXZpb3IsIGluc3RhbmNlLCBuYW1lKSB7XG4gIHZhciBsb29rdXAgPSBpbnN0YW5jZS5fX29ic2VydmVyc19fO1xuXG4gIGlmIChsb29rdXAgPT09IHVuZGVmaW5lZCkge1xuICAgIGlmICghYmVoYXZpb3IuaXNJbml0aWFsaXplZCkge1xuICAgICAgYmVoYXZpb3IuaW5pdGlhbGl6ZShfYXVyZWxpYURlcGVuZGVuY3lJbmplY3Rpb24uQ29udGFpbmVyLmluc3RhbmNlIHx8IG5ldyBfYXVyZWxpYURlcGVuZGVuY3lJbmplY3Rpb24uQ29udGFpbmVyKCksIGluc3RhbmNlLmNvbnN0cnVjdG9yKTtcbiAgICB9XG5cbiAgICBsb29rdXAgPSBiZWhhdmlvci5vYnNlcnZlckxvY2F0b3IuZ2V0T3JDcmVhdGVPYnNlcnZlcnNMb29rdXAoaW5zdGFuY2UpO1xuICAgIGJlaGF2aW9yLl9lbnN1cmVQcm9wZXJ0aWVzRGVmaW5lZChpbnN0YW5jZSwgbG9va3VwKTtcbiAgfVxuXG4gIHJldHVybiBsb29rdXBbbmFtZV07XG59XG5cbnZhciBCaW5kYWJsZVByb3BlcnR5ID0gZXhwb3J0cy5CaW5kYWJsZVByb3BlcnR5ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBCaW5kYWJsZVByb3BlcnR5KG5hbWVPckNvbmZpZykge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCaW5kYWJsZVByb3BlcnR5KTtcblxuICAgIGlmICh0eXBlb2YgbmFtZU9yQ29uZmlnID09PSAnc3RyaW5nJykge1xuICAgICAgdGhpcy5uYW1lID0gbmFtZU9yQ29uZmlnO1xuICAgIH0gZWxzZSB7XG4gICAgICBPYmplY3QuYXNzaWduKHRoaXMsIG5hbWVPckNvbmZpZyk7XG4gICAgfVxuXG4gICAgdGhpcy5hdHRyaWJ1dGUgPSB0aGlzLmF0dHJpYnV0ZSB8fCBfaHlwaGVuYXRlKHRoaXMubmFtZSk7XG4gICAgaWYgKHRoaXMuZGVmYXVsdEJpbmRpbmdNb2RlID09PSBudWxsIHx8IHRoaXMuZGVmYXVsdEJpbmRpbmdNb2RlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuZGVmYXVsdEJpbmRpbmdNb2RlID0gX2F1cmVsaWFCaW5kaW5nLmJpbmRpbmdNb2RlLm9uZVdheTtcbiAgICB9XG4gICAgdGhpcy5jaGFuZ2VIYW5kbGVyID0gdGhpcy5jaGFuZ2VIYW5kbGVyIHx8IG51bGw7XG4gICAgdGhpcy5vd25lciA9IG51bGw7XG4gICAgdGhpcy5kZXNjcmlwdG9yID0gbnVsbDtcbiAgfVxuXG4gIEJpbmRhYmxlUHJvcGVydHkucHJvdG90eXBlLnJlZ2lzdGVyV2l0aCA9IGZ1bmN0aW9uIHJlZ2lzdGVyV2l0aCh0YXJnZXQsIGJlaGF2aW9yLCBkZXNjcmlwdG9yKSB7XG4gICAgYmVoYXZpb3IucHJvcGVydGllcy5wdXNoKHRoaXMpO1xuICAgIGJlaGF2aW9yLmF0dHJpYnV0ZXNbdGhpcy5hdHRyaWJ1dGVdID0gdGhpcztcbiAgICB0aGlzLm93bmVyID0gYmVoYXZpb3I7XG5cbiAgICBpZiAoZGVzY3JpcHRvcikge1xuICAgICAgdGhpcy5kZXNjcmlwdG9yID0gZGVzY3JpcHRvcjtcbiAgICAgIHJldHVybiB0aGlzLl9jb25maWd1cmVEZXNjcmlwdG9yKGJlaGF2aW9yLCBkZXNjcmlwdG9yKTtcbiAgICB9XG4gIH07XG5cbiAgQmluZGFibGVQcm9wZXJ0eS5wcm90b3R5cGUuX2NvbmZpZ3VyZURlc2NyaXB0b3IgPSBmdW5jdGlvbiBfY29uZmlndXJlRGVzY3JpcHRvcihiZWhhdmlvciwgZGVzY3JpcHRvcikge1xuICAgIHZhciBuYW1lID0gdGhpcy5uYW1lO1xuXG4gICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlO1xuICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IHRydWU7XG5cbiAgICBpZiAoJ2luaXRpYWxpemVyJyBpbiBkZXNjcmlwdG9yKSB7XG4gICAgICB0aGlzLmRlZmF1bHRWYWx1ZSA9IGRlc2NyaXB0b3IuaW5pdGlhbGl6ZXI7XG4gICAgICBkZWxldGUgZGVzY3JpcHRvci5pbml0aWFsaXplcjtcbiAgICAgIGRlbGV0ZSBkZXNjcmlwdG9yLndyaXRhYmxlO1xuICAgIH1cblxuICAgIGlmICgndmFsdWUnIGluIGRlc2NyaXB0b3IpIHtcbiAgICAgIHRoaXMuZGVmYXVsdFZhbHVlID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICAgIGRlbGV0ZSBkZXNjcmlwdG9yLnZhbHVlO1xuICAgICAgZGVsZXRlIGRlc2NyaXB0b3Iud3JpdGFibGU7XG4gICAgfVxuXG4gICAgZGVzY3JpcHRvci5nZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gZ2V0T2JzZXJ2ZXIoYmVoYXZpb3IsIHRoaXMsIG5hbWUpLmdldFZhbHVlKCk7XG4gICAgfTtcblxuICAgIGRlc2NyaXB0b3Iuc2V0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICBnZXRPYnNlcnZlcihiZWhhdmlvciwgdGhpcywgbmFtZSkuc2V0VmFsdWUodmFsdWUpO1xuICAgIH07XG5cbiAgICBkZXNjcmlwdG9yLmdldC5nZXRPYnNlcnZlciA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgIHJldHVybiBnZXRPYnNlcnZlcihiZWhhdmlvciwgb2JqLCBuYW1lKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRlc2NyaXB0b3I7XG4gIH07XG5cbiAgQmluZGFibGVQcm9wZXJ0eS5wcm90b3R5cGUuZGVmaW5lT24gPSBmdW5jdGlvbiBkZWZpbmVPbih0YXJnZXQsIGJlaGF2aW9yKSB7XG4gICAgdmFyIG5hbWUgPSB0aGlzLm5hbWU7XG4gICAgdmFyIGhhbmRsZXJOYW1lID0gdm9pZCAwO1xuXG4gICAgaWYgKHRoaXMuY2hhbmdlSGFuZGxlciA9PT0gbnVsbCkge1xuICAgICAgaGFuZGxlck5hbWUgPSBuYW1lICsgJ0NoYW5nZWQnO1xuICAgICAgaWYgKGhhbmRsZXJOYW1lIGluIHRhcmdldC5wcm90b3R5cGUpIHtcbiAgICAgICAgdGhpcy5jaGFuZ2VIYW5kbGVyID0gaGFuZGxlck5hbWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGVzY3JpcHRvciA9PT0gbnVsbCkge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldC5wcm90b3R5cGUsIG5hbWUsIHRoaXMuX2NvbmZpZ3VyZURlc2NyaXB0b3IoYmVoYXZpb3IsIHt9KSk7XG4gICAgfVxuICB9O1xuXG4gIEJpbmRhYmxlUHJvcGVydHkucHJvdG90eXBlLmNyZWF0ZU9ic2VydmVyID0gZnVuY3Rpb24gY3JlYXRlT2JzZXJ2ZXIodmlld01vZGVsKSB7XG4gICAgdmFyIHNlbGZTdWJzY3JpYmVyID0gbnVsbDtcbiAgICB2YXIgZGVmYXVsdFZhbHVlID0gdGhpcy5kZWZhdWx0VmFsdWU7XG4gICAgdmFyIGNoYW5nZUhhbmRsZXJOYW1lID0gdGhpcy5jaGFuZ2VIYW5kbGVyO1xuICAgIHZhciBuYW1lID0gdGhpcy5uYW1lO1xuICAgIHZhciBpbml0aWFsVmFsdWUgPSB2b2lkIDA7XG5cbiAgICBpZiAodGhpcy5oYXNPcHRpb25zKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGlmIChjaGFuZ2VIYW5kbGVyTmFtZSBpbiB2aWV3TW9kZWwpIHtcbiAgICAgIGlmICgncHJvcGVydHlDaGFuZ2VkJyBpbiB2aWV3TW9kZWwpIHtcbiAgICAgICAgc2VsZlN1YnNjcmliZXIgPSBmdW5jdGlvbiBzZWxmU3Vic2NyaWJlcihuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgICB2aWV3TW9kZWxbY2hhbmdlSGFuZGxlck5hbWVdKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgICAgICAgdmlld01vZGVsLnByb3BlcnR5Q2hhbmdlZChuYW1lLCBuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VsZlN1YnNjcmliZXIgPSBmdW5jdGlvbiBzZWxmU3Vic2NyaWJlcihuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgICByZXR1cm4gdmlld01vZGVsW2NoYW5nZUhhbmRsZXJOYW1lXShuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoJ3Byb3BlcnR5Q2hhbmdlZCcgaW4gdmlld01vZGVsKSB7XG4gICAgICBzZWxmU3Vic2NyaWJlciA9IGZ1bmN0aW9uIHNlbGZTdWJzY3JpYmVyKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICByZXR1cm4gdmlld01vZGVsLnByb3BlcnR5Q2hhbmdlZChuYW1lLCBuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKGNoYW5nZUhhbmRsZXJOYW1lICE9PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NoYW5nZSBoYW5kbGVyICcgKyBjaGFuZ2VIYW5kbGVyTmFtZSArICcgd2FzIHNwZWNpZmllZCBidXQgbm90IGRlY2xhcmVkIG9uIHRoZSBjbGFzcy4nKTtcbiAgICB9XG5cbiAgICBpZiAoZGVmYXVsdFZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGluaXRpYWxWYWx1ZSA9IHR5cGVvZiBkZWZhdWx0VmFsdWUgPT09ICdmdW5jdGlvbicgPyBkZWZhdWx0VmFsdWUuY2FsbCh2aWV3TW9kZWwpIDogZGVmYXVsdFZhbHVlO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgQmVoYXZpb3JQcm9wZXJ0eU9ic2VydmVyKHRoaXMub3duZXIudGFza1F1ZXVlLCB2aWV3TW9kZWwsIHRoaXMubmFtZSwgc2VsZlN1YnNjcmliZXIsIGluaXRpYWxWYWx1ZSk7XG4gIH07XG5cbiAgQmluZGFibGVQcm9wZXJ0eS5wcm90b3R5cGUuX2luaXRpYWxpemUgPSBmdW5jdGlvbiBfaW5pdGlhbGl6ZSh2aWV3TW9kZWwsIG9ic2VydmVyTG9va3VwLCBhdHRyaWJ1dGVzLCBiZWhhdmlvckhhbmRsZXNCaW5kLCBib3VuZFByb3BlcnRpZXMpIHtcbiAgICB2YXIgc2VsZlN1YnNjcmliZXIgPSB2b2lkIDA7XG4gICAgdmFyIG9ic2VydmVyID0gdm9pZCAwO1xuICAgIHZhciBhdHRyaWJ1dGUgPSB2b2lkIDA7XG4gICAgdmFyIGRlZmF1bHRWYWx1ZSA9IHRoaXMuZGVmYXVsdFZhbHVlO1xuXG4gICAgaWYgKHRoaXMuaXNEeW5hbWljKSB7XG4gICAgICBmb3IgKHZhciBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgICAgICB0aGlzLl9jcmVhdGVEeW5hbWljUHJvcGVydHkodmlld01vZGVsLCBvYnNlcnZlckxvb2t1cCwgYmVoYXZpb3JIYW5kbGVzQmluZCwga2V5LCBhdHRyaWJ1dGVzW2tleV0sIGJvdW5kUHJvcGVydGllcyk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICghdGhpcy5oYXNPcHRpb25zKSB7XG4gICAgICBvYnNlcnZlciA9IG9ic2VydmVyTG9va3VwW3RoaXMubmFtZV07XG5cbiAgICAgIGlmIChhdHRyaWJ1dGVzICE9PSBudWxsKSB7XG4gICAgICAgIHNlbGZTdWJzY3JpYmVyID0gb2JzZXJ2ZXIuc2VsZlN1YnNjcmliZXI7XG4gICAgICAgIGF0dHJpYnV0ZSA9IGF0dHJpYnV0ZXNbdGhpcy5hdHRyaWJ1dGVdO1xuXG4gICAgICAgIGlmIChiZWhhdmlvckhhbmRsZXNCaW5kKSB7XG4gICAgICAgICAgb2JzZXJ2ZXIuc2VsZlN1YnNjcmliZXIgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGVvZiBhdHRyaWJ1dGUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgdmlld01vZGVsW3RoaXMubmFtZV0gPSBhdHRyaWJ1dGU7XG4gICAgICAgICAgb2JzZXJ2ZXIuY2FsbCgpO1xuICAgICAgICB9IGVsc2UgaWYgKGF0dHJpYnV0ZSkge1xuICAgICAgICAgIGJvdW5kUHJvcGVydGllcy5wdXNoKHsgb2JzZXJ2ZXI6IG9ic2VydmVyLCBiaW5kaW5nOiBhdHRyaWJ1dGUuY3JlYXRlQmluZGluZyh2aWV3TW9kZWwpIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGRlZmF1bHRWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgb2JzZXJ2ZXIuY2FsbCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgb2JzZXJ2ZXIuc2VsZlN1YnNjcmliZXIgPSBzZWxmU3Vic2NyaWJlcjtcbiAgICAgIH1cblxuICAgICAgb2JzZXJ2ZXIucHVibGlzaGluZyA9IHRydWU7XG4gICAgfVxuICB9O1xuXG4gIEJpbmRhYmxlUHJvcGVydHkucHJvdG90eXBlLl9jcmVhdGVEeW5hbWljUHJvcGVydHkgPSBmdW5jdGlvbiBfY3JlYXRlRHluYW1pY1Byb3BlcnR5KHZpZXdNb2RlbCwgb2JzZXJ2ZXJMb29rdXAsIGJlaGF2aW9ySGFuZGxlc0JpbmQsIG5hbWUsIGF0dHJpYnV0ZSwgYm91bmRQcm9wZXJ0aWVzKSB7XG4gICAgdmFyIGNoYW5nZUhhbmRsZXJOYW1lID0gbmFtZSArICdDaGFuZ2VkJztcbiAgICB2YXIgc2VsZlN1YnNjcmliZXIgPSBudWxsO1xuICAgIHZhciBvYnNlcnZlciA9IHZvaWQgMDtcbiAgICB2YXIgaW5mbyA9IHZvaWQgMDtcblxuICAgIGlmIChjaGFuZ2VIYW5kbGVyTmFtZSBpbiB2aWV3TW9kZWwpIHtcbiAgICAgIGlmICgncHJvcGVydHlDaGFuZ2VkJyBpbiB2aWV3TW9kZWwpIHtcbiAgICAgICAgc2VsZlN1YnNjcmliZXIgPSBmdW5jdGlvbiBzZWxmU3Vic2NyaWJlcihuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgICB2aWV3TW9kZWxbY2hhbmdlSGFuZGxlck5hbWVdKG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgICAgICAgdmlld01vZGVsLnByb3BlcnR5Q2hhbmdlZChuYW1lLCBuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VsZlN1YnNjcmliZXIgPSBmdW5jdGlvbiBzZWxmU3Vic2NyaWJlcihuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgICByZXR1cm4gdmlld01vZGVsW2NoYW5nZUhhbmRsZXJOYW1lXShuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoJ3Byb3BlcnR5Q2hhbmdlZCcgaW4gdmlld01vZGVsKSB7XG4gICAgICBzZWxmU3Vic2NyaWJlciA9IGZ1bmN0aW9uIHNlbGZTdWJzY3JpYmVyKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICByZXR1cm4gdmlld01vZGVsLnByb3BlcnR5Q2hhbmdlZChuYW1lLCBuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBvYnNlcnZlciA9IG9ic2VydmVyTG9va3VwW25hbWVdID0gbmV3IEJlaGF2aW9yUHJvcGVydHlPYnNlcnZlcih0aGlzLm93bmVyLnRhc2tRdWV1ZSwgdmlld01vZGVsLCBuYW1lLCBzZWxmU3Vic2NyaWJlcik7XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodmlld01vZGVsLCBuYW1lLCB7XG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgZ2V0OiBvYnNlcnZlci5nZXRWYWx1ZS5iaW5kKG9ic2VydmVyKSxcbiAgICAgIHNldDogb2JzZXJ2ZXIuc2V0VmFsdWUuYmluZChvYnNlcnZlcilcbiAgICB9KTtcblxuICAgIGlmIChiZWhhdmlvckhhbmRsZXNCaW5kKSB7XG4gICAgICBvYnNlcnZlci5zZWxmU3Vic2NyaWJlciA9IG51bGw7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBhdHRyaWJ1dGUgPT09ICdzdHJpbmcnKSB7XG4gICAgICB2aWV3TW9kZWxbbmFtZV0gPSBhdHRyaWJ1dGU7XG4gICAgICBvYnNlcnZlci5jYWxsKCk7XG4gICAgfSBlbHNlIGlmIChhdHRyaWJ1dGUpIHtcbiAgICAgIGluZm8gPSB7IG9ic2VydmVyOiBvYnNlcnZlciwgYmluZGluZzogYXR0cmlidXRlLmNyZWF0ZUJpbmRpbmcodmlld01vZGVsKSB9O1xuICAgICAgYm91bmRQcm9wZXJ0aWVzLnB1c2goaW5mbyk7XG4gICAgfVxuXG4gICAgb2JzZXJ2ZXIucHVibGlzaGluZyA9IHRydWU7XG4gICAgb2JzZXJ2ZXIuc2VsZlN1YnNjcmliZXIgPSBzZWxmU3Vic2NyaWJlcjtcbiAgfTtcblxuICByZXR1cm4gQmluZGFibGVQcm9wZXJ0eTtcbn0oKTtcblxudmFyIGNvbnRlbnRTZWxlY3RvclZpZXdDcmVhdGVJbnN0cnVjdGlvbiA9IHsgZW5oYW5jZTogZmFsc2UgfTtcbnZhciBsYXN0UHJvdmlkZXJJZCA9IDA7XG5cbmZ1bmN0aW9uIG5leHRQcm92aWRlcklkKCkge1xuICByZXR1cm4gKytsYXN0UHJvdmlkZXJJZDtcbn1cblxuZnVuY3Rpb24gZG9Qcm9jZXNzQ29udGVudCgpIHtcbiAgcmV0dXJuIHRydWU7XG59XG5mdW5jdGlvbiBkb1Byb2Nlc3NBdHRyaWJ1dGVzKCkge31cblxudmFyIEh0bWxCZWhhdmlvclJlc291cmNlID0gZXhwb3J0cy5IdG1sQmVoYXZpb3JSZXNvdXJjZSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gSHRtbEJlaGF2aW9yUmVzb3VyY2UoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEh0bWxCZWhhdmlvclJlc291cmNlKTtcblxuICAgIHRoaXMuZWxlbWVudE5hbWUgPSBudWxsO1xuICAgIHRoaXMuYXR0cmlidXRlTmFtZSA9IG51bGw7XG4gICAgdGhpcy5hdHRyaWJ1dGVEZWZhdWx0QmluZGluZ01vZGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5saWZ0c0NvbnRlbnQgPSBmYWxzZTtcbiAgICB0aGlzLnRhcmdldFNoYWRvd0RPTSA9IGZhbHNlO1xuICAgIHRoaXMucHJvY2Vzc0F0dHJpYnV0ZXMgPSBkb1Byb2Nlc3NBdHRyaWJ1dGVzO1xuICAgIHRoaXMucHJvY2Vzc0NvbnRlbnQgPSBkb1Byb2Nlc3NDb250ZW50O1xuICAgIHRoaXMudXNlc1NoYWRvd0RPTSA9IGZhbHNlO1xuICAgIHRoaXMuY2hpbGRCaW5kaW5ncyA9IG51bGw7XG4gICAgdGhpcy5oYXNEeW5hbWljT3B0aW9ucyA9IGZhbHNlO1xuICAgIHRoaXMuY29udGFpbmVybGVzcyA9IGZhbHNlO1xuICAgIHRoaXMucHJvcGVydGllcyA9IFtdO1xuICAgIHRoaXMuYXR0cmlidXRlcyA9IHt9O1xuICAgIHRoaXMuaXNJbml0aWFsaXplZCA9IGZhbHNlO1xuICB9XG5cbiAgSHRtbEJlaGF2aW9yUmVzb3VyY2UuY29udmVudGlvbiA9IGZ1bmN0aW9uIGNvbnZlbnRpb24obmFtZSwgZXhpc3RpbmcpIHtcbiAgICB2YXIgYmVoYXZpb3IgPSB2b2lkIDA7XG5cbiAgICBpZiAobmFtZS5lbmRzV2l0aCgnQ3VzdG9tQXR0cmlidXRlJykpIHtcbiAgICAgIGJlaGF2aW9yID0gZXhpc3RpbmcgfHwgbmV3IEh0bWxCZWhhdmlvclJlc291cmNlKCk7XG4gICAgICBiZWhhdmlvci5hdHRyaWJ1dGVOYW1lID0gX2h5cGhlbmF0ZShuYW1lLnN1YnN0cmluZygwLCBuYW1lLmxlbmd0aCAtIDE1KSk7XG4gICAgfVxuXG4gICAgaWYgKG5hbWUuZW5kc1dpdGgoJ0N1c3RvbUVsZW1lbnQnKSkge1xuICAgICAgYmVoYXZpb3IgPSBleGlzdGluZyB8fCBuZXcgSHRtbEJlaGF2aW9yUmVzb3VyY2UoKTtcbiAgICAgIGJlaGF2aW9yLmVsZW1lbnROYW1lID0gX2h5cGhlbmF0ZShuYW1lLnN1YnN0cmluZygwLCBuYW1lLmxlbmd0aCAtIDEzKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJlaGF2aW9yO1xuICB9O1xuXG4gIEh0bWxCZWhhdmlvclJlc291cmNlLnByb3RvdHlwZS5hZGRDaGlsZEJpbmRpbmcgPSBmdW5jdGlvbiBhZGRDaGlsZEJpbmRpbmcoYmVoYXZpb3IpIHtcbiAgICBpZiAodGhpcy5jaGlsZEJpbmRpbmdzID09PSBudWxsKSB7XG4gICAgICB0aGlzLmNoaWxkQmluZGluZ3MgPSBbXTtcbiAgICB9XG5cbiAgICB0aGlzLmNoaWxkQmluZGluZ3MucHVzaChiZWhhdmlvcik7XG4gIH07XG5cbiAgSHRtbEJlaGF2aW9yUmVzb3VyY2UucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiBpbml0aWFsaXplKGNvbnRhaW5lciwgdGFyZ2V0KSB7XG4gICAgdmFyIHByb3RvID0gdGFyZ2V0LnByb3RvdHlwZTtcbiAgICB2YXIgcHJvcGVydGllcyA9IHRoaXMucHJvcGVydGllcztcbiAgICB2YXIgYXR0cmlidXRlTmFtZSA9IHRoaXMuYXR0cmlidXRlTmFtZTtcbiAgICB2YXIgYXR0cmlidXRlRGVmYXVsdEJpbmRpbmdNb2RlID0gdGhpcy5hdHRyaWJ1dGVEZWZhdWx0QmluZGluZ01vZGU7XG4gICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgdmFyIGlpID0gdm9pZCAwO1xuICAgIHZhciBjdXJyZW50ID0gdm9pZCAwO1xuXG4gICAgaWYgKHRoaXMuaXNJbml0aWFsaXplZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuaXNJbml0aWFsaXplZCA9IHRydWU7XG4gICAgdGFyZ2V0Ll9fcHJvdmlkZXJJZF9fID0gbmV4dFByb3ZpZGVySWQoKTtcblxuICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yID0gY29udGFpbmVyLmdldChfYXVyZWxpYUJpbmRpbmcuT2JzZXJ2ZXJMb2NhdG9yKTtcbiAgICB0aGlzLnRhc2tRdWV1ZSA9IGNvbnRhaW5lci5nZXQoX2F1cmVsaWFUYXNrUXVldWUuVGFza1F1ZXVlKTtcblxuICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgIHRoaXMudXNlc1NoYWRvd0RPTSA9IHRoaXMudGFyZ2V0U2hhZG93RE9NICYmIF9hdXJlbGlhUGFsLkZFQVRVUkUuc2hhZG93RE9NO1xuICAgIHRoaXMuaGFuZGxlc0NyZWF0ZWQgPSAnY3JlYXRlZCcgaW4gcHJvdG87XG4gICAgdGhpcy5oYW5kbGVzQmluZCA9ICdiaW5kJyBpbiBwcm90bztcbiAgICB0aGlzLmhhbmRsZXNVbmJpbmQgPSAndW5iaW5kJyBpbiBwcm90bztcbiAgICB0aGlzLmhhbmRsZXNBdHRhY2hlZCA9ICdhdHRhY2hlZCcgaW4gcHJvdG87XG4gICAgdGhpcy5oYW5kbGVzRGV0YWNoZWQgPSAnZGV0YWNoZWQnIGluIHByb3RvO1xuICAgIHRoaXMuaHRtbE5hbWUgPSB0aGlzLmVsZW1lbnROYW1lIHx8IHRoaXMuYXR0cmlidXRlTmFtZTtcblxuICAgIGlmIChhdHRyaWJ1dGVOYW1lICE9PSBudWxsKSB7XG4gICAgICBpZiAocHJvcGVydGllcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgbmV3IEJpbmRhYmxlUHJvcGVydHkoe1xuICAgICAgICAgIG5hbWU6ICd2YWx1ZScsXG4gICAgICAgICAgY2hhbmdlSGFuZGxlcjogJ3ZhbHVlQ2hhbmdlZCcgaW4gcHJvdG8gPyAndmFsdWVDaGFuZ2VkJyA6IG51bGwsXG4gICAgICAgICAgYXR0cmlidXRlOiBhdHRyaWJ1dGVOYW1lLFxuICAgICAgICAgIGRlZmF1bHRCaW5kaW5nTW9kZTogYXR0cmlidXRlRGVmYXVsdEJpbmRpbmdNb2RlXG4gICAgICAgIH0pLnJlZ2lzdGVyV2l0aCh0YXJnZXQsIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICBjdXJyZW50ID0gcHJvcGVydGllc1swXTtcblxuICAgICAgaWYgKHByb3BlcnRpZXMubGVuZ3RoID09PSAxICYmIGN1cnJlbnQubmFtZSA9PT0gJ3ZhbHVlJykge1xuICAgICAgICBjdXJyZW50LmlzRHluYW1pYyA9IGN1cnJlbnQuaGFzT3B0aW9ucyA9IHRoaXMuaGFzRHluYW1pY09wdGlvbnM7XG4gICAgICAgIGN1cnJlbnQuZGVmaW5lT24odGFyZ2V0LCB0aGlzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAoaSA9IDAsIGlpID0gcHJvcGVydGllcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgICAgcHJvcGVydGllc1tpXS5kZWZpbmVPbih0YXJnZXQsIHRoaXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgY3VycmVudCA9IG5ldyBCaW5kYWJsZVByb3BlcnR5KHtcbiAgICAgICAgICBuYW1lOiAndmFsdWUnLFxuICAgICAgICAgIGNoYW5nZUhhbmRsZXI6ICd2YWx1ZUNoYW5nZWQnIGluIHByb3RvID8gJ3ZhbHVlQ2hhbmdlZCcgOiBudWxsLFxuICAgICAgICAgIGF0dHJpYnV0ZTogYXR0cmlidXRlTmFtZSxcbiAgICAgICAgICBkZWZhdWx0QmluZGluZ01vZGU6IGF0dHJpYnV0ZURlZmF1bHRCaW5kaW5nTW9kZVxuICAgICAgICB9KTtcblxuICAgICAgICBjdXJyZW50Lmhhc09wdGlvbnMgPSB0cnVlO1xuICAgICAgICBjdXJyZW50LnJlZ2lzdGVyV2l0aCh0YXJnZXQsIHRoaXMpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGkgPSAwLCBpaSA9IHByb3BlcnRpZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgICBwcm9wZXJ0aWVzW2ldLmRlZmluZU9uKHRhcmdldCwgdGhpcyk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIEh0bWxCZWhhdmlvclJlc291cmNlLnByb3RvdHlwZS5yZWdpc3RlciA9IGZ1bmN0aW9uIHJlZ2lzdGVyKHJlZ2lzdHJ5LCBuYW1lKSB7XG4gICAgaWYgKHRoaXMuYXR0cmlidXRlTmFtZSAhPT0gbnVsbCkge1xuICAgICAgcmVnaXN0cnkucmVnaXN0ZXJBdHRyaWJ1dGUobmFtZSB8fCB0aGlzLmF0dHJpYnV0ZU5hbWUsIHRoaXMsIHRoaXMuYXR0cmlidXRlTmFtZSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZWxlbWVudE5hbWUgIT09IG51bGwpIHtcbiAgICAgIHJlZ2lzdHJ5LnJlZ2lzdGVyRWxlbWVudChuYW1lIHx8IHRoaXMuZWxlbWVudE5hbWUsIHRoaXMpO1xuICAgIH1cbiAgfTtcblxuICBIdG1sQmVoYXZpb3JSZXNvdXJjZS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIGxvYWQoY29udGFpbmVyLCB0YXJnZXQsIGxvYWRDb250ZXh0LCB2aWV3U3RyYXRlZ3ksIHRyYW5zaWVudFZpZXcpIHtcbiAgICB2YXIgX3RoaXMxMSA9IHRoaXM7XG5cbiAgICB2YXIgb3B0aW9ucyA9IHZvaWQgMDtcblxuICAgIGlmICh0aGlzLmVsZW1lbnROYW1lICE9PSBudWxsKSB7XG4gICAgICB2aWV3U3RyYXRlZ3kgPSBjb250YWluZXIuZ2V0KFZpZXdMb2NhdG9yKS5nZXRWaWV3U3RyYXRlZ3kodmlld1N0cmF0ZWd5IHx8IHRoaXMudmlld1N0cmF0ZWd5IHx8IHRhcmdldCk7XG4gICAgICBvcHRpb25zID0gbmV3IFZpZXdDb21waWxlSW5zdHJ1Y3Rpb24odGhpcy50YXJnZXRTaGFkb3dET00sIHRydWUpO1xuXG4gICAgICBpZiAoIXZpZXdTdHJhdGVneS5tb2R1bGVJZCkge1xuICAgICAgICB2aWV3U3RyYXRlZ3kubW9kdWxlSWQgPSBfYXVyZWxpYU1ldGFkYXRhLk9yaWdpbi5nZXQodGFyZ2V0KS5tb2R1bGVJZDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHZpZXdTdHJhdGVneS5sb2FkVmlld0ZhY3RvcnkoY29udGFpbmVyLmdldChWaWV3RW5naW5lKSwgb3B0aW9ucywgbG9hZENvbnRleHQpLnRoZW4oZnVuY3Rpb24gKHZpZXdGYWN0b3J5KSB7XG4gICAgICAgIGlmICghdHJhbnNpZW50VmlldyB8fCAhX3RoaXMxMS52aWV3RmFjdG9yeSkge1xuICAgICAgICAgIF90aGlzMTEudmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB2aWV3RmFjdG9yeTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcyk7XG4gIH07XG5cbiAgSHRtbEJlaGF2aW9yUmVzb3VyY2UucHJvdG90eXBlLmNvbXBpbGUgPSBmdW5jdGlvbiBjb21waWxlKGNvbXBpbGVyLCByZXNvdXJjZXMsIG5vZGUsIGluc3RydWN0aW9uLCBwYXJlbnROb2RlKSB7XG4gICAgaWYgKHRoaXMubGlmdHNDb250ZW50KSB7XG4gICAgICBpZiAoIWluc3RydWN0aW9uLnZpZXdGYWN0b3J5KSB7XG4gICAgICAgIHZhciB0ZW1wbGF0ZSA9IF9hdXJlbGlhUGFsLkRPTS5jcmVhdGVFbGVtZW50KCd0ZW1wbGF0ZScpO1xuICAgICAgICB2YXIgZnJhZ21lbnQgPSBfYXVyZWxpYVBhbC5ET00uY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgICB2YXIgY2FjaGVTaXplID0gbm9kZS5nZXRBdHRyaWJ1dGUoJ3ZpZXctY2FjaGUnKTtcbiAgICAgICAgdmFyIHBhcnQgPSBub2RlLmdldEF0dHJpYnV0ZSgncGFydCcpO1xuXG4gICAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKGluc3RydWN0aW9uLm9yaWdpbmFsQXR0ck5hbWUpO1xuICAgICAgICBfYXVyZWxpYVBhbC5ET00ucmVwbGFjZU5vZGUodGVtcGxhdGUsIG5vZGUsIHBhcmVudE5vZGUpO1xuICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChub2RlKTtcbiAgICAgICAgaW5zdHJ1Y3Rpb24udmlld0ZhY3RvcnkgPSBjb21waWxlci5jb21waWxlKGZyYWdtZW50LCByZXNvdXJjZXMpO1xuXG4gICAgICAgIGlmIChwYXJ0KSB7XG4gICAgICAgICAgaW5zdHJ1Y3Rpb24udmlld0ZhY3RvcnkucGFydCA9IHBhcnQ7XG4gICAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoJ3BhcnQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjYWNoZVNpemUpIHtcbiAgICAgICAgICBpbnN0cnVjdGlvbi52aWV3RmFjdG9yeS5zZXRDYWNoZVNpemUoY2FjaGVTaXplKTtcbiAgICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZSgndmlldy1jYWNoZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgbm9kZSA9IHRlbXBsYXRlO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodGhpcy5lbGVtZW50TmFtZSAhPT0gbnVsbCkge1xuICAgICAgdmFyIF9wYXJ0UmVwbGFjZW1lbnRzMiA9IHt9O1xuXG4gICAgICBpZiAodGhpcy5wcm9jZXNzQ29udGVudChjb21waWxlciwgcmVzb3VyY2VzLCBub2RlLCBpbnN0cnVjdGlvbikgJiYgbm9kZS5oYXNDaGlsZE5vZGVzKCkpIHtcbiAgICAgICAgaWYgKHRoaXMudXNlc1NoYWRvd0RPTSkge1xuICAgICAgICAgIHZhciBjdXJyZW50Q2hpbGQgPSBub2RlLmZpcnN0Q2hpbGQ7XG4gICAgICAgICAgdmFyIG5leHRTaWJsaW5nID0gdm9pZCAwO1xuICAgICAgICAgIHZhciB0b1JlcGxhY2UgPSB2b2lkIDA7XG5cbiAgICAgICAgICB3aGlsZSAoY3VycmVudENoaWxkKSB7XG4gICAgICAgICAgICBuZXh0U2libGluZyA9IGN1cnJlbnRDaGlsZC5uZXh0U2libGluZztcblxuICAgICAgICAgICAgaWYgKGN1cnJlbnRDaGlsZC50YWdOYW1lID09PSAnVEVNUExBVEUnICYmICh0b1JlcGxhY2UgPSBjdXJyZW50Q2hpbGQuZ2V0QXR0cmlidXRlKCdyZXBsYWNlLXBhcnQnKSkpIHtcbiAgICAgICAgICAgICAgX3BhcnRSZXBsYWNlbWVudHMyW3RvUmVwbGFjZV0gPSBjb21waWxlci5jb21waWxlKGN1cnJlbnRDaGlsZCwgcmVzb3VyY2VzKTtcbiAgICAgICAgICAgICAgX2F1cmVsaWFQYWwuRE9NLnJlbW92ZU5vZGUoY3VycmVudENoaWxkLCBwYXJlbnROb2RlKTtcbiAgICAgICAgICAgICAgaW5zdHJ1Y3Rpb24ucGFydFJlcGxhY2VtZW50cyA9IF9wYXJ0UmVwbGFjZW1lbnRzMjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY3VycmVudENoaWxkID0gbmV4dFNpYmxpbmc7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaW5zdHJ1Y3Rpb24uc2tpcENvbnRlbnRQcm9jZXNzaW5nID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIF9mcmFnbWVudCA9IF9hdXJlbGlhUGFsLkRPTS5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgICAgdmFyIF9jdXJyZW50Q2hpbGQgPSBub2RlLmZpcnN0Q2hpbGQ7XG4gICAgICAgICAgdmFyIF9uZXh0U2libGluZyA9IHZvaWQgMDtcbiAgICAgICAgICB2YXIgX3RvUmVwbGFjZSA9IHZvaWQgMDtcblxuICAgICAgICAgIHdoaWxlIChfY3VycmVudENoaWxkKSB7XG4gICAgICAgICAgICBfbmV4dFNpYmxpbmcgPSBfY3VycmVudENoaWxkLm5leHRTaWJsaW5nO1xuXG4gICAgICAgICAgICBpZiAoX2N1cnJlbnRDaGlsZC50YWdOYW1lID09PSAnVEVNUExBVEUnICYmIChfdG9SZXBsYWNlID0gX2N1cnJlbnRDaGlsZC5nZXRBdHRyaWJ1dGUoJ3JlcGxhY2UtcGFydCcpKSkge1xuICAgICAgICAgICAgICBfcGFydFJlcGxhY2VtZW50czJbX3RvUmVwbGFjZV0gPSBjb21waWxlci5jb21waWxlKF9jdXJyZW50Q2hpbGQsIHJlc291cmNlcyk7XG4gICAgICAgICAgICAgIF9hdXJlbGlhUGFsLkRPTS5yZW1vdmVOb2RlKF9jdXJyZW50Q2hpbGQsIHBhcmVudE5vZGUpO1xuICAgICAgICAgICAgICBpbnN0cnVjdGlvbi5wYXJ0UmVwbGFjZW1lbnRzID0gX3BhcnRSZXBsYWNlbWVudHMyO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgX2ZyYWdtZW50LmFwcGVuZENoaWxkKF9jdXJyZW50Q2hpbGQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY3VycmVudENoaWxkID0gX25leHRTaWJsaW5nO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGluc3RydWN0aW9uLmNvbnRlbnRGYWN0b3J5ID0gY29tcGlsZXIuY29tcGlsZShfZnJhZ21lbnQsIHJlc291cmNlcyk7XG4gICAgICAgICAgaW5zdHJ1Y3Rpb24uc2tpcENvbnRlbnRQcm9jZXNzaW5nID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW5zdHJ1Y3Rpb24uc2tpcENvbnRlbnRQcm9jZXNzaW5nID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbm9kZTtcbiAgfTtcblxuICBIdG1sQmVoYXZpb3JSZXNvdXJjZS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gY3JlYXRlKGNvbnRhaW5lciwgaW5zdHJ1Y3Rpb24sIGVsZW1lbnQsIGJpbmRpbmdzKSB7XG4gICAgdmFyIGhvc3QgPSB2b2lkIDA7XG4gICAgdmFyIGF1ID0gbnVsbDtcblxuICAgIGluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb24gfHwgQmVoYXZpb3JJbnN0cnVjdGlvbi5ub3JtYWw7XG4gICAgZWxlbWVudCA9IGVsZW1lbnQgfHwgbnVsbDtcbiAgICBiaW5kaW5ncyA9IGJpbmRpbmdzIHx8IG51bGw7XG5cbiAgICBpZiAodGhpcy5lbGVtZW50TmFtZSAhPT0gbnVsbCAmJiBlbGVtZW50KSB7XG4gICAgICBpZiAodGhpcy51c2VzU2hhZG93RE9NKSB7XG4gICAgICAgIGhvc3QgPSBlbGVtZW50LmNyZWF0ZVNoYWRvd1Jvb3QoKTtcbiAgICAgICAgY29udGFpbmVyLnJlZ2lzdGVySW5zdGFuY2UoX2F1cmVsaWFQYWwuRE9NLmJvdW5kYXJ5LCBob3N0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGhvc3QgPSBlbGVtZW50O1xuXG4gICAgICAgIGlmICh0aGlzLnRhcmdldFNoYWRvd0RPTSkge1xuICAgICAgICAgIGNvbnRhaW5lci5yZWdpc3Rlckluc3RhbmNlKF9hdXJlbGlhUGFsLkRPTS5ib3VuZGFyeSwgaG9zdCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZWxlbWVudCAhPT0gbnVsbCkge1xuICAgICAgZWxlbWVudC5hdSA9IGF1ID0gZWxlbWVudC5hdSB8fCB7fTtcbiAgICB9XG5cbiAgICB2YXIgdmlld01vZGVsID0gaW5zdHJ1Y3Rpb24udmlld01vZGVsIHx8IGNvbnRhaW5lci5nZXQodGhpcy50YXJnZXQpO1xuICAgIHZhciBjb250cm9sbGVyID0gbmV3IENvbnRyb2xsZXIodGhpcywgaW5zdHJ1Y3Rpb24sIHZpZXdNb2RlbCwgY29udGFpbmVyLmVsZW1lbnRFdmVudHMpO1xuICAgIHZhciBjaGlsZEJpbmRpbmdzID0gdGhpcy5jaGlsZEJpbmRpbmdzO1xuICAgIHZhciB2aWV3RmFjdG9yeSA9IHZvaWQgMDtcblxuICAgIGlmICh0aGlzLmxpZnRzQ29udGVudCkge1xuICAgICAgYXUuY29udHJvbGxlciA9IGNvbnRyb2xsZXI7XG4gICAgfSBlbHNlIGlmICh0aGlzLmVsZW1lbnROYW1lICE9PSBudWxsKSB7XG4gICAgICB2aWV3RmFjdG9yeSA9IGluc3RydWN0aW9uLnZpZXdGYWN0b3J5IHx8IHRoaXMudmlld0ZhY3Rvcnk7XG4gICAgICBjb250YWluZXIudmlld01vZGVsID0gdmlld01vZGVsO1xuXG4gICAgICBpZiAodmlld0ZhY3RvcnkpIHtcbiAgICAgICAgY29udHJvbGxlci52aWV3ID0gdmlld0ZhY3RvcnkuY3JlYXRlKGNvbnRhaW5lciwgaW5zdHJ1Y3Rpb24sIGVsZW1lbnQpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZWxlbWVudCAhPT0gbnVsbCkge1xuICAgICAgICBhdS5jb250cm9sbGVyID0gY29udHJvbGxlcjtcblxuICAgICAgICBpZiAoY29udHJvbGxlci52aWV3KSB7XG4gICAgICAgICAgaWYgKCF0aGlzLnVzZXNTaGFkb3dET00pIHtcbiAgICAgICAgICAgIGlmIChpbnN0cnVjdGlvbi5jb250ZW50RmFjdG9yeSkge1xuICAgICAgICAgICAgICB2YXIgY29udGVudFZpZXcgPSBpbnN0cnVjdGlvbi5jb250ZW50RmFjdG9yeS5jcmVhdGUoY29udGFpbmVyLCBjb250ZW50U2VsZWN0b3JWaWV3Q3JlYXRlSW5zdHJ1Y3Rpb24pO1xuXG4gICAgICAgICAgICAgIF9Db250ZW50U2VsZWN0b3IuYXBwbHlTZWxlY3RvcnMoY29udGVudFZpZXcsIGNvbnRyb2xsZXIudmlldy5jb250ZW50U2VsZWN0b3JzLCBmdW5jdGlvbiAoY29udGVudFNlbGVjdG9yLCBncm91cCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb250ZW50U2VsZWN0b3IuYWRkKGdyb3VwKTtcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgY29udHJvbGxlci5jb250ZW50VmlldyA9IGNvbnRlbnRWaWV3O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChpbnN0cnVjdGlvbi5hbmNob3JJc0NvbnRhaW5lcikge1xuICAgICAgICAgICAgaWYgKGNoaWxkQmluZGluZ3MgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gY2hpbGRCaW5kaW5ncy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci52aWV3LmFkZEJpbmRpbmcoY2hpbGRCaW5kaW5nc1tpXS5jcmVhdGUoZWxlbWVudCwgdmlld01vZGVsKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29udHJvbGxlci52aWV3LmFwcGVuZE5vZGVzVG8oaG9zdCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIudmlldy5pbnNlcnROb2Rlc0JlZm9yZShob3N0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoY2hpbGRCaW5kaW5ncyAhPT0gbnVsbCkge1xuICAgICAgICAgIGZvciAodmFyIF9pMiA9IDAsIF9paTIgPSBjaGlsZEJpbmRpbmdzLmxlbmd0aDsgX2kyIDwgX2lpMjsgKytfaTIpIHtcbiAgICAgICAgICAgIGJpbmRpbmdzLnB1c2goY2hpbGRCaW5kaW5nc1tfaTJdLmNyZWF0ZShlbGVtZW50LCB2aWV3TW9kZWwpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoY29udHJvbGxlci52aWV3KSB7XG4gICAgICAgIGNvbnRyb2xsZXIudmlldy5jb250cm9sbGVyID0gY29udHJvbGxlcjtcblxuICAgICAgICBpZiAoY2hpbGRCaW5kaW5ncyAhPT0gbnVsbCkge1xuICAgICAgICAgIGZvciAodmFyIF9pMyA9IDAsIF9paTMgPSBjaGlsZEJpbmRpbmdzLmxlbmd0aDsgX2kzIDwgX2lpMzsgKytfaTMpIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIudmlldy5hZGRCaW5kaW5nKGNoaWxkQmluZGluZ3NbX2kzXS5jcmVhdGUoaW5zdHJ1Y3Rpb24uaG9zdCwgdmlld01vZGVsKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGNoaWxkQmluZGluZ3MgIT09IG51bGwpIHtcbiAgICAgICAgZm9yICh2YXIgX2k0ID0gMCwgX2lpNCA9IGNoaWxkQmluZGluZ3MubGVuZ3RoOyBfaTQgPCBfaWk0OyArK19pNCkge1xuICAgICAgICAgIGJpbmRpbmdzLnB1c2goY2hpbGRCaW5kaW5nc1tfaTRdLmNyZWF0ZShpbnN0cnVjdGlvbi5ob3N0LCB2aWV3TW9kZWwpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoY2hpbGRCaW5kaW5ncyAhPT0gbnVsbCkge1xuICAgICAgZm9yICh2YXIgX2k1ID0gMCwgX2lpNSA9IGNoaWxkQmluZGluZ3MubGVuZ3RoOyBfaTUgPCBfaWk1OyArK19pNSkge1xuICAgICAgICBiaW5kaW5ncy5wdXNoKGNoaWxkQmluZGluZ3NbX2k1XS5jcmVhdGUoZWxlbWVudCwgdmlld01vZGVsKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGF1ICE9PSBudWxsKSB7XG4gICAgICBhdVt0aGlzLmh0bWxOYW1lXSA9IGNvbnRyb2xsZXI7XG4gICAgfVxuXG4gICAgaWYgKGluc3RydWN0aW9uLmluaXRpYXRlZEJ5QmVoYXZpb3IgJiYgdmlld0ZhY3RvcnkpIHtcbiAgICAgIGNvbnRyb2xsZXIudmlldy5jcmVhdGVkKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvbnRyb2xsZXI7XG4gIH07XG5cbiAgSHRtbEJlaGF2aW9yUmVzb3VyY2UucHJvdG90eXBlLl9lbnN1cmVQcm9wZXJ0aWVzRGVmaW5lZCA9IGZ1bmN0aW9uIF9lbnN1cmVQcm9wZXJ0aWVzRGVmaW5lZChpbnN0YW5jZSwgbG9va3VwKSB7XG4gICAgdmFyIHByb3BlcnRpZXMgPSB2b2lkIDA7XG4gICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgdmFyIGlpID0gdm9pZCAwO1xuICAgIHZhciBvYnNlcnZlciA9IHZvaWQgMDtcblxuICAgIGlmICgnX19wcm9wZXJ0aWVzRGVmaW5lZF9fJyBpbiBsb29rdXApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBsb29rdXAuX19wcm9wZXJ0aWVzRGVmaW5lZF9fID0gdHJ1ZTtcbiAgICBwcm9wZXJ0aWVzID0gdGhpcy5wcm9wZXJ0aWVzO1xuXG4gICAgZm9yIChpID0gMCwgaWkgPSBwcm9wZXJ0aWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIG9ic2VydmVyID0gcHJvcGVydGllc1tpXS5jcmVhdGVPYnNlcnZlcihpbnN0YW5jZSk7XG5cbiAgICAgIGlmIChvYnNlcnZlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGxvb2t1cFtvYnNlcnZlci5wcm9wZXJ0eU5hbWVdID0gb2JzZXJ2ZXI7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBIdG1sQmVoYXZpb3JSZXNvdXJjZTtcbn0oKTtcblxuZnVuY3Rpb24gY3JlYXRlQ2hpbGRPYnNlcnZlckRlY29yYXRvcihzZWxlY3Rvck9yQ29uZmlnLCBhbGwpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcikge1xuICAgIHZhciBhY3R1YWxUYXJnZXQgPSB0eXBlb2Yga2V5ID09PSAnc3RyaW5nJyA/IHRhcmdldC5jb25zdHJ1Y3RvciA6IHRhcmdldDtcbiAgICB2YXIgciA9IF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEuZ2V0T3JDcmVhdGVPd24oX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5yZXNvdXJjZSwgSHRtbEJlaGF2aW9yUmVzb3VyY2UsIGFjdHVhbFRhcmdldCk7XG5cbiAgICBpZiAodHlwZW9mIHNlbGVjdG9yT3JDb25maWcgPT09ICdzdHJpbmcnKSB7XG4gICAgICBzZWxlY3Rvck9yQ29uZmlnID0ge1xuICAgICAgICBzZWxlY3Rvcjogc2VsZWN0b3JPckNvbmZpZyxcbiAgICAgICAgbmFtZToga2V5XG4gICAgICB9O1xuICAgIH1cblxuICAgIGlmIChkZXNjcmlwdG9yKSB7XG4gICAgICBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBzZWxlY3Rvck9yQ29uZmlnLmFsbCA9IGFsbDtcbiAgICByLmFkZENoaWxkQmluZGluZyhuZXcgQ2hpbGRPYnNlcnZlcihzZWxlY3Rvck9yQ29uZmlnKSk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGNoaWxkcmVuKHNlbGVjdG9yT3JDb25maWcpIHtcbiAgcmV0dXJuIGNyZWF0ZUNoaWxkT2JzZXJ2ZXJEZWNvcmF0b3Ioc2VsZWN0b3JPckNvbmZpZywgdHJ1ZSk7XG59XG5cbmZ1bmN0aW9uIGNoaWxkKHNlbGVjdG9yT3JDb25maWcpIHtcbiAgcmV0dXJuIGNyZWF0ZUNoaWxkT2JzZXJ2ZXJEZWNvcmF0b3Ioc2VsZWN0b3JPckNvbmZpZywgZmFsc2UpO1xufVxuXG52YXIgQ2hpbGRPYnNlcnZlciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQ2hpbGRPYnNlcnZlcihjb25maWcpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ2hpbGRPYnNlcnZlcik7XG5cbiAgICB0aGlzLm5hbWUgPSBjb25maWcubmFtZTtcbiAgICB0aGlzLmNoYW5nZUhhbmRsZXIgPSBjb25maWcuY2hhbmdlSGFuZGxlciB8fCB0aGlzLm5hbWUgKyAnQ2hhbmdlZCc7XG4gICAgdGhpcy5zZWxlY3RvciA9IGNvbmZpZy5zZWxlY3RvcjtcbiAgICB0aGlzLmFsbCA9IGNvbmZpZy5hbGw7XG4gIH1cblxuICBDaGlsZE9ic2VydmVyLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUodGFyZ2V0LCB2aWV3TW9kZWwpIHtcbiAgICByZXR1cm4gbmV3IENoaWxkT2JzZXJ2ZXJCaW5kZXIodGhpcy5zZWxlY3RvciwgdGFyZ2V0LCB0aGlzLm5hbWUsIHZpZXdNb2RlbCwgdGhpcy5jaGFuZ2VIYW5kbGVyLCB0aGlzLmFsbCk7XG4gIH07XG5cbiAgcmV0dXJuIENoaWxkT2JzZXJ2ZXI7XG59KCk7XG5cbnZhciBub011dGF0aW9ucyA9IFtdO1xuXG5mdW5jdGlvbiB0cmFja011dGF0aW9uKGdyb3VwZWRNdXRhdGlvbnMsIGJpbmRlciwgcmVjb3JkKSB7XG4gIHZhciBtdXRhdGlvbnMgPSBncm91cGVkTXV0YXRpb25zLmdldChiaW5kZXIpO1xuXG4gIGlmICghbXV0YXRpb25zKSB7XG4gICAgbXV0YXRpb25zID0gW107XG4gICAgZ3JvdXBlZE11dGF0aW9ucy5zZXQoYmluZGVyLCBtdXRhdGlvbnMpO1xuICB9XG5cbiAgbXV0YXRpb25zLnB1c2gocmVjb3JkKTtcbn1cblxuZnVuY3Rpb24gb25DaGlsZENoYW5nZShtdXRhdGlvbnMsIG9ic2VydmVyKSB7XG4gIHZhciBiaW5kZXJzID0gb2JzZXJ2ZXIuYmluZGVycztcbiAgdmFyIGJpbmRlcnNMZW5ndGggPSBiaW5kZXJzLmxlbmd0aDtcbiAgdmFyIGdyb3VwZWRNdXRhdGlvbnMgPSBuZXcgTWFwKCk7XG5cbiAgZm9yICh2YXIgaSA9IDAsIGlpID0gbXV0YXRpb25zLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICB2YXIgcmVjb3JkID0gbXV0YXRpb25zW2ldO1xuICAgIHZhciBhZGRlZCA9IHJlY29yZC5hZGRlZE5vZGVzO1xuICAgIHZhciByZW1vdmVkID0gcmVjb3JkLnJlbW92ZWROb2RlcztcblxuICAgIGZvciAodmFyIGogPSAwLCBqaiA9IHJlbW92ZWQubGVuZ3RoOyBqIDwgamo7ICsraikge1xuICAgICAgdmFyIG5vZGUgPSByZW1vdmVkW2pdO1xuICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDEpIHtcbiAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBiaW5kZXJzTGVuZ3RoOyArK2spIHtcbiAgICAgICAgICB2YXIgYmluZGVyID0gYmluZGVyc1trXTtcbiAgICAgICAgICBpZiAoYmluZGVyLm9uUmVtb3ZlKG5vZGUpKSB7XG4gICAgICAgICAgICB0cmFja011dGF0aW9uKGdyb3VwZWRNdXRhdGlvbnMsIGJpbmRlciwgcmVjb3JkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKHZhciBfaiA9IDAsIF9qaiA9IGFkZGVkLmxlbmd0aDsgX2ogPCBfamo7ICsrX2opIHtcbiAgICAgIHZhciBfbm9kZSA9IGFkZGVkW19qXTtcbiAgICAgIGlmIChfbm9kZS5ub2RlVHlwZSA9PT0gMSkge1xuICAgICAgICBmb3IgKHZhciBfayA9IDA7IF9rIDwgYmluZGVyc0xlbmd0aDsgKytfaykge1xuICAgICAgICAgIHZhciBfYmluZGVyID0gYmluZGVyc1tfa107XG4gICAgICAgICAgaWYgKF9iaW5kZXIub25BZGQoX25vZGUpKSB7XG4gICAgICAgICAgICB0cmFja011dGF0aW9uKGdyb3VwZWRNdXRhdGlvbnMsIF9iaW5kZXIsIHJlY29yZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ3JvdXBlZE11dGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XG4gICAgaWYgKGtleS5jaGFuZ2VIYW5kbGVyICE9PSBudWxsKSB7XG4gICAgICBrZXkudmlld01vZGVsW2tleS5jaGFuZ2VIYW5kbGVyXSh2YWx1ZSk7XG4gICAgfVxuICB9KTtcbn1cblxudmFyIENoaWxkT2JzZXJ2ZXJCaW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIENoaWxkT2JzZXJ2ZXJCaW5kZXIoc2VsZWN0b3IsIHRhcmdldCwgcHJvcGVydHksIHZpZXdNb2RlbCwgY2hhbmdlSGFuZGxlciwgYWxsKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENoaWxkT2JzZXJ2ZXJCaW5kZXIpO1xuXG4gICAgdGhpcy5zZWxlY3RvciA9IHNlbGVjdG9yO1xuICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgIHRoaXMucHJvcGVydHkgPSBwcm9wZXJ0eTtcbiAgICB0aGlzLnZpZXdNb2RlbCA9IHZpZXdNb2RlbDtcbiAgICB0aGlzLmNoYW5nZUhhbmRsZXIgPSBjaGFuZ2VIYW5kbGVyIGluIHZpZXdNb2RlbCA/IGNoYW5nZUhhbmRsZXIgOiBudWxsO1xuICAgIHRoaXMuYWxsID0gYWxsO1xuICB9XG5cbiAgQ2hpbGRPYnNlcnZlckJpbmRlci5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIGJpbmQoc291cmNlKSB7XG4gICAgdmFyIHRhcmdldCA9IHRoaXMudGFyZ2V0O1xuICAgIHZhciB2aWV3TW9kZWwgPSB0aGlzLnZpZXdNb2RlbDtcbiAgICB2YXIgc2VsZWN0b3IgPSB0aGlzLnNlbGVjdG9yO1xuICAgIHZhciBjdXJyZW50ID0gdGFyZ2V0LmZpcnN0RWxlbWVudENoaWxkO1xuICAgIHZhciBvYnNlcnZlciA9IHRhcmdldC5fX2NoaWxkT2JzZXJ2ZXJfXztcblxuICAgIGlmICghb2JzZXJ2ZXIpIHtcbiAgICAgIG9ic2VydmVyID0gdGFyZ2V0Ll9fY2hpbGRPYnNlcnZlcl9fID0gX2F1cmVsaWFQYWwuRE9NLmNyZWF0ZU11dGF0aW9uT2JzZXJ2ZXIob25DaGlsZENoYW5nZSk7XG4gICAgICBvYnNlcnZlci5vYnNlcnZlKHRhcmdldCwgeyBjaGlsZExpc3Q6IHRydWUgfSk7XG4gICAgICBvYnNlcnZlci5iaW5kZXJzID0gW107XG4gICAgfVxuXG4gICAgb2JzZXJ2ZXIuYmluZGVycy5wdXNoKHRoaXMpO1xuXG4gICAgaWYgKHRoaXMuYWxsKSB7XG4gICAgICB2YXIgaXRlbXMgPSB2aWV3TW9kZWxbdGhpcy5wcm9wZXJ0eV07XG4gICAgICBpZiAoIWl0ZW1zKSB7XG4gICAgICAgIGl0ZW1zID0gdmlld01vZGVsW3RoaXMucHJvcGVydHldID0gW107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpdGVtcy5sZW5ndGggPSAwO1xuICAgICAgfVxuXG4gICAgICB3aGlsZSAoY3VycmVudCkge1xuICAgICAgICBpZiAoY3VycmVudC5tYXRjaGVzKHNlbGVjdG9yKSkge1xuICAgICAgICAgIGl0ZW1zLnB1c2goY3VycmVudC5hdSAmJiBjdXJyZW50LmF1LmNvbnRyb2xsZXIgPyBjdXJyZW50LmF1LmNvbnRyb2xsZXIudmlld01vZGVsIDogY3VycmVudCk7XG4gICAgICAgIH1cblxuICAgICAgICBjdXJyZW50ID0gY3VycmVudC5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmNoYW5nZUhhbmRsZXIgIT09IG51bGwpIHtcbiAgICAgICAgdGhpcy52aWV3TW9kZWxbdGhpcy5jaGFuZ2VIYW5kbGVyXShub011dGF0aW9ucyk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHdoaWxlIChjdXJyZW50KSB7XG4gICAgICAgIGlmIChjdXJyZW50Lm1hdGNoZXMoc2VsZWN0b3IpKSB7XG4gICAgICAgICAgdmFyIHZhbHVlID0gY3VycmVudC5hdSAmJiBjdXJyZW50LmF1LmNvbnRyb2xsZXIgPyBjdXJyZW50LmF1LmNvbnRyb2xsZXIudmlld01vZGVsIDogY3VycmVudDtcbiAgICAgICAgICB0aGlzLnZpZXdNb2RlbFt0aGlzLnByb3BlcnR5XSA9IHZhbHVlO1xuXG4gICAgICAgICAgaWYgKHRoaXMuY2hhbmdlSGFuZGxlciAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy52aWV3TW9kZWxbdGhpcy5jaGFuZ2VIYW5kbGVyXSh2YWx1ZSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBjdXJyZW50ID0gY3VycmVudC5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIENoaWxkT2JzZXJ2ZXJCaW5kZXIucHJvdG90eXBlLm9uUmVtb3ZlID0gZnVuY3Rpb24gb25SZW1vdmUoZWxlbWVudCkge1xuICAgIGlmIChlbGVtZW50Lm1hdGNoZXModGhpcy5zZWxlY3RvcikpIHtcbiAgICAgIHZhciB2YWx1ZSA9IGVsZW1lbnQuYXUgJiYgZWxlbWVudC5hdS5jb250cm9sbGVyID8gZWxlbWVudC5hdS5jb250cm9sbGVyLnZpZXdNb2RlbCA6IGVsZW1lbnQ7XG5cbiAgICAgIGlmICh0aGlzLmFsbCkge1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLnZpZXdNb2RlbFt0aGlzLnByb3BlcnR5XTtcbiAgICAgICAgdmFyIGluZGV4ID0gaXRlbXMuaW5kZXhPZih2YWx1ZSk7XG5cbiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICAgIGl0ZW1zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfTtcblxuICBDaGlsZE9ic2VydmVyQmluZGVyLnByb3RvdHlwZS5vbkFkZCA9IGZ1bmN0aW9uIG9uQWRkKGVsZW1lbnQpIHtcbiAgICB2YXIgc2VsZWN0b3IgPSB0aGlzLnNlbGVjdG9yO1xuXG4gICAgaWYgKGVsZW1lbnQubWF0Y2hlcyhzZWxlY3RvcikpIHtcbiAgICAgIHZhciB2YWx1ZSA9IGVsZW1lbnQuYXUgJiYgZWxlbWVudC5hdS5jb250cm9sbGVyID8gZWxlbWVudC5hdS5jb250cm9sbGVyLnZpZXdNb2RlbCA6IGVsZW1lbnQ7XG5cbiAgICAgIGlmICh0aGlzLmFsbCkge1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLnZpZXdNb2RlbFt0aGlzLnByb3BlcnR5XTtcbiAgICAgICAgdmFyIGluZGV4ID0gMDtcbiAgICAgICAgdmFyIHByZXYgPSBlbGVtZW50LnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XG5cbiAgICAgICAgd2hpbGUgKHByZXYpIHtcbiAgICAgICAgICBpZiAocHJldi5tYXRjaGVzKHNlbGVjdG9yKSkge1xuICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBwcmV2ID0gcHJldi5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuICAgICAgICB9XG5cbiAgICAgICAgaXRlbXMuc3BsaWNlKGluZGV4LCAwLCB2YWx1ZSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnZpZXdNb2RlbFt0aGlzLnByb3BlcnR5XSA9IHZhbHVlO1xuXG4gICAgICBpZiAodGhpcy5jaGFuZ2VIYW5kbGVyICE9PSBudWxsKSB7XG4gICAgICAgIHRoaXMudmlld01vZGVsW3RoaXMuY2hhbmdlSGFuZGxlcl0odmFsdWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBDaGlsZE9ic2VydmVyQmluZGVyLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiB1bmJpbmQoKSB7XG4gICAgaWYgKHRoaXMudGFyZ2V0Ll9fY2hpbGRPYnNlcnZlcl9fKSB7XG4gICAgICB0aGlzLnRhcmdldC5fX2NoaWxkT2JzZXJ2ZXJfXy5kaXNjb25uZWN0KCk7XG4gICAgICB0aGlzLnRhcmdldC5fX2NoaWxkT2JzZXJ2ZXJfXyA9IG51bGw7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBDaGlsZE9ic2VydmVyQmluZGVyO1xufSgpO1xuXG5mdW5jdGlvbiB0cnlBY3RpdmF0ZVZpZXdNb2RlbChjb250ZXh0KSB7XG4gIGlmIChjb250ZXh0LnNraXBBY3RpdmF0aW9uIHx8IHR5cGVvZiBjb250ZXh0LnZpZXdNb2RlbC5hY3RpdmF0ZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuXG4gIHJldHVybiBjb250ZXh0LnZpZXdNb2RlbC5hY3RpdmF0ZShjb250ZXh0Lm1vZGVsKSB8fCBQcm9taXNlLnJlc29sdmUoKTtcbn1cblxudmFyIENvbXBvc2l0aW9uRW5naW5lID0gZXhwb3J0cy5Db21wb3NpdGlvbkVuZ2luZSA9IChfZGVjOSA9ICgwLCBfYXVyZWxpYURlcGVuZGVuY3lJbmplY3Rpb24uaW5qZWN0KShWaWV3RW5naW5lLCBWaWV3TG9jYXRvciksIF9kZWM5KF9jbGFzczE3ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBDb21wb3NpdGlvbkVuZ2luZSh2aWV3RW5naW5lLCB2aWV3TG9jYXRvcikge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb21wb3NpdGlvbkVuZ2luZSk7XG5cbiAgICB0aGlzLnZpZXdFbmdpbmUgPSB2aWV3RW5naW5lO1xuICAgIHRoaXMudmlld0xvY2F0b3IgPSB2aWV3TG9jYXRvcjtcbiAgfVxuXG4gIENvbXBvc2l0aW9uRW5naW5lLnByb3RvdHlwZS5fY3JlYXRlQ29udHJvbGxlckFuZFN3YXAgPSBmdW5jdGlvbiBfY3JlYXRlQ29udHJvbGxlckFuZFN3YXAoY29udGV4dCkge1xuICAgIGZ1bmN0aW9uIHN3YXAoY29udHJvbGxlcikge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShjb250ZXh0LnZpZXdTbG90LnJlbW92ZUFsbCh0cnVlKSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChjb250ZXh0LmN1cnJlbnRDb250cm9sbGVyKSB7XG4gICAgICAgICAgY29udGV4dC5jdXJyZW50Q29udHJvbGxlci51bmJpbmQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnRleHQudmlld1Nsb3QuYWRkKGNvbnRyb2xsZXIudmlldyk7XG5cbiAgICAgICAgaWYgKGNvbnRleHQuY29tcG9zaXRpb25UcmFuc2FjdGlvbk5vdGlmaWVyKSB7XG4gICAgICAgICAgY29udGV4dC5jb21wb3NpdGlvblRyYW5zYWN0aW9uTm90aWZpZXIuZG9uZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbnRyb2xsZXI7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5jcmVhdGVDb250cm9sbGVyKGNvbnRleHQpLnRoZW4oZnVuY3Rpb24gKGNvbnRyb2xsZXIpIHtcbiAgICAgIGNvbnRyb2xsZXIuYXV0b21hdGUoY29udGV4dC5vdmVycmlkZUNvbnRleHQsIGNvbnRleHQub3duaW5nVmlldyk7XG5cbiAgICAgIGlmIChjb250ZXh0LmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Pd25lcnNoaXBUb2tlbikge1xuICAgICAgICByZXR1cm4gY29udGV4dC5jb21wb3NpdGlvblRyYW5zYWN0aW9uT3duZXJzaGlwVG9rZW4ud2FpdEZvckNvbXBvc2l0aW9uQ29tcGxldGUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gc3dhcChjb250cm9sbGVyKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzd2FwKGNvbnRyb2xsZXIpO1xuICAgIH0pO1xuICB9O1xuXG4gIENvbXBvc2l0aW9uRW5naW5lLnByb3RvdHlwZS5jcmVhdGVDb250cm9sbGVyID0gZnVuY3Rpb24gY3JlYXRlQ29udHJvbGxlcihjb250ZXh0KSB7XG4gICAgdmFyIF90aGlzMTIgPSB0aGlzO1xuXG4gICAgdmFyIGNoaWxkQ29udGFpbmVyID0gdm9pZCAwO1xuICAgIHZhciB2aWV3TW9kZWwgPSB2b2lkIDA7XG4gICAgdmFyIHZpZXdNb2RlbFJlc291cmNlID0gdm9pZCAwO1xuICAgIHZhciBtID0gdm9pZCAwO1xuXG4gICAgcmV0dXJuIHRoaXMuZW5zdXJlVmlld01vZGVsKGNvbnRleHQpLnRoZW4odHJ5QWN0aXZhdGVWaWV3TW9kZWwpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgY2hpbGRDb250YWluZXIgPSBjb250ZXh0LmNoaWxkQ29udGFpbmVyO1xuICAgICAgdmlld01vZGVsID0gY29udGV4dC52aWV3TW9kZWw7XG4gICAgICB2aWV3TW9kZWxSZXNvdXJjZSA9IGNvbnRleHQudmlld01vZGVsUmVzb3VyY2U7XG4gICAgICBtID0gdmlld01vZGVsUmVzb3VyY2UubWV0YWRhdGE7XG5cbiAgICAgIHZhciB2aWV3U3RyYXRlZ3kgPSBfdGhpczEyLnZpZXdMb2NhdG9yLmdldFZpZXdTdHJhdGVneShjb250ZXh0LnZpZXcgfHwgdmlld01vZGVsKTtcblxuICAgICAgaWYgKGNvbnRleHQudmlld1Jlc291cmNlcykge1xuICAgICAgICB2aWV3U3RyYXRlZ3kubWFrZVJlbGF0aXZlVG8oY29udGV4dC52aWV3UmVzb3VyY2VzLnZpZXdVcmwpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbS5sb2FkKGNoaWxkQ29udGFpbmVyLCB2aWV3TW9kZWxSZXNvdXJjZS52YWx1ZSwgbnVsbCwgdmlld1N0cmF0ZWd5LCB0cnVlKTtcbiAgICB9KS50aGVuKGZ1bmN0aW9uICh2aWV3RmFjdG9yeSkge1xuICAgICAgcmV0dXJuIG0uY3JlYXRlKGNoaWxkQ29udGFpbmVyLCBCZWhhdmlvckluc3RydWN0aW9uLmR5bmFtaWMoY29udGV4dC5ob3N0LCB2aWV3TW9kZWwsIHZpZXdGYWN0b3J5KSk7XG4gICAgfSk7XG4gIH07XG5cbiAgQ29tcG9zaXRpb25FbmdpbmUucHJvdG90eXBlLmVuc3VyZVZpZXdNb2RlbCA9IGZ1bmN0aW9uIGVuc3VyZVZpZXdNb2RlbChjb250ZXh0KSB7XG4gICAgdmFyIGNoaWxkQ29udGFpbmVyID0gY29udGV4dC5jaGlsZENvbnRhaW5lciA9IGNvbnRleHQuY2hpbGRDb250YWluZXIgfHwgY29udGV4dC5jb250YWluZXIuY3JlYXRlQ2hpbGQoKTtcblxuICAgIGlmICh0eXBlb2YgY29udGV4dC52aWV3TW9kZWwgPT09ICdzdHJpbmcnKSB7XG4gICAgICBjb250ZXh0LnZpZXdNb2RlbCA9IGNvbnRleHQudmlld1Jlc291cmNlcyA/IGNvbnRleHQudmlld1Jlc291cmNlcy5yZWxhdGl2ZVRvVmlldyhjb250ZXh0LnZpZXdNb2RlbCkgOiBjb250ZXh0LnZpZXdNb2RlbDtcblxuICAgICAgcmV0dXJuIHRoaXMudmlld0VuZ2luZS5pbXBvcnRWaWV3TW9kZWxSZXNvdXJjZShjb250ZXh0LnZpZXdNb2RlbCkudGhlbihmdW5jdGlvbiAodmlld01vZGVsUmVzb3VyY2UpIHtcbiAgICAgICAgY2hpbGRDb250YWluZXIuYXV0b1JlZ2lzdGVyKHZpZXdNb2RlbFJlc291cmNlLnZhbHVlKTtcblxuICAgICAgICBpZiAoY29udGV4dC5ob3N0KSB7XG4gICAgICAgICAgY2hpbGRDb250YWluZXIucmVnaXN0ZXJJbnN0YW5jZShfYXVyZWxpYVBhbC5ET00uRWxlbWVudCwgY29udGV4dC5ob3N0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnRleHQudmlld01vZGVsID0gY2hpbGRDb250YWluZXIudmlld01vZGVsID0gY2hpbGRDb250YWluZXIuZ2V0KHZpZXdNb2RlbFJlc291cmNlLnZhbHVlKTtcbiAgICAgICAgY29udGV4dC52aWV3TW9kZWxSZXNvdXJjZSA9IHZpZXdNb2RlbFJlc291cmNlO1xuICAgICAgICByZXR1cm4gY29udGV4dDtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHZhciBtID0gX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5nZXRPckNyZWF0ZU93bihfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLnJlc291cmNlLCBIdG1sQmVoYXZpb3JSZXNvdXJjZSwgY29udGV4dC52aWV3TW9kZWwuY29uc3RydWN0b3IpO1xuICAgIG0uZWxlbWVudE5hbWUgPSBtLmVsZW1lbnROYW1lIHx8ICdkeW5hbWljLWVsZW1lbnQnO1xuICAgIG0uaW5pdGlhbGl6ZShjb250ZXh0LmNvbnRhaW5lciB8fCBjaGlsZENvbnRhaW5lciwgY29udGV4dC52aWV3TW9kZWwuY29uc3RydWN0b3IpO1xuICAgIGNvbnRleHQudmlld01vZGVsUmVzb3VyY2UgPSB7IG1ldGFkYXRhOiBtLCB2YWx1ZTogY29udGV4dC52aWV3TW9kZWwuY29uc3RydWN0b3IgfTtcbiAgICBjaGlsZENvbnRhaW5lci52aWV3TW9kZWwgPSBjb250ZXh0LnZpZXdNb2RlbDtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGNvbnRleHQpO1xuICB9O1xuXG4gIENvbXBvc2l0aW9uRW5naW5lLnByb3RvdHlwZS5jb21wb3NlID0gZnVuY3Rpb24gY29tcG9zZShjb250ZXh0KSB7XG4gICAgY29udGV4dC5jaGlsZENvbnRhaW5lciA9IGNvbnRleHQuY2hpbGRDb250YWluZXIgfHwgY29udGV4dC5jb250YWluZXIuY3JlYXRlQ2hpbGQoKTtcbiAgICBjb250ZXh0LnZpZXcgPSB0aGlzLnZpZXdMb2NhdG9yLmdldFZpZXdTdHJhdGVneShjb250ZXh0LnZpZXcpO1xuXG4gICAgdmFyIHRyYW5zYWN0aW9uID0gY29udGV4dC5jaGlsZENvbnRhaW5lci5nZXQoQ29tcG9zaXRpb25UcmFuc2FjdGlvbik7XG4gICAgdmFyIGNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Pd25lcnNoaXBUb2tlbiA9IHRyYW5zYWN0aW9uLnRyeUNhcHR1cmUoKTtcblxuICAgIGlmIChjb21wb3NpdGlvblRyYW5zYWN0aW9uT3duZXJzaGlwVG9rZW4pIHtcbiAgICAgIGNvbnRleHQuY29tcG9zaXRpb25UcmFuc2FjdGlvbk93bmVyc2hpcFRva2VuID0gY29tcG9zaXRpb25UcmFuc2FjdGlvbk93bmVyc2hpcFRva2VuO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb250ZXh0LmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Ob3RpZmllciA9IHRyYW5zYWN0aW9uLmVubGlzdCgpO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0LnZpZXdNb2RlbCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZUNvbnRyb2xsZXJBbmRTd2FwKGNvbnRleHQpO1xuICAgIH0gZWxzZSBpZiAoY29udGV4dC52aWV3KSB7XG4gICAgICBpZiAoY29udGV4dC52aWV3UmVzb3VyY2VzKSB7XG4gICAgICAgIGNvbnRleHQudmlldy5tYWtlUmVsYXRpdmVUbyhjb250ZXh0LnZpZXdSZXNvdXJjZXMudmlld1VybCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjb250ZXh0LnZpZXcubG9hZFZpZXdGYWN0b3J5KHRoaXMudmlld0VuZ2luZSwgbmV3IFZpZXdDb21waWxlSW5zdHJ1Y3Rpb24oKSkudGhlbihmdW5jdGlvbiAodmlld0ZhY3RvcnkpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHZpZXdGYWN0b3J5LmNyZWF0ZShjb250ZXh0LmNoaWxkQ29udGFpbmVyKTtcbiAgICAgICAgcmVzdWx0LmJpbmQoY29udGV4dC5iaW5kaW5nQ29udGV4dCwgY29udGV4dC5vdmVycmlkZUNvbnRleHQpO1xuXG4gICAgICAgIHZhciB3b3JrID0gZnVuY3Rpb24gd29yaygpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGNvbnRleHQudmlld1Nsb3QucmVtb3ZlQWxsKHRydWUpKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnRleHQudmlld1Nsb3QuYWRkKHJlc3VsdCk7XG5cbiAgICAgICAgICAgIGlmIChjb250ZXh0LmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Ob3RpZmllcikge1xuICAgICAgICAgICAgICBjb250ZXh0LmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Ob3RpZmllci5kb25lKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGNvbnRleHQuY29tcG9zaXRpb25UcmFuc2FjdGlvbk93bmVyc2hpcFRva2VuKSB7XG4gICAgICAgICAgcmV0dXJuIGNvbnRleHQuY29tcG9zaXRpb25UcmFuc2FjdGlvbk93bmVyc2hpcFRva2VuLndhaXRGb3JDb21wb3NpdGlvbkNvbXBsZXRlKCkudGhlbih3b3JrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB3b3JrKCk7XG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKGNvbnRleHQudmlld1Nsb3QpIHtcbiAgICAgIGNvbnRleHQudmlld1Nsb3QucmVtb3ZlQWxsKCk7XG5cbiAgICAgIGlmIChjb250ZXh0LmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Ob3RpZmllcikge1xuICAgICAgICBjb250ZXh0LmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Ob3RpZmllci5kb25lKCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBDb21wb3NpdGlvbkVuZ2luZTtcbn0oKSkgfHwgX2NsYXNzMTcpO1xuXG52YXIgRWxlbWVudENvbmZpZ1Jlc291cmNlID0gZXhwb3J0cy5FbGVtZW50Q29uZmlnUmVzb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEVsZW1lbnRDb25maWdSZXNvdXJjZSgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRWxlbWVudENvbmZpZ1Jlc291cmNlKTtcbiAgfVxuXG4gIEVsZW1lbnRDb25maWdSZXNvdXJjZS5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIGluaXRpYWxpemUoY29udGFpbmVyLCB0YXJnZXQpIHt9O1xuXG4gIEVsZW1lbnRDb25maWdSZXNvdXJjZS5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbiByZWdpc3RlcihyZWdpc3RyeSwgbmFtZSkge307XG5cbiAgRWxlbWVudENvbmZpZ1Jlc291cmNlLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gbG9hZChjb250YWluZXIsIHRhcmdldCkge1xuICAgIHZhciBjb25maWcgPSBuZXcgdGFyZ2V0KCk7XG4gICAgdmFyIGV2ZW50TWFuYWdlciA9IGNvbnRhaW5lci5nZXQoX2F1cmVsaWFCaW5kaW5nLkV2ZW50TWFuYWdlcik7XG4gICAgZXZlbnRNYW5hZ2VyLnJlZ2lzdGVyRWxlbWVudENvbmZpZyhjb25maWcpO1xuICB9O1xuXG4gIHJldHVybiBFbGVtZW50Q29uZmlnUmVzb3VyY2U7XG59KCk7XG5cbmZ1bmN0aW9uIHZhbGlkYXRlQmVoYXZpb3JOYW1lKG5hbWUsIHR5cGUpIHtcbiAgaWYgKC9bQS1aXS8udGVzdChuYW1lKSkge1xuICAgIHZhciBuZXdOYW1lID0gX2h5cGhlbmF0ZShuYW1lKTtcbiAgICBMb2dNYW5hZ2VyLmdldExvZ2dlcigndGVtcGxhdGluZycpLndhcm4oJ1xcJycgKyBuYW1lICsgJ1xcJyBpcyBub3QgYSB2YWxpZCAnICsgdHlwZSArICcgbmFtZSBhbmQgaGFzIGJlZW4gY29udmVydGVkIHRvIFxcJycgKyBuZXdOYW1lICsgJ1xcJy4gVXBwZXItY2FzZSBsZXR0ZXJzIGFyZSBub3QgYWxsb3dlZCBiZWNhdXNlIHRoZSBET00gaXMgbm90IGNhc2Utc2Vuc2l0aXZlLicpO1xuICAgIHJldHVybiBuZXdOYW1lO1xuICB9XG4gIHJldHVybiBuYW1lO1xufVxuXG5mdW5jdGlvbiByZXNvdXJjZShpbnN0YW5jZSkge1xuICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgIF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEuZGVmaW5lKF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEucmVzb3VyY2UsIGluc3RhbmNlLCB0YXJnZXQpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBiZWhhdmlvcihvdmVycmlkZSkge1xuICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgIGlmIChvdmVycmlkZSBpbnN0YW5jZW9mIEh0bWxCZWhhdmlvclJlc291cmNlKSB7XG4gICAgICBfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLmRlZmluZShfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLnJlc291cmNlLCBvdmVycmlkZSwgdGFyZ2V0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIHIgPSBfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLmdldE9yQ3JlYXRlT3duKF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEucmVzb3VyY2UsIEh0bWxCZWhhdmlvclJlc291cmNlLCB0YXJnZXQpO1xuICAgICAgT2JqZWN0LmFzc2lnbihyLCBvdmVycmlkZSk7XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBjdXN0b21FbGVtZW50KG5hbWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICB2YXIgciA9IF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEuZ2V0T3JDcmVhdGVPd24oX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5yZXNvdXJjZSwgSHRtbEJlaGF2aW9yUmVzb3VyY2UsIHRhcmdldCk7XG4gICAgci5lbGVtZW50TmFtZSA9IHZhbGlkYXRlQmVoYXZpb3JOYW1lKG5hbWUsICdjdXN0b20gZWxlbWVudCcpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBjdXN0b21BdHRyaWJ1dGUobmFtZSwgZGVmYXVsdEJpbmRpbmdNb2RlKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgdmFyIHIgPSBfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLmdldE9yQ3JlYXRlT3duKF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEucmVzb3VyY2UsIEh0bWxCZWhhdmlvclJlc291cmNlLCB0YXJnZXQpO1xuICAgIHIuYXR0cmlidXRlTmFtZSA9IHZhbGlkYXRlQmVoYXZpb3JOYW1lKG5hbWUsICdjdXN0b20gYXR0cmlidXRlJyk7XG4gICAgci5hdHRyaWJ1dGVEZWZhdWx0QmluZGluZ01vZGUgPSBkZWZhdWx0QmluZGluZ01vZGU7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHRlbXBsYXRlQ29udHJvbGxlcih0YXJnZXQpIHtcbiAgdmFyIGRlY28gPSBmdW5jdGlvbiBkZWNvKHQpIHtcbiAgICB2YXIgciA9IF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEuZ2V0T3JDcmVhdGVPd24oX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5yZXNvdXJjZSwgSHRtbEJlaGF2aW9yUmVzb3VyY2UsIHQpO1xuICAgIHIubGlmdHNDb250ZW50ID0gdHJ1ZTtcbiAgfTtcblxuICByZXR1cm4gdGFyZ2V0ID8gZGVjbyh0YXJnZXQpIDogZGVjbztcbn1cblxuZnVuY3Rpb24gYmluZGFibGUobmFtZU9yQ29uZmlnT3JUYXJnZXQsIGtleSwgZGVzY3JpcHRvcikge1xuICB2YXIgZGVjbyA9IGZ1bmN0aW9uIGRlY28odGFyZ2V0LCBrZXkyLCBkZXNjcmlwdG9yMikge1xuICAgIHZhciBhY3R1YWxUYXJnZXQgPSBrZXkyID8gdGFyZ2V0LmNvbnN0cnVjdG9yIDogdGFyZ2V0O1xuICAgIHZhciByID0gX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5nZXRPckNyZWF0ZU93bihfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLnJlc291cmNlLCBIdG1sQmVoYXZpb3JSZXNvdXJjZSwgYWN0dWFsVGFyZ2V0KTtcbiAgICB2YXIgcHJvcCA9IHZvaWQgMDtcblxuICAgIGlmIChrZXkyKSB7XG4gICAgICBuYW1lT3JDb25maWdPclRhcmdldCA9IG5hbWVPckNvbmZpZ09yVGFyZ2V0IHx8IHt9O1xuICAgICAgbmFtZU9yQ29uZmlnT3JUYXJnZXQubmFtZSA9IGtleTI7XG4gICAgfVxuXG4gICAgcHJvcCA9IG5ldyBCaW5kYWJsZVByb3BlcnR5KG5hbWVPckNvbmZpZ09yVGFyZ2V0KTtcbiAgICByZXR1cm4gcHJvcC5yZWdpc3RlcldpdGgoYWN0dWFsVGFyZ2V0LCByLCBkZXNjcmlwdG9yMik7XG4gIH07XG5cbiAgaWYgKCFuYW1lT3JDb25maWdPclRhcmdldCkge1xuICAgIHJldHVybiBkZWNvO1xuICB9XG5cbiAgaWYgKGtleSkge1xuICAgIHZhciB0YXJnZXQgPSBuYW1lT3JDb25maWdPclRhcmdldDtcbiAgICBuYW1lT3JDb25maWdPclRhcmdldCA9IG51bGw7XG4gICAgcmV0dXJuIGRlY28odGFyZ2V0LCBrZXksIGRlc2NyaXB0b3IpO1xuICB9XG5cbiAgcmV0dXJuIGRlY287XG59XG5cbmZ1bmN0aW9uIGR5bmFtaWNPcHRpb25zKHRhcmdldCkge1xuICB2YXIgZGVjbyA9IGZ1bmN0aW9uIGRlY28odCkge1xuICAgIHZhciByID0gX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5nZXRPckNyZWF0ZU93bihfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLnJlc291cmNlLCBIdG1sQmVoYXZpb3JSZXNvdXJjZSwgdCk7XG4gICAgci5oYXNEeW5hbWljT3B0aW9ucyA9IHRydWU7XG4gIH07XG5cbiAgcmV0dXJuIHRhcmdldCA/IGRlY28odGFyZ2V0KSA6IGRlY287XG59XG5cbmZ1bmN0aW9uIHVzZVNoYWRvd0RPTSh0YXJnZXQpIHtcbiAgdmFyIGRlY28gPSBmdW5jdGlvbiBkZWNvKHQpIHtcbiAgICB2YXIgciA9IF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEuZ2V0T3JDcmVhdGVPd24oX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5yZXNvdXJjZSwgSHRtbEJlaGF2aW9yUmVzb3VyY2UsIHQpO1xuICAgIHIudGFyZ2V0U2hhZG93RE9NID0gdHJ1ZTtcbiAgfTtcblxuICByZXR1cm4gdGFyZ2V0ID8gZGVjbyh0YXJnZXQpIDogZGVjbztcbn1cblxuZnVuY3Rpb24gcHJvY2Vzc0F0dHJpYnV0ZXMocHJvY2Vzc29yKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodCkge1xuICAgIHZhciByID0gX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5nZXRPckNyZWF0ZU93bihfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLnJlc291cmNlLCBIdG1sQmVoYXZpb3JSZXNvdXJjZSwgdCk7XG4gICAgci5wcm9jZXNzQXR0cmlidXRlcyA9IHByb2Nlc3NvcjtcbiAgfTtcbn1cblxuZnVuY3Rpb24gZG9Ob3RQcm9jZXNzQ29udGVudCgpIHtcbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiBwcm9jZXNzQ29udGVudChwcm9jZXNzb3IpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0KSB7XG4gICAgdmFyIHIgPSBfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLmdldE9yQ3JlYXRlT3duKF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEucmVzb3VyY2UsIEh0bWxCZWhhdmlvclJlc291cmNlLCB0KTtcbiAgICByLnByb2Nlc3NDb250ZW50ID0gcHJvY2Vzc29yIHx8IGRvTm90UHJvY2Vzc0NvbnRlbnQ7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGNvbnRhaW5lcmxlc3ModGFyZ2V0KSB7XG4gIHZhciBkZWNvID0gZnVuY3Rpb24gZGVjbyh0KSB7XG4gICAgdmFyIHIgPSBfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLmdldE9yQ3JlYXRlT3duKF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEucmVzb3VyY2UsIEh0bWxCZWhhdmlvclJlc291cmNlLCB0KTtcbiAgICByLmNvbnRhaW5lcmxlc3MgPSB0cnVlO1xuICB9O1xuXG4gIHJldHVybiB0YXJnZXQgPyBkZWNvKHRhcmdldCkgOiBkZWNvO1xufVxuXG5mdW5jdGlvbiB1c2VWaWV3U3RyYXRlZ3koc3RyYXRlZ3kpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICBfYXVyZWxpYU1ldGFkYXRhLm1ldGFkYXRhLmRlZmluZShWaWV3TG9jYXRvci52aWV3U3RyYXRlZ3lNZXRhZGF0YUtleSwgc3RyYXRlZ3ksIHRhcmdldCk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHVzZVZpZXcocGF0aCkge1xuICByZXR1cm4gdXNlVmlld1N0cmF0ZWd5KG5ldyBSZWxhdGl2ZVZpZXdTdHJhdGVneShwYXRoKSk7XG59XG5cbmZ1bmN0aW9uIGlubGluZVZpZXcobWFya3VwLCBkZXBlbmRlbmNpZXMsIGRlcGVuZGVuY3lCYXNlVXJsKSB7XG4gIHJldHVybiB1c2VWaWV3U3RyYXRlZ3kobmV3IElubGluZVZpZXdTdHJhdGVneShtYXJrdXAsIGRlcGVuZGVuY2llcywgZGVwZW5kZW5jeUJhc2VVcmwpKTtcbn1cblxuZnVuY3Rpb24gbm9WaWV3KHRhcmdldCkge1xuICB2YXIgZGVjbyA9IGZ1bmN0aW9uIGRlY28odCkge1xuICAgIF9hdXJlbGlhTWV0YWRhdGEubWV0YWRhdGEuZGVmaW5lKFZpZXdMb2NhdG9yLnZpZXdTdHJhdGVneU1ldGFkYXRhS2V5LCBuZXcgTm9WaWV3U3RyYXRlZ3koKSwgdCk7XG4gIH07XG5cbiAgcmV0dXJuIHRhcmdldCA/IGRlY28odGFyZ2V0KSA6IGRlY287XG59XG5cbmZ1bmN0aW9uIGVsZW1lbnRDb25maWcodGFyZ2V0KSB7XG4gIHZhciBkZWNvID0gZnVuY3Rpb24gZGVjbyh0KSB7XG4gICAgX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5kZWZpbmUoX2F1cmVsaWFNZXRhZGF0YS5tZXRhZGF0YS5yZXNvdXJjZSwgbmV3IEVsZW1lbnRDb25maWdSZXNvdXJjZSgpLCB0KTtcbiAgfTtcblxuICByZXR1cm4gdGFyZ2V0ID8gZGVjbyh0YXJnZXQpIDogZGVjbztcbn1cblxudmFyIFRlbXBsYXRpbmdFbmdpbmUgPSBleHBvcnRzLlRlbXBsYXRpbmdFbmdpbmUgPSAoX2RlYzEwID0gKDAsIF9hdXJlbGlhRGVwZW5kZW5jeUluamVjdGlvbi5pbmplY3QpKF9hdXJlbGlhRGVwZW5kZW5jeUluamVjdGlvbi5Db250YWluZXIsIE1vZHVsZUFuYWx5emVyLCBWaWV3Q29tcGlsZXIsIENvbXBvc2l0aW9uRW5naW5lKSwgX2RlYzEwKF9jbGFzczE4ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBUZW1wbGF0aW5nRW5naW5lKGNvbnRhaW5lciwgbW9kdWxlQW5hbHl6ZXIsIHZpZXdDb21waWxlciwgY29tcG9zaXRpb25FbmdpbmUpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGVtcGxhdGluZ0VuZ2luZSk7XG5cbiAgICB0aGlzLl9jb250YWluZXIgPSBjb250YWluZXI7XG4gICAgdGhpcy5fbW9kdWxlQW5hbHl6ZXIgPSBtb2R1bGVBbmFseXplcjtcbiAgICB0aGlzLl92aWV3Q29tcGlsZXIgPSB2aWV3Q29tcGlsZXI7XG4gICAgdGhpcy5fY29tcG9zaXRpb25FbmdpbmUgPSBjb21wb3NpdGlvbkVuZ2luZTtcbiAgICBjb250YWluZXIucmVnaXN0ZXJJbnN0YW5jZShBbmltYXRvciwgQW5pbWF0b3IuaW5zdGFuY2UgPSBuZXcgQW5pbWF0b3IoKSk7XG4gIH1cblxuICBUZW1wbGF0aW5nRW5naW5lLnByb3RvdHlwZS5jb25maWd1cmVBbmltYXRvciA9IGZ1bmN0aW9uIGNvbmZpZ3VyZUFuaW1hdG9yKGFuaW1hdG9yKSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnVucmVnaXN0ZXIoQW5pbWF0b3IpO1xuICAgIHRoaXMuX2NvbnRhaW5lci5yZWdpc3Rlckluc3RhbmNlKEFuaW1hdG9yLCBBbmltYXRvci5pbnN0YW5jZSA9IGFuaW1hdG9yKTtcbiAgfTtcblxuICBUZW1wbGF0aW5nRW5naW5lLnByb3RvdHlwZS5jb21wb3NlID0gZnVuY3Rpb24gY29tcG9zZShjb250ZXh0KSB7XG4gICAgcmV0dXJuIHRoaXMuX2NvbXBvc2l0aW9uRW5naW5lLmNvbXBvc2UoY29udGV4dCk7XG4gIH07XG5cbiAgVGVtcGxhdGluZ0VuZ2luZS5wcm90b3R5cGUuZW5oYW5jZSA9IGZ1bmN0aW9uIGVuaGFuY2UoaW5zdHJ1Y3Rpb24pIHtcbiAgICBpZiAoaW5zdHJ1Y3Rpb24gaW5zdGFuY2VvZiBfYXVyZWxpYVBhbC5ET00uRWxlbWVudCkge1xuICAgICAgaW5zdHJ1Y3Rpb24gPSB7IGVsZW1lbnQ6IGluc3RydWN0aW9uIH07XG4gICAgfVxuXG4gICAgdmFyIGNvbXBpbGVySW5zdHJ1Y3Rpb25zID0ge307XG4gICAgdmFyIHJlc291cmNlcyA9IGluc3RydWN0aW9uLnJlc291cmNlcyB8fCB0aGlzLl9jb250YWluZXIuZ2V0KFZpZXdSZXNvdXJjZXMpO1xuXG4gICAgdGhpcy5fdmlld0NvbXBpbGVyLl9jb21waWxlTm9kZShpbnN0cnVjdGlvbi5lbGVtZW50LCByZXNvdXJjZXMsIGNvbXBpbGVySW5zdHJ1Y3Rpb25zLCBpbnN0cnVjdGlvbi5lbGVtZW50LnBhcmVudE5vZGUsICdyb290JywgdHJ1ZSk7XG5cbiAgICB2YXIgZmFjdG9yeSA9IG5ldyBWaWV3RmFjdG9yeShpbnN0cnVjdGlvbi5lbGVtZW50LCBjb21waWxlckluc3RydWN0aW9ucywgcmVzb3VyY2VzKTtcbiAgICB2YXIgY29udGFpbmVyID0gaW5zdHJ1Y3Rpb24uY29udGFpbmVyIHx8IHRoaXMuX2NvbnRhaW5lci5jcmVhdGVDaGlsZCgpO1xuICAgIHZhciB2aWV3ID0gZmFjdG9yeS5jcmVhdGUoY29udGFpbmVyLCBCZWhhdmlvckluc3RydWN0aW9uLmVuaGFuY2UoKSk7XG5cbiAgICB2aWV3LmJpbmQoaW5zdHJ1Y3Rpb24uYmluZGluZ0NvbnRleHQgfHwge30sIGluc3RydWN0aW9uLm92ZXJyaWRlQ29udGV4dCk7XG5cbiAgICByZXR1cm4gdmlldztcbiAgfTtcblxuICBUZW1wbGF0aW5nRW5naW5lLnByb3RvdHlwZS5jcmVhdGVDb250cm9sbGVyRm9yVW5pdFRlc3QgPSBmdW5jdGlvbiBjcmVhdGVDb250cm9sbGVyRm9yVW5pdFRlc3Qodmlld01vZGVsVHlwZSwgYXR0cmlidXRlc0Zyb21IVE1MKSB7XG4gICAgdmFyIF9tb2R1bGVBbmFseXplciRhbmFseTtcblxuICAgIHZhciBleHBvcnROYW1lID0gdmlld01vZGVsVHlwZS5uYW1lO1xuICAgIHZhciByZXNvdXJjZU1vZHVsZSA9IHRoaXMuX21vZHVsZUFuYWx5emVyLmFuYWx5emUoJ3Rlc3QtbW9kdWxlJywgKF9tb2R1bGVBbmFseXplciRhbmFseSA9IHt9LCBfbW9kdWxlQW5hbHl6ZXIkYW5hbHlbZXhwb3J0TmFtZV0gPSB2aWV3TW9kZWxUeXBlLCBfbW9kdWxlQW5hbHl6ZXIkYW5hbHkpLCBleHBvcnROYW1lKTtcbiAgICB2YXIgZGVzY3JpcHRpb24gPSByZXNvdXJjZU1vZHVsZS5tYWluUmVzb3VyY2U7XG5cbiAgICBkZXNjcmlwdGlvbi5pbml0aWFsaXplKHRoaXMuX2NvbnRhaW5lcik7XG5cbiAgICB2YXIgdmlld01vZGVsID0gdGhpcy5fY29udGFpbmVyLmdldCh2aWV3TW9kZWxUeXBlKTtcbiAgICB2YXIgaW5zdHJ1Y3Rpb24gPSBCZWhhdmlvckluc3RydWN0aW9uLnVuaXRUZXN0KGRlc2NyaXB0aW9uLCBhdHRyaWJ1dGVzRnJvbUhUTUwpO1xuXG4gICAgcmV0dXJuIG5ldyBDb250cm9sbGVyKGRlc2NyaXB0aW9uLm1ldGFkYXRhLCBpbnN0cnVjdGlvbiwgdmlld01vZGVsKTtcbiAgfTtcblxuICBUZW1wbGF0aW5nRW5naW5lLnByb3RvdHlwZS5jcmVhdGVWaWV3TW9kZWxGb3JVbml0VGVzdCA9IGZ1bmN0aW9uIGNyZWF0ZVZpZXdNb2RlbEZvclVuaXRUZXN0KHZpZXdNb2RlbFR5cGUsIGF0dHJpYnV0ZXNGcm9tSFRNTCwgYmluZGluZ0NvbnRleHQpIHtcbiAgICB2YXIgY29udHJvbGxlciA9IHRoaXMuY3JlYXRlQ29udHJvbGxlckZvclVuaXRUZXN0KHZpZXdNb2RlbFR5cGUsIGF0dHJpYnV0ZXNGcm9tSFRNTCk7XG4gICAgY29udHJvbGxlci5iaW5kKCgwLCBfYXVyZWxpYUJpbmRpbmcuY3JlYXRlU2NvcGVGb3JUZXN0KShiaW5kaW5nQ29udGV4dCkpO1xuICAgIHJldHVybiBjb250cm9sbGVyLnZpZXdNb2RlbDtcbiAgfTtcblxuICByZXR1cm4gVGVtcGxhdGluZ0VuZ2luZTtcbn0oKSkgfHwgX2NsYXNzMTgpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy9kaXN0L2NvbW1vbmpzL2F1cmVsaWEtdGVtcGxhdGluZy5qc1xuICoqIG1vZHVsZSBpZCA9IDI0XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLkV2ZW50QWdncmVnYXRvciA9IHVuZGVmaW5lZDtcbmV4cG9ydHMuaW5jbHVkZUV2ZW50c0luID0gaW5jbHVkZUV2ZW50c0luO1xuZXhwb3J0cy5jb25maWd1cmUgPSBjb25maWd1cmU7XG5cbnZhciBfYXVyZWxpYUxvZ2dpbmcgPSByZXF1aXJlKCdhdXJlbGlhLWxvZ2dpbmcnKTtcblxudmFyIExvZ01hbmFnZXIgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfYXVyZWxpYUxvZ2dpbmcpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgbG9nZ2VyID0gTG9nTWFuYWdlci5nZXRMb2dnZXIoJ2V2ZW50LWFnZ3JlZ2F0b3InKTtcblxudmFyIEhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEhhbmRsZXIobWVzc2FnZVR5cGUsIGNhbGxiYWNrKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEhhbmRsZXIpO1xuXG4gICAgdGhpcy5tZXNzYWdlVHlwZSA9IG1lc3NhZ2VUeXBlO1xuICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgfVxuXG4gIEhhbmRsZXIucHJvdG90eXBlLmhhbmRsZSA9IGZ1bmN0aW9uIGhhbmRsZShtZXNzYWdlKSB7XG4gICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiB0aGlzLm1lc3NhZ2VUeXBlKSB7XG4gICAgICB0aGlzLmNhbGxiYWNrLmNhbGwobnVsbCwgbWVzc2FnZSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBIYW5kbGVyO1xufSgpO1xuXG52YXIgRXZlbnRBZ2dyZWdhdG9yID0gZXhwb3J0cy5FdmVudEFnZ3JlZ2F0b3IgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEV2ZW50QWdncmVnYXRvcigpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXZlbnRBZ2dyZWdhdG9yKTtcblxuICAgIHRoaXMuZXZlbnRMb29rdXAgPSB7fTtcbiAgICB0aGlzLm1lc3NhZ2VIYW5kbGVycyA9IFtdO1xuICB9XG5cbiAgRXZlbnRBZ2dyZWdhdG9yLnByb3RvdHlwZS5wdWJsaXNoID0gZnVuY3Rpb24gcHVibGlzaChldmVudCwgZGF0YSkge1xuICAgIHZhciBzdWJzY3JpYmVycyA9IHZvaWQgMDtcbiAgICB2YXIgaSA9IHZvaWQgMDtcblxuICAgIGlmICghZXZlbnQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRXZlbnQgd2FzIGludmFsaWQuJyk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBldmVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHN1YnNjcmliZXJzID0gdGhpcy5ldmVudExvb2t1cFtldmVudF07XG4gICAgICBpZiAoc3Vic2NyaWJlcnMpIHtcbiAgICAgICAgc3Vic2NyaWJlcnMgPSBzdWJzY3JpYmVycy5zbGljZSgpO1xuICAgICAgICBpID0gc3Vic2NyaWJlcnMubGVuZ3RoO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgc3Vic2NyaWJlcnNbaV0oZGF0YSwgZXZlbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcihlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBzdWJzY3JpYmVycyA9IHRoaXMubWVzc2FnZUhhbmRsZXJzLnNsaWNlKCk7XG4gICAgICBpID0gc3Vic2NyaWJlcnMubGVuZ3RoO1xuXG4gICAgICB0cnkge1xuICAgICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgICAgc3Vic2NyaWJlcnNbaV0uaGFuZGxlKGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2dnZXIuZXJyb3IoZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIEV2ZW50QWdncmVnYXRvci5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gc3Vic2NyaWJlKGV2ZW50LCBjYWxsYmFjaykge1xuICAgIHZhciBoYW5kbGVyID0gdm9pZCAwO1xuICAgIHZhciBzdWJzY3JpYmVycyA9IHZvaWQgMDtcblxuICAgIGlmICghZXZlbnQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRXZlbnQgY2hhbm5lbC90eXBlIHdhcyBpbnZhbGlkLicpO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgZXZlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICBoYW5kbGVyID0gY2FsbGJhY2s7XG4gICAgICBzdWJzY3JpYmVycyA9IHRoaXMuZXZlbnRMb29rdXBbZXZlbnRdIHx8ICh0aGlzLmV2ZW50TG9va3VwW2V2ZW50XSA9IFtdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaGFuZGxlciA9IG5ldyBIYW5kbGVyKGV2ZW50LCBjYWxsYmFjayk7XG4gICAgICBzdWJzY3JpYmVycyA9IHRoaXMubWVzc2FnZUhhbmRsZXJzO1xuICAgIH1cblxuICAgIHN1YnNjcmliZXJzLnB1c2goaGFuZGxlcik7XG5cbiAgICByZXR1cm4ge1xuICAgICAgZGlzcG9zZTogZnVuY3Rpb24gZGlzcG9zZSgpIHtcbiAgICAgICAgdmFyIGlkeCA9IHN1YnNjcmliZXJzLmluZGV4T2YoaGFuZGxlcik7XG4gICAgICAgIGlmIChpZHggIT09IC0xKSB7XG4gICAgICAgICAgc3Vic2NyaWJlcnMuc3BsaWNlKGlkeCwgMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9O1xuXG4gIEV2ZW50QWdncmVnYXRvci5wcm90b3R5cGUuc3Vic2NyaWJlT25jZSA9IGZ1bmN0aW9uIHN1YnNjcmliZU9uY2UoZXZlbnQsIGNhbGxiYWNrKSB7XG4gICAgdmFyIHN1YiA9IHRoaXMuc3Vic2NyaWJlKGV2ZW50LCBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgc3ViLmRpc3Bvc2UoKTtcbiAgICAgIHJldHVybiBjYWxsYmFjayhhLCBiKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBzdWI7XG4gIH07XG5cbiAgcmV0dXJuIEV2ZW50QWdncmVnYXRvcjtcbn0oKTtcblxuZnVuY3Rpb24gaW5jbHVkZUV2ZW50c0luKG9iaikge1xuICB2YXIgZWEgPSBuZXcgRXZlbnRBZ2dyZWdhdG9yKCk7XG5cbiAgb2JqLnN1YnNjcmliZU9uY2UgPSBmdW5jdGlvbiAoZXZlbnQsIGNhbGxiYWNrKSB7XG4gICAgcmV0dXJuIGVhLnN1YnNjcmliZU9uY2UoZXZlbnQsIGNhbGxiYWNrKTtcbiAgfTtcblxuICBvYmouc3Vic2NyaWJlID0gZnVuY3Rpb24gKGV2ZW50LCBjYWxsYmFjaykge1xuICAgIHJldHVybiBlYS5zdWJzY3JpYmUoZXZlbnQsIGNhbGxiYWNrKTtcbiAgfTtcblxuICBvYmoucHVibGlzaCA9IGZ1bmN0aW9uIChldmVudCwgZGF0YSkge1xuICAgIGVhLnB1Ymxpc2goZXZlbnQsIGRhdGEpO1xuICB9O1xuXG4gIHJldHVybiBlYTtcbn1cblxuZnVuY3Rpb24gY29uZmlndXJlKGNvbmZpZykge1xuICBjb25maWcuaW5zdGFuY2UoRXZlbnRBZ2dyZWdhdG9yLCBpbmNsdWRlRXZlbnRzSW4oY29uZmlnLmF1cmVsaWEpKTtcbn1cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLWV2ZW50LWFnZ3JlZ2F0b3IvZGlzdC9jb21tb25qcy9hdXJlbGlhLWV2ZW50LWFnZ3JlZ2F0b3IuanNcbiAqKiBtb2R1bGUgaWQgPSAyNVxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5jb25maWd1cmUgPSBleHBvcnRzLlNhaWxzU29ja2V0Q2xpZW50ID0gZXhwb3J0cy5SZXF1ZXN0QnVpbGRlciA9IGV4cG9ydHMuU29ja2V0UmVxdWVzdE1lc3NhZ2UgPSBleHBvcnRzLlJlcXVlc3RNZXNzYWdlUHJvY2Vzc29yID0gZXhwb3J0cy5Tb2NrZXRSZXNwb25zZU1lc3NhZ2UgPSBleHBvcnRzLkhlYWRlcnMgPSBleHBvcnRzLkxvZ2dlckludGVyY2VwdG9yID0gZXhwb3J0cy5DU1JGSW50ZXJjZXB0b3IgPSB1bmRlZmluZWQ7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmV4cG9ydHMuY3JlYXRlU29ja2V0UmVxdWVzdE1lc3NhZ2VQcm9jZXNzb3IgPSBjcmVhdGVTb2NrZXRSZXF1ZXN0TWVzc2FnZVByb2Nlc3NvcjtcbmV4cG9ydHMuY29uZmlndXJlID0gY29uZmlndXJlO1xuXG52YXIgX2F1cmVsaWFMb2dnaW5nID0gcmVxdWlyZSgnYXVyZWxpYS1sb2dnaW5nJyk7XG5cbnZhciBMb2dNYW5hZ2VyID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX2F1cmVsaWFMb2dnaW5nKTtcblxudmFyIF9hdXJlbGlhUGF0aCA9IHJlcXVpcmUoJ2F1cmVsaWEtcGF0aCcpO1xuXG52YXIgX2F1cmVsaWFQYWwgPSByZXF1aXJlKCdhdXJlbGlhLXBhbCcpO1xuXG5yZXF1aXJlKCdzYWlscy5pby5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgbG9nZ2VyID0gTG9nTWFuYWdlci5nZXRMb2dnZXIoJ3NhaWxzJyk7XG5cbnZhciBDU1JGSW50ZXJjZXB0b3IgPSBleHBvcnRzLkNTUkZJbnRlcmNlcHRvciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQ1NSRkludGVyY2VwdG9yKHVybCwgY2xpZW50LCB0b2tlbikge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDU1JGSW50ZXJjZXB0b3IpO1xuXG4gICAgdGhpcy51cmwgPSB1cmw7XG4gICAgdGhpcy5jbGllbnQgPSBjbGllbnQ7XG4gICAgdGhpcy50b2tlbiA9IHRva2VuO1xuICB9XG5cbiAgQ1NSRkludGVyY2VwdG9yLnByb3RvdHlwZS5yZXF1ZXN0ID0gZnVuY3Rpb24gcmVxdWVzdChtZXNzYWdlKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIGlmIChtZXNzYWdlLm1ldGhvZCA9PT0gJ2dldCcgfHwgbWVzc2FnZS51cmwgPT09IHRoaXMudXJsKSB7XG4gICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy50b2tlbikge1xuICAgICAgdGhpcy5zZXRDc3JmVG9rZW5IZWFkZXIobWVzc2FnZSk7XG4gICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIHByb21pc2UgPSB2b2lkIDA7XG4gICAgICBpZiAoX3RoaXMuX2ZldGNoaW5nKSB7XG4gICAgICAgIHByb21pc2UgPSBfdGhpcy5fZmV0Y2hpbmc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcm9taXNlID0gX3RoaXMuX2ZldGNoaW5nID0gX3RoaXMuY2xpZW50LmdldChfdGhpcy51cmwpO1xuICAgICAgfVxuICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBfdGhpcy50b2tlbiA9IHJlc3BvbnNlLmNvbnRlbnQuX2NzcmY7XG4gICAgICAgIF90aGlzLnNldENzcmZUb2tlbkhlYWRlcihtZXNzYWdlKTtcbiAgICAgICAgcmVzb2x2ZShtZXNzYWdlKTtcbiAgICAgIH0pLmNhdGNoKHJlamVjdCk7XG4gICAgfSk7XG4gIH07XG5cbiAgQ1NSRkludGVyY2VwdG9yLnByb3RvdHlwZS5zZXRDc3JmVG9rZW5IZWFkZXIgPSBmdW5jdGlvbiBzZXRDc3JmVG9rZW5IZWFkZXIobWVzc2FnZSkge1xuICAgIG1lc3NhZ2UuaGVhZGVycy5hZGQoJ1gtQ3NyZi1Ub2tlbicsIHRoaXMudG9rZW4pO1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9O1xuXG4gIHJldHVybiBDU1JGSW50ZXJjZXB0b3I7XG59KCk7XG5cbnZhciBMb2dnZXJJbnRlcmNlcHRvciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gTG9nZ2VySW50ZXJjZXB0b3IoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExvZ2dlckludGVyY2VwdG9yKTtcbiAgfVxuXG4gIExvZ2dlckludGVyY2VwdG9yLnByb3RvdHlwZS5yZXF1ZXN0ID0gZnVuY3Rpb24gcmVxdWVzdChtZXNzYWdlKSB7XG4gICAgbG9nZ2VyLmRlYnVnKCdTZW5kaW5nIG1lc3NhZ2UgdG8gc2FpbHMnLCBtZXNzYWdlKTtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfTtcblxuICBMb2dnZXJJbnRlcmNlcHRvci5wcm90b3R5cGUucmVzcG9uc2UgPSBmdW5jdGlvbiByZXNwb25zZShfcmVzcG9uc2UpIHtcbiAgICBsb2dnZXIuZGVidWcoJ1JlY2VpdmluZyByZXNwb25zZSBmcm9tIHNhaWxzJywgX3Jlc3BvbnNlKTtcbiAgICByZXR1cm4gX3Jlc3BvbnNlO1xuICB9O1xuXG4gIExvZ2dlckludGVyY2VwdG9yLnByb3RvdHlwZS5yZXNwb25zZUVycm9yID0gZnVuY3Rpb24gcmVzcG9uc2VFcnJvcihyZXNwb25zZSkge1xuICAgIGxvZ2dlci5lcnJvcignVGhlcmUgd2FzIGFuIGVycm9yIGR1cmluZyBzYWlscyByZXF1ZXN0JywgcmVzcG9uc2UpO1xuICAgIHRocm93IHJlc3BvbnNlO1xuICB9O1xuXG4gIHJldHVybiBMb2dnZXJJbnRlcmNlcHRvcjtcbn0oKTtcblxuZXhwb3J0cy5Mb2dnZXJJbnRlcmNlcHRvciA9IExvZ2dlckludGVyY2VwdG9yO1xuXG52YXIgSGVhZGVycyA9IGV4cG9ydHMuSGVhZGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gSGVhZGVycygpIHtcbiAgICB2YXIgaGVhZGVycyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzBdO1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEhlYWRlcnMpO1xuXG4gICAgdGhpcy5oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIEhlYWRlcnMucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIGFkZChrZXksIHZhbHVlKSB7XG4gICAgdGhpcy5oZWFkZXJzW2tleV0gPSB2YWx1ZTtcbiAgfTtcblxuICBIZWFkZXJzLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiBnZXQoa2V5KSB7XG4gICAgcmV0dXJuIHRoaXMuaGVhZGVyc1trZXldO1xuICB9O1xuXG4gIEhlYWRlcnMucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gY2xlYXIoKSB7XG4gICAgdGhpcy5oZWFkZXJzID0ge307XG4gIH07XG5cbiAgcmV0dXJuIEhlYWRlcnM7XG59KCk7XG5cbnZhciBTb2NrZXRSZXNwb25zZU1lc3NhZ2UgPSBleHBvcnRzLlNvY2tldFJlc3BvbnNlTWVzc2FnZSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gU29ja2V0UmVzcG9uc2VNZXNzYWdlKHJlcXVlc3RNZXNzYWdlLCBib2R5LCBKV1IpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU29ja2V0UmVzcG9uc2VNZXNzYWdlKTtcblxuICAgIHRoaXMucmVxdWVzdE1lc3NhZ2UgPSByZXF1ZXN0TWVzc2FnZTtcbiAgICB0aGlzLnN0YXR1c0NvZGUgPSBKV1Iuc3RhdHVzQ29kZTtcbiAgICB0aGlzLmJvZHkgPSBib2R5O1xuXG4gICAgdGhpcy5pc1N1Y2Nlc3MgPSB0aGlzLnN0YXR1c0NvZGUgPj0gMjAwICYmIHRoaXMuc3RhdHVzQ29kZSA8IDQwMDtcbiAgICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhKV1IuaGVhZGVycyk7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoU29ja2V0UmVzcG9uc2VNZXNzYWdlLCBbe1xuICAgIGtleTogJ2NvbnRlbnQnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuYm9keTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gU29ja2V0UmVzcG9uc2VNZXNzYWdlO1xufSgpO1xuXG52YXIgUmVxdWVzdE1lc3NhZ2VQcm9jZXNzb3IgPSBleHBvcnRzLlJlcXVlc3RNZXNzYWdlUHJvY2Vzc29yID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBSZXF1ZXN0TWVzc2FnZVByb2Nlc3Nvcih0cmFuc2Zvcm1lcnMpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmVxdWVzdE1lc3NhZ2VQcm9jZXNzb3IpO1xuXG4gICAgdGhpcy50cmFuc2Zvcm1lcnMgPSB0cmFuc2Zvcm1lcnM7XG4gIH1cblxuICBSZXF1ZXN0TWVzc2FnZVByb2Nlc3Nvci5wcm90b3R5cGUuYWJvcnQgPSBmdW5jdGlvbiBhYm9ydCgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBhYm9ydCBzb2NrZXQgcmVxdWVzdCcpO1xuICB9O1xuXG4gIFJlcXVlc3RNZXNzYWdlUHJvY2Vzc29yLnByb3RvdHlwZS5wcm9jZXNzID0gZnVuY3Rpb24gcHJvY2VzcyhjbGllbnQsIHJlcXVlc3RNZXNzYWdlKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIHRyYW5zZm9ybWVycyA9IF90aGlzMi50cmFuc2Zvcm1lcnM7XG4gICAgICB2YXIgcHJvbWlzZXMgPSBbXTtcbiAgICAgIHZhciBpID0gdm9pZCAwO1xuICAgICAgdmFyIGlpID0gdm9pZCAwO1xuXG4gICAgICBmb3IgKGkgPSAwLCBpaSA9IHRyYW5zZm9ybWVycy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgIHByb21pc2VzLnB1c2godHJhbnNmb3JtZXJzW2ldKGNsaWVudCwgX3RoaXMyLCByZXF1ZXN0TWVzc2FnZSkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gcmVzb2x2ZShyZXF1ZXN0TWVzc2FnZSk7XG4gICAgICB9KS5jYXRjaChyZWplY3QpO1xuICAgIH0pLnRoZW4oZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgIHZhciBwcm9jZXNzUmVxdWVzdCA9IGZ1bmN0aW9uIHByb2Nlc3NSZXF1ZXN0KGN1cnJlbnRNZXNzYWdlKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgY2xpZW50LnNvY2tldC5yZXF1ZXN0KGN1cnJlbnRNZXNzYWdlLm9wdGlvbnMsIGZ1bmN0aW9uIChkYXRhLCBqd3IpIHtcbiAgICAgICAgICAgIHZhciByZXNwb25zZSA9IG5ldyBTb2NrZXRSZXNwb25zZU1lc3NhZ2UoY3VycmVudE1lc3NhZ2UsIGRhdGEsIGp3cik7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2UuaXNTdWNjZXNzKSB7XG4gICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICB2YXIgY2hhaW4gPSBbW3Byb2Nlc3NSZXF1ZXN0LCB1bmRlZmluZWRdXTtcblxuICAgICAgdmFyIGludGVyY2VwdG9ycyA9IG1lc3NhZ2UuaW50ZXJjZXB0b3JzIHx8IFtdO1xuICAgICAgaW50ZXJjZXB0b3JzLmZvckVhY2goZnVuY3Rpb24gKGludGVyY2VwdG9yKSB7XG4gICAgICAgIGlmIChpbnRlcmNlcHRvci5yZXF1ZXN0IHx8IGludGVyY2VwdG9yLnJlcXVlc3RFcnJvcikge1xuICAgICAgICAgIGNoYWluLnVuc2hpZnQoW2ludGVyY2VwdG9yLnJlcXVlc3QgPyBpbnRlcmNlcHRvci5yZXF1ZXN0LmJpbmQoaW50ZXJjZXB0b3IpIDogdW5kZWZpbmVkLCBpbnRlcmNlcHRvci5yZXF1ZXN0RXJyb3IgPyBpbnRlcmNlcHRvci5yZXF1ZXN0RXJyb3IuYmluZChpbnRlcmNlcHRvcikgOiB1bmRlZmluZWRdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpbnRlcmNlcHRvci5yZXNwb25zZSB8fCBpbnRlcmNlcHRvci5yZXNwb25zZUVycm9yKSB7XG4gICAgICAgICAgY2hhaW4ucHVzaChbaW50ZXJjZXB0b3IucmVzcG9uc2UgPyBpbnRlcmNlcHRvci5yZXNwb25zZS5iaW5kKGludGVyY2VwdG9yKSA6IHVuZGVmaW5lZCwgaW50ZXJjZXB0b3IucmVzcG9uc2VFcnJvciA/IGludGVyY2VwdG9yLnJlc3BvbnNlRXJyb3IuYmluZChpbnRlcmNlcHRvcikgOiB1bmRlZmluZWRdKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHZhciBpbnRlcmNlcHRvcnNQcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKG1lc3NhZ2UpO1xuXG4gICAgICB3aGlsZSAoY2hhaW4ubGVuZ3RoKSB7XG4gICAgICAgIHZhciBfaW50ZXJjZXB0b3JzUHJvbWlzZTtcblxuICAgICAgICBpbnRlcmNlcHRvcnNQcm9taXNlID0gKF9pbnRlcmNlcHRvcnNQcm9taXNlID0gaW50ZXJjZXB0b3JzUHJvbWlzZSkudGhlbi5hcHBseShfaW50ZXJjZXB0b3JzUHJvbWlzZSwgY2hhaW4uc2hpZnQoKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBpbnRlcmNlcHRvcnNQcm9taXNlO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiBSZXF1ZXN0TWVzc2FnZVByb2Nlc3Nvcjtcbn0oKTtcblxuZnVuY3Rpb24gYnVpbGRGdWxsVXJsKG1lc3NhZ2UpIHtcbiAgdmFyIHVybCA9IHZvaWQgMDtcbiAgdmFyIHFzID0gdm9pZCAwO1xuXG4gIGlmIChtZXNzYWdlLnVybCAmJiBtZXNzYWdlLnVybFswXSA9PT0gJy8nKSB7XG4gICAgdXJsID0gbWVzc2FnZS51cmw7XG4gIH0gZWxzZSB7XG4gICAgdXJsID0gKDAsIF9hdXJlbGlhUGF0aC5qb2luKShtZXNzYWdlLmJhc2VVcmwsIG1lc3NhZ2UudXJsKTtcbiAgfVxuXG4gIGlmIChtZXNzYWdlLnBhcmFtcykge1xuICAgIHFzID0gKDAsIF9hdXJlbGlhUGF0aC5idWlsZFF1ZXJ5U3RyaW5nKShtZXNzYWdlLnBhcmFtcyk7XG4gICAgdXJsID0gcXMgPyB1cmwgKyAnPycgKyBxcyA6IHVybDtcbiAgfVxuXG4gIHJldHVybiB1cmw7XG59XG5cbnZhciBTb2NrZXRSZXF1ZXN0TWVzc2FnZSA9IGV4cG9ydHMuU29ja2V0UmVxdWVzdE1lc3NhZ2UgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFNvY2tldFJlcXVlc3RNZXNzYWdlKG1ldGhvZCwgdXJsLCBjb250ZW50LCBoZWFkZXJzKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNvY2tldFJlcXVlc3RNZXNzYWdlKTtcblxuICAgIHRoaXMubWV0aG9kID0gbWV0aG9kO1xuICAgIHRoaXMudXJsID0gdXJsO1xuICAgIHRoaXMuY29udGVudCA9IGNvbnRlbnQ7XG4gICAgdGhpcy5oZWFkZXJzID0gaGVhZGVycyB8fCBuZXcgSGVhZGVycygpO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKFNvY2tldFJlcXVlc3RNZXNzYWdlLCBbe1xuICAgIGtleTogJ29wdGlvbnMnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWV0aG9kOiB0aGlzLm1ldGhvZCxcbiAgICAgICAgdXJsOiBidWlsZEZ1bGxVcmwodGhpcyksXG4gICAgICAgIHBhcmFtczogdGhpcy5jb250ZW50LFxuICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMuaGVhZGVyc1xuICAgICAgfTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gU29ja2V0UmVxdWVzdE1lc3NhZ2U7XG59KCk7XG5cbmZ1bmN0aW9uIGNyZWF0ZVNvY2tldFJlcXVlc3RNZXNzYWdlUHJvY2Vzc29yKCkge1xuICByZXR1cm4gbmV3IFJlcXVlc3RNZXNzYWdlUHJvY2Vzc29yKFtdKTtcbn1cblxudmFyIFJlcXVlc3RCdWlsZGVyID0gZXhwb3J0cy5SZXF1ZXN0QnVpbGRlciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUmVxdWVzdEJ1aWxkZXIoY2xpZW50KSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlcXVlc3RCdWlsZGVyKTtcblxuICAgIHRoaXMuY2xpZW50ID0gY2xpZW50O1xuICAgIHRoaXMudHJhbnNmb3JtZXJzID0gY2xpZW50LnJlcXVlc3RUcmFuc2Zvcm1lcnMuc2xpY2UoMCk7XG4gIH1cblxuICBSZXF1ZXN0QnVpbGRlci5hZGRIZWxwZXIgPSBmdW5jdGlvbiBhZGRIZWxwZXIobmFtZSwgZm4pIHtcbiAgICBSZXF1ZXN0QnVpbGRlci5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnRyYW5zZm9ybWVycy5wdXNoKGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgfTtcblxuICBSZXF1ZXN0QnVpbGRlci5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uIHNlbmQoKSB7XG4gICAgdmFyIG1lc3NhZ2UgPSBuZXcgU29ja2V0UmVxdWVzdE1lc3NhZ2UoKTtcbiAgICByZXR1cm4gdGhpcy5jbGllbnQuc2VuZChtZXNzYWdlLCB0aGlzLnRyYW5zZm9ybWVycyk7XG4gIH07XG5cbiAgcmV0dXJuIFJlcXVlc3RCdWlsZGVyO1xufSgpO1xuXG5SZXF1ZXN0QnVpbGRlci5hZGRIZWxwZXIoJ2FzRGVsZXRlJywgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gZnVuY3Rpb24gKGNsaWVudCwgcHJvY2Vzc29yLCBtZXNzYWdlKSB7XG4gICAgbWVzc2FnZS5tZXRob2QgPSAnZGVsZXRlJztcbiAgfTtcbn0pO1xuXG5SZXF1ZXN0QnVpbGRlci5hZGRIZWxwZXIoJ2FzR2V0JywgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gZnVuY3Rpb24gKGNsaWVudCwgcHJvY2Vzc29yLCBtZXNzYWdlKSB7XG4gICAgbWVzc2FnZS5tZXRob2QgPSAnZ2V0JztcbiAgfTtcbn0pO1xuXG5SZXF1ZXN0QnVpbGRlci5hZGRIZWxwZXIoJ2FzSGVhZCcsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChjbGllbnQsIHByb2Nlc3NvciwgbWVzc2FnZSkge1xuICAgIG1lc3NhZ2UubWV0aG9kID0gJ2hlYWQnO1xuICB9O1xufSk7XG5cblJlcXVlc3RCdWlsZGVyLmFkZEhlbHBlcignYXNPcHRpb25zJywgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gZnVuY3Rpb24gKGNsaWVudCwgcHJvY2Vzc29yLCBtZXNzYWdlKSB7XG4gICAgbWVzc2FnZS5tZXRob2QgPSAnb3B0aW9ucyc7XG4gIH07XG59KTtcblxuUmVxdWVzdEJ1aWxkZXIuYWRkSGVscGVyKCdhc1BhdGNoJywgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gZnVuY3Rpb24gKGNsaWVudCwgcHJvY2Vzc29yLCBtZXNzYWdlKSB7XG4gICAgbWVzc2FnZS5tZXRob2QgPSAncGF0Y2gnO1xuICB9O1xufSk7XG5cblJlcXVlc3RCdWlsZGVyLmFkZEhlbHBlcignYXNQb3N0JywgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gZnVuY3Rpb24gKGNsaWVudCwgcHJvY2Vzc29yLCBtZXNzYWdlKSB7XG4gICAgbWVzc2FnZS5tZXRob2QgPSAncG9zdCc7XG4gIH07XG59KTtcblxuUmVxdWVzdEJ1aWxkZXIuYWRkSGVscGVyKCdhc1B1dCcsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChjbGllbnQsIHByb2Nlc3NvciwgbWVzc2FnZSkge1xuICAgIG1lc3NhZ2UubWV0aG9kID0gJ3B1dCc7XG4gIH07XG59KTtcblxuUmVxdWVzdEJ1aWxkZXIuYWRkSGVscGVyKCd3aXRoVXJsJywgZnVuY3Rpb24gKHVybCkge1xuICByZXR1cm4gZnVuY3Rpb24gKGNsaWVudCwgcHJvY2Vzc29yLCBtZXNzYWdlKSB7XG4gICAgbWVzc2FnZS51cmwgPSB1cmw7XG4gIH07XG59KTtcblxuUmVxdWVzdEJ1aWxkZXIuYWRkSGVscGVyKCd3aXRoQ29udGVudCcsIGZ1bmN0aW9uIChjb250ZW50KSB7XG4gIHJldHVybiBmdW5jdGlvbiAoY2xpZW50LCBwcm9jZXNzb3IsIG1lc3NhZ2UpIHtcbiAgICBtZXNzYWdlLmNvbnRlbnQgPSBjb250ZW50O1xuICB9O1xufSk7XG5cblJlcXVlc3RCdWlsZGVyLmFkZEhlbHBlcignd2l0aEJhc2VVcmwnLCBmdW5jdGlvbiAoYmFzZVVybCkge1xuICByZXR1cm4gZnVuY3Rpb24gKGNsaWVudCwgcHJvY2Vzc29yLCBtZXNzYWdlKSB7XG4gICAgbWVzc2FnZS5iYXNlVXJsID0gYmFzZVVybDtcbiAgfTtcbn0pO1xuXG5SZXF1ZXN0QnVpbGRlci5hZGRIZWxwZXIoJ3dpdGhQYXJhbXMnLCBmdW5jdGlvbiAocGFyYW1zKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoY2xpZW50LCBwcm9jZXNzb3IsIG1lc3NhZ2UpIHtcbiAgICBtZXNzYWdlLnBhcmFtcyA9IHBhcmFtcztcbiAgfTtcbn0pO1xuXG5SZXF1ZXN0QnVpbGRlci5hZGRIZWxwZXIoJ3dpdGhIZWFkZXInLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24gKGNsaWVudCwgcHJvY2Vzc29yLCBtZXNzYWdlKSB7XG4gICAgbWVzc2FnZS5oZWFkZXJzLmFkZChrZXksIHZhbHVlKTtcbiAgfTtcbn0pO1xuXG5SZXF1ZXN0QnVpbGRlci5hZGRIZWxwZXIoJ3dpdGhDcmVkZW50aWFscycsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24gKGNsaWVudCwgcHJvY2Vzc29yLCBtZXNzYWdlKSB7XG4gICAgbWVzc2FnZS53aXRoQ3JlZGVudGlhbHMgPSB2YWx1ZTtcbiAgfTtcbn0pO1xuXG5SZXF1ZXN0QnVpbGRlci5hZGRIZWxwZXIoJ3dpdGhJbnRlcmNlcHRvcicsIGZ1bmN0aW9uIChpbnRlcmNlcHRvcikge1xuICByZXR1cm4gZnVuY3Rpb24gKGNsaWVudCwgcHJvY2Vzc29yLCBtZXNzYWdlKSB7XG4gICAgbWVzc2FnZS5pbnRlcmNlcHRvcnMgPSBtZXNzYWdlLmludGVyY2VwdG9ycyB8fCBbXTtcbiAgICBtZXNzYWdlLmludGVyY2VwdG9ycy51bnNoaWZ0KGludGVyY2VwdG9yKTtcbiAgfTtcbn0pO1xuXG5mdW5jdGlvbiB0cmFja1JlcXVlc3RTdGFydChjbGllbnQsIHByb2Nlc3Nvcikge1xuICBjbGllbnQucGVuZGluZ1JlcXVlc3RzLnB1c2gocHJvY2Vzc29yKTtcbiAgY2xpZW50LmlzUmVxdWVzdGluZyA9IHRydWU7XG59XG5cbmZ1bmN0aW9uIHRyYWNrUmVxdWVzdEVuZChjbGllbnQsIHByb2Nlc3Nvcikge1xuICB2YXIgaW5kZXggPSBjbGllbnQucGVuZGluZ1JlcXVlc3RzLmluZGV4T2YocHJvY2Vzc29yKTtcblxuICBjbGllbnQucGVuZGluZ1JlcXVlc3RzLnNwbGljZShpbmRleCwgMSk7XG4gIGNsaWVudC5pc1JlcXVlc3RpbmcgPSBjbGllbnQucGVuZGluZ1JlcXVlc3RzLmxlbmd0aCA+IDA7XG5cbiAgaWYgKCFjbGllbnQuaXNSZXF1ZXN0aW5nKSB7XG4gICAgKGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBldnQgPSBfYXVyZWxpYVBhbC5ET00uY3JlYXRlQ3VzdG9tRXZlbnQoJ2F1cmVsaWEtc2FpbHMtc29ja2V0LWNsaWVudC1yZXF1ZXN0cy1kcmFpbmVkJywgeyBidWJibGVzOiB0cnVlLCBjYW5jZWxhYmxlOiB0cnVlIH0pO1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfYXVyZWxpYVBhbC5ET00uZGlzcGF0Y2hFdmVudChldnQpO1xuICAgICAgfSwgMSk7XG4gICAgfSkoKTtcbiAgfVxufVxuXG52YXIgU2FpbHNTb2NrZXRDbGllbnQgPSBleHBvcnRzLlNhaWxzU29ja2V0Q2xpZW50ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBTYWlsc1NvY2tldENsaWVudChzb2NrZXQpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2FpbHNTb2NrZXRDbGllbnQpO1xuXG4gICAgdGhpcy5zb2NrZXQgPSBzb2NrZXQ7XG5cbiAgICB0aGlzLnJlcXVlc3RUcmFuc2Zvcm1lcnMgPSBbXTtcblxuICAgIHRoaXMuaW50ZXJjZXB0b3JzID0gW107XG5cbiAgICB0aGlzLnBlbmRpbmdSZXF1ZXN0cyA9IFtdO1xuICAgIHRoaXMuaXNSZXF1ZXN0aW5nID0gZmFsc2U7XG4gIH1cblxuICBTYWlsc1NvY2tldENsaWVudC5wcm90b3R5cGUuc2V0U29ja2V0ID0gZnVuY3Rpb24gc2V0U29ja2V0KHNvY2tldCkge1xuICAgIHRoaXMuc29ja2V0ID0gc29ja2V0O1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIFNhaWxzU29ja2V0Q2xpZW50LnByb3RvdHlwZS5hZGRJbnRlcmNlcHRvciA9IGZ1bmN0aW9uIGFkZEludGVyY2VwdG9yKGludGVyY2VwdG9yKSB7XG4gICAgdGhpcy5pbnRlcmNlcHRvcnMudW5zaGlmdChpbnRlcmNlcHRvcik7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgU2FpbHNTb2NrZXRDbGllbnQucHJvdG90eXBlLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uIGNvbmZpZ3VyZShmbikge1xuICAgIHZhciBidWlsZGVyID0gbmV3IFJlcXVlc3RCdWlsZGVyKHRoaXMpO1xuICAgIGZuKGJ1aWxkZXIpO1xuICAgIHRoaXMucmVxdWVzdFRyYW5zZm9ybWVycyA9IGJ1aWxkZXIudHJhbnNmb3JtZXJzO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIFNhaWxzU29ja2V0Q2xpZW50LnByb3RvdHlwZS5jcmVhdGVSZXF1ZXN0ID0gZnVuY3Rpb24gY3JlYXRlUmVxdWVzdCh1cmwpIHtcbiAgICB2YXIgYnVpbGRlciA9IG5ldyBSZXF1ZXN0QnVpbGRlcih0aGlzKTtcblxuICAgIGlmICh1cmwpIHtcbiAgICAgIGJ1aWxkZXIud2l0aFVybCh1cmwpO1xuICAgIH1cblxuICAgIHJldHVybiBidWlsZGVyO1xuICB9O1xuXG4gIFNhaWxzU29ja2V0Q2xpZW50LnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gc2VuZChyZXF1ZXN0TWVzc2FnZSwgdHJhbnNmb3JtZXJzKSB7XG4gICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICB2YXIgcHJvY2Vzc29yID0gdm9pZCAwO1xuICAgIHZhciBwcm9taXNlID0gdm9pZCAwO1xuICAgIHZhciBpID0gdm9pZCAwO1xuICAgIHZhciBpaSA9IHZvaWQgMDtcbiAgICB2YXIgdHJhbnNmb3JtUHJvbWlzZXMgPSBbXTtcblxuICAgIHByb2Nlc3NvciA9IGNyZWF0ZVNvY2tldFJlcXVlc3RNZXNzYWdlUHJvY2Vzc29yKCk7XG4gICAgdHJhY2tSZXF1ZXN0U3RhcnQodGhpcywgcHJvY2Vzc29yKTtcblxuICAgIHRyYW5zZm9ybWVycyA9IHRyYW5zZm9ybWVycyB8fCB0aGlzLnJlcXVlc3RUcmFuc2Zvcm1lcnM7XG5cbiAgICBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKHJlcXVlc3RNZXNzYWdlKS50aGVuKGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICBmb3IgKGkgPSAwLCBpaSA9IHRyYW5zZm9ybWVycy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgIHRyYW5zZm9ybVByb21pc2VzLnB1c2godHJhbnNmb3JtZXJzW2ldKF90aGlzMywgcHJvY2Vzc29yLCBtZXNzYWdlKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBwcm9jZXNzb3IucHJvY2VzcyhfdGhpczMsIG1lc3NhZ2UpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIHRyYWNrUmVxdWVzdEVuZChfdGhpczMsIHByb2Nlc3Nvcik7XG4gICAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICB0cmFja1JlcXVlc3RFbmQoX3RoaXMzLCBwcm9jZXNzb3IpO1xuICAgICAgICB0aHJvdyByZXNwb25zZTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgcHJvbWlzZS5hYm9ydCA9IHByb21pc2UuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgcHJvY2Vzc29yLmFib3J0KCk7XG4gICAgfTtcblxuICAgIHJldHVybiBwcm9taXNlO1xuICB9O1xuXG4gIFNhaWxzU29ja2V0Q2xpZW50LnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiBfZGVsZXRlKHVybCwgY29udGVudCkge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZVJlcXVlc3QodXJsKS5hc0RlbGV0ZSgpLndpdGhDb250ZW50KGNvbnRlbnQpLnNlbmQoKTtcbiAgfTtcblxuICBTYWlsc1NvY2tldENsaWVudC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gZ2V0KHVybCwgY29udGVudCkge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZVJlcXVlc3QodXJsKS5hc0dldCgpLndpdGhDb250ZW50KGNvbnRlbnQpLnNlbmQoKTtcbiAgfTtcblxuICBTYWlsc1NvY2tldENsaWVudC5wcm90b3R5cGUuaGVhZCA9IGZ1bmN0aW9uIGhlYWQodXJsLCBjb250ZW50KSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlUmVxdWVzdCh1cmwpLmFzSGVhZCgpLndpdGhDb250ZW50KGNvbnRlbnQpLnNlbmQoKTtcbiAgfTtcblxuICBTYWlsc1NvY2tldENsaWVudC5wcm90b3R5cGUub3B0aW9ucyA9IGZ1bmN0aW9uIG9wdGlvbnModXJsLCBjb250ZW50KSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlUmVxdWVzdCh1cmwpLmFzT3B0aW9ucygpLndpdGhDb250ZW50KGNvbnRlbnQpLnNlbmQoKTtcbiAgfTtcblxuICBTYWlsc1NvY2tldENsaWVudC5wcm90b3R5cGUucHV0ID0gZnVuY3Rpb24gcHV0KHVybCwgY29udGVudCkge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZVJlcXVlc3QodXJsKS5hc1B1dCgpLndpdGhDb250ZW50KGNvbnRlbnQpLnNlbmQoKTtcbiAgfTtcblxuICBTYWlsc1NvY2tldENsaWVudC5wcm90b3R5cGUucGF0Y2ggPSBmdW5jdGlvbiBwYXRjaCh1cmwsIGNvbnRlbnQpIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVSZXF1ZXN0KHVybCkuYXNQYXRjaCgpLndpdGhDb250ZW50KGNvbnRlbnQpLnNlbmQoKTtcbiAgfTtcblxuICBTYWlsc1NvY2tldENsaWVudC5wcm90b3R5cGUucG9zdCA9IGZ1bmN0aW9uIHBvc3QodXJsLCBjb250ZW50KSB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlUmVxdWVzdCh1cmwpLmFzUG9zdCgpLndpdGhDb250ZW50KGNvbnRlbnQpLnNlbmQoKTtcbiAgfTtcblxuICBTYWlsc1NvY2tldENsaWVudC5wcm90b3R5cGUub24gPSBmdW5jdGlvbiBvbihldmVudE5hbWUsIGZuKSB7XG4gICAgdGhpcy5zb2NrZXQub24oZXZlbnROYW1lLCBmbik7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgU2FpbHNTb2NrZXRDbGllbnQucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uIG9mZihldmVudE5hbWUsIGZuKSB7XG4gICAgdGhpcy5zb2NrZXQub2ZmKGV2ZW50TmFtZSwgZm4pO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIHJldHVybiBTYWlsc1NvY2tldENsaWVudDtcbn0oKTtcblxudmFyIGlvID0gX2F1cmVsaWFQYWwuUExBVEZPUk0uZ2xvYmFsLmlvO1xuXG5pZiAoaW8pIHtcbiAgaW8uc2FpbHMuYXV0b0Nvbm5lY3QgPSBmYWxzZTtcbn1cblxuZnVuY3Rpb24gY29uZmlndXJlKGNvbmZpZywgY29uZmlnQ2FsbGJhY2spIHtcbiAgdmFyIHNhaWxzID0gbmV3IFNhaWxzU29ja2V0Q2xpZW50KCk7XG5cbiAgaWYgKGNvbmZpZ0NhbGxiYWNrICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIGNvbmZpZ0NhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgY29uZmlnQ2FsbGJhY2soc2FpbHMsIGlvKTtcbiAgfVxuXG4gIHNhaWxzLnNldFNvY2tldChpby5zYWlscy5jb25uZWN0KCkpO1xuXG4gIGNvbmZpZy5pbnN0YW5jZShTYWlsc1NvY2tldENsaWVudCwgc2FpbHMpO1xufVxuXG5leHBvcnRzLmNvbmZpZ3VyZSA9IGNvbmZpZ3VyZTtcbmV4cG9ydHMuU2FpbHNTb2NrZXRDbGllbnQgPSBTYWlsc1NvY2tldENsaWVudDtcbmV4cG9ydHMuQ1NSRkludGVyY2VwdG9yID0gQ1NSRkludGVyY2VwdG9yO1xuZXhwb3J0cy5Mb2dnZXJJbnRlcmNlcHRvciA9IExvZ2dlckludGVyY2VwdG9yO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtc2FpbHMtc29ja2V0LWNsaWVudC9kaXN0L2NvbW1vbmpzL2F1cmVsaWEtc2FpbHMtc29ja2V0LWNsaWVudC5qc1xuICoqIG1vZHVsZSBpZCA9IDI2XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1xuIC8vICDilojilojilojilojilojilojilojilZcg4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKVl+KWiOKWiOKVlyAgICAg4paI4paI4paI4paI4paI4paI4paI4pWXICAg4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKWiOKVlyAgICAgICAgIOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlyAgICAgICAgIC8vXG4gLy8gIOKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVkeKWiOKWiOKVkSAgICAg4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWdICAg4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4pWQ4paI4paI4pWXICAgICAgICDilojilojilZHilojilojilZTilZDilZDilZDilZDilZ0gICAgICAgICAvL1xuIC8vICDilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZHilojilojilZHilojilojilZEgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlyAgIOKWiOKWiOKVkeKWiOKWiOKVkSAgIOKWiOKWiOKVkSAgICAgICAg4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWXICAgICAgICAgLy9cbiAvLyAg4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4paI4paI4pWR4paI4paI4pWR4paI4paI4pWRICAgICDilZrilZDilZDilZDilZDilojilojilZEgICDilojilojilZHilojilojilZEgICDilojilojilZEgICDilojiloggICDilojilojilZHilZrilZDilZDilZDilZDilojilojilZEgICAgICAgICAvL1xuIC8vICDilojilojilojilojilojilojilojilZHilojilojilZEgIOKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkeKWiOKWiOKVl+KWiOKWiOKVkeKVmuKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVl+KVmuKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkSAgICAgICAgIC8vXG4gLy8gIOKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVnSAg4pWa4pWQ4pWd4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWd4pWa4pWQ4pWdIOKVmuKVkOKVkOKVkOKVkOKVkOKVnSDilZrilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVnSAgICAgICAgIC8vXG4gLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gLy8gICDilabilZTilZDilZfilaYgIOKVpuKVlOKVkOKVl+KVlOKVkOKVl+KVlOKVkOKVl+KVpuKVkOKVl+KVpuKVlOKVkOKVl+KVlOKVpuKVlyAg4pWU4pWQ4pWX4pWmICDilabilZTilZDilZfilZTilZfilZTilZTilabilZcgIOKVlOKVkOKVl+KVlOKVpuKVl+KVpuKVlOKVkCAgICAgICAgICAgICAgICAgICAgIC8vXG4gLy8gICDilZHilaDilZDilaPilZrilZfilZTilZ3ilaDilZDilaPilZrilZDilZfilZEgIOKVoOKVpuKVneKVkeKVoOKVkOKVnSDilZEgICDilZEgIOKVkSAg4pWR4pWR4pWjIOKVkeKVkeKVkSDilZEgICDilZrilZDilZcg4pWR4pWR4pWg4pWp4pWXICAgICAgICAgICAgICAgICAgICAgLy9cbiAvLyAg4pWa4pWd4pWpIOKVqSDilZrilZ0g4pWpIOKVqeKVmuKVkOKVneKVmuKVkOKVneKVqeKVmuKVkOKVqeKVqSAgIOKVqSAgIOKVmuKVkOKVneKVqeKVkOKVneKVqeKVmuKVkOKVneKVneKVmuKVnSDilakgICDilZrilZDilZ3ilZDilanilZ3ilakg4pWpICAgICAgICAgICAgICAgICAgICAgLy9cbiAvLyAg4pSM4pSA4pSQ4pSM4pSA4pSQ4pSs4pSA4pSQICDilIzilJDilIzilIzilIDilJDilIzilKzilJDilIzilIDilJAgIOKUrOKUjOKUgOKUkCAg4pSM4pSA4pSQ4pSM4pSQ4pSM4pSM4pSs4pSQICDilIzilKzilJDilKwg4pSs4pSM4pSA4pSQICDilIzilJAg4pSs4pSA4pSQ4pSM4pSA4pSQ4pSsIOKUrOKUjOKUgOKUkOKUjOKUgOKUkOKUrOKUgOKUkCAgICAvL1xuIC8vICDilJzilKQg4pSCIOKUguKUnOKUrOKUmCAg4pSC4pSC4pSC4pSCIOKUgiDilILilILilJzilKQgICDilILilJTilIDilJAgIOKUnOKUgOKUpOKUguKUguKUgiDilILilIIgICDilIIg4pSc4pSA4pSk4pSc4pSkICAg4pSc4pS04pSQ4pSc4pSs4pSY4pSCIOKUguKUguKUguKUguKUlOKUgOKUkOKUnOKUpCDilJzilKzilJggICAgLy9cbiAvLyAg4pSUICDilJTilIDilJjilLTilJTilIAgIOKUmOKUlOKUmOKUlOKUgOKUmOKUgOKUtOKUmOKUlOKUgOKUmG/ilJTilJjilJTilIDilJggIOKUtCDilLTilJjilJTilJjilIDilLTilJggICDilLQg4pS0IOKUtOKUlOKUgOKUmCAg4pSU4pSA4pSY4pS04pSU4pSA4pSU4pSA4pSY4pSU4pS04pSY4pSU4pSA4pSY4pSU4pSA4pSY4pS04pSU4pSAICAgIC8vXG4gLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4vKipcbiAqIHNhaWxzLmlvLmpzXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIEphdmFTY3JpcHQgQ2xpZW50IChTREspIGZvciBjb21tdW5pY2F0aW5nIHdpdGggU2FpbHMuXG4gKlxuICogTm90ZSB0aGF0IHRoaXMgc2NyaXB0IGlzIGNvbXBsZXRlbHkgb3B0aW9uYWwsIGJ1dCBpdCBpcyBoYW5keSBpZiB5b3UncmVcbiAqIHVzaW5nIFdlYlNvY2tldHMgZnJvbSB0aGUgYnJvd3NlciB0byB0YWxrIHRvIHlvdXIgU2FpbHMgc2VydmVyLlxuICpcbiAqIEZvciB0aXBzIGFuZCBkb2N1bWVudGF0aW9uLCB2aXNpdDpcbiAqIGh0dHA6Ly9zYWlsc2pzLm9yZy8jIWRvY3VtZW50YXRpb24vcmVmZXJlbmNlL0Jyb3dzZXJTREsvQnJvd3NlclNESy5odG1sXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqXG4gKiBUaGlzIGZpbGUgYWxsb3dzIHlvdSB0byBzZW5kIGFuZCByZWNlaXZlIHNvY2tldC5pbyBtZXNzYWdlcyB0byAmIGZyb20gU2FpbHNcbiAqIGJ5IHNpbXVsYXRpbmcgYSBSRVNUIGNsaWVudCBpbnRlcmZhY2Ugb24gdG9wIG9mIHNvY2tldC5pby4gSXQgbW9kZWxzIGl0cyBBUElcbiAqIGFmdGVyIHRoZSAkLmFqYXggcGF0dGVybiBmcm9tIGpRdWVyeSB5b3UgbWlnaHQgYWxyZWFkeSBiZSBmYW1pbGlhciB3aXRoLlxuICpcbiAqIFNvIGlmIHlvdSdyZSBzd2l0Y2hpbmcgZnJvbSB1c2luZyBBSkFYIHRvIHNvY2tldHMsIGluc3RlYWQgb2Y6XG4gKiAgICBgJC5wb3N0KCB1cmwsIFtkYXRhXSwgW2NiXSApYFxuICpcbiAqIFlvdSB3b3VsZCB1c2U6XG4gKiAgICBgc29ja2V0LnBvc3QoIHVybCwgW2RhdGFdLCBbY2JdIClgXG4gKi9cblxuXG4oZnVuY3Rpb24oKSB7XG5cblxuICAvLyAgIOKWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilojilZcg4paI4paI4paI4pWXICAg4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilZcgICDilojilojilZfilojilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZdcbiAgLy8gIOKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKVlyAg4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWQ4paI4paI4pWU4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4paI4paI4pWXICDilojilojilZHilZrilZDilZDilojilojilZTilZDilZDilZ3ilojilojilZTilZDilZDilZDilZDilZ1cbiAgLy8gIOKWiOKWiOKVkSAgICAg4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWU4paI4paI4pWXIOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlyAgIOKWiOKWiOKVkSAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkeKWiOKWiOKVlOKWiOKWiOKVlyDilojilojilZEgICDilojilojilZEgICDilojilojilojilojilojilojilojilZdcbiAgLy8gIOKWiOKWiOKVkSAgICAg4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWR4pWa4paI4paI4pWX4paI4paI4pWR4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4pWU4pWQ4pWQ4paI4paI4pWR4paI4paI4pWR4pWa4paI4paI4pWX4paI4paI4pWRICAg4paI4paI4pWRICAg4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWRXG4gIC8vICDilZrilojilojilojilojilojilojilZfilZrilojilojilojilojilojilojilZTilZ3ilojilojilZEg4pWa4paI4paI4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4pWRICDilojilojilZHilojilojilZEg4pWa4paI4paI4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4paI4paI4paI4paI4paI4pWRXG4gIC8vICAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVkOKVkOKVkOKVkOKVnSDilZrilZDilZ0gIOKVmuKVkOKVkOKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVnSAgIOKVmuKVkOKVnSAgIOKVmuKVkOKVnSAg4pWa4pWQ4pWd4pWa4pWQ4pWdICDilZrilZDilZDilZDilZ0gICDilZrilZDilZ0gICDilZrilZDilZDilZDilZDilZDilZDilZ1cbiAgLy9cblxuXG4gIC8qKlxuICAgKiBDb25zdGFudCBjb250YWluaW5nIHRoZSBuYW1lcyBvZiBhbGwgYXZhaWxhYmxlIG9wdGlvbnNcbiAgICogZm9yIGluZGl2aWR1YWwgc29ja2V0cy5cbiAgICpcbiAgICogQHR5cGUge0FycmF5fVxuICAgKi9cbiAgdmFyIFNPQ0tFVF9PUFRJT05TID0gW1xuICAgICd1c2VDT1JTUm91dGVUb0dldENvb2tpZScsXG4gICAgJ3VybCcsXG4gICAgJ211bHRpcGxleCcsXG4gICAgJ3RyYW5zcG9ydHMnLFxuICAgICdxdWVyeScsXG4gICAgJ3BhdGgnLFxuICAgICdoZWFkZXJzJyxcbiAgICAnaW5pdGlhbENvbm5lY3Rpb25IZWFkZXJzJyxcbiAgICAncmVjb25uZWN0aW9uJyxcbiAgICAncmVjb25uZWN0aW9uQXR0ZW1wdHMnLFxuICAgICdyZWNvbm5lY3Rpb25EZWxheScsXG4gICAgJ3JlY29ubmVjdGlvbkRlbGF5TWF4JyxcbiAgICAncmVqZWN0VW5hdXRob3JpemVkJyxcbiAgICAncmFuZG9taXphdGlvbkZhY3RvcicsXG4gICAgJ3RpbWVvdXQnXG4gIF07XG5cblxuICAvKipcbiAgICogQ29uc3RhbnQgY29udGFpbmluZyB0aGUgbmFtZXMgb2YgcHJvcGVydGllcyBvbiBgaW8uc2FpbHNgIHdoaWNoXG4gICAqIG1heSBiZSBjb25maWd1cmVkIHVzaW5nIEhUTUwgYXR0cmlidXRlcyBvbiB0aGUgc2NyaXB0IHRhZyB3aGljaFxuICAgKiBsb2FkZWQgdGhpcyBmaWxlLlxuICAgKlxuICAgKiBAdHlwZSB7QXJyYXl9XG4gICAqXG4gICAqICh0aGlzIGlzIHVudXNlZCBpZiBsb2FkaW5nIGZyb20gbm9kZS5qcylcbiAgICovXG4gIHZhciBDT05GSUdVUkFCTEVfVklBX0hUTUxfQVRUUiA9IFtcbiAgICAnYXV0b0Nvbm5lY3QnLFxuICAgICdlbnZpcm9ubWVudCcsXG4gICAgJ2hlYWRlcnMnLFxuICAgICd1cmwnLFxuICAgICd0cmFuc3BvcnRzJyxcbiAgICAncGF0aCdcbiAgXTtcblxuXG5cblxuICAvKipcbiAgICogQ29uc3RhbnQgY29udGFpbmluZyB0aGUgbmFtZXMgb2YgcXVlcnlzdHJpbmdcbiAgICogcGFyYW1ldGVycyBzZW50IHdoZW4gY29ubmVjdGluZyBhbnkgU2FpbHNTb2NrZXQuXG4gICAqXG4gICAqIEB0eXBlIHtEaWN0aW9uYXJ5fVxuICAgKi9cbiAgdmFyIENPTk5FQ1RJT05fTUVUQURBVEFfUEFSQU1TID0ge1xuICAgIHZlcnNpb246ICdfX3NhaWxzX2lvX3Nka192ZXJzaW9uJyxcbiAgICBwbGF0Zm9ybTogJ19fc2FpbHNfaW9fc2RrX3BsYXRmb3JtJyxcbiAgICBsYW5ndWFnZTogJ19fc2FpbHNfaW9fc2RrX2xhbmd1YWdlJ1xuICB9O1xuXG5cbiAgLyoqXG4gICAqIENvbnN0YW50IGNvbnRhaW5pbmcgbWV0YWRhdGEgYWJvdXQgdGhlIHBsYXRmb3JtLCBsYW5ndWFnZSwgYW5kXG4gICAqIGN1cnJlbnQgdmVyc2lvbiBvZiB0aGlzIFNESy5cbiAgICpcbiAgICogQHR5cGUge0RpY3Rpb25hcnl9XG4gICAqL1xuICB2YXIgU0RLX0lORk8gPSB7XG4gICAgdmVyc2lvbjogJzAuMTMuOCcsIC8vIDwtLSBwdWxsZWQgYXV0b21hdGljYWxseSBmcm9tIHBhY2thZ2UuanNvbiwgZG8gbm90IGNoYW5nZSFcbiAgICBsYW5ndWFnZTogJ2phdmFzY3JpcHQnLFxuICAgIHBsYXRmb3JtOiAoZnVuY3Rpb24gKCl7XG4gICAgICBpZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gJ25vZGUnO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHJldHVybiAnYnJvd3Nlcic7XG4gICAgICB9XG4gICAgfSkoKVxuICB9O1xuXG4gIC8vIEJ1aWxkIGB2ZXJzaW9uU3RyaW5nYCAoYSBxdWVyeXN0cmluZyBzbmlwcGV0KSBieVxuICAvLyBjb21iaW5pbmcgU0RLX0lORk8gYW5kIENPTk5FQ1RJT05fTUVUQURBVEFfUEFSQU1TLlxuICBTREtfSU5GTy52ZXJzaW9uU3RyaW5nID1cbiAgICBDT05ORUNUSU9OX01FVEFEQVRBX1BBUkFNUy52ZXJzaW9uICsgJz0nICsgU0RLX0lORk8udmVyc2lvbiArICcmJyArXG4gICAgQ09OTkVDVElPTl9NRVRBREFUQV9QQVJBTVMucGxhdGZvcm0gKyAnPScgKyBTREtfSU5GTy5wbGF0Zm9ybSArICcmJyArXG4gICAgQ09OTkVDVElPTl9NRVRBREFUQV9QQVJBTVMubGFuZ3VhZ2UgKyAnPScgKyBTREtfSU5GTy5sYW5ndWFnZTtcblxuXG5cblxuICAvLyAgIOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilojilZcg4paI4paI4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilojilZcg4paI4paI4paI4paI4paI4paI4pWXICAgICDilojilojilZcgIOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKVlyAgIOKWiOKWiOKWiOKVl+KWiOKWiOKVl1xuICAvLyAg4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWXICAgIOKWiOKWiOKVkSAg4paI4paI4pWR4pWa4pWQ4pWQ4paI4paI4pWU4pWQ4pWQ4pWd4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKWiOKVkeKWiOKWiOKVkVxuICAvLyAg4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4pWU4pWdICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkSAgIOKWiOKWiOKVkSAgIOKWiOKWiOKVlOKWiOKWiOKWiOKWiOKVlOKWiOKWiOKVkeKWiOKWiOKVkVxuICAvLyAg4paI4paI4pWU4pWQ4pWQ4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWR4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWXICAgIOKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVkSAgIOKWiOKWiOKVkSAgIOKWiOKWiOKVkeKVmuKWiOKWiOKVlOKVneKWiOKWiOKVkeKWiOKWiOKVkVxuICAvLyAg4paI4paI4pWRICDilojilojilZHilojilojilojilojilojilojilZTilZ3ilojilojilojilojilojilojilojilZHilZrilojilojilojilojilojilojilZTilZ3ilojilojilZEgIOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVnSAgICDilojilojilZEgIOKWiOKWiOKVkSAgIOKWiOKWiOKVkSAgIOKWiOKWiOKVkSDilZrilZDilZ0g4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWXXG4gIC8vICDilZrilZDilZ0gIOKVmuKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVnSDilZrilZDilZDilZDilZDilZDilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVnSAg4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdICAgICDilZrilZDilZ0gIOKVmuKVkOKVnSAgIOKVmuKVkOKVnSAgIOKVmuKVkOKVnSAgICAg4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdXG4gIC8vXG4gIC8vICAg4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilZfilojilojilojilojilojilojilZcg4paI4paI4pWXICAg4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWXXG4gIC8vICDilojilojilZTilZDilZDilojilojilZfilZrilZDilZDilojilojilZTilZDilZDilZ3ilZrilZDilZDilojilojilZTilZDilZDilZ3ilojilojilZTilZDilZDilojilojilZfilojilojilZHilojilojilZTilZDilZDilojilojilZfilojilojilZEgICDilojilojilZHilZrilZDilZDilojilojilZTilZDilZDilZ3ilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZTilZDilZDilZDilZDilZ1cbiAgLy8gIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkSAgIOKWiOKWiOKVkSAgICAgIOKWiOKWiOKVkSAgIOKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkSAgIOKWiOKWiOKVkSAgIOKWiOKWiOKVkSAgIOKWiOKWiOKWiOKWiOKWiOKVlyAg4paI4paI4paI4paI4paI4paI4paI4pWXXG4gIC8vICDilojilojilZTilZDilZDilojilojilZEgICDilojilojilZEgICAgICDilojilojilZEgICDilojilojilZTilZDilZDilojilojilZfilojilojilZHilojilojilZTilZDilZDilojilojilZfilojilojilZEgICDilojilojilZEgICDilojilojilZEgICDilojilojilZTilZDilZDilZ0gIOKVmuKVkOKVkOKVkOKVkOKWiOKWiOKVkVxuICAvLyAg4paI4paI4pWRICDilojilojilZEgICDilojilojilZEgICAgICDilojilojilZEgICDilojilojilZEgIOKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKVmuKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVnSAgIOKWiOKWiOKVkSAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkVxuICAvLyAg4pWa4pWQ4pWdICDilZrilZDilZ0gICDilZrilZDilZ0gICAgICDilZrilZDilZ0gICDilZrilZDilZ0gIOKVmuKVkOKVneKVmuKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVnSAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdICAgIOKVmuKVkOKVnSAgIOKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVnVxuICAvL1xuICAvLyAg4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4pWXICDilojilojilojilojilojilojilZcg4paI4paI4paI4pWXICAg4paI4paI4paI4pWXICAgICAg4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilZfilojilojilojilojilojilojilZcg4paI4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWXXG4gIC8vICDilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilZDilojilojilZfilojilojilojilojilZcg4paI4paI4paI4paI4pWRICAgICDilojilojilZTilZ3ilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZTilZDilZDilojilojilZfilojilojilZHilojilojilZTilZDilZDilojilojilZfilZrilZDilZDilojilojilZTilZDilZDilZ3ilZrilojilojilZdcbiAgLy8gIOKWiOKWiOKWiOKWiOKWiOKVlyAg4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWU4paI4paI4paI4paI4pWU4paI4paI4pWRICAgIOKWiOKWiOKVlOKVnSDilojilojilojilojilojilojilojilZfilojilojilZEgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVnSAgIOKWiOKWiOKVkSAgICDilZrilojilojilZdcbiAgLy8gIOKWiOKWiOKVlOKVkOKVkOKVnSAg4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWR4pWa4paI4paI4pWU4pWd4paI4paI4pWRICAgIOKVmuKWiOKWiOKVlyDilZrilZDilZDilZDilZDilojilojilZHilojilojilZEgICAgIOKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKVnSAgICDilojilojilZEgICAg4paI4paI4pWU4pWdXG4gIC8vICDilojilojilZEgICAgIOKWiOKWiOKVkSAg4paI4paI4pWR4pWa4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4pWRIOKVmuKVkOKVnSDilojilojilZEgICAgIOKVmuKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkeKVmuKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVkSAg4paI4paI4pWR4paI4paI4pWR4paI4paI4pWRICAgICAgICDilojilojilZEgICDilojilojilZTilZ1cbiAgLy8gIOKVmuKVkOKVnSAgICAg4pWa4pWQ4pWdICDilZrilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVnSAgICAg4pWa4pWQ4pWdICAgICAg4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVnSAg4pWa4pWQ4pWd4pWa4pWQ4pWd4pWa4pWQ4pWdICAgICAgICDilZrilZDilZ0gICDilZrilZDilZ1cbiAgLy9cbiAgLy9cbiAgLy8gSWYgYXZhaWxhYmxlLCBncmFiIHRoZSBET00gZWxlbWVudCBmb3IgdGhlIHNjcmlwdCB0YWcgd2hpY2ggaW1wb3J0ZWQgdGhpcyBmaWxlLlxuICAvLyAoc2tpcCB0aGlzIGlmIHRoaXMgU0RLIGlzIGJlaW5nIHVzZWQgb3V0c2lkZSBvZiB0aGUgRE9NLCBpLmUuIGluIGEgTm9kZSBwcm9jZXNzKVxuICAvL1xuICAvLyBUaGlzIGlzIHVzZWQgYmVsb3cgdG8gcGFyc2UgY2xpZW50LXNpZGUgc2FpbHMuaW8uanMgY29uZmlndXJhdGlvbiBlbmNvZGVkIGFzXG4gIC8vIEhUTUwgYXR0cmlidXRlcywgYXMgd2VsbCBhcyBncmFiYmluZyBob2xkIG9mIHRoZSBVUkwgZnJvbSB3aGVuY2UgdGhlIFNESyB3YXMgZmV0Y2hlZC5cbiAgdmFyIHRoaXNTY3JpcHRUYWcgPSAoZnVuY3Rpb24oKSB7XG4gICAgaWYgKFxuICAgICAgdHlwZW9mIHdpbmRvdyAhPT0gJ29iamVjdCcgfHxcbiAgICAgIHR5cGVvZiB3aW5kb3cuZG9jdW1lbnQgIT09ICdvYmplY3QnIHx8XG4gICAgICB0eXBlb2Ygd2luZG93LmRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lICE9PSAnZnVuY3Rpb24nXG4gICAgKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gdGhlIFVSTCBvZiB0aGUgbGFzdCBzY3JpcHQgbG9hZGVkIChpLmUuIHRoaXMgb25lKVxuICAgIC8vICh0aGlzIG11c3QgcnVuIGJlZm9yZSBuZXh0VGljazsgc2VlIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzI5NzY3MTQvNDg2NTQ3KVxuICAgIHZhciBhbGxTY3JpcHRzQ3VycmVudGx5SW5ET00gPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpO1xuICAgIHJldHVybiBhbGxTY3JpcHRzQ3VycmVudGx5SW5ET01bYWxsU2NyaXB0c0N1cnJlbnRseUluRE9NLmxlbmd0aCAtIDFdO1xuICB9KSgpO1xuXG5cbiAgLy8gVmFyaWFibGVzIHRvIGNvbnRhaW4gc3JjIFVSTCBhbmQgb3RoZXIgc2NyaXB0IHRhZyBjb25maWcgKGZvciB1c2UgYmVsb3cpLlxuICB2YXIgdXJsVGhpc1NjcmlwdFdhc0ZldGNoZWRGcm9tID0gJyc7XG4gIHZhciBzY3JpcHRUYWdDb25maWcgPSB7fTtcblxuXG4gIGlmICh0aGlzU2NyaXB0VGFnKSB7XG4gICAgLy8gU2F2ZSB0aGUgVVJMIHRoYXQgdGhpcyBzY3JpcHQgd2FzIGZldGNoZWQgZnJvbS5cbiAgICB1cmxUaGlzU2NyaXB0V2FzRmV0Y2hlZEZyb20gPSB0aGlzU2NyaXB0VGFnLnNyYztcblxuICAgIC8vIE5vdyBwYXJzZSB0aGUgbW9zdCBjb21tb24gY2xpZW50LXNpZGUgY29uZmlndXJhdGlvbiBzZXR0aW5nc1xuICAgIC8vIGZyb20gdGhlIHNjcmlwdCB0YWcgd2hlcmUgdGhleSBtYXkgYmUgZW5jb2RlZCBhcyBIVE1MIGF0dHJpYnV0ZXMuXG4gICAgLy9cbiAgICAvLyBBbnkgY29uZmlndXJhdGlvbiB3aGljaCBtYXkgYmUgcHJvdmlkZWQgYXMgYW4gSFRNTCBhdHRyaWJ1dGUgbWF5XG4gICAgLy8gYWxzbyBiZSBwcm92aWRlZCBwcmVmaXhlZCB3aXRoIGBkYXRhLWAuICBUaGlzIGlzIGZvciBmb2xrcyB3aG9cbiAgICAvLyBuZWVkIHRvIHN1cHBvcnQgYnJvd3NlcnMgdGhhdCBoYXZlIGlzc3VlcyB3aXRoIG5vbnN0YW5kYXJkXG4gICAgLy8gSFRNTCBhdHRyaWJ1dGVzIChvciBpZiB0aGUgaWRlYSBvZiB1c2luZyBub25zdGFuZGFyZCBIVE1MIGF0dHJpYnV0ZXNcbiAgICAvLyBqdXN0IGNyZWVwcyB5b3Ugb3V0KVxuICAgIC8vXG4gICAgLy8gSWYgYSBgZGF0YS1gIHByZWZpeGVkIGF0dHIgaXMgcHJvdmlkZWQsIGl0IHRha2VzIHByZWNlZGVuY2UuXG4gICAgLy8gKHRoaXMgaXMgc28gdGhhdCBpZiB5b3UgYXJlIGFscmVhZHkgdXNpbmcgb25lIG9mIHRoZXNlIEhUTUxcbiAgICAvLyAgYXR0cnMgZm9yIHNvbWUgcmVhc29uLCB5b3UgY2FuIGtlZXAgaXQgYXMtaXMgYW5kIG92ZXJyaWRlXG4gICAgLy8gIGl0IHVzaW5nIGBkYXRhLWAuIElmIHlvdSBhcmUgdXNpbmcgdGhlIGBkYXRhLWAgcHJlZml4ZWQgdmVyc2lvblxuICAgIC8vICBmb3Igc29tZSBvdGhlciBwdXJwb3NlLi4uIHdlbGwsIGluIHRoYXQgY2FzZSB5b3UnbGwganVzdCBoYXZlIHRvXG4gICAgLy8gIGNvbmZpZ3VyZSBwcm9ncmFtbWF0aWNhbGx5IHVzaW5nIGBpby5zYWlsc2AgaW5zdGVhZC4pXG4gICAgQ09ORklHVVJBQkxFX1ZJQV9IVE1MX0FUVFIuZm9yRWFjaChmdW5jdGlvbiAoY29uZmlnS2V5KXtcblxuICAgICAgc2NyaXB0VGFnQ29uZmlnW2NvbmZpZ0tleV0gPSAoZnVuY3Rpb24gKCl7XG5cbiAgICAgICAgLy8gU3VwcG9ydCAnZGF0YS0nIHByZWZpeGVkIG9yIG5vcm1hbCBhdHRyaWJ1dGVzLlxuICAgICAgICAvLyAocHJlZml4ZWQgdmVyc2lvbnMgdGFrZSBwcmVjZWRlbmNlIGlmIHByb3ZpZGVkKVxuICAgICAgICB2YXIgaHRtbEF0dHJWYWwgPSB0aGlzU2NyaXB0VGFnLmdldEF0dHJpYnV0ZSggJ2RhdGEtJytjb25maWdLZXkgKTtcbiAgICAgICAgaWYgKCFodG1sQXR0clZhbCkge1xuICAgICAgICAgIGh0bWxBdHRyVmFsID0gdGhpc1NjcmlwdFRhZy5nZXRBdHRyaWJ1dGUoIGNvbmZpZ0tleSApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVGhlIEhUTUwgYXR0cmlidXRlIHZhbHVlIHNob3VsZCBhbHdheXMgYmUgYSBzdHJpbmcgb3IgYG51bGxgLlxuICAgICAgICAvLyBXZSdsbCB0cnkgdG8gcGFyc2UgaXQgYXMgSlNPTiBhbmQgdXNlIHRoYXQsIGJ1dCB3b3JzdCBjYXNlIGZhbGwgYmFja1xuICAgICAgICAvLyB0byB0aGUgZGVmYXVsdCBzaXR1YXRpb24gb2YgaXQgYmVpbmcgYSBzdHJpbmcuXG4gICAgICAgIGlmICh0eXBlb2YgaHRtbEF0dHJWYWwgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgdHJ5IHsgcmV0dXJuIEpTT04ucGFyc2UoaHRtbEF0dHJWYWwpOyB9IGNhdGNoIChlKSB7IHJldHVybiBodG1sQXR0clZhbDsgfVxuICAgICAgICB9XG4gICAgICAgIC8vIElmIGBudWxsYCB3YXMgcmV0dXJuZWQgZnJvbSBnZXRBdHRyaWJ1dGUoKSwgaXQgbWVhbnMgdGhhdCB0aGUgSFRNTCBhdHRyaWJ1dGVcbiAgICAgICAgLy8gd2FzIG5vdCBzcGVjaWZpZWQsIHNvIHdlIHRyZWF0IGl0IGFzIHVuZGVmaW5lZCAod2hpY2ggd2lsbCBjYXVzZSB0aGUgcHJvcGVydHlcbiAgICAgICAgLy8gdG8gYmUgcmVtb3ZlZCBiZWxvdylcbiAgICAgICAgZWxzZSBpZiAoaHRtbEF0dHJWYWwgPT09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIC8vIEFueSBvdGhlciBjb250aW5nZW5jeSBzaG91bGRuJ3QgYmUgcG9zc2libGU6XG4gICAgICAgIC8vIC0gaWYgbm8gcXVvdGVzIGFyZSB1c2VkIGluIHRoZSBIVE1MIGF0dHJpYnV0ZSwgaXQgc3RpbGwgY29tZXMgaW4gYXMgYSBzdHJpbmcuXG4gICAgICAgIC8vIC0gaWYgbm8gUkhTIGlzIHByb3ZpZGVkIGZvciB0aGUgYXR0cmlidXRlLCBpdCBzdGlsbCBjb21lcyBpbiBhcyBcIlwiIChlbXB0eSBzdHJpbmcpXG4gICAgICAgIC8vIChidXQgd2Ugc3RpbGwgaGFuZGxlIHRoaXMgd2l0aCBhbiBleHBsaWNpdCBlcnJvciBqdXN0IGluIGNhc2UtLWZvciBkZWJ1Z2dpbmcgYW5kIHN1cHBvcnQgcHVycG9zZXMpXG4gICAgICAgIGVsc2UgdGhyb3cgbmV3IEVycm9yKCdzYWlscy5pby5qcyA6OiBVbmV4cGVjdGVkL2ludmFsaWQgc2NyaXB0IHRhZyBjb25maWd1cmF0aW9uIGZvciBgJytjb25maWdLZXkrJ2A6IGAnK2h0bWxBdHRyVmFsKydgIChhIGAnK3R5cGVvZiBodG1sQXR0clZhbCsnYCkuIFNob3VsZCBiZSBhIHN0cmluZy4nKTtcbiAgICAgIH0pKCk7XG5cbiAgICAgIGlmIChzY3JpcHRUYWdDb25maWdbY29uZmlnS2V5XSA9PT0gdW5kZWZpbmVkKXtcbiAgICAgICAgZGVsZXRlIHNjcmlwdFRhZ0NvbmZpZ1tjb25maWdLZXldO1xuICAgICAgfVxuICAgIH0pO1xuXG5cblxuICAgIC8vIE5vdyB0aGF0IHRoZXkndmUgYmVlbiBwYXJzZWQsIGRvIGFuIGV4dHJlbWVseSBsZWFuIHZlcnNpb24gb2ZcbiAgICAvLyBsb2dpY2FsIHR5cGUgdmFsaWRhdGlvbi9jb2VyY2lvbiBvZiBwcm92aWRlZCB2YWx1ZXMuXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAvLyBgYXV0b0Nvbm5lY3RgXG4gICAgaWYgKHR5cGVvZiBzY3JpcHRUYWdDb25maWcuYXV0b0Nvbm5lY3QgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBpZiAoc2NyaXB0VGFnQ29uZmlnLmF1dG9Db25uZWN0ID09PSAnJykge1xuICAgICAgICAvLyBTcGVjaWFsIGNhc2UgZm9yIGVtcHR5IHN0cmluZy4gIEl0IG1lYW5zIGB0cnVlYCAoc2VlIGFib3ZlKS5cbiAgICAgICAgc2NyaXB0VGFnQ29uZmlnLmF1dG9Db25uZWN0ID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHR5cGVvZiBzY3JpcHRUYWdDb25maWcuYXV0b0Nvbm5lY3QgIT09ICdib29sZWFuJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3NhaWxzLmlvLmpzIDo6IFVuZXhwZWN0ZWQvaW52YWxpZCBjb25maWd1cmF0aW9uIGZvciBgYXV0b0Nvbm5lY3RgIHByb3ZpZGVkIGluIHNjcmlwdCB0YWc6IGAnK3NjcmlwdFRhZ0NvbmZpZy5hdXRvQ29ubmVjdCsnYCAoYSBgJyt0eXBlb2Ygc2NyaXB0VGFnQ29uZmlnLmF1dG9Db25uZWN0KydgKS4gU2hvdWxkIGJlIGEgYm9vbGVhbi4nKTtcbiAgICAgIH1cbiAgICB9XG5cblxuICAgIC8vIGBlbnZpcm9ubWVudGBcbiAgICBpZiAodHlwZW9mIHNjcmlwdFRhZ0NvbmZpZy5lbnZpcm9ubWVudCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGlmICh0eXBlb2Ygc2NyaXB0VGFnQ29uZmlnLmVudmlyb25tZW50ICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3NhaWxzLmlvLmpzIDo6IFVuZXhwZWN0ZWQvaW52YWxpZCBjb25maWd1cmF0aW9uIGZvciBgZW52aXJvbm1lbnRgIHByb3ZpZGVkIGluIHNjcmlwdCB0YWc6IGAnK3NjcmlwdFRhZ0NvbmZpZy5lbnZpcm9ubWVudCsnYCAoYSBgJyt0eXBlb2Ygc2NyaXB0VGFnQ29uZmlnLmVudmlyb25tZW50KydgKS4gU2hvdWxkIGJlIGEgc3RyaW5nLicpO1xuICAgICAgfVxuICAgIH1cblxuXG4gICAgLy8gYGhlYWRlcnNgXG4gICAgaWYgKHR5cGVvZiBzY3JpcHRUYWdDb25maWcuaGVhZGVycyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGlmICh0eXBlb2Ygc2NyaXB0VGFnQ29uZmlnLmhlYWRlcnMgIT09ICdvYmplY3QnIHx8IEFycmF5LmlzQXJyYXkoc2NyaXB0VGFnQ29uZmlnLmhlYWRlcnMpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignc2FpbHMuaW8uanMgOjogVW5leHBlY3RlZC9pbnZhbGlkIGNvbmZpZ3VyYXRpb24gZm9yIGBoZWFkZXJzYCBwcm92aWRlZCBpbiBzY3JpcHQgdGFnOiBgJytzY3JpcHRUYWdDb25maWcuaGVhZGVycysnYCAoYSBgJyt0eXBlb2Ygc2NyaXB0VGFnQ29uZmlnLmhlYWRlcnMrJ2ApLiBTaG91bGQgYmUgYSBKU09OLWNvbXBhdGlibGUgZGljdGlvbmFyeSAoaS5lLiBge31gKS4gIERvblxcJ3QgZm9yZ2V0IHRob3NlIGRvdWJsZSBxdW90ZXMgKFwiXCIpLCBldmVuIG9uIGtleSBuYW1lcyEgIFVzZSBzaW5nbGUgcXVvdGVzIChcXCdcXCcpIHRvIHdyYXAgdGhlIEhUTUwgYXR0cmlidXRlIHZhbHVlOyBlLmcuIGBoZWFkZXJzPVxcJ3tcIlgtQXV0aFwiOiBcImZvb1wifVxcJ2AnKTtcbiAgICAgIH1cbiAgICB9XG5cblxuICAgIC8vIGB1cmxgXG4gICAgaWYgKHR5cGVvZiBzY3JpcHRUYWdDb25maWcudXJsICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgaWYgKHR5cGVvZiBzY3JpcHRUYWdDb25maWcudXJsICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3NhaWxzLmlvLmpzIDo6IFVuZXhwZWN0ZWQvaW52YWxpZCBjb25maWd1cmF0aW9uIGZvciBgdXJsYCBwcm92aWRlZCBpbiBzY3JpcHQgdGFnOiBgJytzY3JpcHRUYWdDb25maWcudXJsKydgIChhIGAnK3R5cGVvZiBzY3JpcHRUYWdDb25maWcudXJsKydgKS4gU2hvdWxkIGJlIGEgc3RyaW5nLicpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE9USEVSIGBpby5zYWlsc2Agb3B0aW9ucyBhcmUgTk9UIENVUlJFTlRMWSBTVVBQT1JURUQgVklBIEhUTUwgQVRUUklCVVRFUy5cbiAgfVxuXG5cblxuXG4gIC8vIEdyYWIgYSByZWZlcmVuY2UgdG8gdGhlIGdsb2JhbCBzb2NrZXQuaW8gY2xpZW50IChpZiBvbmUgaXMgYXZhaWxhYmxlKS5cbiAgLy8gVGhpcyBpcyB1c2VkIHZpYSBjbG9zdXJlIGJlbG93IHRvIGRldGVybWluZSB3aGljaCBgaW9gIHRvIHVzZSB3aGVuIHRoZVxuICAvLyBzb2NrZXQuaW8gY2xpZW50IGluc3RhbmNlIChgaW9gKSBpcyBhdWdtZW50ZWQgdG8gYmVjb21lIHRoZSBTYWlscyBjbGllbnRcbiAgLy8gU0RLIGluc3RhbmNlIChzdGlsbCBgaW9gKS5cbiAgdmFyIF9leGlzdGluZ0dsb2JhbFNvY2tldElPID0gKHR5cGVvZiBpbyAhPT0gJ3VuZGVmaW5lZCcpID8gaW8gOiB1bmRlZmluZWQ7XG5cblxuXG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgLy8vLy9cbiAgLy8vLy8gTk9XIEZPUiBCVU5DSEVTIE9GOlxuICAvLy8vLyAgLSBQUklWQVRFIEZVTkNUSU9OIERFRklOSVRJT05TXG4gIC8vLy8vICAtIENPTlNUUlVDVE9SU1xuICAvLy8vLyAgLSBBTkQgTUVUSE9EU1xuICAvLy8vL1xuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAvL1xuXG5cblxuICAvLyAg4paI4paI4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilZfilojilojilZcgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlyAgICAgIOKWiOKWiOKVlyDilojilojilojilojilojilojilZcgICAgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVlyAgICAg4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4pWXICAg4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4paI4pWXXG4gIC8vICDilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZTilZDilZDilojilojilZfilojilojilZHilojilojilZEgICAgIOKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVnSAgICAgIOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKWiOKWiOKVlyAgICAgIOKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVkSAgICAg4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4paI4paI4pWXICDilojilojilZHilZrilZDilZDilojilojilZTilZDilZDilZ1cbiAgLy8gIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKVkSAgICAg4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4pWX4paI4paI4pWR4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4paI4paI4paI4pWX4paI4paI4pWRICAgICDilojilojilZEgICAgIOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKVlyAg4paI4paI4pWU4paI4paI4pWXIOKWiOKWiOKVkSAgIOKWiOKWiOKVkVxuICAvLyAg4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4paI4paI4pWR4paI4paI4pWR4paI4paI4pWRICAgICDilZrilZDilZDilZDilZDilojilojilZHilZrilZDilZDilZDilZDilZ3ilojilojilZHilojilojilZEgICDilojilojilZHilZrilZDilZDilZDilZDilZ3ilojilojilZEgICAgIOKWiOKWiOKVkSAgICAg4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4pWdICDilojilojilZHilZrilojilojilZfilojilojilZEgICDilojilojilZFcbiAgLy8gIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkeKWiOKWiOKVkSAg4paI4paI4pWR4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWRICAgICAg4paI4paI4pWR4pWa4paI4paI4paI4paI4paI4paI4pWU4pWdICAgICAg4pWa4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWRIOKVmuKWiOKWiOKWiOKWiOKVkSAgIOKWiOKWiOKVkVxuICAvLyAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWdICDilZrilZDilZ3ilZrilZDilZ3ilZrilZDilZDilZDilZDilZDilZDilZ3ilZrilZDilZDilZDilZDilZDilZDilZ0gICAgICDilZrilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdICAgICAgICDilZrilZDilZDilZDilZDilZDilZ3ilZrilZDilZDilZDilZDilZDilZDilZ3ilZrilZDilZ3ilZrilZDilZDilZDilZDilZDilZDilZ3ilZrilZDilZ0gIOKVmuKVkOKVkOKVkOKVnSAgIOKVmuKVkOKVnVxuICAvL1xuXG4gIC8qKlxuICAgKiBTYWlsc0lPQ2xpZW50KClcbiAgICpcbiAgICogQXVnbWVudCB0aGUgcHJvdmlkZWQgU29ja2V0LmlvIGNsaWVudCBvYmplY3QgKGBpb2ApIHdpdGggbWV0aG9kcyBmb3JcbiAgICogdGFsa2luZyBhbmQgbGlzdGVuaW5nIHRvIG9uZSBvciBtb3JlIFNhaWxzIGJhY2tlbmQocykuICBJZiBubyBgaW9gIHdhc1xuICAgKiBwcm92aWRlZCAoaS5lLiBpbiBhIGJyb3dzZXIgc2V0dGluZyksIHRoZW4gYXR0ZW1wdCB0byB1c2UgdGhlIGdsb2JhbC5cbiAgICpcbiAgICogVGhpcyBhYnNvcmJzIGltcGxpY2l0IGBpby5zYWlsc2AgY29uZmlndXJhdGlvbiwgc2V0cyBhIHRpbWVyIGZvclxuICAgKiBhdXRvbWF0aWNhbGx5IGNvbm5lY3RpbmcgYSBzb2NrZXQgKGlmIGBpby5zYWlscy5hdXRvQ29ubmVjdGAgaXMgZW5hYmxlZClcbiAgICogYW5kIHJldHVybnMgdGhlIGF1Z21lbnRlZCBgaW9gLlxuICAgKlxuICAgKiBOb3RlOlxuICAgKiBUaGUgYXV0b21hdGljYWxseS1jb25uZWN0ZWQgc29ja2V0IGlzIGV4cG9zZWQgYXMgYGlvLnNvY2tldGAuICBJZiB0aGlzXG4gICAqIHNvY2tldCBhdHRlbXB0cyB0byBiaW5kIGV2ZW50IGxpc3RlbmVycyBvciBzZW5kIHJlcXVlc3RzIGJlZm9yZSBpdCBpc1xuICAgKiBjb25uZWN0ZWQsIGl0IHdpbGwgYmUgcXVldWVkIHVwIGFuZCByZXBsYXllZCB3aGVuIHRoZSBjb25uZWN0aW9uIGlzXG4gICAqIHN1Y2Nlc3NmdWxseSBvcGVuZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7U29ja2V0SU99IGlvXG4gICAqIEByZXR1cm5zIHtTYWlsc0lPQ2xpZW50fSBbYWxzbyBjYWxsZWQgYGlvYF1cbiAgICovXG5cbiAgZnVuY3Rpb24gU2FpbHNJT0NsaWVudChfcHJvdmlkZWRTb2NrZXRJTykge1xuXG4gICAgLy8gRmlyc3QsIGRldGVybWluZSB3aGljaCBgaW9gIHdlJ3JlIGF1Z21lbnRpbmcuXG4gICAgLy9cbiAgICAvLyBQcmVmZXIgdGhlIHBhc3NlZC1pbiBgaW9gIGluc3RhbmNlLCBidXQgZmFsbCBiYWNrIHRvIHRoZVxuICAgIC8vIGdsb2JhbCBvbmUgaWYgd2UndmUgZ290IGl0LlxuICAgIHZhciBpbztcbiAgICBpZiAoX3Byb3ZpZGVkU29ja2V0SU8pIHtcbiAgICAgIGlvID0gX3Byb3ZpZGVkU29ja2V0SU87XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgaW8gPSBfZXhpc3RpbmdHbG9iYWxTb2NrZXRJTztcbiAgICB9XG4gICAgLy8gKG5vdGUgdGhhdCBmb3IgcmVhZGFiaWxpdHksIHdlIGRlbGliZXJhdGVseSBkbyBub3Qgc2hvcnQgY2lyY3VpdCBvciB1c2UgdGhlIHRlcnRpYXJ5IG9wZXJhdG9yIGFib3ZlKVxuXG5cbiAgICAvLyBJZiBhIHNvY2tldC5pbyBjbGllbnQgKGBpb2ApIGlzIG5vdCBhdmFpbGFibGUsIG5vbmUgb2YgdGhpcyB3aWxsIHdvcmsuXG4gICAgaWYgKCFpbykge1xuICAgICAgLy8gSWYgbm9kZTpcbiAgICAgIGlmIChTREtfSU5GTy5wbGF0Zm9ybSA9PT0gJ25vZGUnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gc29ja2V0LmlvIGNsaWVudCBhdmFpbGFibGUuICBXaGVuIHJlcXVpcmluZyBgc2FpbHMuaW8uanNgIGZyb20gTm9kZS5qcywgYSBzb2NrZXQuaW8gY2xpZW50IChgaW9gKSBtdXN0IGJlIHBhc3NlZCBpbjsgZS5nLjpcXG5gYGBcXG52YXIgaW8gPSByZXF1aXJlKFxcJ3NhaWxzLmlvLmpzXFwnKSggcmVxdWlyZShcXCdzb2NrZXQuaW8tY2xpZW50XFwnKSApXFxuYGBgXFxuKHNlZSBodHRwczovL2dpdGh1Yi5jb20vYmFsZGVyZGFzaHkvc2FpbHMuaW8uanMvdHJlZS9tYXN0ZXIvdGVzdCBmb3IgbW9yZSBleGFtcGxlcyknKTtcbiAgICAgIH1cbiAgICAgIC8vIE90aGVyd2lzZSwgdGhpcyBpcyBhIHdlYiBicm93c2VyOlxuICAgICAgZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIFNhaWxzIHNvY2tldCBTREsgZGVwZW5kcyBvbiB0aGUgc29ja2V0LmlvIGNsaWVudCwgYnV0IHRoZSBzb2NrZXQuaW8gZ2xvYmFsIChgaW9gKSB3YXMgbm90IGF2YWlsYWJsZSB3aGVuIGBzYWlscy5pby5qc2AgbG9hZGVkLiAgTm9ybWFsbHksIHRoZSBzb2NrZXQuaW8gY2xpZW50IGNvZGUgaXMgYnVuZGxlZCB3aXRoIHNhaWxzLmlvLmpzLCBzbyBzb21ldGhpbmcgaXMgYSBsaXR0bGUgb2ZmLiAgUGxlYXNlIGNoZWNrIHRvIGJlIHN1cmUgdGhpcyB2ZXJzaW9uIG9mIGBzYWlscy5pby5qc2AgaGFzIHRoZSBtaW5pZmllZCBTb2NrZXQuaW8gY2xpZW50IGF0IHRoZSB0b3Agb2YgdGhlIGZpbGUuJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gSWYgdGhlIGNob3NlbiBzb2NrZXQuaW8gY2xpZW50IChgaW9gKSBoYXMgQUxSRUFEWSBCRUVOIEFVR01FTlRFRCBieSB0aGlzIFNESyxcbiAgICAvLyAoaS5lLiBpZiBpdCBhbHJlYWR5IGhhcyBhIGAuc2FpbHNgIHByb3BlcnR5KSB0aGVuIHRocm93IGFuIGVycm9yLlxuICAgIGlmIChpby5zYWlscykge1xuICAgICAgLy8gSWYgbm9kZTpcbiAgICAgIGlmIChTREtfSU5GTy5wbGF0Zm9ybSA9PT0gJ25vZGUnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIHByb3ZpZGVkIHNvY2tldC5pbyBjbGllbnQgKGBpb2ApIGhhcyBhbHJlYWR5IGJlZW4gYXVnbWVudGVkIGludG8gYSBTYWlscyBzb2NrZXQgU0RLIGluc3RhbmNlIChpdCBoYXMgYGlvLnNhaWxzYCkuJyk7XG4gICAgICB9XG4gICAgICAvLyBPdGhlcndpc2UsIHRoaXMgaXMgYSB3ZWIgYnJvd3NlcjpcbiAgICAgIGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBzb2NrZXQuaW8gY2xpZW50IChgaW9gKSBoYXMgYWxyZWFkeSBiZWVuIGF1Z21lbnRlZCBpbnRvIGEgU2FpbHMgc29ja2V0IFNESyBpbnN0YW5jZS4gIFVzdWFsbHksIHRoaXMgbWVhbnMgeW91IGFyZSBicmluZ2luZyBgc2FpbHMuaW8uanNgIG9udG8gdGhlIHBhZ2UgbW9yZSB0aGFuIG9uY2UuJyk7XG4gICAgICB9XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBBIGxpdHRsZSBsb2dnZXIgZm9yIHRoaXMgbGlicmFyeSB0byB1c2UgaW50ZXJuYWxseS5cbiAgICAgKiBCYXNpY2FsbHkganVzdCBhIHdyYXBwZXIgYXJvdW5kIGBjb25zb2xlLmxvZ2Agd2l0aFxuICAgICAqIHN1cHBvcnQgZm9yIGZlYXR1cmUtZGV0ZWN0aW9uLlxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICogQGZhY3RvcnlcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBMb2dnZXJGYWN0b3J5KG9wdGlvbnMpIHtcbiAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHtcbiAgICAgICAgcHJlZml4OiB0cnVlXG4gICAgICB9O1xuXG4gICAgICAvLyBJZiBgY29uc29sZS5sb2dgIGlzIG5vdCBhY2Nlc3NpYmxlLCBgbG9nYCBpcyBhIG5vb3AuXG4gICAgICBpZiAoXG4gICAgICAgIHR5cGVvZiBjb25zb2xlICE9PSAnb2JqZWN0JyB8fFxuICAgICAgICB0eXBlb2YgY29uc29sZS5sb2cgIT09ICdmdW5jdGlvbicgfHxcbiAgICAgICAgdHlwZW9mIGNvbnNvbGUubG9nLmJpbmQgIT09ICdmdW5jdGlvbidcbiAgICAgICkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gbm9vcCgpIHt9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZnVuY3Rpb24gbG9nKCkge1xuICAgICAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cbiAgICAgICAgLy8gQWxsIGxvZ3MgYXJlIGRpc2FibGVkIHdoZW4gYGlvLnNhaWxzLmVudmlyb25tZW50ID0gJ3Byb2R1Y3Rpb24nYC5cbiAgICAgICAgaWYgKGlvLnNhaWxzLmVudmlyb25tZW50ID09PSAncHJvZHVjdGlvbicpIHJldHVybjtcblxuICAgICAgICAvLyBBZGQgcHJlZml4IHRvIGxvZyBtZXNzYWdlcyAodW5sZXNzIGRpc2FibGVkKVxuICAgICAgICB2YXIgUFJFRklYID0gJyc7XG4gICAgICAgIGlmIChvcHRpb25zLnByZWZpeCkge1xuICAgICAgICAgIGFyZ3MudW5zaGlmdChQUkVGSVgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2FsbCB3cmFwcGVkIGxvZ2dlclxuICAgICAgICBjb25zb2xlLmxvZ1xuICAgICAgICAgIC5iaW5kKGNvbnNvbGUpXG4gICAgICAgICAgLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgfTtcbiAgICB9Ly88L0xvZ2dlckZhY3Rvcnk+XG5cbiAgICAvLyBDcmVhdGUgYSBwcml2YXRlIGxvZ2dlciBpbnN0YW5jZVxuICAgIHZhciBjb25zb2xvZyA9IExvZ2dlckZhY3RvcnkoKTtcbiAgICBjb25zb2xvZy5ub1ByZWZpeCA9IExvZ2dlckZhY3Rvcnkoe1xuICAgICAgcHJlZml4OiBmYWxzZVxuICAgIH0pO1xuXG5cblxuICAgIC8qKlxuICAgICAqIFdoYXQgaXMgdGhlIGByZXF1ZXN0UXVldWVgP1xuICAgICAqXG4gICAgICogVGhlIHJlcXVlc3QgcXVldWUgaXMgdXNlZCB0byBzaW1wbGlmeSBhcHAtbGV2ZWwgY29ubmVjdGlvbiBsb2dpYy0tXG4gICAgICogaS5lLiBzbyB5b3UgZG9uJ3QgaGF2ZSB0byB3YWl0IGZvciB0aGUgc29ja2V0IHRvIGJlIGNvbm5lY3RlZFxuICAgICAqIHRvIHN0YXJ0IHRyeWluZyB0byAgc3luY2hyb25pemUgZGF0YS5cbiAgICAgKlxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqIEBwYXJhbSAge1NhaWxzU29ja2V0fSAgc29ja2V0XG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBydW5SZXF1ZXN0UXVldWUgKHNvY2tldCkge1xuICAgICAgdmFyIHF1ZXVlID0gc29ja2V0LnJlcXVlc3RRdWV1ZTtcblxuICAgICAgaWYgKCFxdWV1ZSkgcmV0dXJuO1xuICAgICAgZm9yICh2YXIgaSBpbiBxdWV1ZSkge1xuXG4gICAgICAgIC8vIERvdWJsZS1jaGVjayB0aGF0IGBxdWV1ZVtpXWAgd2lsbCBub3RcbiAgICAgICAgLy8gaW5hZHZlcnRlbnRseSBkaXNjb3ZlciBleHRyYSBwcm9wZXJ0aWVzIGF0dGFjaGVkIHRvIHRoZSBPYmplY3RcbiAgICAgICAgLy8gYW5kL29yIEFycmF5IHByb3RvdHlwZSBieSBvdGhlciBsaWJyYXJpZXMvZnJhbWV3b3Jrcy90b29scy5cbiAgICAgICAgLy8gKGUuZy4gRW1iZXIgZG9lcyB0aGlzLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2JhbGRlcmRhc2h5L3NhaWxzLmlvLmpzL3B1bGwvNSlcbiAgICAgICAgdmFyIGlzU2FmZVRvRGVyZWZlcmVuY2UgPSAoe30pLmhhc093blByb3BlcnR5LmNhbGwocXVldWUsIGkpO1xuICAgICAgICBpZiAoaXNTYWZlVG9EZXJlZmVyZW5jZSkge1xuICAgICAgICAgIC8vIEdldCB0aGUgYXJndW1lbnRzIHRoYXQgd2VyZSBvcmlnaW5hbGx5IG1hZGUgdG8gdGhlIFwicmVxdWVzdFwiIG1ldGhvZFxuICAgICAgICAgIHZhciByZXF1ZXN0QXJncyA9IHF1ZXVlW2ldO1xuICAgICAgICAgIC8vIENhbGwgdGhlIHJlcXVlc3QgbWV0aG9kIGFnYWluIGluIHRoZSBjb250ZXh0IG9mIHRoZSBzb2NrZXQsIHdpdGggdGhlIG9yaWdpbmFsIGFyZ3NcbiAgICAgICAgICBzb2NrZXQucmVxdWVzdC5hcHBseShzb2NrZXQsIHJlcXVlc3RBcmdzKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBOb3cgZW1wdHkgdGhlIHF1ZXVlIHRvIHJlbW92ZSBpdCBhcyBhIHNvdXJjZSBvZiBhZGRpdGlvbmFsIGNvbXBsZXhpdHkuXG4gICAgICBzb2NrZXQucmVxdWVzdFF1ZXVlID0gbnVsbDtcbiAgICB9XG5cblxuXG4gICAgLyoqXG4gICAgICogU2VuZCBhIEpTT05QIHJlcXVlc3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9ICAgb3B0cyBbb3B0aW9uYWxdXG4gICAgICogQHBhcmFtICB7RnVuY3Rpb259IGNiXG4gICAgICogQHJldHVybiB7WE1MSHR0cFJlcXVlc3R9XG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBqc29ucChvcHRzLCBjYikge1xuICAgICAgb3B0cyA9IG9wdHMgfHwge307XG5cbiAgICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAvLyBUT0RPOiByZWZhY3RvciBub2RlIHVzYWdlIHRvIGxpdmUgaW4gaGVyZVxuICAgICAgICByZXR1cm4gY2IoKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHNjcmlwdEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gICAgICB3aW5kb3cuX3NhaWxzSW9KU0Nvbm5lY3QgPSBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAvLyBJbiByYXJlIGNpcmN1bXN0YW5jZXMgb3VyIHNjcmlwdCBtYXkgaGF2ZSBiZWVuIHZhcG9yaXNlZC5cbiAgICAgICAgLy8gUmVtb3ZlIGl0LCBidXQgb25seSBpZiBpdCBzdGlsbCBleGlzdHNcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2JhbGRlcmRhc2h5L3NhaWxzLmlvLmpzL2lzc3Vlcy85MlxuICAgICAgICBpZiAoc2NyaXB0RWwgJiYgc2NyaXB0RWwucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgc2NyaXB0RWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzY3JpcHRFbCk7XG4gICAgICAgIH1cblxuICAgICAgICBjYihyZXNwb25zZSk7XG4gICAgICB9O1xuICAgICAgc2NyaXB0RWwuc3JjID0gb3B0cy51cmw7XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdLmFwcGVuZENoaWxkKHNjcmlwdEVsKTtcblxuICAgIH1cblxuXG5cblxuICAgIC8vICAgICAgIOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilojilZcg4paI4paI4paI4pWXICAg4paI4paI4pWXICAgICAg4paI4paI4pWXICAgIOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilojilojilZcg4paI4paI4paI4paI4paI4paI4pWXICDilojilojilojilojilojilojilZfilojilojilZcgIOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl1xuICAgIC8vICAgICAgIOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKVlyAg4paI4paI4pWRICAgICAg4paI4paI4pWRICAgIOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVkSDilojilojilZTilZ3ilojilojilZTilZDilZDilZDilZDilZ3ilZrilZDilZDilojilojilZTilZDilZDilZ1cbiAgICAvLyAgICAgICDilojilojilZHilojilojilojilojilojilojilojilZfilojilojilZEgICDilojilojilZHilojilojilZTilojilojilZcg4paI4paI4pWR4paI4paI4paI4paI4paI4pWX4paI4paI4pWRIOKWiOKVlyDilojilojilZHilojilojilojilojilojilZcgIOKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVkSAgIOKWiOKWiOKVkeKWiOKWiOKVkSAgICAg4paI4paI4paI4paI4paI4pWU4pWdIOKWiOKWiOKWiOKWiOKWiOKVlyAgICAg4paI4paI4pWRXG4gICAgLy8gIOKWiOKWiCAgIOKWiOKWiOKVkeKVmuKVkOKVkOKVkOKVkOKWiOKWiOKVkeKWiOKWiOKVkSAgIOKWiOKWiOKVkeKWiOKWiOKVkeKVmuKWiOKWiOKVl+KWiOKWiOKVkeKVmuKVkOKVkOKVkOKVkOKVneKWiOKWiOKVkeKWiOKWiOKWiOKVl+KWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVnSAg4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWR4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWRICAgICDilojilojilZTilZDilojilojilZcg4paI4paI4pWU4pWQ4pWQ4pWdICAgICDilojilojilZFcbiAgICAvLyAg4pWa4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4paI4pWR4pWa4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4pWRIOKVmuKWiOKWiOKWiOKWiOKVkSAgICAgIOKVmuKWiOKWiOKWiOKVlOKWiOKWiOKWiOKVlOKVneKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkeKVmuKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKVmuKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVkSAg4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWXICAg4paI4paI4pWRXG4gICAgLy8gICDilZrilZDilZDilZDilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVkOKVkOKVkOKVkOKVnSDilZrilZDilZ0gIOKVmuKVkOKVkOKVkOKVnSAgICAgICDilZrilZDilZDilZ3ilZrilZDilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVnSDilZrilZDilZDilZDilZDilZDilZ0gIOKVmuKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVnSAg4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdICAg4pWa4pWQ4pWdXG4gICAgLy9cbiAgICAvLyAg4paI4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKVlyAg4paI4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKVlyAgIOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlyAgICAg4paI4paI4pWXICAgICDilojilojilZfilojilojilZcgICAg4paI4paI4pWX4paI4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKVl1xuICAgIC8vICDilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilZDilojilojilZfilojilojilojilojilZcgIOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVnSAgICDilojilojilZTilZ0gICAgIOKWiOKWiOKVkeKWiOKWiOKVkSAgICDilojilojilZHilojilojilZTilZDilZDilojilojilZfilZrilojilojilZdcbiAgICAvLyAg4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4pWXICDilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilZTilZ3ilojilojilZEgICDilojilojilZHilojilojilZTilojilojilZcg4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4pWXICAgICAg4paI4paI4pWRICAgICAg4paI4paI4pWR4paI4paI4pWRIOKWiOKVlyDilojilojilZHilojilojilojilojilojilojilZTilZ0g4paI4paI4pWRXG4gICAgLy8gIOKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKVnSAg4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4pWQ4pWdIOKWiOKWiOKVkSAgIOKWiOKWiOKVkeKWiOKWiOKVkeKVmuKWiOKWiOKVl+KWiOKWiOKVkeKVmuKVkOKVkOKVkOKVkOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVnSAgICAgIOKWiOKWiOKVkSDilojiloggICDilojilojilZHilojilojilZHilojilojilojilZfilojilojilZHilojilojilZTilZDilZDilojilojilZcg4paI4paI4pWRXG4gICAgLy8gIOKWiOKWiOKVkSAg4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4pWRICAgICDilZrilojilojilojilojilojilojilZTilZ3ilojilojilZEg4pWa4paI4paI4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWXICAgIOKVmuKWiOKWiOKVl+KVmuKWiOKWiOKWiOKWiOKWiOKVlOKVneKVmuKWiOKWiOKWiOKVlOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkSAg4paI4paI4pWR4paI4paI4pWU4pWdXG4gICAgLy8gIOKVmuKVkOKVnSAg4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWdICAgICAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVnSAg4pWa4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdICAgICDilZrilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWdICDilZrilZDilZDilZ3ilZrilZDilZDilZ0g4pWa4pWQ4pWdICDilZrilZDilZ3ilZrilZDilZ1cbiAgICAvL1xuXG4gICAgLyoqXG4gICAgICogVGhlIEpXUiAoSlNPTiBXZWJTb2NrZXQgUmVzcG9uc2UpIHJlY2VpdmVkIGZyb20gYSBTYWlscyBzZXJ2ZXIuXG4gICAgICpcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqIEBwYXJhbSAge09iamVjdH0gIHJlc3BvbnNlQ3R4XG4gICAgICogICAgICAgICA9PiA6Ym9keVxuICAgICAqICAgICAgICAgPT4gOnN0YXR1c0NvZGVcbiAgICAgKiAgICAgICAgID0+IDpoZWFkZXJzXG4gICAgICpcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIEpXUihyZXNwb25zZUN0eCkge1xuICAgICAgdGhpcy5ib2R5ID0gcmVzcG9uc2VDdHguYm9keSB8fCB7fTtcbiAgICAgIHRoaXMuaGVhZGVycyA9IHJlc3BvbnNlQ3R4LmhlYWRlcnMgfHwge307XG4gICAgICB0aGlzLnN0YXR1c0NvZGUgPSByZXNwb25zZUN0eC5zdGF0dXNDb2RlIHx8IDIwMDtcbiAgICAgIGlmICh0aGlzLnN0YXR1c0NvZGUgPCAyMDAgfHwgdGhpcy5zdGF0dXNDb2RlID49IDQwMCkge1xuICAgICAgICB0aGlzLmVycm9yID0gdGhpcy5ib2R5IHx8IHRoaXMuc3RhdHVzQ29kZTtcbiAgICAgIH1cbiAgICB9XG4gICAgSldSLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICdbUmVzcG9uc2VGcm9tU2FpbHNdJyArICcgIC0tICcgK1xuICAgICAgICAnU3RhdHVzOiAnICsgdGhpcy5zdGF0dXNDb2RlICsgJyAgLS0gJyArXG4gICAgICAgICdIZWFkZXJzOiAnICsgdGhpcy5oZWFkZXJzICsgJyAgLS0gJyArXG4gICAgICAgICdCb2R5OiAnICsgdGhpcy5ib2R5O1xuICAgIH07XG4gICAgSldSLnByb3RvdHlwZS50b1BPSk8gPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGJvZHk6IHRoaXMuYm9keSxcbiAgICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgICBzdGF0dXNDb2RlOiB0aGlzLnN0YXR1c0NvZGVcbiAgICAgIH07XG4gICAgfTtcbiAgICBKV1IucHJvdG90eXBlLnBpcGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIC8vIFRPRE86IGxvb2sgYXQgc3Vic3RhY2sncyBzdHVmZlxuICAgICAgcmV0dXJuIG5ldyBFcnJvcignQ2xpZW50LXNpZGUgc3RyZWFtaW5nIHN1cHBvcnQgbm90IGltcGxlbWVudGVkIHlldC4nKTtcbiAgICB9O1xuXG5cblxuXG4gICAgLy8gICAgICAgICAg4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4pWXICAg4paI4paI4paI4pWX4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4pWXICDilojilojilojilojilojilojilZcg4paI4paI4paI4pWXICAg4paI4paI4paI4pWXIOKWiOKWiOKVl+KWiOKWiOKVl1xuICAgIC8vICAgICAgICAgIOKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilZHilojilojilZHilZrilZDilZDilojilojilZTilZDilZDilZ3ilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilZDilojilojilZfilojilojilojilojilZcg4paI4paI4paI4paI4pWR4paI4paI4pWU4pWd4pWa4paI4paI4pWXXG4gICAgLy8gICAgICAgICAg4paI4paI4paI4paI4paI4pWXICDilojilojilZTilojilojilojilojilZTilojilojilZHilojilojilZEgICDilojilojilZEgICDilojilojilojilojilojilZcgIOKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkSAgIOKWiOKWiOKVkeKWiOKWiOKVlOKWiOKWiOKWiOKWiOKVlOKWiOKWiOKVkeKWiOKWiOKVkSAg4paI4paI4pWRXG4gICAgLy8gICAgICAgICAg4paI4paI4pWU4pWQ4pWQ4pWdICDilojilojilZHilZrilojilojilZTilZ3ilojilojilZHilojilojilZEgICDilojilojilZEgICDilojilojilZTilZDilZDilZ0gIOKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVkSAgIOKWiOKWiOKVkeKWiOKWiOKVkeKVmuKWiOKWiOKVlOKVneKWiOKWiOKVkeKWiOKWiOKVkSAg4paI4paI4pWRXG4gICAgLy8gIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVkSDilZrilZDilZ0g4paI4paI4pWR4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4pWRICAgICDilojilojilZEgIOKWiOKWiOKVkeKVmuKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkSDilZrilZDilZ0g4paI4paI4pWR4pWa4paI4paI4pWX4paI4paI4pWU4pWdXG4gICAgLy8gIOKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVnSAgICAg4pWa4pWQ4pWd4pWa4pWQ4pWdICAg4pWa4pWQ4pWdICAg4pWa4pWQ4pWdICAgICDilZrilZDilZ0gIOKVmuKVkOKVnSDilZrilZDilZDilZDilZDilZDilZ0g4pWa4pWQ4pWdICAgICDilZrilZDilZ0g4pWa4pWQ4pWd4pWa4pWQ4pWdXG4gICAgLy9cblxuICAgIC8qKlxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqIEBwYXJhbSAge1NhaWxzU29ja2V0fSBzb2NrZXQgIFtkZXNjcmlwdGlvbl1cbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IHJlcXVlc3RDdHggW2Rlc2NyaXB0aW9uXVxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gX2VtaXRGcm9tKHNvY2tldCwgcmVxdWVzdEN0eCkge1xuXG4gICAgICBpZiAoIXNvY2tldC5fcmF3KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGVtaXQgZnJvbSBzb2NrZXQtIHJhdyBTSU8gc29ja2V0IGlzIG1pc3NpbmcuJyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFNpbmNlIGNhbGxiYWNrIGlzIGVtYmVkZGVkIGluIHJlcXVlc3RDdHgsXG4gICAgICAvLyByZXRyaWV2ZSBpdCBhbmQgZGVsZXRlIHRoZSBrZXkgYmVmb3JlIGNvbnRpbnVpbmcuXG4gICAgICB2YXIgY2IgPSByZXF1ZXN0Q3R4LmNiO1xuICAgICAgZGVsZXRlIHJlcXVlc3RDdHguY2I7XG5cbiAgICAgIC8vIE5hbWUgb2YgdGhlIGFwcHJvcHJpYXRlIHNvY2tldC5pbyBsaXN0ZW5lciBvbiB0aGUgc2VydmVyXG4gICAgICAvLyAoID09PSB0aGUgcmVxdWVzdCBtZXRob2Qgb3IgXCJ2ZXJiXCIsIGUuZy4gJ2dldCcsICdwb3N0JywgJ3B1dCcsIGV0Yy4gKVxuICAgICAgdmFyIHNhaWxzRW5kcG9pbnQgPSByZXF1ZXN0Q3R4Lm1ldGhvZDtcblxuICAgICAgc29ja2V0Ll9yYXcuZW1pdChzYWlsc0VuZHBvaW50LCByZXF1ZXN0Q3R4LCBmdW5jdGlvbiBzZXJ2ZXJSZXNwb25kZWQocmVzcG9uc2VDdHgpIHtcblxuICAgICAgICAvLyBTZW5kIGJhY2sgKGVtdWxhdGVkSFRUUEJvZHksIGpzb25XZWJTb2NrZXRSZXNwb25zZSlcbiAgICAgICAgaWYgKGNiKSB7XG4gICAgICAgICAgY2IocmVzcG9uc2VDdHguYm9keSwgbmV3IEpXUihyZXNwb25zZUN0eCkpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cblxuXG5cblxuXG5cbiAgICAvLyAg4paI4paI4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilZfilojilojilZcgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilojilZcgIOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVlyAg4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4paI4pWXXG4gICAgLy8gIOKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVkeKWiOKWiOKVkSAgICAg4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWRIOKWiOKWiOKVlOKVneKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKWiOKWiOKVlOKVkOKVkOKVnVxuICAgIC8vICDilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZHilojilojilZHilojilojilZEgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVkSAgIOKWiOKWiOKVkeKWiOKWiOKVkSAgICAg4paI4paI4paI4paI4paI4pWU4pWdIOKWiOKWiOKWiOKWiOKWiOKVlyAgICAg4paI4paI4pWRXG4gICAgLy8gIOKVmuKVkOKVkOKVkOKVkOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKVkSAgICAg4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWR4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWR4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWRICAgICDilojilojilZTilZDilojilojilZcg4paI4paI4pWU4pWQ4pWQ4pWdICAgICDilojilojilZFcbiAgICAvLyAg4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4pWRICDilojilojilZHilojilojilZHilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZHilojilojilojilojilojilojilojilZHilZrilojilojilojilojilojilojilZTilZ3ilZrilojilojilojilojilojilojilZfilojilojilZEgIOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlyAgIOKWiOKWiOKVkVxuICAgIC8vICDilZrilZDilZDilZDilZDilZDilZDilZ3ilZrilZDilZ0gIOKVmuKVkOKVneKVmuKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVnSDilZrilZDilZDilZDilZDilZDilZ0gIOKVmuKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVnSAg4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdICAg4pWa4pWQ4pWdXG4gICAgLy9cblxuICAgIC8qKlxuICAgICAqIFNhaWxzU29ja2V0XG4gICAgICpcbiAgICAgKiBBIHdyYXBwZXIgZm9yIGFuIHVuZGVybHlpbmcgU29ja2V0IGluc3RhbmNlIHRoYXQgY29tbXVuaWNhdGVzIGRpcmVjdGx5XG4gICAgICogdG8gdGhlIFNvY2tldC5pbyBzZXJ2ZXIgcnVubmluZyBpbnNpZGUgb2YgU2FpbHMuXG4gICAgICpcbiAgICAgKiBJZiBubyBgc29ja2V0YCBvcHRpb24gaXMgcHJvdmllZCwgU2FpbHNTb2NrZXQgd2lsbCBmdW5jdGlvbiBhcyBhIG1vY2suIEl0IHdpbGwgcXVldWUgc29ja2V0XG4gICAgICogcmVxdWVzdHMgYW5kIGV2ZW50IGhhbmRsZXIgYmluZGluZ3MsIHJlcGxheWluZyB0aGVtIHdoZW4gdGhlIHJhdyB1bmRlcmx5aW5nIHNvY2tldCBhY3R1YWxseVxuICAgICAqIGNvbm5lY3RzLiBUaGlzIGlzIGhhbmR5IHdoZW4gd2UgZG9uJ3QgbmVjZXNzYXJpbHkgaGF2ZSB0aGUgdmFsaWQgY29uZmlndXJhdGlvbiB0byBrbm93XG4gICAgICogV0hJQ0ggU0VSVkVSIHRvIHRhbGsgdG8geWV0LCBldGMuICBJdCBpcyBhbHNvIHVzZWQgYnkgYGlvLnNvY2tldGAgZm9yIHlvdXIgY29udmVuaWVuY2UuXG4gICAgICpcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKlxuICAgICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgKiBOb3RlOiBUaGlzIGNvbnN0cnVjdG9yIHNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseS4gVG8gb2J0YWluIGEgYFNhaWxzU29ja2V0YFxuICAgICAqIGluc3RhbmNlIG9mIHlvdXIgdmVyeSBvd24sIHJ1bjpcbiAgICAgKiBgYGBcbiAgICAgKiB2YXIgbXlTb2NrZXQgPSBpby5zYWlscy5jb25uZWN0KCk7XG4gICAgICogYGBgXG4gICAgICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFNhaWxzU29ja2V0IChvcHRzKXtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIG9wdHMgPSBvcHRzfHx7fTtcblxuICAgICAgLy8gU2V0IHVwIGNvbm5lY3Rpb24gb3B0aW9ucyBzbyB0aGF0IHRoZXkgY2FuIG9ubHkgYmUgY2hhbmdlZCB3aGVuIHNvY2tldCBpcyBkaXNjb25uZWN0ZWQuXG4gICAgICB2YXIgX29wdHMgPSB7fTtcbiAgICAgIFNPQ0tFVF9PUFRJT05TLmZvckVhY2goZnVuY3Rpb24ob3B0aW9uKSB7XG4gICAgICAgIC8vIE9rYXkgdG8gY2hhbmdlIGdsb2JhbCBoZWFkZXJzIHdoaWxlIHNvY2tldCBpcyBjb25uZWN0ZWRcbiAgICAgICAgaWYgKG9wdGlvbiA9PSAnaGVhZGVycycpIHtyZXR1cm47fVxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZiwgb3B0aW9uLCB7XG4gICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmIChvcHRpb24gPT0gJ3VybCcpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIF9vcHRzW29wdGlvbl0gfHwgKHNlbGYuX3JhdyAmJiBzZWxmLl9yYXcuaW8gJiYgc2VsZi5fcmF3LmlvLnVyaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX29wdHNbb3B0aW9uXTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIC8vIERvbid0IGFsbG93IHZhbHVlIHRvIGJlIGNoYW5nZWQgd2hpbGUgc29ja2V0IGlzIGNvbm5lY3RlZFxuICAgICAgICAgICAgaWYgKHNlbGYuaXNDb25uZWN0ZWQoKSAmJiBpby5zYWlscy5zdHJpY3QgIT09IGZhbHNlICYmIHZhbHVlICE9IF9vcHRzW29wdGlvbl0pIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgY2hhbmdlIHZhbHVlIG9mIGAnICsgb3B0aW9uICsgJ2Agd2hpbGUgc29ja2V0IGlzIGNvbm5lY3RlZC4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIElmIHNvY2tldCBpcyBhdHRlbXB0aW5nIHRvIHJlY29ubmVjdCwgc3RvcCBpdC5cbiAgICAgICAgICAgIGlmIChzZWxmLl9yYXcgJiYgc2VsZi5fcmF3LmlvICYmIHNlbGYuX3Jhdy5pby5yZWNvbm5lY3RpbmcgJiYgIXNlbGYuX3Jhdy5pby5za2lwUmVjb25uZWN0KSB7XG4gICAgICAgICAgICAgIHNlbGYuX3Jhdy5pby5za2lwUmVjb25uZWN0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgY29uc29sb2coJ1N0b3BwaW5nIHJlY29ubmVjdDsgdXNlIC5yZWNvbm5lY3QoKSB0byBjb25uZWN0IHNvY2tldCBhZnRlciBjaGFuZ2luZyBvcHRpb25zLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX29wdHNbb3B0aW9uXSA9IHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gQWJzb3JiIG9wdHMgaW50byBTYWlsc1NvY2tldCBpbnN0YW5jZVxuICAgICAgLy8gU2VlIGh0dHBzOi8vc2FpbHNqcy5vcmcvcmVmZXJlbmNlL3dlYnNvY2tldHMvc2FpbHMuaW8uanMvU2FpbHNTb2NrZXQvcHJvcGVydGllcy5tZFxuICAgICAgLy8gZm9yIGRlc2NyaXB0aW9uIG9mIG9wdGlvbnNcbiAgICAgIFNPQ0tFVF9PUFRJT05TLmZvckVhY2goZnVuY3Rpb24ob3B0aW9uKSB7XG4gICAgICAgIHNlbGZbb3B0aW9uXSA9IG9wdHNbb3B0aW9uXTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBTZXQgdXAgXCJldmVudFF1ZXVlXCIgdG8gaG9sZCBldmVudCBoYW5kbGVycyB3aGljaCBoYXZlIG5vdCBiZWVuIHNldCBvbiB0aGUgYWN0dWFsIHJhdyBzb2NrZXQgeWV0LlxuICAgICAgc2VsZi5ldmVudFF1ZXVlID0ge307XG5cbiAgICAgIC8vIExpc3RlbiBmb3Igc3BlY2lhbCBgcGFyc2VFcnJvcmAgZXZlbnQgc2VudCBmcm9tIHNvY2tldHMgaG9vayBvbiB0aGUgYmFja2VuZFxuICAgICAgLy8gaWYgYW4gZXJyb3Igb2NjdXJzIGJ1dCBhIHZhbGlkIGNhbGxiYWNrIHdhcyBub3QgcmVjZWl2ZWQgZnJvbSB0aGUgY2xpZW50XG4gICAgICAvLyAoaS5lLiBzbyB0aGUgc2VydmVyIGhhZCBubyBvdGhlciB3YXkgdG8gc2VuZCBiYWNrIHRoZSBlcnJvciBpbmZvcm1hdGlvbilcbiAgICAgIHNlbGYub24oJ3NhaWxzOnBhcnNlRXJyb3InLCBmdW5jdGlvbiAoZXJyKXtcbiAgICAgICAgY29uc29sb2coJ1NhaWxzIGVuY291bnRlcmVkIGFuIGVycm9yIHBhcnNpbmcgYSBzb2NrZXQgbWVzc2FnZSBzZW50IGZyb20gdGhpcyBjbGllbnQsIGFuZCBkaWQgbm90IGhhdmUgYWNjZXNzIHRvIGEgY2FsbGJhY2sgZnVuY3Rpb24gdG8gcmVzcG9uZCB3aXRoLicpO1xuICAgICAgICBjb25zb2xvZygnRXJyb3IgZGV0YWlsczonLGVycik7XG4gICAgICB9KTtcblxuICAgICAgLy8gVE9ETzpcbiAgICAgIC8vIExpc3RlbiBmb3IgYSBzcGVjaWFsIHByaXZhdGUgbWVzc2FnZSBvbiBhbnkgY29ubmVjdGVkIHRoYXQgYWxsb3dzIHRoZSBzZXJ2ZXJcbiAgICAgIC8vIHRvIHNldCB0aGUgZW52aXJvbm1lbnQgKGdpdmluZyB1cyAxMDAlIGNlcnRhaW50eSB0aGF0IHdlIGd1ZXNzZWQgcmlnaHQpXG4gICAgICAvLyBIb3dldmVyLCBub3RlIHRoYXQgdGhlIGBjb25zb2xlLmxvZ2BzIGNhbGxlZCBiZWZvcmUgYW5kIGFmdGVyIGNvbm5lY3Rpb25cbiAgICAgIC8vIGFyZSBzdGlsbCBmb3JjZWQgdG8gcmVseSBvbiBvdXIgZXhpc3RpbmcgaGV1cmlzdGljcyAodG8gZGlzYWJsZSwgdGFjayAjcHJvZHVjdGlvblxuICAgICAgLy8gb250byB0aGUgVVJMIHVzZWQgdG8gZmV0Y2ggdGhpcyBmaWxlLilcbiAgICB9Ly88L1NhaWxzU29ja2V0PlxuXG5cbiAgICAvKipcbiAgICAgKiBgU2FpbHNTb2NrZXQucHJvdG90eXBlLl9jb25uZWN0KClgXG4gICAgICpcbiAgICAgKiBCZWdpbiBjb25uZWN0aW5nIHRoaXMgc29ja2V0IHRvIHRoZSBzZXJ2ZXIuXG4gICAgICpcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cbiAgICBTYWlsc1NvY2tldC5wcm90b3R5cGUuX2Nvbm5lY3QgPSBmdW5jdGlvbiAoKXtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgc2VsZi5pc0Nvbm5lY3RpbmcgPSB0cnVlO1xuXG4gICAgICAvLyBBcHBseSBgaW8uc2FpbHNgIGNvbmZpZyBhcyBkZWZhdWx0c1xuICAgICAgLy8gKG5vdyB0aGF0IGF0IGxlYXN0IG9uZSB0aWNrIGhhcyBlbGFwc2VkKVxuICAgICAgLy8gU2VlIGh0dHBzOi8vc2FpbHNqcy5vcmcvcmVmZXJlbmNlL3dlYnNvY2tldHMvc2FpbHMuaW8uanMvU2FpbHNTb2NrZXQvcHJvcGVydGllcy5tZFxuICAgICAgLy8gZm9yIGRlc2NyaXB0aW9uIG9mIG9wdGlvbnMgYW5kIGRlZmF1bHQgdmFsdWVzXG4gICAgICBTT0NLRVRfT1BUSU9OUy5mb3JFYWNoKGZ1bmN0aW9uKG9wdGlvbikge1xuICAgICAgICBpZiAoJ3VuZGVmaW5lZCcgPT0gdHlwZW9mIHNlbGZbb3B0aW9uXSkge1xuICAgICAgICAgIHNlbGZbb3B0aW9uXSA9IGlvLnNhaWxzW29wdGlvbl07XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBIZWFkZXJzIHRoYXQgd2lsbCBiZSBzZW50IHdpdGggdGhlIGluaXRpYWwgcmVxdWVzdCB0byAvc29ja2V0LmlvIChOb2RlLmpzIG9ubHkpXG4gICAgICBzZWxmLmV4dHJhSGVhZGVycyA9IHNlbGYuaW5pdGlhbENvbm5lY3Rpb25IZWFkZXJzIHx8IHt9O1xuXG4gICAgICAvLyBMb2cgYSB3YXJuaW5nIGlmIG5vbi1Ob2RlLmpzIHBsYXRmb3JtIGF0dGVtcHRzIHRvIHVzZSBgaW5pdGlhbENvbm5lY3Rpb25IZWFkZXJzYFxuICAgICAgaWYgKHNlbGYuaW5pdGlhbENvbm5lY3Rpb25IZWFkZXJzICYmIFNES19JTkZPLnBsYXRmb3JtICE9PSAnbm9kZScpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgY29uc29sZS53YXJuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdpbml0aWFsQ29ubmVjdGlvbkhlYWRlcnMgb3B0aW9uIGF2YWlsYWJsZSBpbiBOb2RlLmpzIG9ubHkhJyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gRW5zdXJlIFVSTCBoYXMgbm8gdHJhaWxpbmcgc2xhc2hcbiAgICAgIHNlbGYudXJsID0gc2VsZi51cmwgPyBzZWxmLnVybC5yZXBsYWNlKC8oXFwvKSQvLCAnJykgOiB1bmRlZmluZWQ7XG5cbiAgICAgIC8vIE1peCB0aGUgY3VycmVudCBTREsgdmVyc2lvbiBpbnRvIHRoZSBxdWVyeSBzdHJpbmcgaW5cbiAgICAgIC8vIHRoZSBjb25uZWN0aW9uIHJlcXVlc3QgdG8gdGhlIHNlcnZlcjpcbiAgICAgIGlmICh0eXBlb2Ygc2VsZi5xdWVyeSAhPT0gJ3N0cmluZycpIHNlbGYucXVlcnkgPSBTREtfSU5GTy52ZXJzaW9uU3RyaW5nO1xuICAgICAgZWxzZSBzZWxmLnF1ZXJ5ICs9ICcmJyArIFNES19JTkZPLnZlcnNpb25TdHJpbmc7XG5cbiAgICAgIC8vIERldGVybWluZSB3aGV0aGVyIHRoaXMgaXMgYSBjcm9zcy1vcmlnaW4gc29ja2V0IGJ5IGV4YW1pbmluZyB0aGVcbiAgICAgIC8vIGhvc3RuYW1lIGFuZCBwb3J0IG9uIHRoZSBgd2luZG93LmxvY2F0aW9uYCBvYmplY3QuICBJZiBpdCdzIGNyb3NzLW9yaWdpbixcbiAgICAgIC8vIHdlJ2xsIGF0dGVtcHQgdG8gZ2V0IGEgY29va2llIGZvciB0aGUgZG9tYWluIHNvIHRoYXQgYSBTYWlscyBzZXNzaW9uIGNhblxuICAgICAgLy8gYmUgZXN0YWJsaXNoZWQuXG4gICAgICB2YXIgaXNYT3JpZ2luID0gKGZ1bmN0aW9uICgpe1xuXG4gICAgICAgIC8vIElmIGB3aW5kb3dgIGRvZXNuJ3QgZXhpc3QgKGkuZS4gYmVpbmcgdXNlZCBmcm9tIE5vZGUuanMpLCB0aGVuXG4gICAgICAgIC8vIHdlIHdvbid0IGJvdGhlciBhdHRlbXB0aW5nIHRvIGdldCBhIGNvb2tpZS4gIElmIHlvdSdyZSB1c2luZyBzb2NrZXRzXG4gICAgICAgIC8vIGZyb20gTm9kZS5qcyBhbmQgZmluZCB5b3UgbmVlZCB0byBzaGFyZSBhIHNlc3Npb24gYmV0d2VlbiBtdWx0aXBsZVxuICAgICAgICAvLyBzb2NrZXQgY29ubmVjdGlvbnMsIHlvdSdsbCBuZWVkIHRvIG1ha2UgYW4gSFRUUCByZXF1ZXN0IHRvIHRoZSAvX19nZXRjb29raWVcbiAgICAgICAgLy8gZW5kcG9pbnQgb2YgdGhlIFNhaWxzIHNlcnZlciAob3IgYW55IGVuZHBvaW50IHRoYXQgcmV0dXJucyBhIHNldC1jb29raWUgaGVhZGVyKVxuICAgICAgICAvLyBhbmQgdGhlbiB1c2UgdGhlIGNvb2tpZSB2YWx1ZSBpbiB0aGUgYGluaXRpYWxDb25uZWN0aW9uSGVhZGVyc2Agb3B0aW9uIHRvXG4gICAgICAgIC8vIGlvLnNhaWxzLmNvbm5lY3QoKVxuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcgfHwgdHlwZW9mIHdpbmRvdy5sb2NhdGlvbiA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiBgc2VsZi51cmxgIChha2EgXCJ0YXJnZXRcIikgaXMgZmFsc3ksIHRoZW4gd2UgZG9uJ3QgbmVlZCB0byB3b3JyeSBhYm91dCBpdC5cbiAgICAgICAgaWYgKHR5cGVvZiBzZWxmLnVybCAhPT0gJ3N0cmluZycpIHsgcmV0dXJuIGZhbHNlOyB9XG5cbiAgICAgICAgLy8gR2V0IGluZm9ybWF0aW9uIGFib3V0IHRoZSBcInRhcmdldFwiIChgc2VsZi51cmxgKVxuICAgICAgICB2YXIgdGFyZ2V0UHJvdG9jb2wgPSAoZnVuY3Rpb24gKCl7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRhcmdldFByb3RvY29sID0gc2VsZi51cmwubWF0Y2goL14oW2Etel0rOlxcL1xcLykvaSlbMV0udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2F0Y2ggKGUpIHt9XG4gICAgICAgICAgdGFyZ2V0UHJvdG9jb2wgPSB0YXJnZXRQcm90b2NvbCB8fCAnaHR0cDovLyc7XG4gICAgICAgICAgcmV0dXJuIHRhcmdldFByb3RvY29sO1xuICAgICAgICB9KSgpO1xuICAgICAgICB2YXIgaXNUYXJnZXRTU0wgPSAhIXNlbGYudXJsLm1hdGNoKCdeaHR0cHMnKTtcbiAgICAgICAgdmFyIHRhcmdldFBvcnQgPSAoZnVuY3Rpb24gKCl7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBzZWxmLnVybC5tYXRjaCgvXlthLXpdKzpcXC9cXC9bXjpdKjooWzAtOV0qKS9pKVsxXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2F0Y2ggKGUpe31cbiAgICAgICAgICByZXR1cm4gaXNUYXJnZXRTU0wgPyAnNDQzJyA6ICc4MCc7XG4gICAgICAgIH0pKCk7XG4gICAgICAgIHZhciB0YXJnZXRBZnRlclByb3RvY29sID0gc2VsZi51cmwucmVwbGFjZSgvXihbYS16XSs6XFwvXFwvKS9pLCAnJyk7XG5cblxuICAgICAgICAvLyBJZiB0YXJnZXQgcHJvdG9jb2wgaXMgZGlmZmVyZW50IHRoYW4gdGhlIGFjdHVhbCBwcm90b2NvbCxcbiAgICAgICAgLy8gdGhlbiB3ZSdsbCBjb25zaWRlciB0aGlzIGNyb3NzLW9yaWdpbi5cbiAgICAgICAgaWYgKHRhcmdldFByb3RvY29sLnJlcGxhY2UoL1s6XFwvXS9nLCAnJykgIT09IHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbC5yZXBsYWNlKC9bOlxcL10vZywnJykpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgLy8gSWYgdGFyZ2V0IGhvc3RuYW1lIGlzIGRpZmZlcmVudCB0aGFuIGFjdHVhbCBob3N0bmFtZSwgd2UnbGwgY29uc2lkZXIgdGhpcyBjcm9zcy1vcmlnaW4uXG4gICAgICAgIHZhciBoYXNTYW1lSG9zdG5hbWUgPSB0YXJnZXRBZnRlclByb3RvY29sLnNlYXJjaCh3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUpID09PSAwO1xuICAgICAgICBpZiAoIWhhc1NhbWVIb3N0bmFtZSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgbm8gYWN0dWFsIHBvcnQgaXMgZXhwbGljaXRseSBzZXQgb24gdGhlIGB3aW5kb3cubG9jYXRpb25gIG9iamVjdCxcbiAgICAgICAgLy8gd2UnbGwgYXNzdW1lIGVpdGhlciA4MCBvciA0NDMuXG4gICAgICAgIHZhciBpc0xvY2F0aW9uU1NMID0gd2luZG93LmxvY2F0aW9uLnByb3RvY29sLm1hdGNoKC9odHRwcy9pKTtcbiAgICAgICAgdmFyIGxvY2F0aW9uUG9ydCA9ICh3aW5kb3cubG9jYXRpb24ucG9ydCsnJykgfHwgKGlzTG9jYXRpb25TU0wgPyAnNDQzJyA6ICc4MCcpO1xuXG4gICAgICAgIC8vIEZpbmFsbHksIGlmIHBvcnRzIGRvbid0IG1hdGNoLCB3ZSdsbCBjb25zaWRlciB0aGlzIGNyb3NzLW9yaWdpbi5cbiAgICAgICAgaWYgKHRhcmdldFBvcnQgIT09IGxvY2F0aW9uUG9ydCkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gT3RoZXJ3aXNlLCBpdCdzIHRoZSBzYW1lIG9yaWdpbi5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICB9KSgpO1xuXG5cbiAgICAgIC8vIFByZXBhcmUgdG8gc3RhcnQgY29ubmVjdGluZyB0aGUgc29ja2V0XG4gICAgICAoZnVuY3Rpb24gc2VsZkludm9raW5nIChjYil7XG5cbiAgICAgICAgLy8gSWYgdGhpcyBpcyBhbiBhdHRlbXB0IGF0IGEgY3Jvc3Mtb3JpZ2luIG9yIGNyb3NzLXBvcnRcbiAgICAgICAgLy8gc29ja2V0IGNvbm5lY3Rpb24gdmlhIGEgYnJvd3N3ZSwgc2VuZCBhIEpTT05QIHJlcXVlc3RcbiAgICAgICAgLy8gZmlyc3QgdG8gZW5zdXJlIHRoYXQgYSB2YWxpZCBjb29raWUgaXMgYXZhaWxhYmxlLlxuICAgICAgICAvLyBUaGlzIGNhbiBiZSBkaXNhYmxlZCBieSBzZXR0aW5nIGBpby5zYWlscy51c2VDT1JTUm91dGVUb0dldENvb2tpZWBcbiAgICAgICAgLy8gdG8gZmFsc2UuXG4gICAgICAgIC8vXG4gICAgICAgIC8vIE90aGVyd2lzZSwgc2tpcCB0aGUgc3R1ZmYgYmVsb3cuXG4gICAgICAgIC8vXG4gICAgICAgIGlmICghKHNlbGYudXNlQ09SU1JvdXRlVG9HZXRDb29raWUgJiYgaXNYT3JpZ2luKSkge1xuICAgICAgICAgIHJldHVybiBjYigpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRmlndXJlIG91dCB0aGUgeC1vcmlnaW4gQ09SUyByb3V0ZVxuICAgICAgICAvLyAoU2FpbHMgcHJvdmlkZXMgYSBkZWZhdWx0KVxuICAgICAgICB2YXIgeE9yaWdpbkNvb2tpZVVSTCA9IHNlbGYudXJsO1xuICAgICAgICBpZiAodHlwZW9mIHNlbGYudXNlQ09SU1JvdXRlVG9HZXRDb29raWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgeE9yaWdpbkNvb2tpZVVSTCArPSBzZWxmLnVzZUNPUlNSb3V0ZVRvR2V0Q29va2llO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHhPcmlnaW5Db29raWVVUkwgKz0gJy9fX2dldGNvb2tpZSc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNYWtlIHRoZSBBSkFYIHJlcXVlc3QgKENPUlMpXG4gICAgICAgIGpzb25wKHtcbiAgICAgICAgICB1cmw6IHhPcmlnaW5Db29raWVVUkwsXG4gICAgICAgICAgbWV0aG9kOiAnR0VUJ1xuICAgICAgICB9LCBjYik7XG5cbiAgICAgIH0pKGZ1bmN0aW9uIGdvQWhlYWRBbmRBY3R1YWxseUNvbm5lY3QoKSB7XG5cbiAgICAgICAgLy8gTm93IHRoYXQgd2UncmUgcmVhZHkgdG8gY29ubmVjdCwgY3JlYXRlIGEgcmF3IHVuZGVybHlpbmcgU29ja2V0XG4gICAgICAgIC8vIHVzaW5nIFNvY2tldC5pbyBhbmQgc2F2ZSBpdCBhcyBgX3Jhd2AgKHRoaXMgd2lsbCBzdGFydCBpdCBjb25uZWN0aW5nKVxuICAgICAgICBzZWxmLl9yYXcgPSBpbyhzZWxmLnVybCwgc2VsZik7XG5cbiAgICAgICAgLy8gUmVwbGF5IGV2ZW50IGJpbmRpbmdzIGZyb20gdGhlIGVhZ2VyIHNvY2tldFxuICAgICAgICBzZWxmLnJlcGxheSgpO1xuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqICdjb25uZWN0JyBldmVudCBpcyB0cmlnZ2VyZWQgd2hlbiB0aGUgc29ja2V0IGVzdGFibGlzaGVzIGEgY29ubmVjdGlvblxuICAgICAgICAgKiAgc3VjY2Vzc2Z1bGx5LlxuICAgICAgICAgKi9cbiAgICAgICAgc2VsZi5vbignY29ubmVjdCcsIGZ1bmN0aW9uIHNvY2tldENvbm5lY3RlZCgpIHtcbiAgICAgICAgICBzZWxmLmlzQ29ubmVjdGluZyA9IGZhbHNlO1xuICAgICAgICAgIGNvbnNvbG9nLm5vUHJlZml4KFxuICAgICAgICAgICAgJ1xcbicgK1xuICAgICAgICAgICAgJ1xcbicgK1xuICAgICAgICAgICAgLy8gJyAgICB8PiAgICAnICsgJ1xcbicgK1xuICAgICAgICAgICAgLy8gJyAgXFxcXF9fXy8gICcr77iPXG4gICAgICAgICAgICAvLyAnXFxuJytcbiAgICAgICAgICAgICAnICB8PiAgICBOb3cgY29ubmVjdGVkIHRvIFNhaWxzLicgKyAnXFxuJyArXG4gICAgICAgICAgICAnXFxcXF9fXy8gICBGb3IgaGVscCwgc2VlOiBodHRwOi8vYml0Lmx5LzFEbVR2Z0snICsgJ1xcbicgK1xuICAgICAgICAgICAgICcgICAgICAgICh1c2luZyBzYWlscy5pby5qcyAnK2lvLnNhaWxzLnNkay5wbGF0Zm9ybSsnIFNESyBAdicraW8uc2FpbHMuc2RrLnZlcnNpb24rJyknKyAnXFxuJyArXG4gICAgICAgICAgICAnXFxuJytcbiAgICAgICAgICAgICdcXG4nK1xuICAgICAgICAgICAgLy8gJ1xcbicrXG4gICAgICAgICAgICAnJ1xuICAgICAgICAgICAgLy8gJyDimpPvuI4gKGRldmVsb3BtZW50IG1vZGUpJ1xuICAgICAgICAgICAgLy8gJ2UuZy4gdG8gc2VuZCBhIEdFVCByZXF1ZXN0IHRvIFNhaWxzIHZpYSBXZWJTb2NrZXRzLCBydW46JysgJ1xcbicgK1xuICAgICAgICAgICAgLy8gJ2Bpby5zb2NrZXQuZ2V0KFwiL2Zvb1wiLCBmdW5jdGlvbiBzZXJ2ZXJSZXNwb25kZWRXaXRoIChib2R5LCBqd3IpIHsgY29uc29sZS5sb2coYm9keSk7IH0pYCcrICdcXG4nICtcbiAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICBzZWxmLm9uKCdkaXNjb25uZWN0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgc2VsZi5jb25uZWN0aW9uTG9zdFRpbWVzdGFtcCA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7XG4gICAgICAgICAgY29uc29sb2coJz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PScpO1xuICAgICAgICAgIGNvbnNvbG9nKCdTb2NrZXQgd2FzIGRpc2Nvbm5lY3RlZCBmcm9tIFNhaWxzLicpO1xuICAgICAgICAgIGNvbnNvbG9nKCdVc3VhbGx5LCB0aGlzIGlzIGR1ZSB0byBvbmUgb2YgdGhlIGZvbGxvd2luZyByZWFzb25zOicgKyAnXFxuJyArXG4gICAgICAgICAgICAnIC0+IHRoZSBzZXJ2ZXIgJyArIChzZWxmLnVybCA/IHNlbGYudXJsICsgJyAnIDogJycpICsgJ3dhcyB0YWtlbiBkb3duJyArICdcXG4nICtcbiAgICAgICAgICAgICcgLT4geW91ciBicm93c2VyIGxvc3QgaW50ZXJuZXQgY29ubmVjdGl2aXR5Jyk7XG4gICAgICAgICAgY29uc29sb2coJz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PScpO1xuICAgICAgICB9KTtcblxuICAgICAgICBzZWxmLm9uKCdyZWNvbm5lY3RpbmcnLCBmdW5jdGlvbihudW1BdHRlbXB0cykge1xuICAgICAgICAgIGNvbnNvbG9nKFxuICAgICAgICAgICAgJ1xcbicrXG4gICAgICAgICAgICAnICAgICAgICBTb2NrZXQgaXMgdHJ5aW5nIHRvIHJlY29ubmVjdCB0byBTYWlscy4uLlxcbicrXG4gICAgICAgICAgICAnXy18Pl8tICAoYXR0ZW1wdCAjJyArIG51bUF0dGVtcHRzICsgJyknKydcXG4nK1xuICAgICAgICAgICAgJ1xcbidcbiAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICBzZWxmLm9uKCdyZWNvbm5lY3QnLCBmdW5jdGlvbih0cmFuc3BvcnQsIG51bUF0dGVtcHRzKSB7XG4gICAgICAgICAgaWYgKCFzZWxmLmlzQ29ubmVjdGluZykge1xuICAgICAgICAgICAgc2VsZi5vbignY29ubmVjdCcsIHJ1blJlcXVlc3RRdWV1ZS5iaW5kKHNlbGYsIHNlbGYpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIG1zU2luY2VDb25uZWN0aW9uTG9zdCA9ICgobmV3IERhdGUoKSkuZ2V0VGltZSgpIC0gc2VsZi5jb25uZWN0aW9uTG9zdFRpbWVzdGFtcCk7XG4gICAgICAgICAgdmFyIG51bVNlY3NPZmZsaW5lID0gKG1zU2luY2VDb25uZWN0aW9uTG9zdCAvIDEwMDApO1xuICAgICAgICAgIGNvbnNvbG9nKFxuICAgICAgICAgICAgJ1xcbicrXG4gICAgICAgICAgICAgJyAgfD4gICAgU29ja2V0IHJlY29ubmVjdGVkIHN1Y2Nlc3NmdWxseSBhZnRlcicrJ1xcbicrXG4gICAgICAgICAgICAnXFxcXF9fXy8gICBiZWluZyBvZmZsaW5lIGZvciB+JyArIG51bVNlY3NPZmZsaW5lICsgJyBzZWNvbmRzLicrJ1xcbicrXG4gICAgICAgICAgICAnXFxuJ1xuICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vICdlcnJvcicgZXZlbnQgaXMgdHJpZ2dlcmVkIGlmIGNvbm5lY3Rpb24gY2FuIG5vdCBiZSBlc3RhYmxpc2hlZC5cbiAgICAgICAgLy8gKHVzdWFsbHkgYmVjYXVzZSBvZiBhIGZhaWxlZCBhdXRob3JpemF0aW9uLCB3aGljaCBpcyBpbiB0dXJuXG4gICAgICAgIC8vIHVzdWFsbHkgZHVlIHRvIGEgbWlzc2luZyBvciBpbnZhbGlkIGNvb2tpZSlcbiAgICAgICAgc2VsZi5vbignZXJyb3InLCBmdW5jdGlvbiBmYWlsZWRUb0Nvbm5lY3QoZXJyKSB7XG4gICAgICAgICAgc2VsZi5pc0Nvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgICAvLyBOb3RlOlxuICAgICAgICAgIC8vIEluIHRoZSBmdXR1cmUsIHdlIGNvdWxkIHByb3ZpZGUgYSBzZXBhcmF0ZSBldmVudCBmb3Igd2hlbiBhIHNvY2tldCBjYW5ub3QgY29ubmVjdFxuICAgICAgICAgIC8vIGR1ZSB0byBhIGZhaWxlZCBgYmVmb3JlQ29ubmVjdGAgKGFrYSBcImF1dGhvcml6YXRpb25cIiBpZiB5b3UncmUgb2xkIHNjaG9vbCkuXG4gICAgICAgICAgLy8gdGhpcyBjb3VsZCBwcm9iYWJseSBiZSBpbXBsZW1lbnRlZCBieSBlbWl0dGluZyBhIHNwZWNpYWwgZXZlbnQgZnJvbSB0aGUgc2VydmVyLlxuICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgICAgY29uc29sb2coXG4gICAgICAgICAgICAnRmFpbGVkIHRvIGNvbm5lY3Qgc29ja2V0IChwb3NzaWJseSBkdWUgdG8gZmFpbGVkIGBiZWZvcmVDb25uZWN0YCBvbiBzZXJ2ZXIpJyxcbiAgICAgICAgICAgICdFcnJvcjonLCBlcnJcbiAgICAgICAgICApO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJlY29ubmVjdCB0aGUgdW5kZXJseWluZyBzb2NrZXQuXG4gICAgICpcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuICAgIFNhaWxzU29ja2V0LnByb3RvdHlwZS5yZWNvbm5lY3QgPSBmdW5jdGlvbiAoKXtcbiAgICAgIGlmICh0aGlzLmlzQ29ubmVjdGluZykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBjb25uZWN0LSBzb2NrZXQgaXMgYWxyZWFkeSBjb25uZWN0aW5nJyk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5pc0Nvbm5lY3RlZCgpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGNvbm5lY3QtIHNvY2tldCBpcyBhbHJlYWR5IGNvbm5lY3RlZCcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuX2Nvbm5lY3QoKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRGlzY29ubmVjdCB0aGUgdW5kZXJseWluZyBzb2NrZXQuXG4gICAgICpcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuICAgIFNhaWxzU29ja2V0LnByb3RvdHlwZS5kaXNjb25uZWN0ID0gZnVuY3Rpb24gKCl7XG4gICAgICB0aGlzLmlzQ29ubmVjdGluZyA9IGZhbHNlO1xuICAgICAgaWYgKCF0aGlzLmlzQ29ubmVjdGVkKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgZGlzY29ubmVjdC0gc29ja2V0IGlzIGFscmVhZHkgZGlzY29ubmVjdGVkJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5fcmF3LmRpc2Nvbm5lY3QoKTtcbiAgICB9O1xuXG5cblxuICAgIC8qKlxuICAgICAqIGlzQ29ubmVjdGVkXG4gICAgICpcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufSB3aGV0aGVyIHRoZSBzb2NrZXQgaXMgY29ubmVjdGVkIGFuZCBhYmxlIHRvXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICBjb21tdW5pY2F0ZSB3LyB0aGUgc2VydmVyLlxuICAgICAqL1xuXG4gICAgU2FpbHNTb2NrZXQucHJvdG90eXBlLmlzQ29ubmVjdGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCF0aGlzLl9yYXcpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gISF0aGlzLl9yYXcuY29ubmVjdGVkO1xuICAgIH07XG5cblxuXG4gICAgLyoqXG4gICAgICogW3JlcGxheSBkZXNjcmlwdGlvbl1cbiAgICAgKiBAcmV0dXJuIHtbdHlwZV19IFtkZXNjcmlwdGlvbl1cbiAgICAgKi9cbiAgICBTYWlsc1NvY2tldC5wcm90b3R5cGUucmVwbGF5ID0gZnVuY3Rpb24gKCl7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgIC8vIFBhc3MgZXZlbnRzIGFuZCBhIHJlZmVyZW5jZSB0byB0aGUgcmVxdWVzdCBxdWV1ZVxuICAgICAgLy8gb2ZmIHRvIHRoZSBzZWxmLl9yYXcgZm9yIGNvbnN1bXB0aW9uXG4gICAgICBmb3IgKHZhciBldk5hbWUgaW4gc2VsZi5ldmVudFF1ZXVlKSB7XG4gICAgICAgIGZvciAodmFyIGkgaW4gc2VsZi5ldmVudFF1ZXVlW2V2TmFtZV0pIHtcbiAgICAgICAgICBzZWxmLl9yYXcub24oZXZOYW1lLCBzZWxmLmV2ZW50UXVldWVbZXZOYW1lXVtpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQmluZCBhIG9uZS10aW1lIGZ1bmN0aW9uIHRvIHJ1biB0aGUgcmVxdWVzdCBxdWV1ZVxuICAgICAgLy8gd2hlbiB0aGUgc2VsZi5fcmF3IGNvbm5lY3RzLlxuICAgICAgaWYgKCAhc2VsZi5pc0Nvbm5lY3RlZCgpICkge1xuICAgICAgICBzZWxmLl9yYXcub25jZSgnY29ubmVjdCcsIHJ1blJlcXVlc3RRdWV1ZS5iaW5kKHNlbGYsIHNlbGYpKTtcbiAgICAgIH1cbiAgICAgIC8vIE9yIHJ1biBpdCBpbW1lZGlhdGVseSBpZiBzZWxmLl9yYXcgaXMgYWxyZWFkeSBjb25uZWN0ZWRcbiAgICAgIGVsc2Uge1xuICAgICAgICBydW5SZXF1ZXN0UXVldWUoc2VsZik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzZWxmO1xuICAgIH07XG5cblxuICAgIC8qKlxuICAgICAqIENoYWluYWJsZSBtZXRob2QgdG8gYmluZCBhbiBldmVudCB0byB0aGUgc29ja2V0LlxuICAgICAqXG4gICAgICogQHBhcmFtICB7U3RyaW5nfSAgIGV2TmFtZSBbZXZlbnQgbmFtZV1cbiAgICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gZm4gICAgIFtldmVudCBoYW5kbGVyIGZ1bmN0aW9uXVxuICAgICAqIEByZXR1cm4ge1NhaWxzU29ja2V0fVxuICAgICAqL1xuICAgIFNhaWxzU29ja2V0LnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChldk5hbWUsIGZuKXtcblxuICAgICAgLy8gQmluZCB0aGUgZXZlbnQgdG8gdGhlIHJhdyB1bmRlcmx5aW5nIHNvY2tldCBpZiBwb3NzaWJsZS5cbiAgICAgIGlmICh0aGlzLl9yYXcpIHtcbiAgICAgICAgdGhpcy5fcmF3Lm9uKGV2TmFtZSwgZm4pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgLy8gT3RoZXJ3aXNlIHF1ZXVlIHRoZSBldmVudCBiaW5kaW5nLlxuICAgICAgaWYgKCF0aGlzLmV2ZW50UXVldWVbZXZOYW1lXSkge1xuICAgICAgICB0aGlzLmV2ZW50UXVldWVbZXZOYW1lXSA9IFtmbl07XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgdGhpcy5ldmVudFF1ZXVlW2V2TmFtZV0ucHVzaChmbik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDaGFpbmFibGUgbWV0aG9kIHRvIHVuYmluZCBhbiBldmVudCBmcm9tIHRoZSBzb2NrZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgZXZOYW1lIFtldmVudCBuYW1lXVxuICAgICAqIEBwYXJhbSAge0Z1bmN0aW9ufSBmbiAgICAgW2V2ZW50IGhhbmRsZXIgZnVuY3Rpb25dXG4gICAgICogQHJldHVybiB7U2FpbHNTb2NrZXR9XG4gICAgICovXG4gICAgU2FpbHNTb2NrZXQucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uIChldk5hbWUsIGZuKXtcblxuICAgICAgLy8gQmluZCB0aGUgZXZlbnQgdG8gdGhlIHJhdyB1bmRlcmx5aW5nIHNvY2tldCBpZiBwb3NzaWJsZS5cbiAgICAgIGlmICh0aGlzLl9yYXcpIHtcbiAgICAgICAgdGhpcy5fcmF3Lm9mZihldk5hbWUsIGZuKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIC8vIE90aGVyd2lzZSBxdWV1ZSB0aGUgZXZlbnQgYmluZGluZy5cbiAgICAgIGlmICh0aGlzLmV2ZW50UXVldWVbZXZOYW1lXSAmJiB0aGlzLmV2ZW50UXVldWVbZXZOYW1lXS5pbmRleE9mKGZuKSA+IC0xKSB7XG4gICAgICAgIHRoaXMuZXZlbnRRdWV1ZVtldk5hbWVdLnNwbGljZSh0aGlzLmV2ZW50UXVldWVbZXZOYW1lXS5pbmRleE9mKGZuKSwgMSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cblxuICAgIC8qKlxuICAgICAqIENoYWluYWJsZSBtZXRob2QgdG8gdW5iaW5kIGFsbCBldmVudHMgZnJvbSB0aGUgc29ja2V0LlxuICAgICAqXG4gICAgICogQHJldHVybiB7U2FpbHNTb2NrZXR9XG4gICAgICovXG4gICAgU2FpbHNTb2NrZXQucHJvdG90eXBlLnJlbW92ZUFsbExpc3RlbmVycyA9IGZ1bmN0aW9uICgpe1xuXG4gICAgICAvLyBCaW5kIHRoZSBldmVudCB0byB0aGUgcmF3IHVuZGVybHlpbmcgc29ja2V0IGlmIHBvc3NpYmxlLlxuICAgICAgaWYgKHRoaXMuX3Jhdykge1xuICAgICAgICB0aGlzLl9yYXcucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICAvLyBPdGhlcndpc2UgcXVldWUgdGhlIGV2ZW50IGJpbmRpbmcuXG4gICAgICB0aGlzLmV2ZW50UXVldWUgPSB7fTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFNpbXVsYXRlIGEgR0VUIHJlcXVlc3QgdG8gc2FpbHNcbiAgICAgKiBlLmcuXG4gICAgICogICAgYHNvY2tldC5nZXQoJy91c2VyLzMnLCBTdGF0cy5wb3B1bGF0ZSlgXG4gICAgICpcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB1cmwgICAgOjogICAgZGVzdGluYXRpb24gVVJMXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEgICA6OiAgICBwYXJhbWV0ZXJzIHRvIHNlbmQgd2l0aCB0aGUgcmVxdWVzdCBbb3B0aW9uYWxdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2IgICA6OiAgICBjYWxsYmFjayBmdW5jdGlvbiB0byBjYWxsIHdoZW4gZmluaXNoZWQgW29wdGlvbmFsXVxuICAgICAqL1xuXG4gICAgU2FpbHNTb2NrZXQucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKHVybCwgZGF0YSwgY2IpIHtcblxuICAgICAgLy8gYGRhdGFgIGlzIG9wdGlvbmFsXG4gICAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgY2IgPSBkYXRhO1xuICAgICAgICBkYXRhID0ge307XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLnJlcXVlc3Qoe1xuICAgICAgICBtZXRob2Q6ICdnZXQnLFxuICAgICAgICBwYXJhbXM6IGRhdGEsXG4gICAgICAgIHVybDogdXJsXG4gICAgICB9LCBjYik7XG4gICAgfTtcblxuXG5cbiAgICAvKipcbiAgICAgKiBTaW11bGF0ZSBhIFBPU1QgcmVxdWVzdCB0byBzYWlsc1xuICAgICAqIGUuZy5cbiAgICAgKiAgICBgc29ja2V0LnBvc3QoJy9ldmVudCcsIG5ld01lZXRpbmcsICRzcGlubmVyLmhpZGUpYFxuICAgICAqXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdXJsICAgIDo6ICAgIGRlc3RpbmF0aW9uIFVSTFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhICAgOjogICAgcGFyYW1ldGVycyB0byBzZW5kIHdpdGggdGhlIHJlcXVlc3QgW29wdGlvbmFsXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNiICAgOjogICAgY2FsbGJhY2sgZnVuY3Rpb24gdG8gY2FsbCB3aGVuIGZpbmlzaGVkIFtvcHRpb25hbF1cbiAgICAgKi9cblxuICAgIFNhaWxzU29ja2V0LnByb3RvdHlwZS5wb3N0ID0gZnVuY3Rpb24odXJsLCBkYXRhLCBjYikge1xuXG4gICAgICAvLyBgZGF0YWAgaXMgb3B0aW9uYWxcbiAgICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBjYiA9IGRhdGE7XG4gICAgICAgIGRhdGEgPSB7fTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdCh7XG4gICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICB1cmw6IHVybFxuICAgICAgfSwgY2IpO1xuICAgIH07XG5cblxuXG4gICAgLyoqXG4gICAgICogU2ltdWxhdGUgYSBQVVQgcmVxdWVzdCB0byBzYWlsc1xuICAgICAqIGUuZy5cbiAgICAgKiAgICBgc29ja2V0LnBvc3QoJy9ldmVudC8zJywgY2hhbmdlZEZpZWxkcywgJHNwaW5uZXIuaGlkZSlgXG4gICAgICpcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB1cmwgICAgOjogICAgZGVzdGluYXRpb24gVVJMXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEgICA6OiAgICBwYXJhbWV0ZXJzIHRvIHNlbmQgd2l0aCB0aGUgcmVxdWVzdCBbb3B0aW9uYWxdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2IgICA6OiAgICBjYWxsYmFjayBmdW5jdGlvbiB0byBjYWxsIHdoZW4gZmluaXNoZWQgW29wdGlvbmFsXVxuICAgICAqL1xuXG4gICAgU2FpbHNTb2NrZXQucHJvdG90eXBlLnB1dCA9IGZ1bmN0aW9uKHVybCwgZGF0YSwgY2IpIHtcblxuICAgICAgLy8gYGRhdGFgIGlzIG9wdGlvbmFsXG4gICAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgY2IgPSBkYXRhO1xuICAgICAgICBkYXRhID0ge307XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLnJlcXVlc3Qoe1xuICAgICAgICBtZXRob2Q6ICdwdXQnLFxuICAgICAgICBwYXJhbXM6IGRhdGEsXG4gICAgICAgIHVybDogdXJsXG4gICAgICB9LCBjYik7XG4gICAgfTtcblxuXG5cbiAgICAvKipcbiAgICAgKiBTaW11bGF0ZSBhIERFTEVURSByZXF1ZXN0IHRvIHNhaWxzXG4gICAgICogZS5nLlxuICAgICAqICAgIGBzb2NrZXQuZGVsZXRlKCcvZXZlbnQnLCAkc3Bpbm5lci5oaWRlKWBcbiAgICAgKlxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHVybCAgICA6OiAgICBkZXN0aW5hdGlvbiBVUkxcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSAgIDo6ICAgIHBhcmFtZXRlcnMgdG8gc2VuZCB3aXRoIHRoZSByZXF1ZXN0IFtvcHRpb25hbF1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYiAgIDo6ICAgIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBmaW5pc2hlZCBbb3B0aW9uYWxdXG4gICAgICovXG5cbiAgICBTYWlsc1NvY2tldC5wcm90b3R5cGVbJ2RlbGV0ZSddID0gZnVuY3Rpb24odXJsLCBkYXRhLCBjYikge1xuXG4gICAgICAvLyBgZGF0YWAgaXMgb3B0aW9uYWxcbiAgICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBjYiA9IGRhdGE7XG4gICAgICAgIGRhdGEgPSB7fTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdCh7XG4gICAgICAgIG1ldGhvZDogJ2RlbGV0ZScsXG4gICAgICAgIHBhcmFtczogZGF0YSxcbiAgICAgICAgdXJsOiB1cmxcbiAgICAgIH0sIGNiKTtcbiAgICB9O1xuXG5cblxuICAgIC8qKlxuICAgICAqIFNpbXVsYXRlIGFuIEhUVFAgcmVxdWVzdCB0byBzYWlsc1xuICAgICAqIGUuZy5cbiAgICAgKiBgYGBcbiAgICAgKiBzb2NrZXQucmVxdWVzdCh7XG4gICAgICogICB1cmw6Jy91c2VyJyxcbiAgICAgKiAgIHBhcmFtczoge30sXG4gICAgICogICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgKiAgIGhlYWRlcnM6IHt9XG4gICAgICogfSwgZnVuY3Rpb24gKHJlc3BvbnNlQm9keSwgSldSKSB7XG4gICAgICogICAvLyAuLi5cbiAgICAgKiB9KTtcbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICogQG9wdGlvbiB7U3RyaW5nfSB1cmwgICAgOjogICAgZGVzdGluYXRpb24gVVJMXG4gICAgICogQG9wdGlvbiB7T2JqZWN0fSBwYXJhbXMgOjogICAgcGFyYW1ldGVycyB0byBzZW5kIHdpdGggdGhlIHJlcXVlc3QgW29wdGlvbmFsXVxuICAgICAqIEBvcHRpb24ge09iamVjdH0gaGVhZGVyczo6ICAgIGhlYWRlcnMgdG8gc2VuZCB3aXRoIHRoZSByZXF1ZXN0IFtvcHRpb25hbF1cbiAgICAgKiBAb3B0aW9uIHtGdW5jdGlvbn0gY2IgICA6OiAgICBjYWxsYmFjayBmdW5jdGlvbiB0byBjYWxsIHdoZW4gZmluaXNoZWQgW29wdGlvbmFsXVxuICAgICAqIEBvcHRpb24ge1N0cmluZ30gbWV0aG9kIDo6ICAgIEhUVFAgcmVxdWVzdCBtZXRob2QgW29wdGlvbmFsXVxuICAgICAqL1xuXG4gICAgU2FpbHNTb2NrZXQucHJvdG90eXBlLnJlcXVlc3QgPSBmdW5jdGlvbihvcHRpb25zLCBjYikge1xuXG4gICAgICB2YXIgdXNhZ2UgPVxuICAgICAgJ1VzYWdlOlxcbicrXG4gICAgICAnc29ja2V0LnJlcXVlc3QoIG9wdGlvbnMsIFtmblRvQ2FsbFdoZW5Db21wbGV0ZV0gKVxcblxcbicrXG4gICAgICAnb3B0aW9ucy51cmwgOjogZS5nLiBcIi9mb28vYmFyXCInKydcXG4nK1xuICAgICAgJ29wdGlvbnMubWV0aG9kIDo6IGUuZy4gXCJnZXRcIiwgXCJwb3N0XCIsIFwicHV0XCIsIG9yIFwiZGVsZXRlXCIsIGV0Yy4nKydcXG4nK1xuICAgICAgJ29wdGlvbnMucGFyYW1zIDo6IGUuZy4geyBlbWFpbEFkZHJlc3M6IFwibWlrZUBzYWlsc2pzLm9yZ1wiIH0nKydcXG4nK1xuICAgICAgJ29wdGlvbnMuaGVhZGVycyA6OiBlLmcuIHsgXCJ4LW15LWN1c3RvbS1oZWFkZXJcIjogXCJzb21lIHN0cmluZ1wiIH0nO1xuICAgICAgLy8gT2xkIHVzYWdlOlxuICAgICAgLy8gdmFyIHVzYWdlID0gJ1VzYWdlOlxcbiBzb2NrZXQuJysob3B0aW9ucy5tZXRob2R8fCdyZXF1ZXN0JykrJygnK1xuICAgICAgLy8gICAnIGRlc3RpbmF0aW9uVVJMLCBbZGF0YVRvU2VuZF0sIFtmblRvQ2FsbFdoZW5Db21wbGV0ZV0gKSc7XG5cblxuICAgICAgLy8gVmFsaWRhdGUgb3B0aW9ucyBhbmQgY2FsbGJhY2tcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucyAhPT0gJ29iamVjdCcgfHwgdHlwZW9mIG9wdGlvbnMudXJsICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgb3IgbWlzc2luZyBVUkwhXFxuJyArIHVzYWdlKTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLm1ldGhvZCAmJiB0eXBlb2Ygb3B0aW9ucy5tZXRob2QgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBgbWV0aG9kYCBwcm92aWRlZCAoc2hvdWxkIGJlIGEgc3RyaW5nIGxpa2UgXCJwb3N0XCIgb3IgXCJwdXRcIilcXG4nICsgdXNhZ2UpO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMuaGVhZGVycyAmJiB0eXBlb2Ygb3B0aW9ucy5oZWFkZXJzICE9PSAnb2JqZWN0Jykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgYGhlYWRlcnNgIHByb3ZpZGVkIChzaG91bGQgYmUgYSBkaWN0aW9uYXJ5IHdpdGggc3RyaW5nIHZhbHVlcylcXG4nICsgdXNhZ2UpO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMucGFyYW1zICYmIHR5cGVvZiBvcHRpb25zLnBhcmFtcyAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGBwYXJhbXNgIHByb3ZpZGVkIChzaG91bGQgYmUgYSBkaWN0aW9uYXJ5IHdpdGggSlNPTi1zZXJpYWxpemFibGUgdmFsdWVzKVxcbicgKyB1c2FnZSk7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy5kYXRhICYmIHR5cGVvZiBvcHRpb25zLmRhdGEgIT09ICdvYmplY3QnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBgZGF0YWAgcHJvdmlkZWQgKHNob3VsZCBiZSBhIGRpY3Rpb25hcnkgd2l0aCBKU09OLXNlcmlhbGl6YWJsZSB2YWx1ZXMpXFxuJyArIHVzYWdlKTtcbiAgICAgIH1cbiAgICAgIGlmIChjYiAmJiB0eXBlb2YgY2IgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNhbGxiYWNrIGZ1bmN0aW9uIVxcbicgKyB1c2FnZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFjY2VwdCBlaXRoZXIgYHBhcmFtc2Agb3IgYGRhdGFgIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSAoYnV0IG5vdCBib3RoISlcbiAgICAgIGlmIChvcHRpb25zLmRhdGEgJiYgb3B0aW9ucy5wYXJhbXMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3Qgc3BlY2lmeSBib3RoIGBwYXJhbXNgIGFuZCBgZGF0YWAhICBUaGV5IGFyZSBhbGlhc2VzIG9mIGVhY2ggb3RoZXIuXFxuJyArIHVzYWdlKTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKG9wdGlvbnMuZGF0YSkge1xuICAgICAgICBvcHRpb25zLnBhcmFtcyA9IG9wdGlvbnMuZGF0YTtcbiAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YTtcbiAgICAgIH1cblxuXG4gICAgICAvLyBJZiB0aGlzIHNvY2tldCBpcyBub3QgY29ubmVjdGVkIHlldCwgcXVldWUgdXAgdGhpcyByZXF1ZXN0XG4gICAgICAvLyBpbnN0ZWFkIG9mIHNlbmRpbmcgaXQuXG4gICAgICAvLyAoc28gaXQgY2FuIGJlIHJlcGxheWVkIHdoZW4gdGhlIHNvY2tldCBjb21lcyBvbmxpbmUuKVxuICAgICAgaWYgKCAhIHRoaXMuaXNDb25uZWN0ZWQoKSApIHtcblxuICAgICAgICAvLyBJZiBubyBxdWV1ZSBhcnJheSBleGlzdHMgZm9yIHRoaXMgc29ja2V0IHlldCwgY3JlYXRlIGl0LlxuICAgICAgICB0aGlzLnJlcXVlc3RRdWV1ZSA9IHRoaXMucmVxdWVzdFF1ZXVlIHx8IFtdO1xuICAgICAgICB0aGlzLnJlcXVlc3RRdWV1ZS5wdXNoKFtvcHRpb25zLCBjYl0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIE90aGVyd2lzZSwgb3VyIHNvY2tldCBpcyBjb25uZWN0ZWQsIHNvIGNvbnRpbnVlIHByZXBwaW5nXG4gICAgICAvLyB0aGUgcmVxdWVzdC5cblxuICAgICAgLy8gRGVmYXVsdCBoZWFkZXJzIHRvIGFuIGVtcHR5IG9iamVjdFxuICAgICAgb3B0aW9ucy5oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzIHx8IHt9O1xuXG4gICAgICAvLyBCdWlsZCBhIHNpbXVsYXRlZCByZXF1ZXN0IG9iamVjdFxuICAgICAgLy8gKGFuZCBzYW5pdGl6ZS9tYXJzaGFsIG9wdGlvbnMgYWxvbmcgdGhlIHdheSlcbiAgICAgIHZhciByZXF1ZXN0Q3R4ID0ge1xuXG4gICAgICAgIG1ldGhvZDogb3B0aW9ucy5tZXRob2QudG9Mb3dlckNhc2UoKSB8fCAnZ2V0JyxcblxuICAgICAgICBoZWFkZXJzOiBvcHRpb25zLmhlYWRlcnMsXG5cbiAgICAgICAgZGF0YTogb3B0aW9ucy5wYXJhbXMgfHwgb3B0aW9ucy5kYXRhIHx8IHt9LFxuXG4gICAgICAgIC8vIFJlbW92ZSB0cmFpbGluZyBzbGFzaGVzIGFuZCBzcGFjZXMgdG8gbWFrZSBwYWNrZXRzIHNtYWxsZXIuXG4gICAgICAgIHVybDogb3B0aW9ucy51cmwucmVwbGFjZSgvXiguKylcXC8qXFxzKiQvLCAnJDEnKSxcblxuICAgICAgICBjYjogY2JcbiAgICAgIH07XG5cbiAgICAgIC8vIE1lcmdlIGdsb2JhbCBoZWFkZXJzIGluXG4gICAgICBpZiAodGhpcy5oZWFkZXJzICYmICdvYmplY3QnID09IHR5cGVvZiB0aGlzLmhlYWRlcnMpIHtcbiAgICAgICAgZm9yICh2YXIgaGVhZGVyIGluIHRoaXMuaGVhZGVycykge1xuICAgICAgICAgIGlmICghb3B0aW9ucy5oZWFkZXJzLmhhc093blByb3BlcnR5KGhlYWRlcikpIHtcbiAgICAgICAgICAgIG9wdGlvbnMuaGVhZGVyc1toZWFkZXJdID0gdGhpcy5oZWFkZXJzW2hlYWRlcl07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFNlbmQgdGhlIHJlcXVlc3QuXG4gICAgICBfZW1pdEZyb20odGhpcywgcmVxdWVzdEN0eCk7XG4gICAgfTtcblxuXG5cbiAgICAvKipcbiAgICAgKiBTb2NrZXQucHJvdG90eXBlLl9yZXF1ZXN0XG4gICAgICpcbiAgICAgKiBTaW11bGF0ZSBIVFRQIG92ZXIgU29ja2V0LmlvLlxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICogQHBhcmFtICB7W3R5cGVdfSAgIG9wdGlvbnMgW2Rlc2NyaXB0aW9uXVxuICAgICAqIEBwYXJhbSAge0Z1bmN0aW9ufSBjYiAgICAgIFtkZXNjcmlwdGlvbl1cbiAgICAgKi9cbiAgICBTYWlsc1NvY2tldC5wcm90b3R5cGUuX3JlcXVlc3QgPSBmdW5jdGlvbihvcHRpb25zLCBjYikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdgX3JlcXVlc3QoKWAgd2FzIGEgcHJpdmF0ZSBBUEkgZGVwcmVjYXRlZCBhcyBvZiB2MC4xMSBvZiB0aGUgc2FpbHMuaW8uanMgY2xpZW50LiBVc2UgYC5yZXF1ZXN0KClgIGluc3RlYWQuJyk7XG4gICAgfTtcblxuXG5cblxuXG5cblxuICAgIC8vICDilojilojilZcg4paI4paI4paI4paI4paI4paI4pWXICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilZcg4paI4paI4pWX4paI4paI4pWXICAgICDilojilojilojilojilojilojilojilZdcbiAgICAvLyAg4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4pWQ4paI4paI4pWXICAg4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWR4paI4paI4pWRICAgICDilojilojilZTilZDilZDilZDilZDilZ1cbiAgICAvLyAg4paI4paI4pWR4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4pWR4paI4paI4pWRICAgICDilojilojilojilojilojilojilojilZdcbiAgICAvLyAg4paI4paI4pWR4paI4paI4pWRICAg4paI4paI4pWRICAg4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4paI4paI4pWR4paI4paI4pWR4paI4paI4pWRICAgICDilZrilZDilZDilZDilZDilojilojilZFcbiAgICAvLyAg4paI4paI4pWR4pWa4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4pWRICDilojilojilZHilojilojilZHilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZFcbiAgICAvLyAg4pWa4pWQ4pWdIOKVmuKVkOKVkOKVkOKVkOKVkOKVnSDilZrilZDilZ3ilZrilZDilZDilZDilZDilZDilZDilZ3ilZrilZDilZ0gIOKVmuKVkOKVneKVmuKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVnVxuICAgIC8vXG4gICAgLy8gU2V0IGFuIGBpby5zYWlsc2Agb2JqZWN0IHRoYXQgbWF5IGJlIHVzZWQgZm9yIGNvbmZpZ3VyYXRpb24gYmVmb3JlIHRoZVxuICAgIC8vIGZpcnN0IHNvY2tldCBjb25uZWN0cyAoaS5lLiB0byBhbGxvdyBhdXRvLWNvbm5lY3QgYmVoYXZpb3IgdG8gYmVcbiAgICAvLyBwcmV2ZW50ZWQgYnkgc2V0dGluZyBgaW8uc2FpbHMuYXV0b0Nvbm5lY3RgIGluIGFuIGlubGluZSBzY3JpcHRcbiAgICAvLyBkaXJlY3RseSBhZnRlciB0aGUgc2NyaXB0IHRhZyB3aGljaCBsb2FkZWQgdGhpcyBmaWxlKS5cblxuXG4gICAgLy8gIOKUjOKUgOKUkOKUjOKUgOKUkOKUjOKUrOKUkCAg4pSsIOKUrOKUjOKUgOKUkCAg4pWU4pWm4pWX4pWU4pWQ4pWX4pWU4pWQ4pWX4pWU4pWQ4pWX4pWmIOKVpuKVpiDilZTilabilZfilZTilZDilZcgIOKUjOKUgOKUkOKUjOKUgOKUkOKUrOKUgOKUkCAg4pSs4pSM4pSA4pSQIOKUjOKUgOKUkOKUjOKUgOKUkOKUrOKUrCAg4pSM4pSA4pSQXG4gICAgLy8gIOKUlOKUgOKUkOKUnOKUpCAg4pSCICAg4pSCIOKUguKUnOKUgOKUmCAgIOKVkeKVkeKVkeKVoyDilaDilaMg4pWg4pWQ4pWj4pWRIOKVkeKVkSAg4pWRIOKVmuKVkOKVlyAg4pSc4pSkIOKUgiDilILilJzilKzilJggIOKUguKUgiDilIIg4pSU4pSA4pSQ4pSc4pSA4pSk4pSC4pSCICDilJTilIDilJBcbiAgICAvLyAg4pSU4pSA4pSY4pSU4pSA4pSYIOKUtCAgIOKUlOKUgOKUmOKUtCAgICDilZDilanilZ3ilZrilZDilZ3ilZogIOKVqSDilanilZrilZDilZ3ilanilZDilZ3ilakg4pWa4pWQ4pWdICDilJQgIOKUlOKUgOKUmOKUtOKUlOKUgCAg4pS04pSU4pSA4pSYb+KUlOKUgOKUmOKUtCDilLTilLTilLTilIDilJjilJTilIDilJhcbiAgICBpby5zYWlscyA9IHtcblxuICAgICAgLy8gV2hldGhlciB0byBhdXRvbWF0aWNhbGx5IGNvbm5lY3QgYSBzb2NrZXQgYW5kIHNhdmUgaXQgYXMgYGlvLnNvY2tldGAuXG4gICAgICBhdXRvQ29ubmVjdDogdHJ1ZSxcblxuICAgICAgLy8gVGhlIHJvdXRlIChwYXRoKSB0byBoaXQgdG8gZ2V0IGEgeC1vcmlnaW4gKENPUlMpIGNvb2tpZVxuICAgICAgLy8gKG9yIHRydWUgdG8gdXNlIHRoZSBkZWZhdWx0OiAnL19fZ2V0Y29va2llJylcbiAgICAgIHVzZUNPUlNSb3V0ZVRvR2V0Q29va2llOiB0cnVlLFxuXG4gICAgICAvLyBUaGUgZW52aXJvbm1lbnQgd2UncmUgcnVubmluZyBpbi5cbiAgICAgIC8vIChsb2dzIGFyZSBub3QgZGlzcGxheWVkIHdoZW4gdGhpcyBpcyBzZXQgdG8gJ3Byb2R1Y3Rpb24nKVxuICAgICAgLy9cbiAgICAgIC8vIERlZmF1bHRzIHRvIGRldmVsb3BtZW50IHVubGVzcyB0aGlzIHNjcmlwdCB3YXMgZmV0Y2hlZCBmcm9tIGEgVVJMXG4gICAgICAvLyB0aGF0IGVuZHMgaW4gYCoubWluLmpzYCBvciAnI3Byb2R1Y3Rpb24nIChtYXkgYWxzbyBiZSBtYW51YWxseSBvdmVycmlkZGVuLilcbiAgICAgIC8vXG4gICAgICBlbnZpcm9ubWVudDogdXJsVGhpc1NjcmlwdFdhc0ZldGNoZWRGcm9tLm1hdGNoKC8oXFwjcHJvZHVjdGlvbnxcXC5taW5cXC5qcykvZykgPyAncHJvZHVjdGlvbicgOiAnZGV2ZWxvcG1lbnQnLFxuXG4gICAgICAvLyBUaGUgdmVyc2lvbiBvZiB0aGlzIHNhaWxzLmlvLmpzIGNsaWVudCBTREtcbiAgICAgIHNkazogU0RLX0lORk8sXG5cbiAgICAgIC8vIFRyYW5zcG9ydHMgdG8gdXNlIHdoZW4gY29tbXVuaWNhdGluZyB3aXRoIHRoZSBzZXJ2ZXIsIGluIHRoZSBvcmRlciB0aGV5IHdpbGwgYmUgdHJpZWRcbiAgICAgIHRyYW5zcG9ydHM6IFsncG9sbGluZycsICd3ZWJzb2NrZXQnXVxuICAgIH07XG5cblxuXG4gICAgLy8gIOKUjOKUgOKUkOKUgOKUkCDilKzilIzilKzilJDilIzilIDilJDilIzilJDilIzilIzilKzilJAgIOKUrOKUjOKUgOKUkCDilIzilIDilJDilIzilIDilJDilKzilKwgIOKUjOKUgOKUkCAg4pSM4pSs4pSQ4pSM4pSA4pSQ4pSM4pSA4pSQ4pSM4pSA4pSQ4pSsIOKUrOKUrCDilIzilKzilJDilIzilIDilJBcbiAgICAvLyAg4pSc4pSkIOKUjOKUtOKUrOKUmCDilIIg4pSc4pSkIOKUguKUguKUgiDilILilIIgIOKUguKUgiDilIIg4pSU4pSA4pSQ4pSc4pSA4pSk4pSC4pSCICDilJTilIDilJAgICDilILilILilJzilKQg4pSc4pSkIOKUnOKUgOKUpOKUgiDilILilIIgIOKUgiDilJTilIDilJBcbiAgICAvLyAg4pSU4pSA4pSY4pS0IOKUlOKUgCDilLQg4pSU4pSA4pSY4pSY4pSU4pSY4pSA4pS04pSYICDilLTilJTilIDilJhv4pSU4pSA4pSY4pS0IOKUtOKUtOKUtOKUgOKUmOKUlOKUgOKUmCAg4pSA4pS04pSY4pSU4pSA4pSY4pSUICDilLQg4pS04pSU4pSA4pSY4pS04pSA4pSY4pS0IOKUlOKUgOKUmFxuICAgIC8vICDilKwg4pSs4pSs4pSM4pSs4pSQ4pSsIOKUrCAg4pSM4pSs4pSQ4pSsIOKUrOKUjOKUgOKUkCAg4pWmIOKVpuKVlOKVpuKVl+KVlOKVpuKVl+KVpiAgICDilZTilZDilZfilZTilabilZfilZTilabilZfilabilZDilZfilabilZTilZcg4pWmIOKVpuKVlOKVpuKVl+KVlOKVkOKVl+KVlOKVkOKVl1xuICAgIC8vICDilILilILilILilIIg4pSCIOKUnOKUgOKUpCAgIOKUgiDilJzilIDilKTilJzilKQgICDilaDilZDilaMg4pWRIOKVkeKVkeKVkeKVkSAgICDilaDilZDilaMg4pWRICDilZEg4pWg4pWm4pWd4pWR4pWg4pWp4pWX4pWRIOKVkSDilZEg4pWR4pWjIOKVmuKVkOKVl1xuICAgIC8vICDilJTilLTilJjilLQg4pS0IOKUtCDilLQgICDilLQg4pS0IOKUtOKUlOKUgOKUmCAg4pWpIOKVqSDilakg4pWpIOKVqeKVqeKVkOKVnSAg4pWpIOKVqSDilakgIOKVqSDilanilZrilZDilanilZrilZDilZ3ilZrilZDilZ0g4pWpIOKVmuKVkOKVneKVmuKVkOKVnVxuICAgIC8vICDilIzilIDilJDilKzilIDilJDilIzilIDilJDilIzilKzilJAgIOKUjOKUrOKUkOKUrCDilKzilIzilIDilJAgIOKUjOKUgOKUkOKUjOKUgOKUkOKUrOKUgOKUkOKUrOKUjOKUgOKUkOKUjOKUrOKUkCAg4pSM4pSs4pSQ4pSM4pSA4pSQ4pSM4pSA4pSQXG4gICAgLy8gIOKUnOKUpCDilJzilKzilJjilIIg4pSC4pSC4pSC4pSCICAg4pSCIOKUnOKUgOKUpOKUnOKUpCAgIOKUlOKUgOKUkOKUgiAg4pSc4pSs4pSY4pSC4pSc4pSA4pSYIOKUgiAgICDilIIg4pSc4pSA4pSk4pSCIOKUrFxuICAgIC8vICDilJQgIOKUtOKUlOKUgOKUlOKUgOKUmOKUtCDilLQgICDilLQg4pS0IOKUtOKUlOKUgOKUmCAg4pSU4pSA4pSY4pSU4pSA4pSY4pS04pSU4pSA4pS04pS0ICAg4pS0ICAgIOKUtCDilLQg4pS04pSU4pSA4pSYXG4gICAgLy9cbiAgICAvLyBOb3cgZm9sZCBpbiBjb25maWcgcHJvdmlkZWQgYXMgSFRNTCBhdHRyaWJ1dGVzIG9uIHRoZSBzY3JpcHQgdGFnOlxuICAgIC8vIChub3RlIHRoYXQgaWYgYGlvLnNhaWxzLipgIGlzIGNoYW5nZWQgYWZ0ZXIgdGhpcyBzY3JpcHQsIHRob3NlIGNoYW5nZXNcbiAgICAvLyAgd2lsbCBzdGlsbCB0YWtlIHByZWNlZGVuY2UpXG4gICAgQ09ORklHVVJBQkxFX1ZJQV9IVE1MX0FUVFIuZm9yRWFjaChmdW5jdGlvbiAoY29uZmlnS2V5KXtcbiAgICAgIGlmICh0eXBlb2Ygc2NyaXB0VGFnQ29uZmlnW2NvbmZpZ0tleV0gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGlvLnNhaWxzW2NvbmZpZ0tleV0gPSBzY3JpcHRUYWdDb25maWdbY29uZmlnS2V5XTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAvLyBOb3RlIHRoYXQgdGhlIG5ldyBIVE1MIGF0dHJpYnV0ZSBjb25maWd1cmF0aW9uIHN0eWxlIG1heSBldmVudHVhbGx5XG4gICAgLy8gY29tcGxldGVseSByZXBsYWNlIHRoZSBvcmlnaW5hbCBhcHByb2FjaCBvZiBzZXR0aW5nIGBpby5zYWlsc2AgcHJvcGVydGllcyxcbiAgICAvLyBzaW5jZSB0aGUgbmV3IHN0cmF0ZWd5IGlzIGVhc2llciB0byByZWFzb24gYWJvdXQuICBBbHNvLCBpdCB3b3VsZCBhbGxvdyB1c1xuICAgIC8vIHRvIHJlbW92ZSB0aGUgdGltZW91dCBiZWxvdyBzb21lZGF5LlxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cblxuXG4gICAgLy8gIOKUrOKUjOKUgOKUkCDilIzilIDilJDilIzilIDilJDilKzilKwgIOKUjOKUgOKUkCDilZTilZDilZfilZTilZDilZfilZTilZfilZTilZTilZfilZTilZTilZDilZfilZTilZDilZfilZTilabilZcgIC8gIFxcXG4gICAgLy8gIOKUguKUgiDilIIg4pSU4pSA4pSQ4pSc4pSA4pSk4pSC4pSCICDilJTilIDilJAg4pWRICDilZEg4pWR4pWR4pWR4pWR4pWR4pWR4pWR4pWR4pWjIOKVkSAgIOKVkSAgLyAgIC9cbiAgICAvLyAg4pS04pSU4pSA4pSYb+KUlOKUgOKUmOKUtCDilLTilLTilLTilIDilJjilJTilIDilJhv4pWa4pWQ4pWd4pWa4pWQ4pWd4pWd4pWa4pWd4pWd4pWa4pWd4pWa4pWQ4pWd4pWa4pWQ4pWdIOKVqSAgXFwgIC9cblxuICAgIC8qKlxuICAgICAqIEFkZCBgaW8uc2FpbHMuY29ubmVjdGAgZnVuY3Rpb24gYXMgYSB3cmFwcGVyIGZvciB0aGUgYnVpbHQtaW4gYGlvKClgIGFrYSBgaW8uY29ubmVjdCgpYFxuICAgICAqIG1ldGhvZCwgcmV0dXJuaW5nIGEgU2FpbHNTb2NrZXQuIFRoaXMgc3BlY2lhbCBmdW5jdGlvbiByZXNwZWN0cyB0aGUgY29uZmlndXJlZCBpby5zYWlsc1xuICAgICAqIGNvbm5lY3Rpb24gVVJMLCBhcyB3ZWxsIGFzIHNlbmRpbmcgb3RoZXIgaWRlbnRpZnlpbmcgaW5mb3JtYXRpb24gKG1vc3QgaW1wb3J0YW50bHksIHRoZVxuICAgICAqIGN1cnJlbnQgdmVyc2lvbiBvZiB0aGlzIFNESykuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtTdHJpbmd9IHVybCAgW29wdGlvbmFsXVxuICAgICAqIEBwYXJhbSAge09iamVjdH0gb3B0cyBbb3B0aW9uYWxdXG4gICAgICogQHJldHVybiB7U29ja2V0fVxuICAgICAqL1xuICAgIGlvLnNhaWxzLmNvbm5lY3QgPSBmdW5jdGlvbih1cmwsIG9wdHMpIHtcblxuICAgICAgLy8gTWFrZSBVUkwgb3B0aW9uYWxcbiAgICAgIGlmICgnb2JqZWN0JyA9PT0gdHlwZW9mIHVybCkge1xuICAgICAgICBvcHRzID0gdXJsO1xuICAgICAgICB1cmwgPSBudWxsO1xuICAgICAgfVxuXG4gICAgICAvLyBEZWZhdWx0IG9wdHMgdG8gZW1wdHkgb2JqZWN0XG4gICAgICBvcHRzID0gb3B0cyB8fCB7fTtcblxuICAgICAgLy8gSWYgZXhwbGljaXQgY29ubmVjdGlvbiB1cmwgaXMgc3BlY2lmaWVkLCBzYXZlIGl0IHRvIG9wdGlvbnNcbiAgICAgIG9wdHMudXJsID0gdXJsIHx8IG9wdHMudXJsIHx8IHVuZGVmaW5lZDtcblxuICAgICAgLy8gSW5zdGFudGlhdGUgYW5kIHJldHVybiBhIG5ldyBTYWlsc1NvY2tldC0gYW5kIHRyeSB0byBjb25uZWN0IGltbWVkaWF0ZWx5LlxuICAgICAgdmFyIHNvY2tldCA9IG5ldyBTYWlsc1NvY2tldChvcHRzKTtcbiAgICAgIHNvY2tldC5fY29ubmVjdCgpO1xuICAgICAgcmV0dXJuIHNvY2tldDtcbiAgICB9O1xuXG5cblxuXG5cblxuICAgIC8vICDilojilojilZcg4paI4paI4paI4paI4paI4paI4pWXICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilojilZcgIOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVlyAg4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4paI4pWXXG4gICAgLy8gIOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKWiOKWiOKVlyAgIOKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVkSDilojilojilZTilZ3ilojilojilZTilZDilZDilZDilZDilZ3ilZrilZDilZDilojilojilZTilZDilZDilZ1cbiAgICAvLyAg4paI4paI4pWR4paI4paI4pWRICAg4paI4paI4pWRICAg4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWRICAgICDilojilojilojilojilojilZTilZ0g4paI4paI4paI4paI4paI4pWXICAgICDilojilojilZFcbiAgICAvLyAg4paI4paI4pWR4paI4paI4pWRICAg4paI4paI4pWRICAg4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWR4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWRICAgICDilojilojilZTilZDilojilojilZcg4paI4paI4pWU4pWQ4pWQ4pWdICAgICDilojilojilZFcbiAgICAvLyAg4paI4paI4pWR4pWa4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWR4pWa4paI4paI4paI4paI4paI4paI4pWU4pWd4pWa4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWRICDilojilojilZfilojilojilojilojilojilojilojilZcgICDilojilojilZFcbiAgICAvLyAg4pWa4pWQ4pWdIOKVmuKVkOKVkOKVkOKVkOKVkOKVnSDilZrilZDilZ3ilZrilZDilZDilZDilZDilZDilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdICDilZrilZDilZDilZDilZDilZDilZ3ilZrilZDilZ0gIOKVmuKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVnSAgIOKVmuKVkOKVnVxuICAgIC8vXG4gICAgLy8gaW8uc29ja2V0XG4gICAgLy9cbiAgICAvLyBUaGUgZWFnZXIgaW5zdGFuY2Ugb2YgU29ja2V0IHdoaWNoIHdpbGwgYXV0b21hdGljYWxseSB0cnkgdG8gY29ubmVjdFxuICAgIC8vIHVzaW5nIHRoZSBob3N0IHRoYXQgdGhpcyBqcyBmaWxlIHdhcyBzZXJ2ZWQgZnJvbS5cbiAgICAvL1xuICAgIC8vIFRoaXMgY2FuIGJlIGRpc2FibGVkIG9yIGNvbmZpZ3VyZWQgYnkgc2V0dGluZyBwcm9wZXJ0aWVzIG9uIGBpby5zYWlscy4qYCB3aXRoaW4gdGhlXG4gICAgLy8gZmlyc3QgY3ljbGUgb2YgdGhlIGV2ZW50IGxvb3AuXG4gICAgLy9cblxuXG4gICAgLy8gQnVpbGQgYGlvLnNvY2tldGAgc28gaXQgZXhpc3RzXG4gICAgLy8gKG5vdGUgdGhhdCB0aGlzIERPRVMgTk9UIHN0YXJ0IHRoZSBjb25uZWN0aW9uIHByb2Nlc3MpXG4gICAgaW8uc29ja2V0ID0gbmV3IFNhaWxzU29ja2V0KCk7XG4gICAgLy9cbiAgICAvLyBUaGlzIHNvY2tldCBpcyBub3QgY29ubmVjdGVkIHlldCwgYW5kIGhhcyBub3QgZXZlbiBfc3RhcnRlZF8gY29ubmVjdGluZy5cbiAgICAvL1xuICAgIC8vIEJ1dCBpbiB0aGUgbWVhbiB0aW1lLCB0aGlzIGVhZ2VyIHNvY2tldCB3aWxsIGJlIHF1ZXVlIGV2ZW50cyBib3VuZCBieSB0aGUgdXNlclxuICAgIC8vIGJlZm9yZSB0aGUgZmlyc3QgY3ljbGUgb2YgdGhlIGV2ZW50IGxvb3AgKHVzaW5nIGAub24oKWApLCB3aGljaCB3aWxsIGxhdGVyXG4gICAgLy8gYmUgcmVib3VuZCBvbiB0aGUgcmF3IHVuZGVybHlpbmcgc29ja2V0LlxuXG5cbiAgICAvLyAg4pSM4pSA4pSQ4pSM4pSA4pSQ4pSM4pSs4pSQICDilIzilIDilJDilKwg4pSs4pSM4pSs4pSQ4pSM4pSA4pSQICAg4pSM4pSA4pSQ4pSM4pSA4pSQ4pSM4pSQ4pSM4pSM4pSQ4pSM4pSM4pSA4pSQ4pSM4pSA4pSQ4pSM4pSs4pSQICDilIzilKzilJDilKzilIzilKzilJDilIzilIDilJDilKzilIDilJBcbiAgICAvLyAg4pSU4pSA4pSQ4pSc4pSkICDilIIgICDilJzilIDilKTilIIg4pSCIOKUgiDilIIg4pSC4pSA4pSA4pSA4pSCICDilIIg4pSC4pSC4pSC4pSC4pSC4pSC4pSC4pSc4pSkIOKUgiAgIOKUgiAgICDilIIg4pSC4pSC4pSC4pSC4pSc4pSkIOKUnOKUrOKUmFxuICAgIC8vICDilJTilIDilJjilJTilIDilJgg4pS0ICAg4pS0IOKUtOKUlOKUgOKUmCDilLQg4pSU4pSA4pSYICAg4pSU4pSA4pSY4pSU4pSA4pSY4pSY4pSU4pSY4pSY4pSU4pSY4pSU4pSA4pSY4pSU4pSA4pSYIOKUtCAgICDilLQg4pS04pS0IOKUtOKUlOKUgOKUmOKUtOKUlOKUgFxuICAgIC8vIElmIGNvbmZpZ3VyZWQgdG8gZG8gc28sIHN0YXJ0IGF1dG8tY29ubmVjdGluZyBhZnRlciB0aGUgZmlyc3QgY3ljbGUgb2YgdGhlIGV2ZW50IGxvb3BcbiAgICAvLyBoYXMgY29tcGxldGVkICh0byBhbGxvdyB0aW1lIGZvciB0aGlzIGJlaGF2aW9yIHRvIGJlIGNvbmZpZ3VyZWQvZGlzYWJsZWRcbiAgICAvLyBieSBzcGVjaWZ5aW5nIHByb3BlcnRpZXMgb24gYGlvLnNhaWxzYClcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXG4gICAgICAvLyBJZiBhdXRvQ29ubmVjdCBpcyBkaXNhYmxlZCwgZGVsZXRlIHRoZSBlYWdlciBzb2NrZXQgKGlvLnNvY2tldCkgYW5kIGJhaWwgb3V0LlxuICAgICAgaWYgKGlvLnNhaWxzLmF1dG9Db25uZWN0ID09PSBmYWxzZSB8fCBpby5zYWlscy5hdXRvY29ubmVjdCA9PT0gZmFsc2UpIHtcbiAgICAgICAgZGVsZXRlIGlvLnNvY2tldDtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBjb25zb2xvZygnRWFnZXJseSBhdXRvLWNvbm5lY3Rpbmcgc29ja2V0IHRvIFNhaWxzLi4uIChyZXF1ZXN0cyB3aWxsIGJlIHF1ZXVlZCBpbiB0aGUgbWVhbi10aW1lKScpO1xuICAgICAgaW8uc29ja2V0Ll9jb25uZWN0KCk7XG5cblxuICAgIH0sIDApOyAvLyA8L3NldFRpbWVvdXQ+XG5cblxuICAgIC8vIFJldHVybiB0aGUgYGlvYCBvYmplY3QuXG4gICAgcmV0dXJuIGlvO1xuICB9IC8vPC9TYWlsc0lPQ2xpZW50PlxuXG4gIC8vXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAvLy8vLyA8L2J1bmNoZXMgb2YgcHJpdmF0ZSBmdW5jdGlvbiBkZWZpbml0aW9ucywgY29uc3RydWN0b3JzLCBhbmQgbWV0aG9kcz5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblxuXG5cbiAgLy8gIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVlyAg4paI4paI4pWX4paI4paI4paI4paI4paI4paI4pWXICDilojilojilojilojilojilojilZcg4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWXICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilZcgIOKWiOKWiOKVl1xuICAvLyAg4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4pWa4paI4paI4pWX4paI4paI4pWU4pWd4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWdICAgIOKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVkSDilojilojilZTilZ1cbiAgLy8gIOKWiOKWiOKWiOKWiOKWiOKVlyAgIOKVmuKWiOKWiOKWiOKVlOKVnSDilojilojilojilojilojilojilZTilZ3ilojilojilZEgICDilojilojilZHilojilojilojilojilojilojilojilZfilojilojilojilojilojilZcgICAgICDilojilojilojilojilojilojilojilZfilojilojilZEgIOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKVlOKVnVxuICAvLyAg4paI4paI4pWU4pWQ4pWQ4pWdICAg4paI4paI4pWU4paI4paI4pWXIOKWiOKWiOKVlOKVkOKVkOKVkOKVnSDilojilojilZEgICDilojilojilZHilZrilZDilZDilZDilZDilojilojilZHilojilojilZTilZDilZDilZ0gICAgICDilZrilZDilZDilZDilZDilojilojilZHilojilojilZEgIOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKWiOKWiOKVl1xuICAvLyAg4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4pWU4pWdIOKWiOKWiOKVl+KWiOKWiOKVkSAgICAg4pWa4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWXICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkSAg4paI4paI4pWXXG4gIC8vICDilZrilZDilZDilZDilZDilZDilZDilZ3ilZrilZDilZ0gIOKVmuKVkOKVneKVmuKVkOKVnSAgICAgIOKVmuKVkOKVkOKVkOKVkOKVkOKVnSDilZrilZDilZDilZDilZDilZDilZDilZ3ilZrilZDilZDilZDilZDilZDilZDilZ0gICAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVnSAg4pWa4pWQ4pWdXG4gIC8vXG5cblxuICAvLyBBZGQgQ29tbW9uSlMgc3VwcG9ydCB0byBhbGxvdyB0aGlzIGNsaWVudCBTREsgdG8gYmUgdXNlZCBmcm9tIE5vZGUuanMuXG4gIGlmIChTREtfSU5GTy5wbGF0Zm9ybSA9PT0gJ25vZGUnKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBTYWlsc0lPQ2xpZW50O1xuICB9XG4gIC8vIEFkZCBBTUQgc3VwcG9ydCwgcmVnaXN0ZXJpbmcgdGhpcyBjbGllbnQgU0RLIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG4gIGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShbXSwgZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gU2FpbHNJT0NsaWVudDtcbiAgICB9KTtcbiAgfVxuICBlbHNlIHtcbiAgICAvLyBPdGhlcndpc2UsIHRyeSB0byBpbnN0YW50aWF0ZSB0aGUgY2xpZW50IHVzaW5nIHRoZSBnbG9iYWwgYGlvYDpcbiAgICBTYWlsc0lPQ2xpZW50KCk7XG5cbiAgICAvLyBOb3RlOlxuICAgIC8vIElmIHlvdSBhcmUgbW9kaWZ5aW5nIHRoaXMgZmlsZSBtYW51YWxseSB0byB3cmFwIGFuIGV4aXN0aW5nIHNvY2tldC5pbyBjbGllbnRcbiAgICAvLyAoZS5nLiB0byBwcmV2ZW50IHBvbGx1dGlvbiBvZiB0aGUgZ2xvYmFsIG5hbWVzcGFjZSksIHlvdSBjYW4gcmVwbGFjZSB0aGUgZ2xvYmFsXG4gICAgLy8gYGlvYCB3aXRoIHlvdXIgb3duIGBpb2AgaW5zdGFuY2UgYWJvdmUuXG4gIH1cblxufSkoKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3NhaWxzLmlvLmpzL3NhaWxzLmlvLmpzXG4gKiogbW9kdWxlIGlkID0gMjdcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGU+XFxuICA8IS0tIFJlc3BvbnNpdmUgc2lkZWJhciBtZW51IC0tPlxcbiAgPGRpdiBjbGFzcz1cXFwidWkgc2lkZWJhciBpbnZlcnRlZCB2ZXJ0aWNhbCBtZW51XFxcIj5cXG4gICAgPGEgY2xhc3M9XFxcIml0ZW1cXFwiIGNsaWNrLmRlbGVnYXRlPVxcXCJsb2dvdXQoKVxcXCI+XFxuICAgICAgPGg0IGNsYXNzPVxcXCJ1aSBncmV5IGhlYWRlclxcXCI+JHt1c2VyLnVzZXJuYW1lfTwvaDQ+XFxuICAgICAgPHA+U2lnbiBPdXQ8L3A+XFxuICAgIDwvYT5cXG4gICAgPGEgcmVwZWF0LmZvcj1cXFwicm93IG9mIHJvdXRlci5uYXZpZ2F0aW9uXFxcIiBocmVmLmJpbmQ9XFxcInJvdy5ocmVmXFxcIlxcbiAgICAgICBjbGFzcz1cXFwiaXRlbSAke3Jvdy5pc0FjdGl2ZSA/ICdhY3RpdmUnIDogJyd9XFxcIj5cXG4gICAgICA8aSBjbGFzcz1cXFwidWkgaWNvbiAke3Jvdy5zZXR0aW5ncy5pY29ufVxcXCI+PC9pPiR7cm93LnRpdGxlfVxcbiAgICA8L2E+XFxuICA8L2Rpdj5cXG5cXG4gIDxkaXYgY2xhc3M9XFxcInB1c2hlclxcXCI+XFxuICAgIDxkaXYgY2xhc3M9XFxcInVpIGFjdGl2ZSBpbnZlcnRlZCBkaW1tZXJcXFwiIGlmLmJpbmQ9XFxcInJvdXRlci5pc05hdmlnYXRpbmdcXFwiPlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcInVpIGxhcmdlIHRleHQgbG9hZGVyXFxcIj5Mb2FkaW5nPC9kaXY+XFxuICAgIDwvZGl2PlxcbiAgICA8cD48L3A+XFxuICAgIDxwPjwvcD5cXG4gICAgPHA+PC9wPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJ1aSBjb250YWluZXJcXFwiPlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcInVpIGxlZnQgZml4ZWQgdmVydGljYWwgaW52ZXJ0ZWQgbWVudVxcXCI+XFxuICAgICAgICA8YSBjbGFzcz1cXFwiaXRlbVxcXCIgY2xpY2suZGVsZWdhdGU9XFxcImxvZ291dCgpXFxcIj5cXG4gICAgICAgICAgPGg0IGNsYXNzPVxcXCJ1aSBncmV5IGhlYWRlclxcXCI+JHt1c2VyLnVzZXJuYW1lfTwvaDQ+XFxuICAgICAgICAgIDxwPlNpZ24gT3V0PC9wPlxcbiAgICAgICAgPC9hPlxcbiAgICAgICAgPGEgcmVwZWF0LmZvcj1cXFwicm93IG9mIHJvdXRlci5uYXZpZ2F0aW9uXFxcIiBocmVmLmJpbmQ9XFxcInJvdy5ocmVmXFxcIlxcbiAgICAgICAgICAgY2xhc3M9XFxcInVpIGl0ZW0gJHtyb3cuaXNBY3RpdmUgPyAnYWN0aXZlJyA6ICcnfVxcXCI+XFxuICAgICAgICAgIDxpIGNsYXNzPVxcXCJ1aSBpY29uICR7cm93LnNldHRpbmdzLmljb259XFxcIj48L2k+JHtyb3cudGl0bGV9XFxuICAgICAgICA8L2E+XFxuICAgICAgPC9kaXY+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwidWkgbWFpbiBncmlkXFxcIiBpZD1cXFwibWFpblZpZXdcXFwiPlxcbiAgICAgICAgPCEtLSBSZXNwb25zaXZlIHRvcCBtZW51IC0tPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwidWkgZml4ZWQgaW52ZXJ0ZWQgbWFpbiBtZW51XFxcIj5cXG4gICAgICAgICAgPGRpdiBjbGFzcz1cXFwidWkgY29udGFpbmVyXFxcIj5cXG4gICAgICAgICAgICA8YSBjbGFzcz1cXFwibGF1bmNoIGljb24gaXRlbSBzaWRlYmFyLXRvZ2dsZVxcXCI+XFxuICAgICAgICAgICAgICA8aSBjbGFzcz1cXFwic2lkZWJhciBpY29uXFxcIj48L2k+XFxuICAgICAgICAgICAgPC9hPlxcbiAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgICAgPHJvdXRlci12aWV3IGNsYXNzPVxcXCJzaXh0ZWVuIHdpZGUgY29sdW1uXFxcIj48L3JvdXRlci12aWV3PlxcbiAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG4gIDwvZGl2PlxcbjwvdGVtcGxhdGU+XFxuXCI7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9hcHAuaHRtbFxuICoqIG1vZHVsZSBpZCA9IDI4XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLkNzc0FuaW1hdG9yID0gdW5kZWZpbmVkO1xuZXhwb3J0cy5jb25maWd1cmUgPSBjb25maWd1cmU7XG5cbnZhciBfYXVyZWxpYVRlbXBsYXRpbmcgPSByZXF1aXJlKCdhdXJlbGlhLXRlbXBsYXRpbmcnKTtcblxudmFyIF9hdXJlbGlhUGFsID0gcmVxdWlyZSgnYXVyZWxpYS1wYWwnKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIENzc0FuaW1hdG9yID0gZXhwb3J0cy5Dc3NBbmltYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQ3NzQW5pbWF0b3IoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENzc0FuaW1hdG9yKTtcblxuICAgIHRoaXMudXNlQW5pbWF0aW9uRG9uZUNsYXNzZXMgPSBmYWxzZTtcbiAgICB0aGlzLmFuaW1hdGlvbkVudGVyZWRDbGFzcyA9ICdhdS1lbnRlcmVkJztcbiAgICB0aGlzLmFuaW1hdGlvbkxlZnRDbGFzcyA9ICdhdS1sZWZ0JztcbiAgICB0aGlzLmlzQW5pbWF0aW5nID0gZmFsc2U7XG5cbiAgICB0aGlzLnZlcmlmeUtleWZyYW1lc0V4aXN0ID0gdHJ1ZTtcbiAgfVxuXG4gIENzc0FuaW1hdG9yLnByb3RvdHlwZS5fYWRkTXVsdGlwbGVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gX2FkZE11bHRpcGxlRXZlbnRMaXN0ZW5lcihlbCwgcywgZm4pIHtcbiAgICB2YXIgZXZ0cyA9IHMuc3BsaXQoJyAnKTtcbiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBldnRzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoZXZ0c1tpXSwgZm4sIGZhbHNlKTtcbiAgICB9XG4gIH07XG5cbiAgQ3NzQW5pbWF0b3IucHJvdG90eXBlLl9nZXRFbGVtZW50QW5pbWF0aW9uRGVsYXkgPSBmdW5jdGlvbiBfZ2V0RWxlbWVudEFuaW1hdGlvbkRlbGF5KGVsZW1lbnQpIHtcbiAgICB2YXIgc3R5bCA9IF9hdXJlbGlhUGFsLkRPTS5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpO1xuICAgIHZhciBwcm9wID0gdm9pZCAwO1xuICAgIHZhciBkZWxheSA9IHZvaWQgMDtcblxuICAgIGlmIChzdHlsLmdldFByb3BlcnR5VmFsdWUoJ2FuaW1hdGlvbi1kZWxheScpKSB7XG4gICAgICBwcm9wID0gJ2FuaW1hdGlvbi1kZWxheSc7XG4gICAgfSBlbHNlIGlmIChzdHlsLmdldFByb3BlcnR5VmFsdWUoJy13ZWJraXQtYW5pbWF0aW9uLWRlbGF5JykpIHtcbiAgICAgIHByb3AgPSAnLXdlYmtpdC1hbmltYXRpb24tZGVsYXknO1xuICAgIH0gZWxzZSBpZiAoc3R5bC5nZXRQcm9wZXJ0eVZhbHVlKCctbW96LWFuaW1hdGlvbi1kZWxheScpKSB7XG4gICAgICBwcm9wID0gJy1tb3otYW5pbWF0aW9uLWRlbGF5JztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgZGVsYXkgPSBzdHlsLmdldFByb3BlcnR5VmFsdWUocHJvcCk7XG4gICAgZGVsYXkgPSBOdW1iZXIoZGVsYXkucmVwbGFjZSgvW15cXGRcXC5dL2csICcnKSk7XG5cbiAgICByZXR1cm4gZGVsYXkgKiAxMDAwO1xuICB9O1xuXG4gIENzc0FuaW1hdG9yLnByb3RvdHlwZS5fZ2V0RWxlbWVudEFuaW1hdGlvbk5hbWVzID0gZnVuY3Rpb24gX2dldEVsZW1lbnRBbmltYXRpb25OYW1lcyhlbGVtZW50KSB7XG4gICAgdmFyIHN0eWwgPSBfYXVyZWxpYVBhbC5ET00uZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTtcbiAgICB2YXIgcHJlZml4ID0gdm9pZCAwO1xuXG4gICAgaWYgKHN0eWwuZ2V0UHJvcGVydHlWYWx1ZSgnYW5pbWF0aW9uLW5hbWUnKSkge1xuICAgICAgcHJlZml4ID0gJyc7XG4gICAgfSBlbHNlIGlmIChzdHlsLmdldFByb3BlcnR5VmFsdWUoJy13ZWJraXQtYW5pbWF0aW9uLW5hbWUnKSkge1xuICAgICAgcHJlZml4ID0gJy13ZWJraXQtJztcbiAgICB9IGVsc2UgaWYgKHN0eWwuZ2V0UHJvcGVydHlWYWx1ZSgnLW1vei1hbmltYXRpb24tbmFtZScpKSB7XG4gICAgICBwcmVmaXggPSAnLW1vei0nO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgdmFyIGFuaW1hdGlvbk5hbWVzID0gc3R5bC5nZXRQcm9wZXJ0eVZhbHVlKHByZWZpeCArICdhbmltYXRpb24tbmFtZScpO1xuICAgIHJldHVybiBhbmltYXRpb25OYW1lcyA/IGFuaW1hdGlvbk5hbWVzLnNwbGl0KCcgJykgOiBbXTtcbiAgfTtcblxuICBDc3NBbmltYXRvci5wcm90b3R5cGUuX3BlcmZvcm1TaW5nbGVBbmltYXRlID0gZnVuY3Rpb24gX3BlcmZvcm1TaW5nbGVBbmltYXRlKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB0aGlzLl90cmlnZ2VyRE9NRXZlbnQoX2F1cmVsaWFUZW1wbGF0aW5nLmFuaW1hdGlvbkV2ZW50LmFuaW1hdGVCZWdpbiwgZWxlbWVudCk7XG5cbiAgICByZXR1cm4gdGhpcy5hZGRDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUsIHRydWUpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgX3RoaXMuX3RyaWdnZXJET01FdmVudChfYXVyZWxpYVRlbXBsYXRpbmcuYW5pbWF0aW9uRXZlbnQuYW5pbWF0ZUFjdGl2ZSwgZWxlbWVudCk7XG5cbiAgICAgIGlmIChyZXN1bHQgIT09IGZhbHNlKSB7XG4gICAgICAgIHJldHVybiBfdGhpcy5yZW1vdmVDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUsIHRydWUpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF90aGlzLl90cmlnZ2VyRE9NRXZlbnQoX2F1cmVsaWFUZW1wbGF0aW5nLmFuaW1hdGlvbkV2ZW50LmFuaW1hdGVEb25lLCBlbGVtZW50KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpcy5fdHJpZ2dlckRPTUV2ZW50KF9hdXJlbGlhVGVtcGxhdGluZy5hbmltYXRpb25FdmVudC5hbmltYXRlVGltZW91dCwgZWxlbWVudCk7XG4gICAgfSk7XG4gIH07XG5cbiAgQ3NzQW5pbWF0b3IucHJvdG90eXBlLl90cmlnZ2VyRE9NRXZlbnQgPSBmdW5jdGlvbiBfdHJpZ2dlckRPTUV2ZW50KGV2ZW50VHlwZSwgZWxlbWVudCkge1xuICAgIHZhciBldnQgPSBfYXVyZWxpYVBhbC5ET00uY3JlYXRlQ3VzdG9tRXZlbnQoZXZlbnRUeXBlLCB7IGJ1YmJsZXM6IHRydWUsIGNhbmNlbGFibGU6IHRydWUsIGRldGFpbDogZWxlbWVudCB9KTtcbiAgICBfYXVyZWxpYVBhbC5ET00uZGlzcGF0Y2hFdmVudChldnQpO1xuICB9O1xuXG4gIENzc0FuaW1hdG9yLnByb3RvdHlwZS5fYW5pbWF0aW9uQ2hhbmdlV2l0aFZhbGlkS2V5ZnJhbWUgPSBmdW5jdGlvbiBfYW5pbWF0aW9uQ2hhbmdlV2l0aFZhbGlkS2V5ZnJhbWUoYW5pbWF0aW9uTmFtZXMsIHByZXZBbmltYXRpb25OYW1lcykge1xuICAgIHZhciBuZXdBbmltYXRpb25OYW1lcyA9IGFuaW1hdGlvbk5hbWVzLmZpbHRlcihmdW5jdGlvbiAobmFtZSkge1xuICAgICAgcmV0dXJuIHByZXZBbmltYXRpb25OYW1lcy5pbmRleE9mKG5hbWUpID09PSAtMTtcbiAgICB9KTtcblxuICAgIGlmIChuZXdBbmltYXRpb25OYW1lcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMudmVyaWZ5S2V5ZnJhbWVzRXhpc3QpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHZhciBrZXlmcmFtZXNSdWxlVHlwZSA9IHdpbmRvdy5DU1NSdWxlLktFWUZSQU1FU19SVUxFIHx8IHdpbmRvdy5DU1NSdWxlLk1PWl9LRVlGUkFNRVNfUlVMRSB8fCB3aW5kb3cuQ1NTUnVsZS5XRUJLSVRfS0VZRlJBTUVTX1JVTEU7XG5cbiAgICB2YXIgc3R5bGVTaGVldHMgPSBkb2N1bWVudC5zdHlsZVNoZWV0cztcblxuICAgIHRyeSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0eWxlU2hlZXRzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIHZhciBjc3NSdWxlcyA9IHN0eWxlU2hlZXRzW2ldLmNzc1J1bGVzO1xuXG4gICAgICAgIGlmICghY3NzUnVsZXMpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgY3NzUnVsZXMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICB2YXIgY3NzUnVsZSA9IGNzc1J1bGVzW2pdO1xuXG4gICAgICAgICAgaWYgKGNzc1J1bGUudHlwZSA9PT0ga2V5ZnJhbWVzUnVsZVR5cGUpIHtcbiAgICAgICAgICAgIGlmIChuZXdBbmltYXRpb25OYW1lcy5pbmRleE9mKGNzc1J1bGUubmFtZSkgIT09IC0xKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHt9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgQ3NzQW5pbWF0b3IucHJvdG90eXBlLmFuaW1hdGUgPSBmdW5jdGlvbiBhbmltYXRlKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZWxlbWVudCkpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChlbGVtZW50Lm1hcChmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgcmV0dXJuIF90aGlzMi5fcGVyZm9ybVNpbmdsZUFuaW1hdGUoZWwsIGNsYXNzTmFtZSk7XG4gICAgICB9KSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuX3BlcmZvcm1TaW5nbGVBbmltYXRlKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG4gIH07XG5cbiAgQ3NzQW5pbWF0b3IucHJvdG90eXBlLnJ1blNlcXVlbmNlID0gZnVuY3Rpb24gcnVuU2VxdWVuY2UoYW5pbWF0aW9ucykge1xuICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgdGhpcy5fdHJpZ2dlckRPTUV2ZW50KF9hdXJlbGlhVGVtcGxhdGluZy5hbmltYXRpb25FdmVudC5zZXF1ZW5jZUJlZ2luLCBudWxsKTtcblxuICAgIHJldHVybiBhbmltYXRpb25zLnJlZHVjZShmdW5jdGlvbiAocCwgYW5pbSkge1xuICAgICAgcmV0dXJuIHAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfdGhpczMuYW5pbWF0ZShhbmltLmVsZW1lbnQsIGFuaW0uY2xhc3NOYW1lKTtcbiAgICAgIH0pO1xuICAgIH0sIFByb21pc2UucmVzb2x2ZSh0cnVlKSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpczMuX3RyaWdnZXJET01FdmVudChfYXVyZWxpYVRlbXBsYXRpbmcuYW5pbWF0aW9uRXZlbnQuc2VxdWVuY2VEb25lLCBudWxsKTtcbiAgICB9KTtcbiAgfTtcblxuICBDc3NBbmltYXRvci5wcm90b3R5cGUuZW50ZXIgPSBmdW5jdGlvbiBlbnRlcihlbGVtZW50KSB7XG4gICAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIGNsYXNzTGlzdCA9IGVsZW1lbnQuY2xhc3NMaXN0O1xuXG4gICAgICBfdGhpczQuX3RyaWdnZXJET01FdmVudChfYXVyZWxpYVRlbXBsYXRpbmcuYW5pbWF0aW9uRXZlbnQuZW50ZXJCZWdpbiwgZWxlbWVudCk7XG5cbiAgICAgIGlmIChfdGhpczQudXNlQW5pbWF0aW9uRG9uZUNsYXNzZXMpIHtcbiAgICAgICAgY2xhc3NMaXN0LnJlbW92ZShfdGhpczQuYW5pbWF0aW9uRW50ZXJlZENsYXNzKTtcbiAgICAgICAgY2xhc3NMaXN0LnJlbW92ZShfdGhpczQuYW5pbWF0aW9uTGVmdENsYXNzKTtcbiAgICAgIH1cblxuICAgICAgY2xhc3NMaXN0LmFkZCgnYXUtZW50ZXInKTtcbiAgICAgIHZhciBwcmV2QW5pbWF0aW9uTmFtZXMgPSBfdGhpczQuX2dldEVsZW1lbnRBbmltYXRpb25OYW1lcyhlbGVtZW50KTtcblxuICAgICAgdmFyIF9hbmltU3RhcnQgPSB2b2lkIDA7XG4gICAgICB2YXIgYW5pbUhhc1N0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgIF90aGlzNC5fYWRkTXVsdGlwbGVFdmVudExpc3RlbmVyKGVsZW1lbnQsICd3ZWJraXRBbmltYXRpb25TdGFydCBhbmltYXRpb25zdGFydCcsIF9hbmltU3RhcnQgPSBmdW5jdGlvbiBhbmltU3RhcnQoZXZBbmltU3RhcnQpIHtcbiAgICAgICAgYW5pbUhhc1N0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICBfdGhpczQuaXNBbmltYXRpbmcgPSB0cnVlO1xuXG4gICAgICAgIF90aGlzNC5fdHJpZ2dlckRPTUV2ZW50KF9hdXJlbGlhVGVtcGxhdGluZy5hbmltYXRpb25FdmVudC5lbnRlckFjdGl2ZSwgZWxlbWVudCk7XG5cbiAgICAgICAgZXZBbmltU3RhcnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgZXZBbmltU3RhcnQudGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZBbmltU3RhcnQudHlwZSwgX2FuaW1TdGFydCk7XG4gICAgICB9LCBmYWxzZSk7XG5cbiAgICAgIHZhciBfYW5pbUVuZCA9IHZvaWQgMDtcbiAgICAgIF90aGlzNC5fYWRkTXVsdGlwbGVFdmVudExpc3RlbmVyKGVsZW1lbnQsICd3ZWJraXRBbmltYXRpb25FbmQgYW5pbWF0aW9uZW5kJywgX2FuaW1FbmQgPSBmdW5jdGlvbiBhbmltRW5kKGV2QW5pbUVuZCkge1xuICAgICAgICBpZiAoIWFuaW1IYXNTdGFydGVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZXZBbmltRW5kLnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIGNsYXNzTGlzdC5yZW1vdmUoJ2F1LWVudGVyLWFjdGl2ZScpO1xuICAgICAgICBjbGFzc0xpc3QucmVtb3ZlKCdhdS1lbnRlcicpO1xuXG4gICAgICAgIGV2QW5pbUVuZC50YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldkFuaW1FbmQudHlwZSwgX2FuaW1FbmQpO1xuXG4gICAgICAgIGlmIChfdGhpczQudXNlQW5pbWF0aW9uRG9uZUNsYXNzZXMgJiYgX3RoaXM0LmFuaW1hdGlvbkVudGVyZWRDbGFzcyAhPT0gdW5kZWZpbmVkICYmIF90aGlzNC5hbmltYXRpb25FbnRlcmVkQ2xhc3MgIT09IG51bGwpIHtcbiAgICAgICAgICBjbGFzc0xpc3QuYWRkKF90aGlzNC5hbmltYXRpb25FbnRlcmVkQ2xhc3MpO1xuICAgICAgICB9XG5cbiAgICAgICAgX3RoaXM0LmlzQW5pbWF0aW5nID0gZmFsc2U7XG4gICAgICAgIF90aGlzNC5fdHJpZ2dlckRPTUV2ZW50KF9hdXJlbGlhVGVtcGxhdGluZy5hbmltYXRpb25FdmVudC5lbnRlckRvbmUsIGVsZW1lbnQpO1xuXG4gICAgICAgIHJlc29sdmUodHJ1ZSk7XG4gICAgICB9LCBmYWxzZSk7XG5cbiAgICAgIHZhciBwYXJlbnQgPSBlbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgICB2YXIgZGVsYXkgPSAwO1xuXG4gICAgICB2YXIgY2xlYW51cEFuaW1hdGlvbiA9IGZ1bmN0aW9uIGNsZWFudXBBbmltYXRpb24oKSB7XG4gICAgICAgIHZhciBhbmltYXRpb25OYW1lcyA9IF90aGlzNC5fZ2V0RWxlbWVudEFuaW1hdGlvbk5hbWVzKGVsZW1lbnQpO1xuICAgICAgICBpZiAoIV90aGlzNC5fYW5pbWF0aW9uQ2hhbmdlV2l0aFZhbGlkS2V5ZnJhbWUoYW5pbWF0aW9uTmFtZXMsIHByZXZBbmltYXRpb25OYW1lcykpIHtcbiAgICAgICAgICBjbGFzc0xpc3QucmVtb3ZlKCdhdS1lbnRlci1hY3RpdmUnKTtcbiAgICAgICAgICBjbGFzc0xpc3QucmVtb3ZlKCdhdS1lbnRlcicpO1xuICAgICAgICAgIF90aGlzNC5fdHJpZ2dlckRPTUV2ZW50KF9hdXJlbGlhVGVtcGxhdGluZy5hbmltYXRpb25FdmVudC5lbnRlclRpbWVvdXQsIGVsZW1lbnQpO1xuICAgICAgICAgIHJlc29sdmUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBpZiAocGFyZW50ICE9PSBudWxsICYmIHBhcmVudCAhPT0gdW5kZWZpbmVkICYmIChwYXJlbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdhdS1zdGFnZ2VyJykgfHwgcGFyZW50LmNsYXNzTGlzdC5jb250YWlucygnYXUtc3RhZ2dlci1lbnRlcicpKSkge1xuICAgICAgICB2YXIgZWxlbVBvcyA9IEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwocGFyZW50LmNoaWxkcmVuLCBlbGVtZW50KTtcbiAgICAgICAgZGVsYXkgPSBfdGhpczQuX2dldEVsZW1lbnRBbmltYXRpb25EZWxheShwYXJlbnQpICogZWxlbVBvcztcblxuICAgICAgICBfdGhpczQuX3RyaWdnZXJET01FdmVudChfYXVyZWxpYVRlbXBsYXRpbmcuYW5pbWF0aW9uRXZlbnQuc3RhZ2dlck5leHQsIGVsZW1lbnQpO1xuXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGNsYXNzTGlzdC5hZGQoJ2F1LWVudGVyLWFjdGl2ZScpO1xuICAgICAgICAgIGNsZWFudXBBbmltYXRpb24oKTtcbiAgICAgICAgfSwgZGVsYXkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2xhc3NMaXN0LmFkZCgnYXUtZW50ZXItYWN0aXZlJyk7XG4gICAgICAgIGNsZWFudXBBbmltYXRpb24oKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBDc3NBbmltYXRvci5wcm90b3R5cGUubGVhdmUgPSBmdW5jdGlvbiBsZWF2ZShlbGVtZW50KSB7XG4gICAgdmFyIF90aGlzNSA9IHRoaXM7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIGNsYXNzTGlzdCA9IGVsZW1lbnQuY2xhc3NMaXN0O1xuXG4gICAgICBfdGhpczUuX3RyaWdnZXJET01FdmVudChfYXVyZWxpYVRlbXBsYXRpbmcuYW5pbWF0aW9uRXZlbnQubGVhdmVCZWdpbiwgZWxlbWVudCk7XG5cbiAgICAgIGlmIChfdGhpczUudXNlQW5pbWF0aW9uRG9uZUNsYXNzZXMpIHtcbiAgICAgICAgY2xhc3NMaXN0LnJlbW92ZShfdGhpczUuYW5pbWF0aW9uRW50ZXJlZENsYXNzKTtcbiAgICAgICAgY2xhc3NMaXN0LnJlbW92ZShfdGhpczUuYW5pbWF0aW9uTGVmdENsYXNzKTtcbiAgICAgIH1cblxuICAgICAgY2xhc3NMaXN0LmFkZCgnYXUtbGVhdmUnKTtcbiAgICAgIHZhciBwcmV2QW5pbWF0aW9uTmFtZXMgPSBfdGhpczUuX2dldEVsZW1lbnRBbmltYXRpb25OYW1lcyhlbGVtZW50KTtcblxuICAgICAgdmFyIF9hbmltU3RhcnQyID0gdm9pZCAwO1xuICAgICAgdmFyIGFuaW1IYXNTdGFydGVkID0gZmFsc2U7XG4gICAgICBfdGhpczUuX2FkZE11bHRpcGxlRXZlbnRMaXN0ZW5lcihlbGVtZW50LCAnd2Via2l0QW5pbWF0aW9uU3RhcnQgYW5pbWF0aW9uc3RhcnQnLCBfYW5pbVN0YXJ0MiA9IGZ1bmN0aW9uIGFuaW1TdGFydChldkFuaW1TdGFydCkge1xuICAgICAgICBhbmltSGFzU3RhcnRlZCA9IHRydWU7XG4gICAgICAgIF90aGlzNS5pc0FuaW1hdGluZyA9IHRydWU7XG5cbiAgICAgICAgX3RoaXM1Ll90cmlnZ2VyRE9NRXZlbnQoX2F1cmVsaWFUZW1wbGF0aW5nLmFuaW1hdGlvbkV2ZW50LmxlYXZlQWN0aXZlLCBlbGVtZW50KTtcblxuICAgICAgICBldkFuaW1TdGFydC5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICBldkFuaW1TdGFydC50YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldkFuaW1TdGFydC50eXBlLCBfYW5pbVN0YXJ0Mik7XG4gICAgICB9LCBmYWxzZSk7XG5cbiAgICAgIHZhciBfYW5pbUVuZDIgPSB2b2lkIDA7XG4gICAgICBfdGhpczUuX2FkZE11bHRpcGxlRXZlbnRMaXN0ZW5lcihlbGVtZW50LCAnd2Via2l0QW5pbWF0aW9uRW5kIGFuaW1hdGlvbmVuZCcsIF9hbmltRW5kMiA9IGZ1bmN0aW9uIGFuaW1FbmQoZXZBbmltRW5kKSB7XG4gICAgICAgIGlmICghYW5pbUhhc1N0YXJ0ZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBldkFuaW1FbmQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgY2xhc3NMaXN0LnJlbW92ZSgnYXUtbGVhdmUtYWN0aXZlJyk7XG4gICAgICAgIGNsYXNzTGlzdC5yZW1vdmUoJ2F1LWxlYXZlJyk7XG5cbiAgICAgICAgZXZBbmltRW5kLnRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKGV2QW5pbUVuZC50eXBlLCBfYW5pbUVuZDIpO1xuXG4gICAgICAgIGlmIChfdGhpczUudXNlQW5pbWF0aW9uRG9uZUNsYXNzZXMgJiYgX3RoaXM1LmFuaW1hdGlvbkxlZnRDbGFzcyAhPT0gdW5kZWZpbmVkICYmIF90aGlzNS5hbmltYXRpb25MZWZ0Q2xhc3MgIT09IG51bGwpIHtcbiAgICAgICAgICBjbGFzc0xpc3QuYWRkKF90aGlzNS5hbmltYXRpb25MZWZ0Q2xhc3MpO1xuICAgICAgICB9XG5cbiAgICAgICAgX3RoaXM1LmlzQW5pbWF0aW5nID0gZmFsc2U7XG4gICAgICAgIF90aGlzNS5fdHJpZ2dlckRPTUV2ZW50KF9hdXJlbGlhVGVtcGxhdGluZy5hbmltYXRpb25FdmVudC5sZWF2ZURvbmUsIGVsZW1lbnQpO1xuXG4gICAgICAgIHJlc29sdmUodHJ1ZSk7XG4gICAgICB9LCBmYWxzZSk7XG5cbiAgICAgIHZhciBwYXJlbnQgPSBlbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgICB2YXIgZGVsYXkgPSAwO1xuXG4gICAgICB2YXIgY2xlYW51cEFuaW1hdGlvbiA9IGZ1bmN0aW9uIGNsZWFudXBBbmltYXRpb24oKSB7XG4gICAgICAgIHZhciBhbmltYXRpb25OYW1lcyA9IF90aGlzNS5fZ2V0RWxlbWVudEFuaW1hdGlvbk5hbWVzKGVsZW1lbnQpO1xuICAgICAgICBpZiAoIV90aGlzNS5fYW5pbWF0aW9uQ2hhbmdlV2l0aFZhbGlkS2V5ZnJhbWUoYW5pbWF0aW9uTmFtZXMsIHByZXZBbmltYXRpb25OYW1lcykpIHtcbiAgICAgICAgICBjbGFzc0xpc3QucmVtb3ZlKCdhdS1sZWF2ZS1hY3RpdmUnKTtcbiAgICAgICAgICBjbGFzc0xpc3QucmVtb3ZlKCdhdS1sZWF2ZScpO1xuICAgICAgICAgIF90aGlzNS5fdHJpZ2dlckRPTUV2ZW50KF9hdXJlbGlhVGVtcGxhdGluZy5hbmltYXRpb25FdmVudC5sZWF2ZVRpbWVvdXQsIGVsZW1lbnQpO1xuICAgICAgICAgIHJlc29sdmUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBpZiAocGFyZW50ICE9PSBudWxsICYmIHBhcmVudCAhPT0gdW5kZWZpbmVkICYmIChwYXJlbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdhdS1zdGFnZ2VyJykgfHwgcGFyZW50LmNsYXNzTGlzdC5jb250YWlucygnYXUtc3RhZ2dlci1sZWF2ZScpKSkge1xuICAgICAgICB2YXIgZWxlbVBvcyA9IEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwocGFyZW50LmNoaWxkcmVuLCBlbGVtZW50KTtcbiAgICAgICAgZGVsYXkgPSBfdGhpczUuX2dldEVsZW1lbnRBbmltYXRpb25EZWxheShwYXJlbnQpICogZWxlbVBvcztcblxuICAgICAgICBfdGhpczUuX3RyaWdnZXJET01FdmVudChfYXVyZWxpYVRlbXBsYXRpbmcuYW5pbWF0aW9uRXZlbnQuc3RhZ2dlck5leHQsIGVsZW1lbnQpO1xuXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGNsYXNzTGlzdC5hZGQoJ2F1LWxlYXZlLWFjdGl2ZScpO1xuICAgICAgICAgIGNsZWFudXBBbmltYXRpb24oKTtcbiAgICAgICAgfSwgZGVsYXkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2xhc3NMaXN0LmFkZCgnYXUtbGVhdmUtYWN0aXZlJyk7XG4gICAgICAgIGNsZWFudXBBbmltYXRpb24oKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBDc3NBbmltYXRvci5wcm90b3R5cGUucmVtb3ZlQ2xhc3MgPSBmdW5jdGlvbiByZW1vdmVDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpIHtcbiAgICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICAgIHZhciBzdXBwcmVzc0V2ZW50cyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMiB8fCBhcmd1bWVudHNbMl0gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzJdO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHZhciBjbGFzc0xpc3QgPSBlbGVtZW50LmNsYXNzTGlzdDtcblxuICAgICAgaWYgKCFjbGFzc0xpc3QuY29udGFpbnMoY2xhc3NOYW1lKSAmJiAhY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSArICctYWRkJykpIHtcbiAgICAgICAgcmVzb2x2ZShmYWxzZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKHN1cHByZXNzRXZlbnRzICE9PSB0cnVlKSB7XG4gICAgICAgIF90aGlzNi5fdHJpZ2dlckRPTUV2ZW50KF9hdXJlbGlhVGVtcGxhdGluZy5hbmltYXRpb25FdmVudC5yZW1vdmVDbGFzc0JlZ2luLCBlbGVtZW50KTtcbiAgICAgIH1cblxuICAgICAgY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xuICAgICAgdmFyIHByZXZBbmltYXRpb25OYW1lcyA9IF90aGlzNi5fZ2V0RWxlbWVudEFuaW1hdGlvbk5hbWVzKGVsZW1lbnQpO1xuXG4gICAgICB2YXIgX2FuaW1TdGFydDMgPSB2b2lkIDA7XG4gICAgICB2YXIgYW5pbUhhc1N0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgIF90aGlzNi5fYWRkTXVsdGlwbGVFdmVudExpc3RlbmVyKGVsZW1lbnQsICd3ZWJraXRBbmltYXRpb25TdGFydCBhbmltYXRpb25zdGFydCcsIF9hbmltU3RhcnQzID0gZnVuY3Rpb24gYW5pbVN0YXJ0KGV2QW5pbVN0YXJ0KSB7XG4gICAgICAgIGFuaW1IYXNTdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgX3RoaXM2LmlzQW5pbWF0aW5nID0gdHJ1ZTtcblxuICAgICAgICBpZiAoc3VwcHJlc3NFdmVudHMgIT09IHRydWUpIHtcbiAgICAgICAgICBfdGhpczYuX3RyaWdnZXJET01FdmVudChfYXVyZWxpYVRlbXBsYXRpbmcuYW5pbWF0aW9uRXZlbnQucmVtb3ZlQ2xhc3NBY3RpdmUsIGVsZW1lbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgZXZBbmltU3RhcnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgZXZBbmltU3RhcnQudGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZBbmltU3RhcnQudHlwZSwgX2FuaW1TdGFydDMpO1xuICAgICAgfSwgZmFsc2UpO1xuXG4gICAgICB2YXIgX2FuaW1FbmQzID0gdm9pZCAwO1xuICAgICAgX3RoaXM2Ll9hZGRNdWx0aXBsZUV2ZW50TGlzdGVuZXIoZWxlbWVudCwgJ3dlYmtpdEFuaW1hdGlvbkVuZCBhbmltYXRpb25lbmQnLCBfYW5pbUVuZDMgPSBmdW5jdGlvbiBhbmltRW5kKGV2QW5pbUVuZCkge1xuICAgICAgICBpZiAoIWFuaW1IYXNTdGFydGVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZXZBbmltRW5kLnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIGNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lICsgJy1yZW1vdmUnKTtcblxuICAgICAgICBldkFuaW1FbmQudGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZBbmltRW5kLnR5cGUsIF9hbmltRW5kMyk7XG5cbiAgICAgICAgX3RoaXM2LmlzQW5pbWF0aW5nID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHN1cHByZXNzRXZlbnRzICE9PSB0cnVlKSB7XG4gICAgICAgICAgX3RoaXM2Ll90cmlnZ2VyRE9NRXZlbnQoX2F1cmVsaWFUZW1wbGF0aW5nLmFuaW1hdGlvbkV2ZW50LnJlbW92ZUNsYXNzRG9uZSwgZWxlbWVudCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgfSwgZmFsc2UpO1xuXG4gICAgICBjbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSArICctcmVtb3ZlJyk7XG5cbiAgICAgIHZhciBhbmltYXRpb25OYW1lcyA9IF90aGlzNi5fZ2V0RWxlbWVudEFuaW1hdGlvbk5hbWVzKGVsZW1lbnQpO1xuICAgICAgaWYgKCFfdGhpczYuX2FuaW1hdGlvbkNoYW5nZVdpdGhWYWxpZEtleWZyYW1lKGFuaW1hdGlvbk5hbWVzLCBwcmV2QW5pbWF0aW9uTmFtZXMpKSB7XG4gICAgICAgIGNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lICsgJy1yZW1vdmUnKTtcbiAgICAgICAgY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xuXG4gICAgICAgIGlmIChzdXBwcmVzc0V2ZW50cyAhPT0gdHJ1ZSkge1xuICAgICAgICAgIF90aGlzNi5fdHJpZ2dlckRPTUV2ZW50KF9hdXJlbGlhVGVtcGxhdGluZy5hbmltYXRpb25FdmVudC5yZW1vdmVDbGFzc1RpbWVvdXQsIGVsZW1lbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVzb2x2ZShmYWxzZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgQ3NzQW5pbWF0b3IucHJvdG90eXBlLmFkZENsYXNzID0gZnVuY3Rpb24gYWRkQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gICAgdmFyIF90aGlzNyA9IHRoaXM7XG5cbiAgICB2YXIgc3VwcHJlc3NFdmVudHMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDIgfHwgYXJndW1lbnRzWzJdID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IGFyZ3VtZW50c1syXTtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgY2xhc3NMaXN0ID0gZWxlbWVudC5jbGFzc0xpc3Q7XG5cbiAgICAgIGlmIChzdXBwcmVzc0V2ZW50cyAhPT0gdHJ1ZSkge1xuICAgICAgICBfdGhpczcuX3RyaWdnZXJET01FdmVudChfYXVyZWxpYVRlbXBsYXRpbmcuYW5pbWF0aW9uRXZlbnQuYWRkQ2xhc3NCZWdpbiwgZWxlbWVudCk7XG4gICAgICB9XG5cbiAgICAgIHZhciBfYW5pbVN0YXJ0NCA9IHZvaWQgMDtcbiAgICAgIHZhciBhbmltSGFzU3RhcnRlZCA9IGZhbHNlO1xuICAgICAgX3RoaXM3Ll9hZGRNdWx0aXBsZUV2ZW50TGlzdGVuZXIoZWxlbWVudCwgJ3dlYmtpdEFuaW1hdGlvblN0YXJ0IGFuaW1hdGlvbnN0YXJ0JywgX2FuaW1TdGFydDQgPSBmdW5jdGlvbiBhbmltU3RhcnQoZXZBbmltU3RhcnQpIHtcbiAgICAgICAgYW5pbUhhc1N0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICBfdGhpczcuaXNBbmltYXRpbmcgPSB0cnVlO1xuXG4gICAgICAgIGlmIChzdXBwcmVzc0V2ZW50cyAhPT0gdHJ1ZSkge1xuICAgICAgICAgIF90aGlzNy5fdHJpZ2dlckRPTUV2ZW50KF9hdXJlbGlhVGVtcGxhdGluZy5hbmltYXRpb25FdmVudC5hZGRDbGFzc0FjdGl2ZSwgZWxlbWVudCk7XG4gICAgICAgIH1cblxuICAgICAgICBldkFuaW1TdGFydC5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICBldkFuaW1TdGFydC50YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldkFuaW1TdGFydC50eXBlLCBfYW5pbVN0YXJ0NCk7XG4gICAgICB9LCBmYWxzZSk7XG5cbiAgICAgIHZhciBfYW5pbUVuZDQgPSB2b2lkIDA7XG4gICAgICBfdGhpczcuX2FkZE11bHRpcGxlRXZlbnRMaXN0ZW5lcihlbGVtZW50LCAnd2Via2l0QW5pbWF0aW9uRW5kIGFuaW1hdGlvbmVuZCcsIF9hbmltRW5kNCA9IGZ1bmN0aW9uIGFuaW1FbmQoZXZBbmltRW5kKSB7XG4gICAgICAgIGlmICghYW5pbUhhc1N0YXJ0ZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBldkFuaW1FbmQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xuXG4gICAgICAgIGNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lICsgJy1hZGQnKTtcblxuICAgICAgICBldkFuaW1FbmQudGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZBbmltRW5kLnR5cGUsIF9hbmltRW5kNCk7XG5cbiAgICAgICAgX3RoaXM3LmlzQW5pbWF0aW5nID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHN1cHByZXNzRXZlbnRzICE9PSB0cnVlKSB7XG4gICAgICAgICAgX3RoaXM3Ll90cmlnZ2VyRE9NRXZlbnQoX2F1cmVsaWFUZW1wbGF0aW5nLmFuaW1hdGlvbkV2ZW50LmFkZENsYXNzRG9uZSwgZWxlbWVudCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgfSwgZmFsc2UpO1xuXG4gICAgICB2YXIgcHJldkFuaW1hdGlvbk5hbWVzID0gX3RoaXM3Ll9nZXRFbGVtZW50QW5pbWF0aW9uTmFtZXMoZWxlbWVudCk7XG5cbiAgICAgIGNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lICsgJy1hZGQnKTtcblxuICAgICAgdmFyIGFuaW1hdGlvbk5hbWVzID0gX3RoaXM3Ll9nZXRFbGVtZW50QW5pbWF0aW9uTmFtZXMoZWxlbWVudCk7XG4gICAgICBpZiAoIV90aGlzNy5fYW5pbWF0aW9uQ2hhbmdlV2l0aFZhbGlkS2V5ZnJhbWUoYW5pbWF0aW9uTmFtZXMsIHByZXZBbmltYXRpb25OYW1lcykpIHtcbiAgICAgICAgY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUgKyAnLWFkZCcpO1xuICAgICAgICBjbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XG5cbiAgICAgICAgaWYgKHN1cHByZXNzRXZlbnRzICE9PSB0cnVlKSB7XG4gICAgICAgICAgX3RoaXM3Ll90cmlnZ2VyRE9NRXZlbnQoX2F1cmVsaWFUZW1wbGF0aW5nLmFuaW1hdGlvbkV2ZW50LmFkZENsYXNzVGltZW91dCwgZWxlbWVudCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXNvbHZlKGZhbHNlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4gQ3NzQW5pbWF0b3I7XG59KCk7XG5cbmZ1bmN0aW9uIGNvbmZpZ3VyZShjb25maWcsIGNhbGxiYWNrKSB7XG4gIHZhciBhbmltYXRvciA9IGNvbmZpZy5jb250YWluZXIuZ2V0KENzc0FuaW1hdG9yKTtcbiAgY29uZmlnLmNvbnRhaW5lci5nZXQoX2F1cmVsaWFUZW1wbGF0aW5nLlRlbXBsYXRpbmdFbmdpbmUpLmNvbmZpZ3VyZUFuaW1hdG9yKGFuaW1hdG9yKTtcbiAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGNhbGxiYWNrKGFuaW1hdG9yKTtcbiAgfVxufVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtYW5pbWF0b3ItY3NzL2Rpc3QvY29tbW9uanMvYXVyZWxpYS1hbmltYXRvci1jc3MuanNcbiAqKiBtb2R1bGUgaWQgPSAyOVxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5Ccm93c2VySGlzdG9yeSA9IGV4cG9ydHMuRGVmYXVsdExpbmtIYW5kbGVyID0gZXhwb3J0cy5MaW5rSGFuZGxlciA9IHVuZGVmaW5lZDtcblxudmFyIF9jbGFzcywgX3RlbXA7XG5cbmV4cG9ydHMuY29uZmlndXJlID0gY29uZmlndXJlO1xuXG52YXIgX2F1cmVsaWFQYWwgPSByZXF1aXJlKCdhdXJlbGlhLXBhbCcpO1xuXG52YXIgX2F1cmVsaWFIaXN0b3J5ID0gcmVxdWlyZSgnYXVyZWxpYS1oaXN0b3J5Jyk7XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIExpbmtIYW5kbGVyID0gZXhwb3J0cy5MaW5rSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gTGlua0hhbmRsZXIoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExpbmtIYW5kbGVyKTtcbiAgfVxuXG4gIExpbmtIYW5kbGVyLnByb3RvdHlwZS5hY3RpdmF0ZSA9IGZ1bmN0aW9uIGFjdGl2YXRlKGhpc3RvcnkpIHt9O1xuXG4gIExpbmtIYW5kbGVyLnByb3RvdHlwZS5kZWFjdGl2YXRlID0gZnVuY3Rpb24gZGVhY3RpdmF0ZSgpIHt9O1xuXG4gIHJldHVybiBMaW5rSGFuZGxlcjtcbn0oKTtcblxudmFyIERlZmF1bHRMaW5rSGFuZGxlciA9IGV4cG9ydHMuRGVmYXVsdExpbmtIYW5kbGVyID0gZnVuY3Rpb24gKF9MaW5rSGFuZGxlcikge1xuICBfaW5oZXJpdHMoRGVmYXVsdExpbmtIYW5kbGVyLCBfTGlua0hhbmRsZXIpO1xuXG4gIGZ1bmN0aW9uIERlZmF1bHRMaW5rSGFuZGxlcigpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGVmYXVsdExpbmtIYW5kbGVyKTtcblxuICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9MaW5rSGFuZGxlci5jYWxsKHRoaXMpKTtcblxuICAgIF90aGlzLmhhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdmFyIF9EZWZhdWx0TGlua0hhbmRsZXIkZyA9IERlZmF1bHRMaW5rSGFuZGxlci5nZXRFdmVudEluZm8oZSk7XG5cbiAgICAgIHZhciBzaG91bGRIYW5kbGVFdmVudCA9IF9EZWZhdWx0TGlua0hhbmRsZXIkZy5zaG91bGRIYW5kbGVFdmVudDtcbiAgICAgIHZhciBocmVmID0gX0RlZmF1bHRMaW5rSGFuZGxlciRnLmhyZWY7XG5cblxuICAgICAgaWYgKHNob3VsZEhhbmRsZUV2ZW50KSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgX3RoaXMuaGlzdG9yeS5uYXZpZ2F0ZShocmVmKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIERlZmF1bHRMaW5rSGFuZGxlci5wcm90b3R5cGUuYWN0aXZhdGUgPSBmdW5jdGlvbiBhY3RpdmF0ZShoaXN0b3J5KSB7XG4gICAgaWYgKGhpc3RvcnkuX2hhc1B1c2hTdGF0ZSkge1xuICAgICAgdGhpcy5oaXN0b3J5ID0gaGlzdG9yeTtcbiAgICAgIF9hdXJlbGlhUGFsLkRPTS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuaGFuZGxlciwgdHJ1ZSk7XG4gICAgfVxuICB9O1xuXG4gIERlZmF1bHRMaW5rSGFuZGxlci5wcm90b3R5cGUuZGVhY3RpdmF0ZSA9IGZ1bmN0aW9uIGRlYWN0aXZhdGUoKSB7XG4gICAgX2F1cmVsaWFQYWwuRE9NLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVyKTtcbiAgfTtcblxuICBEZWZhdWx0TGlua0hhbmRsZXIuZ2V0RXZlbnRJbmZvID0gZnVuY3Rpb24gZ2V0RXZlbnRJbmZvKGV2ZW50KSB7XG4gICAgdmFyIGluZm8gPSB7XG4gICAgICBzaG91bGRIYW5kbGVFdmVudDogZmFsc2UsXG4gICAgICBocmVmOiBudWxsLFxuICAgICAgYW5jaG9yOiBudWxsXG4gICAgfTtcblxuICAgIHZhciB0YXJnZXQgPSBEZWZhdWx0TGlua0hhbmRsZXIuZmluZENsb3Nlc3RBbmNob3IoZXZlbnQudGFyZ2V0KTtcbiAgICBpZiAoIXRhcmdldCB8fCAhRGVmYXVsdExpbmtIYW5kbGVyLnRhcmdldElzVGhpc1dpbmRvdyh0YXJnZXQpKSB7XG4gICAgICByZXR1cm4gaW5mbztcbiAgICB9XG5cbiAgICBpZiAoZXZlbnQuYWx0S2V5IHx8IGV2ZW50LmN0cmxLZXkgfHwgZXZlbnQubWV0YUtleSB8fCBldmVudC5zaGlmdEtleSkge1xuICAgICAgcmV0dXJuIGluZm87XG4gICAgfVxuXG4gICAgdmFyIGhyZWYgPSB0YXJnZXQuZ2V0QXR0cmlidXRlKCdocmVmJyk7XG4gICAgaW5mby5hbmNob3IgPSB0YXJnZXQ7XG4gICAgaW5mby5ocmVmID0gaHJlZjtcblxuICAgIHZhciBsZWZ0QnV0dG9uQ2xpY2tlZCA9IGV2ZW50LndoaWNoID09PSAxO1xuICAgIHZhciBpc1JlbGF0aXZlID0gaHJlZiAmJiAhKGhyZWYuY2hhckF0KDApID09PSAnIycgfHwgL15bYS16XSs6L2kudGVzdChocmVmKSk7XG5cbiAgICBpbmZvLnNob3VsZEhhbmRsZUV2ZW50ID0gbGVmdEJ1dHRvbkNsaWNrZWQgJiYgaXNSZWxhdGl2ZTtcbiAgICByZXR1cm4gaW5mbztcbiAgfTtcblxuICBEZWZhdWx0TGlua0hhbmRsZXIuZmluZENsb3Nlc3RBbmNob3IgPSBmdW5jdGlvbiBmaW5kQ2xvc2VzdEFuY2hvcihlbCkge1xuICAgIHdoaWxlIChlbCkge1xuICAgICAgaWYgKGVsLnRhZ05hbWUgPT09ICdBJykge1xuICAgICAgICByZXR1cm4gZWw7XG4gICAgICB9XG5cbiAgICAgIGVsID0gZWwucGFyZW50Tm9kZTtcbiAgICB9XG4gIH07XG5cbiAgRGVmYXVsdExpbmtIYW5kbGVyLnRhcmdldElzVGhpc1dpbmRvdyA9IGZ1bmN0aW9uIHRhcmdldElzVGhpc1dpbmRvdyh0YXJnZXQpIHtcbiAgICB2YXIgdGFyZ2V0V2luZG93ID0gdGFyZ2V0LmdldEF0dHJpYnV0ZSgndGFyZ2V0Jyk7XG4gICAgdmFyIHdpbiA9IF9hdXJlbGlhUGFsLlBMQVRGT1JNLmdsb2JhbDtcblxuICAgIHJldHVybiAhdGFyZ2V0V2luZG93IHx8IHRhcmdldFdpbmRvdyA9PT0gd2luLm5hbWUgfHwgdGFyZ2V0V2luZG93ID09PSAnX3NlbGYnIHx8IHRhcmdldFdpbmRvdyA9PT0gJ3RvcCcgJiYgd2luID09PSB3aW4udG9wO1xuICB9O1xuXG4gIHJldHVybiBEZWZhdWx0TGlua0hhbmRsZXI7XG59KExpbmtIYW5kbGVyKTtcblxuZnVuY3Rpb24gY29uZmlndXJlKGNvbmZpZykge1xuICBjb25maWcuc2luZ2xldG9uKF9hdXJlbGlhSGlzdG9yeS5IaXN0b3J5LCBCcm93c2VySGlzdG9yeSk7XG4gIGNvbmZpZy50cmFuc2llbnQoTGlua0hhbmRsZXIsIERlZmF1bHRMaW5rSGFuZGxlcik7XG59XG5cbnZhciBCcm93c2VySGlzdG9yeSA9IGV4cG9ydHMuQnJvd3Nlckhpc3RvcnkgPSAoX3RlbXAgPSBfY2xhc3MgPSBmdW5jdGlvbiAoX0hpc3RvcnkpIHtcbiAgX2luaGVyaXRzKEJyb3dzZXJIaXN0b3J5LCBfSGlzdG9yeSk7XG5cbiAgZnVuY3Rpb24gQnJvd3Nlckhpc3RvcnkobGlua0hhbmRsZXIpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQnJvd3Nlckhpc3RvcnkpO1xuXG4gICAgdmFyIF90aGlzMiA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9IaXN0b3J5LmNhbGwodGhpcykpO1xuXG4gICAgX3RoaXMyLl9pc0FjdGl2ZSA9IGZhbHNlO1xuICAgIF90aGlzMi5fY2hlY2tVcmxDYWxsYmFjayA9IF90aGlzMi5fY2hlY2tVcmwuYmluZChfdGhpczIpO1xuXG4gICAgX3RoaXMyLmxvY2F0aW9uID0gX2F1cmVsaWFQYWwuUExBVEZPUk0ubG9jYXRpb247XG4gICAgX3RoaXMyLmhpc3RvcnkgPSBfYXVyZWxpYVBhbC5QTEFURk9STS5oaXN0b3J5O1xuICAgIF90aGlzMi5saW5rSGFuZGxlciA9IGxpbmtIYW5kbGVyO1xuICAgIHJldHVybiBfdGhpczI7XG4gIH1cblxuICBCcm93c2VySGlzdG9yeS5wcm90b3R5cGUuYWN0aXZhdGUgPSBmdW5jdGlvbiBhY3RpdmF0ZShvcHRpb25zKSB7XG4gICAgaWYgKHRoaXMuX2lzQWN0aXZlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0hpc3RvcnkgaGFzIGFscmVhZHkgYmVlbiBhY3RpdmF0ZWQuJyk7XG4gICAgfVxuXG4gICAgdmFyIHdhbnRzUHVzaFN0YXRlID0gISFvcHRpb25zLnB1c2hTdGF0ZTtcblxuICAgIHRoaXMuX2lzQWN0aXZlID0gdHJ1ZTtcbiAgICB0aGlzLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCB7IHJvb3Q6ICcvJyB9LCB0aGlzLm9wdGlvbnMsIG9wdGlvbnMpO1xuXG4gICAgdGhpcy5yb290ID0gKCcvJyArIHRoaXMub3B0aW9ucy5yb290ICsgJy8nKS5yZXBsYWNlKHJvb3RTdHJpcHBlciwgJy8nKTtcblxuICAgIHRoaXMuX3dhbnRzSGFzaENoYW5nZSA9IHRoaXMub3B0aW9ucy5oYXNoQ2hhbmdlICE9PSBmYWxzZTtcbiAgICB0aGlzLl9oYXNQdXNoU3RhdGUgPSAhISh0aGlzLm9wdGlvbnMucHVzaFN0YXRlICYmIHRoaXMuaGlzdG9yeSAmJiB0aGlzLmhpc3RvcnkucHVzaFN0YXRlKTtcblxuICAgIHZhciBldmVudE5hbWUgPSB2b2lkIDA7XG4gICAgaWYgKHRoaXMuX2hhc1B1c2hTdGF0ZSkge1xuICAgICAgZXZlbnROYW1lID0gJ3BvcHN0YXRlJztcbiAgICB9IGVsc2UgaWYgKHRoaXMuX3dhbnRzSGFzaENoYW5nZSkge1xuICAgICAgZXZlbnROYW1lID0gJ2hhc2hjaGFuZ2UnO1xuICAgIH1cblxuICAgIF9hdXJlbGlhUGFsLlBMQVRGT1JNLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCB0aGlzLl9jaGVja1VybENhbGxiYWNrKTtcblxuICAgIGlmICh0aGlzLl93YW50c0hhc2hDaGFuZ2UgJiYgd2FudHNQdXNoU3RhdGUpIHtcbiAgICAgIHZhciBsb2MgPSB0aGlzLmxvY2F0aW9uO1xuICAgICAgdmFyIGF0Um9vdCA9IGxvYy5wYXRobmFtZS5yZXBsYWNlKC9bXlxcL10kLywgJyQmLycpID09PSB0aGlzLnJvb3Q7XG5cbiAgICAgIGlmICghdGhpcy5faGFzUHVzaFN0YXRlICYmICFhdFJvb3QpIHtcbiAgICAgICAgdGhpcy5mcmFnbWVudCA9IHRoaXMuX2dldEZyYWdtZW50KG51bGwsIHRydWUpO1xuICAgICAgICB0aGlzLmxvY2F0aW9uLnJlcGxhY2UodGhpcy5yb290ICsgdGhpcy5sb2NhdGlvbi5zZWFyY2ggKyAnIycgKyB0aGlzLmZyYWdtZW50KTtcblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5faGFzUHVzaFN0YXRlICYmIGF0Um9vdCAmJiBsb2MuaGFzaCkge1xuICAgICAgICAgIHRoaXMuZnJhZ21lbnQgPSB0aGlzLl9nZXRIYXNoKCkucmVwbGFjZShyb3V0ZVN0cmlwcGVyLCAnJyk7XG4gICAgICAgICAgdGhpcy5oaXN0b3J5LnJlcGxhY2VTdGF0ZSh7fSwgX2F1cmVsaWFQYWwuRE9NLnRpdGxlLCB0aGlzLnJvb3QgKyB0aGlzLmZyYWdtZW50ICsgbG9jLnNlYXJjaCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuZnJhZ21lbnQpIHtcbiAgICAgIHRoaXMuZnJhZ21lbnQgPSB0aGlzLl9nZXRGcmFnbWVudCgpO1xuICAgIH1cblxuICAgIHRoaXMubGlua0hhbmRsZXIuYWN0aXZhdGUodGhpcyk7XG5cbiAgICBpZiAoIXRoaXMub3B0aW9ucy5zaWxlbnQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9sb2FkVXJsKCk7XG4gICAgfVxuICB9O1xuXG4gIEJyb3dzZXJIaXN0b3J5LnByb3RvdHlwZS5kZWFjdGl2YXRlID0gZnVuY3Rpb24gZGVhY3RpdmF0ZSgpIHtcbiAgICBfYXVyZWxpYVBhbC5QTEFURk9STS5yZW1vdmVFdmVudExpc3RlbmVyKCdwb3BzdGF0ZScsIHRoaXMuX2NoZWNrVXJsQ2FsbGJhY2spO1xuICAgIF9hdXJlbGlhUGFsLlBMQVRGT1JNLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2hhc2hjaGFuZ2UnLCB0aGlzLl9jaGVja1VybENhbGxiYWNrKTtcbiAgICB0aGlzLl9pc0FjdGl2ZSA9IGZhbHNlO1xuICAgIHRoaXMubGlua0hhbmRsZXIuZGVhY3RpdmF0ZSgpO1xuICB9O1xuXG4gIEJyb3dzZXJIaXN0b3J5LnByb3RvdHlwZS5nZXRBYnNvbHV0ZVJvb3QgPSBmdW5jdGlvbiBnZXRBYnNvbHV0ZVJvb3QoKSB7XG4gICAgdmFyIG9yaWdpbiA9IGNyZWF0ZU9yaWdpbih0aGlzLmxvY2F0aW9uLnByb3RvY29sLCB0aGlzLmxvY2F0aW9uLmhvc3RuYW1lLCB0aGlzLmxvY2F0aW9uLnBvcnQpO1xuICAgIHJldHVybiAnJyArIG9yaWdpbiArIHRoaXMucm9vdDtcbiAgfTtcblxuICBCcm93c2VySGlzdG9yeS5wcm90b3R5cGUubmF2aWdhdGUgPSBmdW5jdGlvbiBuYXZpZ2F0ZShmcmFnbWVudCkge1xuICAgIHZhciBfcmVmID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07XG5cbiAgICB2YXIgX3JlZiR0cmlnZ2VyID0gX3JlZi50cmlnZ2VyO1xuICAgIHZhciB0cmlnZ2VyID0gX3JlZiR0cmlnZ2VyID09PSB1bmRlZmluZWQgPyB0cnVlIDogX3JlZiR0cmlnZ2VyO1xuICAgIHZhciBfcmVmJHJlcGxhY2UgPSBfcmVmLnJlcGxhY2U7XG4gICAgdmFyIHJlcGxhY2UgPSBfcmVmJHJlcGxhY2UgPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogX3JlZiRyZXBsYWNlO1xuXG4gICAgaWYgKGZyYWdtZW50ICYmIGFic29sdXRlVXJsLnRlc3QoZnJhZ21lbnQpKSB7XG4gICAgICB0aGlzLmxvY2F0aW9uLmhyZWYgPSBmcmFnbWVudDtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5faXNBY3RpdmUpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBmcmFnbWVudCA9IHRoaXMuX2dldEZyYWdtZW50KGZyYWdtZW50IHx8ICcnKTtcblxuICAgIGlmICh0aGlzLmZyYWdtZW50ID09PSBmcmFnbWVudCAmJiAhcmVwbGFjZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHRoaXMuZnJhZ21lbnQgPSBmcmFnbWVudDtcblxuICAgIHZhciB1cmwgPSB0aGlzLnJvb3QgKyBmcmFnbWVudDtcblxuICAgIGlmIChmcmFnbWVudCA9PT0gJycgJiYgdXJsICE9PSAnLycpIHtcbiAgICAgIHVybCA9IHVybC5zbGljZSgwLCAtMSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX2hhc1B1c2hTdGF0ZSkge1xuICAgICAgdXJsID0gdXJsLnJlcGxhY2UoJy8vJywgJy8nKTtcbiAgICAgIHRoaXMuaGlzdG9yeVtyZXBsYWNlID8gJ3JlcGxhY2VTdGF0ZScgOiAncHVzaFN0YXRlJ10oe30sIF9hdXJlbGlhUGFsLkRPTS50aXRsZSwgdXJsKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuX3dhbnRzSGFzaENoYW5nZSkge1xuICAgICAgdXBkYXRlSGFzaCh0aGlzLmxvY2F0aW9uLCBmcmFnbWVudCwgcmVwbGFjZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmxvY2F0aW9uLmFzc2lnbih1cmwpO1xuICAgIH1cblxuICAgIGlmICh0cmlnZ2VyKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbG9hZFVybChmcmFnbWVudCk7XG4gICAgfVxuICB9O1xuXG4gIEJyb3dzZXJIaXN0b3J5LnByb3RvdHlwZS5uYXZpZ2F0ZUJhY2sgPSBmdW5jdGlvbiBuYXZpZ2F0ZUJhY2soKSB7XG4gICAgdGhpcy5oaXN0b3J5LmJhY2soKTtcbiAgfTtcblxuICBCcm93c2VySGlzdG9yeS5wcm90b3R5cGUuc2V0VGl0bGUgPSBmdW5jdGlvbiBzZXRUaXRsZSh0aXRsZSkge1xuICAgIF9hdXJlbGlhUGFsLkRPTS50aXRsZSA9IHRpdGxlO1xuICB9O1xuXG4gIEJyb3dzZXJIaXN0b3J5LnByb3RvdHlwZS5fZ2V0SGFzaCA9IGZ1bmN0aW9uIF9nZXRIYXNoKCkge1xuICAgIHJldHVybiB0aGlzLmxvY2F0aW9uLmhhc2guc3Vic3RyKDEpO1xuICB9O1xuXG4gIEJyb3dzZXJIaXN0b3J5LnByb3RvdHlwZS5fZ2V0RnJhZ21lbnQgPSBmdW5jdGlvbiBfZ2V0RnJhZ21lbnQoZnJhZ21lbnQsIGZvcmNlUHVzaFN0YXRlKSB7XG4gICAgdmFyIHJvb3QgPSB2b2lkIDA7XG5cbiAgICBpZiAoIWZyYWdtZW50KSB7XG4gICAgICBpZiAodGhpcy5faGFzUHVzaFN0YXRlIHx8ICF0aGlzLl93YW50c0hhc2hDaGFuZ2UgfHwgZm9yY2VQdXNoU3RhdGUpIHtcbiAgICAgICAgZnJhZ21lbnQgPSB0aGlzLmxvY2F0aW9uLnBhdGhuYW1lICsgdGhpcy5sb2NhdGlvbi5zZWFyY2g7XG4gICAgICAgIHJvb3QgPSB0aGlzLnJvb3QucmVwbGFjZSh0cmFpbGluZ1NsYXNoLCAnJyk7XG4gICAgICAgIGlmICghZnJhZ21lbnQuaW5kZXhPZihyb290KSkge1xuICAgICAgICAgIGZyYWdtZW50ID0gZnJhZ21lbnQuc3Vic3RyKHJvb3QubGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZnJhZ21lbnQgPSB0aGlzLl9nZXRIYXNoKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuICcvJyArIGZyYWdtZW50LnJlcGxhY2Uocm91dGVTdHJpcHBlciwgJycpO1xuICB9O1xuXG4gIEJyb3dzZXJIaXN0b3J5LnByb3RvdHlwZS5fY2hlY2tVcmwgPSBmdW5jdGlvbiBfY2hlY2tVcmwoKSB7XG4gICAgdmFyIGN1cnJlbnQgPSB0aGlzLl9nZXRGcmFnbWVudCgpO1xuICAgIGlmIChjdXJyZW50ICE9PSB0aGlzLmZyYWdtZW50KSB7XG4gICAgICB0aGlzLl9sb2FkVXJsKCk7XG4gICAgfVxuICB9O1xuXG4gIEJyb3dzZXJIaXN0b3J5LnByb3RvdHlwZS5fbG9hZFVybCA9IGZ1bmN0aW9uIF9sb2FkVXJsKGZyYWdtZW50T3ZlcnJpZGUpIHtcbiAgICB2YXIgZnJhZ21lbnQgPSB0aGlzLmZyYWdtZW50ID0gdGhpcy5fZ2V0RnJhZ21lbnQoZnJhZ21lbnRPdmVycmlkZSk7XG5cbiAgICByZXR1cm4gdGhpcy5vcHRpb25zLnJvdXRlSGFuZGxlciA/IHRoaXMub3B0aW9ucy5yb3V0ZUhhbmRsZXIoZnJhZ21lbnQpIDogZmFsc2U7XG4gIH07XG5cbiAgcmV0dXJuIEJyb3dzZXJIaXN0b3J5O1xufShfYXVyZWxpYUhpc3RvcnkuSGlzdG9yeSksIF9jbGFzcy5pbmplY3QgPSBbTGlua0hhbmRsZXJdLCBfdGVtcCk7XG5cbnZhciByb3V0ZVN0cmlwcGVyID0gL14jP1xcLyp8XFxzKyQvZztcblxudmFyIHJvb3RTdHJpcHBlciA9IC9eXFwvK3xcXC8rJC9nO1xuXG52YXIgdHJhaWxpbmdTbGFzaCA9IC9cXC8kLztcblxudmFyIGFic29sdXRlVXJsID0gL14oW2Etel1bYS16MC05K1xcLS5dKjopP1xcL1xcLy9pO1xuXG5mdW5jdGlvbiB1cGRhdGVIYXNoKGxvY2F0aW9uLCBmcmFnbWVudCwgcmVwbGFjZSkge1xuICBpZiAocmVwbGFjZSkge1xuICAgIHZhciBfaHJlZiA9IGxvY2F0aW9uLmhyZWYucmVwbGFjZSgvKGphdmFzY3JpcHQ6fCMpLiokLywgJycpO1xuICAgIGxvY2F0aW9uLnJlcGxhY2UoX2hyZWYgKyAnIycgKyBmcmFnbWVudCk7XG4gIH0gZWxzZSB7XG4gICAgbG9jYXRpb24uaGFzaCA9ICcjJyArIGZyYWdtZW50O1xuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZU9yaWdpbihwcm90b2NvbCwgaG9zdG5hbWUsIHBvcnQpIHtcbiAgcmV0dXJuIHByb3RvY29sICsgJy8vJyArIGhvc3RuYW1lICsgKHBvcnQgPyAnOicgKyBwb3J0IDogJycpO1xufVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtaGlzdG9yeS1icm93c2VyL2Rpc3QvY29tbW9uanMvYXVyZWxpYS1oaXN0b3J5LWJyb3dzZXIuanNcbiAqKiBtb2R1bGUgaWQgPSAzMFxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBtaShuYW1lKSB7XG4gIHRocm93IG5ldyBFcnJvcignSGlzdG9yeSBtdXN0IGltcGxlbWVudCAnICsgbmFtZSArICcoKS4nKTtcbn1cblxudmFyIEhpc3RvcnkgPSBleHBvcnRzLkhpc3RvcnkgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEhpc3RvcnkoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEhpc3RvcnkpO1xuICB9XG5cbiAgSGlzdG9yeS5wcm90b3R5cGUuYWN0aXZhdGUgPSBmdW5jdGlvbiBhY3RpdmF0ZShvcHRpb25zKSB7XG4gICAgbWkoJ2FjdGl2YXRlJyk7XG4gIH07XG5cbiAgSGlzdG9yeS5wcm90b3R5cGUuZGVhY3RpdmF0ZSA9IGZ1bmN0aW9uIGRlYWN0aXZhdGUoKSB7XG4gICAgbWkoJ2RlYWN0aXZhdGUnKTtcbiAgfTtcblxuICBIaXN0b3J5LnByb3RvdHlwZS5nZXRBYnNvbHV0ZVJvb3QgPSBmdW5jdGlvbiBnZXRBYnNvbHV0ZVJvb3QoKSB7XG4gICAgbWkoJ2dldEFic29sdXRlUm9vdCcpO1xuICB9O1xuXG4gIEhpc3RvcnkucHJvdG90eXBlLm5hdmlnYXRlID0gZnVuY3Rpb24gbmF2aWdhdGUoZnJhZ21lbnQsIG9wdGlvbnMpIHtcbiAgICBtaSgnbmF2aWdhdGUnKTtcbiAgfTtcblxuICBIaXN0b3J5LnByb3RvdHlwZS5uYXZpZ2F0ZUJhY2sgPSBmdW5jdGlvbiBuYXZpZ2F0ZUJhY2soKSB7XG4gICAgbWkoJ25hdmlnYXRlQmFjaycpO1xuICB9O1xuXG4gIEhpc3RvcnkucHJvdG90eXBlLnNldFRpdGxlID0gZnVuY3Rpb24gc2V0VGl0bGUodGl0bGUpIHtcbiAgICBtaSgnc2V0VGl0bGUnKTtcbiAgfTtcblxuICByZXR1cm4gSGlzdG9yeTtcbn0oKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLWhpc3RvcnkvZGlzdC9jb21tb25qcy9hdXJlbGlhLWhpc3RvcnkuanNcbiAqKiBtb2R1bGUgaWQgPSAzMVxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5Db25zb2xlQXBwZW5kZXIgPSB1bmRlZmluZWQ7XG5cbnZhciBfYXVyZWxpYUxvZ2dpbmcgPSByZXF1aXJlKCdhdXJlbGlhLWxvZ2dpbmcnKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIENvbnNvbGVBcHBlbmRlciA9IGV4cG9ydHMuQ29uc29sZUFwcGVuZGVyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBDb25zb2xlQXBwZW5kZXIoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENvbnNvbGVBcHBlbmRlcik7XG4gIH1cblxuICBDb25zb2xlQXBwZW5kZXIucHJvdG90eXBlLmRlYnVnID0gZnVuY3Rpb24gZGVidWcobG9nZ2VyKSB7XG4gICAgdmFyIF9jb25zb2xlO1xuXG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIHJlc3QgPSBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICByZXN0W19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG5cbiAgICAoX2NvbnNvbGUgPSBjb25zb2xlKS5kZWJ1Zy5hcHBseShfY29uc29sZSwgWydERUJVRyBbJyArIGxvZ2dlci5pZCArICddJ10uY29uY2F0KHJlc3QpKTtcbiAgfTtcblxuICBDb25zb2xlQXBwZW5kZXIucHJvdG90eXBlLmluZm8gPSBmdW5jdGlvbiBpbmZvKGxvZ2dlcikge1xuICAgIHZhciBfY29uc29sZTI7XG5cbiAgICBmb3IgKHZhciBfbGVuMiA9IGFyZ3VtZW50cy5sZW5ndGgsIHJlc3QgPSBBcnJheShfbGVuMiA+IDEgPyBfbGVuMiAtIDEgOiAwKSwgX2tleTIgPSAxOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7XG4gICAgICByZXN0W19rZXkyIC0gMV0gPSBhcmd1bWVudHNbX2tleTJdO1xuICAgIH1cblxuICAgIChfY29uc29sZTIgPSBjb25zb2xlKS5pbmZvLmFwcGx5KF9jb25zb2xlMiwgWydJTkZPIFsnICsgbG9nZ2VyLmlkICsgJ10nXS5jb25jYXQocmVzdCkpO1xuICB9O1xuXG4gIENvbnNvbGVBcHBlbmRlci5wcm90b3R5cGUud2FybiA9IGZ1bmN0aW9uIHdhcm4obG9nZ2VyKSB7XG4gICAgdmFyIF9jb25zb2xlMztcblxuICAgIGZvciAodmFyIF9sZW4zID0gYXJndW1lbnRzLmxlbmd0aCwgcmVzdCA9IEFycmF5KF9sZW4zID4gMSA/IF9sZW4zIC0gMSA6IDApLCBfa2V5MyA9IDE7IF9rZXkzIDwgX2xlbjM7IF9rZXkzKyspIHtcbiAgICAgIHJlc3RbX2tleTMgLSAxXSA9IGFyZ3VtZW50c1tfa2V5M107XG4gICAgfVxuXG4gICAgKF9jb25zb2xlMyA9IGNvbnNvbGUpLndhcm4uYXBwbHkoX2NvbnNvbGUzLCBbJ1dBUk4gWycgKyBsb2dnZXIuaWQgKyAnXSddLmNvbmNhdChyZXN0KSk7XG4gIH07XG5cbiAgQ29uc29sZUFwcGVuZGVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIGVycm9yKGxvZ2dlcikge1xuICAgIHZhciBfY29uc29sZTQ7XG5cbiAgICBmb3IgKHZhciBfbGVuNCA9IGFyZ3VtZW50cy5sZW5ndGgsIHJlc3QgPSBBcnJheShfbGVuNCA+IDEgPyBfbGVuNCAtIDEgOiAwKSwgX2tleTQgPSAxOyBfa2V5NCA8IF9sZW40OyBfa2V5NCsrKSB7XG4gICAgICByZXN0W19rZXk0IC0gMV0gPSBhcmd1bWVudHNbX2tleTRdO1xuICAgIH1cblxuICAgIChfY29uc29sZTQgPSBjb25zb2xlKS5lcnJvci5hcHBseShfY29uc29sZTQsIFsnRVJST1IgWycgKyBsb2dnZXIuaWQgKyAnXSddLmNvbmNhdChyZXN0KSk7XG4gIH07XG5cbiAgcmV0dXJuIENvbnNvbGVBcHBlbmRlcjtcbn0oKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLWxvZ2dpbmctY29uc29sZS9kaXN0L2NvbW1vbmpzL2F1cmVsaWEtbG9nZ2luZy1jb25zb2xlLmpzXG4gKiogbW9kdWxlIGlkID0gMzJcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuQXBwUm91dGVyID0gZXhwb3J0cy5QaXBlbGluZVByb3ZpZGVyID0gZXhwb3J0cy5Mb2FkUm91dGVTdGVwID0gZXhwb3J0cy5Sb3V0ZUxvYWRlciA9IGV4cG9ydHMuQWN0aXZhdGVOZXh0U3RlcCA9IGV4cG9ydHMuRGVhY3RpdmF0ZVByZXZpb3VzU3RlcCA9IGV4cG9ydHMuQ2FuQWN0aXZhdGVOZXh0U3RlcCA9IGV4cG9ydHMuQ2FuRGVhY3RpdmF0ZVByZXZpb3VzU3RlcCA9IGV4cG9ydHMuUm91dGVyID0gZXhwb3J0cy5CdWlsZE5hdmlnYXRpb25QbGFuU3RlcCA9IGV4cG9ydHMuYWN0aXZhdGlvblN0cmF0ZWd5ID0gZXhwb3J0cy5Sb3V0ZXJDb25maWd1cmF0aW9uID0gZXhwb3J0cy5SZWRpcmVjdFRvUm91dGUgPSBleHBvcnRzLlJlZGlyZWN0ID0gZXhwb3J0cy5OYXZNb2RlbCA9IGV4cG9ydHMuTmF2aWdhdGlvbkluc3RydWN0aW9uID0gZXhwb3J0cy5Db21taXRDaGFuZ2VzU3RlcCA9IGV4cG9ydHMuUGlwZWxpbmUgPSBleHBvcnRzLnBpcGVsaW5lU3RhdHVzID0gdW5kZWZpbmVkO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZXhwb3J0cy5fbm9ybWFsaXplQWJzb2x1dGVQYXRoID0gX25vcm1hbGl6ZUFic29sdXRlUGF0aDtcbmV4cG9ydHMuX2NyZWF0ZVJvb3RlZFBhdGggPSBfY3JlYXRlUm9vdGVkUGF0aDtcbmV4cG9ydHMuX3Jlc29sdmVVcmwgPSBfcmVzb2x2ZVVybDtcbmV4cG9ydHMuaXNOYXZpZ2F0aW9uQ29tbWFuZCA9IGlzTmF2aWdhdGlvbkNvbW1hbmQ7XG5leHBvcnRzLl9idWlsZE5hdmlnYXRpb25QbGFuID0gX2J1aWxkTmF2aWdhdGlvblBsYW47XG5cbnZhciBfYXVyZWxpYUxvZ2dpbmcgPSByZXF1aXJlKCdhdXJlbGlhLWxvZ2dpbmcnKTtcblxudmFyIExvZ01hbmFnZXIgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfYXVyZWxpYUxvZ2dpbmcpO1xuXG52YXIgX2F1cmVsaWFSb3V0ZVJlY29nbml6ZXIgPSByZXF1aXJlKCdhdXJlbGlhLXJvdXRlLXJlY29nbml6ZXInKTtcblxudmFyIF9hdXJlbGlhRGVwZW5kZW5jeUluamVjdGlvbiA9IHJlcXVpcmUoJ2F1cmVsaWEtZGVwZW5kZW5jeS1pbmplY3Rpb24nKTtcblxudmFyIF9hdXJlbGlhSGlzdG9yeSA9IHJlcXVpcmUoJ2F1cmVsaWEtaGlzdG9yeScpO1xuXG52YXIgX2F1cmVsaWFFdmVudEFnZ3JlZ2F0b3IgPSByZXF1aXJlKCdhdXJlbGlhLWV2ZW50LWFnZ3JlZ2F0b3InKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09iai5kZWZhdWx0ID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfbm9ybWFsaXplQWJzb2x1dGVQYXRoKHBhdGgsIGhhc1B1c2hTdGF0ZSkge1xuICB2YXIgYWJzb2x1dGUgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDIgfHwgYXJndW1lbnRzWzJdID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IGFyZ3VtZW50c1syXTtcblxuICBpZiAoIWhhc1B1c2hTdGF0ZSAmJiBwYXRoWzBdICE9PSAnIycpIHtcbiAgICBwYXRoID0gJyMnICsgcGF0aDtcbiAgfVxuXG4gIGlmIChoYXNQdXNoU3RhdGUgJiYgYWJzb2x1dGUpIHtcbiAgICBwYXRoID0gcGF0aC5zdWJzdHJpbmcoMSwgcGF0aC5sZW5ndGgpO1xuICB9XG5cbiAgcmV0dXJuIHBhdGg7XG59XG5cbmZ1bmN0aW9uIF9jcmVhdGVSb290ZWRQYXRoKGZyYWdtZW50LCBiYXNlVXJsLCBoYXNQdXNoU3RhdGUsIGFic29sdXRlKSB7XG4gIGlmIChpc0Fic29sdXRlVXJsLnRlc3QoZnJhZ21lbnQpKSB7XG4gICAgcmV0dXJuIGZyYWdtZW50O1xuICB9XG5cbiAgdmFyIHBhdGggPSAnJztcblxuICBpZiAoYmFzZVVybC5sZW5ndGggJiYgYmFzZVVybFswXSAhPT0gJy8nKSB7XG4gICAgcGF0aCArPSAnLyc7XG4gIH1cblxuICBwYXRoICs9IGJhc2VVcmw7XG5cbiAgaWYgKCghcGF0aC5sZW5ndGggfHwgcGF0aFtwYXRoLmxlbmd0aCAtIDFdICE9PSAnLycpICYmIGZyYWdtZW50WzBdICE9PSAnLycpIHtcbiAgICBwYXRoICs9ICcvJztcbiAgfVxuXG4gIGlmIChwYXRoLmxlbmd0aCAmJiBwYXRoW3BhdGgubGVuZ3RoIC0gMV0gPT09ICcvJyAmJiBmcmFnbWVudFswXSA9PT0gJy8nKSB7XG4gICAgcGF0aCA9IHBhdGguc3Vic3RyaW5nKDAsIHBhdGgubGVuZ3RoIC0gMSk7XG4gIH1cblxuICByZXR1cm4gX25vcm1hbGl6ZUFic29sdXRlUGF0aChwYXRoICsgZnJhZ21lbnQsIGhhc1B1c2hTdGF0ZSwgYWJzb2x1dGUpO1xufVxuXG5mdW5jdGlvbiBfcmVzb2x2ZVVybChmcmFnbWVudCwgYmFzZVVybCwgaGFzUHVzaFN0YXRlKSB7XG4gIGlmIChpc1Jvb3RlZFBhdGgudGVzdChmcmFnbWVudCkpIHtcbiAgICByZXR1cm4gX25vcm1hbGl6ZUFic29sdXRlUGF0aChmcmFnbWVudCwgaGFzUHVzaFN0YXRlKTtcbiAgfVxuXG4gIHJldHVybiBfY3JlYXRlUm9vdGVkUGF0aChmcmFnbWVudCwgYmFzZVVybCwgaGFzUHVzaFN0YXRlKTtcbn1cblxudmFyIGlzUm9vdGVkUGF0aCA9IC9eIz9cXC8vO1xudmFyIGlzQWJzb2x1dGVVcmwgPSAvXihbYS16XVthLXowLTkrXFwtLl0qOik/XFwvXFwvL2k7XG5cbnZhciBwaXBlbGluZVN0YXR1cyA9IGV4cG9ydHMucGlwZWxpbmVTdGF0dXMgPSB7XG4gIGNvbXBsZXRlZDogJ2NvbXBsZXRlZCcsXG4gIGNhbmNlbGVkOiAnY2FuY2VsZWQnLFxuICByZWplY3RlZDogJ3JlamVjdGVkJyxcbiAgcnVubmluZzogJ3J1bm5pbmcnXG59O1xuXG52YXIgUGlwZWxpbmUgPSBleHBvcnRzLlBpcGVsaW5lID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBQaXBlbGluZSgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGlwZWxpbmUpO1xuXG4gICAgdGhpcy5zdGVwcyA9IFtdO1xuICB9XG5cbiAgUGlwZWxpbmUucHJvdG90eXBlLmFkZFN0ZXAgPSBmdW5jdGlvbiBhZGRTdGVwKHN0ZXApIHtcbiAgICB2YXIgcnVuID0gdm9pZCAwO1xuXG4gICAgaWYgKHR5cGVvZiBzdGVwID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBydW4gPSBzdGVwO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHN0ZXAuZ2V0U3RlcHMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHZhciBzdGVwcyA9IHN0ZXAuZ2V0U3RlcHMoKTtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gc3RlcHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIHRoaXMuYWRkU3RlcChzdGVwc1tpXSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0gZWxzZSB7XG4gICAgICBydW4gPSBzdGVwLnJ1bi5iaW5kKHN0ZXApO1xuICAgIH1cblxuICAgIHRoaXMuc3RlcHMucHVzaChydW4pO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgUGlwZWxpbmUucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uIHJ1bihpbnN0cnVjdGlvbikge1xuICAgIHZhciBpbmRleCA9IC0xO1xuICAgIHZhciBzdGVwcyA9IHRoaXMuc3RlcHM7XG5cbiAgICBmdW5jdGlvbiBuZXh0KCkge1xuICAgICAgaW5kZXgrKztcblxuICAgICAgaWYgKGluZGV4IDwgc3RlcHMubGVuZ3RoKSB7XG4gICAgICAgIHZhciBjdXJyZW50U3RlcCA9IHN0ZXBzW2luZGV4XTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIHJldHVybiBjdXJyZW50U3RlcChpbnN0cnVjdGlvbiwgbmV4dCk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICByZXR1cm4gbmV4dC5yZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXh0LmNvbXBsZXRlKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbmV4dC5jb21wbGV0ZSA9IGNyZWF0ZUNvbXBsZXRpb25IYW5kbGVyKG5leHQsIHBpcGVsaW5lU3RhdHVzLmNvbXBsZXRlZCk7XG4gICAgbmV4dC5jYW5jZWwgPSBjcmVhdGVDb21wbGV0aW9uSGFuZGxlcihuZXh0LCBwaXBlbGluZVN0YXR1cy5jYW5jZWxlZCk7XG4gICAgbmV4dC5yZWplY3QgPSBjcmVhdGVDb21wbGV0aW9uSGFuZGxlcihuZXh0LCBwaXBlbGluZVN0YXR1cy5yZWplY3RlZCk7XG5cbiAgICByZXR1cm4gbmV4dCgpO1xuICB9O1xuXG4gIHJldHVybiBQaXBlbGluZTtcbn0oKTtcblxuZnVuY3Rpb24gY3JlYXRlQ29tcGxldGlvbkhhbmRsZXIobmV4dCwgc3RhdHVzKSB7XG4gIHJldHVybiBmdW5jdGlvbiAob3V0cHV0KSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7IHN0YXR1czogc3RhdHVzLCBvdXRwdXQ6IG91dHB1dCwgY29tcGxldGVkOiBzdGF0dXMgPT09IHBpcGVsaW5lU3RhdHVzLmNvbXBsZXRlZCB9KTtcbiAgfTtcbn1cblxudmFyIENvbW1pdENoYW5nZXNTdGVwID0gZXhwb3J0cy5Db21taXRDaGFuZ2VzU3RlcCA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQ29tbWl0Q2hhbmdlc1N0ZXAoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENvbW1pdENoYW5nZXNTdGVwKTtcbiAgfVxuXG4gIENvbW1pdENoYW5nZXNTdGVwLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiBydW4obmF2aWdhdGlvbkluc3RydWN0aW9uLCBuZXh0KSB7XG4gICAgcmV0dXJuIG5hdmlnYXRpb25JbnN0cnVjdGlvbi5fY29tbWl0Q2hhbmdlcyh0cnVlKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgIG5hdmlnYXRpb25JbnN0cnVjdGlvbi5fdXBkYXRlVGl0bGUoKTtcbiAgICAgIHJldHVybiBuZXh0KCk7XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIENvbW1pdENoYW5nZXNTdGVwO1xufSgpO1xuXG52YXIgTmF2aWdhdGlvbkluc3RydWN0aW9uID0gZXhwb3J0cy5OYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIE5hdmlnYXRpb25JbnN0cnVjdGlvbihpbml0KSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE5hdmlnYXRpb25JbnN0cnVjdGlvbik7XG5cbiAgICB0aGlzLnBsYW4gPSBudWxsO1xuICAgIHRoaXMub3B0aW9ucyA9IHt9O1xuXG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLCBpbml0KTtcblxuICAgIHRoaXMucGFyYW1zID0gdGhpcy5wYXJhbXMgfHwge307XG4gICAgdGhpcy52aWV3UG9ydEluc3RydWN0aW9ucyA9IHt9O1xuXG4gICAgdmFyIGFuY2VzdG9yUGFyYW1zID0gW107XG4gICAgdmFyIGN1cnJlbnQgPSB0aGlzO1xuICAgIGRvIHtcbiAgICAgIHZhciBjdXJyZW50UGFyYW1zID0gT2JqZWN0LmFzc2lnbih7fSwgY3VycmVudC5wYXJhbXMpO1xuICAgICAgaWYgKGN1cnJlbnQuY29uZmlnICYmIGN1cnJlbnQuY29uZmlnLmhhc0NoaWxkUm91dGVyKSB7XG4gICAgICAgIGRlbGV0ZSBjdXJyZW50UGFyYW1zW2N1cnJlbnQuZ2V0V2lsZENhcmROYW1lKCldO1xuICAgICAgfVxuXG4gICAgICBhbmNlc3RvclBhcmFtcy51bnNoaWZ0KGN1cnJlbnRQYXJhbXMpO1xuICAgICAgY3VycmVudCA9IGN1cnJlbnQucGFyZW50SW5zdHJ1Y3Rpb247XG4gICAgfSB3aGlsZSAoY3VycmVudCk7XG5cbiAgICB2YXIgYWxsUGFyYW1zID0gT2JqZWN0LmFzc2lnbi5hcHBseShPYmplY3QsIFt7fSwgdGhpcy5xdWVyeVBhcmFtc10uY29uY2F0KGFuY2VzdG9yUGFyYW1zKSk7XG4gICAgdGhpcy5saWZlY3ljbGVBcmdzID0gW2FsbFBhcmFtcywgdGhpcy5jb25maWcsIHRoaXNdO1xuICB9XG5cbiAgTmF2aWdhdGlvbkluc3RydWN0aW9uLnByb3RvdHlwZS5nZXRBbGxJbnN0cnVjdGlvbnMgPSBmdW5jdGlvbiBnZXRBbGxJbnN0cnVjdGlvbnMoKSB7XG4gICAgdmFyIGluc3RydWN0aW9ucyA9IFt0aGlzXTtcbiAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy52aWV3UG9ydEluc3RydWN0aW9ucykge1xuICAgICAgdmFyIGNoaWxkSW5zdHJ1Y3Rpb24gPSB0aGlzLnZpZXdQb3J0SW5zdHJ1Y3Rpb25zW2tleV0uY2hpbGROYXZpZ2F0aW9uSW5zdHJ1Y3Rpb247XG4gICAgICBpZiAoY2hpbGRJbnN0cnVjdGlvbikge1xuICAgICAgICBpbnN0cnVjdGlvbnMucHVzaC5hcHBseShpbnN0cnVjdGlvbnMsIGNoaWxkSW5zdHJ1Y3Rpb24uZ2V0QWxsSW5zdHJ1Y3Rpb25zKCkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBpbnN0cnVjdGlvbnM7XG4gIH07XG5cbiAgTmF2aWdhdGlvbkluc3RydWN0aW9uLnByb3RvdHlwZS5nZXRBbGxQcmV2aW91c0luc3RydWN0aW9ucyA9IGZ1bmN0aW9uIGdldEFsbFByZXZpb3VzSW5zdHJ1Y3Rpb25zKCkge1xuICAgIHJldHVybiB0aGlzLmdldEFsbEluc3RydWN0aW9ucygpLm1hcChmdW5jdGlvbiAoYykge1xuICAgICAgcmV0dXJuIGMucHJldmlvdXNJbnN0cnVjdGlvbjtcbiAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKGMpIHtcbiAgICAgIHJldHVybiBjO1xuICAgIH0pO1xuICB9O1xuXG4gIE5hdmlnYXRpb25JbnN0cnVjdGlvbi5wcm90b3R5cGUuYWRkVmlld1BvcnRJbnN0cnVjdGlvbiA9IGZ1bmN0aW9uIGFkZFZpZXdQb3J0SW5zdHJ1Y3Rpb24odmlld1BvcnROYW1lLCBzdHJhdGVneSwgbW9kdWxlSWQsIGNvbXBvbmVudCkge1xuICAgIHZhciB2aWV3cG9ydEluc3RydWN0aW9uID0gdGhpcy52aWV3UG9ydEluc3RydWN0aW9uc1t2aWV3UG9ydE5hbWVdID0ge1xuICAgICAgbmFtZTogdmlld1BvcnROYW1lLFxuICAgICAgc3RyYXRlZ3k6IHN0cmF0ZWd5LFxuICAgICAgbW9kdWxlSWQ6IG1vZHVsZUlkLFxuICAgICAgY29tcG9uZW50OiBjb21wb25lbnQsXG4gICAgICBjaGlsZFJvdXRlcjogY29tcG9uZW50LmNoaWxkUm91dGVyLFxuICAgICAgbGlmZWN5Y2xlQXJnczogdGhpcy5saWZlY3ljbGVBcmdzLnNsaWNlKClcbiAgICB9O1xuXG4gICAgcmV0dXJuIHZpZXdwb3J0SW5zdHJ1Y3Rpb247XG4gIH07XG5cbiAgTmF2aWdhdGlvbkluc3RydWN0aW9uLnByb3RvdHlwZS5nZXRXaWxkQ2FyZE5hbWUgPSBmdW5jdGlvbiBnZXRXaWxkQ2FyZE5hbWUoKSB7XG4gICAgdmFyIHdpbGRjYXJkSW5kZXggPSB0aGlzLmNvbmZpZy5yb3V0ZS5sYXN0SW5kZXhPZignKicpO1xuICAgIHJldHVybiB0aGlzLmNvbmZpZy5yb3V0ZS5zdWJzdHIod2lsZGNhcmRJbmRleCArIDEpO1xuICB9O1xuXG4gIE5hdmlnYXRpb25JbnN0cnVjdGlvbi5wcm90b3R5cGUuZ2V0V2lsZGNhcmRQYXRoID0gZnVuY3Rpb24gZ2V0V2lsZGNhcmRQYXRoKCkge1xuICAgIHZhciB3aWxkY2FyZE5hbWUgPSB0aGlzLmdldFdpbGRDYXJkTmFtZSgpO1xuICAgIHZhciBwYXRoID0gdGhpcy5wYXJhbXNbd2lsZGNhcmROYW1lXSB8fCAnJztcblxuICAgIGlmICh0aGlzLnF1ZXJ5U3RyaW5nKSB7XG4gICAgICBwYXRoICs9ICc/JyArIHRoaXMucXVlcnlTdHJpbmc7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhdGg7XG4gIH07XG5cbiAgTmF2aWdhdGlvbkluc3RydWN0aW9uLnByb3RvdHlwZS5nZXRCYXNlVXJsID0gZnVuY3Rpb24gZ2V0QmFzZVVybCgpIHtcbiAgICBpZiAoIXRoaXMucGFyYW1zKSB7XG4gICAgICByZXR1cm4gdGhpcy5mcmFnbWVudDtcbiAgICB9XG5cbiAgICB2YXIgd2lsZGNhcmROYW1lID0gdGhpcy5nZXRXaWxkQ2FyZE5hbWUoKTtcbiAgICB2YXIgcGF0aCA9IHRoaXMucGFyYW1zW3dpbGRjYXJkTmFtZV0gfHwgJyc7XG5cbiAgICBpZiAoIXBhdGgpIHtcbiAgICAgIHJldHVybiB0aGlzLmZyYWdtZW50O1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmZyYWdtZW50LnN1YnN0cigwLCB0aGlzLmZyYWdtZW50Lmxhc3RJbmRleE9mKHBhdGgpKTtcbiAgfTtcblxuICBOYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24ucHJvdG90eXBlLl9jb21taXRDaGFuZ2VzID0gZnVuY3Rpb24gX2NvbW1pdENoYW5nZXMod2FpdFRvU3dhcCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB2YXIgcm91dGVyID0gdGhpcy5yb3V0ZXI7XG4gICAgcm91dGVyLmN1cnJlbnRJbnN0cnVjdGlvbiA9IHRoaXM7XG5cbiAgICBpZiAodGhpcy5wcmV2aW91c0luc3RydWN0aW9uKSB7XG4gICAgICB0aGlzLnByZXZpb3VzSW5zdHJ1Y3Rpb24uY29uZmlnLm5hdk1vZGVsLmlzQWN0aXZlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgdGhpcy5jb25maWcubmF2TW9kZWwuaXNBY3RpdmUgPSB0cnVlO1xuXG4gICAgcm91dGVyLl9yZWZyZXNoQmFzZVVybCgpO1xuICAgIHJvdXRlci5yZWZyZXNoTmF2aWdhdGlvbigpO1xuXG4gICAgdmFyIGxvYWRzID0gW107XG4gICAgdmFyIGRlbGF5U3dhcHMgPSBbXTtcblxuICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKHZpZXdQb3J0TmFtZSkge1xuICAgICAgdmFyIHZpZXdQb3J0SW5zdHJ1Y3Rpb24gPSBfdGhpcy52aWV3UG9ydEluc3RydWN0aW9uc1t2aWV3UG9ydE5hbWVdO1xuICAgICAgdmFyIHZpZXdQb3J0ID0gcm91dGVyLnZpZXdQb3J0c1t2aWV3UG9ydE5hbWVdO1xuXG4gICAgICBpZiAoIXZpZXdQb3J0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlcmUgd2FzIG5vIHJvdXRlci12aWV3IGZvdW5kIGluIHRoZSB2aWV3IGZvciAnICsgdmlld1BvcnRJbnN0cnVjdGlvbi5tb2R1bGVJZCArICcuJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICh2aWV3UG9ydEluc3RydWN0aW9uLnN0cmF0ZWd5ID09PSBhY3RpdmF0aW9uU3RyYXRlZ3kucmVwbGFjZSkge1xuICAgICAgICBpZiAod2FpdFRvU3dhcCkge1xuICAgICAgICAgIGRlbGF5U3dhcHMucHVzaCh7IHZpZXdQb3J0OiB2aWV3UG9ydCwgdmlld1BvcnRJbnN0cnVjdGlvbjogdmlld1BvcnRJbnN0cnVjdGlvbiB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxvYWRzLnB1c2godmlld1BvcnQucHJvY2Vzcyh2aWV3UG9ydEluc3RydWN0aW9uLCB3YWl0VG9Td2FwKS50aGVuKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgaWYgKHZpZXdQb3J0SW5zdHJ1Y3Rpb24uY2hpbGROYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB2aWV3UG9ydEluc3RydWN0aW9uLmNoaWxkTmF2aWdhdGlvbkluc3RydWN0aW9uLl9jb21taXRDaGFuZ2VzKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodmlld1BvcnRJbnN0cnVjdGlvbi5jaGlsZE5hdmlnYXRpb25JbnN0cnVjdGlvbikge1xuICAgICAgICAgIGxvYWRzLnB1c2godmlld1BvcnRJbnN0cnVjdGlvbi5jaGlsZE5hdmlnYXRpb25JbnN0cnVjdGlvbi5fY29tbWl0Q2hhbmdlcyh3YWl0VG9Td2FwKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZm9yICh2YXIgdmlld1BvcnROYW1lIGluIHRoaXMudmlld1BvcnRJbnN0cnVjdGlvbnMpIHtcbiAgICAgIF9sb29wKHZpZXdQb3J0TmFtZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKGxvYWRzKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgIGRlbGF5U3dhcHMuZm9yRWFjaChmdW5jdGlvbiAoeCkge1xuICAgICAgICByZXR1cm4geC52aWV3UG9ydC5zd2FwKHgudmlld1BvcnRJbnN0cnVjdGlvbik7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHBydW5lKF90aGlzKTtcbiAgICB9KTtcbiAgfTtcblxuICBOYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24ucHJvdG90eXBlLl91cGRhdGVUaXRsZSA9IGZ1bmN0aW9uIF91cGRhdGVUaXRsZSgpIHtcbiAgICB2YXIgdGl0bGUgPSB0aGlzLl9idWlsZFRpdGxlKCk7XG4gICAgaWYgKHRpdGxlKSB7XG4gICAgICB0aGlzLnJvdXRlci5oaXN0b3J5LnNldFRpdGxlKHRpdGxlKTtcbiAgICB9XG4gIH07XG5cbiAgTmF2aWdhdGlvbkluc3RydWN0aW9uLnByb3RvdHlwZS5fYnVpbGRUaXRsZSA9IGZ1bmN0aW9uIF9idWlsZFRpdGxlKCkge1xuICAgIHZhciBzZXBhcmF0b3IgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyAnIHwgJyA6IGFyZ3VtZW50c1swXTtcblxuICAgIHZhciB0aXRsZSA9IHRoaXMuY29uZmlnLm5hdk1vZGVsLnRpdGxlIHx8ICcnO1xuICAgIHZhciBjaGlsZFRpdGxlcyA9IFtdO1xuXG4gICAgZm9yICh2YXIgdmlld1BvcnROYW1lIGluIHRoaXMudmlld1BvcnRJbnN0cnVjdGlvbnMpIHtcbiAgICAgIHZhciBfdmlld1BvcnRJbnN0cnVjdGlvbiA9IHRoaXMudmlld1BvcnRJbnN0cnVjdGlvbnNbdmlld1BvcnROYW1lXTtcblxuICAgICAgaWYgKF92aWV3UG9ydEluc3RydWN0aW9uLmNoaWxkTmF2aWdhdGlvbkluc3RydWN0aW9uKSB7XG4gICAgICAgIHZhciBjaGlsZFRpdGxlID0gX3ZpZXdQb3J0SW5zdHJ1Y3Rpb24uY2hpbGROYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24uX2J1aWxkVGl0bGUoc2VwYXJhdG9yKTtcbiAgICAgICAgaWYgKGNoaWxkVGl0bGUpIHtcbiAgICAgICAgICBjaGlsZFRpdGxlcy5wdXNoKGNoaWxkVGl0bGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGNoaWxkVGl0bGVzLmxlbmd0aCkge1xuICAgICAgdGl0bGUgPSBjaGlsZFRpdGxlcy5qb2luKHNlcGFyYXRvcikgKyAodGl0bGUgPyBzZXBhcmF0b3IgOiAnJykgKyB0aXRsZTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5yb3V0ZXIudGl0bGUpIHtcbiAgICAgIHRpdGxlICs9ICh0aXRsZSA/IHNlcGFyYXRvciA6ICcnKSArIHRoaXMucm91dGVyLnRpdGxlO1xuICAgIH1cblxuICAgIHJldHVybiB0aXRsZTtcbiAgfTtcblxuICByZXR1cm4gTmF2aWdhdGlvbkluc3RydWN0aW9uO1xufSgpO1xuXG5mdW5jdGlvbiBwcnVuZShpbnN0cnVjdGlvbikge1xuICBpbnN0cnVjdGlvbi5wcmV2aW91c0luc3RydWN0aW9uID0gbnVsbDtcbiAgaW5zdHJ1Y3Rpb24ucGxhbiA9IG51bGw7XG59XG5cbnZhciBOYXZNb2RlbCA9IGV4cG9ydHMuTmF2TW9kZWwgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIE5hdk1vZGVsKHJvdXRlciwgcmVsYXRpdmVIcmVmKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE5hdk1vZGVsKTtcblxuICAgIHRoaXMuaXNBY3RpdmUgPSBmYWxzZTtcbiAgICB0aGlzLnRpdGxlID0gbnVsbDtcbiAgICB0aGlzLmhyZWYgPSBudWxsO1xuICAgIHRoaXMucmVsYXRpdmVIcmVmID0gbnVsbDtcbiAgICB0aGlzLnNldHRpbmdzID0ge307XG4gICAgdGhpcy5jb25maWcgPSBudWxsO1xuXG4gICAgdGhpcy5yb3V0ZXIgPSByb3V0ZXI7XG4gICAgdGhpcy5yZWxhdGl2ZUhyZWYgPSByZWxhdGl2ZUhyZWY7XG4gIH1cblxuICBOYXZNb2RlbC5wcm90b3R5cGUuc2V0VGl0bGUgPSBmdW5jdGlvbiBzZXRUaXRsZSh0aXRsZSkge1xuICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcblxuICAgIGlmICh0aGlzLmlzQWN0aXZlKSB7XG4gICAgICB0aGlzLnJvdXRlci51cGRhdGVUaXRsZSgpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gTmF2TW9kZWw7XG59KCk7XG5cbmZ1bmN0aW9uIGlzTmF2aWdhdGlvbkNvbW1hbmQob2JqKSB7XG4gIHJldHVybiBvYmogJiYgdHlwZW9mIG9iai5uYXZpZ2F0ZSA9PT0gJ2Z1bmN0aW9uJztcbn1cblxudmFyIFJlZGlyZWN0ID0gZXhwb3J0cy5SZWRpcmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUmVkaXJlY3QodXJsKSB7XG4gICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1sxXTtcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSZWRpcmVjdCk7XG5cbiAgICB0aGlzLnVybCA9IHVybDtcbiAgICB0aGlzLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgdHJpZ2dlcjogdHJ1ZSwgcmVwbGFjZTogdHJ1ZSB9LCBvcHRpb25zKTtcbiAgICB0aGlzLnNob3VsZENvbnRpbnVlUHJvY2Vzc2luZyA9IGZhbHNlO1xuICB9XG5cbiAgUmVkaXJlY3QucHJvdG90eXBlLnNldFJvdXRlciA9IGZ1bmN0aW9uIHNldFJvdXRlcihyb3V0ZXIpIHtcbiAgICB0aGlzLnJvdXRlciA9IHJvdXRlcjtcbiAgfTtcblxuICBSZWRpcmVjdC5wcm90b3R5cGUubmF2aWdhdGUgPSBmdW5jdGlvbiBuYXZpZ2F0ZShhcHBSb3V0ZXIpIHtcbiAgICB2YXIgbmF2aWdhdGluZ1JvdXRlciA9IHRoaXMub3B0aW9ucy51c2VBcHBSb3V0ZXIgPyBhcHBSb3V0ZXIgOiB0aGlzLnJvdXRlciB8fCBhcHBSb3V0ZXI7XG4gICAgbmF2aWdhdGluZ1JvdXRlci5uYXZpZ2F0ZSh0aGlzLnVybCwgdGhpcy5vcHRpb25zKTtcbiAgfTtcblxuICByZXR1cm4gUmVkaXJlY3Q7XG59KCk7XG5cbnZhciBSZWRpcmVjdFRvUm91dGUgPSBleHBvcnRzLlJlZGlyZWN0VG9Sb3V0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUmVkaXJlY3RUb1JvdXRlKHJvdXRlKSB7XG4gICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzFdO1xuICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA8PSAyIHx8IGFyZ3VtZW50c1syXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMl07XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmVkaXJlY3RUb1JvdXRlKTtcblxuICAgIHRoaXMucm91dGUgPSByb3V0ZTtcbiAgICB0aGlzLnBhcmFtcyA9IHBhcmFtcztcbiAgICB0aGlzLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgdHJpZ2dlcjogdHJ1ZSwgcmVwbGFjZTogdHJ1ZSB9LCBvcHRpb25zKTtcbiAgICB0aGlzLnNob3VsZENvbnRpbnVlUHJvY2Vzc2luZyA9IGZhbHNlO1xuICB9XG5cbiAgUmVkaXJlY3RUb1JvdXRlLnByb3RvdHlwZS5zZXRSb3V0ZXIgPSBmdW5jdGlvbiBzZXRSb3V0ZXIocm91dGVyKSB7XG4gICAgdGhpcy5yb3V0ZXIgPSByb3V0ZXI7XG4gIH07XG5cbiAgUmVkaXJlY3RUb1JvdXRlLnByb3RvdHlwZS5uYXZpZ2F0ZSA9IGZ1bmN0aW9uIG5hdmlnYXRlKGFwcFJvdXRlcikge1xuICAgIHZhciBuYXZpZ2F0aW5nUm91dGVyID0gdGhpcy5vcHRpb25zLnVzZUFwcFJvdXRlciA/IGFwcFJvdXRlciA6IHRoaXMucm91dGVyIHx8IGFwcFJvdXRlcjtcbiAgICBuYXZpZ2F0aW5nUm91dGVyLm5hdmlnYXRlVG9Sb3V0ZSh0aGlzLnJvdXRlLCB0aGlzLnBhcmFtcywgdGhpcy5vcHRpb25zKTtcbiAgfTtcblxuICByZXR1cm4gUmVkaXJlY3RUb1JvdXRlO1xufSgpO1xuXG52YXIgUm91dGVyQ29uZmlndXJhdGlvbiA9IGV4cG9ydHMuUm91dGVyQ29uZmlndXJhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUm91dGVyQ29uZmlndXJhdGlvbigpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUm91dGVyQ29uZmlndXJhdGlvbik7XG5cbiAgICB0aGlzLmluc3RydWN0aW9ucyA9IFtdO1xuICAgIHRoaXMub3B0aW9ucyA9IHt9O1xuICAgIHRoaXMucGlwZWxpbmVTdGVwcyA9IFtdO1xuICB9XG5cbiAgUm91dGVyQ29uZmlndXJhdGlvbi5wcm90b3R5cGUuYWRkUGlwZWxpbmVTdGVwID0gZnVuY3Rpb24gYWRkUGlwZWxpbmVTdGVwKG5hbWUsIHN0ZXApIHtcbiAgICB0aGlzLnBpcGVsaW5lU3RlcHMucHVzaCh7IG5hbWU6IG5hbWUsIHN0ZXA6IHN0ZXAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgUm91dGVyQ29uZmlndXJhdGlvbi5wcm90b3R5cGUuYWRkQXV0aG9yaXplU3RlcCA9IGZ1bmN0aW9uIGFkZEF1dGhvcml6ZVN0ZXAoc3RlcCkge1xuICAgIHJldHVybiB0aGlzLmFkZFBpcGVsaW5lU3RlcCgnYXV0aG9yaXplJywgc3RlcCk7XG4gIH07XG5cbiAgUm91dGVyQ29uZmlndXJhdGlvbi5wcm90b3R5cGUuYWRkUHJlQWN0aXZhdGVTdGVwID0gZnVuY3Rpb24gYWRkUHJlQWN0aXZhdGVTdGVwKHN0ZXApIHtcbiAgICByZXR1cm4gdGhpcy5hZGRQaXBlbGluZVN0ZXAoJ3ByZUFjdGl2YXRlJywgc3RlcCk7XG4gIH07XG5cbiAgUm91dGVyQ29uZmlndXJhdGlvbi5wcm90b3R5cGUuYWRkUHJlUmVuZGVyU3RlcCA9IGZ1bmN0aW9uIGFkZFByZVJlbmRlclN0ZXAoc3RlcCkge1xuICAgIHJldHVybiB0aGlzLmFkZFBpcGVsaW5lU3RlcCgncHJlUmVuZGVyJywgc3RlcCk7XG4gIH07XG5cbiAgUm91dGVyQ29uZmlndXJhdGlvbi5wcm90b3R5cGUuYWRkUG9zdFJlbmRlclN0ZXAgPSBmdW5jdGlvbiBhZGRQb3N0UmVuZGVyU3RlcChzdGVwKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkUGlwZWxpbmVTdGVwKCdwb3N0UmVuZGVyJywgc3RlcCk7XG4gIH07XG5cbiAgUm91dGVyQ29uZmlndXJhdGlvbi5wcm90b3R5cGUubWFwID0gZnVuY3Rpb24gbWFwKHJvdXRlKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkocm91dGUpKSB7XG4gICAgICByb3V0ZS5mb3JFYWNoKHRoaXMubWFwLmJpbmQodGhpcykpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMubWFwUm91dGUocm91dGUpO1xuICB9O1xuXG4gIFJvdXRlckNvbmZpZ3VyYXRpb24ucHJvdG90eXBlLm1hcFJvdXRlID0gZnVuY3Rpb24gbWFwUm91dGUoY29uZmlnKSB7XG4gICAgdGhpcy5pbnN0cnVjdGlvbnMucHVzaChmdW5jdGlvbiAocm91dGVyKSB7XG4gICAgICB2YXIgcm91dGVDb25maWdzID0gW107XG5cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGNvbmZpZy5yb3V0ZSkpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gY29uZmlnLnJvdXRlLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgICB2YXIgX2N1cnJlbnQgPSBPYmplY3QuYXNzaWduKHt9LCBjb25maWcpO1xuICAgICAgICAgIF9jdXJyZW50LnJvdXRlID0gY29uZmlnLnJvdXRlW2ldO1xuICAgICAgICAgIHJvdXRlQ29uZmlncy5wdXNoKF9jdXJyZW50KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcm91dGVDb25maWdzLnB1c2goT2JqZWN0LmFzc2lnbih7fSwgY29uZmlnKSk7XG4gICAgICB9XG5cbiAgICAgIHZhciBuYXZNb2RlbCA9IHZvaWQgMDtcbiAgICAgIGZvciAodmFyIF9pID0gMCwgX2lpID0gcm91dGVDb25maWdzLmxlbmd0aDsgX2kgPCBfaWk7ICsrX2kpIHtcbiAgICAgICAgdmFyIHJvdXRlQ29uZmlnID0gcm91dGVDb25maWdzW19pXTtcbiAgICAgICAgcm91dGVDb25maWcuc2V0dGluZ3MgPSByb3V0ZUNvbmZpZy5zZXR0aW5ncyB8fCB7fTtcbiAgICAgICAgaWYgKCFuYXZNb2RlbCkge1xuICAgICAgICAgIG5hdk1vZGVsID0gcm91dGVyLmNyZWF0ZU5hdk1vZGVsKHJvdXRlQ29uZmlnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJvdXRlci5hZGRSb3V0ZShyb3V0ZUNvbmZpZywgbmF2TW9kZWwpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgUm91dGVyQ29uZmlndXJhdGlvbi5wcm90b3R5cGUubWFwVW5rbm93blJvdXRlcyA9IGZ1bmN0aW9uIG1hcFVua25vd25Sb3V0ZXMoY29uZmlnKSB7XG4gICAgdGhpcy51bmtub3duUm91dGVDb25maWcgPSBjb25maWc7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgUm91dGVyQ29uZmlndXJhdGlvbi5wcm90b3R5cGUuZXhwb3J0VG9Sb3V0ZXIgPSBmdW5jdGlvbiBleHBvcnRUb1JvdXRlcihyb3V0ZXIpIHtcbiAgICB2YXIgaW5zdHJ1Y3Rpb25zID0gdGhpcy5pbnN0cnVjdGlvbnM7XG4gICAgZm9yICh2YXIgaSA9IDAsIGlpID0gaW5zdHJ1Y3Rpb25zLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGluc3RydWN0aW9uc1tpXShyb3V0ZXIpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnRpdGxlKSB7XG4gICAgICByb3V0ZXIudGl0bGUgPSB0aGlzLnRpdGxlO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnVua25vd25Sb3V0ZUNvbmZpZykge1xuICAgICAgcm91dGVyLmhhbmRsZVVua25vd25Sb3V0ZXModGhpcy51bmtub3duUm91dGVDb25maWcpO1xuICAgIH1cblxuICAgIHJvdXRlci5vcHRpb25zID0gdGhpcy5vcHRpb25zO1xuXG4gICAgdmFyIHBpcGVsaW5lU3RlcHMgPSB0aGlzLnBpcGVsaW5lU3RlcHM7XG4gICAgaWYgKHBpcGVsaW5lU3RlcHMubGVuZ3RoKSB7XG4gICAgICBpZiAoIXJvdXRlci5pc1Jvb3QpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQaXBlbGluZSBzdGVwcyBjYW4gb25seSBiZSBhZGRlZCB0byB0aGUgcm9vdCByb3V0ZXInKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHBpcGVsaW5lUHJvdmlkZXIgPSByb3V0ZXIucGlwZWxpbmVQcm92aWRlcjtcbiAgICAgIGZvciAodmFyIF9pMiA9IDAsIF9paTIgPSBwaXBlbGluZVN0ZXBzLmxlbmd0aDsgX2kyIDwgX2lpMjsgKytfaTIpIHtcbiAgICAgICAgdmFyIF9waXBlbGluZVN0ZXBzJF9pID0gcGlwZWxpbmVTdGVwc1tfaTJdO1xuICAgICAgICB2YXIgX25hbWUgPSBfcGlwZWxpbmVTdGVwcyRfaS5uYW1lO1xuICAgICAgICB2YXIgc3RlcCA9IF9waXBlbGluZVN0ZXBzJF9pLnN0ZXA7XG5cbiAgICAgICAgcGlwZWxpbmVQcm92aWRlci5hZGRTdGVwKF9uYW1lLCBzdGVwKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIFJvdXRlckNvbmZpZ3VyYXRpb247XG59KCk7XG5cbnZhciBhY3RpdmF0aW9uU3RyYXRlZ3kgPSBleHBvcnRzLmFjdGl2YXRpb25TdHJhdGVneSA9IHtcbiAgbm9DaGFuZ2U6ICduby1jaGFuZ2UnLFxuICBpbnZva2VMaWZlY3ljbGU6ICdpbnZva2UtbGlmZWN5Y2xlJyxcbiAgcmVwbGFjZTogJ3JlcGxhY2UnXG59O1xuXG52YXIgQnVpbGROYXZpZ2F0aW9uUGxhblN0ZXAgPSBleHBvcnRzLkJ1aWxkTmF2aWdhdGlvblBsYW5TdGVwID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBCdWlsZE5hdmlnYXRpb25QbGFuU3RlcCgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQnVpbGROYXZpZ2F0aW9uUGxhblN0ZXApO1xuICB9XG5cbiAgQnVpbGROYXZpZ2F0aW9uUGxhblN0ZXAucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uIHJ1bihuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIG5leHQpIHtcbiAgICByZXR1cm4gX2J1aWxkTmF2aWdhdGlvblBsYW4obmF2aWdhdGlvbkluc3RydWN0aW9uKS50aGVuKGZ1bmN0aW9uIChwbGFuKSB7XG4gICAgICBuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24ucGxhbiA9IHBsYW47XG4gICAgICByZXR1cm4gbmV4dCgpO1xuICAgIH0pLmNhdGNoKG5leHQuY2FuY2VsKTtcbiAgfTtcblxuICByZXR1cm4gQnVpbGROYXZpZ2F0aW9uUGxhblN0ZXA7XG59KCk7XG5cbmZ1bmN0aW9uIF9idWlsZE5hdmlnYXRpb25QbGFuKGluc3RydWN0aW9uLCBmb3JjZUxpZmVjeWNsZU1pbmltdW0pIHtcbiAgdmFyIHByZXYgPSBpbnN0cnVjdGlvbi5wcmV2aW91c0luc3RydWN0aW9uO1xuICB2YXIgY29uZmlnID0gaW5zdHJ1Y3Rpb24uY29uZmlnO1xuICB2YXIgcGxhbiA9IHt9O1xuXG4gIGlmICgncmVkaXJlY3QnIGluIGNvbmZpZykge1xuICAgIHZhciByZWRpcmVjdExvY2F0aW9uID0gX3Jlc29sdmVVcmwoY29uZmlnLnJlZGlyZWN0LCBnZXRJbnN0cnVjdGlvbkJhc2VVcmwoaW5zdHJ1Y3Rpb24pKTtcbiAgICBpZiAoaW5zdHJ1Y3Rpb24ucXVlcnlTdHJpbmcpIHtcbiAgICAgIHJlZGlyZWN0TG9jYXRpb24gKz0gJz8nICsgaW5zdHJ1Y3Rpb24ucXVlcnlTdHJpbmc7XG4gICAgfVxuXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBSZWRpcmVjdChyZWRpcmVjdExvY2F0aW9uKSk7XG4gIH1cblxuICBpZiAocHJldikge1xuICAgIHZhciBuZXdQYXJhbXMgPSBoYXNEaWZmZXJlbnRQYXJhbWV0ZXJWYWx1ZXMocHJldiwgaW5zdHJ1Y3Rpb24pO1xuICAgIHZhciBwZW5kaW5nID0gW107XG5cbiAgICB2YXIgX2xvb3AyID0gZnVuY3Rpb24gX2xvb3AyKHZpZXdQb3J0TmFtZSkge1xuICAgICAgdmFyIHByZXZWaWV3UG9ydEluc3RydWN0aW9uID0gcHJldi52aWV3UG9ydEluc3RydWN0aW9uc1t2aWV3UG9ydE5hbWVdO1xuICAgICAgdmFyIG5leHRWaWV3UG9ydENvbmZpZyA9IGNvbmZpZy52aWV3UG9ydHNbdmlld1BvcnROYW1lXTtcblxuICAgICAgaWYgKCFuZXh0Vmlld1BvcnRDb25maWcpIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBSb3V0ZSBDb25maWc6IENvbmZpZ3VyYXRpb24gZm9yIHZpZXdQb3J0IFwiJyArIHZpZXdQb3J0TmFtZSArICdcIiB3YXMgbm90IGZvdW5kIGZvciByb3V0ZTogXCInICsgaW5zdHJ1Y3Rpb24uY29uZmlnLnJvdXRlICsgJy5cIicpO1xuXG4gICAgICB2YXIgdmlld1BvcnRQbGFuID0gcGxhblt2aWV3UG9ydE5hbWVdID0ge1xuICAgICAgICBuYW1lOiB2aWV3UG9ydE5hbWUsXG4gICAgICAgIGNvbmZpZzogbmV4dFZpZXdQb3J0Q29uZmlnLFxuICAgICAgICBwcmV2Q29tcG9uZW50OiBwcmV2Vmlld1BvcnRJbnN0cnVjdGlvbi5jb21wb25lbnQsXG4gICAgICAgIHByZXZNb2R1bGVJZDogcHJldlZpZXdQb3J0SW5zdHJ1Y3Rpb24ubW9kdWxlSWRcbiAgICAgIH07XG5cbiAgICAgIGlmIChwcmV2Vmlld1BvcnRJbnN0cnVjdGlvbi5tb2R1bGVJZCAhPT0gbmV4dFZpZXdQb3J0Q29uZmlnLm1vZHVsZUlkKSB7XG4gICAgICAgIHZpZXdQb3J0UGxhbi5zdHJhdGVneSA9IGFjdGl2YXRpb25TdHJhdGVneS5yZXBsYWNlO1xuICAgICAgfSBlbHNlIGlmICgnZGV0ZXJtaW5lQWN0aXZhdGlvblN0cmF0ZWd5JyBpbiBwcmV2Vmlld1BvcnRJbnN0cnVjdGlvbi5jb21wb25lbnQudmlld01vZGVsKSB7XG4gICAgICAgIHZhciBfcHJldlZpZXdQb3J0SW5zdHJ1Y3Q7XG5cbiAgICAgICAgdmlld1BvcnRQbGFuLnN0cmF0ZWd5ID0gKF9wcmV2Vmlld1BvcnRJbnN0cnVjdCA9IHByZXZWaWV3UG9ydEluc3RydWN0aW9uLmNvbXBvbmVudC52aWV3TW9kZWwpLmRldGVybWluZUFjdGl2YXRpb25TdHJhdGVneS5hcHBseShfcHJldlZpZXdQb3J0SW5zdHJ1Y3QsIGluc3RydWN0aW9uLmxpZmVjeWNsZUFyZ3MpO1xuICAgICAgfSBlbHNlIGlmIChjb25maWcuYWN0aXZhdGlvblN0cmF0ZWd5KSB7XG4gICAgICAgIHZpZXdQb3J0UGxhbi5zdHJhdGVneSA9IGNvbmZpZy5hY3RpdmF0aW9uU3RyYXRlZ3k7XG4gICAgICB9IGVsc2UgaWYgKG5ld1BhcmFtcyB8fCBmb3JjZUxpZmVjeWNsZU1pbmltdW0pIHtcbiAgICAgICAgdmlld1BvcnRQbGFuLnN0cmF0ZWd5ID0gYWN0aXZhdGlvblN0cmF0ZWd5Lmludm9rZUxpZmVjeWNsZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZpZXdQb3J0UGxhbi5zdHJhdGVneSA9IGFjdGl2YXRpb25TdHJhdGVneS5ub0NoYW5nZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHZpZXdQb3J0UGxhbi5zdHJhdGVneSAhPT0gYWN0aXZhdGlvblN0cmF0ZWd5LnJlcGxhY2UgJiYgcHJldlZpZXdQb3J0SW5zdHJ1Y3Rpb24uY2hpbGRSb3V0ZXIpIHtcbiAgICAgICAgdmFyIHBhdGggPSBpbnN0cnVjdGlvbi5nZXRXaWxkY2FyZFBhdGgoKTtcbiAgICAgICAgdmFyIHRhc2sgPSBwcmV2Vmlld1BvcnRJbnN0cnVjdGlvbi5jaGlsZFJvdXRlci5fY3JlYXRlTmF2aWdhdGlvbkluc3RydWN0aW9uKHBhdGgsIGluc3RydWN0aW9uKS50aGVuKGZ1bmN0aW9uIChjaGlsZEluc3RydWN0aW9uKSB7XG4gICAgICAgICAgdmlld1BvcnRQbGFuLmNoaWxkTmF2aWdhdGlvbkluc3RydWN0aW9uID0gY2hpbGRJbnN0cnVjdGlvbjtcblxuICAgICAgICAgIHJldHVybiBfYnVpbGROYXZpZ2F0aW9uUGxhbihjaGlsZEluc3RydWN0aW9uLCB2aWV3UG9ydFBsYW4uc3RyYXRlZ3kgPT09IGFjdGl2YXRpb25TdHJhdGVneS5pbnZva2VMaWZlY3ljbGUpLnRoZW4oZnVuY3Rpb24gKGNoaWxkUGxhbikge1xuICAgICAgICAgICAgY2hpbGRJbnN0cnVjdGlvbi5wbGFuID0gY2hpbGRQbGFuO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBwZW5kaW5nLnB1c2godGFzayk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGZvciAodmFyIHZpZXdQb3J0TmFtZSBpbiBwcmV2LnZpZXdQb3J0SW5zdHJ1Y3Rpb25zKSB7XG4gICAgICBfbG9vcDIodmlld1BvcnROYW1lKTtcbiAgICB9XG5cbiAgICByZXR1cm4gUHJvbWlzZS5hbGwocGVuZGluZykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcGxhbjtcbiAgICB9KTtcbiAgfVxuXG4gIGZvciAodmFyIF92aWV3UG9ydE5hbWUgaW4gY29uZmlnLnZpZXdQb3J0cykge1xuICAgIHBsYW5bX3ZpZXdQb3J0TmFtZV0gPSB7XG4gICAgICBuYW1lOiBfdmlld1BvcnROYW1lLFxuICAgICAgc3RyYXRlZ3k6IGFjdGl2YXRpb25TdHJhdGVneS5yZXBsYWNlLFxuICAgICAgY29uZmlnOiBpbnN0cnVjdGlvbi5jb25maWcudmlld1BvcnRzW192aWV3UG9ydE5hbWVdXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiBQcm9taXNlLnJlc29sdmUocGxhbik7XG59XG5cbmZ1bmN0aW9uIGhhc0RpZmZlcmVudFBhcmFtZXRlclZhbHVlcyhwcmV2LCBuZXh0KSB7XG4gIHZhciBwcmV2UGFyYW1zID0gcHJldi5wYXJhbXM7XG4gIHZhciBuZXh0UGFyYW1zID0gbmV4dC5wYXJhbXM7XG4gIHZhciBuZXh0V2lsZENhcmROYW1lID0gbmV4dC5jb25maWcuaGFzQ2hpbGRSb3V0ZXIgPyBuZXh0LmdldFdpbGRDYXJkTmFtZSgpIDogbnVsbDtcblxuICBmb3IgKHZhciBrZXkgaW4gbmV4dFBhcmFtcykge1xuICAgIGlmIChrZXkgPT09IG5leHRXaWxkQ2FyZE5hbWUpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmIChwcmV2UGFyYW1zW2tleV0gIT09IG5leHRQYXJhbXNba2V5XSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG5cbiAgZm9yICh2YXIgX2tleSBpbiBwcmV2UGFyYW1zKSB7XG4gICAgaWYgKF9rZXkgPT09IG5leHRXaWxkQ2FyZE5hbWUpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmIChwcmV2UGFyYW1zW19rZXldICE9PSBuZXh0UGFyYW1zW19rZXldKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBpZiAoIW5leHQub3B0aW9ucy5jb21wYXJlUXVlcnlQYXJhbXMpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICB2YXIgcHJldlF1ZXJ5UGFyYW1zID0gcHJldi5xdWVyeVBhcmFtcztcbiAgdmFyIG5leHRRdWVyeVBhcmFtcyA9IG5leHQucXVlcnlQYXJhbXM7XG4gIGZvciAodmFyIF9rZXkyIGluIG5leHRRdWVyeVBhcmFtcykge1xuICAgIGlmIChwcmV2UXVlcnlQYXJhbXNbX2tleTJdICE9PSBuZXh0UXVlcnlQYXJhbXNbX2tleTJdKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBmb3IgKHZhciBfa2V5MyBpbiBwcmV2UXVlcnlQYXJhbXMpIHtcbiAgICBpZiAocHJldlF1ZXJ5UGFyYW1zW19rZXkzXSAhPT0gbmV4dFF1ZXJ5UGFyYW1zW19rZXkzXSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiBnZXRJbnN0cnVjdGlvbkJhc2VVcmwoaW5zdHJ1Y3Rpb24pIHtcbiAgdmFyIGluc3RydWN0aW9uQmFzZVVybFBhcnRzID0gW107XG4gIGluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb24ucGFyZW50SW5zdHJ1Y3Rpb247XG5cbiAgd2hpbGUgKGluc3RydWN0aW9uKSB7XG4gICAgaW5zdHJ1Y3Rpb25CYXNlVXJsUGFydHMudW5zaGlmdChpbnN0cnVjdGlvbi5nZXRCYXNlVXJsKCkpO1xuICAgIGluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb24ucGFyZW50SW5zdHJ1Y3Rpb247XG4gIH1cblxuICBpbnN0cnVjdGlvbkJhc2VVcmxQYXJ0cy51bnNoaWZ0KCcvJyk7XG4gIHJldHVybiBpbnN0cnVjdGlvbkJhc2VVcmxQYXJ0cy5qb2luKCcnKTtcbn1cblxudmFyIFJvdXRlciA9IGV4cG9ydHMuUm91dGVyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBSb3V0ZXIoY29udGFpbmVyLCBoaXN0b3J5KSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJvdXRlcik7XG5cbiAgICB0aGlzLnBhcmVudCA9IG51bGw7XG4gICAgdGhpcy5vcHRpb25zID0ge307XG5cbiAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICB0aGlzLmhpc3RvcnkgPSBoaXN0b3J5O1xuICAgIHRoaXMucmVzZXQoKTtcbiAgfVxuXG4gIFJvdXRlci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiByZXNldCgpIHtcbiAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgIHRoaXMudmlld1BvcnRzID0ge307XG4gICAgdGhpcy5yb3V0ZXMgPSBbXTtcbiAgICB0aGlzLmJhc2VVcmwgPSAnJztcbiAgICB0aGlzLmlzQ29uZmlndXJlZCA9IGZhbHNlO1xuICAgIHRoaXMuaXNOYXZpZ2F0aW5nID0gZmFsc2U7XG4gICAgdGhpcy5uYXZpZ2F0aW9uID0gW107XG4gICAgdGhpcy5jdXJyZW50SW5zdHJ1Y3Rpb24gPSBudWxsO1xuICAgIHRoaXMuX2ZhbGxiYWNrT3JkZXIgPSAxMDA7XG4gICAgdGhpcy5fcmVjb2duaXplciA9IG5ldyBfYXVyZWxpYVJvdXRlUmVjb2duaXplci5Sb3V0ZVJlY29nbml6ZXIoKTtcbiAgICB0aGlzLl9jaGlsZFJlY29nbml6ZXIgPSBuZXcgX2F1cmVsaWFSb3V0ZVJlY29nbml6ZXIuUm91dGVSZWNvZ25pemVyKCk7XG4gICAgdGhpcy5fY29uZmlndXJlZFByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgX3RoaXMyLl9yZXNvbHZlQ29uZmlndXJlZFByb21pc2UgPSByZXNvbHZlO1xuICAgIH0pO1xuICB9O1xuXG4gIFJvdXRlci5wcm90b3R5cGUucmVnaXN0ZXJWaWV3UG9ydCA9IGZ1bmN0aW9uIHJlZ2lzdGVyVmlld1BvcnQodmlld1BvcnQsIG5hbWUpIHtcbiAgICBuYW1lID0gbmFtZSB8fCAnZGVmYXVsdCc7XG4gICAgdGhpcy52aWV3UG9ydHNbbmFtZV0gPSB2aWV3UG9ydDtcbiAgfTtcblxuICBSb3V0ZXIucHJvdG90eXBlLmVuc3VyZUNvbmZpZ3VyZWQgPSBmdW5jdGlvbiBlbnN1cmVDb25maWd1cmVkKCkge1xuICAgIHJldHVybiB0aGlzLl9jb25maWd1cmVkUHJvbWlzZTtcbiAgfTtcblxuICBSb3V0ZXIucHJvdG90eXBlLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uIGNvbmZpZ3VyZShjYWxsYmFja09yQ29uZmlnKSB7XG4gICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICB0aGlzLmlzQ29uZmlndXJlZCA9IHRydWU7XG5cbiAgICB2YXIgcmVzdWx0ID0gY2FsbGJhY2tPckNvbmZpZztcbiAgICB2YXIgY29uZmlnID0gdm9pZCAwO1xuICAgIGlmICh0eXBlb2YgY2FsbGJhY2tPckNvbmZpZyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgY29uZmlnID0gbmV3IFJvdXRlckNvbmZpZ3VyYXRpb24oKTtcbiAgICAgIHJlc3VsdCA9IGNhbGxiYWNrT3JDb25maWcoY29uZmlnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3VsdCkudGhlbihmdW5jdGlvbiAoYykge1xuICAgICAgaWYgKGMgJiYgYy5leHBvcnRUb1JvdXRlcikge1xuICAgICAgICBjb25maWcgPSBjO1xuICAgICAgfVxuXG4gICAgICBjb25maWcuZXhwb3J0VG9Sb3V0ZXIoX3RoaXMzKTtcbiAgICAgIF90aGlzMy5pc0NvbmZpZ3VyZWQgPSB0cnVlO1xuICAgICAgX3RoaXMzLl9yZXNvbHZlQ29uZmlndXJlZFByb21pc2UoKTtcbiAgICB9KTtcbiAgfTtcblxuICBSb3V0ZXIucHJvdG90eXBlLm5hdmlnYXRlID0gZnVuY3Rpb24gbmF2aWdhdGUoZnJhZ21lbnQsIG9wdGlvbnMpIHtcbiAgICBpZiAoIXRoaXMuaXNDb25maWd1cmVkICYmIHRoaXMucGFyZW50KSB7XG4gICAgICByZXR1cm4gdGhpcy5wYXJlbnQubmF2aWdhdGUoZnJhZ21lbnQsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmhpc3RvcnkubmF2aWdhdGUoX3Jlc29sdmVVcmwoZnJhZ21lbnQsIHRoaXMuYmFzZVVybCwgdGhpcy5oaXN0b3J5Ll9oYXNQdXNoU3RhdGUpLCBvcHRpb25zKTtcbiAgfTtcblxuICBSb3V0ZXIucHJvdG90eXBlLm5hdmlnYXRlVG9Sb3V0ZSA9IGZ1bmN0aW9uIG5hdmlnYXRlVG9Sb3V0ZShyb3V0ZSwgcGFyYW1zLCBvcHRpb25zKSB7XG4gICAgdmFyIHBhdGggPSB0aGlzLmdlbmVyYXRlKHJvdXRlLCBwYXJhbXMpO1xuICAgIHJldHVybiB0aGlzLm5hdmlnYXRlKHBhdGgsIG9wdGlvbnMpO1xuICB9O1xuXG4gIFJvdXRlci5wcm90b3R5cGUubmF2aWdhdGVCYWNrID0gZnVuY3Rpb24gbmF2aWdhdGVCYWNrKCkge1xuICAgIHRoaXMuaGlzdG9yeS5uYXZpZ2F0ZUJhY2soKTtcbiAgfTtcblxuICBSb3V0ZXIucHJvdG90eXBlLmNyZWF0ZUNoaWxkID0gZnVuY3Rpb24gY3JlYXRlQ2hpbGQoY29udGFpbmVyKSB7XG4gICAgdmFyIGNoaWxkUm91dGVyID0gbmV3IFJvdXRlcihjb250YWluZXIgfHwgdGhpcy5jb250YWluZXIuY3JlYXRlQ2hpbGQoKSwgdGhpcy5oaXN0b3J5KTtcbiAgICBjaGlsZFJvdXRlci5wYXJlbnQgPSB0aGlzO1xuICAgIHJldHVybiBjaGlsZFJvdXRlcjtcbiAgfTtcblxuICBSb3V0ZXIucHJvdG90eXBlLmdlbmVyYXRlID0gZnVuY3Rpb24gZ2VuZXJhdGUobmFtZSwgcGFyYW1zKSB7XG4gICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDIgfHwgYXJndW1lbnRzWzJdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1syXTtcblxuICAgIHZhciBoYXNSb3V0ZSA9IHRoaXMuX3JlY29nbml6ZXIuaGFzUm91dGUobmFtZSk7XG4gICAgaWYgKCghdGhpcy5pc0NvbmZpZ3VyZWQgfHwgIWhhc1JvdXRlKSAmJiB0aGlzLnBhcmVudCkge1xuICAgICAgcmV0dXJuIHRoaXMucGFyZW50LmdlbmVyYXRlKG5hbWUsIHBhcmFtcyk7XG4gICAgfVxuXG4gICAgaWYgKCFoYXNSb3V0ZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdBIHJvdXRlIHdpdGggbmFtZSBcXCcnICsgbmFtZSArICdcXCcgY291bGQgbm90IGJlIGZvdW5kLiBDaGVjayB0aGF0IGBuYW1lOiBcXCcnICsgbmFtZSArICdcXCdgIHdhcyBzcGVjaWZpZWQgaW4gdGhlIHJvdXRlXFwncyBjb25maWcuJyk7XG4gICAgfVxuXG4gICAgdmFyIHBhdGggPSB0aGlzLl9yZWNvZ25pemVyLmdlbmVyYXRlKG5hbWUsIHBhcmFtcyk7XG4gICAgdmFyIHJvb3RlZFBhdGggPSBfY3JlYXRlUm9vdGVkUGF0aChwYXRoLCB0aGlzLmJhc2VVcmwsIHRoaXMuaGlzdG9yeS5faGFzUHVzaFN0YXRlLCBvcHRpb25zLmFic29sdXRlKTtcbiAgICByZXR1cm4gb3B0aW9ucy5hYnNvbHV0ZSA/ICcnICsgdGhpcy5oaXN0b3J5LmdldEFic29sdXRlUm9vdCgpICsgcm9vdGVkUGF0aCA6IHJvb3RlZFBhdGg7XG4gIH07XG5cbiAgUm91dGVyLnByb3RvdHlwZS5jcmVhdGVOYXZNb2RlbCA9IGZ1bmN0aW9uIGNyZWF0ZU5hdk1vZGVsKGNvbmZpZykge1xuICAgIHZhciBuYXZNb2RlbCA9IG5ldyBOYXZNb2RlbCh0aGlzLCAnaHJlZicgaW4gY29uZmlnID8gY29uZmlnLmhyZWYgOiBjb25maWcucm91dGUpO1xuICAgIG5hdk1vZGVsLnRpdGxlID0gY29uZmlnLnRpdGxlO1xuICAgIG5hdk1vZGVsLm9yZGVyID0gY29uZmlnLm5hdjtcbiAgICBuYXZNb2RlbC5ocmVmID0gY29uZmlnLmhyZWY7XG4gICAgbmF2TW9kZWwuc2V0dGluZ3MgPSBjb25maWcuc2V0dGluZ3M7XG4gICAgbmF2TW9kZWwuY29uZmlnID0gY29uZmlnO1xuXG4gICAgcmV0dXJuIG5hdk1vZGVsO1xuICB9O1xuXG4gIFJvdXRlci5wcm90b3R5cGUuYWRkUm91dGUgPSBmdW5jdGlvbiBhZGRSb3V0ZShjb25maWcsIG5hdk1vZGVsKSB7XG4gICAgdmFsaWRhdGVSb3V0ZUNvbmZpZyhjb25maWcpO1xuXG4gICAgaWYgKCEoJ3ZpZXdQb3J0cycgaW4gY29uZmlnKSAmJiAhY29uZmlnLm5hdmlnYXRpb25TdHJhdGVneSkge1xuICAgICAgY29uZmlnLnZpZXdQb3J0cyA9IHtcbiAgICAgICAgJ2RlZmF1bHQnOiB7XG4gICAgICAgICAgbW9kdWxlSWQ6IGNvbmZpZy5tb2R1bGVJZCxcbiAgICAgICAgICB2aWV3OiBjb25maWcudmlld1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cblxuICAgIGlmICghbmF2TW9kZWwpIHtcbiAgICAgIG5hdk1vZGVsID0gdGhpcy5jcmVhdGVOYXZNb2RlbChjb25maWcpO1xuICAgIH1cblxuICAgIHRoaXMucm91dGVzLnB1c2goY29uZmlnKTtcblxuICAgIHZhciBwYXRoID0gY29uZmlnLnJvdXRlO1xuICAgIGlmIChwYXRoLmNoYXJBdCgwKSA9PT0gJy8nKSB7XG4gICAgICBwYXRoID0gcGF0aC5zdWJzdHIoMSk7XG4gICAgfVxuICAgIHZhciBjYXNlU2Vuc2l0aXZlID0gY29uZmlnLmNhc2VTZW5zaXRpdmUgPT09IHRydWU7XG4gICAgdmFyIHN0YXRlID0gdGhpcy5fcmVjb2duaXplci5hZGQoeyBwYXRoOiBwYXRoLCBoYW5kbGVyOiBjb25maWcsIGNhc2VTZW5zaXRpdmU6IGNhc2VTZW5zaXRpdmUgfSk7XG5cbiAgICBpZiAocGF0aCkge1xuICAgICAgdmFyIF9zZXR0aW5ncyA9IGNvbmZpZy5zZXR0aW5ncztcbiAgICAgIGRlbGV0ZSBjb25maWcuc2V0dGluZ3M7XG4gICAgICB2YXIgd2l0aENoaWxkID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb25maWcpKTtcbiAgICAgIGNvbmZpZy5zZXR0aW5ncyA9IF9zZXR0aW5ncztcbiAgICAgIHdpdGhDaGlsZC5yb3V0ZSA9IHBhdGggKyAnLypjaGlsZFJvdXRlJztcbiAgICAgIHdpdGhDaGlsZC5oYXNDaGlsZFJvdXRlciA9IHRydWU7XG4gICAgICB0aGlzLl9jaGlsZFJlY29nbml6ZXIuYWRkKHtcbiAgICAgICAgcGF0aDogd2l0aENoaWxkLnJvdXRlLFxuICAgICAgICBoYW5kbGVyOiB3aXRoQ2hpbGQsXG4gICAgICAgIGNhc2VTZW5zaXRpdmU6IGNhc2VTZW5zaXRpdmVcbiAgICAgIH0pO1xuXG4gICAgICB3aXRoQ2hpbGQubmF2TW9kZWwgPSBuYXZNb2RlbDtcbiAgICAgIHdpdGhDaGlsZC5zZXR0aW5ncyA9IGNvbmZpZy5zZXR0aW5ncztcbiAgICB9XG5cbiAgICBjb25maWcubmF2TW9kZWwgPSBuYXZNb2RlbDtcblxuICAgIGlmICgobmF2TW9kZWwub3JkZXIgfHwgbmF2TW9kZWwub3JkZXIgPT09IDApICYmIHRoaXMubmF2aWdhdGlvbi5pbmRleE9mKG5hdk1vZGVsKSA9PT0gLTEpIHtcbiAgICAgIGlmICghbmF2TW9kZWwuaHJlZiAmJiBuYXZNb2RlbC5ocmVmICE9PSAnJyAmJiAoc3RhdGUudHlwZXMuZHluYW1pY3MgfHwgc3RhdGUudHlwZXMuc3RhcnMpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCByb3V0ZSBjb25maWc6IGR5bmFtaWMgcm91dGVzIG11c3Qgc3BlY2lmeSBhbiBocmVmIHRvIGJlIGluY2x1ZGVkIGluIHRoZSBuYXZpZ2F0aW9uIG1vZGVsLicpO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIG5hdk1vZGVsLm9yZGVyICE9PSAnbnVtYmVyJykge1xuICAgICAgICBuYXZNb2RlbC5vcmRlciA9ICsrdGhpcy5fZmFsbGJhY2tPcmRlcjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5uYXZpZ2F0aW9uLnB1c2gobmF2TW9kZWwpO1xuICAgICAgdGhpcy5uYXZpZ2F0aW9uID0gdGhpcy5uYXZpZ2F0aW9uLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGEub3JkZXIgLSBiLm9yZGVyO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIFJvdXRlci5wcm90b3R5cGUuaGFzUm91dGUgPSBmdW5jdGlvbiBoYXNSb3V0ZShuYW1lKSB7XG4gICAgcmV0dXJuICEhKHRoaXMuX3JlY29nbml6ZXIuaGFzUm91dGUobmFtZSkgfHwgdGhpcy5wYXJlbnQgJiYgdGhpcy5wYXJlbnQuaGFzUm91dGUobmFtZSkpO1xuICB9O1xuXG4gIFJvdXRlci5wcm90b3R5cGUuaGFzT3duUm91dGUgPSBmdW5jdGlvbiBoYXNPd25Sb3V0ZShuYW1lKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlY29nbml6ZXIuaGFzUm91dGUobmFtZSk7XG4gIH07XG5cbiAgUm91dGVyLnByb3RvdHlwZS5oYW5kbGVVbmtub3duUm91dGVzID0gZnVuY3Rpb24gaGFuZGxlVW5rbm93blJvdXRlcyhjb25maWcpIHtcbiAgICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICAgIGlmICghY29uZmlnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdW5rbm93biByb3V0ZSBoYW5kbGVyJyk7XG4gICAgfVxuXG4gICAgdGhpcy5jYXRjaEFsbEhhbmRsZXIgPSBmdW5jdGlvbiAoaW5zdHJ1Y3Rpb24pIHtcbiAgICAgIHJldHVybiBfdGhpczQuX2NyZWF0ZVJvdXRlQ29uZmlnKGNvbmZpZywgaW5zdHJ1Y3Rpb24pLnRoZW4oZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgaW5zdHJ1Y3Rpb24uY29uZmlnID0gYztcbiAgICAgICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfTtcblxuICBSb3V0ZXIucHJvdG90eXBlLnVwZGF0ZVRpdGxlID0gZnVuY3Rpb24gdXBkYXRlVGl0bGUoKSB7XG4gICAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICByZXR1cm4gdGhpcy5wYXJlbnQudXBkYXRlVGl0bGUoKTtcbiAgICB9XG5cbiAgICB0aGlzLmN1cnJlbnRJbnN0cnVjdGlvbi5fdXBkYXRlVGl0bGUoKTtcbiAgfTtcblxuICBSb3V0ZXIucHJvdG90eXBlLnJlZnJlc2hOYXZpZ2F0aW9uID0gZnVuY3Rpb24gcmVmcmVzaE5hdmlnYXRpb24oKSB7XG4gICAgdmFyIG5hdiA9IHRoaXMubmF2aWdhdGlvbjtcblxuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBuYXYubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBfY3VycmVudDIgPSBuYXZbaV07XG4gICAgICBpZiAoIV9jdXJyZW50Mi5jb25maWcuaHJlZikge1xuICAgICAgICBfY3VycmVudDIuaHJlZiA9IF9jcmVhdGVSb290ZWRQYXRoKF9jdXJyZW50Mi5yZWxhdGl2ZUhyZWYsIHRoaXMuYmFzZVVybCwgdGhpcy5oaXN0b3J5Ll9oYXNQdXNoU3RhdGUpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBSb3V0ZXIucHJvdG90eXBlLl9yZWZyZXNoQmFzZVVybCA9IGZ1bmN0aW9uIF9yZWZyZXNoQmFzZVVybCgpIHtcbiAgICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgIHZhciBiYXNlVXJsID0gdGhpcy5wYXJlbnQuY3VycmVudEluc3RydWN0aW9uLmdldEJhc2VVcmwoKTtcbiAgICAgIHRoaXMuYmFzZVVybCA9IHRoaXMucGFyZW50LmJhc2VVcmwgKyBiYXNlVXJsO1xuICAgIH1cbiAgfTtcblxuICBSb3V0ZXIucHJvdG90eXBlLl9jcmVhdGVOYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24gPSBmdW5jdGlvbiBfY3JlYXRlTmF2aWdhdGlvbkluc3RydWN0aW9uKCkge1xuICAgIHZhciB1cmwgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyAnJyA6IGFyZ3VtZW50c1swXTtcbiAgICB2YXIgcGFyZW50SW5zdHJ1Y3Rpb24gPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyBudWxsIDogYXJndW1lbnRzWzFdO1xuXG4gICAgdmFyIGZyYWdtZW50ID0gdXJsO1xuICAgIHZhciBxdWVyeVN0cmluZyA9ICcnO1xuXG4gICAgdmFyIHF1ZXJ5SW5kZXggPSB1cmwuaW5kZXhPZignPycpO1xuICAgIGlmIChxdWVyeUluZGV4ICE9PSAtMSkge1xuICAgICAgZnJhZ21lbnQgPSB1cmwuc3Vic3RyKDAsIHF1ZXJ5SW5kZXgpO1xuICAgICAgcXVlcnlTdHJpbmcgPSB1cmwuc3Vic3RyKHF1ZXJ5SW5kZXggKyAxKTtcbiAgICB9XG5cbiAgICB2YXIgcmVzdWx0cyA9IHRoaXMuX3JlY29nbml6ZXIucmVjb2duaXplKHVybCk7XG4gICAgaWYgKCFyZXN1bHRzIHx8ICFyZXN1bHRzLmxlbmd0aCkge1xuICAgICAgcmVzdWx0cyA9IHRoaXMuX2NoaWxkUmVjb2duaXplci5yZWNvZ25pemUodXJsKTtcbiAgICB9XG5cbiAgICB2YXIgaW5zdHJ1Y3Rpb25Jbml0ID0ge1xuICAgICAgZnJhZ21lbnQ6IGZyYWdtZW50LFxuICAgICAgcXVlcnlTdHJpbmc6IHF1ZXJ5U3RyaW5nLFxuICAgICAgY29uZmlnOiBudWxsLFxuICAgICAgcGFyZW50SW5zdHJ1Y3Rpb246IHBhcmVudEluc3RydWN0aW9uLFxuICAgICAgcHJldmlvdXNJbnN0cnVjdGlvbjogdGhpcy5jdXJyZW50SW5zdHJ1Y3Rpb24sXG4gICAgICByb3V0ZXI6IHRoaXMsXG4gICAgICBvcHRpb25zOiB7XG4gICAgICAgIGNvbXBhcmVRdWVyeVBhcmFtczogdGhpcy5vcHRpb25zLmNvbXBhcmVRdWVyeVBhcmFtc1xuICAgICAgfVxuICAgIH07XG5cbiAgICBpZiAocmVzdWx0cyAmJiByZXN1bHRzLmxlbmd0aCkge1xuICAgICAgdmFyIGZpcnN0ID0gcmVzdWx0c1swXTtcbiAgICAgIHZhciBfaW5zdHJ1Y3Rpb24gPSBuZXcgTmF2aWdhdGlvbkluc3RydWN0aW9uKE9iamVjdC5hc3NpZ24oe30sIGluc3RydWN0aW9uSW5pdCwge1xuICAgICAgICBwYXJhbXM6IGZpcnN0LnBhcmFtcyxcbiAgICAgICAgcXVlcnlQYXJhbXM6IGZpcnN0LnF1ZXJ5UGFyYW1zIHx8IHJlc3VsdHMucXVlcnlQYXJhbXMsXG4gICAgICAgIGNvbmZpZzogZmlyc3QuY29uZmlnIHx8IGZpcnN0LmhhbmRsZXJcbiAgICAgIH0pKTtcblxuICAgICAgaWYgKHR5cGVvZiBmaXJzdC5oYW5kbGVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJldHVybiBldmFsdWF0ZU5hdmlnYXRpb25TdHJhdGVneShfaW5zdHJ1Y3Rpb24sIGZpcnN0LmhhbmRsZXIsIGZpcnN0KTtcbiAgICAgIH0gZWxzZSBpZiAoZmlyc3QuaGFuZGxlciAmJiAnbmF2aWdhdGlvblN0cmF0ZWd5JyBpbiBmaXJzdC5oYW5kbGVyKSB7XG4gICAgICAgIHJldHVybiBldmFsdWF0ZU5hdmlnYXRpb25TdHJhdGVneShfaW5zdHJ1Y3Rpb24sIGZpcnN0LmhhbmRsZXIubmF2aWdhdGlvblN0cmF0ZWd5LCBmaXJzdC5oYW5kbGVyKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShfaW5zdHJ1Y3Rpb24pO1xuICAgIH0gZWxzZSBpZiAodGhpcy5jYXRjaEFsbEhhbmRsZXIpIHtcbiAgICAgIHZhciBfaW5zdHJ1Y3Rpb24yID0gbmV3IE5hdmlnYXRpb25JbnN0cnVjdGlvbihPYmplY3QuYXNzaWduKHt9LCBpbnN0cnVjdGlvbkluaXQsIHtcbiAgICAgICAgcGFyYW1zOiB7IHBhdGg6IGZyYWdtZW50IH0sXG4gICAgICAgIHF1ZXJ5UGFyYW1zOiByZXN1bHRzICYmIHJlc3VsdHMucXVlcnlQYXJhbXMsXG4gICAgICAgIGNvbmZpZzogbnVsbCB9KSk7XG5cbiAgICAgIHJldHVybiBldmFsdWF0ZU5hdmlnYXRpb25TdHJhdGVneShfaW5zdHJ1Y3Rpb24yLCB0aGlzLmNhdGNoQWxsSGFuZGxlcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignUm91dGUgbm90IGZvdW5kOiAnICsgdXJsKSk7XG4gIH07XG5cbiAgUm91dGVyLnByb3RvdHlwZS5fY3JlYXRlUm91dGVDb25maWcgPSBmdW5jdGlvbiBfY3JlYXRlUm91dGVDb25maWcoY29uZmlnLCBpbnN0cnVjdGlvbikge1xuICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShjb25maWcpLnRoZW4oZnVuY3Rpb24gKGMpIHtcbiAgICAgIGlmICh0eXBlb2YgYyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuIHsgbW9kdWxlSWQ6IGMgfTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIGMoaW5zdHJ1Y3Rpb24pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYztcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChjKSB7XG4gICAgICByZXR1cm4gdHlwZW9mIGMgPT09ICdzdHJpbmcnID8geyBtb2R1bGVJZDogYyB9IDogYztcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChjKSB7XG4gICAgICBjLnJvdXRlID0gaW5zdHJ1Y3Rpb24ucGFyYW1zLnBhdGg7XG4gICAgICB2YWxpZGF0ZVJvdXRlQ29uZmlnKGMpO1xuXG4gICAgICBpZiAoIWMubmF2TW9kZWwpIHtcbiAgICAgICAgYy5uYXZNb2RlbCA9IF90aGlzNS5jcmVhdGVOYXZNb2RlbChjKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGM7XG4gICAgfSk7XG4gIH07XG5cbiAgX2NyZWF0ZUNsYXNzKFJvdXRlciwgW3tcbiAgICBrZXk6ICdpc1Jvb3QnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuICF0aGlzLnBhcmVudDtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gUm91dGVyO1xufSgpO1xuXG5mdW5jdGlvbiB2YWxpZGF0ZVJvdXRlQ29uZmlnKGNvbmZpZykge1xuICBpZiAoKHR5cGVvZiBjb25maWcgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKGNvbmZpZykpICE9PSAnb2JqZWN0Jykge1xuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBSb3V0ZSBDb25maWcnKTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgY29uZmlnLnJvdXRlICE9PSAnc3RyaW5nJykge1xuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBSb3V0ZSBDb25maWc6IFlvdSBtdXN0IHNwZWNpZnkgYSByb3V0ZSBwYXR0ZXJuLicpO1xuICB9XG5cbiAgaWYgKCEoJ3JlZGlyZWN0JyBpbiBjb25maWcgfHwgY29uZmlnLm1vZHVsZUlkIHx8IGNvbmZpZy5uYXZpZ2F0aW9uU3RyYXRlZ3kgfHwgY29uZmlnLnZpZXdQb3J0cykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgUm91dGUgQ29uZmlnOiBZb3UgbXVzdCBzcGVjaWZ5IGEgbW9kdWxlSWQsIHJlZGlyZWN0LCBuYXZpZ2F0aW9uU3RyYXRlZ3ksIG9yIHZpZXdQb3J0cy4nKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBldmFsdWF0ZU5hdmlnYXRpb25TdHJhdGVneShpbnN0cnVjdGlvbiwgZXZhbHVhdG9yLCBjb250ZXh0KSB7XG4gIHJldHVybiBQcm9taXNlLnJlc29sdmUoZXZhbHVhdG9yLmNhbGwoY29udGV4dCwgaW5zdHJ1Y3Rpb24pKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoISgndmlld1BvcnRzJyBpbiBpbnN0cnVjdGlvbi5jb25maWcpKSB7XG4gICAgICBpbnN0cnVjdGlvbi5jb25maWcudmlld1BvcnRzID0ge1xuICAgICAgICAnZGVmYXVsdCc6IHtcbiAgICAgICAgICBtb2R1bGVJZDogaW5zdHJ1Y3Rpb24uY29uZmlnLm1vZHVsZUlkXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9KTtcbn1cblxudmFyIENhbkRlYWN0aXZhdGVQcmV2aW91c1N0ZXAgPSBleHBvcnRzLkNhbkRlYWN0aXZhdGVQcmV2aW91c1N0ZXAgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIENhbkRlYWN0aXZhdGVQcmV2aW91c1N0ZXAoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENhbkRlYWN0aXZhdGVQcmV2aW91c1N0ZXApO1xuICB9XG5cbiAgQ2FuRGVhY3RpdmF0ZVByZXZpb3VzU3RlcC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gcnVuKG5hdmlnYXRpb25JbnN0cnVjdGlvbiwgbmV4dCkge1xuICAgIHJldHVybiBwcm9jZXNzRGVhY3RpdmF0YWJsZShuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24ucGxhbiwgJ2NhbkRlYWN0aXZhdGUnLCBuZXh0KTtcbiAgfTtcblxuICByZXR1cm4gQ2FuRGVhY3RpdmF0ZVByZXZpb3VzU3RlcDtcbn0oKTtcblxudmFyIENhbkFjdGl2YXRlTmV4dFN0ZXAgPSBleHBvcnRzLkNhbkFjdGl2YXRlTmV4dFN0ZXAgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIENhbkFjdGl2YXRlTmV4dFN0ZXAoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENhbkFjdGl2YXRlTmV4dFN0ZXApO1xuICB9XG5cbiAgQ2FuQWN0aXZhdGVOZXh0U3RlcC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gcnVuKG5hdmlnYXRpb25JbnN0cnVjdGlvbiwgbmV4dCkge1xuICAgIHJldHVybiBwcm9jZXNzQWN0aXZhdGFibGUobmF2aWdhdGlvbkluc3RydWN0aW9uLCAnY2FuQWN0aXZhdGUnLCBuZXh0KTtcbiAgfTtcblxuICByZXR1cm4gQ2FuQWN0aXZhdGVOZXh0U3RlcDtcbn0oKTtcblxudmFyIERlYWN0aXZhdGVQcmV2aW91c1N0ZXAgPSBleHBvcnRzLkRlYWN0aXZhdGVQcmV2aW91c1N0ZXAgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIERlYWN0aXZhdGVQcmV2aW91c1N0ZXAoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERlYWN0aXZhdGVQcmV2aW91c1N0ZXApO1xuICB9XG5cbiAgRGVhY3RpdmF0ZVByZXZpb3VzU3RlcC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gcnVuKG5hdmlnYXRpb25JbnN0cnVjdGlvbiwgbmV4dCkge1xuICAgIHJldHVybiBwcm9jZXNzRGVhY3RpdmF0YWJsZShuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24ucGxhbiwgJ2RlYWN0aXZhdGUnLCBuZXh0LCB0cnVlKTtcbiAgfTtcblxuICByZXR1cm4gRGVhY3RpdmF0ZVByZXZpb3VzU3RlcDtcbn0oKTtcblxudmFyIEFjdGl2YXRlTmV4dFN0ZXAgPSBleHBvcnRzLkFjdGl2YXRlTmV4dFN0ZXAgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEFjdGl2YXRlTmV4dFN0ZXAoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFjdGl2YXRlTmV4dFN0ZXApO1xuICB9XG5cbiAgQWN0aXZhdGVOZXh0U3RlcC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gcnVuKG5hdmlnYXRpb25JbnN0cnVjdGlvbiwgbmV4dCkge1xuICAgIHJldHVybiBwcm9jZXNzQWN0aXZhdGFibGUobmF2aWdhdGlvbkluc3RydWN0aW9uLCAnYWN0aXZhdGUnLCBuZXh0LCB0cnVlKTtcbiAgfTtcblxuICByZXR1cm4gQWN0aXZhdGVOZXh0U3RlcDtcbn0oKTtcblxuZnVuY3Rpb24gcHJvY2Vzc0RlYWN0aXZhdGFibGUocGxhbiwgY2FsbGJhY2tOYW1lLCBuZXh0LCBpZ25vcmVSZXN1bHQpIHtcbiAgdmFyIGluZm9zID0gZmluZERlYWN0aXZhdGFibGUocGxhbiwgY2FsbGJhY2tOYW1lKTtcbiAgdmFyIGkgPSBpbmZvcy5sZW5ndGg7XG5cbiAgZnVuY3Rpb24gaW5zcGVjdCh2YWwpIHtcbiAgICBpZiAoaWdub3JlUmVzdWx0IHx8IHNob3VsZENvbnRpbnVlKHZhbCkpIHtcbiAgICAgIHJldHVybiBpdGVyYXRlKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5leHQuY2FuY2VsKHZhbCk7XG4gIH1cblxuICBmdW5jdGlvbiBpdGVyYXRlKCkge1xuICAgIGlmIChpLS0pIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhciB2aWV3TW9kZWwgPSBpbmZvc1tpXTtcbiAgICAgICAgdmFyIF9yZXN1bHQgPSB2aWV3TW9kZWxbY2FsbGJhY2tOYW1lXSgpO1xuICAgICAgICByZXR1cm4gcHJvY2Vzc1BvdGVudGlhbChfcmVzdWx0LCBpbnNwZWN0LCBuZXh0LmNhbmNlbCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbmV4dC5jYW5jZWwoZXJyb3IpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBuZXh0KCk7XG4gIH1cblxuICByZXR1cm4gaXRlcmF0ZSgpO1xufVxuXG5mdW5jdGlvbiBmaW5kRGVhY3RpdmF0YWJsZShwbGFuLCBjYWxsYmFja05hbWUpIHtcbiAgdmFyIGxpc3QgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDIgfHwgYXJndW1lbnRzWzJdID09PSB1bmRlZmluZWQgPyBbXSA6IGFyZ3VtZW50c1syXTtcblxuICBmb3IgKHZhciB2aWV3UG9ydE5hbWUgaW4gcGxhbikge1xuICAgIHZhciBfdmlld1BvcnRQbGFuID0gcGxhblt2aWV3UG9ydE5hbWVdO1xuICAgIHZhciBwcmV2Q29tcG9uZW50ID0gX3ZpZXdQb3J0UGxhbi5wcmV2Q29tcG9uZW50O1xuXG4gICAgaWYgKChfdmlld1BvcnRQbGFuLnN0cmF0ZWd5ID09PSBhY3RpdmF0aW9uU3RyYXRlZ3kuaW52b2tlTGlmZWN5Y2xlIHx8IF92aWV3UG9ydFBsYW4uc3RyYXRlZ3kgPT09IGFjdGl2YXRpb25TdHJhdGVneS5yZXBsYWNlKSAmJiBwcmV2Q29tcG9uZW50KSB7XG4gICAgICB2YXIgdmlld01vZGVsID0gcHJldkNvbXBvbmVudC52aWV3TW9kZWw7XG5cbiAgICAgIGlmIChjYWxsYmFja05hbWUgaW4gdmlld01vZGVsKSB7XG4gICAgICAgIGxpc3QucHVzaCh2aWV3TW9kZWwpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChfdmlld1BvcnRQbGFuLmNoaWxkTmF2aWdhdGlvbkluc3RydWN0aW9uKSB7XG4gICAgICBmaW5kRGVhY3RpdmF0YWJsZShfdmlld1BvcnRQbGFuLmNoaWxkTmF2aWdhdGlvbkluc3RydWN0aW9uLnBsYW4sIGNhbGxiYWNrTmFtZSwgbGlzdCk7XG4gICAgfSBlbHNlIGlmIChwcmV2Q29tcG9uZW50KSB7XG4gICAgICBhZGRQcmV2aW91c0RlYWN0aXZhdGFibGUocHJldkNvbXBvbmVudCwgY2FsbGJhY2tOYW1lLCBsaXN0KTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbGlzdDtcbn1cblxuZnVuY3Rpb24gYWRkUHJldmlvdXNEZWFjdGl2YXRhYmxlKGNvbXBvbmVudCwgY2FsbGJhY2tOYW1lLCBsaXN0KSB7XG4gIHZhciBjaGlsZFJvdXRlciA9IGNvbXBvbmVudC5jaGlsZFJvdXRlcjtcblxuICBpZiAoY2hpbGRSb3V0ZXIgJiYgY2hpbGRSb3V0ZXIuY3VycmVudEluc3RydWN0aW9uKSB7XG4gICAgdmFyIHZpZXdQb3J0SW5zdHJ1Y3Rpb25zID0gY2hpbGRSb3V0ZXIuY3VycmVudEluc3RydWN0aW9uLnZpZXdQb3J0SW5zdHJ1Y3Rpb25zO1xuXG4gICAgZm9yICh2YXIgdmlld1BvcnROYW1lIGluIHZpZXdQb3J0SW5zdHJ1Y3Rpb25zKSB7XG4gICAgICB2YXIgX3ZpZXdQb3J0SW5zdHJ1Y3Rpb24yID0gdmlld1BvcnRJbnN0cnVjdGlvbnNbdmlld1BvcnROYW1lXTtcbiAgICAgIHZhciBwcmV2Q29tcG9uZW50ID0gX3ZpZXdQb3J0SW5zdHJ1Y3Rpb24yLmNvbXBvbmVudDtcbiAgICAgIHZhciBwcmV2Vmlld01vZGVsID0gcHJldkNvbXBvbmVudC52aWV3TW9kZWw7XG5cbiAgICAgIGlmIChjYWxsYmFja05hbWUgaW4gcHJldlZpZXdNb2RlbCkge1xuICAgICAgICBsaXN0LnB1c2gocHJldlZpZXdNb2RlbCk7XG4gICAgICB9XG5cbiAgICAgIGFkZFByZXZpb3VzRGVhY3RpdmF0YWJsZShwcmV2Q29tcG9uZW50LCBjYWxsYmFja05hbWUsIGxpc3QpO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBwcm9jZXNzQWN0aXZhdGFibGUobmF2aWdhdGlvbkluc3RydWN0aW9uLCBjYWxsYmFja05hbWUsIG5leHQsIGlnbm9yZVJlc3VsdCkge1xuICB2YXIgaW5mb3MgPSBmaW5kQWN0aXZhdGFibGUobmF2aWdhdGlvbkluc3RydWN0aW9uLCBjYWxsYmFja05hbWUpO1xuICB2YXIgbGVuZ3RoID0gaW5mb3MubGVuZ3RoO1xuICB2YXIgaSA9IC0xO1xuXG4gIGZ1bmN0aW9uIGluc3BlY3QodmFsLCByb3V0ZXIpIHtcbiAgICBpZiAoaWdub3JlUmVzdWx0IHx8IHNob3VsZENvbnRpbnVlKHZhbCwgcm91dGVyKSkge1xuICAgICAgcmV0dXJuIGl0ZXJhdGUoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV4dC5jYW5jZWwodmFsKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGl0ZXJhdGUoKSB7XG4gICAgaSsrO1xuXG4gICAgaWYgKGkgPCBsZW5ndGgpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhciBfcmV0MyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgX2N1cnJlbnQkdmlld01vZGVsO1xuXG4gICAgICAgICAgdmFyIGN1cnJlbnQgPSBpbmZvc1tpXTtcbiAgICAgICAgICB2YXIgcmVzdWx0ID0gKF9jdXJyZW50JHZpZXdNb2RlbCA9IGN1cnJlbnQudmlld01vZGVsKVtjYWxsYmFja05hbWVdLmFwcGx5KF9jdXJyZW50JHZpZXdNb2RlbCwgY3VycmVudC5saWZlY3ljbGVBcmdzKTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdjogcHJvY2Vzc1BvdGVudGlhbChyZXN1bHQsIGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGluc3BlY3QodmFsLCBjdXJyZW50LnJvdXRlcik7XG4gICAgICAgICAgICB9LCBuZXh0LmNhbmNlbClcbiAgICAgICAgICB9O1xuICAgICAgICB9KCk7XG5cbiAgICAgICAgaWYgKCh0eXBlb2YgX3JldDMgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKF9yZXQzKSkgPT09IFwib2JqZWN0XCIpIHJldHVybiBfcmV0My52O1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG5leHQuY2FuY2VsKGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbmV4dCgpO1xuICB9XG5cbiAgcmV0dXJuIGl0ZXJhdGUoKTtcbn1cblxuZnVuY3Rpb24gZmluZEFjdGl2YXRhYmxlKG5hdmlnYXRpb25JbnN0cnVjdGlvbiwgY2FsbGJhY2tOYW1lKSB7XG4gIHZhciBsaXN0ID0gYXJndW1lbnRzLmxlbmd0aCA8PSAyIHx8IGFyZ3VtZW50c1syXSA9PT0gdW5kZWZpbmVkID8gW10gOiBhcmd1bWVudHNbMl07XG4gIHZhciByb3V0ZXIgPSBhcmd1bWVudHNbM107XG5cbiAgdmFyIHBsYW4gPSBuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24ucGxhbjtcblxuICBPYmplY3Qua2V5cyhwbGFuKS5maWx0ZXIoZnVuY3Rpb24gKHZpZXdQb3J0TmFtZSkge1xuICAgIHZhciB2aWV3UG9ydFBsYW4gPSBwbGFuW3ZpZXdQb3J0TmFtZV07XG4gICAgdmFyIHZpZXdQb3J0SW5zdHJ1Y3Rpb24gPSBuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24udmlld1BvcnRJbnN0cnVjdGlvbnNbdmlld1BvcnROYW1lXTtcbiAgICB2YXIgdmlld01vZGVsID0gdmlld1BvcnRJbnN0cnVjdGlvbi5jb21wb25lbnQudmlld01vZGVsO1xuXG4gICAgaWYgKCh2aWV3UG9ydFBsYW4uc3RyYXRlZ3kgPT09IGFjdGl2YXRpb25TdHJhdGVneS5pbnZva2VMaWZlY3ljbGUgfHwgdmlld1BvcnRQbGFuLnN0cmF0ZWd5ID09PSBhY3RpdmF0aW9uU3RyYXRlZ3kucmVwbGFjZSkgJiYgY2FsbGJhY2tOYW1lIGluIHZpZXdNb2RlbCkge1xuICAgICAgbGlzdC5wdXNoKHtcbiAgICAgICAgdmlld01vZGVsOiB2aWV3TW9kZWwsXG4gICAgICAgIGxpZmVjeWNsZUFyZ3M6IHZpZXdQb3J0SW5zdHJ1Y3Rpb24ubGlmZWN5Y2xlQXJncyxcbiAgICAgICAgcm91dGVyOiByb3V0ZXJcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICh2aWV3UG9ydFBsYW4uY2hpbGROYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24pIHtcbiAgICAgIGZpbmRBY3RpdmF0YWJsZSh2aWV3UG9ydFBsYW4uY2hpbGROYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIGNhbGxiYWNrTmFtZSwgbGlzdCwgdmlld1BvcnRJbnN0cnVjdGlvbi5jb21wb25lbnQuY2hpbGRSb3V0ZXIgfHwgcm91dGVyKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBsaXN0O1xufVxuXG5mdW5jdGlvbiBzaG91bGRDb250aW51ZShvdXRwdXQsIHJvdXRlcikge1xuICBpZiAob3V0cHV0IGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBpZiAoaXNOYXZpZ2F0aW9uQ29tbWFuZChvdXRwdXQpKSB7XG4gICAgaWYgKHR5cGVvZiBvdXRwdXQuc2V0Um91dGVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBvdXRwdXQuc2V0Um91dGVyKHJvdXRlcik7XG4gICAgfVxuXG4gICAgcmV0dXJuICEhb3V0cHV0LnNob3VsZENvbnRpbnVlUHJvY2Vzc2luZztcbiAgfVxuXG4gIGlmIChvdXRwdXQgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIG91dHB1dDtcbn1cblxudmFyIFNhZmVTdWJzY3JpcHRpb24gPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFNhZmVTdWJzY3JpcHRpb24oc3Vic2NyaXB0aW9uRnVuYykge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTYWZlU3Vic2NyaXB0aW9uKTtcblxuICAgIHRoaXMuX3N1YnNjcmliZWQgPSB0cnVlO1xuICAgIHRoaXMuX3N1YnNjcmlwdGlvbiA9IHN1YnNjcmlwdGlvbkZ1bmModGhpcyk7XG5cbiAgICBpZiAoIXRoaXMuX3N1YnNjcmliZWQpIHRoaXMudW5zdWJzY3JpYmUoKTtcbiAgfVxuXG4gIFNhZmVTdWJzY3JpcHRpb24ucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gdW5zdWJzY3JpYmUoKSB7XG4gICAgaWYgKHRoaXMuX3N1YnNjcmliZWQgJiYgdGhpcy5fc3Vic2NyaXB0aW9uKSB0aGlzLl9zdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcblxuICAgIHRoaXMuX3N1YnNjcmliZWQgPSBmYWxzZTtcbiAgfTtcblxuICBfY3JlYXRlQ2xhc3MoU2FmZVN1YnNjcmlwdGlvbiwgW3tcbiAgICBrZXk6ICdzdWJzY3JpYmVkJyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpYmVkO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBTYWZlU3Vic2NyaXB0aW9uO1xufSgpO1xuXG5mdW5jdGlvbiBwcm9jZXNzUG90ZW50aWFsKG9iaiwgcmVzb2x2ZSwgcmVqZWN0KSB7XG4gIGlmIChvYmogJiYgdHlwZW9mIG9iai50aGVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShvYmopLnRoZW4ocmVzb2x2ZSkuY2F0Y2gocmVqZWN0KTtcbiAgfVxuXG4gIGlmIChvYmogJiYgdHlwZW9mIG9iai5zdWJzY3JpYmUgPT09ICdmdW5jdGlvbicpIHtcbiAgICB2YXIgX3JldDQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgb2JzID0gb2JqO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdjogbmV3IFNhZmVTdWJzY3JpcHRpb24oZnVuY3Rpb24gKHN1Yikge1xuICAgICAgICAgIHJldHVybiBvYnMuc3Vic2NyaWJlKHtcbiAgICAgICAgICAgIG5leHQ6IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgICAgICAgIGlmIChzdWIuc3Vic2NyaWJlZCkge1xuICAgICAgICAgICAgICAgIHN1Yi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUob2JqKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiBlcnJvcihfZXJyb3IpIHtcbiAgICAgICAgICAgICAgaWYgKHN1Yi5zdWJzY3JpYmVkKSB7XG4gICAgICAgICAgICAgICAgc3ViLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgcmVqZWN0KF9lcnJvcik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gY29tcGxldGUoKSB7XG4gICAgICAgICAgICAgIGlmIChzdWIuc3Vic2NyaWJlZCkge1xuICAgICAgICAgICAgICAgIHN1Yi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUob2JqKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KVxuICAgICAgfTtcbiAgICB9KCk7XG5cbiAgICBpZiAoKHR5cGVvZiBfcmV0NCA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoX3JldDQpKSA9PT0gXCJvYmplY3RcIikgcmV0dXJuIF9yZXQ0LnY7XG4gIH1cblxuICB0cnkge1xuICAgIHJldHVybiByZXNvbHZlKG9iaik7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHJlamVjdChlcnJvcik7XG4gIH1cbn1cblxudmFyIFJvdXRlTG9hZGVyID0gZXhwb3J0cy5Sb3V0ZUxvYWRlciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUm91dGVMb2FkZXIoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJvdXRlTG9hZGVyKTtcbiAgfVxuXG4gIFJvdXRlTG9hZGVyLnByb3RvdHlwZS5sb2FkUm91dGUgPSBmdW5jdGlvbiBsb2FkUm91dGUocm91dGVyLCBjb25maWcsIG5hdmlnYXRpb25JbnN0cnVjdGlvbikge1xuICAgIHRocm93IEVycm9yKCdSb3V0ZSBsb2FkZXJzIG11c3QgaW1wbGVtZW50IFwibG9hZFJvdXRlKHJvdXRlciwgY29uZmlnLCBuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24pXCIuJyk7XG4gIH07XG5cbiAgcmV0dXJuIFJvdXRlTG9hZGVyO1xufSgpO1xuXG52YXIgTG9hZFJvdXRlU3RlcCA9IGV4cG9ydHMuTG9hZFJvdXRlU3RlcCA9IGZ1bmN0aW9uICgpIHtcbiAgTG9hZFJvdXRlU3RlcC5pbmplY3QgPSBmdW5jdGlvbiBpbmplY3QoKSB7XG4gICAgcmV0dXJuIFtSb3V0ZUxvYWRlcl07XG4gIH07XG5cbiAgZnVuY3Rpb24gTG9hZFJvdXRlU3RlcChyb3V0ZUxvYWRlcikge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMb2FkUm91dGVTdGVwKTtcblxuICAgIHRoaXMucm91dGVMb2FkZXIgPSByb3V0ZUxvYWRlcjtcbiAgfVxuXG4gIExvYWRSb3V0ZVN0ZXAucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uIHJ1bihuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIG5leHQpIHtcbiAgICByZXR1cm4gbG9hZE5ld1JvdXRlKHRoaXMucm91dGVMb2FkZXIsIG5hdmlnYXRpb25JbnN0cnVjdGlvbikudGhlbihuZXh0KS5jYXRjaChuZXh0LmNhbmNlbCk7XG4gIH07XG5cbiAgcmV0dXJuIExvYWRSb3V0ZVN0ZXA7XG59KCk7XG5cbmZ1bmN0aW9uIGxvYWROZXdSb3V0ZShyb3V0ZUxvYWRlciwgbmF2aWdhdGlvbkluc3RydWN0aW9uKSB7XG4gIHZhciB0b0xvYWQgPSBkZXRlcm1pbmVXaGF0VG9Mb2FkKG5hdmlnYXRpb25JbnN0cnVjdGlvbik7XG4gIHZhciBsb2FkUHJvbWlzZXMgPSB0b0xvYWQubWFwKGZ1bmN0aW9uIChjdXJyZW50KSB7XG4gICAgcmV0dXJuIGxvYWRSb3V0ZShyb3V0ZUxvYWRlciwgY3VycmVudC5uYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIGN1cnJlbnQudmlld1BvcnRQbGFuKTtcbiAgfSk7XG5cbiAgcmV0dXJuIFByb21pc2UuYWxsKGxvYWRQcm9taXNlcyk7XG59XG5cbmZ1bmN0aW9uIGRldGVybWluZVdoYXRUb0xvYWQobmF2aWdhdGlvbkluc3RydWN0aW9uKSB7XG4gIHZhciB0b0xvYWQgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyBbXSA6IGFyZ3VtZW50c1sxXTtcblxuICB2YXIgcGxhbiA9IG5hdmlnYXRpb25JbnN0cnVjdGlvbi5wbGFuO1xuXG4gIGZvciAodmFyIHZpZXdQb3J0TmFtZSBpbiBwbGFuKSB7XG4gICAgdmFyIF92aWV3UG9ydFBsYW4yID0gcGxhblt2aWV3UG9ydE5hbWVdO1xuXG4gICAgaWYgKF92aWV3UG9ydFBsYW4yLnN0cmF0ZWd5ID09PSBhY3RpdmF0aW9uU3RyYXRlZ3kucmVwbGFjZSkge1xuICAgICAgdG9Mb2FkLnB1c2goeyB2aWV3UG9ydFBsYW46IF92aWV3UG9ydFBsYW4yLCBuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb246IG5hdmlnYXRpb25JbnN0cnVjdGlvbiB9KTtcblxuICAgICAgaWYgKF92aWV3UG9ydFBsYW4yLmNoaWxkTmF2aWdhdGlvbkluc3RydWN0aW9uKSB7XG4gICAgICAgIGRldGVybWluZVdoYXRUb0xvYWQoX3ZpZXdQb3J0UGxhbjIuY2hpbGROYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIHRvTG9hZCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBfdmlld1BvcnRJbnN0cnVjdGlvbjMgPSBuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24uYWRkVmlld1BvcnRJbnN0cnVjdGlvbih2aWV3UG9ydE5hbWUsIF92aWV3UG9ydFBsYW4yLnN0cmF0ZWd5LCBfdmlld1BvcnRQbGFuMi5wcmV2TW9kdWxlSWQsIF92aWV3UG9ydFBsYW4yLnByZXZDb21wb25lbnQpO1xuXG4gICAgICBpZiAoX3ZpZXdQb3J0UGxhbjIuY2hpbGROYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24pIHtcbiAgICAgICAgX3ZpZXdQb3J0SW5zdHJ1Y3Rpb24zLmNoaWxkTmF2aWdhdGlvbkluc3RydWN0aW9uID0gX3ZpZXdQb3J0UGxhbjIuY2hpbGROYXZpZ2F0aW9uSW5zdHJ1Y3Rpb247XG4gICAgICAgIGRldGVybWluZVdoYXRUb0xvYWQoX3ZpZXdQb3J0UGxhbjIuY2hpbGROYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIHRvTG9hZCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRvTG9hZDtcbn1cblxuZnVuY3Rpb24gbG9hZFJvdXRlKHJvdXRlTG9hZGVyLCBuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIHZpZXdQb3J0UGxhbikge1xuICB2YXIgbW9kdWxlSWQgPSB2aWV3UG9ydFBsYW4uY29uZmlnLm1vZHVsZUlkO1xuXG4gIHJldHVybiBsb2FkQ29tcG9uZW50KHJvdXRlTG9hZGVyLCBuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24sIHZpZXdQb3J0UGxhbi5jb25maWcpLnRoZW4oZnVuY3Rpb24gKGNvbXBvbmVudCkge1xuICAgIHZhciB2aWV3UG9ydEluc3RydWN0aW9uID0gbmF2aWdhdGlvbkluc3RydWN0aW9uLmFkZFZpZXdQb3J0SW5zdHJ1Y3Rpb24odmlld1BvcnRQbGFuLm5hbWUsIHZpZXdQb3J0UGxhbi5zdHJhdGVneSwgbW9kdWxlSWQsIGNvbXBvbmVudCk7XG5cbiAgICB2YXIgY2hpbGRSb3V0ZXIgPSBjb21wb25lbnQuY2hpbGRSb3V0ZXI7XG4gICAgaWYgKGNoaWxkUm91dGVyKSB7XG4gICAgICB2YXIgcGF0aCA9IG5hdmlnYXRpb25JbnN0cnVjdGlvbi5nZXRXaWxkY2FyZFBhdGgoKTtcblxuICAgICAgcmV0dXJuIGNoaWxkUm91dGVyLl9jcmVhdGVOYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24ocGF0aCwgbmF2aWdhdGlvbkluc3RydWN0aW9uKS50aGVuKGZ1bmN0aW9uIChjaGlsZEluc3RydWN0aW9uKSB7XG4gICAgICAgIHZpZXdQb3J0UGxhbi5jaGlsZE5hdmlnYXRpb25JbnN0cnVjdGlvbiA9IGNoaWxkSW5zdHJ1Y3Rpb247XG5cbiAgICAgICAgcmV0dXJuIF9idWlsZE5hdmlnYXRpb25QbGFuKGNoaWxkSW5zdHJ1Y3Rpb24pLnRoZW4oZnVuY3Rpb24gKGNoaWxkUGxhbikge1xuICAgICAgICAgIGNoaWxkSW5zdHJ1Y3Rpb24ucGxhbiA9IGNoaWxkUGxhbjtcbiAgICAgICAgICB2aWV3UG9ydEluc3RydWN0aW9uLmNoaWxkTmF2aWdhdGlvbkluc3RydWN0aW9uID0gY2hpbGRJbnN0cnVjdGlvbjtcblxuICAgICAgICAgIHJldHVybiBsb2FkTmV3Um91dGUocm91dGVMb2FkZXIsIGNoaWxkSW5zdHJ1Y3Rpb24pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGxvYWRDb21wb25lbnQocm91dGVMb2FkZXIsIG5hdmlnYXRpb25JbnN0cnVjdGlvbiwgY29uZmlnKSB7XG4gIHZhciByb3V0ZXIgPSBuYXZpZ2F0aW9uSW5zdHJ1Y3Rpb24ucm91dGVyO1xuICB2YXIgbGlmZWN5Y2xlQXJncyA9IG5hdmlnYXRpb25JbnN0cnVjdGlvbi5saWZlY3ljbGVBcmdzO1xuXG4gIHJldHVybiByb3V0ZUxvYWRlci5sb2FkUm91dGUocm91dGVyLCBjb25maWcsIG5hdmlnYXRpb25JbnN0cnVjdGlvbikudGhlbihmdW5jdGlvbiAoY29tcG9uZW50KSB7XG4gICAgdmFyIHZpZXdNb2RlbCA9IGNvbXBvbmVudC52aWV3TW9kZWw7XG4gICAgdmFyIGNoaWxkQ29udGFpbmVyID0gY29tcG9uZW50LmNoaWxkQ29udGFpbmVyO1xuXG4gICAgY29tcG9uZW50LnJvdXRlciA9IHJvdXRlcjtcbiAgICBjb21wb25lbnQuY29uZmlnID0gY29uZmlnO1xuXG4gICAgaWYgKCdjb25maWd1cmVSb3V0ZXInIGluIHZpZXdNb2RlbCkge1xuICAgICAgdmFyIF9yZXQ1ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY2hpbGRSb3V0ZXIgPSBjaGlsZENvbnRhaW5lci5nZXRDaGlsZFJvdXRlcigpO1xuICAgICAgICBjb21wb25lbnQuY2hpbGRSb3V0ZXIgPSBjaGlsZFJvdXRlcjtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHY6IGNoaWxkUm91dGVyLmNvbmZpZ3VyZShmdW5jdGlvbiAoYykge1xuICAgICAgICAgICAgcmV0dXJuIHZpZXdNb2RlbC5jb25maWd1cmVSb3V0ZXIuYXBwbHkodmlld01vZGVsLCBbYywgY2hpbGRSb3V0ZXJdLmNvbmNhdChsaWZlY3ljbGVBcmdzKSk7XG4gICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gY29tcG9uZW50O1xuICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICB9KCk7XG5cbiAgICAgIGlmICgodHlwZW9mIF9yZXQ1ID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihfcmV0NSkpID09PSBcIm9iamVjdFwiKSByZXR1cm4gX3JldDUudjtcbiAgICB9XG5cbiAgICByZXR1cm4gY29tcG9uZW50O1xuICB9KTtcbn1cblxudmFyIFBpcGVsaW5lU2xvdCA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUGlwZWxpbmVTbG90KGNvbnRhaW5lciwgbmFtZSwgYWxpYXMpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGlwZWxpbmVTbG90KTtcblxuICAgIHRoaXMuc3RlcHMgPSBbXTtcblxuICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgIHRoaXMuc2xvdE5hbWUgPSBuYW1lO1xuICAgIHRoaXMuc2xvdEFsaWFzID0gYWxpYXM7XG4gIH1cblxuICBQaXBlbGluZVNsb3QucHJvdG90eXBlLmdldFN0ZXBzID0gZnVuY3Rpb24gZ2V0U3RlcHMoKSB7XG4gICAgdmFyIF90aGlzNiA9IHRoaXM7XG5cbiAgICByZXR1cm4gdGhpcy5zdGVwcy5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgIHJldHVybiBfdGhpczYuY29udGFpbmVyLmdldCh4KTtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4gUGlwZWxpbmVTbG90O1xufSgpO1xuXG52YXIgUGlwZWxpbmVQcm92aWRlciA9IGV4cG9ydHMuUGlwZWxpbmVQcm92aWRlciA9IGZ1bmN0aW9uICgpIHtcbiAgUGlwZWxpbmVQcm92aWRlci5pbmplY3QgPSBmdW5jdGlvbiBpbmplY3QoKSB7XG4gICAgcmV0dXJuIFtfYXVyZWxpYURlcGVuZGVuY3lJbmplY3Rpb24uQ29udGFpbmVyXTtcbiAgfTtcblxuICBmdW5jdGlvbiBQaXBlbGluZVByb3ZpZGVyKGNvbnRhaW5lcikge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQaXBlbGluZVByb3ZpZGVyKTtcblxuICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgIHRoaXMuc3RlcHMgPSBbQnVpbGROYXZpZ2F0aW9uUGxhblN0ZXAsIENhbkRlYWN0aXZhdGVQcmV2aW91c1N0ZXAsIExvYWRSb3V0ZVN0ZXAsIHRoaXMuX2NyZWF0ZVBpcGVsaW5lU2xvdCgnYXV0aG9yaXplJyksIENhbkFjdGl2YXRlTmV4dFN0ZXAsIHRoaXMuX2NyZWF0ZVBpcGVsaW5lU2xvdCgncHJlQWN0aXZhdGUnLCAnbW9kZWxiaW5kJyksIERlYWN0aXZhdGVQcmV2aW91c1N0ZXAsIEFjdGl2YXRlTmV4dFN0ZXAsIHRoaXMuX2NyZWF0ZVBpcGVsaW5lU2xvdCgncHJlUmVuZGVyJywgJ3ByZWNvbW1pdCcpLCBDb21taXRDaGFuZ2VzU3RlcCwgdGhpcy5fY3JlYXRlUGlwZWxpbmVTbG90KCdwb3N0UmVuZGVyJywgJ3Bvc3Rjb21wbGV0ZScpXTtcbiAgfVxuXG4gIFBpcGVsaW5lUHJvdmlkZXIucHJvdG90eXBlLmNyZWF0ZVBpcGVsaW5lID0gZnVuY3Rpb24gY3JlYXRlUGlwZWxpbmUoKSB7XG4gICAgdmFyIF90aGlzNyA9IHRoaXM7XG5cbiAgICB2YXIgcGlwZWxpbmUgPSBuZXcgUGlwZWxpbmUoKTtcbiAgICB0aGlzLnN0ZXBzLmZvckVhY2goZnVuY3Rpb24gKHN0ZXApIHtcbiAgICAgIHJldHVybiBwaXBlbGluZS5hZGRTdGVwKF90aGlzNy5jb250YWluZXIuZ2V0KHN0ZXApKTtcbiAgICB9KTtcbiAgICByZXR1cm4gcGlwZWxpbmU7XG4gIH07XG5cbiAgUGlwZWxpbmVQcm92aWRlci5wcm90b3R5cGUuX2ZpbmRTdGVwID0gZnVuY3Rpb24gX2ZpbmRTdGVwKG5hbWUpIHtcbiAgICByZXR1cm4gdGhpcy5zdGVwcy5maW5kKGZ1bmN0aW9uICh4KSB7XG4gICAgICByZXR1cm4geC5zbG90TmFtZSA9PT0gbmFtZSB8fCB4LnNsb3RBbGlhcyA9PT0gbmFtZTtcbiAgICB9KTtcbiAgfTtcblxuICBQaXBlbGluZVByb3ZpZGVyLnByb3RvdHlwZS5hZGRTdGVwID0gZnVuY3Rpb24gYWRkU3RlcChuYW1lLCBzdGVwKSB7XG4gICAgdmFyIGZvdW5kID0gdGhpcy5fZmluZFN0ZXAobmFtZSk7XG4gICAgaWYgKGZvdW5kKSB7XG4gICAgICBpZiAoIWZvdW5kLnN0ZXBzLmluY2x1ZGVzKHN0ZXApKSB7XG4gICAgICAgIGZvdW5kLnN0ZXBzLnB1c2goc3RlcCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBwaXBlbGluZSBzbG90IG5hbWU6ICcgKyBuYW1lICsgJy4nKTtcbiAgICB9XG4gIH07XG5cbiAgUGlwZWxpbmVQcm92aWRlci5wcm90b3R5cGUucmVtb3ZlU3RlcCA9IGZ1bmN0aW9uIHJlbW92ZVN0ZXAobmFtZSwgc3RlcCkge1xuICAgIHZhciBzbG90ID0gdGhpcy5fZmluZFN0ZXAobmFtZSk7XG4gICAgaWYgKHNsb3QpIHtcbiAgICAgIHNsb3Quc3RlcHMuc3BsaWNlKHNsb3Quc3RlcHMuaW5kZXhPZihzdGVwKSwgMSk7XG4gICAgfVxuICB9O1xuXG4gIFBpcGVsaW5lUHJvdmlkZXIucHJvdG90eXBlLl9jbGVhclN0ZXBzID0gZnVuY3Rpb24gX2NsZWFyU3RlcHMoKSB7XG4gICAgdmFyIG5hbWUgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyAnJyA6IGFyZ3VtZW50c1swXTtcblxuICAgIHZhciBzbG90ID0gdGhpcy5fZmluZFN0ZXAobmFtZSk7XG4gICAgaWYgKHNsb3QpIHtcbiAgICAgIHNsb3Quc3RlcHMgPSBbXTtcbiAgICB9XG4gIH07XG5cbiAgUGlwZWxpbmVQcm92aWRlci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiByZXNldCgpIHtcbiAgICB0aGlzLl9jbGVhclN0ZXBzKCdhdXRob3JpemUnKTtcbiAgICB0aGlzLl9jbGVhclN0ZXBzKCdwcmVBY3RpdmF0ZScpO1xuICAgIHRoaXMuX2NsZWFyU3RlcHMoJ3ByZVJlbmRlcicpO1xuICAgIHRoaXMuX2NsZWFyU3RlcHMoJ3Bvc3RSZW5kZXInKTtcbiAgfTtcblxuICBQaXBlbGluZVByb3ZpZGVyLnByb3RvdHlwZS5fY3JlYXRlUGlwZWxpbmVTbG90ID0gZnVuY3Rpb24gX2NyZWF0ZVBpcGVsaW5lU2xvdChuYW1lLCBhbGlhcykge1xuICAgIHJldHVybiBuZXcgUGlwZWxpbmVTbG90KHRoaXMuY29udGFpbmVyLCBuYW1lLCBhbGlhcyk7XG4gIH07XG5cbiAgcmV0dXJuIFBpcGVsaW5lUHJvdmlkZXI7XG59KCk7XG5cbnZhciBsb2dnZXIgPSBMb2dNYW5hZ2VyLmdldExvZ2dlcignYXBwLXJvdXRlcicpO1xuXG52YXIgQXBwUm91dGVyID0gZXhwb3J0cy5BcHBSb3V0ZXIgPSBmdW5jdGlvbiAoX1JvdXRlcikge1xuICBfaW5oZXJpdHMoQXBwUm91dGVyLCBfUm91dGVyKTtcblxuICBBcHBSb3V0ZXIuaW5qZWN0ID0gZnVuY3Rpb24gaW5qZWN0KCkge1xuICAgIHJldHVybiBbX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uLkNvbnRhaW5lciwgX2F1cmVsaWFIaXN0b3J5Lkhpc3RvcnksIFBpcGVsaW5lUHJvdmlkZXIsIF9hdXJlbGlhRXZlbnRBZ2dyZWdhdG9yLkV2ZW50QWdncmVnYXRvcl07XG4gIH07XG5cbiAgZnVuY3Rpb24gQXBwUm91dGVyKGNvbnRhaW5lciwgaGlzdG9yeSwgcGlwZWxpbmVQcm92aWRlciwgZXZlbnRzKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFwcFJvdXRlcik7XG5cbiAgICB2YXIgX3RoaXM4ID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX1JvdXRlci5jYWxsKHRoaXMsIGNvbnRhaW5lciwgaGlzdG9yeSkpO1xuXG4gICAgX3RoaXM4LnBpcGVsaW5lUHJvdmlkZXIgPSBwaXBlbGluZVByb3ZpZGVyO1xuICAgIF90aGlzOC5ldmVudHMgPSBldmVudHM7XG4gICAgcmV0dXJuIF90aGlzODtcbiAgfVxuXG4gIEFwcFJvdXRlci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiByZXNldCgpIHtcbiAgICBfUm91dGVyLnByb3RvdHlwZS5yZXNldC5jYWxsKHRoaXMpO1xuICAgIHRoaXMubWF4SW5zdHJ1Y3Rpb25Db3VudCA9IDEwO1xuICAgIGlmICghdGhpcy5fcXVldWUpIHtcbiAgICAgIHRoaXMuX3F1ZXVlID0gW107XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3F1ZXVlLmxlbmd0aCA9IDA7XG4gICAgfVxuICB9O1xuXG4gIEFwcFJvdXRlci5wcm90b3R5cGUubG9hZFVybCA9IGZ1bmN0aW9uIGxvYWRVcmwodXJsKSB7XG4gICAgdmFyIF90aGlzOSA9IHRoaXM7XG5cbiAgICByZXR1cm4gdGhpcy5fY3JlYXRlTmF2aWdhdGlvbkluc3RydWN0aW9uKHVybCkudGhlbihmdW5jdGlvbiAoaW5zdHJ1Y3Rpb24pIHtcbiAgICAgIHJldHVybiBfdGhpczkuX3F1ZXVlSW5zdHJ1Y3Rpb24oaW5zdHJ1Y3Rpb24pO1xuICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKGVycm9yKTtcbiAgICAgIHJlc3RvcmVQcmV2aW91c0xvY2F0aW9uKF90aGlzOSk7XG4gICAgfSk7XG4gIH07XG5cbiAgQXBwUm91dGVyLnByb3RvdHlwZS5yZWdpc3RlclZpZXdQb3J0ID0gZnVuY3Rpb24gcmVnaXN0ZXJWaWV3UG9ydCh2aWV3UG9ydCwgbmFtZSkge1xuICAgIHZhciBfdGhpczEwID0gdGhpcztcblxuICAgIF9Sb3V0ZXIucHJvdG90eXBlLnJlZ2lzdGVyVmlld1BvcnQuY2FsbCh0aGlzLCB2aWV3UG9ydCwgbmFtZSk7XG5cbiAgICBpZiAoIXRoaXMuaXNBY3RpdmUpIHtcbiAgICAgIHZhciBfcmV0NiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZpZXdNb2RlbCA9IF90aGlzMTAuX2ZpbmRWaWV3TW9kZWwodmlld1BvcnQpO1xuICAgICAgICBpZiAoJ2NvbmZpZ3VyZVJvdXRlcicgaW4gdmlld01vZGVsKSB7XG4gICAgICAgICAgaWYgKCFfdGhpczEwLmlzQ29uZmlndXJlZCkge1xuICAgICAgICAgICAgdmFyIF9yZXQ3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICB2YXIgcmVzb2x2ZUNvbmZpZ3VyZWRQcm9taXNlID0gX3RoaXMxMC5fcmVzb2x2ZUNvbmZpZ3VyZWRQcm9taXNlO1xuICAgICAgICAgICAgICBfdGhpczEwLl9yZXNvbHZlQ29uZmlndXJlZFByb21pc2UgPSBmdW5jdGlvbiAoKSB7fTtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2OiB7XG4gICAgICAgICAgICAgICAgICB2OiBfdGhpczEwLmNvbmZpZ3VyZShmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2aWV3TW9kZWwuY29uZmlndXJlUm91dGVyKGNvbmZpZywgX3RoaXMxMCk7XG4gICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMC5hY3RpdmF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ29uZmlndXJlZFByb21pc2UoKTtcbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSgpO1xuXG4gICAgICAgICAgICBpZiAoKHR5cGVvZiBfcmV0NyA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoX3JldDcpKSA9PT0gXCJvYmplY3RcIikgcmV0dXJuIF9yZXQ3LnY7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF90aGlzMTAuYWN0aXZhdGUoKTtcbiAgICAgICAgfVxuICAgICAgfSgpO1xuXG4gICAgICBpZiAoKHR5cGVvZiBfcmV0NiA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoX3JldDYpKSA9PT0gXCJvYmplY3RcIikgcmV0dXJuIF9yZXQ2LnY7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2RlcXVldWVJbnN0cnVjdGlvbigpO1xuICAgIH1cblxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfTtcblxuICBBcHBSb3V0ZXIucHJvdG90eXBlLmFjdGl2YXRlID0gZnVuY3Rpb24gYWN0aXZhdGUob3B0aW9ucykge1xuICAgIGlmICh0aGlzLmlzQWN0aXZlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5pc0FjdGl2ZSA9IHRydWU7XG4gICAgdGhpcy5vcHRpb25zID0gT2JqZWN0LmFzc2lnbih7IHJvdXRlSGFuZGxlcjogdGhpcy5sb2FkVXJsLmJpbmQodGhpcykgfSwgdGhpcy5vcHRpb25zLCBvcHRpb25zKTtcbiAgICB0aGlzLmhpc3RvcnkuYWN0aXZhdGUodGhpcy5vcHRpb25zKTtcbiAgICB0aGlzLl9kZXF1ZXVlSW5zdHJ1Y3Rpb24oKTtcbiAgfTtcblxuICBBcHBSb3V0ZXIucHJvdG90eXBlLmRlYWN0aXZhdGUgPSBmdW5jdGlvbiBkZWFjdGl2YXRlKCkge1xuICAgIHRoaXMuaXNBY3RpdmUgPSBmYWxzZTtcbiAgICB0aGlzLmhpc3RvcnkuZGVhY3RpdmF0ZSgpO1xuICB9O1xuXG4gIEFwcFJvdXRlci5wcm90b3R5cGUuX3F1ZXVlSW5zdHJ1Y3Rpb24gPSBmdW5jdGlvbiBfcXVldWVJbnN0cnVjdGlvbihpbnN0cnVjdGlvbikge1xuICAgIHZhciBfdGhpczExID0gdGhpcztcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgaW5zdHJ1Y3Rpb24ucmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgICBfdGhpczExLl9xdWV1ZS51bnNoaWZ0KGluc3RydWN0aW9uKTtcbiAgICAgIF90aGlzMTEuX2RlcXVldWVJbnN0cnVjdGlvbigpO1xuICAgIH0pO1xuICB9O1xuXG4gIEFwcFJvdXRlci5wcm90b3R5cGUuX2RlcXVldWVJbnN0cnVjdGlvbiA9IGZ1bmN0aW9uIF9kZXF1ZXVlSW5zdHJ1Y3Rpb24oKSB7XG4gICAgdmFyIF90aGlzMTIgPSB0aGlzO1xuXG4gICAgdmFyIGluc3RydWN0aW9uQ291bnQgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyAwIDogYXJndW1lbnRzWzBdO1xuXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKF90aGlzMTIuaXNOYXZpZ2F0aW5nICYmICFpbnN0cnVjdGlvbkNvdW50KSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICB9XG5cbiAgICAgIHZhciBpbnN0cnVjdGlvbiA9IF90aGlzMTIuX3F1ZXVlLnNoaWZ0KCk7XG4gICAgICBfdGhpczEyLl9xdWV1ZS5sZW5ndGggPSAwO1xuXG4gICAgICBpZiAoIWluc3RydWN0aW9uKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICB9XG5cbiAgICAgIF90aGlzMTIuaXNOYXZpZ2F0aW5nID0gdHJ1ZTtcbiAgICAgIGluc3RydWN0aW9uLnByZXZpb3VzSW5zdHJ1Y3Rpb24gPSBfdGhpczEyLmN1cnJlbnRJbnN0cnVjdGlvbjtcblxuICAgICAgaWYgKCFpbnN0cnVjdGlvbkNvdW50KSB7XG4gICAgICAgIF90aGlzMTIuZXZlbnRzLnB1Ymxpc2goJ3JvdXRlcjpuYXZpZ2F0aW9uOnByb2Nlc3NpbmcnLCB7IGluc3RydWN0aW9uOiBpbnN0cnVjdGlvbiB9KTtcbiAgICAgIH0gZWxzZSBpZiAoaW5zdHJ1Y3Rpb25Db3VudCA9PT0gX3RoaXMxMi5tYXhJbnN0cnVjdGlvbkNvdW50IC0gMSkge1xuICAgICAgICBsb2dnZXIuZXJyb3IoaW5zdHJ1Y3Rpb25Db3VudCArIDEgKyAnIG5hdmlnYXRpb24gaW5zdHJ1Y3Rpb25zIGhhdmUgYmVlbiBhdHRlbXB0ZWQgd2l0aG91dCBzdWNjZXNzLiBSZXN0b3JpbmcgbGFzdCBrbm93biBnb29kIGxvY2F0aW9uLicpO1xuICAgICAgICByZXN0b3JlUHJldmlvdXNMb2NhdGlvbihfdGhpczEyKTtcbiAgICAgICAgcmV0dXJuIF90aGlzMTIuX2RlcXVldWVJbnN0cnVjdGlvbihpbnN0cnVjdGlvbkNvdW50ICsgMSk7XG4gICAgICB9IGVsc2UgaWYgKGluc3RydWN0aW9uQ291bnQgPiBfdGhpczEyLm1heEluc3RydWN0aW9uQ291bnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNYXhpbXVtIG5hdmlnYXRpb24gYXR0ZW1wdHMgZXhjZWVkZWQuIEdpdmluZyB1cC4nKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHBpcGVsaW5lID0gX3RoaXMxMi5waXBlbGluZVByb3ZpZGVyLmNyZWF0ZVBpcGVsaW5lKCk7XG5cbiAgICAgIHJldHVybiBwaXBlbGluZS5ydW4oaW5zdHJ1Y3Rpb24pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICByZXR1cm4gcHJvY2Vzc1Jlc3VsdChpbnN0cnVjdGlvbiwgcmVzdWx0LCBpbnN0cnVjdGlvbkNvdW50LCBfdGhpczEyKTtcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICByZXR1cm4geyBvdXRwdXQ6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvciA6IG5ldyBFcnJvcihlcnJvcikgfTtcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICByZXR1cm4gcmVzb2x2ZUluc3RydWN0aW9uKGluc3RydWN0aW9uLCByZXN1bHQsICEhaW5zdHJ1Y3Rpb25Db3VudCwgX3RoaXMxMik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBBcHBSb3V0ZXIucHJvdG90eXBlLl9maW5kVmlld01vZGVsID0gZnVuY3Rpb24gX2ZpbmRWaWV3TW9kZWwodmlld1BvcnQpIHtcbiAgICBpZiAodGhpcy5jb250YWluZXIudmlld01vZGVsKSB7XG4gICAgICByZXR1cm4gdGhpcy5jb250YWluZXIudmlld01vZGVsO1xuICAgIH1cblxuICAgIGlmICh2aWV3UG9ydC5jb250YWluZXIpIHtcbiAgICAgIHZhciBjb250YWluZXIgPSB2aWV3UG9ydC5jb250YWluZXI7XG5cbiAgICAgIHdoaWxlIChjb250YWluZXIpIHtcbiAgICAgICAgaWYgKGNvbnRhaW5lci52aWV3TW9kZWwpIHtcbiAgICAgICAgICB0aGlzLmNvbnRhaW5lci52aWV3TW9kZWwgPSBjb250YWluZXIudmlld01vZGVsO1xuICAgICAgICAgIHJldHVybiBjb250YWluZXIudmlld01vZGVsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29udGFpbmVyID0gY29udGFpbmVyLnBhcmVudDtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIEFwcFJvdXRlcjtcbn0oUm91dGVyKTtcblxuZnVuY3Rpb24gcHJvY2Vzc1Jlc3VsdChpbnN0cnVjdGlvbiwgcmVzdWx0LCBpbnN0cnVjdGlvbkNvdW50LCByb3V0ZXIpIHtcbiAgaWYgKCEocmVzdWx0ICYmICdjb21wbGV0ZWQnIGluIHJlc3VsdCAmJiAnb3V0cHV0JyBpbiByZXN1bHQpKSB7XG4gICAgcmVzdWx0ID0gcmVzdWx0IHx8IHt9O1xuICAgIHJlc3VsdC5vdXRwdXQgPSBuZXcgRXJyb3IoJ0V4cGVjdGVkIHJvdXRlciBwaXBlbGluZSB0byByZXR1cm4gYSBuYXZpZ2F0aW9uIHJlc3VsdCwgYnV0IGdvdCBbJyArIEpTT04uc3RyaW5naWZ5KHJlc3VsdCkgKyAnXSBpbnN0ZWFkLicpO1xuICB9XG5cbiAgdmFyIGZpbmFsUmVzdWx0ID0gbnVsbDtcbiAgaWYgKGlzTmF2aWdhdGlvbkNvbW1hbmQocmVzdWx0Lm91dHB1dCkpIHtcbiAgICByZXN1bHQub3V0cHV0Lm5hdmlnYXRlKHJvdXRlcik7XG4gIH0gZWxzZSB7XG4gICAgZmluYWxSZXN1bHQgPSByZXN1bHQ7XG5cbiAgICBpZiAoIXJlc3VsdC5jb21wbGV0ZWQpIHtcbiAgICAgIGlmIChyZXN1bHQub3V0cHV0IGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKHJlc3VsdC5vdXRwdXQpO1xuICAgICAgfVxuXG4gICAgICByZXN0b3JlUHJldmlvdXNMb2NhdGlvbihyb3V0ZXIpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiByb3V0ZXIuX2RlcXVldWVJbnN0cnVjdGlvbihpbnN0cnVjdGlvbkNvdW50ICsgMSkudGhlbihmdW5jdGlvbiAoaW5uZXJSZXN1bHQpIHtcbiAgICByZXR1cm4gZmluYWxSZXN1bHQgfHwgaW5uZXJSZXN1bHQgfHwgcmVzdWx0O1xuICB9KTtcbn1cblxuZnVuY3Rpb24gcmVzb2x2ZUluc3RydWN0aW9uKGluc3RydWN0aW9uLCByZXN1bHQsIGlzSW5uZXJJbnN0cnVjdGlvbiwgcm91dGVyKSB7XG4gIGluc3RydWN0aW9uLnJlc29sdmUocmVzdWx0KTtcblxuICBpZiAoIWlzSW5uZXJJbnN0cnVjdGlvbikge1xuICAgIHJvdXRlci5pc05hdmlnYXRpbmcgPSBmYWxzZTtcbiAgICB2YXIgZXZlbnRBcmdzID0geyBpbnN0cnVjdGlvbjogaW5zdHJ1Y3Rpb24sIHJlc3VsdDogcmVzdWx0IH07XG4gICAgdmFyIGV2ZW50TmFtZSA9IHZvaWQgMDtcblxuICAgIGlmIChyZXN1bHQub3V0cHV0IGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgIGV2ZW50TmFtZSA9ICdlcnJvcic7XG4gICAgfSBlbHNlIGlmICghcmVzdWx0LmNvbXBsZXRlZCkge1xuICAgICAgZXZlbnROYW1lID0gJ2NhbmNlbGVkJztcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIF9xdWVyeVN0cmluZyA9IGluc3RydWN0aW9uLnF1ZXJ5U3RyaW5nID8gJz8nICsgaW5zdHJ1Y3Rpb24ucXVlcnlTdHJpbmcgOiAnJztcbiAgICAgIHJvdXRlci5oaXN0b3J5LnByZXZpb3VzTG9jYXRpb24gPSBpbnN0cnVjdGlvbi5mcmFnbWVudCArIF9xdWVyeVN0cmluZztcbiAgICAgIGV2ZW50TmFtZSA9ICdzdWNjZXNzJztcbiAgICB9XG5cbiAgICByb3V0ZXIuZXZlbnRzLnB1Ymxpc2goJ3JvdXRlcjpuYXZpZ2F0aW9uOicgKyBldmVudE5hbWUsIGV2ZW50QXJncyk7XG4gICAgcm91dGVyLmV2ZW50cy5wdWJsaXNoKCdyb3V0ZXI6bmF2aWdhdGlvbjpjb21wbGV0ZScsIGV2ZW50QXJncyk7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiByZXN0b3JlUHJldmlvdXNMb2NhdGlvbihyb3V0ZXIpIHtcbiAgdmFyIHByZXZpb3VzTG9jYXRpb24gPSByb3V0ZXIuaGlzdG9yeS5wcmV2aW91c0xvY2F0aW9uO1xuICBpZiAocHJldmlvdXNMb2NhdGlvbikge1xuICAgIHJvdXRlci5uYXZpZ2F0ZShyb3V0ZXIuaGlzdG9yeS5wcmV2aW91c0xvY2F0aW9uLCB7IHRyaWdnZXI6IGZhbHNlLCByZXBsYWNlOiB0cnVlIH0pO1xuICB9IGVsc2Uge1xuICAgIGxvZ2dlci5lcnJvcignUm91dGVyIG5hdmlnYXRpb24gZmFpbGVkLCBhbmQgbm8gcHJldmlvdXMgbG9jYXRpb24gY291bGQgYmUgcmVzdG9yZWQuJyk7XG4gIH1cbn1cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLXJvdXRlci9kaXN0L2NvbW1vbmpzL2F1cmVsaWEtcm91dGVyLmpzXG4gKiogbW9kdWxlIGlkID0gMzNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuUm91dGVSZWNvZ25pemVyID0gZXhwb3J0cy5FcHNpbG9uU2VnbWVudCA9IGV4cG9ydHMuU3RhclNlZ21lbnQgPSBleHBvcnRzLkR5bmFtaWNTZWdtZW50ID0gZXhwb3J0cy5TdGF0aWNTZWdtZW50ID0gZXhwb3J0cy5TdGF0ZSA9IHVuZGVmaW5lZDtcblxudmFyIF9hdXJlbGlhUGF0aCA9IHJlcXVpcmUoJ2F1cmVsaWEtcGF0aCcpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgU3RhdGUgPSBleHBvcnRzLlN0YXRlID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBTdGF0ZShjaGFyU3BlYykge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTdGF0ZSk7XG5cbiAgICB0aGlzLmNoYXJTcGVjID0gY2hhclNwZWM7XG4gICAgdGhpcy5uZXh0U3RhdGVzID0gW107XG4gIH1cblxuICBTdGF0ZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gZ2V0KGNoYXJTcGVjKSB7XG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yID0gdGhpcy5uZXh0U3RhdGVzLCBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yKSwgX2kgPSAwLCBfaXRlcmF0b3IgPSBfaXNBcnJheSA/IF9pdGVyYXRvciA6IF9pdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuICAgICAgdmFyIF9yZWY7XG5cbiAgICAgIGlmIChfaXNBcnJheSkge1xuICAgICAgICBpZiAoX2kgPj0gX2l0ZXJhdG9yLmxlbmd0aCkgYnJlYWs7XG4gICAgICAgIF9yZWYgPSBfaXRlcmF0b3JbX2krK107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfaSA9IF9pdGVyYXRvci5uZXh0KCk7XG4gICAgICAgIGlmIChfaS5kb25lKSBicmVhaztcbiAgICAgICAgX3JlZiA9IF9pLnZhbHVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgY2hpbGQgPSBfcmVmO1xuXG4gICAgICB2YXIgaXNFcXVhbCA9IGNoaWxkLmNoYXJTcGVjLnZhbGlkQ2hhcnMgPT09IGNoYXJTcGVjLnZhbGlkQ2hhcnMgJiYgY2hpbGQuY2hhclNwZWMuaW52YWxpZENoYXJzID09PSBjaGFyU3BlYy5pbnZhbGlkQ2hhcnM7XG5cbiAgICAgIGlmIChpc0VxdWFsKSB7XG4gICAgICAgIHJldHVybiBjaGlsZDtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgU3RhdGUucHJvdG90eXBlLnB1dCA9IGZ1bmN0aW9uIHB1dChjaGFyU3BlYykge1xuICAgIHZhciBzdGF0ZSA9IHRoaXMuZ2V0KGNoYXJTcGVjKTtcblxuICAgIGlmIChzdGF0ZSkge1xuICAgICAgcmV0dXJuIHN0YXRlO1xuICAgIH1cblxuICAgIHN0YXRlID0gbmV3IFN0YXRlKGNoYXJTcGVjKTtcblxuICAgIHRoaXMubmV4dFN0YXRlcy5wdXNoKHN0YXRlKTtcblxuICAgIGlmIChjaGFyU3BlYy5yZXBlYXQpIHtcbiAgICAgIHN0YXRlLm5leHRTdGF0ZXMucHVzaChzdGF0ZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN0YXRlO1xuICB9O1xuXG4gIFN0YXRlLnByb3RvdHlwZS5tYXRjaCA9IGZ1bmN0aW9uIG1hdGNoKGNoKSB7XG4gICAgdmFyIG5leHRTdGF0ZXMgPSB0aGlzLm5leHRTdGF0ZXM7XG4gICAgdmFyIHJlc3VsdHMgPSBbXTtcblxuICAgIGZvciAodmFyIGkgPSAwLCBsID0gbmV4dFN0YXRlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgIHZhciBjaGlsZCA9IG5leHRTdGF0ZXNbaV07XG4gICAgICB2YXIgY2hhclNwZWMgPSBjaGlsZC5jaGFyU3BlYztcblxuICAgICAgaWYgKGNoYXJTcGVjLnZhbGlkQ2hhcnMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAoY2hhclNwZWMudmFsaWRDaGFycy5pbmRleE9mKGNoKSAhPT0gLTEpIHtcbiAgICAgICAgICByZXN1bHRzLnB1c2goY2hpbGQpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGNoYXJTcGVjLmludmFsaWRDaGFycyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmIChjaGFyU3BlYy5pbnZhbGlkQ2hhcnMuaW5kZXhPZihjaCkgPT09IC0xKSB7XG4gICAgICAgICAgcmVzdWx0cy5wdXNoKGNoaWxkKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXN1bHRzO1xuICB9O1xuXG4gIHJldHVybiBTdGF0ZTtcbn0oKTtcblxudmFyIHNwZWNpYWxzID0gWycvJywgJy4nLCAnKicsICcrJywgJz8nLCAnfCcsICcoJywgJyknLCAnWycsICddJywgJ3snLCAnfScsICdcXFxcJ107XG5cbnZhciBlc2NhcGVSZWdleCA9IG5ldyBSZWdFeHAoJyhcXFxcJyArIHNwZWNpYWxzLmpvaW4oJ3xcXFxcJykgKyAnKScsICdnJyk7XG5cbnZhciBTdGF0aWNTZWdtZW50ID0gZXhwb3J0cy5TdGF0aWNTZWdtZW50ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBTdGF0aWNTZWdtZW50KHN0cmluZywgY2FzZVNlbnNpdGl2ZSkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTdGF0aWNTZWdtZW50KTtcblxuICAgIHRoaXMuc3RyaW5nID0gc3RyaW5nO1xuICAgIHRoaXMuY2FzZVNlbnNpdGl2ZSA9IGNhc2VTZW5zaXRpdmU7XG4gIH1cblxuICBTdGF0aWNTZWdtZW50LnByb3RvdHlwZS5lYWNoQ2hhciA9IGZ1bmN0aW9uIGVhY2hDaGFyKGNhbGxiYWNrKSB7XG4gICAgdmFyIHMgPSB0aGlzLnN0cmluZztcbiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIHZhciBjaCA9IHNbaV07XG4gICAgICBjYWxsYmFjayh7IHZhbGlkQ2hhcnM6IHRoaXMuY2FzZVNlbnNpdGl2ZSA/IGNoIDogY2gudG9VcHBlckNhc2UoKSArIGNoLnRvTG93ZXJDYXNlKCkgfSk7XG4gICAgfVxuICB9O1xuXG4gIFN0YXRpY1NlZ21lbnQucHJvdG90eXBlLnJlZ2V4ID0gZnVuY3Rpb24gcmVnZXgoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RyaW5nLnJlcGxhY2UoZXNjYXBlUmVnZXgsICdcXFxcJDEnKTtcbiAgfTtcblxuICBTdGF0aWNTZWdtZW50LnByb3RvdHlwZS5nZW5lcmF0ZSA9IGZ1bmN0aW9uIGdlbmVyYXRlKCkge1xuICAgIHJldHVybiB0aGlzLnN0cmluZztcbiAgfTtcblxuICByZXR1cm4gU3RhdGljU2VnbWVudDtcbn0oKTtcblxudmFyIER5bmFtaWNTZWdtZW50ID0gZXhwb3J0cy5EeW5hbWljU2VnbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gRHluYW1pY1NlZ21lbnQobmFtZSkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBEeW5hbWljU2VnbWVudCk7XG5cbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICB9XG5cbiAgRHluYW1pY1NlZ21lbnQucHJvdG90eXBlLmVhY2hDaGFyID0gZnVuY3Rpb24gZWFjaENoYXIoY2FsbGJhY2spIHtcbiAgICBjYWxsYmFjayh7IGludmFsaWRDaGFyczogJy8nLCByZXBlYXQ6IHRydWUgfSk7XG4gIH07XG5cbiAgRHluYW1pY1NlZ21lbnQucHJvdG90eXBlLnJlZ2V4ID0gZnVuY3Rpb24gcmVnZXgoKSB7XG4gICAgcmV0dXJuICcoW14vXSspJztcbiAgfTtcblxuICBEeW5hbWljU2VnbWVudC5wcm90b3R5cGUuZ2VuZXJhdGUgPSBmdW5jdGlvbiBnZW5lcmF0ZShwYXJhbXMsIGNvbnN1bWVkKSB7XG4gICAgY29uc3VtZWRbdGhpcy5uYW1lXSA9IHRydWU7XG4gICAgcmV0dXJuIHBhcmFtc1t0aGlzLm5hbWVdO1xuICB9O1xuXG4gIHJldHVybiBEeW5hbWljU2VnbWVudDtcbn0oKTtcblxudmFyIFN0YXJTZWdtZW50ID0gZXhwb3J0cy5TdGFyU2VnbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gU3RhclNlZ21lbnQobmFtZSkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTdGFyU2VnbWVudCk7XG5cbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICB9XG5cbiAgU3RhclNlZ21lbnQucHJvdG90eXBlLmVhY2hDaGFyID0gZnVuY3Rpb24gZWFjaENoYXIoY2FsbGJhY2spIHtcbiAgICBjYWxsYmFjayh7IGludmFsaWRDaGFyczogJycsIHJlcGVhdDogdHJ1ZSB9KTtcbiAgfTtcblxuICBTdGFyU2VnbWVudC5wcm90b3R5cGUucmVnZXggPSBmdW5jdGlvbiByZWdleCgpIHtcbiAgICByZXR1cm4gJyguKyknO1xuICB9O1xuXG4gIFN0YXJTZWdtZW50LnByb3RvdHlwZS5nZW5lcmF0ZSA9IGZ1bmN0aW9uIGdlbmVyYXRlKHBhcmFtcywgY29uc3VtZWQpIHtcbiAgICBjb25zdW1lZFt0aGlzLm5hbWVdID0gdHJ1ZTtcbiAgICByZXR1cm4gcGFyYW1zW3RoaXMubmFtZV07XG4gIH07XG5cbiAgcmV0dXJuIFN0YXJTZWdtZW50O1xufSgpO1xuXG52YXIgRXBzaWxvblNlZ21lbnQgPSBleHBvcnRzLkVwc2lsb25TZWdtZW50ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBFcHNpbG9uU2VnbWVudCgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXBzaWxvblNlZ21lbnQpO1xuICB9XG5cbiAgRXBzaWxvblNlZ21lbnQucHJvdG90eXBlLmVhY2hDaGFyID0gZnVuY3Rpb24gZWFjaENoYXIoKSB7fTtcblxuICBFcHNpbG9uU2VnbWVudC5wcm90b3R5cGUucmVnZXggPSBmdW5jdGlvbiByZWdleCgpIHtcbiAgICByZXR1cm4gJyc7XG4gIH07XG5cbiAgRXBzaWxvblNlZ21lbnQucHJvdG90eXBlLmdlbmVyYXRlID0gZnVuY3Rpb24gZ2VuZXJhdGUoKSB7XG4gICAgcmV0dXJuICcnO1xuICB9O1xuXG4gIHJldHVybiBFcHNpbG9uU2VnbWVudDtcbn0oKTtcblxudmFyIFJvdXRlUmVjb2duaXplciA9IGV4cG9ydHMuUm91dGVSZWNvZ25pemVyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBSb3V0ZVJlY29nbml6ZXIoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJvdXRlUmVjb2duaXplcik7XG5cbiAgICB0aGlzLnJvb3RTdGF0ZSA9IG5ldyBTdGF0ZSgpO1xuICAgIHRoaXMubmFtZXMgPSB7fTtcbiAgfVxuXG4gIFJvdXRlUmVjb2duaXplci5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gYWRkKHJvdXRlKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIGlmIChBcnJheS5pc0FycmF5KHJvdXRlKSkge1xuICAgICAgcm91dGUuZm9yRWFjaChmdW5jdGlvbiAocikge1xuICAgICAgICByZXR1cm4gX3RoaXMuYWRkKHIpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHZhciBjdXJyZW50U3RhdGUgPSB0aGlzLnJvb3RTdGF0ZTtcbiAgICB2YXIgcmVnZXggPSAnXic7XG4gICAgdmFyIHR5cGVzID0geyBzdGF0aWNzOiAwLCBkeW5hbWljczogMCwgc3RhcnM6IDAgfTtcbiAgICB2YXIgbmFtZXMgPSBbXTtcbiAgICB2YXIgcm91dGVOYW1lID0gcm91dGUuaGFuZGxlci5uYW1lO1xuICAgIHZhciBpc0VtcHR5ID0gdHJ1ZTtcbiAgICB2YXIgc2VnbWVudHMgPSBwYXJzZShyb3V0ZS5wYXRoLCBuYW1lcywgdHlwZXMsIHJvdXRlLmNhc2VTZW5zaXRpdmUpO1xuXG4gICAgZm9yICh2YXIgaSA9IDAsIGlpID0gc2VnbWVudHMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgdmFyIHNlZ21lbnQgPSBzZWdtZW50c1tpXTtcbiAgICAgIGlmIChzZWdtZW50IGluc3RhbmNlb2YgRXBzaWxvblNlZ21lbnQpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGlzRW1wdHkgPSBmYWxzZTtcblxuICAgICAgY3VycmVudFN0YXRlID0gY3VycmVudFN0YXRlLnB1dCh7IHZhbGlkQ2hhcnM6ICcvJyB9KTtcbiAgICAgIHJlZ2V4ICs9ICcvJztcblxuICAgICAgY3VycmVudFN0YXRlID0gYWRkU2VnbWVudChjdXJyZW50U3RhdGUsIHNlZ21lbnQpO1xuICAgICAgcmVnZXggKz0gc2VnbWVudC5yZWdleCgpO1xuICAgIH1cblxuICAgIGlmIChpc0VtcHR5KSB7XG4gICAgICBjdXJyZW50U3RhdGUgPSBjdXJyZW50U3RhdGUucHV0KHsgdmFsaWRDaGFyczogJy8nIH0pO1xuICAgICAgcmVnZXggKz0gJy8nO1xuICAgIH1cblxuICAgIHZhciBoYW5kbGVycyA9IFt7IGhhbmRsZXI6IHJvdXRlLmhhbmRsZXIsIG5hbWVzOiBuYW1lcyB9XTtcblxuICAgIGlmIChyb3V0ZU5hbWUpIHtcbiAgICAgIHZhciByb3V0ZU5hbWVzID0gQXJyYXkuaXNBcnJheShyb3V0ZU5hbWUpID8gcm91dGVOYW1lIDogW3JvdXRlTmFtZV07XG4gICAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCByb3V0ZU5hbWVzLmxlbmd0aDsgX2kyKyspIHtcbiAgICAgICAgdGhpcy5uYW1lc1tyb3V0ZU5hbWVzW19pMl1dID0ge1xuICAgICAgICAgIHNlZ21lbnRzOiBzZWdtZW50cyxcbiAgICAgICAgICBoYW5kbGVyczogaGFuZGxlcnNcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjdXJyZW50U3RhdGUuaGFuZGxlcnMgPSBoYW5kbGVycztcbiAgICBjdXJyZW50U3RhdGUucmVnZXggPSBuZXcgUmVnRXhwKHJlZ2V4ICsgJyQnLCByb3V0ZS5jYXNlU2Vuc2l0aXZlID8gJycgOiAnaScpO1xuICAgIGN1cnJlbnRTdGF0ZS50eXBlcyA9IHR5cGVzO1xuXG4gICAgcmV0dXJuIGN1cnJlbnRTdGF0ZTtcbiAgfTtcblxuICBSb3V0ZVJlY29nbml6ZXIucHJvdG90eXBlLmhhbmRsZXJzRm9yID0gZnVuY3Rpb24gaGFuZGxlcnNGb3IobmFtZSkge1xuICAgIHZhciByb3V0ZSA9IHRoaXMubmFtZXNbbmFtZV07XG4gICAgaWYgKCFyb3V0ZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGVyZSBpcyBubyByb3V0ZSBuYW1lZCAnICsgbmFtZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFtdLmNvbmNhdChyb3V0ZS5oYW5kbGVycyk7XG4gIH07XG5cbiAgUm91dGVSZWNvZ25pemVyLnByb3RvdHlwZS5oYXNSb3V0ZSA9IGZ1bmN0aW9uIGhhc1JvdXRlKG5hbWUpIHtcbiAgICByZXR1cm4gISF0aGlzLm5hbWVzW25hbWVdO1xuICB9O1xuXG4gIFJvdXRlUmVjb2duaXplci5wcm90b3R5cGUuZ2VuZXJhdGUgPSBmdW5jdGlvbiBnZW5lcmF0ZShuYW1lLCBwYXJhbXMpIHtcbiAgICB2YXIgcm91dGVQYXJhbXMgPSBPYmplY3QuYXNzaWduKHt9LCBwYXJhbXMpO1xuXG4gICAgdmFyIHJvdXRlID0gdGhpcy5uYW1lc1tuYW1lXTtcbiAgICBpZiAoIXJvdXRlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZXJlIGlzIG5vIHJvdXRlIG5hbWVkICcgKyBuYW1lKTtcbiAgICB9XG5cbiAgICB2YXIgc2VnbWVudHMgPSByb3V0ZS5zZWdtZW50cztcbiAgICB2YXIgY29uc3VtZWQgPSB7fTtcbiAgICB2YXIgb3V0cHV0ID0gJyc7XG5cbiAgICBmb3IgKHZhciBpID0gMCwgbCA9IHNlZ21lbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgdmFyIHNlZ21lbnQgPSBzZWdtZW50c1tpXTtcblxuICAgICAgaWYgKHNlZ21lbnQgaW5zdGFuY2VvZiBFcHNpbG9uU2VnbWVudCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgb3V0cHV0ICs9ICcvJztcbiAgICAgIHZhciBzZWdtZW50VmFsdWUgPSBzZWdtZW50LmdlbmVyYXRlKHJvdXRlUGFyYW1zLCBjb25zdW1lZCk7XG4gICAgICBpZiAoc2VnbWVudFZhbHVlID09PSBudWxsIHx8IHNlZ21lbnRWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQSB2YWx1ZSBpcyByZXF1aXJlZCBmb3Igcm91dGUgcGFyYW1ldGVyIFxcJycgKyBzZWdtZW50Lm5hbWUgKyAnXFwnIGluIHJvdXRlIFxcJycgKyBuYW1lICsgJ1xcJy4nKTtcbiAgICAgIH1cblxuICAgICAgb3V0cHV0ICs9IHNlZ21lbnRWYWx1ZTtcbiAgICB9XG5cbiAgICBpZiAob3V0cHV0LmNoYXJBdCgwKSAhPT0gJy8nKSB7XG4gICAgICBvdXRwdXQgPSAnLycgKyBvdXRwdXQ7XG4gICAgfVxuXG4gICAgZm9yICh2YXIgcGFyYW0gaW4gY29uc3VtZWQpIHtcbiAgICAgIGRlbGV0ZSByb3V0ZVBhcmFtc1twYXJhbV07XG4gICAgfVxuXG4gICAgdmFyIHF1ZXJ5U3RyaW5nID0gKDAsIF9hdXJlbGlhUGF0aC5idWlsZFF1ZXJ5U3RyaW5nKShyb3V0ZVBhcmFtcyk7XG4gICAgb3V0cHV0ICs9IHF1ZXJ5U3RyaW5nID8gJz8nICsgcXVlcnlTdHJpbmcgOiAnJztcblxuICAgIHJldHVybiBvdXRwdXQ7XG4gIH07XG5cbiAgUm91dGVSZWNvZ25pemVyLnByb3RvdHlwZS5yZWNvZ25pemUgPSBmdW5jdGlvbiByZWNvZ25pemUocGF0aCkge1xuICAgIHZhciBzdGF0ZXMgPSBbdGhpcy5yb290U3RhdGVdO1xuICAgIHZhciBxdWVyeVBhcmFtcyA9IHt9O1xuICAgIHZhciBpc1NsYXNoRHJvcHBlZCA9IGZhbHNlO1xuICAgIHZhciBub3JtYWxpemVkUGF0aCA9IHBhdGg7XG5cbiAgICB2YXIgcXVlcnlTdGFydCA9IG5vcm1hbGl6ZWRQYXRoLmluZGV4T2YoJz8nKTtcbiAgICBpZiAocXVlcnlTdGFydCAhPT0gLTEpIHtcbiAgICAgIHZhciBxdWVyeVN0cmluZyA9IG5vcm1hbGl6ZWRQYXRoLnN1YnN0cihxdWVyeVN0YXJ0ICsgMSwgbm9ybWFsaXplZFBhdGgubGVuZ3RoKTtcbiAgICAgIG5vcm1hbGl6ZWRQYXRoID0gbm9ybWFsaXplZFBhdGguc3Vic3RyKDAsIHF1ZXJ5U3RhcnQpO1xuICAgICAgcXVlcnlQYXJhbXMgPSAoMCwgX2F1cmVsaWFQYXRoLnBhcnNlUXVlcnlTdHJpbmcpKHF1ZXJ5U3RyaW5nKTtcbiAgICB9XG5cbiAgICBub3JtYWxpemVkUGF0aCA9IGRlY29kZVVSSShub3JtYWxpemVkUGF0aCk7XG5cbiAgICBpZiAobm9ybWFsaXplZFBhdGguY2hhckF0KDApICE9PSAnLycpIHtcbiAgICAgIG5vcm1hbGl6ZWRQYXRoID0gJy8nICsgbm9ybWFsaXplZFBhdGg7XG4gICAgfVxuXG4gICAgdmFyIHBhdGhMZW4gPSBub3JtYWxpemVkUGF0aC5sZW5ndGg7XG4gICAgaWYgKHBhdGhMZW4gPiAxICYmIG5vcm1hbGl6ZWRQYXRoLmNoYXJBdChwYXRoTGVuIC0gMSkgPT09ICcvJykge1xuICAgICAgbm9ybWFsaXplZFBhdGggPSBub3JtYWxpemVkUGF0aC5zdWJzdHIoMCwgcGF0aExlbiAtIDEpO1xuICAgICAgaXNTbGFzaERyb3BwZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSAwLCBsID0gbm9ybWFsaXplZFBhdGgubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICBzdGF0ZXMgPSByZWNvZ25pemVDaGFyKHN0YXRlcywgbm9ybWFsaXplZFBhdGguY2hhckF0KGkpKTtcbiAgICAgIGlmICghc3RhdGVzLmxlbmd0aCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgc29sdXRpb25zID0gW107XG4gICAgZm9yICh2YXIgX2kzID0gMCwgX2wgPSBzdGF0ZXMubGVuZ3RoOyBfaTMgPCBfbDsgX2kzKyspIHtcbiAgICAgIGlmIChzdGF0ZXNbX2kzXS5oYW5kbGVycykge1xuICAgICAgICBzb2x1dGlvbnMucHVzaChzdGF0ZXNbX2kzXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgc3RhdGVzID0gc29ydFNvbHV0aW9ucyhzb2x1dGlvbnMpO1xuXG4gICAgdmFyIHN0YXRlID0gc29sdXRpb25zWzBdO1xuICAgIGlmIChzdGF0ZSAmJiBzdGF0ZS5oYW5kbGVycykge1xuICAgICAgaWYgKGlzU2xhc2hEcm9wcGVkICYmIHN0YXRlLnJlZ2V4LnNvdXJjZS5zbGljZSgtNSkgPT09ICcoLispJCcpIHtcbiAgICAgICAgbm9ybWFsaXplZFBhdGggPSBub3JtYWxpemVkUGF0aCArICcvJztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZpbmRIYW5kbGVyKHN0YXRlLCBub3JtYWxpemVkUGF0aCwgcXVlcnlQYXJhbXMpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gUm91dGVSZWNvZ25pemVyO1xufSgpO1xuXG52YXIgUmVjb2duaXplUmVzdWx0cyA9IGZ1bmN0aW9uIFJlY29nbml6ZVJlc3VsdHMocXVlcnlQYXJhbXMpIHtcbiAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlY29nbml6ZVJlc3VsdHMpO1xuXG4gIHRoaXMuc3BsaWNlID0gQXJyYXkucHJvdG90eXBlLnNwbGljZTtcbiAgdGhpcy5zbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcbiAgdGhpcy5wdXNoID0gQXJyYXkucHJvdG90eXBlLnB1c2g7XG4gIHRoaXMubGVuZ3RoID0gMDtcbiAgdGhpcy5xdWVyeVBhcmFtcyA9IHF1ZXJ5UGFyYW1zIHx8IHt9O1xufTtcblxuZnVuY3Rpb24gcGFyc2Uocm91dGUsIG5hbWVzLCB0eXBlcywgY2FzZVNlbnNpdGl2ZSkge1xuICB2YXIgbm9ybWFsaXplZFJvdXRlID0gcm91dGU7XG4gIGlmIChyb3V0ZS5jaGFyQXQoMCkgPT09ICcvJykge1xuICAgIG5vcm1hbGl6ZWRSb3V0ZSA9IHJvdXRlLnN1YnN0cigxKTtcbiAgfVxuXG4gIHZhciByZXN1bHRzID0gW107XG5cbiAgdmFyIHNwbGl0Um91dGUgPSBub3JtYWxpemVkUm91dGUuc3BsaXQoJy8nKTtcbiAgZm9yICh2YXIgaSA9IDAsIGlpID0gc3BsaXRSb3V0ZS5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgdmFyIHNlZ21lbnQgPSBzcGxpdFJvdXRlW2ldO1xuICAgIHZhciBtYXRjaCA9IHNlZ21lbnQubWF0Y2goL146KFteXFwvXSspJC8pO1xuICAgIGlmIChtYXRjaCkge1xuICAgICAgcmVzdWx0cy5wdXNoKG5ldyBEeW5hbWljU2VnbWVudChtYXRjaFsxXSkpO1xuICAgICAgbmFtZXMucHVzaChtYXRjaFsxXSk7XG4gICAgICB0eXBlcy5keW5hbWljcysrO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgbWF0Y2ggPSBzZWdtZW50Lm1hdGNoKC9eXFwqKFteXFwvXSspJC8pO1xuICAgIGlmIChtYXRjaCkge1xuICAgICAgcmVzdWx0cy5wdXNoKG5ldyBTdGFyU2VnbWVudChtYXRjaFsxXSkpO1xuICAgICAgbmFtZXMucHVzaChtYXRjaFsxXSk7XG4gICAgICB0eXBlcy5zdGFycysrO1xuICAgIH0gZWxzZSBpZiAoc2VnbWVudCA9PT0gJycpIHtcbiAgICAgIHJlc3VsdHMucHVzaChuZXcgRXBzaWxvblNlZ21lbnQoKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdHMucHVzaChuZXcgU3RhdGljU2VnbWVudChzZWdtZW50LCBjYXNlU2Vuc2l0aXZlKSk7XG4gICAgICB0eXBlcy5zdGF0aWNzKys7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdHM7XG59XG5cbmZ1bmN0aW9uIHNvcnRTb2x1dGlvbnMoc3RhdGVzKSB7XG4gIHJldHVybiBzdGF0ZXMuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgIGlmIChhLnR5cGVzLnN0YXJzICE9PSBiLnR5cGVzLnN0YXJzKSB7XG4gICAgICByZXR1cm4gYS50eXBlcy5zdGFycyAtIGIudHlwZXMuc3RhcnM7XG4gICAgfVxuXG4gICAgaWYgKGEudHlwZXMuc3RhcnMpIHtcbiAgICAgIGlmIChhLnR5cGVzLnN0YXRpY3MgIT09IGIudHlwZXMuc3RhdGljcykge1xuICAgICAgICByZXR1cm4gYi50eXBlcy5zdGF0aWNzIC0gYS50eXBlcy5zdGF0aWNzO1xuICAgICAgfVxuICAgICAgaWYgKGEudHlwZXMuZHluYW1pY3MgIT09IGIudHlwZXMuZHluYW1pY3MpIHtcbiAgICAgICAgcmV0dXJuIGIudHlwZXMuZHluYW1pY3MgLSBhLnR5cGVzLmR5bmFtaWNzO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChhLnR5cGVzLmR5bmFtaWNzICE9PSBiLnR5cGVzLmR5bmFtaWNzKSB7XG4gICAgICByZXR1cm4gYS50eXBlcy5keW5hbWljcyAtIGIudHlwZXMuZHluYW1pY3M7XG4gICAgfVxuXG4gICAgaWYgKGEudHlwZXMuc3RhdGljcyAhPT0gYi50eXBlcy5zdGF0aWNzKSB7XG4gICAgICByZXR1cm4gYi50eXBlcy5zdGF0aWNzIC0gYS50eXBlcy5zdGF0aWNzO1xuICAgIH1cblxuICAgIHJldHVybiAwO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gcmVjb2duaXplQ2hhcihzdGF0ZXMsIGNoKSB7XG4gIHZhciBuZXh0U3RhdGVzID0gW107XG5cbiAgZm9yICh2YXIgaSA9IDAsIGwgPSBzdGF0ZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgdmFyIHN0YXRlID0gc3RhdGVzW2ldO1xuICAgIG5leHRTdGF0ZXMucHVzaC5hcHBseShuZXh0U3RhdGVzLCBzdGF0ZS5tYXRjaChjaCkpO1xuICB9XG5cbiAgcmV0dXJuIG5leHRTdGF0ZXM7XG59XG5cbmZ1bmN0aW9uIGZpbmRIYW5kbGVyKHN0YXRlLCBwYXRoLCBxdWVyeVBhcmFtcykge1xuICB2YXIgaGFuZGxlcnMgPSBzdGF0ZS5oYW5kbGVycztcbiAgdmFyIHJlZ2V4ID0gc3RhdGUucmVnZXg7XG4gIHZhciBjYXB0dXJlcyA9IHBhdGgubWF0Y2gocmVnZXgpO1xuICB2YXIgY3VycmVudENhcHR1cmUgPSAxO1xuICB2YXIgcmVzdWx0ID0gbmV3IFJlY29nbml6ZVJlc3VsdHMocXVlcnlQYXJhbXMpO1xuXG4gIGZvciAodmFyIGkgPSAwLCBsID0gaGFuZGxlcnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgdmFyIF9oYW5kbGVyID0gaGFuZGxlcnNbaV07XG4gICAgdmFyIF9uYW1lcyA9IF9oYW5kbGVyLm5hbWVzO1xuICAgIHZhciBfcGFyYW1zID0ge307XG5cbiAgICBmb3IgKHZhciBqID0gMCwgbSA9IF9uYW1lcy5sZW5ndGg7IGogPCBtOyBqKyspIHtcbiAgICAgIF9wYXJhbXNbX25hbWVzW2pdXSA9IGNhcHR1cmVzW2N1cnJlbnRDYXB0dXJlKytdO1xuICAgIH1cblxuICAgIHJlc3VsdC5wdXNoKHsgaGFuZGxlcjogX2hhbmRsZXIuaGFuZGxlciwgcGFyYW1zOiBfcGFyYW1zLCBpc0R5bmFtaWM6ICEhX25hbWVzLmxlbmd0aCB9KTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmZ1bmN0aW9uIGFkZFNlZ21lbnQoY3VycmVudFN0YXRlLCBzZWdtZW50KSB7XG4gIHZhciBzdGF0ZSA9IGN1cnJlbnRTdGF0ZTtcbiAgc2VnbWVudC5lYWNoQ2hhcihmdW5jdGlvbiAoY2gpIHtcbiAgICBzdGF0ZSA9IHN0YXRlLnB1dChjaCk7XG4gIH0pO1xuXG4gIHJldHVybiBzdGF0ZTtcbn1cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLXJvdXRlLXJlY29nbml6ZXIvZGlzdC9jb21tb25qcy9hdXJlbGlhLXJvdXRlLXJlY29nbml6ZXIuanNcbiAqKiBtb2R1bGUgaWQgPSAzNFxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5UZW1wbGF0aW5nQmluZGluZ0xhbmd1YWdlID0gZXhwb3J0cy5TeW50YXhJbnRlcnByZXRlciA9IGV4cG9ydHMuQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZyA9IGV4cG9ydHMuSW50ZXJwb2xhdGlvbkJpbmRpbmcgPSBleHBvcnRzLkludGVycG9sYXRpb25CaW5kaW5nRXhwcmVzc2lvbiA9IGV4cG9ydHMuQXR0cmlidXRlTWFwID0gdW5kZWZpbmVkO1xuXG52YXIgX2NsYXNzLCBfdGVtcCwgX2RlYywgX2NsYXNzMiwgX2NsYXNzMywgX3RlbXAyLCBfY2xhc3M0LCBfdGVtcDM7XG5cbmV4cG9ydHMuY29uZmlndXJlID0gY29uZmlndXJlO1xuXG52YXIgX2F1cmVsaWFMb2dnaW5nID0gcmVxdWlyZSgnYXVyZWxpYS1sb2dnaW5nJyk7XG5cbnZhciBMb2dNYW5hZ2VyID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX2F1cmVsaWFMb2dnaW5nKTtcblxudmFyIF9hdXJlbGlhQmluZGluZyA9IHJlcXVpcmUoJ2F1cmVsaWEtYmluZGluZycpO1xuXG52YXIgX2F1cmVsaWFUZW1wbGF0aW5nID0gcmVxdWlyZSgnYXVyZWxpYS10ZW1wbGF0aW5nJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIEF0dHJpYnV0ZU1hcCA9IGV4cG9ydHMuQXR0cmlidXRlTWFwID0gKF90ZW1wID0gX2NsYXNzID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBBdHRyaWJ1dGVNYXAoc3ZnKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEF0dHJpYnV0ZU1hcCk7XG5cbiAgICB0aGlzLmVsZW1lbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICB0aGlzLmFsbEVsZW1lbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcblxuICAgIHRoaXMuc3ZnID0gc3ZnO1xuXG4gICAgdGhpcy5yZWdpc3RlclVuaXZlcnNhbCgnYWNjZXNza2V5JywgJ2FjY2Vzc0tleScpO1xuICAgIHRoaXMucmVnaXN0ZXJVbml2ZXJzYWwoJ2NvbnRlbnRlZGl0YWJsZScsICdjb250ZW50RWRpdGFibGUnKTtcbiAgICB0aGlzLnJlZ2lzdGVyVW5pdmVyc2FsKCd0YWJpbmRleCcsICd0YWJJbmRleCcpO1xuICAgIHRoaXMucmVnaXN0ZXJVbml2ZXJzYWwoJ3RleHRjb250ZW50JywgJ3RleHRDb250ZW50Jyk7XG4gICAgdGhpcy5yZWdpc3RlclVuaXZlcnNhbCgnaW5uZXJodG1sJywgJ2lubmVySFRNTCcpO1xuICAgIHRoaXMucmVnaXN0ZXJVbml2ZXJzYWwoJ3Njcm9sbHRvcCcsICdzY3JvbGxUb3AnKTtcbiAgICB0aGlzLnJlZ2lzdGVyVW5pdmVyc2FsKCdzY3JvbGxsZWZ0JywgJ3Njcm9sbExlZnQnKTtcbiAgICB0aGlzLnJlZ2lzdGVyVW5pdmVyc2FsKCdyZWFkb25seScsICdyZWFkT25seScpO1xuXG4gICAgdGhpcy5yZWdpc3RlcignbGFiZWwnLCAnZm9yJywgJ2h0bWxGb3InKTtcblxuICAgIHRoaXMucmVnaXN0ZXIoJ2lucHV0JywgJ21heGxlbmd0aCcsICdtYXhMZW5ndGgnKTtcbiAgICB0aGlzLnJlZ2lzdGVyKCdpbnB1dCcsICdtaW5sZW5ndGgnLCAnbWluTGVuZ3RoJyk7XG4gICAgdGhpcy5yZWdpc3RlcignaW5wdXQnLCAnZm9ybWFjdGlvbicsICdmb3JtQWN0aW9uJyk7XG4gICAgdGhpcy5yZWdpc3RlcignaW5wdXQnLCAnZm9ybWVuY3R5cGUnLCAnZm9ybUVuY1R5cGUnKTtcbiAgICB0aGlzLnJlZ2lzdGVyKCdpbnB1dCcsICdmb3JtbWV0aG9kJywgJ2Zvcm1NZXRob2QnKTtcbiAgICB0aGlzLnJlZ2lzdGVyKCdpbnB1dCcsICdmb3Jtbm92YWxpZGF0ZScsICdmb3JtTm9WYWxpZGF0ZScpO1xuICAgIHRoaXMucmVnaXN0ZXIoJ2lucHV0JywgJ2Zvcm10YXJnZXQnLCAnZm9ybVRhcmdldCcpO1xuXG4gICAgdGhpcy5yZWdpc3RlcigndGQnLCAncm93c3BhbicsICdyb3dTcGFuJyk7XG4gICAgdGhpcy5yZWdpc3RlcigndGQnLCAnY29sc3BhbicsICdjb2xTcGFuJyk7XG4gICAgdGhpcy5yZWdpc3RlcigndGgnLCAncm93c3BhbicsICdyb3dTcGFuJyk7XG4gICAgdGhpcy5yZWdpc3RlcigndGgnLCAnY29sc3BhbicsICdjb2xTcGFuJyk7XG4gIH1cblxuICBBdHRyaWJ1dGVNYXAucHJvdG90eXBlLnJlZ2lzdGVyID0gZnVuY3Rpb24gcmVnaXN0ZXIoZWxlbWVudE5hbWUsIGF0dHJpYnV0ZU5hbWUsIHByb3BlcnR5TmFtZSkge1xuICAgIGVsZW1lbnROYW1lID0gZWxlbWVudE5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICBhdHRyaWJ1dGVOYW1lID0gYXR0cmlidXRlTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50c1tlbGVtZW50TmFtZV0gPSB0aGlzLmVsZW1lbnRzW2VsZW1lbnROYW1lXSB8fCBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIGVsZW1lbnRbYXR0cmlidXRlTmFtZV0gPSBwcm9wZXJ0eU5hbWU7XG4gIH07XG5cbiAgQXR0cmlidXRlTWFwLnByb3RvdHlwZS5yZWdpc3RlclVuaXZlcnNhbCA9IGZ1bmN0aW9uIHJlZ2lzdGVyVW5pdmVyc2FsKGF0dHJpYnV0ZU5hbWUsIHByb3BlcnR5TmFtZSkge1xuICAgIGF0dHJpYnV0ZU5hbWUgPSBhdHRyaWJ1dGVOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgdGhpcy5hbGxFbGVtZW50c1thdHRyaWJ1dGVOYW1lXSA9IHByb3BlcnR5TmFtZTtcbiAgfTtcblxuICBBdHRyaWJ1dGVNYXAucHJvdG90eXBlLm1hcCA9IGZ1bmN0aW9uIG1hcChlbGVtZW50TmFtZSwgYXR0cmlidXRlTmFtZSkge1xuICAgIGlmICh0aGlzLnN2Zy5pc1N0YW5kYXJkU3ZnQXR0cmlidXRlKGVsZW1lbnROYW1lLCBhdHRyaWJ1dGVOYW1lKSkge1xuICAgICAgcmV0dXJuIGF0dHJpYnV0ZU5hbWU7XG4gICAgfVxuICAgIGVsZW1lbnROYW1lID0gZWxlbWVudE5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICBhdHRyaWJ1dGVOYW1lID0gYXR0cmlidXRlTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50c1tlbGVtZW50TmFtZV07XG4gICAgaWYgKGVsZW1lbnQgIT09IHVuZGVmaW5lZCAmJiBhdHRyaWJ1dGVOYW1lIGluIGVsZW1lbnQpIHtcbiAgICAgIHJldHVybiBlbGVtZW50W2F0dHJpYnV0ZU5hbWVdO1xuICAgIH1cbiAgICBpZiAoYXR0cmlidXRlTmFtZSBpbiB0aGlzLmFsbEVsZW1lbnRzKSB7XG4gICAgICByZXR1cm4gdGhpcy5hbGxFbGVtZW50c1thdHRyaWJ1dGVOYW1lXTtcbiAgICB9XG5cbiAgICBpZiAoLyheZGF0YS0pfCheYXJpYS0pfDovLnRlc3QoYXR0cmlidXRlTmFtZSkpIHtcbiAgICAgIHJldHVybiBhdHRyaWJ1dGVOYW1lO1xuICAgIH1cbiAgICByZXR1cm4gKDAsIF9hdXJlbGlhQmluZGluZy5jYW1lbENhc2UpKGF0dHJpYnV0ZU5hbWUpO1xuICB9O1xuXG4gIHJldHVybiBBdHRyaWJ1dGVNYXA7XG59KCksIF9jbGFzcy5pbmplY3QgPSBbX2F1cmVsaWFCaW5kaW5nLlNWR0FuYWx5emVyXSwgX3RlbXApO1xuXG52YXIgSW50ZXJwb2xhdGlvbkJpbmRpbmdFeHByZXNzaW9uID0gZXhwb3J0cy5JbnRlcnBvbGF0aW9uQmluZGluZ0V4cHJlc3Npb24gPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEludGVycG9sYXRpb25CaW5kaW5nRXhwcmVzc2lvbihvYnNlcnZlckxvY2F0b3IsIHRhcmdldFByb3BlcnR5LCBwYXJ0cywgbW9kZSwgbG9va3VwRnVuY3Rpb25zLCBhdHRyaWJ1dGUpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSW50ZXJwb2xhdGlvbkJpbmRpbmdFeHByZXNzaW9uKTtcblxuICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xuICAgIHRoaXMudGFyZ2V0UHJvcGVydHkgPSB0YXJnZXRQcm9wZXJ0eTtcbiAgICB0aGlzLnBhcnRzID0gcGFydHM7XG4gICAgdGhpcy5tb2RlID0gbW9kZTtcbiAgICB0aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IGxvb2t1cEZ1bmN0aW9ucztcbiAgICB0aGlzLmF0dHJpYnV0ZSA9IHRoaXMuYXR0clRvUmVtb3ZlID0gYXR0cmlidXRlO1xuICAgIHRoaXMuZGlzY3JldGUgPSBmYWxzZTtcbiAgfVxuXG4gIEludGVycG9sYXRpb25CaW5kaW5nRXhwcmVzc2lvbi5wcm90b3R5cGUuY3JlYXRlQmluZGluZyA9IGZ1bmN0aW9uIGNyZWF0ZUJpbmRpbmcodGFyZ2V0KSB7XG4gICAgaWYgKHRoaXMucGFydHMubGVuZ3RoID09PSAzKSB7XG4gICAgICByZXR1cm4gbmV3IENoaWxkSW50ZXJwb2xhdGlvbkJpbmRpbmcodGFyZ2V0LCB0aGlzLm9ic2VydmVyTG9jYXRvciwgdGhpcy5wYXJ0c1sxXSwgdGhpcy5tb2RlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucywgdGhpcy50YXJnZXRQcm9wZXJ0eSwgdGhpcy5wYXJ0c1swXSwgdGhpcy5wYXJ0c1syXSk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgSW50ZXJwb2xhdGlvbkJpbmRpbmcodGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMucGFydHMsIHRhcmdldCwgdGhpcy50YXJnZXRQcm9wZXJ0eSwgdGhpcy5tb2RlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gIH07XG5cbiAgcmV0dXJuIEludGVycG9sYXRpb25CaW5kaW5nRXhwcmVzc2lvbjtcbn0oKTtcblxuZnVuY3Rpb24gdmFsaWRhdGVUYXJnZXQodGFyZ2V0LCBwcm9wZXJ0eU5hbWUpIHtcbiAgaWYgKHByb3BlcnR5TmFtZSA9PT0gJ3N0eWxlJykge1xuICAgIExvZ01hbmFnZXIuZ2V0TG9nZ2VyKCd0ZW1wbGF0aW5nLWJpbmRpbmcnKS5pbmZvKCdJbnRlcm5ldCBFeHBsb3JlciBkb2VzIG5vdCBzdXBwb3J0IGludGVycG9sYXRpb24gaW4gXCJzdHlsZVwiIGF0dHJpYnV0ZXMuICBVc2UgdGhlIHN0eWxlIGF0dHJpYnV0ZVxcJ3MgYWxpYXMsIFwiY3NzXCIgaW5zdGVhZC4nKTtcbiAgfSBlbHNlIGlmICh0YXJnZXQucGFyZW50RWxlbWVudCAmJiB0YXJnZXQucGFyZW50RWxlbWVudC5ub2RlTmFtZSA9PT0gJ1RFWFRBUkVBJyAmJiBwcm9wZXJ0eU5hbWUgPT09ICd0ZXh0Q29udGVudCcpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludGVycG9sYXRpb24gYmluZGluZyBjYW5ub3QgYmUgdXNlZCBpbiB0aGUgY29udGVudCBvZiBhIHRleHRhcmVhIGVsZW1lbnQuICBVc2UgPHRleHRhcmVhIHZhbHVlLmJpbmQ9XCJleHByZXNzaW9uXCI+PC90ZXh0YXJlYT4gaW5zdGVhZC4nKTtcbiAgfVxufVxuXG52YXIgSW50ZXJwb2xhdGlvbkJpbmRpbmcgPSBleHBvcnRzLkludGVycG9sYXRpb25CaW5kaW5nID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBJbnRlcnBvbGF0aW9uQmluZGluZyhvYnNlcnZlckxvY2F0b3IsIHBhcnRzLCB0YXJnZXQsIHRhcmdldFByb3BlcnR5LCBtb2RlLCBsb29rdXBGdW5jdGlvbnMpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSW50ZXJwb2xhdGlvbkJpbmRpbmcpO1xuXG4gICAgdmFsaWRhdGVUYXJnZXQodGFyZ2V0LCB0YXJnZXRQcm9wZXJ0eSk7XG4gICAgdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XG4gICAgdGhpcy5wYXJ0cyA9IHBhcnRzO1xuICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgIHRoaXMudGFyZ2V0UHJvcGVydHkgPSB0YXJnZXRQcm9wZXJ0eTtcbiAgICB0aGlzLnRhcmdldEFjY2Vzc29yID0gb2JzZXJ2ZXJMb2NhdG9yLmdldEFjY2Vzc29yKHRhcmdldCwgdGFyZ2V0UHJvcGVydHkpO1xuICAgIHRoaXMubW9kZSA9IG1vZGU7XG4gICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSBsb29rdXBGdW5jdGlvbnM7XG4gIH1cblxuICBJbnRlcnBvbGF0aW9uQmluZGluZy5wcm90b3R5cGUuaW50ZXJwb2xhdGUgPSBmdW5jdGlvbiBpbnRlcnBvbGF0ZSgpIHtcbiAgICBpZiAodGhpcy5pc0JvdW5kKSB7XG4gICAgICB2YXIgdmFsdWUgPSAnJztcbiAgICAgIHZhciBwYXJ0cyA9IHRoaXMucGFydHM7XG4gICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBwYXJ0cy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgIHZhbHVlICs9IGkgJSAyID09PSAwID8gcGFydHNbaV0gOiB0aGlzWydjaGlsZEJpbmRpbmcnICsgaV0udmFsdWU7XG4gICAgICB9XG4gICAgICB0aGlzLnRhcmdldEFjY2Vzc29yLnNldFZhbHVlKHZhbHVlLCB0aGlzLnRhcmdldCwgdGhpcy50YXJnZXRQcm9wZXJ0eSk7XG4gICAgfVxuICB9O1xuXG4gIEludGVycG9sYXRpb25CaW5kaW5nLnByb3RvdHlwZS51cGRhdGVPbmVUaW1lQmluZGluZ3MgPSBmdW5jdGlvbiB1cGRhdGVPbmVUaW1lQmluZGluZ3MoKSB7XG4gICAgZm9yICh2YXIgaSA9IDEsIGlpID0gdGhpcy5wYXJ0cy5sZW5ndGg7IGkgPCBpaTsgaSArPSAyKSB7XG4gICAgICB2YXIgY2hpbGQgPSB0aGlzWydjaGlsZEJpbmRpbmcnICsgaV07XG4gICAgICBpZiAoY2hpbGQubW9kZSA9PT0gX2F1cmVsaWFCaW5kaW5nLmJpbmRpbmdNb2RlLm9uZVRpbWUpIHtcbiAgICAgICAgY2hpbGQuY2FsbCgpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBJbnRlcnBvbGF0aW9uQmluZGluZy5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIGJpbmQoc291cmNlKSB7XG4gICAgaWYgKHRoaXMuaXNCb3VuZCkge1xuICAgICAgaWYgKHRoaXMuc291cmNlID09PSBzb3VyY2UpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy51bmJpbmQoKTtcbiAgICB9XG4gICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cbiAgICB2YXIgcGFydHMgPSB0aGlzLnBhcnRzO1xuICAgIGZvciAodmFyIGkgPSAxLCBpaSA9IHBhcnRzLmxlbmd0aDsgaSA8IGlpOyBpICs9IDIpIHtcbiAgICAgIHZhciBiaW5kaW5nID0gbmV3IENoaWxkSW50ZXJwb2xhdGlvbkJpbmRpbmcodGhpcywgdGhpcy5vYnNlcnZlckxvY2F0b3IsIHBhcnRzW2ldLCB0aGlzLm1vZGUsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICAgIGJpbmRpbmcuYmluZChzb3VyY2UpO1xuICAgICAgdGhpc1snY2hpbGRCaW5kaW5nJyArIGldID0gYmluZGluZztcbiAgICB9XG5cbiAgICB0aGlzLmlzQm91bmQgPSB0cnVlO1xuICAgIHRoaXMuaW50ZXJwb2xhdGUoKTtcbiAgfTtcblxuICBJbnRlcnBvbGF0aW9uQmluZGluZy5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gdW5iaW5kKCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgIHRoaXMuc291cmNlID0gbnVsbDtcbiAgICB2YXIgcGFydHMgPSB0aGlzLnBhcnRzO1xuICAgIGZvciAodmFyIGkgPSAxLCBpaSA9IHBhcnRzLmxlbmd0aDsgaSA8IGlpOyBpICs9IDIpIHtcbiAgICAgIHZhciBuYW1lID0gJ2NoaWxkQmluZGluZycgKyBpO1xuICAgICAgdGhpc1tuYW1lXS51bmJpbmQoKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIEludGVycG9sYXRpb25CaW5kaW5nO1xufSgpO1xuXG52YXIgQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZyA9IGV4cG9ydHMuQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZyA9IChfZGVjID0gKDAsIF9hdXJlbGlhQmluZGluZy5jb25uZWN0YWJsZSkoKSwgX2RlYyhfY2xhc3MyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBDaGlsZEludGVycG9sYXRpb25CaW5kaW5nKHRhcmdldCwgb2JzZXJ2ZXJMb2NhdG9yLCBzb3VyY2VFeHByZXNzaW9uLCBtb2RlLCBsb29rdXBGdW5jdGlvbnMsIHRhcmdldFByb3BlcnR5LCBsZWZ0LCByaWdodCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDaGlsZEludGVycG9sYXRpb25CaW5kaW5nKTtcblxuICAgIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBJbnRlcnBvbGF0aW9uQmluZGluZykge1xuICAgICAgdGhpcy5wYXJlbnQgPSB0YXJnZXQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbGlkYXRlVGFyZ2V0KHRhcmdldCwgdGFyZ2V0UHJvcGVydHkpO1xuICAgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgICB0aGlzLnRhcmdldFByb3BlcnR5ID0gdGFyZ2V0UHJvcGVydHk7XG4gICAgICB0aGlzLnRhcmdldEFjY2Vzc29yID0gb2JzZXJ2ZXJMb2NhdG9yLmdldEFjY2Vzc29yKHRhcmdldCwgdGFyZ2V0UHJvcGVydHkpO1xuICAgIH1cbiAgICB0aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcbiAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24gPSBzb3VyY2VFeHByZXNzaW9uO1xuICAgIHRoaXMubW9kZSA9IG1vZGU7XG4gICAgdGhpcy5sb29rdXBGdW5jdGlvbnMgPSBsb29rdXBGdW5jdGlvbnM7XG4gICAgdGhpcy5sZWZ0ID0gbGVmdDtcbiAgICB0aGlzLnJpZ2h0ID0gcmlnaHQ7XG4gIH1cblxuICBDaGlsZEludGVycG9sYXRpb25CaW5kaW5nLnByb3RvdHlwZS51cGRhdGVUYXJnZXQgPSBmdW5jdGlvbiB1cGRhdGVUYXJnZXQodmFsdWUpIHtcbiAgICB2YWx1ZSA9IHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgPyAnJyA6IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgaWYgKHZhbHVlICE9PSB0aGlzLnZhbHVlKSB7XG4gICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgICAgdGhpcy5wYXJlbnQuaW50ZXJwb2xhdGUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMudGFyZ2V0QWNjZXNzb3Iuc2V0VmFsdWUodGhpcy5sZWZ0ICsgdmFsdWUgKyB0aGlzLnJpZ2h0LCB0aGlzLnRhcmdldCwgdGhpcy50YXJnZXRQcm9wZXJ0eSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIENoaWxkSW50ZXJwb2xhdGlvbkJpbmRpbmcucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbiBjYWxsKCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIHZhbHVlID0gdGhpcy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc291cmNlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgdGhpcy51cGRhdGVUYXJnZXQodmFsdWUpO1xuXG4gICAgaWYgKHRoaXMubW9kZSAhPT0gX2F1cmVsaWFCaW5kaW5nLmJpbmRpbmdNb2RlLm9uZVRpbWUpIHtcbiAgICAgIHRoaXMuX3ZlcnNpb24rKztcbiAgICAgIHRoaXMuc291cmNlRXhwcmVzc2lvbi5jb25uZWN0KHRoaXMsIHRoaXMuc291cmNlKTtcbiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgIHRoaXMub2JzZXJ2ZUFycmF5KHZhbHVlKTtcbiAgICAgIH1cbiAgICAgIHRoaXMudW5vYnNlcnZlKGZhbHNlKTtcbiAgICB9XG4gIH07XG5cbiAgQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZy5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIGJpbmQoc291cmNlKSB7XG4gICAgaWYgKHRoaXMuaXNCb3VuZCkge1xuICAgICAgaWYgKHRoaXMuc291cmNlID09PSBzb3VyY2UpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy51bmJpbmQoKTtcbiAgICB9XG4gICAgdGhpcy5pc0JvdW5kID0gdHJ1ZTtcbiAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblxuICAgIHZhciBzb3VyY2VFeHByZXNzaW9uID0gdGhpcy5zb3VyY2VFeHByZXNzaW9uO1xuICAgIGlmIChzb3VyY2VFeHByZXNzaW9uLmJpbmQpIHtcbiAgICAgIHNvdXJjZUV4cHJlc3Npb24uYmluZCh0aGlzLCBzb3VyY2UsIHRoaXMubG9va3VwRnVuY3Rpb25zKTtcbiAgICB9XG5cbiAgICB2YXIgdmFsdWUgPSBzb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHNvdXJjZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICAgIHRoaXMudXBkYXRlVGFyZ2V0KHZhbHVlKTtcblxuICAgIGlmICh0aGlzLm1vZGUgPT09IF9hdXJlbGlhQmluZGluZy5iaW5kaW5nTW9kZS5vbmVXYXkpIHtcbiAgICAgICgwLCBfYXVyZWxpYUJpbmRpbmcuZW5xdWV1ZUJpbmRpbmdDb25uZWN0KSh0aGlzKTtcbiAgICB9XG4gIH07XG5cbiAgQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZy5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gdW5iaW5kKCkge1xuICAgIGlmICghdGhpcy5pc0JvdW5kKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaXNCb3VuZCA9IGZhbHNlO1xuICAgIHZhciBzb3VyY2VFeHByZXNzaW9uID0gdGhpcy5zb3VyY2VFeHByZXNzaW9uO1xuICAgIGlmIChzb3VyY2VFeHByZXNzaW9uLnVuYmluZCkge1xuICAgICAgc291cmNlRXhwcmVzc2lvbi51bmJpbmQodGhpcywgdGhpcy5zb3VyY2UpO1xuICAgIH1cbiAgICB0aGlzLnNvdXJjZSA9IG51bGw7XG4gICAgdGhpcy51bm9ic2VydmUodHJ1ZSk7XG4gIH07XG5cbiAgQ2hpbGRJbnRlcnBvbGF0aW9uQmluZGluZy5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uIGNvbm5lY3QoZXZhbHVhdGUpIHtcbiAgICBpZiAoIXRoaXMuaXNCb3VuZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZXZhbHVhdGUpIHtcbiAgICAgIHZhciB2YWx1ZSA9IHRoaXMuc291cmNlRXhwcmVzc2lvbi5ldmFsdWF0ZSh0aGlzLnNvdXJjZSwgdGhpcy5sb29rdXBGdW5jdGlvbnMpO1xuICAgICAgdGhpcy51cGRhdGVUYXJnZXQodmFsdWUpO1xuICAgIH1cbiAgICB0aGlzLnNvdXJjZUV4cHJlc3Npb24uY29ubmVjdCh0aGlzLCB0aGlzLnNvdXJjZSk7XG4gICAgaWYgKHRoaXMudmFsdWUgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgdGhpcy5vYnNlcnZlQXJyYXkodGhpcy52YWx1ZSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBDaGlsZEludGVycG9sYXRpb25CaW5kaW5nO1xufSgpKSB8fCBfY2xhc3MyKTtcbnZhciBTeW50YXhJbnRlcnByZXRlciA9IGV4cG9ydHMuU3ludGF4SW50ZXJwcmV0ZXIgPSAoX3RlbXAyID0gX2NsYXNzMyA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gU3ludGF4SW50ZXJwcmV0ZXIocGFyc2VyLCBvYnNlcnZlckxvY2F0b3IsIGV2ZW50TWFuYWdlciwgYXR0cmlidXRlTWFwKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN5bnRheEludGVycHJldGVyKTtcblxuICAgIHRoaXMucGFyc2VyID0gcGFyc2VyO1xuICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyID0gZXZlbnRNYW5hZ2VyO1xuICAgIHRoaXMuYXR0cmlidXRlTWFwID0gYXR0cmlidXRlTWFwO1xuICB9XG5cbiAgU3ludGF4SW50ZXJwcmV0ZXIucHJvdG90eXBlLmludGVycHJldCA9IGZ1bmN0aW9uIGludGVycHJldChyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24sIGNvbnRleHQpIHtcbiAgICBpZiAoaW5mby5jb21tYW5kIGluIHRoaXMpIHtcbiAgICAgIHJldHVybiB0aGlzW2luZm8uY29tbWFuZF0ocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvLCBleGlzdGluZ0luc3RydWN0aW9uLCBjb250ZXh0KTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5oYW5kbGVVbmtub3duQ29tbWFuZChyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24sIGNvbnRleHQpO1xuICB9O1xuXG4gIFN5bnRheEludGVycHJldGVyLnByb3RvdHlwZS5oYW5kbGVVbmtub3duQ29tbWFuZCA9IGZ1bmN0aW9uIGhhbmRsZVVua25vd25Db21tYW5kKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbiwgY29udGV4dCkge1xuICAgIExvZ01hbmFnZXIuZ2V0TG9nZ2VyKCd0ZW1wbGF0aW5nLWJpbmRpbmcnKS53YXJuKCdVbmtub3duIGJpbmRpbmcgY29tbWFuZC4nLCBpbmZvKTtcbiAgICByZXR1cm4gZXhpc3RpbmdJbnN0cnVjdGlvbjtcbiAgfTtcblxuICBTeW50YXhJbnRlcnByZXRlci5wcm90b3R5cGUuZGV0ZXJtaW5lRGVmYXVsdEJpbmRpbmdNb2RlID0gZnVuY3Rpb24gZGV0ZXJtaW5lRGVmYXVsdEJpbmRpbmdNb2RlKGVsZW1lbnQsIGF0dHJOYW1lLCBjb250ZXh0KSB7XG4gICAgdmFyIHRhZ05hbWUgPSBlbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcblxuICAgIGlmICh0YWdOYW1lID09PSAnaW5wdXQnICYmIChhdHRyTmFtZSA9PT0gJ3ZhbHVlJyB8fCBhdHRyTmFtZSA9PT0gJ2ZpbGVzJykgJiYgZWxlbWVudC50eXBlICE9PSAnY2hlY2tib3gnICYmIGVsZW1lbnQudHlwZSAhPT0gJ3JhZGlvJyB8fCB0YWdOYW1lID09PSAnaW5wdXQnICYmIGF0dHJOYW1lID09PSAnY2hlY2tlZCcgJiYgKGVsZW1lbnQudHlwZSA9PT0gJ2NoZWNrYm94JyB8fCBlbGVtZW50LnR5cGUgPT09ICdyYWRpbycpIHx8ICh0YWdOYW1lID09PSAndGV4dGFyZWEnIHx8IHRhZ05hbWUgPT09ICdzZWxlY3QnKSAmJiBhdHRyTmFtZSA9PT0gJ3ZhbHVlJyB8fCAoYXR0ck5hbWUgPT09ICd0ZXh0Y29udGVudCcgfHwgYXR0ck5hbWUgPT09ICdpbm5lcmh0bWwnKSAmJiBlbGVtZW50LmNvbnRlbnRFZGl0YWJsZSA9PT0gJ3RydWUnIHx8IGF0dHJOYW1lID09PSAnc2Nyb2xsdG9wJyB8fCBhdHRyTmFtZSA9PT0gJ3Njcm9sbGxlZnQnKSB7XG4gICAgICByZXR1cm4gX2F1cmVsaWFCaW5kaW5nLmJpbmRpbmdNb2RlLnR3b1dheTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dCAmJiBhdHRyTmFtZSBpbiBjb250ZXh0LmF0dHJpYnV0ZXMgJiYgY29udGV4dC5hdHRyaWJ1dGVzW2F0dHJOYW1lXSAmJiBjb250ZXh0LmF0dHJpYnV0ZXNbYXR0ck5hbWVdLmRlZmF1bHRCaW5kaW5nTW9kZSA+PSBfYXVyZWxpYUJpbmRpbmcuYmluZGluZ01vZGUub25lVGltZSkge1xuICAgICAgcmV0dXJuIGNvbnRleHQuYXR0cmlidXRlc1thdHRyTmFtZV0uZGVmYXVsdEJpbmRpbmdNb2RlO1xuICAgIH1cblxuICAgIHJldHVybiBfYXVyZWxpYUJpbmRpbmcuYmluZGluZ01vZGUub25lV2F5O1xuICB9O1xuXG4gIFN5bnRheEludGVycHJldGVyLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gYmluZChyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24sIGNvbnRleHQpIHtcbiAgICB2YXIgaW5zdHJ1Y3Rpb24gPSBleGlzdGluZ0luc3RydWN0aW9uIHx8IF9hdXJlbGlhVGVtcGxhdGluZy5CZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZShpbmZvLmF0dHJOYW1lKTtcblxuICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBuZXcgX2F1cmVsaWFCaW5kaW5nLkJpbmRpbmdFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0aGlzLmF0dHJpYnV0ZU1hcC5tYXAoZWxlbWVudC50YWdOYW1lLCBpbmZvLmF0dHJOYW1lKSwgdGhpcy5wYXJzZXIucGFyc2UoaW5mby5hdHRyVmFsdWUpLCBpbmZvLmRlZmF1bHRCaW5kaW5nTW9kZSB8fCB0aGlzLmRldGVybWluZURlZmF1bHRCaW5kaW5nTW9kZShlbGVtZW50LCBpbmZvLmF0dHJOYW1lLCBjb250ZXh0KSwgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucyk7XG5cbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XG4gIH07XG5cbiAgU3ludGF4SW50ZXJwcmV0ZXIucHJvdG90eXBlLnRyaWdnZXIgPSBmdW5jdGlvbiB0cmlnZ2VyKHJlc291cmNlcywgZWxlbWVudCwgaW5mbykge1xuICAgIHJldHVybiBuZXcgX2F1cmVsaWFCaW5kaW5nLkxpc3RlbmVyRXhwcmVzc2lvbih0aGlzLmV2ZW50TWFuYWdlciwgaW5mby5hdHRyTmFtZSwgdGhpcy5wYXJzZXIucGFyc2UoaW5mby5hdHRyVmFsdWUpLCBmYWxzZSwgdHJ1ZSwgcmVzb3VyY2VzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gIH07XG5cbiAgU3ludGF4SW50ZXJwcmV0ZXIucHJvdG90eXBlLmRlbGVnYXRlID0gZnVuY3Rpb24gZGVsZWdhdGUocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvKSB7XG4gICAgcmV0dXJuIG5ldyBfYXVyZWxpYUJpbmRpbmcuTGlzdGVuZXJFeHByZXNzaW9uKHRoaXMuZXZlbnRNYW5hZ2VyLCBpbmZvLmF0dHJOYW1lLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIHRydWUsIHRydWUsIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuICB9O1xuXG4gIFN5bnRheEludGVycHJldGVyLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gY2FsbChyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24pIHtcbiAgICB2YXIgaW5zdHJ1Y3Rpb24gPSBleGlzdGluZ0luc3RydWN0aW9uIHx8IF9hdXJlbGlhVGVtcGxhdGluZy5CZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZShpbmZvLmF0dHJOYW1lKTtcblxuICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0gPSBuZXcgX2F1cmVsaWFCaW5kaW5nLkNhbGxFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBpbmZvLmF0dHJOYW1lLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9O1xuXG4gIFN5bnRheEludGVycHJldGVyLnByb3RvdHlwZS5vcHRpb25zID0gZnVuY3Rpb24gb3B0aW9ucyhyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24sIGNvbnRleHQpIHtcbiAgICB2YXIgaW5zdHJ1Y3Rpb24gPSBleGlzdGluZ0luc3RydWN0aW9uIHx8IF9hdXJlbGlhVGVtcGxhdGluZy5CZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZShpbmZvLmF0dHJOYW1lKTtcbiAgICB2YXIgYXR0clZhbHVlID0gaW5mby5hdHRyVmFsdWU7XG4gICAgdmFyIGxhbmd1YWdlID0gdGhpcy5sYW5ndWFnZTtcbiAgICB2YXIgbmFtZSA9IG51bGw7XG4gICAgdmFyIHRhcmdldCA9ICcnO1xuICAgIHZhciBjdXJyZW50ID0gdm9pZCAwO1xuICAgIHZhciBpID0gdm9pZCAwO1xuICAgIHZhciBpaSA9IHZvaWQgMDtcbiAgICB2YXIgaW5TdHJpbmcgPSBmYWxzZTtcbiAgICB2YXIgaW5Fc2NhcGUgPSBmYWxzZTtcblxuICAgIGZvciAoaSA9IDAsIGlpID0gYXR0clZhbHVlLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGN1cnJlbnQgPSBhdHRyVmFsdWVbaV07XG5cbiAgICAgIGlmIChjdXJyZW50ID09PSAnOycgJiYgIWluU3RyaW5nKSB7XG4gICAgICAgIGluZm8gPSBsYW5ndWFnZS5pbnNwZWN0QXR0cmlidXRlKHJlc291cmNlcywgJz8nLCBuYW1lLCB0YXJnZXQudHJpbSgpKTtcbiAgICAgICAgbGFuZ3VhZ2UuY3JlYXRlQXR0cmlidXRlSW5zdHJ1Y3Rpb24ocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvLCBpbnN0cnVjdGlvbiwgY29udGV4dCk7XG5cbiAgICAgICAgaWYgKCFpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2luZm8uYXR0ck5hbWVdKSB7XG4gICAgICAgICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlc1tpbmZvLmF0dHJOYW1lXSA9IGluZm8uYXR0clZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGFyZ2V0ID0gJyc7XG4gICAgICAgIG5hbWUgPSBudWxsO1xuICAgICAgfSBlbHNlIGlmIChjdXJyZW50ID09PSAnOicgJiYgbmFtZSA9PT0gbnVsbCkge1xuICAgICAgICBuYW1lID0gdGFyZ2V0LnRyaW0oKTtcbiAgICAgICAgdGFyZ2V0ID0gJyc7XG4gICAgICB9IGVsc2UgaWYgKGN1cnJlbnQgPT09ICdcXFxcJykge1xuICAgICAgICB0YXJnZXQgKz0gY3VycmVudDtcbiAgICAgICAgaW5Fc2NhcGUgPSB0cnVlO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRhcmdldCArPSBjdXJyZW50O1xuXG4gICAgICAgIGlmIChuYW1lICE9PSBudWxsICYmIGluRXNjYXBlID09PSBmYWxzZSAmJiBjdXJyZW50ID09PSAnXFwnJykge1xuICAgICAgICAgIGluU3RyaW5nID0gIWluU3RyaW5nO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGluRXNjYXBlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKG5hbWUgIT09IG51bGwpIHtcbiAgICAgIGluZm8gPSBsYW5ndWFnZS5pbnNwZWN0QXR0cmlidXRlKHJlc291cmNlcywgJz8nLCBuYW1lLCB0YXJnZXQudHJpbSgpKTtcbiAgICAgIGxhbmd1YWdlLmNyZWF0ZUF0dHJpYnV0ZUluc3RydWN0aW9uKHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgaW5zdHJ1Y3Rpb24sIGNvbnRleHQpO1xuXG4gICAgICBpZiAoIWluc3RydWN0aW9uLmF0dHJpYnV0ZXNbaW5mby5hdHRyTmFtZV0pIHtcbiAgICAgICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlc1tpbmZvLmF0dHJOYW1lXSA9IGluZm8uYXR0clZhbHVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBpbnN0cnVjdGlvbjtcbiAgfTtcblxuICBTeW50YXhJbnRlcnByZXRlci5wcm90b3R5cGVbJ2ZvciddID0gZnVuY3Rpb24gX2ZvcihyZXNvdXJjZXMsIGVsZW1lbnQsIGluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24pIHtcbiAgICB2YXIgcGFydHMgPSB2b2lkIDA7XG4gICAgdmFyIGtleVZhbHVlID0gdm9pZCAwO1xuICAgIHZhciBpbnN0cnVjdGlvbiA9IHZvaWQgMDtcbiAgICB2YXIgYXR0clZhbHVlID0gdm9pZCAwO1xuICAgIHZhciBpc0Rlc3RydWN0dXJpbmcgPSB2b2lkIDA7XG5cbiAgICBhdHRyVmFsdWUgPSBpbmZvLmF0dHJWYWx1ZTtcbiAgICBpc0Rlc3RydWN0dXJpbmcgPSBhdHRyVmFsdWUubWF0Y2goL14gKltbXS4rW1xcXV0vKTtcbiAgICBwYXJ0cyA9IGlzRGVzdHJ1Y3R1cmluZyA/IGF0dHJWYWx1ZS5zcGxpdCgnb2YgJykgOiBhdHRyVmFsdWUuc3BsaXQoJyBvZiAnKTtcblxuICAgIGlmIChwYXJ0cy5sZW5ndGggIT09IDIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW5jb3JyZWN0IHN5bnRheCBmb3IgXCJmb3JcIi4gVGhlIGZvcm0gaXM6IFwiJGxvY2FsIG9mICRpdGVtc1wiIG9yIFwiWyRrZXksICR2YWx1ZV0gb2YgJGl0ZW1zXCIuJyk7XG4gICAgfVxuXG4gICAgaW5zdHJ1Y3Rpb24gPSBleGlzdGluZ0luc3RydWN0aW9uIHx8IF9hdXJlbGlhVGVtcGxhdGluZy5CZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZShpbmZvLmF0dHJOYW1lKTtcblxuICAgIGlmIChpc0Rlc3RydWN0dXJpbmcpIHtcbiAgICAgIGtleVZhbHVlID0gcGFydHNbMF0ucmVwbGFjZSgvW1tcXF1dL2csICcnKS5yZXBsYWNlKC8sL2csICcgJykucmVwbGFjZSgvXFxzKy9nLCAnICcpLnRyaW0oKS5zcGxpdCgnICcpO1xuICAgICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlcy5rZXkgPSBrZXlWYWx1ZVswXTtcbiAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXMudmFsdWUgPSBrZXlWYWx1ZVsxXTtcbiAgICB9IGVsc2Uge1xuICAgICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlcy5sb2NhbCA9IHBhcnRzWzBdO1xuICAgIH1cblxuICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXMuaXRlbXMgPSBuZXcgX2F1cmVsaWFCaW5kaW5nLkJpbmRpbmdFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCAnaXRlbXMnLCB0aGlzLnBhcnNlci5wYXJzZShwYXJ0c1sxXSksIF9hdXJlbGlhQmluZGluZy5iaW5kaW5nTW9kZS5vbmVXYXksIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9O1xuXG4gIFN5bnRheEludGVycHJldGVyLnByb3RvdHlwZVsndHdvLXdheSddID0gZnVuY3Rpb24gdHdvV2F5KHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbikge1xuICAgIHZhciBpbnN0cnVjdGlvbiA9IGV4aXN0aW5nSW5zdHJ1Y3Rpb24gfHwgX2F1cmVsaWFUZW1wbGF0aW5nLkJlaGF2aW9ySW5zdHJ1Y3Rpb24uYXR0cmlidXRlKGluZm8uYXR0ck5hbWUpO1xuXG4gICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlc1tpbmZvLmF0dHJOYW1lXSA9IG5ldyBfYXVyZWxpYUJpbmRpbmcuQmluZGluZ0V4cHJlc3Npb24odGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuYXR0cmlidXRlTWFwLm1hcChlbGVtZW50LnRhZ05hbWUsIGluZm8uYXR0ck5hbWUpLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIF9hdXJlbGlhQmluZGluZy5iaW5kaW5nTW9kZS50d29XYXksIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9O1xuXG4gIFN5bnRheEludGVycHJldGVyLnByb3RvdHlwZVsnb25lLXdheSddID0gZnVuY3Rpb24gb25lV2F5KHJlc291cmNlcywgZWxlbWVudCwgaW5mbywgZXhpc3RpbmdJbnN0cnVjdGlvbikge1xuICAgIHZhciBpbnN0cnVjdGlvbiA9IGV4aXN0aW5nSW5zdHJ1Y3Rpb24gfHwgX2F1cmVsaWFUZW1wbGF0aW5nLkJlaGF2aW9ySW5zdHJ1Y3Rpb24uYXR0cmlidXRlKGluZm8uYXR0ck5hbWUpO1xuXG4gICAgaW5zdHJ1Y3Rpb24uYXR0cmlidXRlc1tpbmZvLmF0dHJOYW1lXSA9IG5ldyBfYXVyZWxpYUJpbmRpbmcuQmluZGluZ0V4cHJlc3Npb24odGhpcy5vYnNlcnZlckxvY2F0b3IsIHRoaXMuYXR0cmlidXRlTWFwLm1hcChlbGVtZW50LnRhZ05hbWUsIGluZm8uYXR0ck5hbWUpLCB0aGlzLnBhcnNlci5wYXJzZShpbmZvLmF0dHJWYWx1ZSksIF9hdXJlbGlhQmluZGluZy5iaW5kaW5nTW9kZS5vbmVXYXksIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9O1xuXG4gIFN5bnRheEludGVycHJldGVyLnByb3RvdHlwZVsnb25lLXRpbWUnXSA9IGZ1bmN0aW9uIG9uZVRpbWUocmVzb3VyY2VzLCBlbGVtZW50LCBpbmZvLCBleGlzdGluZ0luc3RydWN0aW9uKSB7XG4gICAgdmFyIGluc3RydWN0aW9uID0gZXhpc3RpbmdJbnN0cnVjdGlvbiB8fCBfYXVyZWxpYVRlbXBsYXRpbmcuQmVoYXZpb3JJbnN0cnVjdGlvbi5hdHRyaWJ1dGUoaW5mby5hdHRyTmFtZSk7XG5cbiAgICBpbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW2luZm8uYXR0ck5hbWVdID0gbmV3IF9hdXJlbGlhQmluZGluZy5CaW5kaW5nRXhwcmVzc2lvbih0aGlzLm9ic2VydmVyTG9jYXRvciwgdGhpcy5hdHRyaWJ1dGVNYXAubWFwKGVsZW1lbnQudGFnTmFtZSwgaW5mby5hdHRyTmFtZSksIHRoaXMucGFyc2VyLnBhcnNlKGluZm8uYXR0clZhbHVlKSwgX2F1cmVsaWFCaW5kaW5nLmJpbmRpbmdNb2RlLm9uZVRpbWUsIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMpO1xuXG4gICAgcmV0dXJuIGluc3RydWN0aW9uO1xuICB9O1xuXG4gIHJldHVybiBTeW50YXhJbnRlcnByZXRlcjtcbn0oKSwgX2NsYXNzMy5pbmplY3QgPSBbX2F1cmVsaWFCaW5kaW5nLlBhcnNlciwgX2F1cmVsaWFCaW5kaW5nLk9ic2VydmVyTG9jYXRvciwgX2F1cmVsaWFCaW5kaW5nLkV2ZW50TWFuYWdlciwgQXR0cmlidXRlTWFwXSwgX3RlbXAyKTtcblxudmFyIGluZm8gPSB7fTtcblxudmFyIFRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2UgPSBleHBvcnRzLlRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2UgPSAoX3RlbXAzID0gX2NsYXNzNCA9IGZ1bmN0aW9uIChfQmluZGluZ0xhbmd1YWdlKSB7XG4gIF9pbmhlcml0cyhUZW1wbGF0aW5nQmluZGluZ0xhbmd1YWdlLCBfQmluZGluZ0xhbmd1YWdlKTtcblxuICBmdW5jdGlvbiBUZW1wbGF0aW5nQmluZGluZ0xhbmd1YWdlKHBhcnNlciwgb2JzZXJ2ZXJMb2NhdG9yLCBzeW50YXhJbnRlcnByZXRlciwgYXR0cmlidXRlTWFwKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2UpO1xuXG4gICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX0JpbmRpbmdMYW5ndWFnZS5jYWxsKHRoaXMpKTtcblxuICAgIF90aGlzLnBhcnNlciA9IHBhcnNlcjtcbiAgICBfdGhpcy5vYnNlcnZlckxvY2F0b3IgPSBvYnNlcnZlckxvY2F0b3I7XG4gICAgX3RoaXMuc3ludGF4SW50ZXJwcmV0ZXIgPSBzeW50YXhJbnRlcnByZXRlcjtcbiAgICBfdGhpcy5lbXB0eVN0cmluZ0V4cHJlc3Npb24gPSBfdGhpcy5wYXJzZXIucGFyc2UoJ1xcJ1xcJycpO1xuICAgIHN5bnRheEludGVycHJldGVyLmxhbmd1YWdlID0gX3RoaXM7XG4gICAgX3RoaXMuYXR0cmlidXRlTWFwID0gYXR0cmlidXRlTWFwO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIFRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2UucHJvdG90eXBlLmluc3BlY3RBdHRyaWJ1dGUgPSBmdW5jdGlvbiBpbnNwZWN0QXR0cmlidXRlKHJlc291cmNlcywgZWxlbWVudE5hbWUsIGF0dHJOYW1lLCBhdHRyVmFsdWUpIHtcbiAgICB2YXIgcGFydHMgPSBhdHRyTmFtZS5zcGxpdCgnLicpO1xuXG4gICAgaW5mby5kZWZhdWx0QmluZGluZ01vZGUgPSBudWxsO1xuXG4gICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgaW5mby5hdHRyTmFtZSA9IHBhcnRzWzBdLnRyaW0oKTtcbiAgICAgIGluZm8uYXR0clZhbHVlID0gYXR0clZhbHVlO1xuICAgICAgaW5mby5jb21tYW5kID0gcGFydHNbMV0udHJpbSgpO1xuXG4gICAgICBpZiAoaW5mby5jb21tYW5kID09PSAncmVmJykge1xuICAgICAgICBpbmZvLmV4cHJlc3Npb24gPSBuZXcgX2F1cmVsaWFCaW5kaW5nLk5hbWVFeHByZXNzaW9uKHRoaXMucGFyc2VyLnBhcnNlKGF0dHJWYWx1ZSksIGluZm8uYXR0ck5hbWUpO1xuICAgICAgICBpbmZvLmNvbW1hbmQgPSBudWxsO1xuICAgICAgICBpbmZvLmF0dHJOYW1lID0gJ3JlZic7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbmZvLmV4cHJlc3Npb24gPSBudWxsO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoYXR0ck5hbWUgPT09ICdyZWYnKSB7XG4gICAgICBpbmZvLmF0dHJOYW1lID0gYXR0ck5hbWU7XG4gICAgICBpbmZvLmF0dHJWYWx1ZSA9IGF0dHJWYWx1ZTtcbiAgICAgIGluZm8uY29tbWFuZCA9IG51bGw7XG4gICAgICBpbmZvLmV4cHJlc3Npb24gPSBuZXcgX2F1cmVsaWFCaW5kaW5nLk5hbWVFeHByZXNzaW9uKHRoaXMucGFyc2VyLnBhcnNlKGF0dHJWYWx1ZSksICdlbGVtZW50Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGluZm8uYXR0ck5hbWUgPSBhdHRyTmFtZTtcbiAgICAgIGluZm8uYXR0clZhbHVlID0gYXR0clZhbHVlO1xuICAgICAgaW5mby5jb21tYW5kID0gbnVsbDtcbiAgICAgIHZhciBpbnRlcnBvbGF0aW9uUGFydHMgPSB0aGlzLnBhcnNlSW50ZXJwb2xhdGlvbihyZXNvdXJjZXMsIGF0dHJWYWx1ZSk7XG4gICAgICBpZiAoaW50ZXJwb2xhdGlvblBhcnRzID09PSBudWxsKSB7XG4gICAgICAgIGluZm8uZXhwcmVzc2lvbiA9IG51bGw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbmZvLmV4cHJlc3Npb24gPSBuZXcgSW50ZXJwb2xhdGlvbkJpbmRpbmdFeHByZXNzaW9uKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCB0aGlzLmF0dHJpYnV0ZU1hcC5tYXAoZWxlbWVudE5hbWUsIGF0dHJOYW1lKSwgaW50ZXJwb2xhdGlvblBhcnRzLCBfYXVyZWxpYUJpbmRpbmcuYmluZGluZ01vZGUub25lV2F5LCByZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zLCBhdHRyTmFtZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGluZm87XG4gIH07XG5cbiAgVGVtcGxhdGluZ0JpbmRpbmdMYW5ndWFnZS5wcm90b3R5cGUuY3JlYXRlQXR0cmlidXRlSW5zdHJ1Y3Rpb24gPSBmdW5jdGlvbiBjcmVhdGVBdHRyaWJ1dGVJbnN0cnVjdGlvbihyZXNvdXJjZXMsIGVsZW1lbnQsIHRoZUluZm8sIGV4aXN0aW5nSW5zdHJ1Y3Rpb24sIGNvbnRleHQpIHtcbiAgICB2YXIgaW5zdHJ1Y3Rpb24gPSB2b2lkIDA7XG5cbiAgICBpZiAodGhlSW5mby5leHByZXNzaW9uKSB7XG4gICAgICBpZiAodGhlSW5mby5hdHRyTmFtZSA9PT0gJ3JlZicpIHtcbiAgICAgICAgcmV0dXJuIHRoZUluZm8uZXhwcmVzc2lvbjtcbiAgICAgIH1cblxuICAgICAgaW5zdHJ1Y3Rpb24gPSBleGlzdGluZ0luc3RydWN0aW9uIHx8IF9hdXJlbGlhVGVtcGxhdGluZy5CZWhhdmlvckluc3RydWN0aW9uLmF0dHJpYnV0ZSh0aGVJbmZvLmF0dHJOYW1lKTtcbiAgICAgIGluc3RydWN0aW9uLmF0dHJpYnV0ZXNbdGhlSW5mby5hdHRyTmFtZV0gPSB0aGVJbmZvLmV4cHJlc3Npb247XG4gICAgfSBlbHNlIGlmICh0aGVJbmZvLmNvbW1hbmQpIHtcbiAgICAgIGluc3RydWN0aW9uID0gdGhpcy5zeW50YXhJbnRlcnByZXRlci5pbnRlcnByZXQocmVzb3VyY2VzLCBlbGVtZW50LCB0aGVJbmZvLCBleGlzdGluZ0luc3RydWN0aW9uLCBjb250ZXh0KTtcbiAgICB9XG5cbiAgICByZXR1cm4gaW5zdHJ1Y3Rpb247XG4gIH07XG5cbiAgVGVtcGxhdGluZ0JpbmRpbmdMYW5ndWFnZS5wcm90b3R5cGUuaW5zcGVjdFRleHRDb250ZW50ID0gZnVuY3Rpb24gaW5zcGVjdFRleHRDb250ZW50KHJlc291cmNlcywgdmFsdWUpIHtcbiAgICB2YXIgcGFydHMgPSB0aGlzLnBhcnNlSW50ZXJwb2xhdGlvbihyZXNvdXJjZXMsIHZhbHVlKTtcbiAgICBpZiAocGFydHMgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IEludGVycG9sYXRpb25CaW5kaW5nRXhwcmVzc2lvbih0aGlzLm9ic2VydmVyTG9jYXRvciwgJ3RleHRDb250ZW50JywgcGFydHMsIF9hdXJlbGlhQmluZGluZy5iaW5kaW5nTW9kZS5vbmVXYXksIHJlc291cmNlcy5sb29rdXBGdW5jdGlvbnMsICd0ZXh0Q29udGVudCcpO1xuICB9O1xuXG4gIFRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2UucHJvdG90eXBlLnBhcnNlSW50ZXJwb2xhdGlvbiA9IGZ1bmN0aW9uIHBhcnNlSW50ZXJwb2xhdGlvbihyZXNvdXJjZXMsIHZhbHVlKSB7XG4gICAgdmFyIGkgPSB2YWx1ZS5pbmRleE9mKCckeycsIDApO1xuICAgIHZhciBpaSA9IHZhbHVlLmxlbmd0aDtcbiAgICB2YXIgY2hhciA9IHZvaWQgMDtcbiAgICB2YXIgcG9zID0gMDtcbiAgICB2YXIgb3BlbiA9IDA7XG4gICAgdmFyIHF1b3RlID0gbnVsbDtcbiAgICB2YXIgaW50ZXJwb2xhdGlvblN0YXJ0ID0gdm9pZCAwO1xuICAgIHZhciBwYXJ0cyA9IHZvaWQgMDtcbiAgICB2YXIgcGFydEluZGV4ID0gMDtcblxuICAgIHdoaWxlIChpID49IDAgJiYgaSA8IGlpIC0gMikge1xuICAgICAgb3BlbiA9IDE7XG4gICAgICBpbnRlcnBvbGF0aW9uU3RhcnQgPSBpO1xuICAgICAgaSArPSAyO1xuXG4gICAgICBkbyB7XG4gICAgICAgIGNoYXIgPSB2YWx1ZVtpXTtcbiAgICAgICAgaSsrO1xuXG4gICAgICAgIGlmIChjaGFyID09PSBcIidcIiB8fCBjaGFyID09PSAnXCInKSB7XG4gICAgICAgICAgaWYgKHF1b3RlID09PSBudWxsKSB7XG4gICAgICAgICAgICBxdW90ZSA9IGNoYXI7XG4gICAgICAgICAgfSBlbHNlIGlmIChxdW90ZSA9PT0gY2hhcikge1xuICAgICAgICAgICAgcXVvdGUgPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjaGFyID09PSAnXFxcXCcpIHtcbiAgICAgICAgICBpKys7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocXVvdGUgIT09IG51bGwpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjaGFyID09PSAneycpIHtcbiAgICAgICAgICBvcGVuKys7XG4gICAgICAgIH0gZWxzZSBpZiAoY2hhciA9PT0gJ30nKSB7XG4gICAgICAgICAgb3Blbi0tO1xuICAgICAgICB9XG4gICAgICB9IHdoaWxlIChvcGVuID4gMCAmJiBpIDwgaWkpO1xuXG4gICAgICBpZiAob3BlbiA9PT0gMCkge1xuICAgICAgICBwYXJ0cyA9IHBhcnRzIHx8IFtdO1xuICAgICAgICBpZiAodmFsdWVbaW50ZXJwb2xhdGlvblN0YXJ0IC0gMV0gPT09ICdcXFxcJyAmJiB2YWx1ZVtpbnRlcnBvbGF0aW9uU3RhcnQgLSAyXSAhPT0gJ1xcXFwnKSB7XG4gICAgICAgICAgcGFydHNbcGFydEluZGV4XSA9IHZhbHVlLnN1YnN0cmluZyhwb3MsIGludGVycG9sYXRpb25TdGFydCAtIDEpICsgdmFsdWUuc3Vic3RyaW5nKGludGVycG9sYXRpb25TdGFydCwgaSk7XG4gICAgICAgICAgcGFydEluZGV4Kys7XG4gICAgICAgICAgcGFydHNbcGFydEluZGV4XSA9IHRoaXMuZW1wdHlTdHJpbmdFeHByZXNzaW9uO1xuICAgICAgICAgIHBhcnRJbmRleCsrO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHBhcnRzW3BhcnRJbmRleF0gPSB2YWx1ZS5zdWJzdHJpbmcocG9zLCBpbnRlcnBvbGF0aW9uU3RhcnQpO1xuICAgICAgICAgIHBhcnRJbmRleCsrO1xuICAgICAgICAgIHBhcnRzW3BhcnRJbmRleF0gPSB0aGlzLnBhcnNlci5wYXJzZSh2YWx1ZS5zdWJzdHJpbmcoaW50ZXJwb2xhdGlvblN0YXJ0ICsgMiwgaSAtIDEpKTtcbiAgICAgICAgICBwYXJ0SW5kZXgrKztcbiAgICAgICAgfVxuICAgICAgICBwb3MgPSBpO1xuICAgICAgICBpID0gdmFsdWUuaW5kZXhPZignJHsnLCBpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChwYXJ0SW5kZXggPT09IDApIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHBhcnRzW3BhcnRJbmRleF0gPSB2YWx1ZS5zdWJzdHIocG9zKTtcbiAgICByZXR1cm4gcGFydHM7XG4gIH07XG5cbiAgcmV0dXJuIFRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2U7XG59KF9hdXJlbGlhVGVtcGxhdGluZy5CaW5kaW5nTGFuZ3VhZ2UpLCBfY2xhc3M0LmluamVjdCA9IFtfYXVyZWxpYUJpbmRpbmcuUGFyc2VyLCBfYXVyZWxpYUJpbmRpbmcuT2JzZXJ2ZXJMb2NhdG9yLCBTeW50YXhJbnRlcnByZXRlciwgQXR0cmlidXRlTWFwXSwgX3RlbXAzKTtcbmZ1bmN0aW9uIGNvbmZpZ3VyZShjb25maWcpIHtcbiAgY29uZmlnLmNvbnRhaW5lci5yZWdpc3RlclNpbmdsZXRvbihfYXVyZWxpYVRlbXBsYXRpbmcuQmluZGluZ0xhbmd1YWdlLCBUZW1wbGF0aW5nQmluZGluZ0xhbmd1YWdlKTtcbiAgY29uZmlnLmNvbnRhaW5lci5yZWdpc3RlckFsaWFzKF9hdXJlbGlhVGVtcGxhdGluZy5CaW5kaW5nTGFuZ3VhZ2UsIFRlbXBsYXRpbmdCaW5kaW5nTGFuZ3VhZ2UpO1xufVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1iaW5kaW5nL2Rpc3QvY29tbW9uanMvYXVyZWxpYS10ZW1wbGF0aW5nLWJpbmRpbmcuanNcbiAqKiBtb2R1bGUgaWQgPSAzNVxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy52aWV3c1JlcXVpcmVMaWZlY3ljbGUgPSBleHBvcnRzLnVud3JhcEV4cHJlc3Npb24gPSBleHBvcnRzLnVwZGF0ZU9uZVRpbWVCaW5kaW5nID0gZXhwb3J0cy5pc09uZVRpbWUgPSBleHBvcnRzLmdldEl0ZW1zU291cmNlRXhwcmVzc2lvbiA9IGV4cG9ydHMudXBkYXRlT3ZlcnJpZGVDb250ZXh0ID0gZXhwb3J0cy5jcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0ID0gZXhwb3J0cy5OdW1iZXJSZXBlYXRTdHJhdGVneSA9IGV4cG9ydHMuU2V0UmVwZWF0U3RyYXRlZ3kgPSBleHBvcnRzLk1hcFJlcGVhdFN0cmF0ZWd5ID0gZXhwb3J0cy5BcnJheVJlcGVhdFN0cmF0ZWd5ID0gZXhwb3J0cy5OdWxsUmVwZWF0U3RyYXRlZ3kgPSBleHBvcnRzLlJlcGVhdFN0cmF0ZWd5TG9jYXRvciA9IGV4cG9ydHMuQWJzdHJhY3RSZXBlYXRlciA9IGV4cG9ydHMuVXBkYXRlVHJpZ2dlckJpbmRpbmdCZWhhdmlvciA9IGV4cG9ydHMuQmluZGluZ1NpZ25hbGVyID0gZXhwb3J0cy5TaWduYWxCaW5kaW5nQmVoYXZpb3IgPSBleHBvcnRzLkRlYm91bmNlQmluZGluZ0JlaGF2aW9yID0gZXhwb3J0cy5UaHJvdHRsZUJpbmRpbmdCZWhhdmlvciA9IGV4cG9ydHMuVHdvV2F5QmluZGluZ0JlaGF2aW9yID0gZXhwb3J0cy5PbmVXYXlCaW5kaW5nQmVoYXZpb3IgPSBleHBvcnRzLk9uZVRpbWVCaW5kaW5nQmVoYXZpb3IgPSBleHBvcnRzLmNvbmZpZ3VyZSA9IGV4cG9ydHMuVmlld1NweSA9IGV4cG9ydHMuQ29tcGlsZVNweSA9IGV4cG9ydHMuRm9jdXMgPSBleHBvcnRzLlJlcGxhY2VhYmxlID0gZXhwb3J0cy5TYW5pdGl6ZUhUTUxWYWx1ZUNvbnZlcnRlciA9IGV4cG9ydHMuSFRNTFNhbml0aXplciA9IGV4cG9ydHMuSGlkZSA9IGV4cG9ydHMuU2hvdyA9IGV4cG9ydHMuUmVwZWF0ID0gZXhwb3J0cy5XaXRoID0gZXhwb3J0cy5JZiA9IGV4cG9ydHMuQ29tcG9zZSA9IHVuZGVmaW5lZDtcblxudmFyIF9jb21wb3NlID0gcmVxdWlyZSgnLi9jb21wb3NlJyk7XG5cbnZhciBfaWYgPSByZXF1aXJlKCcuL2lmJyk7XG5cbnZhciBfd2l0aCA9IHJlcXVpcmUoJy4vd2l0aCcpO1xuXG52YXIgX3JlcGVhdCA9IHJlcXVpcmUoJy4vcmVwZWF0Jyk7XG5cbnZhciBfc2hvdyA9IHJlcXVpcmUoJy4vc2hvdycpO1xuXG52YXIgX2hpZGUgPSByZXF1aXJlKCcuL2hpZGUnKTtcblxudmFyIF9zYW5pdGl6ZUh0bWwgPSByZXF1aXJlKCcuL3Nhbml0aXplLWh0bWwnKTtcblxudmFyIF9yZXBsYWNlYWJsZSA9IHJlcXVpcmUoJy4vcmVwbGFjZWFibGUnKTtcblxudmFyIF9mb2N1cyA9IHJlcXVpcmUoJy4vZm9jdXMnKTtcblxudmFyIF9jb21waWxlU3B5ID0gcmVxdWlyZSgnLi9jb21waWxlLXNweScpO1xuXG52YXIgX3ZpZXdTcHkgPSByZXF1aXJlKCcuL3ZpZXctc3B5Jyk7XG5cbnZhciBfYXVyZWxpYVRlbXBsYXRpbmcgPSByZXF1aXJlKCdhdXJlbGlhLXRlbXBsYXRpbmcnKTtcblxudmFyIF9jc3NSZXNvdXJjZSA9IHJlcXVpcmUoJy4vY3NzLXJlc291cmNlJyk7XG5cbnZhciBfYXVyZWxpYVBhbCA9IHJlcXVpcmUoJ2F1cmVsaWEtcGFsJyk7XG5cbnZhciBfaHRtbFNhbml0aXplciA9IHJlcXVpcmUoJy4vaHRtbC1zYW5pdGl6ZXInKTtcblxudmFyIF9iaW5kaW5nTW9kZUJlaGF2aW9ycyA9IHJlcXVpcmUoJy4vYmluZGluZy1tb2RlLWJlaGF2aW9ycycpO1xuXG52YXIgX3Rocm90dGxlQmluZGluZ0JlaGF2aW9yID0gcmVxdWlyZSgnLi90aHJvdHRsZS1iaW5kaW5nLWJlaGF2aW9yJyk7XG5cbnZhciBfZGVib3VuY2VCaW5kaW5nQmVoYXZpb3IgPSByZXF1aXJlKCcuL2RlYm91bmNlLWJpbmRpbmctYmVoYXZpb3InKTtcblxudmFyIF9zaWduYWxCaW5kaW5nQmVoYXZpb3IgPSByZXF1aXJlKCcuL3NpZ25hbC1iaW5kaW5nLWJlaGF2aW9yJyk7XG5cbnZhciBfYmluZGluZ1NpZ25hbGVyID0gcmVxdWlyZSgnLi9iaW5kaW5nLXNpZ25hbGVyJyk7XG5cbnZhciBfdXBkYXRlVHJpZ2dlckJpbmRpbmdCZWhhdmlvciA9IHJlcXVpcmUoJy4vdXBkYXRlLXRyaWdnZXItYmluZGluZy1iZWhhdmlvcicpO1xuXG52YXIgX2Fic3RyYWN0UmVwZWF0ZXIgPSByZXF1aXJlKCcuL2Fic3RyYWN0LXJlcGVhdGVyJyk7XG5cbnZhciBfcmVwZWF0U3RyYXRlZ3lMb2NhdG9yID0gcmVxdWlyZSgnLi9yZXBlYXQtc3RyYXRlZ3ktbG9jYXRvcicpO1xuXG52YXIgX2h0bWxSZXNvdXJjZVBsdWdpbiA9IHJlcXVpcmUoJy4vaHRtbC1yZXNvdXJjZS1wbHVnaW4nKTtcblxudmFyIF9udWxsUmVwZWF0U3RyYXRlZ3kgPSByZXF1aXJlKCcuL251bGwtcmVwZWF0LXN0cmF0ZWd5Jyk7XG5cbnZhciBfYXJyYXlSZXBlYXRTdHJhdGVneSA9IHJlcXVpcmUoJy4vYXJyYXktcmVwZWF0LXN0cmF0ZWd5Jyk7XG5cbnZhciBfbWFwUmVwZWF0U3RyYXRlZ3kgPSByZXF1aXJlKCcuL21hcC1yZXBlYXQtc3RyYXRlZ3knKTtcblxudmFyIF9zZXRSZXBlYXRTdHJhdGVneSA9IHJlcXVpcmUoJy4vc2V0LXJlcGVhdC1zdHJhdGVneScpO1xuXG52YXIgX251bWJlclJlcGVhdFN0cmF0ZWd5ID0gcmVxdWlyZSgnLi9udW1iZXItcmVwZWF0LXN0cmF0ZWd5Jyk7XG5cbnZhciBfcmVwZWF0VXRpbGl0aWVzID0gcmVxdWlyZSgnLi9yZXBlYXQtdXRpbGl0aWVzJyk7XG5cbnZhciBfYW5hbHl6ZVZpZXdGYWN0b3J5ID0gcmVxdWlyZSgnLi9hbmFseXplLXZpZXctZmFjdG9yeScpO1xuXG5mdW5jdGlvbiBjb25maWd1cmUoY29uZmlnKSB7XG4gIGlmIChfYXVyZWxpYVBhbC5GRUFUVVJFLnNoYWRvd0RPTSkge1xuICAgIF9hdXJlbGlhUGFsLkRPTS5pbmplY3RTdHlsZXMoJ2JvZHkgL2RlZXAvIC5hdXJlbGlhLWhpZGUgeyBkaXNwbGF5Om5vbmUgIWltcG9ydGFudDsgfScpO1xuICB9IGVsc2Uge1xuICAgIF9hdXJlbGlhUGFsLkRPTS5pbmplY3RTdHlsZXMoJy5hdXJlbGlhLWhpZGUgeyBkaXNwbGF5Om5vbmUgIWltcG9ydGFudDsgfScpO1xuICB9XG5cbiAgY29uZmlnLmdsb2JhbFJlc291cmNlcygnLi9jb21wb3NlJywgJy4vaWYnLCAnLi93aXRoJywgJy4vcmVwZWF0JywgJy4vc2hvdycsICcuL2hpZGUnLCAnLi9yZXBsYWNlYWJsZScsICcuL3Nhbml0aXplLWh0bWwnLCAnLi9mb2N1cycsICcuL2NvbXBpbGUtc3B5JywgJy4vdmlldy1zcHknLCAnLi9iaW5kaW5nLW1vZGUtYmVoYXZpb3JzJywgJy4vdGhyb3R0bGUtYmluZGluZy1iZWhhdmlvcicsICcuL2RlYm91bmNlLWJpbmRpbmctYmVoYXZpb3InLCAnLi9zaWduYWwtYmluZGluZy1iZWhhdmlvcicsICcuL3VwZGF0ZS10cmlnZ2VyLWJpbmRpbmctYmVoYXZpb3InKTtcblxuICAoMCwgX2h0bWxSZXNvdXJjZVBsdWdpbi5jb25maWd1cmUpKGNvbmZpZyk7XG5cbiAgdmFyIHZpZXdFbmdpbmUgPSBjb25maWcuY29udGFpbmVyLmdldChfYXVyZWxpYVRlbXBsYXRpbmcuVmlld0VuZ2luZSk7XG4gIHZpZXdFbmdpbmUuYWRkUmVzb3VyY2VQbHVnaW4oJy5jc3MnLCB7XG4gICAgJ2ZldGNoJzogZnVuY3Rpb24gZmV0Y2goYWRkcmVzcykge1xuICAgICAgdmFyIF9yZWY7XG5cbiAgICAgIHJldHVybiBfcmVmID0ge30sIF9yZWZbYWRkcmVzc10gPSAoMCwgX2Nzc1Jlc291cmNlLl9jcmVhdGVDU1NSZXNvdXJjZSkoYWRkcmVzcyksIF9yZWY7XG4gICAgfVxuICB9KTtcbn1cblxuZXhwb3J0cy5Db21wb3NlID0gX2NvbXBvc2UuQ29tcG9zZTtcbmV4cG9ydHMuSWYgPSBfaWYuSWY7XG5leHBvcnRzLldpdGggPSBfd2l0aC5XaXRoO1xuZXhwb3J0cy5SZXBlYXQgPSBfcmVwZWF0LlJlcGVhdDtcbmV4cG9ydHMuU2hvdyA9IF9zaG93LlNob3c7XG5leHBvcnRzLkhpZGUgPSBfaGlkZS5IaWRlO1xuZXhwb3J0cy5IVE1MU2FuaXRpemVyID0gX2h0bWxTYW5pdGl6ZXIuSFRNTFNhbml0aXplcjtcbmV4cG9ydHMuU2FuaXRpemVIVE1MVmFsdWVDb252ZXJ0ZXIgPSBfc2FuaXRpemVIdG1sLlNhbml0aXplSFRNTFZhbHVlQ29udmVydGVyO1xuZXhwb3J0cy5SZXBsYWNlYWJsZSA9IF9yZXBsYWNlYWJsZS5SZXBsYWNlYWJsZTtcbmV4cG9ydHMuRm9jdXMgPSBfZm9jdXMuRm9jdXM7XG5leHBvcnRzLkNvbXBpbGVTcHkgPSBfY29tcGlsZVNweS5Db21waWxlU3B5O1xuZXhwb3J0cy5WaWV3U3B5ID0gX3ZpZXdTcHkuVmlld1NweTtcbmV4cG9ydHMuY29uZmlndXJlID0gY29uZmlndXJlO1xuZXhwb3J0cy5PbmVUaW1lQmluZGluZ0JlaGF2aW9yID0gX2JpbmRpbmdNb2RlQmVoYXZpb3JzLk9uZVRpbWVCaW5kaW5nQmVoYXZpb3I7XG5leHBvcnRzLk9uZVdheUJpbmRpbmdCZWhhdmlvciA9IF9iaW5kaW5nTW9kZUJlaGF2aW9ycy5PbmVXYXlCaW5kaW5nQmVoYXZpb3I7XG5leHBvcnRzLlR3b1dheUJpbmRpbmdCZWhhdmlvciA9IF9iaW5kaW5nTW9kZUJlaGF2aW9ycy5Ud29XYXlCaW5kaW5nQmVoYXZpb3I7XG5leHBvcnRzLlRocm90dGxlQmluZGluZ0JlaGF2aW9yID0gX3Rocm90dGxlQmluZGluZ0JlaGF2aW9yLlRocm90dGxlQmluZGluZ0JlaGF2aW9yO1xuZXhwb3J0cy5EZWJvdW5jZUJpbmRpbmdCZWhhdmlvciA9IF9kZWJvdW5jZUJpbmRpbmdCZWhhdmlvci5EZWJvdW5jZUJpbmRpbmdCZWhhdmlvcjtcbmV4cG9ydHMuU2lnbmFsQmluZGluZ0JlaGF2aW9yID0gX3NpZ25hbEJpbmRpbmdCZWhhdmlvci5TaWduYWxCaW5kaW5nQmVoYXZpb3I7XG5leHBvcnRzLkJpbmRpbmdTaWduYWxlciA9IF9iaW5kaW5nU2lnbmFsZXIuQmluZGluZ1NpZ25hbGVyO1xuZXhwb3J0cy5VcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yID0gX3VwZGF0ZVRyaWdnZXJCaW5kaW5nQmVoYXZpb3IuVXBkYXRlVHJpZ2dlckJpbmRpbmdCZWhhdmlvcjtcbmV4cG9ydHMuQWJzdHJhY3RSZXBlYXRlciA9IF9hYnN0cmFjdFJlcGVhdGVyLkFic3RyYWN0UmVwZWF0ZXI7XG5leHBvcnRzLlJlcGVhdFN0cmF0ZWd5TG9jYXRvciA9IF9yZXBlYXRTdHJhdGVneUxvY2F0b3IuUmVwZWF0U3RyYXRlZ3lMb2NhdG9yO1xuZXhwb3J0cy5OdWxsUmVwZWF0U3RyYXRlZ3kgPSBfbnVsbFJlcGVhdFN0cmF0ZWd5Lk51bGxSZXBlYXRTdHJhdGVneTtcbmV4cG9ydHMuQXJyYXlSZXBlYXRTdHJhdGVneSA9IF9hcnJheVJlcGVhdFN0cmF0ZWd5LkFycmF5UmVwZWF0U3RyYXRlZ3k7XG5leHBvcnRzLk1hcFJlcGVhdFN0cmF0ZWd5ID0gX21hcFJlcGVhdFN0cmF0ZWd5Lk1hcFJlcGVhdFN0cmF0ZWd5O1xuZXhwb3J0cy5TZXRSZXBlYXRTdHJhdGVneSA9IF9zZXRSZXBlYXRTdHJhdGVneS5TZXRSZXBlYXRTdHJhdGVneTtcbmV4cG9ydHMuTnVtYmVyUmVwZWF0U3RyYXRlZ3kgPSBfbnVtYmVyUmVwZWF0U3RyYXRlZ3kuTnVtYmVyUmVwZWF0U3RyYXRlZ3k7XG5leHBvcnRzLmNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQgPSBfcmVwZWF0VXRpbGl0aWVzLmNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQ7XG5leHBvcnRzLnVwZGF0ZU92ZXJyaWRlQ29udGV4dCA9IF9yZXBlYXRVdGlsaXRpZXMudXBkYXRlT3ZlcnJpZGVDb250ZXh0O1xuZXhwb3J0cy5nZXRJdGVtc1NvdXJjZUV4cHJlc3Npb24gPSBfcmVwZWF0VXRpbGl0aWVzLmdldEl0ZW1zU291cmNlRXhwcmVzc2lvbjtcbmV4cG9ydHMuaXNPbmVUaW1lID0gX3JlcGVhdFV0aWxpdGllcy5pc09uZVRpbWU7XG5leHBvcnRzLnVwZGF0ZU9uZVRpbWVCaW5kaW5nID0gX3JlcGVhdFV0aWxpdGllcy51cGRhdGVPbmVUaW1lQmluZGluZztcbmV4cG9ydHMudW53cmFwRXhwcmVzc2lvbiA9IF9yZXBlYXRVdGlsaXRpZXMudW53cmFwRXhwcmVzc2lvbjtcbmV4cG9ydHMudmlld3NSZXF1aXJlTGlmZWN5Y2xlID0gX2FuYWx5emVWaWV3RmFjdG9yeS52aWV3c1JlcXVpcmVMaWZlY3ljbGU7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9kaXN0L2NvbW1vbmpzL2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMuanNcbiAqKiBtb2R1bGUgaWQgPSAzNlxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5Db21wb3NlID0gdW5kZWZpbmVkO1xuXG52YXIgX2RlYywgX2RlYzIsIF9jbGFzcywgX2Rlc2MsIF92YWx1ZSwgX2NsYXNzMiwgX2Rlc2NyaXB0b3IsIF9kZXNjcmlwdG9yMiwgX2Rlc2NyaXB0b3IzO1xuXG52YXIgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uID0gcmVxdWlyZSgnYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbicpO1xuXG52YXIgX2F1cmVsaWFUYXNrUXVldWUgPSByZXF1aXJlKCdhdXJlbGlhLXRhc2stcXVldWUnKTtcblxudmFyIF9hdXJlbGlhVGVtcGxhdGluZyA9IHJlcXVpcmUoJ2F1cmVsaWEtdGVtcGxhdGluZycpO1xuXG52YXIgX2F1cmVsaWFQYWwgPSByZXF1aXJlKCdhdXJlbGlhLXBhbCcpO1xuXG5mdW5jdGlvbiBfaW5pdERlZmluZVByb3AodGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvciwgY29udGV4dCkge1xuICBpZiAoIWRlc2NyaXB0b3IpIHJldHVybjtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgcHJvcGVydHksIHtcbiAgICBlbnVtZXJhYmxlOiBkZXNjcmlwdG9yLmVudW1lcmFibGUsXG4gICAgY29uZmlndXJhYmxlOiBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSxcbiAgICB3cml0YWJsZTogZGVzY3JpcHRvci53cml0YWJsZSxcbiAgICB2YWx1ZTogZGVzY3JpcHRvci5pbml0aWFsaXplciA/IGRlc2NyaXB0b3IuaW5pdGlhbGl6ZXIuY2FsbChjb250ZXh0KSA6IHZvaWQgMFxuICB9KTtcbn1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX2FwcGx5RGVjb3JhdGVkRGVzY3JpcHRvcih0YXJnZXQsIHByb3BlcnR5LCBkZWNvcmF0b3JzLCBkZXNjcmlwdG9yLCBjb250ZXh0KSB7XG4gIHZhciBkZXNjID0ge307XG4gIE9iamVjdFsna2UnICsgJ3lzJ10oZGVzY3JpcHRvcikuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgZGVzY1trZXldID0gZGVzY3JpcHRvcltrZXldO1xuICB9KTtcbiAgZGVzYy5lbnVtZXJhYmxlID0gISFkZXNjLmVudW1lcmFibGU7XG4gIGRlc2MuY29uZmlndXJhYmxlID0gISFkZXNjLmNvbmZpZ3VyYWJsZTtcblxuICBpZiAoJ3ZhbHVlJyBpbiBkZXNjIHx8IGRlc2MuaW5pdGlhbGl6ZXIpIHtcbiAgICBkZXNjLndyaXRhYmxlID0gdHJ1ZTtcbiAgfVxuXG4gIGRlc2MgPSBkZWNvcmF0b3JzLnNsaWNlKCkucmV2ZXJzZSgpLnJlZHVjZShmdW5jdGlvbiAoZGVzYywgZGVjb3JhdG9yKSB7XG4gICAgcmV0dXJuIGRlY29yYXRvcih0YXJnZXQsIHByb3BlcnR5LCBkZXNjKSB8fCBkZXNjO1xuICB9LCBkZXNjKTtcblxuICBpZiAoY29udGV4dCAmJiBkZXNjLmluaXRpYWxpemVyICE9PSB2b2lkIDApIHtcbiAgICBkZXNjLnZhbHVlID0gZGVzYy5pbml0aWFsaXplciA/IGRlc2MuaW5pdGlhbGl6ZXIuY2FsbChjb250ZXh0KSA6IHZvaWQgMDtcbiAgICBkZXNjLmluaXRpYWxpemVyID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgaWYgKGRlc2MuaW5pdGlhbGl6ZXIgPT09IHZvaWQgMCkge1xuICAgIE9iamVjdFsnZGVmaW5lJyArICdQcm9wZXJ0eSddKHRhcmdldCwgcHJvcGVydHksIGRlc2MpO1xuICAgIGRlc2MgPSBudWxsO1xuICB9XG5cbiAgcmV0dXJuIGRlc2M7XG59XG5cbmZ1bmN0aW9uIF9pbml0aWFsaXplcldhcm5pbmdIZWxwZXIoZGVzY3JpcHRvciwgY29udGV4dCkge1xuICB0aHJvdyBuZXcgRXJyb3IoJ0RlY29yYXRpbmcgY2xhc3MgcHJvcGVydHkgZmFpbGVkLiBQbGVhc2UgZW5zdXJlIHRoYXQgdHJhbnNmb3JtLWNsYXNzLXByb3BlcnRpZXMgaXMgZW5hYmxlZC4nKTtcbn1cblxudmFyIENvbXBvc2UgPSBleHBvcnRzLkNvbXBvc2UgPSAoX2RlYyA9ICgwLCBfYXVyZWxpYVRlbXBsYXRpbmcuY3VzdG9tRWxlbWVudCkoJ2NvbXBvc2UnKSwgX2RlYzIgPSAoMCwgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uLmluamVjdCkoX2F1cmVsaWFQYWwuRE9NLkVsZW1lbnQsIF9hdXJlbGlhRGVwZW5kZW5jeUluamVjdGlvbi5Db250YWluZXIsIF9hdXJlbGlhVGVtcGxhdGluZy5Db21wb3NpdGlvbkVuZ2luZSwgX2F1cmVsaWFUZW1wbGF0aW5nLlZpZXdTbG90LCBfYXVyZWxpYVRlbXBsYXRpbmcuVmlld1Jlc291cmNlcywgX2F1cmVsaWFUYXNrUXVldWUuVGFza1F1ZXVlKSwgX2RlYyhfY2xhc3MgPSAoMCwgX2F1cmVsaWFUZW1wbGF0aW5nLm5vVmlldykoX2NsYXNzID0gX2RlYzIoX2NsYXNzID0gKF9jbGFzczIgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIENvbXBvc2UoZWxlbWVudCwgY29udGFpbmVyLCBjb21wb3NpdGlvbkVuZ2luZSwgdmlld1Nsb3QsIHZpZXdSZXNvdXJjZXMsIHRhc2tRdWV1ZSkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb21wb3NlKTtcblxuICAgIF9pbml0RGVmaW5lUHJvcCh0aGlzLCAnbW9kZWwnLCBfZGVzY3JpcHRvciwgdGhpcyk7XG5cbiAgICBfaW5pdERlZmluZVByb3AodGhpcywgJ3ZpZXcnLCBfZGVzY3JpcHRvcjIsIHRoaXMpO1xuXG4gICAgX2luaXREZWZpbmVQcm9wKHRoaXMsICd2aWV3TW9kZWwnLCBfZGVzY3JpcHRvcjMsIHRoaXMpO1xuXG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICB0aGlzLmNvbXBvc2l0aW9uRW5naW5lID0gY29tcG9zaXRpb25FbmdpbmU7XG4gICAgdGhpcy52aWV3U2xvdCA9IHZpZXdTbG90O1xuICAgIHRoaXMudmlld1Jlc291cmNlcyA9IHZpZXdSZXNvdXJjZXM7XG4gICAgdGhpcy50YXNrUXVldWUgPSB0YXNrUXVldWU7XG4gICAgdGhpcy5jdXJyZW50Q29udHJvbGxlciA9IG51bGw7XG4gICAgdGhpcy5jdXJyZW50Vmlld01vZGVsID0gbnVsbDtcbiAgfVxuXG4gIENvbXBvc2UucHJvdG90eXBlLmNyZWF0ZWQgPSBmdW5jdGlvbiBjcmVhdGVkKG93bmluZ1ZpZXcpIHtcbiAgICB0aGlzLm93bmluZ1ZpZXcgPSBvd25pbmdWaWV3O1xuICB9O1xuXG4gIENvbXBvc2UucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiBiaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcbiAgICB0aGlzLmJpbmRpbmdDb250ZXh0ID0gYmluZGluZ0NvbnRleHQ7XG4gICAgdGhpcy5vdmVycmlkZUNvbnRleHQgPSBvdmVycmlkZUNvbnRleHQ7XG4gICAgcHJvY2Vzc0luc3RydWN0aW9uKHRoaXMsIGNyZWF0ZUluc3RydWN0aW9uKHRoaXMsIHtcbiAgICAgIHZpZXc6IHRoaXMudmlldyxcbiAgICAgIHZpZXdNb2RlbDogdGhpcy52aWV3TW9kZWwsXG4gICAgICBtb2RlbDogdGhpcy5tb2RlbFxuICAgIH0pKTtcbiAgfTtcblxuICBDb21wb3NlLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiB1bmJpbmQoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCkge1xuICAgIHRoaXMuYmluZGluZ0NvbnRleHQgPSBudWxsO1xuICAgIHRoaXMub3ZlcnJpZGVDb250ZXh0ID0gbnVsbDtcbiAgICB2YXIgcmV0dXJuVG9DYWNoZSA9IHRydWU7XG4gICAgdmFyIHNraXBBbmltYXRpb24gPSB0cnVlO1xuICAgIHRoaXMudmlld1Nsb3QucmVtb3ZlQWxsKHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pO1xuICB9O1xuXG4gIENvbXBvc2UucHJvdG90eXBlLm1vZGVsQ2hhbmdlZCA9IGZ1bmN0aW9uIG1vZGVsQ2hhbmdlZChuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgaWYgKHRoaXMuY3VycmVudEluc3RydWN0aW9uKSB7XG4gICAgICB0aGlzLmN1cnJlbnRJbnN0cnVjdGlvbi5tb2RlbCA9IG5ld1ZhbHVlO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMudGFza1F1ZXVlLnF1ZXVlTWljcm9UYXNrKGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChfdGhpcy5jdXJyZW50SW5zdHJ1Y3Rpb24pIHtcbiAgICAgICAgX3RoaXMuY3VycmVudEluc3RydWN0aW9uLm1vZGVsID0gbmV3VmFsdWU7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIHZtID0gX3RoaXMuY3VycmVudFZpZXdNb2RlbDtcblxuICAgICAgaWYgKHZtICYmIHR5cGVvZiB2bS5hY3RpdmF0ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB2bS5hY3RpdmF0ZShuZXdWYWx1ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgQ29tcG9zZS5wcm90b3R5cGUudmlld0NoYW5nZWQgPSBmdW5jdGlvbiB2aWV3Q2hhbmdlZChuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgIHZhciBpbnN0cnVjdGlvbiA9IGNyZWF0ZUluc3RydWN0aW9uKHRoaXMsIHtcbiAgICAgIHZpZXc6IG5ld1ZhbHVlLFxuICAgICAgdmlld01vZGVsOiB0aGlzLmN1cnJlbnRWaWV3TW9kZWwgfHwgdGhpcy52aWV3TW9kZWwsXG4gICAgICBtb2RlbDogdGhpcy5tb2RlbFxuICAgIH0pO1xuXG4gICAgaWYgKHRoaXMuY3VycmVudEluc3RydWN0aW9uKSB7XG4gICAgICB0aGlzLmN1cnJlbnRJbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuY3VycmVudEluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb247XG4gICAgdGhpcy50YXNrUXVldWUucXVldWVNaWNyb1Rhc2soZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHByb2Nlc3NJbnN0cnVjdGlvbihfdGhpczIsIF90aGlzMi5jdXJyZW50SW5zdHJ1Y3Rpb24pO1xuICAgIH0pO1xuICB9O1xuXG4gIENvbXBvc2UucHJvdG90eXBlLnZpZXdNb2RlbENoYW5nZWQgPSBmdW5jdGlvbiB2aWV3TW9kZWxDaGFuZ2VkKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgdmFyIGluc3RydWN0aW9uID0gY3JlYXRlSW5zdHJ1Y3Rpb24odGhpcywge1xuICAgICAgdmlld01vZGVsOiBuZXdWYWx1ZSxcbiAgICAgIHZpZXc6IHRoaXMudmlldyxcbiAgICAgIG1vZGVsOiB0aGlzLm1vZGVsXG4gICAgfSk7XG5cbiAgICBpZiAodGhpcy5jdXJyZW50SW5zdHJ1Y3Rpb24pIHtcbiAgICAgIHRoaXMuY3VycmVudEluc3RydWN0aW9uID0gaW5zdHJ1Y3Rpb247XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5jdXJyZW50SW5zdHJ1Y3Rpb24gPSBpbnN0cnVjdGlvbjtcbiAgICB0aGlzLnRhc2tRdWV1ZS5xdWV1ZU1pY3JvVGFzayhmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcHJvY2Vzc0luc3RydWN0aW9uKF90aGlzMywgX3RoaXMzLmN1cnJlbnRJbnN0cnVjdGlvbik7XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIENvbXBvc2U7XG59KCksIChfZGVzY3JpcHRvciA9IF9hcHBseURlY29yYXRlZERlc2NyaXB0b3IoX2NsYXNzMi5wcm90b3R5cGUsICdtb2RlbCcsIFtfYXVyZWxpYVRlbXBsYXRpbmcuYmluZGFibGVdLCB7XG4gIGVudW1lcmFibGU6IHRydWUsXG4gIGluaXRpYWxpemVyOiBudWxsXG59KSwgX2Rlc2NyaXB0b3IyID0gX2FwcGx5RGVjb3JhdGVkRGVzY3JpcHRvcihfY2xhc3MyLnByb3RvdHlwZSwgJ3ZpZXcnLCBbX2F1cmVsaWFUZW1wbGF0aW5nLmJpbmRhYmxlXSwge1xuICBlbnVtZXJhYmxlOiB0cnVlLFxuICBpbml0aWFsaXplcjogbnVsbFxufSksIF9kZXNjcmlwdG9yMyA9IF9hcHBseURlY29yYXRlZERlc2NyaXB0b3IoX2NsYXNzMi5wcm90b3R5cGUsICd2aWV3TW9kZWwnLCBbX2F1cmVsaWFUZW1wbGF0aW5nLmJpbmRhYmxlXSwge1xuICBlbnVtZXJhYmxlOiB0cnVlLFxuICBpbml0aWFsaXplcjogbnVsbFxufSkpLCBfY2xhc3MyKSkgfHwgX2NsYXNzKSB8fCBfY2xhc3MpIHx8IF9jbGFzcyk7XG5cblxuZnVuY3Rpb24gY3JlYXRlSW5zdHJ1Y3Rpb24oY29tcG9zZXIsIGluc3RydWN0aW9uKSB7XG4gIHJldHVybiBPYmplY3QuYXNzaWduKGluc3RydWN0aW9uLCB7XG4gICAgYmluZGluZ0NvbnRleHQ6IGNvbXBvc2VyLmJpbmRpbmdDb250ZXh0LFxuICAgIG92ZXJyaWRlQ29udGV4dDogY29tcG9zZXIub3ZlcnJpZGVDb250ZXh0LFxuICAgIG93bmluZ1ZpZXc6IGNvbXBvc2VyLm93bmluZ1ZpZXcsXG4gICAgY29udGFpbmVyOiBjb21wb3Nlci5jb250YWluZXIsXG4gICAgdmlld1Nsb3Q6IGNvbXBvc2VyLnZpZXdTbG90LFxuICAgIHZpZXdSZXNvdXJjZXM6IGNvbXBvc2VyLnZpZXdSZXNvdXJjZXMsXG4gICAgY3VycmVudENvbnRyb2xsZXI6IGNvbXBvc2VyLmN1cnJlbnRDb250cm9sbGVyLFxuICAgIGhvc3Q6IGNvbXBvc2VyLmVsZW1lbnRcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHByb2Nlc3NJbnN0cnVjdGlvbihjb21wb3NlciwgaW5zdHJ1Y3Rpb24pIHtcbiAgY29tcG9zZXIuY3VycmVudEluc3RydWN0aW9uID0gbnVsbDtcbiAgY29tcG9zZXIuY29tcG9zaXRpb25FbmdpbmUuY29tcG9zZShpbnN0cnVjdGlvbikudGhlbihmdW5jdGlvbiAoY29udHJvbGxlcikge1xuICAgIGNvbXBvc2VyLmN1cnJlbnRDb250cm9sbGVyID0gY29udHJvbGxlcjtcbiAgICBjb21wb3Nlci5jdXJyZW50Vmlld01vZGVsID0gY29udHJvbGxlciA/IGNvbnRyb2xsZXIudmlld01vZGVsIDogbnVsbDtcbiAgfSk7XG59XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9kaXN0L2NvbW1vbmpzL2NvbXBvc2UuanNcbiAqKiBtb2R1bGUgaWQgPSAzN1xuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5JZiA9IHVuZGVmaW5lZDtcblxudmFyIF9kZWMsIF9kZWMyLCBfY2xhc3M7XG5cbnZhciBfYXVyZWxpYVRlbXBsYXRpbmcgPSByZXF1aXJlKCdhdXJlbGlhLXRlbXBsYXRpbmcnKTtcblxudmFyIF9hdXJlbGlhRGVwZW5kZW5jeUluamVjdGlvbiA9IHJlcXVpcmUoJ2F1cmVsaWEtZGVwZW5kZW5jeS1pbmplY3Rpb24nKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIElmID0gZXhwb3J0cy5JZiA9IChfZGVjID0gKDAsIF9hdXJlbGlhVGVtcGxhdGluZy5jdXN0b21BdHRyaWJ1dGUpKCdpZicpLCBfZGVjMiA9ICgwLCBfYXVyZWxpYURlcGVuZGVuY3lJbmplY3Rpb24uaW5qZWN0KShfYXVyZWxpYVRlbXBsYXRpbmcuQm91bmRWaWV3RmFjdG9yeSwgX2F1cmVsaWFUZW1wbGF0aW5nLlZpZXdTbG90KSwgX2RlYyhfY2xhc3MgPSAoMCwgX2F1cmVsaWFUZW1wbGF0aW5nLnRlbXBsYXRlQ29udHJvbGxlcikoX2NsYXNzID0gX2RlYzIoX2NsYXNzID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBJZih2aWV3RmFjdG9yeSwgdmlld1Nsb3QpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSWYpO1xuXG4gICAgdGhpcy52aWV3RmFjdG9yeSA9IHZpZXdGYWN0b3J5O1xuICAgIHRoaXMudmlld1Nsb3QgPSB2aWV3U2xvdDtcbiAgICB0aGlzLnNob3dpbmcgPSBmYWxzZTtcbiAgICB0aGlzLnZpZXcgPSBudWxsO1xuICAgIHRoaXMuYmluZGluZ0NvbnRleHQgPSBudWxsO1xuICAgIHRoaXMub3ZlcnJpZGVDb250ZXh0ID0gbnVsbDtcbiAgfVxuXG4gIElmLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XG4gICAgdGhpcy5iaW5kaW5nQ29udGV4dCA9IGJpbmRpbmdDb250ZXh0O1xuICAgIHRoaXMub3ZlcnJpZGVDb250ZXh0ID0gb3ZlcnJpZGVDb250ZXh0O1xuICAgIHRoaXMudmFsdWVDaGFuZ2VkKHRoaXMudmFsdWUpO1xuICB9O1xuXG4gIElmLnByb3RvdHlwZS52YWx1ZUNoYW5nZWQgPSBmdW5jdGlvbiB2YWx1ZUNoYW5nZWQobmV3VmFsdWUpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgaWYgKHRoaXMuX19xdWV1ZWRDaGFuZ2VzKSB7XG4gICAgICB0aGlzLl9fcXVldWVkQ2hhbmdlcy5wdXNoKG5ld1ZhbHVlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgbWF5YmVQcm9taXNlID0gdGhpcy5fcnVuVmFsdWVDaGFuZ2VkKG5ld1ZhbHVlKTtcbiAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHF1ZXVlZENoYW5nZXMgPSBfdGhpcy5fX3F1ZXVlZENoYW5nZXMgPSBbXTtcblxuICAgICAgICB2YXIgcnVuUXVldWVkQ2hhbmdlcyA9IGZ1bmN0aW9uIHJ1blF1ZXVlZENoYW5nZXMoKSB7XG4gICAgICAgICAgaWYgKCFxdWV1ZWRDaGFuZ2VzLmxlbmd0aCkge1xuICAgICAgICAgICAgX3RoaXMuX19xdWV1ZWRDaGFuZ2VzID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBuZXh0UHJvbWlzZSA9IF90aGlzLl9ydW5WYWx1ZUNoYW5nZWQocXVldWVkQ2hhbmdlcy5zaGlmdCgpKSB8fCBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgICBuZXh0UHJvbWlzZS50aGVuKHJ1blF1ZXVlZENoYW5nZXMpO1xuICAgICAgICB9O1xuXG4gICAgICAgIG1heWJlUHJvbWlzZS50aGVuKHJ1blF1ZXVlZENoYW5nZXMpO1xuICAgICAgfSkoKTtcbiAgICB9XG4gIH07XG5cbiAgSWYucHJvdG90eXBlLl9ydW5WYWx1ZUNoYW5nZWQgPSBmdW5jdGlvbiBfcnVuVmFsdWVDaGFuZ2VkKG5ld1ZhbHVlKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICBpZiAoIW5ld1ZhbHVlKSB7XG4gICAgICB2YXIgdmlld09yUHJvbWlzZSA9IHZvaWQgMDtcbiAgICAgIGlmICh0aGlzLnZpZXcgIT09IG51bGwgJiYgdGhpcy5zaG93aW5nKSB7XG4gICAgICAgIHZpZXdPclByb21pc2UgPSB0aGlzLnZpZXdTbG90LnJlbW92ZSh0aGlzLnZpZXcpO1xuICAgICAgICBpZiAodmlld09yUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICB2aWV3T3JQcm9taXNlLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzMi52aWV3LnVuYmluZCgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMudmlldy51bmJpbmQoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLnNob3dpbmcgPSBmYWxzZTtcbiAgICAgIHJldHVybiB2aWV3T3JQcm9taXNlO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnZpZXcgPT09IG51bGwpIHtcbiAgICAgIHRoaXMudmlldyA9IHRoaXMudmlld0ZhY3RvcnkuY3JlYXRlKCk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLnZpZXcuaXNCb3VuZCkge1xuICAgICAgdGhpcy52aWV3LmJpbmQodGhpcy5iaW5kaW5nQ29udGV4dCwgdGhpcy5vdmVycmlkZUNvbnRleHQpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5zaG93aW5nKSB7XG4gICAgICB0aGlzLnNob3dpbmcgPSB0cnVlO1xuICAgICAgcmV0dXJuIHRoaXMudmlld1Nsb3QuYWRkKHRoaXMudmlldyk7XG4gICAgfVxuICB9O1xuXG4gIElmLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiB1bmJpbmQoKSB7XG4gICAgaWYgKHRoaXMudmlldyA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMudmlldy51bmJpbmQoKTtcblxuICAgIGlmICghdGhpcy52aWV3RmFjdG9yeS5pc0NhY2hpbmcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zaG93aW5nKSB7XG4gICAgICB0aGlzLnNob3dpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMudmlld1Nsb3QucmVtb3ZlKHRoaXMudmlldywgdHJ1ZSwgdHJ1ZSk7XG4gICAgfVxuICAgIHRoaXMudmlldy5yZXR1cm5Ub0NhY2hlKCk7XG4gICAgdGhpcy52aWV3ID0gbnVsbDtcbiAgfTtcblxuICByZXR1cm4gSWY7XG59KCkpIHx8IF9jbGFzcykgfHwgX2NsYXNzKSB8fCBfY2xhc3MpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9pZi5qc1xuICoqIG1vZHVsZSBpZCA9IDM4XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLldpdGggPSB1bmRlZmluZWQ7XG5cbnZhciBfZGVjLCBfZGVjMiwgX2NsYXNzO1xuXG52YXIgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uID0gcmVxdWlyZSgnYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbicpO1xuXG52YXIgX2F1cmVsaWFUZW1wbGF0aW5nID0gcmVxdWlyZSgnYXVyZWxpYS10ZW1wbGF0aW5nJyk7XG5cbnZhciBfYXVyZWxpYUJpbmRpbmcgPSByZXF1aXJlKCdhdXJlbGlhLWJpbmRpbmcnKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIFdpdGggPSBleHBvcnRzLldpdGggPSAoX2RlYyA9ICgwLCBfYXVyZWxpYVRlbXBsYXRpbmcuY3VzdG9tQXR0cmlidXRlKSgnd2l0aCcpLCBfZGVjMiA9ICgwLCBfYXVyZWxpYURlcGVuZGVuY3lJbmplY3Rpb24uaW5qZWN0KShfYXVyZWxpYVRlbXBsYXRpbmcuQm91bmRWaWV3RmFjdG9yeSwgX2F1cmVsaWFUZW1wbGF0aW5nLlZpZXdTbG90KSwgX2RlYyhfY2xhc3MgPSAoMCwgX2F1cmVsaWFUZW1wbGF0aW5nLnRlbXBsYXRlQ29udHJvbGxlcikoX2NsYXNzID0gX2RlYzIoX2NsYXNzID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBXaXRoKHZpZXdGYWN0b3J5LCB2aWV3U2xvdCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBXaXRoKTtcblxuICAgIHRoaXMudmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcbiAgICB0aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XG4gICAgdGhpcy5wYXJlbnRPdmVycmlkZUNvbnRleHQgPSBudWxsO1xuICAgIHRoaXMudmlldyA9IG51bGw7XG4gIH1cblxuICBXaXRoLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XG4gICAgdGhpcy5wYXJlbnRPdmVycmlkZUNvbnRleHQgPSBvdmVycmlkZUNvbnRleHQ7XG4gICAgdGhpcy52YWx1ZUNoYW5nZWQodGhpcy52YWx1ZSk7XG4gIH07XG5cbiAgV2l0aC5wcm90b3R5cGUudmFsdWVDaGFuZ2VkID0gZnVuY3Rpb24gdmFsdWVDaGFuZ2VkKG5ld1ZhbHVlKSB7XG4gICAgdmFyIG92ZXJyaWRlQ29udGV4dCA9ICgwLCBfYXVyZWxpYUJpbmRpbmcuY3JlYXRlT3ZlcnJpZGVDb250ZXh0KShuZXdWYWx1ZSwgdGhpcy5wYXJlbnRPdmVycmlkZUNvbnRleHQpO1xuICAgIGlmICghdGhpcy52aWV3KSB7XG4gICAgICB0aGlzLnZpZXcgPSB0aGlzLnZpZXdGYWN0b3J5LmNyZWF0ZSgpO1xuICAgICAgdGhpcy52aWV3LmJpbmQobmV3VmFsdWUsIG92ZXJyaWRlQ29udGV4dCk7XG4gICAgICB0aGlzLnZpZXdTbG90LmFkZCh0aGlzLnZpZXcpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnZpZXcuYmluZChuZXdWYWx1ZSwgb3ZlcnJpZGVDb250ZXh0KTtcbiAgICB9XG4gIH07XG5cbiAgV2l0aC5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gdW5iaW5kKCkge1xuICAgIHRoaXMucGFyZW50T3ZlcnJpZGVDb250ZXh0ID0gbnVsbDtcblxuICAgIGlmICh0aGlzLnZpZXcpIHtcbiAgICAgIHRoaXMudmlldy51bmJpbmQoKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIFdpdGg7XG59KCkpIHx8IF9jbGFzcykgfHwgX2NsYXNzKSB8fCBfY2xhc3MpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy93aXRoLmpzXG4gKiogbW9kdWxlIGlkID0gMzlcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuUmVwZWF0ID0gdW5kZWZpbmVkO1xuXG52YXIgX2RlYywgX2RlYzIsIF9jbGFzcywgX2Rlc2MsIF92YWx1ZSwgX2NsYXNzMiwgX2Rlc2NyaXB0b3IsIF9kZXNjcmlwdG9yMiwgX2Rlc2NyaXB0b3IzLCBfZGVzY3JpcHRvcjQ7XG5cbnZhciBfYXVyZWxpYURlcGVuZGVuY3lJbmplY3Rpb24gPSByZXF1aXJlKCdhdXJlbGlhLWRlcGVuZGVuY3ktaW5qZWN0aW9uJyk7XG5cbnZhciBfYXVyZWxpYUJpbmRpbmcgPSByZXF1aXJlKCdhdXJlbGlhLWJpbmRpbmcnKTtcblxudmFyIF9hdXJlbGlhVGVtcGxhdGluZyA9IHJlcXVpcmUoJ2F1cmVsaWEtdGVtcGxhdGluZycpO1xuXG52YXIgX3JlcGVhdFN0cmF0ZWd5TG9jYXRvciA9IHJlcXVpcmUoJy4vcmVwZWF0LXN0cmF0ZWd5LWxvY2F0b3InKTtcblxudmFyIF9yZXBlYXRVdGlsaXRpZXMgPSByZXF1aXJlKCcuL3JlcGVhdC11dGlsaXRpZXMnKTtcblxudmFyIF9hbmFseXplVmlld0ZhY3RvcnkgPSByZXF1aXJlKCcuL2FuYWx5emUtdmlldy1mYWN0b3J5Jyk7XG5cbnZhciBfYWJzdHJhY3RSZXBlYXRlciA9IHJlcXVpcmUoJy4vYWJzdHJhY3QtcmVwZWF0ZXInKTtcblxuZnVuY3Rpb24gX2luaXREZWZpbmVQcm9wKHRhcmdldCwgcHJvcGVydHksIGRlc2NyaXB0b3IsIGNvbnRleHQpIHtcbiAgaWYgKCFkZXNjcmlwdG9yKSByZXR1cm47XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHByb3BlcnR5LCB7XG4gICAgZW51bWVyYWJsZTogZGVzY3JpcHRvci5lbnVtZXJhYmxlLFxuICAgIGNvbmZpZ3VyYWJsZTogZGVzY3JpcHRvci5jb25maWd1cmFibGUsXG4gICAgd3JpdGFibGU6IGRlc2NyaXB0b3Iud3JpdGFibGUsXG4gICAgdmFsdWU6IGRlc2NyaXB0b3IuaW5pdGlhbGl6ZXIgPyBkZXNjcmlwdG9yLmluaXRpYWxpemVyLmNhbGwoY29udGV4dCkgOiB2b2lkIDBcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuZnVuY3Rpb24gX2FwcGx5RGVjb3JhdGVkRGVzY3JpcHRvcih0YXJnZXQsIHByb3BlcnR5LCBkZWNvcmF0b3JzLCBkZXNjcmlwdG9yLCBjb250ZXh0KSB7XG4gIHZhciBkZXNjID0ge307XG4gIE9iamVjdFsna2UnICsgJ3lzJ10oZGVzY3JpcHRvcikuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgZGVzY1trZXldID0gZGVzY3JpcHRvcltrZXldO1xuICB9KTtcbiAgZGVzYy5lbnVtZXJhYmxlID0gISFkZXNjLmVudW1lcmFibGU7XG4gIGRlc2MuY29uZmlndXJhYmxlID0gISFkZXNjLmNvbmZpZ3VyYWJsZTtcblxuICBpZiAoJ3ZhbHVlJyBpbiBkZXNjIHx8IGRlc2MuaW5pdGlhbGl6ZXIpIHtcbiAgICBkZXNjLndyaXRhYmxlID0gdHJ1ZTtcbiAgfVxuXG4gIGRlc2MgPSBkZWNvcmF0b3JzLnNsaWNlKCkucmV2ZXJzZSgpLnJlZHVjZShmdW5jdGlvbiAoZGVzYywgZGVjb3JhdG9yKSB7XG4gICAgcmV0dXJuIGRlY29yYXRvcih0YXJnZXQsIHByb3BlcnR5LCBkZXNjKSB8fCBkZXNjO1xuICB9LCBkZXNjKTtcblxuICBpZiAoY29udGV4dCAmJiBkZXNjLmluaXRpYWxpemVyICE9PSB2b2lkIDApIHtcbiAgICBkZXNjLnZhbHVlID0gZGVzYy5pbml0aWFsaXplciA/IGRlc2MuaW5pdGlhbGl6ZXIuY2FsbChjb250ZXh0KSA6IHZvaWQgMDtcbiAgICBkZXNjLmluaXRpYWxpemVyID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgaWYgKGRlc2MuaW5pdGlhbGl6ZXIgPT09IHZvaWQgMCkge1xuICAgIE9iamVjdFsnZGVmaW5lJyArICdQcm9wZXJ0eSddKHRhcmdldCwgcHJvcGVydHksIGRlc2MpO1xuICAgIGRlc2MgPSBudWxsO1xuICB9XG5cbiAgcmV0dXJuIGRlc2M7XG59XG5cbmZ1bmN0aW9uIF9pbml0aWFsaXplcldhcm5pbmdIZWxwZXIoZGVzY3JpcHRvciwgY29udGV4dCkge1xuICB0aHJvdyBuZXcgRXJyb3IoJ0RlY29yYXRpbmcgY2xhc3MgcHJvcGVydHkgZmFpbGVkLiBQbGVhc2UgZW5zdXJlIHRoYXQgdHJhbnNmb3JtLWNsYXNzLXByb3BlcnRpZXMgaXMgZW5hYmxlZC4nKTtcbn1cblxudmFyIFJlcGVhdCA9IGV4cG9ydHMuUmVwZWF0ID0gKF9kZWMgPSAoMCwgX2F1cmVsaWFUZW1wbGF0aW5nLmN1c3RvbUF0dHJpYnV0ZSkoJ3JlcGVhdCcpLCBfZGVjMiA9ICgwLCBfYXVyZWxpYURlcGVuZGVuY3lJbmplY3Rpb24uaW5qZWN0KShfYXVyZWxpYVRlbXBsYXRpbmcuQm91bmRWaWV3RmFjdG9yeSwgX2F1cmVsaWFUZW1wbGF0aW5nLlRhcmdldEluc3RydWN0aW9uLCBfYXVyZWxpYVRlbXBsYXRpbmcuVmlld1Nsb3QsIF9hdXJlbGlhVGVtcGxhdGluZy5WaWV3UmVzb3VyY2VzLCBfYXVyZWxpYUJpbmRpbmcuT2JzZXJ2ZXJMb2NhdG9yLCBfcmVwZWF0U3RyYXRlZ3lMb2NhdG9yLlJlcGVhdFN0cmF0ZWd5TG9jYXRvciksIF9kZWMoX2NsYXNzID0gKDAsIF9hdXJlbGlhVGVtcGxhdGluZy50ZW1wbGF0ZUNvbnRyb2xsZXIpKF9jbGFzcyA9IF9kZWMyKF9jbGFzcyA9IChfY2xhc3MyID0gZnVuY3Rpb24gKF9BYnN0cmFjdFJlcGVhdGVyKSB7XG4gIF9pbmhlcml0cyhSZXBlYXQsIF9BYnN0cmFjdFJlcGVhdGVyKTtcblxuICBmdW5jdGlvbiBSZXBlYXQodmlld0ZhY3RvcnksIGluc3RydWN0aW9uLCB2aWV3U2xvdCwgdmlld1Jlc291cmNlcywgb2JzZXJ2ZXJMb2NhdG9yLCBzdHJhdGVneUxvY2F0b3IpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmVwZWF0KTtcblxuICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9BYnN0cmFjdFJlcGVhdGVyLmNhbGwodGhpcywge1xuICAgICAgbG9jYWw6ICdpdGVtJyxcbiAgICAgIHZpZXdzUmVxdWlyZUxpZmVjeWNsZTogKDAsIF9hbmFseXplVmlld0ZhY3Rvcnkudmlld3NSZXF1aXJlTGlmZWN5Y2xlKSh2aWV3RmFjdG9yeSlcbiAgICB9KSk7XG5cbiAgICBfaW5pdERlZmluZVByb3AoX3RoaXMsICdpdGVtcycsIF9kZXNjcmlwdG9yLCBfdGhpcyk7XG5cbiAgICBfaW5pdERlZmluZVByb3AoX3RoaXMsICdsb2NhbCcsIF9kZXNjcmlwdG9yMiwgX3RoaXMpO1xuXG4gICAgX2luaXREZWZpbmVQcm9wKF90aGlzLCAna2V5JywgX2Rlc2NyaXB0b3IzLCBfdGhpcyk7XG5cbiAgICBfaW5pdERlZmluZVByb3AoX3RoaXMsICd2YWx1ZScsIF9kZXNjcmlwdG9yNCwgX3RoaXMpO1xuXG4gICAgX3RoaXMudmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcbiAgICBfdGhpcy5pbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uO1xuICAgIF90aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XG4gICAgX3RoaXMubG9va3VwRnVuY3Rpb25zID0gdmlld1Jlc291cmNlcy5sb29rdXBGdW5jdGlvbnM7XG4gICAgX3RoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xuICAgIF90aGlzLmtleSA9ICdrZXknO1xuICAgIF90aGlzLnZhbHVlID0gJ3ZhbHVlJztcbiAgICBfdGhpcy5zdHJhdGVneUxvY2F0b3IgPSBzdHJhdGVneUxvY2F0b3I7XG4gICAgX3RoaXMuaWdub3JlTXV0YXRpb24gPSBmYWxzZTtcbiAgICBfdGhpcy5zb3VyY2VFeHByZXNzaW9uID0gKDAsIF9yZXBlYXRVdGlsaXRpZXMuZ2V0SXRlbXNTb3VyY2VFeHByZXNzaW9uKShfdGhpcy5pbnN0cnVjdGlvbiwgJ3JlcGVhdC5mb3InKTtcbiAgICBfdGhpcy5pc09uZVRpbWUgPSAoMCwgX3JlcGVhdFV0aWxpdGllcy5pc09uZVRpbWUpKF90aGlzLnNvdXJjZUV4cHJlc3Npb24pO1xuICAgIF90aGlzLnZpZXdzUmVxdWlyZUxpZmVjeWNsZSA9ICgwLCBfYW5hbHl6ZVZpZXdGYWN0b3J5LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSkodmlld0ZhY3RvcnkpO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIFJlcGVhdC5wcm90b3R5cGUuY2FsbCA9IGZ1bmN0aW9uIGNhbGwoY29udGV4dCwgY2hhbmdlcykge1xuICAgIHRoaXNbY29udGV4dF0odGhpcy5pdGVtcywgY2hhbmdlcyk7XG4gIH07XG5cbiAgUmVwZWF0LnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XG4gICAgdGhpcy5zY29wZSA9IHsgYmluZGluZ0NvbnRleHQ6IGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQ6IG92ZXJyaWRlQ29udGV4dCB9O1xuICAgIHRoaXMubWF0Y2hlckJpbmRpbmcgPSB0aGlzLl9jYXB0dXJlQW5kUmVtb3ZlTWF0Y2hlckJpbmRpbmcoKTtcbiAgICB0aGlzLml0ZW1zQ2hhbmdlZCgpO1xuICB9O1xuXG4gIFJlcGVhdC5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gdW5iaW5kKCkge1xuICAgIHRoaXMuc2NvcGUgPSBudWxsO1xuICAgIHRoaXMuaXRlbXMgPSBudWxsO1xuICAgIHRoaXMubWF0Y2hlckJpbmRpbmcgPSBudWxsO1xuICAgIHRoaXMudmlld1Nsb3QucmVtb3ZlQWxsKHRydWUpO1xuICAgIHRoaXMuX3Vuc3Vic2NyaWJlQ29sbGVjdGlvbigpO1xuICB9O1xuXG4gIFJlcGVhdC5wcm90b3R5cGUuX3Vuc3Vic2NyaWJlQ29sbGVjdGlvbiA9IGZ1bmN0aW9uIF91bnN1YnNjcmliZUNvbGxlY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuY29sbGVjdGlvbk9ic2VydmVyKSB7XG4gICAgICB0aGlzLmNvbGxlY3Rpb25PYnNlcnZlci51bnN1YnNjcmliZSh0aGlzLmNhbGxDb250ZXh0LCB0aGlzKTtcbiAgICAgIHRoaXMuY29sbGVjdGlvbk9ic2VydmVyID0gbnVsbDtcbiAgICAgIHRoaXMuY2FsbENvbnRleHQgPSBudWxsO1xuICAgIH1cbiAgfTtcblxuICBSZXBlYXQucHJvdG90eXBlLml0ZW1zQ2hhbmdlZCA9IGZ1bmN0aW9uIGl0ZW1zQ2hhbmdlZCgpIHtcbiAgICB0aGlzLl91bnN1YnNjcmliZUNvbGxlY3Rpb24oKTtcblxuICAgIGlmICghdGhpcy5zY29wZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgdGhpcy5zdHJhdGVneSA9IHRoaXMuc3RyYXRlZ3lMb2NhdG9yLmdldFN0cmF0ZWd5KGl0ZW1zKTtcbiAgICBpZiAoIXRoaXMuc3RyYXRlZ3kpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVmFsdWUgZm9yIFxcJycgKyB0aGlzLnNvdXJjZUV4cHJlc3Npb24gKyAnXFwnIGlzIG5vbi1yZXBlYXRhYmxlJyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmlzT25lVGltZSAmJiAhdGhpcy5fb2JzZXJ2ZUlubmVyQ29sbGVjdGlvbigpKSB7XG4gICAgICB0aGlzLl9vYnNlcnZlQ29sbGVjdGlvbigpO1xuICAgIH1cbiAgICB0aGlzLnN0cmF0ZWd5Lmluc3RhbmNlQ2hhbmdlZCh0aGlzLCBpdGVtcyk7XG4gIH07XG5cbiAgUmVwZWF0LnByb3RvdHlwZS5fZ2V0SW5uZXJDb2xsZWN0aW9uID0gZnVuY3Rpb24gX2dldElubmVyQ29sbGVjdGlvbigpIHtcbiAgICB2YXIgZXhwcmVzc2lvbiA9ICgwLCBfcmVwZWF0VXRpbGl0aWVzLnVud3JhcEV4cHJlc3Npb24pKHRoaXMuc291cmNlRXhwcmVzc2lvbik7XG4gICAgaWYgKCFleHByZXNzaW9uKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIGV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zY29wZSwgbnVsbCk7XG4gIH07XG5cbiAgUmVwZWF0LnByb3RvdHlwZS5oYW5kbGVDb2xsZWN0aW9uTXV0YXRlZCA9IGZ1bmN0aW9uIGhhbmRsZUNvbGxlY3Rpb25NdXRhdGVkKGNvbGxlY3Rpb24sIGNoYW5nZXMpIHtcbiAgICBpZiAoIXRoaXMuY29sbGVjdGlvbk9ic2VydmVyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuc3RyYXRlZ3kuaW5zdGFuY2VNdXRhdGVkKHRoaXMsIGNvbGxlY3Rpb24sIGNoYW5nZXMpO1xuICB9O1xuXG4gIFJlcGVhdC5wcm90b3R5cGUuaGFuZGxlSW5uZXJDb2xsZWN0aW9uTXV0YXRlZCA9IGZ1bmN0aW9uIGhhbmRsZUlubmVyQ29sbGVjdGlvbk11dGF0ZWQoY29sbGVjdGlvbiwgY2hhbmdlcykge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgaWYgKCF0aGlzLmNvbGxlY3Rpb25PYnNlcnZlcikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlnbm9yZU11dGF0aW9uKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaWdub3JlTXV0YXRpb24gPSB0cnVlO1xuICAgIHZhciBuZXdJdGVtcyA9IHRoaXMuc291cmNlRXhwcmVzc2lvbi5ldmFsdWF0ZSh0aGlzLnNjb3BlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XG4gICAgdGhpcy5vYnNlcnZlckxvY2F0b3IudGFza1F1ZXVlLnF1ZXVlTWljcm9UYXNrKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBfdGhpczIuaWdub3JlTXV0YXRpb24gPSBmYWxzZTtcbiAgICB9KTtcblxuICAgIGlmIChuZXdJdGVtcyA9PT0gdGhpcy5pdGVtcykge1xuICAgICAgdGhpcy5pdGVtc0NoYW5nZWQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5pdGVtcyA9IG5ld0l0ZW1zO1xuICAgIH1cbiAgfTtcblxuICBSZXBlYXQucHJvdG90eXBlLl9vYnNlcnZlSW5uZXJDb2xsZWN0aW9uID0gZnVuY3Rpb24gX29ic2VydmVJbm5lckNvbGxlY3Rpb24oKSB7XG4gICAgdmFyIGl0ZW1zID0gdGhpcy5fZ2V0SW5uZXJDb2xsZWN0aW9uKCk7XG4gICAgdmFyIHN0cmF0ZWd5ID0gdGhpcy5zdHJhdGVneUxvY2F0b3IuZ2V0U3RyYXRlZ3koaXRlbXMpO1xuICAgIGlmICghc3RyYXRlZ3kpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIgPSBzdHJhdGVneS5nZXRDb2xsZWN0aW9uT2JzZXJ2ZXIodGhpcy5vYnNlcnZlckxvY2F0b3IsIGl0ZW1zKTtcbiAgICBpZiAoIXRoaXMuY29sbGVjdGlvbk9ic2VydmVyKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHRoaXMuY2FsbENvbnRleHQgPSAnaGFuZGxlSW5uZXJDb2xsZWN0aW9uTXV0YXRlZCc7XG4gICAgdGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIuc3Vic2NyaWJlKHRoaXMuY2FsbENvbnRleHQsIHRoaXMpO1xuICAgIHJldHVybiB0cnVlO1xuICB9O1xuXG4gIFJlcGVhdC5wcm90b3R5cGUuX29ic2VydmVDb2xsZWN0aW9uID0gZnVuY3Rpb24gX29ic2VydmVDb2xsZWN0aW9uKCkge1xuICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgdGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIgPSB0aGlzLnN0cmF0ZWd5LmdldENvbGxlY3Rpb25PYnNlcnZlcih0aGlzLm9ic2VydmVyTG9jYXRvciwgaXRlbXMpO1xuICAgIGlmICh0aGlzLmNvbGxlY3Rpb25PYnNlcnZlcikge1xuICAgICAgdGhpcy5jYWxsQ29udGV4dCA9ICdoYW5kbGVDb2xsZWN0aW9uTXV0YXRlZCc7XG4gICAgICB0aGlzLmNvbGxlY3Rpb25PYnNlcnZlci5zdWJzY3JpYmUodGhpcy5jYWxsQ29udGV4dCwgdGhpcyk7XG4gICAgfVxuICB9O1xuXG4gIFJlcGVhdC5wcm90b3R5cGUuX2NhcHR1cmVBbmRSZW1vdmVNYXRjaGVyQmluZGluZyA9IGZ1bmN0aW9uIF9jYXB0dXJlQW5kUmVtb3ZlTWF0Y2hlckJpbmRpbmcoKSB7XG4gICAgaWYgKHRoaXMudmlld0ZhY3Rvcnkudmlld0ZhY3RvcnkpIHtcbiAgICAgIHZhciBpbnN0cnVjdGlvbnMgPSB0aGlzLnZpZXdGYWN0b3J5LnZpZXdGYWN0b3J5Lmluc3RydWN0aW9ucztcbiAgICAgIHZhciBpbnN0cnVjdGlvbklkcyA9IE9iamVjdC5rZXlzKGluc3RydWN0aW9ucyk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluc3RydWN0aW9uSWRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBleHByZXNzaW9ucyA9IGluc3RydWN0aW9uc1tpbnN0cnVjdGlvbklkc1tpXV0uZXhwcmVzc2lvbnM7XG4gICAgICAgIGlmIChleHByZXNzaW9ucykge1xuICAgICAgICAgIGZvciAodmFyIGlpID0gMDsgaSA8IGV4cHJlc3Npb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoZXhwcmVzc2lvbnNbaWldLnRhcmdldFByb3BlcnR5ID09PSAnbWF0Y2hlcicpIHtcbiAgICAgICAgICAgICAgdmFyIG1hdGNoZXJCaW5kaW5nID0gZXhwcmVzc2lvbnNbaWldO1xuICAgICAgICAgICAgICBleHByZXNzaW9ucy5zcGxpY2UoaWksIDEpO1xuICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hlckJpbmRpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIFJlcGVhdC5wcm90b3R5cGUudmlld0NvdW50ID0gZnVuY3Rpb24gdmlld0NvdW50KCkge1xuICAgIHJldHVybiB0aGlzLnZpZXdTbG90LmNoaWxkcmVuLmxlbmd0aDtcbiAgfTtcblxuICBSZXBlYXQucHJvdG90eXBlLnZpZXdzID0gZnVuY3Rpb24gdmlld3MoKSB7XG4gICAgcmV0dXJuIHRoaXMudmlld1Nsb3QuY2hpbGRyZW47XG4gIH07XG5cbiAgUmVwZWF0LnByb3RvdHlwZS52aWV3ID0gZnVuY3Rpb24gdmlldyhpbmRleCkge1xuICAgIHJldHVybiB0aGlzLnZpZXdTbG90LmNoaWxkcmVuW2luZGV4XTtcbiAgfTtcblxuICBSZXBlYXQucHJvdG90eXBlLm1hdGNoZXIgPSBmdW5jdGlvbiBtYXRjaGVyKCkge1xuICAgIHJldHVybiB0aGlzLm1hdGNoZXJCaW5kaW5nID8gdGhpcy5tYXRjaGVyQmluZGluZy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc2NvcGUsIHRoaXMubWF0Y2hlckJpbmRpbmcubG9va3VwRnVuY3Rpb25zKSA6IG51bGw7XG4gIH07XG5cbiAgUmVwZWF0LnByb3RvdHlwZS5hZGRWaWV3ID0gZnVuY3Rpb24gYWRkVmlldyhiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XG4gICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdGYWN0b3J5LmNyZWF0ZSgpO1xuICAgIHZpZXcuYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcbiAgICB0aGlzLnZpZXdTbG90LmFkZCh2aWV3KTtcbiAgfTtcblxuICBSZXBlYXQucHJvdG90eXBlLmluc2VydFZpZXcgPSBmdW5jdGlvbiBpbnNlcnRWaWV3KGluZGV4LCBiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XG4gICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdGYWN0b3J5LmNyZWF0ZSgpO1xuICAgIHZpZXcuYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcbiAgICB0aGlzLnZpZXdTbG90Lmluc2VydChpbmRleCwgdmlldyk7XG4gIH07XG5cbiAgUmVwZWF0LnByb3RvdHlwZS5tb3ZlVmlldyA9IGZ1bmN0aW9uIG1vdmVWaWV3KHNvdXJjZUluZGV4LCB0YXJnZXRJbmRleCkge1xuICAgIHRoaXMudmlld1Nsb3QubW92ZShzb3VyY2VJbmRleCwgdGFyZ2V0SW5kZXgpO1xuICB9O1xuXG4gIFJlcGVhdC5wcm90b3R5cGUucmVtb3ZlQWxsVmlld3MgPSBmdW5jdGlvbiByZW1vdmVBbGxWaWV3cyhyZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMudmlld1Nsb3QucmVtb3ZlQWxsKHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pO1xuICB9O1xuXG4gIFJlcGVhdC5wcm90b3R5cGUucmVtb3ZlVmlld3MgPSBmdW5jdGlvbiByZW1vdmVWaWV3cyh2aWV3c1RvUmVtb3ZlLCByZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMudmlld1Nsb3QucmVtb3ZlTWFueSh2aWV3c1RvUmVtb3ZlLCByZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKTtcbiAgfTtcblxuICBSZXBlYXQucHJvdG90eXBlLnJlbW92ZVZpZXcgPSBmdW5jdGlvbiByZW1vdmVWaWV3KGluZGV4LCByZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMudmlld1Nsb3QucmVtb3ZlQXQoaW5kZXgsIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pO1xuICB9O1xuXG4gIFJlcGVhdC5wcm90b3R5cGUudXBkYXRlQmluZGluZ3MgPSBmdW5jdGlvbiB1cGRhdGVCaW5kaW5ncyh2aWV3KSB7XG4gICAgdmFyIGogPSB2aWV3LmJpbmRpbmdzLmxlbmd0aDtcbiAgICB3aGlsZSAoai0tKSB7XG4gICAgICAoMCwgX3JlcGVhdFV0aWxpdGllcy51cGRhdGVPbmVUaW1lQmluZGluZykodmlldy5iaW5kaW5nc1tqXSk7XG4gICAgfVxuICAgIGogPSB2aWV3LmNvbnRyb2xsZXJzLmxlbmd0aDtcbiAgICB3aGlsZSAoai0tKSB7XG4gICAgICB2YXIgayA9IHZpZXcuY29udHJvbGxlcnNbal0uYm91bmRQcm9wZXJ0aWVzLmxlbmd0aDtcbiAgICAgIHdoaWxlIChrLS0pIHtcbiAgICAgICAgdmFyIGJpbmRpbmcgPSB2aWV3LmNvbnRyb2xsZXJzW2pdLmJvdW5kUHJvcGVydGllc1trXS5iaW5kaW5nO1xuICAgICAgICAoMCwgX3JlcGVhdFV0aWxpdGllcy51cGRhdGVPbmVUaW1lQmluZGluZykoYmluZGluZyk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBSZXBlYXQ7XG59KF9hYnN0cmFjdFJlcGVhdGVyLkFic3RyYWN0UmVwZWF0ZXIpLCAoX2Rlc2NyaXB0b3IgPSBfYXBwbHlEZWNvcmF0ZWREZXNjcmlwdG9yKF9jbGFzczIucHJvdG90eXBlLCAnaXRlbXMnLCBbX2F1cmVsaWFUZW1wbGF0aW5nLmJpbmRhYmxlXSwge1xuICBlbnVtZXJhYmxlOiB0cnVlLFxuICBpbml0aWFsaXplcjogbnVsbFxufSksIF9kZXNjcmlwdG9yMiA9IF9hcHBseURlY29yYXRlZERlc2NyaXB0b3IoX2NsYXNzMi5wcm90b3R5cGUsICdsb2NhbCcsIFtfYXVyZWxpYVRlbXBsYXRpbmcuYmluZGFibGVdLCB7XG4gIGVudW1lcmFibGU6IHRydWUsXG4gIGluaXRpYWxpemVyOiBudWxsXG59KSwgX2Rlc2NyaXB0b3IzID0gX2FwcGx5RGVjb3JhdGVkRGVzY3JpcHRvcihfY2xhc3MyLnByb3RvdHlwZSwgJ2tleScsIFtfYXVyZWxpYVRlbXBsYXRpbmcuYmluZGFibGVdLCB7XG4gIGVudW1lcmFibGU6IHRydWUsXG4gIGluaXRpYWxpemVyOiBudWxsXG59KSwgX2Rlc2NyaXB0b3I0ID0gX2FwcGx5RGVjb3JhdGVkRGVzY3JpcHRvcihfY2xhc3MyLnByb3RvdHlwZSwgJ3ZhbHVlJywgW19hdXJlbGlhVGVtcGxhdGluZy5iaW5kYWJsZV0sIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgaW5pdGlhbGl6ZXI6IG51bGxcbn0pKSwgX2NsYXNzMikpIHx8IF9jbGFzcykgfHwgX2NsYXNzKSB8fCBfY2xhc3MpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9yZXBlYXQuanNcbiAqKiBtb2R1bGUgaWQgPSA0MFxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5SZXBlYXRTdHJhdGVneUxvY2F0b3IgPSB1bmRlZmluZWQ7XG5cbnZhciBfbnVsbFJlcGVhdFN0cmF0ZWd5ID0gcmVxdWlyZSgnLi9udWxsLXJlcGVhdC1zdHJhdGVneScpO1xuXG52YXIgX2FycmF5UmVwZWF0U3RyYXRlZ3kgPSByZXF1aXJlKCcuL2FycmF5LXJlcGVhdC1zdHJhdGVneScpO1xuXG52YXIgX21hcFJlcGVhdFN0cmF0ZWd5ID0gcmVxdWlyZSgnLi9tYXAtcmVwZWF0LXN0cmF0ZWd5Jyk7XG5cbnZhciBfc2V0UmVwZWF0U3RyYXRlZ3kgPSByZXF1aXJlKCcuL3NldC1yZXBlYXQtc3RyYXRlZ3knKTtcblxudmFyIF9udW1iZXJSZXBlYXRTdHJhdGVneSA9IHJlcXVpcmUoJy4vbnVtYmVyLXJlcGVhdC1zdHJhdGVneScpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgUmVwZWF0U3RyYXRlZ3lMb2NhdG9yID0gZXhwb3J0cy5SZXBlYXRTdHJhdGVneUxvY2F0b3IgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFJlcGVhdFN0cmF0ZWd5TG9jYXRvcigpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmVwZWF0U3RyYXRlZ3lMb2NhdG9yKTtcblxuICAgIHRoaXMubWF0Y2hlcnMgPSBbXTtcbiAgICB0aGlzLnN0cmF0ZWdpZXMgPSBbXTtcblxuICAgIHRoaXMuYWRkU3RyYXRlZ3koZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICByZXR1cm4gaXRlbXMgPT09IG51bGwgfHwgaXRlbXMgPT09IHVuZGVmaW5lZDtcbiAgICB9LCBuZXcgX251bGxSZXBlYXRTdHJhdGVneS5OdWxsUmVwZWF0U3RyYXRlZ3koKSk7XG4gICAgdGhpcy5hZGRTdHJhdGVneShmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgIHJldHVybiBpdGVtcyBpbnN0YW5jZW9mIEFycmF5O1xuICAgIH0sIG5ldyBfYXJyYXlSZXBlYXRTdHJhdGVneS5BcnJheVJlcGVhdFN0cmF0ZWd5KCkpO1xuICAgIHRoaXMuYWRkU3RyYXRlZ3koZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICByZXR1cm4gaXRlbXMgaW5zdGFuY2VvZiBNYXA7XG4gICAgfSwgbmV3IF9tYXBSZXBlYXRTdHJhdGVneS5NYXBSZXBlYXRTdHJhdGVneSgpKTtcbiAgICB0aGlzLmFkZFN0cmF0ZWd5KGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgcmV0dXJuIGl0ZW1zIGluc3RhbmNlb2YgU2V0O1xuICAgIH0sIG5ldyBfc2V0UmVwZWF0U3RyYXRlZ3kuU2V0UmVwZWF0U3RyYXRlZ3koKSk7XG4gICAgdGhpcy5hZGRTdHJhdGVneShmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgaXRlbXMgPT09ICdudW1iZXInO1xuICAgIH0sIG5ldyBfbnVtYmVyUmVwZWF0U3RyYXRlZ3kuTnVtYmVyUmVwZWF0U3RyYXRlZ3koKSk7XG4gIH1cblxuICBSZXBlYXRTdHJhdGVneUxvY2F0b3IucHJvdG90eXBlLmFkZFN0cmF0ZWd5ID0gZnVuY3Rpb24gYWRkU3RyYXRlZ3kobWF0Y2hlciwgc3RyYXRlZ3kpIHtcbiAgICB0aGlzLm1hdGNoZXJzLnB1c2gobWF0Y2hlcik7XG4gICAgdGhpcy5zdHJhdGVnaWVzLnB1c2goc3RyYXRlZ3kpO1xuICB9O1xuXG4gIFJlcGVhdFN0cmF0ZWd5TG9jYXRvci5wcm90b3R5cGUuZ2V0U3RyYXRlZ3kgPSBmdW5jdGlvbiBnZXRTdHJhdGVneShpdGVtcykge1xuICAgIHZhciBtYXRjaGVycyA9IHRoaXMubWF0Y2hlcnM7XG5cbiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBtYXRjaGVycy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBpZiAobWF0Y2hlcnNbaV0oaXRlbXMpKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0cmF0ZWdpZXNbaV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH07XG5cbiAgcmV0dXJuIFJlcGVhdFN0cmF0ZWd5TG9jYXRvcjtcbn0oKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvcmVwZWF0LXN0cmF0ZWd5LWxvY2F0b3IuanNcbiAqKiBtb2R1bGUgaWQgPSA0MVxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBOdWxsUmVwZWF0U3RyYXRlZ3kgPSBleHBvcnRzLk51bGxSZXBlYXRTdHJhdGVneSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gTnVsbFJlcGVhdFN0cmF0ZWd5KCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBOdWxsUmVwZWF0U3RyYXRlZ3kpO1xuICB9XG5cbiAgTnVsbFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5pbnN0YW5jZUNoYW5nZWQgPSBmdW5jdGlvbiBpbnN0YW5jZUNoYW5nZWQocmVwZWF0LCBpdGVtcykge1xuICAgIHJlcGVhdC5yZW1vdmVBbGxWaWV3cyh0cnVlKTtcbiAgfTtcblxuICBOdWxsUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmdldENvbGxlY3Rpb25PYnNlcnZlciA9IGZ1bmN0aW9uIGdldENvbGxlY3Rpb25PYnNlcnZlcihvYnNlcnZlckxvY2F0b3IsIGl0ZW1zKSB7fTtcblxuICByZXR1cm4gTnVsbFJlcGVhdFN0cmF0ZWd5O1xufSgpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9udWxsLXJlcGVhdC1zdHJhdGVneS5qc1xuICoqIG1vZHVsZSBpZCA9IDQyXG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLkFycmF5UmVwZWF0U3RyYXRlZ3kgPSB1bmRlZmluZWQ7XG5cbnZhciBfcmVwZWF0VXRpbGl0aWVzID0gcmVxdWlyZSgnLi9yZXBlYXQtdXRpbGl0aWVzJyk7XG5cbnZhciBfYXVyZWxpYUJpbmRpbmcgPSByZXF1aXJlKCdhdXJlbGlhLWJpbmRpbmcnKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIEFycmF5UmVwZWF0U3RyYXRlZ3kgPSBleHBvcnRzLkFycmF5UmVwZWF0U3RyYXRlZ3kgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEFycmF5UmVwZWF0U3RyYXRlZ3koKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFycmF5UmVwZWF0U3RyYXRlZ3kpO1xuICB9XG5cbiAgQXJyYXlSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuZ2V0Q29sbGVjdGlvbk9ic2VydmVyID0gZnVuY3Rpb24gZ2V0Q29sbGVjdGlvbk9ic2VydmVyKG9ic2VydmVyTG9jYXRvciwgaXRlbXMpIHtcbiAgICByZXR1cm4gb2JzZXJ2ZXJMb2NhdG9yLmdldEFycmF5T2JzZXJ2ZXIoaXRlbXMpO1xuICB9O1xuXG4gIEFycmF5UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmluc3RhbmNlQ2hhbmdlZCA9IGZ1bmN0aW9uIGluc3RhbmNlQ2hhbmdlZChyZXBlYXQsIGl0ZW1zKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIHZhciBpdGVtc0xlbmd0aCA9IGl0ZW1zLmxlbmd0aDtcblxuICAgIGlmICghaXRlbXMgfHwgaXRlbXNMZW5ndGggPT09IDApIHtcbiAgICAgIHJlcGVhdC5yZW1vdmVBbGxWaWV3cyh0cnVlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgY2hpbGRyZW4gPSByZXBlYXQudmlld3MoKTtcbiAgICB2YXIgdmlld3NMZW5ndGggPSBjaGlsZHJlbi5sZW5ndGg7XG5cbiAgICBpZiAodmlld3NMZW5ndGggPT09IDApIHtcbiAgICAgIHRoaXMuX3N0YW5kYXJkUHJvY2Vzc0luc3RhbmNlQ2hhbmdlZChyZXBlYXQsIGl0ZW1zKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAocmVwZWF0LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSkge1xuICAgICAgKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNoaWxkcmVuU25hcHNob3QgPSBjaGlsZHJlbi5zbGljZSgwKTtcbiAgICAgICAgdmFyIGl0ZW1OYW1lSW5CaW5kaW5nQ29udGV4dCA9IHJlcGVhdC5sb2NhbDtcbiAgICAgICAgdmFyIG1hdGNoZXIgPSByZXBlYXQubWF0Y2hlcigpO1xuXG4gICAgICAgIHZhciBpdGVtc1ByZXZpb3VzbHlJblZpZXdzID0gW107XG4gICAgICAgIHZhciB2aWV3c1RvUmVtb3ZlID0gW107XG5cbiAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IHZpZXdzTGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgdmFyIHZpZXcgPSBjaGlsZHJlblNuYXBzaG90W2luZGV4XTtcbiAgICAgICAgICB2YXIgb2xkSXRlbSA9IHZpZXcuYmluZGluZ0NvbnRleHRbaXRlbU5hbWVJbkJpbmRpbmdDb250ZXh0XTtcblxuICAgICAgICAgIGlmICgoMCwgX3JlcGVhdFV0aWxpdGllcy5pbmRleE9mKShpdGVtcywgb2xkSXRlbSwgbWF0Y2hlcikgPT09IC0xKSB7XG4gICAgICAgICAgICB2aWV3c1RvUmVtb3ZlLnB1c2godmlldyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGl0ZW1zUHJldmlvdXNseUluVmlld3MucHVzaChvbGRJdGVtKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgdXBkYXRlVmlld3MgPSB2b2lkIDA7XG4gICAgICAgIHZhciByZW1vdmVQcm9taXNlID0gdm9pZCAwO1xuXG4gICAgICAgIGlmIChpdGVtc1ByZXZpb3VzbHlJblZpZXdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICByZW1vdmVQcm9taXNlID0gcmVwZWF0LnJlbW92ZVZpZXdzKHZpZXdzVG9SZW1vdmUsIHRydWUpO1xuICAgICAgICAgIHVwZGF0ZVZpZXdzID0gZnVuY3Rpb24gdXBkYXRlVmlld3MoKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBfaW5kZXggPSAwOyBfaW5kZXggPCBpdGVtc0xlbmd0aDsgX2luZGV4KyspIHtcbiAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtc1tfaW5kZXhdO1xuICAgICAgICAgICAgICB2YXIgaW5kZXhPZlZpZXcgPSAoMCwgX3JlcGVhdFV0aWxpdGllcy5pbmRleE9mKShpdGVtc1ByZXZpb3VzbHlJblZpZXdzLCBpdGVtLCBtYXRjaGVyLCBfaW5kZXgpO1xuICAgICAgICAgICAgICB2YXIgX3ZpZXcgPSB2b2lkIDA7XG5cbiAgICAgICAgICAgICAgaWYgKGluZGV4T2ZWaWV3ID09PSAtMSkge1xuICAgICAgICAgICAgICAgIHZhciBvdmVycmlkZUNvbnRleHQgPSAoMCwgX3JlcGVhdFV0aWxpdGllcy5jcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KShyZXBlYXQsIGl0ZW1zW19pbmRleF0sIF9pbmRleCwgaXRlbXNMZW5ndGgpO1xuICAgICAgICAgICAgICAgIHJlcGVhdC5pbnNlcnRWaWV3KF9pbmRleCwgb3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xuXG4gICAgICAgICAgICAgICAgaXRlbXNQcmV2aW91c2x5SW5WaWV3cy5zcGxpY2UoX2luZGV4LCAwLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluZGV4T2ZWaWV3ID09PSBfaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBfdmlldyA9IGNoaWxkcmVuW2luZGV4T2ZWaWV3XTtcbiAgICAgICAgICAgICAgICBpdGVtc1ByZXZpb3VzbHlJblZpZXdzW2luZGV4T2ZWaWV3XSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBfdmlldyA9IGNoaWxkcmVuW2luZGV4T2ZWaWV3XTtcbiAgICAgICAgICAgICAgICByZXBlYXQubW92ZVZpZXcoaW5kZXhPZlZpZXcsIF9pbmRleCk7XG4gICAgICAgICAgICAgICAgaXRlbXNQcmV2aW91c2x5SW5WaWV3cy5zcGxpY2UoaW5kZXhPZlZpZXcsIDEpO1xuICAgICAgICAgICAgICAgIGl0ZW1zUHJldmlvdXNseUluVmlld3Muc3BsaWNlKF9pbmRleCwgMCwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChfdmlldykge1xuICAgICAgICAgICAgICAgICgwLCBfcmVwZWF0VXRpbGl0aWVzLnVwZGF0ZU92ZXJyaWRlQ29udGV4dCkoX3ZpZXcub3ZlcnJpZGVDb250ZXh0LCBfaW5kZXgsIGl0ZW1zTGVuZ3RoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfdGhpcy5faW5QbGFjZVByb2Nlc3NJdGVtcyhyZXBlYXQsIGl0ZW1zKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlbW92ZVByb21pc2UgPSByZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSk7XG4gICAgICAgICAgdXBkYXRlVmlld3MgPSBmdW5jdGlvbiB1cGRhdGVWaWV3cygpIHtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5fc3RhbmRhcmRQcm9jZXNzSW5zdGFuY2VDaGFuZ2VkKHJlcGVhdCwgaXRlbXMpO1xuICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmVtb3ZlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICByZW1vdmVQcm9taXNlLnRoZW4odXBkYXRlVmlld3MpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHVwZGF0ZVZpZXdzKCk7XG4gICAgICAgIH1cbiAgICAgIH0pKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2luUGxhY2VQcm9jZXNzSXRlbXMocmVwZWF0LCBpdGVtcyk7XG4gICAgfVxuICB9O1xuXG4gIEFycmF5UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLl9zdGFuZGFyZFByb2Nlc3NJbnN0YW5jZUNoYW5nZWQgPSBmdW5jdGlvbiBfc3RhbmRhcmRQcm9jZXNzSW5zdGFuY2VDaGFuZ2VkKHJlcGVhdCwgaXRlbXMpIHtcbiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBpdGVtcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICB2YXIgb3ZlcnJpZGVDb250ZXh0ID0gKDAsIF9yZXBlYXRVdGlsaXRpZXMuY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dCkocmVwZWF0LCBpdGVtc1tpXSwgaSwgaWkpO1xuICAgICAgcmVwZWF0LmFkZFZpZXcob3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xuICAgIH1cbiAgfTtcblxuICBBcnJheVJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5faW5QbGFjZVByb2Nlc3NJdGVtcyA9IGZ1bmN0aW9uIF9pblBsYWNlUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgaXRlbXMpIHtcbiAgICB2YXIgaXRlbXNMZW5ndGggPSBpdGVtcy5sZW5ndGg7XG4gICAgdmFyIHZpZXdzTGVuZ3RoID0gcmVwZWF0LnZpZXdDb3VudCgpO1xuXG4gICAgd2hpbGUgKHZpZXdzTGVuZ3RoID4gaXRlbXNMZW5ndGgpIHtcbiAgICAgIHZpZXdzTGVuZ3RoLS07XG4gICAgICByZXBlYXQucmVtb3ZlVmlldyh2aWV3c0xlbmd0aCwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgdmFyIGxvY2FsID0gcmVwZWF0LmxvY2FsO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2aWV3c0xlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgdmlldyA9IHJlcGVhdC52aWV3KGkpO1xuICAgICAgdmFyIGxhc3QgPSBpID09PSBpdGVtc0xlbmd0aCAtIDE7XG4gICAgICB2YXIgbWlkZGxlID0gaSAhPT0gMCAmJiAhbGFzdDtcblxuICAgICAgaWYgKHZpZXcuYmluZGluZ0NvbnRleHRbbG9jYWxdID09PSBpdGVtc1tpXSAmJiB2aWV3Lm92ZXJyaWRlQ29udGV4dC4kbWlkZGxlID09PSBtaWRkbGUgJiYgdmlldy5vdmVycmlkZUNvbnRleHQuJGxhc3QgPT09IGxhc3QpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIHZpZXcuYmluZGluZ0NvbnRleHRbbG9jYWxdID0gaXRlbXNbaV07XG4gICAgICB2aWV3Lm92ZXJyaWRlQ29udGV4dC4kbWlkZGxlID0gbWlkZGxlO1xuICAgICAgdmlldy5vdmVycmlkZUNvbnRleHQuJGxhc3QgPSBsYXN0O1xuICAgICAgcmVwZWF0LnVwZGF0ZUJpbmRpbmdzKHZpZXcpO1xuICAgIH1cblxuICAgIGZvciAodmFyIF9pID0gdmlld3NMZW5ndGg7IF9pIDwgaXRlbXNMZW5ndGg7IF9pKyspIHtcbiAgICAgIHZhciBvdmVycmlkZUNvbnRleHQgPSAoMCwgX3JlcGVhdFV0aWxpdGllcy5jcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KShyZXBlYXQsIGl0ZW1zW19pXSwgX2ksIGl0ZW1zTGVuZ3RoKTtcbiAgICAgIHJlcGVhdC5hZGRWaWV3KG92ZXJyaWRlQ29udGV4dC5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcbiAgICB9XG4gIH07XG5cbiAgQXJyYXlSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaW5zdGFuY2VNdXRhdGVkID0gZnVuY3Rpb24gaW5zdGFuY2VNdXRhdGVkKHJlcGVhdCwgYXJyYXksIHNwbGljZXMpIHtcbiAgICBpZiAocmVwZWF0LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSkge1xuICAgICAgdGhpcy5fc3RhbmRhcmRQcm9jZXNzSW5zdGFuY2VNdXRhdGVkKHJlcGVhdCwgYXJyYXksIHNwbGljZXMpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl9pblBsYWNlUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgYXJyYXkpO1xuICB9O1xuXG4gIEFycmF5UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLl9zdGFuZGFyZFByb2Nlc3NJbnN0YW5jZU11dGF0ZWQgPSBmdW5jdGlvbiBfc3RhbmRhcmRQcm9jZXNzSW5zdGFuY2VNdXRhdGVkKHJlcGVhdCwgYXJyYXksIHNwbGljZXMpIHtcbiAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgIGlmIChyZXBlYXQuX19xdWV1ZWRTcGxpY2VzKSB7XG4gICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBzcGxpY2VzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgICAgdmFyIF9zcGxpY2VzJGkgPSBzcGxpY2VzW2ldO1xuICAgICAgICB2YXIgaW5kZXggPSBfc3BsaWNlcyRpLmluZGV4O1xuICAgICAgICB2YXIgcmVtb3ZlZCA9IF9zcGxpY2VzJGkucmVtb3ZlZDtcbiAgICAgICAgdmFyIGFkZGVkQ291bnQgPSBfc3BsaWNlcyRpLmFkZGVkQ291bnQ7XG5cbiAgICAgICAgKDAsIF9hdXJlbGlhQmluZGluZy5tZXJnZVNwbGljZSkocmVwZWF0Ll9fcXVldWVkU3BsaWNlcywgaW5kZXgsIHJlbW92ZWQsIGFkZGVkQ291bnQpO1xuICAgICAgfVxuXG4gICAgICByZXBlYXQuX19hcnJheSA9IGFycmF5LnNsaWNlKDApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBtYXliZVByb21pc2UgPSB0aGlzLl9ydW5TcGxpY2VzKHJlcGVhdCwgYXJyYXkuc2xpY2UoMCksIHNwbGljZXMpO1xuICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcXVldWVkU3BsaWNlcyA9IHJlcGVhdC5fX3F1ZXVlZFNwbGljZXMgPSBbXTtcblxuICAgICAgICB2YXIgcnVuUXVldWVkU3BsaWNlcyA9IGZ1bmN0aW9uIHJ1blF1ZXVlZFNwbGljZXMoKSB7XG4gICAgICAgICAgaWYgKCFxdWV1ZWRTcGxpY2VzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmVwZWF0Ll9fcXVldWVkU3BsaWNlcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHJlcGVhdC5fX2FycmF5ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBuZXh0UHJvbWlzZSA9IF90aGlzMi5fcnVuU3BsaWNlcyhyZXBlYXQsIHJlcGVhdC5fX2FycmF5LCBxdWV1ZWRTcGxpY2VzKSB8fCBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgICBxdWV1ZWRTcGxpY2VzID0gcmVwZWF0Ll9fcXVldWVkU3BsaWNlcyA9IFtdO1xuICAgICAgICAgIG5leHRQcm9taXNlLnRoZW4ocnVuUXVldWVkU3BsaWNlcyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgbWF5YmVQcm9taXNlLnRoZW4ocnVuUXVldWVkU3BsaWNlcyk7XG4gICAgICB9KSgpO1xuICAgIH1cbiAgfTtcblxuICBBcnJheVJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5fcnVuU3BsaWNlcyA9IGZ1bmN0aW9uIF9ydW5TcGxpY2VzKHJlcGVhdCwgYXJyYXksIHNwbGljZXMpIHtcbiAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgIHZhciByZW1vdmVEZWx0YSA9IDA7XG4gICAgdmFyIHJtUHJvbWlzZXMgPSBbXTtcblxuICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHNwbGljZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgdmFyIHNwbGljZSA9IHNwbGljZXNbaV07XG4gICAgICB2YXIgcmVtb3ZlZCA9IHNwbGljZS5yZW1vdmVkO1xuXG4gICAgICBmb3IgKHZhciBqID0gMCwgamogPSByZW1vdmVkLmxlbmd0aDsgaiA8IGpqOyArK2opIHtcbiAgICAgICAgdmFyIHZpZXdPclByb21pc2UgPSByZXBlYXQucmVtb3ZlVmlldyhzcGxpY2UuaW5kZXggKyByZW1vdmVEZWx0YSArIHJtUHJvbWlzZXMubGVuZ3RoLCB0cnVlKTtcbiAgICAgICAgaWYgKHZpZXdPclByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgcm1Qcm9taXNlcy5wdXNoKHZpZXdPclByb21pc2UpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZW1vdmVEZWx0YSAtPSBzcGxpY2UuYWRkZWRDb3VudDtcbiAgICB9XG5cbiAgICBpZiAocm1Qcm9taXNlcy5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5hbGwocm1Qcm9taXNlcykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzcGxpY2VJbmRleExvdyA9IF90aGlzMy5faGFuZGxlQWRkZWRTcGxpY2VzKHJlcGVhdCwgYXJyYXksIHNwbGljZXMpO1xuICAgICAgICAoMCwgX3JlcGVhdFV0aWxpdGllcy51cGRhdGVPdmVycmlkZUNvbnRleHRzKShyZXBlYXQudmlld3MoKSwgc3BsaWNlSW5kZXhMb3cpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdmFyIHNwbGljZUluZGV4TG93ID0gdGhpcy5faGFuZGxlQWRkZWRTcGxpY2VzKHJlcGVhdCwgYXJyYXksIHNwbGljZXMpO1xuICAgICgwLCBfcmVwZWF0VXRpbGl0aWVzLnVwZGF0ZU92ZXJyaWRlQ29udGV4dHMpKHJlcGVhdC52aWV3cygpLCBzcGxpY2VJbmRleExvdyk7XG4gIH07XG5cbiAgQXJyYXlSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuX2hhbmRsZUFkZGVkU3BsaWNlcyA9IGZ1bmN0aW9uIF9oYW5kbGVBZGRlZFNwbGljZXMocmVwZWF0LCBhcnJheSwgc3BsaWNlcykge1xuICAgIHZhciBzcGxpY2VJbmRleCA9IHZvaWQgMDtcbiAgICB2YXIgc3BsaWNlSW5kZXhMb3cgPSB2b2lkIDA7XG4gICAgdmFyIGFycmF5TGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHNwbGljZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgdmFyIHNwbGljZSA9IHNwbGljZXNbaV07XG4gICAgICB2YXIgYWRkSW5kZXggPSBzcGxpY2VJbmRleCA9IHNwbGljZS5pbmRleDtcbiAgICAgIHZhciBlbmQgPSBzcGxpY2UuaW5kZXggKyBzcGxpY2UuYWRkZWRDb3VudDtcblxuICAgICAgaWYgKHR5cGVvZiBzcGxpY2VJbmRleExvdyA9PT0gJ3VuZGVmaW5lZCcgfHwgc3BsaWNlSW5kZXhMb3cgPT09IG51bGwgfHwgc3BsaWNlSW5kZXhMb3cgPiBzcGxpY2UuaW5kZXgpIHtcbiAgICAgICAgc3BsaWNlSW5kZXhMb3cgPSBzcGxpY2VJbmRleDtcbiAgICAgIH1cblxuICAgICAgZm9yICg7IGFkZEluZGV4IDwgZW5kOyArK2FkZEluZGV4KSB7XG4gICAgICAgIHZhciBvdmVycmlkZUNvbnRleHQgPSAoMCwgX3JlcGVhdFV0aWxpdGllcy5jcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KShyZXBlYXQsIGFycmF5W2FkZEluZGV4XSwgYWRkSW5kZXgsIGFycmF5TGVuZ3RoKTtcbiAgICAgICAgcmVwZWF0Lmluc2VydFZpZXcoYWRkSW5kZXgsIG92ZXJyaWRlQ29udGV4dC5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc3BsaWNlSW5kZXhMb3c7XG4gIH07XG5cbiAgcmV0dXJuIEFycmF5UmVwZWF0U3RyYXRlZ3k7XG59KCk7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9kaXN0L2NvbW1vbmpzL2FycmF5LXJlcGVhdC1zdHJhdGVneS5qc1xuICoqIG1vZHVsZSBpZCA9IDQzXG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLnVwZGF0ZU92ZXJyaWRlQ29udGV4dHMgPSB1cGRhdGVPdmVycmlkZUNvbnRleHRzO1xuZXhwb3J0cy5jcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dDtcbmV4cG9ydHMudXBkYXRlT3ZlcnJpZGVDb250ZXh0ID0gdXBkYXRlT3ZlcnJpZGVDb250ZXh0O1xuZXhwb3J0cy5nZXRJdGVtc1NvdXJjZUV4cHJlc3Npb24gPSBnZXRJdGVtc1NvdXJjZUV4cHJlc3Npb247XG5leHBvcnRzLnVud3JhcEV4cHJlc3Npb24gPSB1bndyYXBFeHByZXNzaW9uO1xuZXhwb3J0cy5pc09uZVRpbWUgPSBpc09uZVRpbWU7XG5leHBvcnRzLnVwZGF0ZU9uZVRpbWVCaW5kaW5nID0gdXBkYXRlT25lVGltZUJpbmRpbmc7XG5leHBvcnRzLmluZGV4T2YgPSBpbmRleE9mO1xuXG52YXIgX2F1cmVsaWFCaW5kaW5nID0gcmVxdWlyZSgnYXVyZWxpYS1iaW5kaW5nJyk7XG5cbnZhciBvbmVUaW1lID0gX2F1cmVsaWFCaW5kaW5nLmJpbmRpbmdNb2RlLm9uZVRpbWU7XG5cbmZ1bmN0aW9uIHVwZGF0ZU92ZXJyaWRlQ29udGV4dHModmlld3MsIHN0YXJ0SW5kZXgpIHtcbiAgdmFyIGxlbmd0aCA9IHZpZXdzLmxlbmd0aDtcblxuICBpZiAoc3RhcnRJbmRleCA+IDApIHtcbiAgICBzdGFydEluZGV4ID0gc3RhcnRJbmRleCAtIDE7XG4gIH1cblxuICBmb3IgKDsgc3RhcnRJbmRleCA8IGxlbmd0aDsgKytzdGFydEluZGV4KSB7XG4gICAgdXBkYXRlT3ZlcnJpZGVDb250ZXh0KHZpZXdzW3N0YXJ0SW5kZXhdLm92ZXJyaWRlQ29udGV4dCwgc3RhcnRJbmRleCwgbGVuZ3RoKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KHJlcGVhdCwgZGF0YSwgaW5kZXgsIGxlbmd0aCwga2V5KSB7XG4gIHZhciBiaW5kaW5nQ29udGV4dCA9IHt9O1xuICB2YXIgb3ZlcnJpZGVDb250ZXh0ID0gKDAsIF9hdXJlbGlhQmluZGluZy5jcmVhdGVPdmVycmlkZUNvbnRleHQpKGJpbmRpbmdDb250ZXh0LCByZXBlYXQuc2NvcGUub3ZlcnJpZGVDb250ZXh0KTtcblxuICBpZiAodHlwZW9mIGtleSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBiaW5kaW5nQ29udGV4dFtyZXBlYXQua2V5XSA9IGtleTtcbiAgICBiaW5kaW5nQ29udGV4dFtyZXBlYXQudmFsdWVdID0gZGF0YTtcbiAgfSBlbHNlIHtcbiAgICBiaW5kaW5nQ29udGV4dFtyZXBlYXQubG9jYWxdID0gZGF0YTtcbiAgfVxuICB1cGRhdGVPdmVycmlkZUNvbnRleHQob3ZlcnJpZGVDb250ZXh0LCBpbmRleCwgbGVuZ3RoKTtcbiAgcmV0dXJuIG92ZXJyaWRlQ29udGV4dDtcbn1cblxuZnVuY3Rpb24gdXBkYXRlT3ZlcnJpZGVDb250ZXh0KG92ZXJyaWRlQ29udGV4dCwgaW5kZXgsIGxlbmd0aCkge1xuICB2YXIgZmlyc3QgPSBpbmRleCA9PT0gMDtcbiAgdmFyIGxhc3QgPSBpbmRleCA9PT0gbGVuZ3RoIC0gMTtcbiAgdmFyIGV2ZW4gPSBpbmRleCAlIDIgPT09IDA7XG5cbiAgb3ZlcnJpZGVDb250ZXh0LiRpbmRleCA9IGluZGV4O1xuICBvdmVycmlkZUNvbnRleHQuJGZpcnN0ID0gZmlyc3Q7XG4gIG92ZXJyaWRlQ29udGV4dC4kbGFzdCA9IGxhc3Q7XG4gIG92ZXJyaWRlQ29udGV4dC4kbWlkZGxlID0gIShmaXJzdCB8fCBsYXN0KTtcbiAgb3ZlcnJpZGVDb250ZXh0LiRvZGQgPSAhZXZlbjtcbiAgb3ZlcnJpZGVDb250ZXh0LiRldmVuID0gZXZlbjtcbn1cblxuZnVuY3Rpb24gZ2V0SXRlbXNTb3VyY2VFeHByZXNzaW9uKGluc3RydWN0aW9uLCBhdHRyTmFtZSkge1xuICByZXR1cm4gaW5zdHJ1Y3Rpb24uYmVoYXZpb3JJbnN0cnVjdGlvbnMuZmlsdGVyKGZ1bmN0aW9uIChiaSkge1xuICAgIHJldHVybiBiaS5vcmlnaW5hbEF0dHJOYW1lID09PSBhdHRyTmFtZTtcbiAgfSlbMF0uYXR0cmlidXRlcy5pdGVtcy5zb3VyY2VFeHByZXNzaW9uO1xufVxuXG5mdW5jdGlvbiB1bndyYXBFeHByZXNzaW9uKGV4cHJlc3Npb24pIHtcbiAgdmFyIHVud3JhcHBlZCA9IGZhbHNlO1xuICB3aGlsZSAoZXhwcmVzc2lvbiBpbnN0YW5jZW9mIF9hdXJlbGlhQmluZGluZy5CaW5kaW5nQmVoYXZpb3IpIHtcbiAgICBleHByZXNzaW9uID0gZXhwcmVzc2lvbi5leHByZXNzaW9uO1xuICB9XG4gIHdoaWxlIChleHByZXNzaW9uIGluc3RhbmNlb2YgX2F1cmVsaWFCaW5kaW5nLlZhbHVlQ29udmVydGVyKSB7XG4gICAgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb24uZXhwcmVzc2lvbjtcbiAgICB1bndyYXBwZWQgPSB0cnVlO1xuICB9XG4gIHJldHVybiB1bndyYXBwZWQgPyBleHByZXNzaW9uIDogbnVsbDtcbn1cblxuZnVuY3Rpb24gaXNPbmVUaW1lKGV4cHJlc3Npb24pIHtcbiAgd2hpbGUgKGV4cHJlc3Npb24gaW5zdGFuY2VvZiBfYXVyZWxpYUJpbmRpbmcuQmluZGluZ0JlaGF2aW9yKSB7XG4gICAgaWYgKGV4cHJlc3Npb24ubmFtZSA9PT0gJ29uZVRpbWUnKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb24uZXhwcmVzc2lvbjtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZU9uZVRpbWVCaW5kaW5nKGJpbmRpbmcpIHtcbiAgaWYgKGJpbmRpbmcuY2FsbCAmJiBiaW5kaW5nLm1vZGUgPT09IG9uZVRpbWUpIHtcbiAgICBiaW5kaW5nLmNhbGwoX2F1cmVsaWFCaW5kaW5nLnNvdXJjZUNvbnRleHQpO1xuICB9IGVsc2UgaWYgKGJpbmRpbmcudXBkYXRlT25lVGltZUJpbmRpbmdzKSB7XG4gICAgYmluZGluZy51cGRhdGVPbmVUaW1lQmluZGluZ3MoKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBpbmRleE9mKGFycmF5LCBpdGVtLCBtYXRjaGVyLCBzdGFydEluZGV4KSB7XG4gIGlmICghbWF0Y2hlcikge1xuICAgIHJldHVybiBhcnJheS5pbmRleE9mKGl0ZW0pO1xuICB9XG4gIHZhciBsZW5ndGggPSBhcnJheS5sZW5ndGg7XG4gIGZvciAodmFyIGluZGV4ID0gc3RhcnRJbmRleCB8fCAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuICAgIGlmIChtYXRjaGVyKGFycmF5W2luZGV4XSwgaXRlbSkpIHtcbiAgICAgIHJldHVybiBpbmRleDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIC0xO1xufVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9yZXBlYXQtdXRpbGl0aWVzLmpzXG4gKiogbW9kdWxlIGlkID0gNDRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuTWFwUmVwZWF0U3RyYXRlZ3kgPSB1bmRlZmluZWQ7XG5cbnZhciBfcmVwZWF0VXRpbGl0aWVzID0gcmVxdWlyZSgnLi9yZXBlYXQtdXRpbGl0aWVzJyk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBNYXBSZXBlYXRTdHJhdGVneSA9IGV4cG9ydHMuTWFwUmVwZWF0U3RyYXRlZ3kgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIE1hcFJlcGVhdFN0cmF0ZWd5KCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNYXBSZXBlYXRTdHJhdGVneSk7XG4gIH1cblxuICBNYXBSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuZ2V0Q29sbGVjdGlvbk9ic2VydmVyID0gZnVuY3Rpb24gZ2V0Q29sbGVjdGlvbk9ic2VydmVyKG9ic2VydmVyTG9jYXRvciwgaXRlbXMpIHtcbiAgICByZXR1cm4gb2JzZXJ2ZXJMb2NhdG9yLmdldE1hcE9ic2VydmVyKGl0ZW1zKTtcbiAgfTtcblxuICBNYXBSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaW5zdGFuY2VDaGFuZ2VkID0gZnVuY3Rpb24gaW5zdGFuY2VDaGFuZ2VkKHJlcGVhdCwgaXRlbXMpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgdmFyIHJlbW92ZVByb21pc2UgPSByZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSk7XG4gICAgaWYgKHJlbW92ZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICByZW1vdmVQcm9taXNlLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX3RoaXMuX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgaXRlbXMpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgaXRlbXMpO1xuICB9O1xuXG4gIE1hcFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5fc3RhbmRhcmRQcm9jZXNzSXRlbXMgPSBmdW5jdGlvbiBfc3RhbmRhcmRQcm9jZXNzSXRlbXMocmVwZWF0LCBpdGVtcykge1xuICAgIHZhciBpbmRleCA9IDA7XG4gICAgdmFyIG92ZXJyaWRlQ29udGV4dCA9IHZvaWQgMDtcblxuICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcbiAgICAgIG92ZXJyaWRlQ29udGV4dCA9ICgwLCBfcmVwZWF0VXRpbGl0aWVzLmNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQpKHJlcGVhdCwgdmFsdWUsIGluZGV4LCBpdGVtcy5zaXplLCBrZXkpO1xuICAgICAgcmVwZWF0LmFkZFZpZXcob3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xuICAgICAgKytpbmRleDtcbiAgICB9KTtcbiAgfTtcblxuICBNYXBSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaW5zdGFuY2VNdXRhdGVkID0gZnVuY3Rpb24gaW5zdGFuY2VNdXRhdGVkKHJlcGVhdCwgbWFwLCByZWNvcmRzKSB7XG4gICAgdmFyIGtleSA9IHZvaWQgMDtcbiAgICB2YXIgaSA9IHZvaWQgMDtcbiAgICB2YXIgaWkgPSB2b2lkIDA7XG4gICAgdmFyIG92ZXJyaWRlQ29udGV4dCA9IHZvaWQgMDtcbiAgICB2YXIgcmVtb3ZlSW5kZXggPSB2b2lkIDA7XG4gICAgdmFyIHJlY29yZCA9IHZvaWQgMDtcbiAgICB2YXIgcm1Qcm9taXNlcyA9IFtdO1xuICAgIHZhciB2aWV3T3JQcm9taXNlID0gdm9pZCAwO1xuXG4gICAgZm9yIChpID0gMCwgaWkgPSByZWNvcmRzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcbiAgICAgIHJlY29yZCA9IHJlY29yZHNbaV07XG4gICAgICBrZXkgPSByZWNvcmQua2V5O1xuICAgICAgc3dpdGNoIChyZWNvcmQudHlwZSkge1xuICAgICAgICBjYXNlICd1cGRhdGUnOlxuICAgICAgICAgIHJlbW92ZUluZGV4ID0gdGhpcy5fZ2V0Vmlld0luZGV4QnlLZXkocmVwZWF0LCBrZXkpO1xuICAgICAgICAgIHZpZXdPclByb21pc2UgPSByZXBlYXQucmVtb3ZlVmlldyhyZW1vdmVJbmRleCwgdHJ1ZSk7XG4gICAgICAgICAgaWYgKHZpZXdPclByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICBybVByb21pc2VzLnB1c2godmlld09yUHJvbWlzZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIG92ZXJyaWRlQ29udGV4dCA9ICgwLCBfcmVwZWF0VXRpbGl0aWVzLmNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQpKHJlcGVhdCwgbWFwLmdldChrZXkpLCByZW1vdmVJbmRleCwgbWFwLnNpemUsIGtleSk7XG4gICAgICAgICAgcmVwZWF0Lmluc2VydFZpZXcocmVtb3ZlSW5kZXgsIG92ZXJyaWRlQ29udGV4dC5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICBvdmVycmlkZUNvbnRleHQgPSAoMCwgX3JlcGVhdFV0aWxpdGllcy5jcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KShyZXBlYXQsIG1hcC5nZXQoa2V5KSwgbWFwLnNpemUgLSAxLCBtYXAuc2l6ZSwga2V5KTtcbiAgICAgICAgICByZXBlYXQuaW5zZXJ0VmlldyhtYXAuc2l6ZSAtIDEsIG92ZXJyaWRlQ29udGV4dC5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICBpZiAocmVjb3JkLm9sZFZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVtb3ZlSW5kZXggPSB0aGlzLl9nZXRWaWV3SW5kZXhCeUtleShyZXBlYXQsIGtleSk7XG4gICAgICAgICAgdmlld09yUHJvbWlzZSA9IHJlcGVhdC5yZW1vdmVWaWV3KHJlbW92ZUluZGV4LCB0cnVlKTtcbiAgICAgICAgICBpZiAodmlld09yUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIHJtUHJvbWlzZXMucHVzaCh2aWV3T3JQcm9taXNlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2NsZWFyJzpcbiAgICAgICAgICByZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHJtUHJvbWlzZXMubGVuZ3RoID4gMCkge1xuICAgICAgUHJvbWlzZS5hbGwocm1Qcm9taXNlcykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICgwLCBfcmVwZWF0VXRpbGl0aWVzLnVwZGF0ZU92ZXJyaWRlQ29udGV4dHMpKHJlcGVhdC52aWV3cygpLCAwKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAoMCwgX3JlcGVhdFV0aWxpdGllcy51cGRhdGVPdmVycmlkZUNvbnRleHRzKShyZXBlYXQudmlld3MoKSwgMCk7XG4gICAgfVxuICB9O1xuXG4gIE1hcFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5fZ2V0Vmlld0luZGV4QnlLZXkgPSBmdW5jdGlvbiBfZ2V0Vmlld0luZGV4QnlLZXkocmVwZWF0LCBrZXkpIHtcbiAgICB2YXIgaSA9IHZvaWQgMDtcbiAgICB2YXIgaWkgPSB2b2lkIDA7XG4gICAgdmFyIGNoaWxkID0gdm9pZCAwO1xuXG4gICAgZm9yIChpID0gMCwgaWkgPSByZXBlYXQudmlld0NvdW50KCk7IGkgPCBpaTsgKytpKSB7XG4gICAgICBjaGlsZCA9IHJlcGVhdC52aWV3KGkpO1xuICAgICAgaWYgKGNoaWxkLmJpbmRpbmdDb250ZXh0W3JlcGVhdC5rZXldID09PSBrZXkpIHtcbiAgICAgICAgcmV0dXJuIGk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBNYXBSZXBlYXRTdHJhdGVneTtcbn0oKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvbWFwLXJlcGVhdC1zdHJhdGVneS5qc1xuICoqIG1vZHVsZSBpZCA9IDQ1XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLlNldFJlcGVhdFN0cmF0ZWd5ID0gdW5kZWZpbmVkO1xuXG52YXIgX3JlcGVhdFV0aWxpdGllcyA9IHJlcXVpcmUoJy4vcmVwZWF0LXV0aWxpdGllcycpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgU2V0UmVwZWF0U3RyYXRlZ3kgPSBleHBvcnRzLlNldFJlcGVhdFN0cmF0ZWd5ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBTZXRSZXBlYXRTdHJhdGVneSgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2V0UmVwZWF0U3RyYXRlZ3kpO1xuICB9XG5cbiAgU2V0UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmdldENvbGxlY3Rpb25PYnNlcnZlciA9IGZ1bmN0aW9uIGdldENvbGxlY3Rpb25PYnNlcnZlcihvYnNlcnZlckxvY2F0b3IsIGl0ZW1zKSB7XG4gICAgcmV0dXJuIG9ic2VydmVyTG9jYXRvci5nZXRTZXRPYnNlcnZlcihpdGVtcyk7XG4gIH07XG5cbiAgU2V0UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmluc3RhbmNlQ2hhbmdlZCA9IGZ1bmN0aW9uIGluc3RhbmNlQ2hhbmdlZChyZXBlYXQsIGl0ZW1zKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIHZhciByZW1vdmVQcm9taXNlID0gcmVwZWF0LnJlbW92ZUFsbFZpZXdzKHRydWUpO1xuICAgIGlmIChyZW1vdmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgcmVtb3ZlUHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF90aGlzLl9zdGFuZGFyZFByb2Nlc3NJdGVtcyhyZXBlYXQsIGl0ZW1zKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl9zdGFuZGFyZFByb2Nlc3NJdGVtcyhyZXBlYXQsIGl0ZW1zKTtcbiAgfTtcblxuICBTZXRSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zID0gZnVuY3Rpb24gX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgaXRlbXMpIHtcbiAgICB2YXIgaW5kZXggPSAwO1xuICAgIHZhciBvdmVycmlkZUNvbnRleHQgPSB2b2lkIDA7XG5cbiAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgb3ZlcnJpZGVDb250ZXh0ID0gKDAsIF9yZXBlYXRVdGlsaXRpZXMuY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dCkocmVwZWF0LCB2YWx1ZSwgaW5kZXgsIGl0ZW1zLnNpemUpO1xuICAgICAgcmVwZWF0LmFkZFZpZXcob3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xuICAgICAgKytpbmRleDtcbiAgICB9KTtcbiAgfTtcblxuICBTZXRSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaW5zdGFuY2VNdXRhdGVkID0gZnVuY3Rpb24gaW5zdGFuY2VNdXRhdGVkKHJlcGVhdCwgc2V0LCByZWNvcmRzKSB7XG4gICAgdmFyIHZhbHVlID0gdm9pZCAwO1xuICAgIHZhciBpID0gdm9pZCAwO1xuICAgIHZhciBpaSA9IHZvaWQgMDtcbiAgICB2YXIgb3ZlcnJpZGVDb250ZXh0ID0gdm9pZCAwO1xuICAgIHZhciByZW1vdmVJbmRleCA9IHZvaWQgMDtcbiAgICB2YXIgcmVjb3JkID0gdm9pZCAwO1xuICAgIHZhciBybVByb21pc2VzID0gW107XG4gICAgdmFyIHZpZXdPclByb21pc2UgPSB2b2lkIDA7XG5cbiAgICBmb3IgKGkgPSAwLCBpaSA9IHJlY29yZHMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xuICAgICAgcmVjb3JkID0gcmVjb3Jkc1tpXTtcbiAgICAgIHZhbHVlID0gcmVjb3JkLnZhbHVlO1xuICAgICAgc3dpdGNoIChyZWNvcmQudHlwZSkge1xuICAgICAgICBjYXNlICdhZGQnOlxuICAgICAgICAgIG92ZXJyaWRlQ29udGV4dCA9ICgwLCBfcmVwZWF0VXRpbGl0aWVzLmNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQpKHJlcGVhdCwgdmFsdWUsIHNldC5zaXplIC0gMSwgc2V0LnNpemUpO1xuICAgICAgICAgIHJlcGVhdC5pbnNlcnRWaWV3KHNldC5zaXplIC0gMSwgb3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgIHJlbW92ZUluZGV4ID0gdGhpcy5fZ2V0Vmlld0luZGV4QnlWYWx1ZShyZXBlYXQsIHZhbHVlKTtcbiAgICAgICAgICB2aWV3T3JQcm9taXNlID0gcmVwZWF0LnJlbW92ZVZpZXcocmVtb3ZlSW5kZXgsIHRydWUpO1xuICAgICAgICAgIGlmICh2aWV3T3JQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgcm1Qcm9taXNlcy5wdXNoKHZpZXdPclByb21pc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnY2xlYXInOlxuICAgICAgICAgIHJlcGVhdC5yZW1vdmVBbGxWaWV3cyh0cnVlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocm1Qcm9taXNlcy5sZW5ndGggPiAwKSB7XG4gICAgICBQcm9taXNlLmFsbChybVByb21pc2VzKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgKDAsIF9yZXBlYXRVdGlsaXRpZXMudXBkYXRlT3ZlcnJpZGVDb250ZXh0cykocmVwZWF0LnZpZXdzKCksIDApO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICgwLCBfcmVwZWF0VXRpbGl0aWVzLnVwZGF0ZU92ZXJyaWRlQ29udGV4dHMpKHJlcGVhdC52aWV3cygpLCAwKTtcbiAgICB9XG4gIH07XG5cbiAgU2V0UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLl9nZXRWaWV3SW5kZXhCeVZhbHVlID0gZnVuY3Rpb24gX2dldFZpZXdJbmRleEJ5VmFsdWUocmVwZWF0LCB2YWx1ZSkge1xuICAgIHZhciBpID0gdm9pZCAwO1xuICAgIHZhciBpaSA9IHZvaWQgMDtcbiAgICB2YXIgY2hpbGQgPSB2b2lkIDA7XG5cbiAgICBmb3IgKGkgPSAwLCBpaSA9IHJlcGVhdC52aWV3Q291bnQoKTsgaSA8IGlpOyArK2kpIHtcbiAgICAgIGNoaWxkID0gcmVwZWF0LnZpZXcoaSk7XG4gICAgICBpZiAoY2hpbGQuYmluZGluZ0NvbnRleHRbcmVwZWF0LmxvY2FsXSA9PT0gdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBTZXRSZXBlYXRTdHJhdGVneTtcbn0oKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvc2V0LXJlcGVhdC1zdHJhdGVneS5qc1xuICoqIG1vZHVsZSBpZCA9IDQ2XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLk51bWJlclJlcGVhdFN0cmF0ZWd5ID0gdW5kZWZpbmVkO1xuXG52YXIgX3JlcGVhdFV0aWxpdGllcyA9IHJlcXVpcmUoJy4vcmVwZWF0LXV0aWxpdGllcycpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgTnVtYmVyUmVwZWF0U3RyYXRlZ3kgPSBleHBvcnRzLk51bWJlclJlcGVhdFN0cmF0ZWd5ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBOdW1iZXJSZXBlYXRTdHJhdGVneSgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTnVtYmVyUmVwZWF0U3RyYXRlZ3kpO1xuICB9XG5cbiAgTnVtYmVyUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmdldENvbGxlY3Rpb25PYnNlcnZlciA9IGZ1bmN0aW9uIGdldENvbGxlY3Rpb25PYnNlcnZlcigpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfTtcblxuICBOdW1iZXJSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaW5zdGFuY2VDaGFuZ2VkID0gZnVuY3Rpb24gaW5zdGFuY2VDaGFuZ2VkKHJlcGVhdCwgdmFsdWUpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgdmFyIHJlbW92ZVByb21pc2UgPSByZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSk7XG4gICAgaWYgKHJlbW92ZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICByZW1vdmVQcm9taXNlLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX3RoaXMuX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgdmFsdWUpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgdmFsdWUpO1xuICB9O1xuXG4gIE51bWJlclJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5fc3RhbmRhcmRQcm9jZXNzSXRlbXMgPSBmdW5jdGlvbiBfc3RhbmRhcmRQcm9jZXNzSXRlbXMocmVwZWF0LCB2YWx1ZSkge1xuICAgIHZhciBjaGlsZHJlbkxlbmd0aCA9IHJlcGVhdC52aWV3Q291bnQoKTtcbiAgICB2YXIgaSA9IHZvaWQgMDtcbiAgICB2YXIgaWkgPSB2b2lkIDA7XG4gICAgdmFyIG92ZXJyaWRlQ29udGV4dCA9IHZvaWQgMDtcbiAgICB2YXIgdmlld3NUb1JlbW92ZSA9IHZvaWQgMDtcblxuICAgIHZhbHVlID0gTWF0aC5mbG9vcih2YWx1ZSk7XG4gICAgdmlld3NUb1JlbW92ZSA9IGNoaWxkcmVuTGVuZ3RoIC0gdmFsdWU7XG5cbiAgICBpZiAodmlld3NUb1JlbW92ZSA+IDApIHtcbiAgICAgIGlmICh2aWV3c1RvUmVtb3ZlID4gY2hpbGRyZW5MZW5ndGgpIHtcbiAgICAgICAgdmlld3NUb1JlbW92ZSA9IGNoaWxkcmVuTGVuZ3RoO1xuICAgICAgfVxuXG4gICAgICBmb3IgKGkgPSAwLCBpaSA9IHZpZXdzVG9SZW1vdmU7IGkgPCBpaTsgKytpKSB7XG4gICAgICAgIHJlcGVhdC5yZW1vdmVWaWV3KGNoaWxkcmVuTGVuZ3RoIC0gKGkgKyAxKSwgdHJ1ZSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmb3IgKGkgPSBjaGlsZHJlbkxlbmd0aCwgaWkgPSB2YWx1ZTsgaSA8IGlpOyArK2kpIHtcbiAgICAgIG92ZXJyaWRlQ29udGV4dCA9ICgwLCBfcmVwZWF0VXRpbGl0aWVzLmNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQpKHJlcGVhdCwgaSwgaSwgaWkpO1xuICAgICAgcmVwZWF0LmFkZFZpZXcob3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xuICAgIH1cblxuICAgICgwLCBfcmVwZWF0VXRpbGl0aWVzLnVwZGF0ZU92ZXJyaWRlQ29udGV4dHMpKHJlcGVhdC52aWV3cygpLCAwKTtcbiAgfTtcblxuICByZXR1cm4gTnVtYmVyUmVwZWF0U3RyYXRlZ3k7XG59KCk7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9kaXN0L2NvbW1vbmpzL251bWJlci1yZXBlYXQtc3RyYXRlZ3kuanNcbiAqKiBtb2R1bGUgaWQgPSA0N1xuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy52aWV3c1JlcXVpcmVMaWZlY3ljbGUgPSB2aWV3c1JlcXVpcmVMaWZlY3ljbGU7XG52YXIgbGlmZWN5Y2xlT3B0aW9uYWxCZWhhdmlvcnMgPSBleHBvcnRzLmxpZmVjeWNsZU9wdGlvbmFsQmVoYXZpb3JzID0gWydmb2N1cycsICdpZicsICdyZXBlYXQnLCAnc2hvdycsICd3aXRoJ107XG5cbmZ1bmN0aW9uIGJlaGF2aW9yUmVxdWlyZXNMaWZlY3ljbGUoaW5zdHJ1Y3Rpb24pIHtcbiAgdmFyIHQgPSBpbnN0cnVjdGlvbi50eXBlO1xuICB2YXIgbmFtZSA9IHQuZWxlbWVudE5hbWUgIT09IG51bGwgPyB0LmVsZW1lbnROYW1lIDogdC5hdHRyaWJ1dGVOYW1lO1xuICByZXR1cm4gbGlmZWN5Y2xlT3B0aW9uYWxCZWhhdmlvcnMuaW5kZXhPZihuYW1lKSA9PT0gLTEgJiYgKHQuaGFuZGxlc0F0dGFjaGVkIHx8IHQuaGFuZGxlc0JpbmQgfHwgdC5oYW5kbGVzQ3JlYXRlZCB8fCB0LmhhbmRsZXNEZXRhY2hlZCB8fCB0LmhhbmRsZXNVbmJpbmQpIHx8IHQudmlld0ZhY3RvcnkgJiYgdmlld3NSZXF1aXJlTGlmZWN5Y2xlKHQudmlld0ZhY3RvcnkpIHx8IGluc3RydWN0aW9uLnZpZXdGYWN0b3J5ICYmIHZpZXdzUmVxdWlyZUxpZmVjeWNsZShpbnN0cnVjdGlvbi52aWV3RmFjdG9yeSk7XG59XG5cbmZ1bmN0aW9uIHRhcmdldFJlcXVpcmVzTGlmZWN5Y2xlKGluc3RydWN0aW9uKSB7XG4gIHZhciBiZWhhdmlvcnMgPSBpbnN0cnVjdGlvbi5iZWhhdmlvckluc3RydWN0aW9ucztcbiAgaWYgKGJlaGF2aW9ycykge1xuICAgIHZhciBpID0gYmVoYXZpb3JzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICBpZiAoYmVoYXZpb3JSZXF1aXJlc0xpZmVjeWNsZShiZWhhdmlvcnNbaV0pKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBpbnN0cnVjdGlvbi52aWV3RmFjdG9yeSAmJiB2aWV3c1JlcXVpcmVMaWZlY3ljbGUoaW5zdHJ1Y3Rpb24udmlld0ZhY3RvcnkpO1xufVxuXG5mdW5jdGlvbiB2aWV3c1JlcXVpcmVMaWZlY3ljbGUodmlld0ZhY3RvcnkpIHtcbiAgaWYgKCdfdmlld3NSZXF1aXJlTGlmZWN5Y2xlJyBpbiB2aWV3RmFjdG9yeSkge1xuICAgIHJldHVybiB2aWV3RmFjdG9yeS5fdmlld3NSZXF1aXJlTGlmZWN5Y2xlO1xuICB9XG5cbiAgdmlld0ZhY3RvcnkuX3ZpZXdzUmVxdWlyZUxpZmVjeWNsZSA9IGZhbHNlO1xuXG4gIGlmICh2aWV3RmFjdG9yeS52aWV3RmFjdG9yeSkge1xuICAgIHZpZXdGYWN0b3J5Ll92aWV3c1JlcXVpcmVMaWZlY3ljbGUgPSB2aWV3c1JlcXVpcmVMaWZlY3ljbGUodmlld0ZhY3Rvcnkudmlld0ZhY3RvcnkpO1xuICAgIHJldHVybiB2aWV3RmFjdG9yeS5fdmlld3NSZXF1aXJlTGlmZWN5Y2xlO1xuICB9XG5cbiAgaWYgKHZpZXdGYWN0b3J5LnRlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IoJy5hdS1hbmltYXRlJykpIHtcbiAgICB2aWV3RmFjdG9yeS5fdmlld3NSZXF1aXJlTGlmZWN5Y2xlID0gdHJ1ZTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGZvciAodmFyIGlkIGluIHZpZXdGYWN0b3J5Lmluc3RydWN0aW9ucykge1xuICAgIGlmICh0YXJnZXRSZXF1aXJlc0xpZmVjeWNsZSh2aWV3RmFjdG9yeS5pbnN0cnVjdGlvbnNbaWRdKSkge1xuICAgICAgdmlld0ZhY3RvcnkuX3ZpZXdzUmVxdWlyZUxpZmVjeWNsZSA9IHRydWU7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICB2aWV3RmFjdG9yeS5fdmlld3NSZXF1aXJlTGlmZWN5Y2xlID0gZmFsc2U7XG4gIHJldHVybiBmYWxzZTtcbn1cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvYW5hbHl6ZS12aWV3LWZhY3RvcnkuanNcbiAqKiBtb2R1bGUgaWQgPSA0OFxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgQWJzdHJhY3RSZXBlYXRlciA9IGV4cG9ydHMuQWJzdHJhY3RSZXBlYXRlciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQWJzdHJhY3RSZXBlYXRlcihvcHRpb25zKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFic3RyYWN0UmVwZWF0ZXIpO1xuXG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLCB7XG4gICAgICBsb2NhbDogJ2l0ZW1zJyxcbiAgICAgIHZpZXdzUmVxdWlyZUxpZmVjeWNsZTogdHJ1ZVxuICAgIH0sIG9wdGlvbnMpO1xuICB9XG5cbiAgQWJzdHJhY3RSZXBlYXRlci5wcm90b3R5cGUudmlld0NvdW50ID0gZnVuY3Rpb24gdmlld0NvdW50KCkge1xuICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYHZpZXdDb3VudGAnKTtcbiAgfTtcblxuICBBYnN0cmFjdFJlcGVhdGVyLnByb3RvdHlwZS52aWV3cyA9IGZ1bmN0aW9uIHZpZXdzKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYHZpZXdzYCcpO1xuICB9O1xuXG4gIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLnZpZXcgPSBmdW5jdGlvbiB2aWV3KGluZGV4KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgdmlld2AnKTtcbiAgfTtcblxuICBBYnN0cmFjdFJlcGVhdGVyLnByb3RvdHlwZS5tYXRjaGVyID0gZnVuY3Rpb24gbWF0Y2hlcigpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGBtYXRjaGVyYCcpO1xuICB9O1xuXG4gIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLmFkZFZpZXcgPSBmdW5jdGlvbiBhZGRWaWV3KGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGBhZGRWaWV3YCcpO1xuICB9O1xuXG4gIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLmluc2VydFZpZXcgPSBmdW5jdGlvbiBpbnNlcnRWaWV3KGluZGV4LCBiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgaW5zZXJ0Vmlld2AnKTtcbiAgfTtcblxuICBBYnN0cmFjdFJlcGVhdGVyLnByb3RvdHlwZS5tb3ZlVmlldyA9IGZ1bmN0aW9uIG1vdmVWaWV3KHNvdXJjZUluZGV4LCB0YXJnZXRJbmRleCkge1xuICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYG1vdmVWaWV3YCcpO1xuICB9O1xuXG4gIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLnJlbW92ZUFsbFZpZXdzID0gZnVuY3Rpb24gcmVtb3ZlQWxsVmlld3MocmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbikge1xuICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYHJlbW92ZUFsbFZpZXdzYCcpO1xuICB9O1xuXG4gIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLnJlbW92ZVZpZXdzID0gZnVuY3Rpb24gcmVtb3ZlVmlld3Modmlld3NUb1JlbW92ZSwgcmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbikge1xuICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYHJlbW92ZVZpZXdgJyk7XG4gIH07XG5cbiAgQWJzdHJhY3RSZXBlYXRlci5wcm90b3R5cGUucmVtb3ZlVmlldyA9IGZ1bmN0aW9uIHJlbW92ZVZpZXcoaW5kZXgsIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGByZW1vdmVWaWV3YCcpO1xuICB9O1xuXG4gIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLnVwZGF0ZUJpbmRpbmdzID0gZnVuY3Rpb24gdXBkYXRlQmluZGluZ3Modmlldykge1xuICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYHVwZGF0ZUJpbmRpbmdzYCcpO1xuICB9O1xuXG4gIHJldHVybiBBYnN0cmFjdFJlcGVhdGVyO1xufSgpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9hYnN0cmFjdC1yZXBlYXRlci5qc1xuICoqIG1vZHVsZSBpZCA9IDQ5XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLlNob3cgPSB1bmRlZmluZWQ7XG5cbnZhciBfZGVjLCBfZGVjMiwgX2NsYXNzO1xuXG52YXIgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uID0gcmVxdWlyZSgnYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbicpO1xuXG52YXIgX2F1cmVsaWFUZW1wbGF0aW5nID0gcmVxdWlyZSgnYXVyZWxpYS10ZW1wbGF0aW5nJyk7XG5cbnZhciBfYXVyZWxpYVBhbCA9IHJlcXVpcmUoJ2F1cmVsaWEtcGFsJyk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBTaG93ID0gZXhwb3J0cy5TaG93ID0gKF9kZWMgPSAoMCwgX2F1cmVsaWFUZW1wbGF0aW5nLmN1c3RvbUF0dHJpYnV0ZSkoJ3Nob3cnKSwgX2RlYzIgPSAoMCwgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uLmluamVjdCkoX2F1cmVsaWFQYWwuRE9NLkVsZW1lbnQsIF9hdXJlbGlhVGVtcGxhdGluZy5BbmltYXRvciksIF9kZWMoX2NsYXNzID0gX2RlYzIoX2NsYXNzID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBTaG93KGVsZW1lbnQsIGFuaW1hdG9yKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNob3cpO1xuXG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLmFuaW1hdG9yID0gYW5pbWF0b3I7XG4gIH1cblxuICBTaG93LnByb3RvdHlwZS52YWx1ZUNoYW5nZWQgPSBmdW5jdGlvbiB2YWx1ZUNoYW5nZWQobmV3VmFsdWUpIHtcbiAgICBpZiAobmV3VmFsdWUpIHtcbiAgICAgIHRoaXMuYW5pbWF0b3IucmVtb3ZlQ2xhc3ModGhpcy5lbGVtZW50LCAnYXVyZWxpYS1oaWRlJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYW5pbWF0b3IuYWRkQ2xhc3ModGhpcy5lbGVtZW50LCAnYXVyZWxpYS1oaWRlJyk7XG4gICAgfVxuICB9O1xuXG4gIFNob3cucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiBiaW5kKGJpbmRpbmdDb250ZXh0KSB7XG4gICAgdGhpcy52YWx1ZUNoYW5nZWQodGhpcy52YWx1ZSk7XG4gIH07XG5cbiAgcmV0dXJuIFNob3c7XG59KCkpIHx8IF9jbGFzcykgfHwgX2NsYXNzKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvc2hvdy5qc1xuICoqIG1vZHVsZSBpZCA9IDUwXG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLkhpZGUgPSB1bmRlZmluZWQ7XG5cbnZhciBfZGVjLCBfZGVjMiwgX2NsYXNzO1xuXG52YXIgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uID0gcmVxdWlyZSgnYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbicpO1xuXG52YXIgX2F1cmVsaWFUZW1wbGF0aW5nID0gcmVxdWlyZSgnYXVyZWxpYS10ZW1wbGF0aW5nJyk7XG5cbnZhciBfYXVyZWxpYVBhbCA9IHJlcXVpcmUoJ2F1cmVsaWEtcGFsJyk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBIaWRlID0gZXhwb3J0cy5IaWRlID0gKF9kZWMgPSAoMCwgX2F1cmVsaWFUZW1wbGF0aW5nLmN1c3RvbUF0dHJpYnV0ZSkoJ2hpZGUnKSwgX2RlYzIgPSAoMCwgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uLmluamVjdCkoX2F1cmVsaWFQYWwuRE9NLkVsZW1lbnQsIF9hdXJlbGlhVGVtcGxhdGluZy5BbmltYXRvciksIF9kZWMoX2NsYXNzID0gX2RlYzIoX2NsYXNzID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBIaWRlKGVsZW1lbnQsIGFuaW1hdG9yKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEhpZGUpO1xuXG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLmFuaW1hdG9yID0gYW5pbWF0b3I7XG4gIH1cblxuICBIaWRlLnByb3RvdHlwZS52YWx1ZUNoYW5nZWQgPSBmdW5jdGlvbiB2YWx1ZUNoYW5nZWQobmV3VmFsdWUpIHtcbiAgICBpZiAobmV3VmFsdWUpIHtcbiAgICAgIHRoaXMuYW5pbWF0b3IuYWRkQ2xhc3ModGhpcy5lbGVtZW50LCAnYXVyZWxpYS1oaWRlJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYW5pbWF0b3IucmVtb3ZlQ2xhc3ModGhpcy5lbGVtZW50LCAnYXVyZWxpYS1oaWRlJyk7XG4gICAgfVxuICB9O1xuXG4gIEhpZGUucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiBiaW5kKGJpbmRpbmdDb250ZXh0KSB7XG4gICAgdGhpcy52YWx1ZUNoYW5nZWQodGhpcy52YWx1ZSk7XG4gIH07XG5cbiAgcmV0dXJuIEhpZGU7XG59KCkpIHx8IF9jbGFzcykgfHwgX2NsYXNzKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvaGlkZS5qc1xuICoqIG1vZHVsZSBpZCA9IDUxXG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLlNhbml0aXplSFRNTFZhbHVlQ29udmVydGVyID0gdW5kZWZpbmVkO1xuXG52YXIgX2RlYywgX2RlYzIsIF9jbGFzcztcblxudmFyIF9hdXJlbGlhQmluZGluZyA9IHJlcXVpcmUoJ2F1cmVsaWEtYmluZGluZycpO1xuXG52YXIgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uID0gcmVxdWlyZSgnYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbicpO1xuXG52YXIgX2h0bWxTYW5pdGl6ZXIgPSByZXF1aXJlKCcuL2h0bWwtc2FuaXRpemVyJyk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBTYW5pdGl6ZUhUTUxWYWx1ZUNvbnZlcnRlciA9IGV4cG9ydHMuU2FuaXRpemVIVE1MVmFsdWVDb252ZXJ0ZXIgPSAoX2RlYyA9ICgwLCBfYXVyZWxpYUJpbmRpbmcudmFsdWVDb252ZXJ0ZXIpKCdzYW5pdGl6ZUhUTUwnKSwgX2RlYzIgPSAoMCwgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uLmluamVjdCkoX2h0bWxTYW5pdGl6ZXIuSFRNTFNhbml0aXplciksIF9kZWMoX2NsYXNzID0gX2RlYzIoX2NsYXNzID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBTYW5pdGl6ZUhUTUxWYWx1ZUNvbnZlcnRlcihzYW5pdGl6ZXIpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2FuaXRpemVIVE1MVmFsdWVDb252ZXJ0ZXIpO1xuXG4gICAgdGhpcy5zYW5pdGl6ZXIgPSBzYW5pdGl6ZXI7XG4gIH1cblxuICBTYW5pdGl6ZUhUTUxWYWx1ZUNvbnZlcnRlci5wcm90b3R5cGUudG9WaWV3ID0gZnVuY3Rpb24gdG9WaWV3KHVudHJ1c3RlZE1hcmt1cCkge1xuICAgIGlmICh1bnRydXN0ZWRNYXJrdXAgPT09IG51bGwgfHwgdW50cnVzdGVkTWFya3VwID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnNhbml0aXplci5zYW5pdGl6ZSh1bnRydXN0ZWRNYXJrdXApO1xuICB9O1xuXG4gIHJldHVybiBTYW5pdGl6ZUhUTUxWYWx1ZUNvbnZlcnRlcjtcbn0oKSkgfHwgX2NsYXNzKSB8fCBfY2xhc3MpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9zYW5pdGl6ZS1odG1sLmpzXG4gKiogbW9kdWxlIGlkID0gNTJcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIFNDUklQVF9SRUdFWCA9IC88c2NyaXB0XFxiW148XSooPzooPyE8XFwvc2NyaXB0Pik8W148XSopKjxcXC9zY3JpcHQ+L2dpO1xuXG52YXIgSFRNTFNhbml0aXplciA9IGV4cG9ydHMuSFRNTFNhbml0aXplciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gSFRNTFNhbml0aXplcigpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSFRNTFNhbml0aXplcik7XG4gIH1cblxuICBIVE1MU2FuaXRpemVyLnByb3RvdHlwZS5zYW5pdGl6ZSA9IGZ1bmN0aW9uIHNhbml0aXplKGlucHV0KSB7XG4gICAgcmV0dXJuIGlucHV0LnJlcGxhY2UoU0NSSVBUX1JFR0VYLCAnJyk7XG4gIH07XG5cbiAgcmV0dXJuIEhUTUxTYW5pdGl6ZXI7XG59KCk7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9kaXN0L2NvbW1vbmpzL2h0bWwtc2FuaXRpemVyLmpzXG4gKiogbW9kdWxlIGlkID0gNTNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuUmVwbGFjZWFibGUgPSB1bmRlZmluZWQ7XG5cbnZhciBfZGVjLCBfZGVjMiwgX2NsYXNzO1xuXG52YXIgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uID0gcmVxdWlyZSgnYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbicpO1xuXG52YXIgX2F1cmVsaWFUZW1wbGF0aW5nID0gcmVxdWlyZSgnYXVyZWxpYS10ZW1wbGF0aW5nJyk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBSZXBsYWNlYWJsZSA9IGV4cG9ydHMuUmVwbGFjZWFibGUgPSAoX2RlYyA9ICgwLCBfYXVyZWxpYVRlbXBsYXRpbmcuY3VzdG9tQXR0cmlidXRlKSgncmVwbGFjZWFibGUnKSwgX2RlYzIgPSAoMCwgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uLmluamVjdCkoX2F1cmVsaWFUZW1wbGF0aW5nLkJvdW5kVmlld0ZhY3RvcnksIF9hdXJlbGlhVGVtcGxhdGluZy5WaWV3U2xvdCksIF9kZWMoX2NsYXNzID0gKDAsIF9hdXJlbGlhVGVtcGxhdGluZy50ZW1wbGF0ZUNvbnRyb2xsZXIpKF9jbGFzcyA9IF9kZWMyKF9jbGFzcyA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUmVwbGFjZWFibGUodmlld0ZhY3RvcnksIHZpZXdTbG90KSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlcGxhY2VhYmxlKTtcblxuICAgIHRoaXMudmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcbiAgICB0aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XG4gICAgdGhpcy52aWV3ID0gbnVsbDtcbiAgfVxuXG4gIFJlcGxhY2VhYmxlLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XG4gICAgaWYgKHRoaXMudmlldyA9PT0gbnVsbCkge1xuICAgICAgdGhpcy52aWV3ID0gdGhpcy52aWV3RmFjdG9yeS5jcmVhdGUoKTtcbiAgICAgIHRoaXMudmlld1Nsb3QuYWRkKHRoaXMudmlldyk7XG4gICAgfVxuXG4gICAgdGhpcy52aWV3LmJpbmQoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XG4gIH07XG5cbiAgUmVwbGFjZWFibGUucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uIHVuYmluZCgpIHtcbiAgICB0aGlzLnZpZXcudW5iaW5kKCk7XG4gIH07XG5cbiAgcmV0dXJuIFJlcGxhY2VhYmxlO1xufSgpKSB8fCBfY2xhc3MpIHx8IF9jbGFzcykgfHwgX2NsYXNzKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvcmVwbGFjZWFibGUuanNcbiAqKiBtb2R1bGUgaWQgPSA1NFxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5Gb2N1cyA9IHVuZGVmaW5lZDtcblxudmFyIF9kZWMsIF9kZWMyLCBfY2xhc3M7XG5cbnZhciBfYXVyZWxpYVRlbXBsYXRpbmcgPSByZXF1aXJlKCdhdXJlbGlhLXRlbXBsYXRpbmcnKTtcblxudmFyIF9hdXJlbGlhQmluZGluZyA9IHJlcXVpcmUoJ2F1cmVsaWEtYmluZGluZycpO1xuXG52YXIgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uID0gcmVxdWlyZSgnYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbicpO1xuXG52YXIgX2F1cmVsaWFUYXNrUXVldWUgPSByZXF1aXJlKCdhdXJlbGlhLXRhc2stcXVldWUnKTtcblxudmFyIF9hdXJlbGlhUGFsID0gcmVxdWlyZSgnYXVyZWxpYS1wYWwnKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIEZvY3VzID0gZXhwb3J0cy5Gb2N1cyA9IChfZGVjID0gKDAsIF9hdXJlbGlhVGVtcGxhdGluZy5jdXN0b21BdHRyaWJ1dGUpKCdmb2N1cycsIF9hdXJlbGlhQmluZGluZy5iaW5kaW5nTW9kZS50d29XYXkpLCBfZGVjMiA9ICgwLCBfYXVyZWxpYURlcGVuZGVuY3lJbmplY3Rpb24uaW5qZWN0KShfYXVyZWxpYVBhbC5ET00uRWxlbWVudCwgX2F1cmVsaWFUYXNrUXVldWUuVGFza1F1ZXVlKSwgX2RlYyhfY2xhc3MgPSBfZGVjMihfY2xhc3MgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEZvY3VzKGVsZW1lbnQsIHRhc2tRdWV1ZSkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRm9jdXMpO1xuXG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLnRhc2tRdWV1ZSA9IHRhc2tRdWV1ZTtcbiAgICB0aGlzLmlzQXR0YWNoZWQgPSBmYWxzZTtcbiAgICB0aGlzLm5lZWRzQXBwbHkgPSBmYWxzZTtcblxuICAgIHRoaXMuZm9jdXNMaXN0ZW5lciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICBfdGhpcy52YWx1ZSA9IHRydWU7XG4gICAgfTtcbiAgICB0aGlzLmJsdXJMaXN0ZW5lciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICBpZiAoX2F1cmVsaWFQYWwuRE9NLmFjdGl2ZUVsZW1lbnQgIT09IF90aGlzLmVsZW1lbnQpIHtcbiAgICAgICAgX3RoaXMudmFsdWUgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgRm9jdXMucHJvdG90eXBlLnZhbHVlQ2hhbmdlZCA9IGZ1bmN0aW9uIHZhbHVlQ2hhbmdlZChuZXdWYWx1ZSkge1xuICAgIGlmICh0aGlzLmlzQXR0YWNoZWQpIHtcbiAgICAgIHRoaXMuX2FwcGx5KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubmVlZHNBcHBseSA9IHRydWU7XG4gICAgfVxuICB9O1xuXG4gIEZvY3VzLnByb3RvdHlwZS5fYXBwbHkgPSBmdW5jdGlvbiBfYXBwbHkoKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICBpZiAodGhpcy52YWx1ZSkge1xuICAgICAgdGhpcy50YXNrUXVldWUucXVldWVNaWNyb1Rhc2soZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoX3RoaXMyLnZhbHVlKSB7XG4gICAgICAgICAgX3RoaXMyLmVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZWxlbWVudC5ibHVyKCk7XG4gICAgfVxuICB9O1xuXG4gIEZvY3VzLnByb3RvdHlwZS5hdHRhY2hlZCA9IGZ1bmN0aW9uIGF0dGFjaGVkKCkge1xuICAgIHRoaXMuaXNBdHRhY2hlZCA9IHRydWU7XG4gICAgaWYgKHRoaXMubmVlZHNBcHBseSkge1xuICAgICAgdGhpcy5uZWVkc0FwcGx5ID0gZmFsc2U7XG4gICAgICB0aGlzLl9hcHBseSgpO1xuICAgIH1cbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0aGlzLmZvY3VzTGlzdGVuZXIpO1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5ibHVyTGlzdGVuZXIpO1xuICB9O1xuXG4gIEZvY3VzLnByb3RvdHlwZS5kZXRhY2hlZCA9IGZ1bmN0aW9uIGRldGFjaGVkKCkge1xuICAgIHRoaXMuaXNBdHRhY2hlZCA9IGZhbHNlO1xuICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMuZm9jdXNMaXN0ZW5lcik7XG4gICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLmJsdXJMaXN0ZW5lcik7XG4gIH07XG5cbiAgcmV0dXJuIEZvY3VzO1xufSgpKSB8fCBfY2xhc3MpIHx8IF9jbGFzcyk7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9kaXN0L2NvbW1vbmpzL2ZvY3VzLmpzXG4gKiogbW9kdWxlIGlkID0gNTVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuQ29tcGlsZVNweSA9IHVuZGVmaW5lZDtcblxudmFyIF9kZWMsIF9kZWMyLCBfY2xhc3M7XG5cbnZhciBfYXVyZWxpYVRlbXBsYXRpbmcgPSByZXF1aXJlKCdhdXJlbGlhLXRlbXBsYXRpbmcnKTtcblxudmFyIF9hdXJlbGlhRGVwZW5kZW5jeUluamVjdGlvbiA9IHJlcXVpcmUoJ2F1cmVsaWEtZGVwZW5kZW5jeS1pbmplY3Rpb24nKTtcblxudmFyIF9hdXJlbGlhTG9nZ2luZyA9IHJlcXVpcmUoJ2F1cmVsaWEtbG9nZ2luZycpO1xuXG52YXIgTG9nTWFuYWdlciA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9hdXJlbGlhTG9nZ2luZyk7XG5cbnZhciBfYXVyZWxpYVBhbCA9IHJlcXVpcmUoJ2F1cmVsaWEtcGFsJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBDb21waWxlU3B5ID0gZXhwb3J0cy5Db21waWxlU3B5ID0gKF9kZWMgPSAoMCwgX2F1cmVsaWFUZW1wbGF0aW5nLmN1c3RvbUF0dHJpYnV0ZSkoJ2NvbXBpbGUtc3B5JyksIF9kZWMyID0gKDAsIF9hdXJlbGlhRGVwZW5kZW5jeUluamVjdGlvbi5pbmplY3QpKF9hdXJlbGlhUGFsLkRPTS5FbGVtZW50LCBfYXVyZWxpYVRlbXBsYXRpbmcuVGFyZ2V0SW5zdHJ1Y3Rpb24pLCBfZGVjKF9jbGFzcyA9IF9kZWMyKF9jbGFzcyA9IGZ1bmN0aW9uIENvbXBpbGVTcHkoZWxlbWVudCwgaW5zdHJ1Y3Rpb24pIHtcbiAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENvbXBpbGVTcHkpO1xuXG4gIExvZ01hbmFnZXIuZ2V0TG9nZ2VyKCdjb21waWxlLXNweScpLmluZm8oZWxlbWVudCwgaW5zdHJ1Y3Rpb24pO1xufSkgfHwgX2NsYXNzKSB8fCBfY2xhc3MpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9jb21waWxlLXNweS5qc1xuICoqIG1vZHVsZSBpZCA9IDU2XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLlZpZXdTcHkgPSB1bmRlZmluZWQ7XG5cbnZhciBfZGVjLCBfY2xhc3M7XG5cbnZhciBfYXVyZWxpYVRlbXBsYXRpbmcgPSByZXF1aXJlKCdhdXJlbGlhLXRlbXBsYXRpbmcnKTtcblxudmFyIF9hdXJlbGlhTG9nZ2luZyA9IHJlcXVpcmUoJ2F1cmVsaWEtbG9nZ2luZycpO1xuXG52YXIgTG9nTWFuYWdlciA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9hdXJlbGlhTG9nZ2luZyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBWaWV3U3B5ID0gZXhwb3J0cy5WaWV3U3B5ID0gKF9kZWMgPSAoMCwgX2F1cmVsaWFUZW1wbGF0aW5nLmN1c3RvbUF0dHJpYnV0ZSkoJ3ZpZXctc3B5JyksIF9kZWMoX2NsYXNzID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBWaWV3U3B5KCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBWaWV3U3B5KTtcblxuICAgIHRoaXMubG9nZ2VyID0gTG9nTWFuYWdlci5nZXRMb2dnZXIoJ3ZpZXctc3B5Jyk7XG4gIH1cblxuICBWaWV3U3B5LnByb3RvdHlwZS5fbG9nID0gZnVuY3Rpb24gX2xvZyhsaWZlY3ljbGVOYW1lLCBjb250ZXh0KSB7XG4gICAgaWYgKCF0aGlzLnZhbHVlICYmIGxpZmVjeWNsZU5hbWUgPT09ICdjcmVhdGVkJykge1xuICAgICAgdGhpcy5sb2dnZXIuaW5mbyhsaWZlY3ljbGVOYW1lLCB0aGlzLnZpZXcpO1xuICAgIH0gZWxzZSBpZiAodGhpcy52YWx1ZSAmJiB0aGlzLnZhbHVlLmluZGV4T2YobGlmZWN5Y2xlTmFtZSkgIT09IC0xKSB7XG4gICAgICB0aGlzLmxvZ2dlci5pbmZvKGxpZmVjeWNsZU5hbWUsIHRoaXMudmlldywgY29udGV4dCk7XG4gICAgfVxuICB9O1xuXG4gIFZpZXdTcHkucHJvdG90eXBlLmNyZWF0ZWQgPSBmdW5jdGlvbiBjcmVhdGVkKHZpZXcpIHtcbiAgICB0aGlzLnZpZXcgPSB2aWV3O1xuICAgIHRoaXMuX2xvZygnY3JlYXRlZCcpO1xuICB9O1xuXG4gIFZpZXdTcHkucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiBiaW5kKGJpbmRpbmdDb250ZXh0KSB7XG4gICAgdGhpcy5fbG9nKCdiaW5kJywgYmluZGluZ0NvbnRleHQpO1xuICB9O1xuXG4gIFZpZXdTcHkucHJvdG90eXBlLmF0dGFjaGVkID0gZnVuY3Rpb24gYXR0YWNoZWQoKSB7XG4gICAgdGhpcy5fbG9nKCdhdHRhY2hlZCcpO1xuICB9O1xuXG4gIFZpZXdTcHkucHJvdG90eXBlLmRldGFjaGVkID0gZnVuY3Rpb24gZGV0YWNoZWQoKSB7XG4gICAgdGhpcy5fbG9nKCdkZXRhY2hlZCcpO1xuICB9O1xuXG4gIFZpZXdTcHkucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uIHVuYmluZCgpIHtcbiAgICB0aGlzLl9sb2coJ3VuYmluZCcpO1xuICB9O1xuXG4gIHJldHVybiBWaWV3U3B5O1xufSgpKSB8fCBfY2xhc3MpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy92aWV3LXNweS5qc1xuICoqIG1vZHVsZSBpZCA9IDU3XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLl9jcmVhdGVDU1NSZXNvdXJjZSA9IF9jcmVhdGVDU1NSZXNvdXJjZTtcblxudmFyIF9hdXJlbGlhVGVtcGxhdGluZyA9IHJlcXVpcmUoJ2F1cmVsaWEtdGVtcGxhdGluZycpO1xuXG52YXIgX2F1cmVsaWFMb2FkZXIgPSByZXF1aXJlKCdhdXJlbGlhLWxvYWRlcicpO1xuXG52YXIgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uID0gcmVxdWlyZSgnYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbicpO1xuXG52YXIgX2F1cmVsaWFQYXRoID0gcmVxdWlyZSgnYXVyZWxpYS1wYXRoJyk7XG5cbnZhciBfYXVyZWxpYVBhbCA9IHJlcXVpcmUoJ2F1cmVsaWEtcGFsJyk7XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIGNzc1VybE1hdGNoZXIgPSAvdXJsXFwoKD8hWydcIl1kYXRhKShbXildKylcXCkvZ2k7XG5cbmZ1bmN0aW9uIGZpeHVwQ1NTVXJscyhhZGRyZXNzLCBjc3MpIHtcbiAgaWYgKHR5cGVvZiBjc3MgIT09ICdzdHJpbmcnKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgbG9hZGluZyByZXF1aXJlZCBDU1MgZmlsZTogJyArIGFkZHJlc3MpO1xuICB9XG4gIHJldHVybiBjc3MucmVwbGFjZShjc3NVcmxNYXRjaGVyLCBmdW5jdGlvbiAobWF0Y2gsIHAxKSB7XG4gICAgdmFyIHF1b3RlID0gcDEuY2hhckF0KDApO1xuICAgIGlmIChxdW90ZSA9PT0gJ1xcJycgfHwgcXVvdGUgPT09ICdcIicpIHtcbiAgICAgIHAxID0gcDEuc3Vic3RyKDEsIHAxLmxlbmd0aCAtIDIpO1xuICAgIH1cbiAgICByZXR1cm4gJ3VybChcXCcnICsgKDAsIF9hdXJlbGlhUGF0aC5yZWxhdGl2ZVRvRmlsZSkocDEsIGFkZHJlc3MpICsgJ1xcJyknO1xuICB9KTtcbn1cblxudmFyIENTU1Jlc291cmNlID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBDU1NSZXNvdXJjZShhZGRyZXNzKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENTU1Jlc291cmNlKTtcblxuICAgIHRoaXMuYWRkcmVzcyA9IGFkZHJlc3M7XG4gICAgdGhpcy5fZ2xvYmFsID0gbnVsbDtcbiAgICB0aGlzLl9zY29wZWQgPSBudWxsO1xuICB9XG5cbiAgQ1NTUmVzb3VyY2UucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiBpbml0aWFsaXplKGNvbnRhaW5lciwgdGFyZ2V0KSB7XG4gICAgdGhpcy5fZ2xvYmFsID0gbmV3IHRhcmdldCgnZ2xvYmFsJyk7XG4gICAgdGhpcy5fc2NvcGVkID0gbmV3IHRhcmdldCgnc2NvcGVkJyk7XG4gIH07XG5cbiAgQ1NTUmVzb3VyY2UucHJvdG90eXBlLnJlZ2lzdGVyID0gZnVuY3Rpb24gcmVnaXN0ZXIocmVnaXN0cnksIG5hbWUpIHtcbiAgICByZWdpc3RyeS5yZWdpc3RlclZpZXdFbmdpbmVIb29rcyhuYW1lID09PSAnc2NvcGVkJyA/IHRoaXMuX3Njb3BlZCA6IHRoaXMuX2dsb2JhbCk7XG4gIH07XG5cbiAgQ1NTUmVzb3VyY2UucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiBsb2FkKGNvbnRhaW5lcikge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICByZXR1cm4gY29udGFpbmVyLmdldChfYXVyZWxpYUxvYWRlci5Mb2FkZXIpLmxvYWRUZXh0KHRoaXMuYWRkcmVzcykuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSkudGhlbihmdW5jdGlvbiAodGV4dCkge1xuICAgICAgdGV4dCA9IGZpeHVwQ1NTVXJscyhfdGhpcy5hZGRyZXNzLCB0ZXh0KTtcbiAgICAgIF90aGlzLl9nbG9iYWwuY3NzID0gdGV4dDtcbiAgICAgIF90aGlzLl9zY29wZWQuY3NzID0gdGV4dDtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4gQ1NTUmVzb3VyY2U7XG59KCk7XG5cbnZhciBDU1NWaWV3RW5naW5lSG9va3MgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIENTU1ZpZXdFbmdpbmVIb29rcyhtb2RlKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENTU1ZpZXdFbmdpbmVIb29rcyk7XG5cbiAgICB0aGlzLm1vZGUgPSBtb2RlO1xuICAgIHRoaXMuY3NzID0gbnVsbDtcbiAgICB0aGlzLl9hbHJlYWR5R2xvYmFsbHlJbmplY3RlZCA9IGZhbHNlO1xuICB9XG5cbiAgQ1NTVmlld0VuZ2luZUhvb2tzLnByb3RvdHlwZS5iZWZvcmVDb21waWxlID0gZnVuY3Rpb24gYmVmb3JlQ29tcGlsZShjb250ZW50LCByZXNvdXJjZXMsIGluc3RydWN0aW9uKSB7XG4gICAgaWYgKHRoaXMubW9kZSA9PT0gJ3Njb3BlZCcpIHtcbiAgICAgIGlmIChpbnN0cnVjdGlvbi50YXJnZXRTaGFkb3dET00pIHtcbiAgICAgICAgX2F1cmVsaWFQYWwuRE9NLmluamVjdFN0eWxlcyh0aGlzLmNzcywgY29udGVudCwgdHJ1ZSk7XG4gICAgICB9IGVsc2UgaWYgKF9hdXJlbGlhUGFsLkZFQVRVUkUuc2NvcGVkQ1NTKSB7XG4gICAgICAgIHZhciBzdHlsZU5vZGUgPSBfYXVyZWxpYVBhbC5ET00uaW5qZWN0U3R5bGVzKHRoaXMuY3NzLCBjb250ZW50LCB0cnVlKTtcbiAgICAgICAgc3R5bGVOb2RlLnNldEF0dHJpYnV0ZSgnc2NvcGVkJywgJ3Njb3BlZCcpO1xuICAgICAgfSBlbHNlIGlmICghdGhpcy5fYWxyZWFkeUdsb2JhbGx5SW5qZWN0ZWQpIHtcbiAgICAgICAgX2F1cmVsaWFQYWwuRE9NLmluamVjdFN0eWxlcyh0aGlzLmNzcyk7XG4gICAgICAgIHRoaXMuX2FscmVhZHlHbG9iYWxseUluamVjdGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKCF0aGlzLl9hbHJlYWR5R2xvYmFsbHlJbmplY3RlZCkge1xuICAgICAgX2F1cmVsaWFQYWwuRE9NLmluamVjdFN0eWxlcyh0aGlzLmNzcyk7XG4gICAgICB0aGlzLl9hbHJlYWR5R2xvYmFsbHlJbmplY3RlZCA9IHRydWU7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBDU1NWaWV3RW5naW5lSG9va3M7XG59KCk7XG5cbmZ1bmN0aW9uIF9jcmVhdGVDU1NSZXNvdXJjZShhZGRyZXNzKSB7XG4gIHZhciBfZGVjLCBfY2xhc3M7XG5cbiAgdmFyIFZpZXdDU1MgPSAoX2RlYyA9ICgwLCBfYXVyZWxpYVRlbXBsYXRpbmcucmVzb3VyY2UpKG5ldyBDU1NSZXNvdXJjZShhZGRyZXNzKSksIF9kZWMoX2NsYXNzID0gZnVuY3Rpb24gKF9DU1NWaWV3RW5naW5lSG9va3MpIHtcbiAgICBfaW5oZXJpdHMoVmlld0NTUywgX0NTU1ZpZXdFbmdpbmVIb29rcyk7XG5cbiAgICBmdW5jdGlvbiBWaWV3Q1NTKCkge1xuICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpZXdDU1MpO1xuXG4gICAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX0NTU1ZpZXdFbmdpbmVIb29rcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gVmlld0NTUztcbiAgfShDU1NWaWV3RW5naW5lSG9va3MpKSB8fCBfY2xhc3MpO1xuXG4gIHJldHVybiBWaWV3Q1NTO1xufVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9jc3MtcmVzb3VyY2UuanNcbiAqKiBtb2R1bGUgaWQgPSA1OFxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5Ud29XYXlCaW5kaW5nQmVoYXZpb3IgPSBleHBvcnRzLk9uZVdheUJpbmRpbmdCZWhhdmlvciA9IGV4cG9ydHMuT25lVGltZUJpbmRpbmdCZWhhdmlvciA9IHVuZGVmaW5lZDtcblxudmFyIF9kZWMsIF9jbGFzcywgX2RlYzIsIF9jbGFzczIsIF9kZWMzLCBfY2xhc3MzO1xuXG52YXIgX2F1cmVsaWFCaW5kaW5nID0gcmVxdWlyZSgnYXVyZWxpYS1iaW5kaW5nJyk7XG5cbnZhciBfYXVyZWxpYU1ldGFkYXRhID0gcmVxdWlyZSgnYXVyZWxpYS1tZXRhZGF0YScpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgbW9kZUJpbmRpbmdCZWhhdmlvciA9IHtcbiAgYmluZDogZnVuY3Rpb24gYmluZChiaW5kaW5nLCBzb3VyY2UsIGxvb2t1cEZ1bmN0aW9ucykge1xuICAgIGJpbmRpbmcub3JpZ2luYWxNb2RlID0gYmluZGluZy5tb2RlO1xuICAgIGJpbmRpbmcubW9kZSA9IHRoaXMubW9kZTtcbiAgfSxcbiAgdW5iaW5kOiBmdW5jdGlvbiB1bmJpbmQoYmluZGluZywgc291cmNlKSB7XG4gICAgYmluZGluZy5tb2RlID0gYmluZGluZy5vcmlnaW5hbE1vZGU7XG4gICAgYmluZGluZy5vcmlnaW5hbE1vZGUgPSBudWxsO1xuICB9XG59O1xuXG52YXIgT25lVGltZUJpbmRpbmdCZWhhdmlvciA9IGV4cG9ydHMuT25lVGltZUJpbmRpbmdCZWhhdmlvciA9IChfZGVjID0gKDAsIF9hdXJlbGlhTWV0YWRhdGEubWl4aW4pKG1vZGVCaW5kaW5nQmVoYXZpb3IpLCBfZGVjKF9jbGFzcyA9IGZ1bmN0aW9uIE9uZVRpbWVCaW5kaW5nQmVoYXZpb3IoKSB7XG4gIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBPbmVUaW1lQmluZGluZ0JlaGF2aW9yKTtcblxuICB0aGlzLm1vZGUgPSBfYXVyZWxpYUJpbmRpbmcuYmluZGluZ01vZGUub25lVGltZTtcbn0pIHx8IF9jbGFzcyk7XG52YXIgT25lV2F5QmluZGluZ0JlaGF2aW9yID0gZXhwb3J0cy5PbmVXYXlCaW5kaW5nQmVoYXZpb3IgPSAoX2RlYzIgPSAoMCwgX2F1cmVsaWFNZXRhZGF0YS5taXhpbikobW9kZUJpbmRpbmdCZWhhdmlvciksIF9kZWMyKF9jbGFzczIgPSBmdW5jdGlvbiBPbmVXYXlCaW5kaW5nQmVoYXZpb3IoKSB7XG4gIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBPbmVXYXlCaW5kaW5nQmVoYXZpb3IpO1xuXG4gIHRoaXMubW9kZSA9IF9hdXJlbGlhQmluZGluZy5iaW5kaW5nTW9kZS5vbmVXYXk7XG59KSB8fCBfY2xhc3MyKTtcbnZhciBUd29XYXlCaW5kaW5nQmVoYXZpb3IgPSBleHBvcnRzLlR3b1dheUJpbmRpbmdCZWhhdmlvciA9IChfZGVjMyA9ICgwLCBfYXVyZWxpYU1ldGFkYXRhLm1peGluKShtb2RlQmluZGluZ0JlaGF2aW9yKSwgX2RlYzMoX2NsYXNzMyA9IGZ1bmN0aW9uIFR3b1dheUJpbmRpbmdCZWhhdmlvcigpIHtcbiAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFR3b1dheUJpbmRpbmdCZWhhdmlvcik7XG5cbiAgdGhpcy5tb2RlID0gX2F1cmVsaWFCaW5kaW5nLmJpbmRpbmdNb2RlLnR3b1dheTtcbn0pIHx8IF9jbGFzczMpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9iaW5kaW5nLW1vZGUtYmVoYXZpb3JzLmpzXG4gKiogbW9kdWxlIGlkID0gNTlcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuVGhyb3R0bGVCaW5kaW5nQmVoYXZpb3IgPSB1bmRlZmluZWQ7XG5cbnZhciBfYXVyZWxpYUJpbmRpbmcgPSByZXF1aXJlKCdhdXJlbGlhLWJpbmRpbmcnKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gdGhyb3R0bGUobmV3VmFsdWUpIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICB2YXIgc3RhdGUgPSB0aGlzLnRocm90dGxlU3RhdGU7XG4gIHZhciBlbGFwc2VkID0gK25ldyBEYXRlKCkgLSBzdGF0ZS5sYXN0O1xuICBpZiAoZWxhcHNlZCA+PSBzdGF0ZS5kZWxheSkge1xuICAgIGNsZWFyVGltZW91dChzdGF0ZS50aW1lb3V0SWQpO1xuICAgIHN0YXRlLnRpbWVvdXRJZCA9IG51bGw7XG4gICAgc3RhdGUubGFzdCA9ICtuZXcgRGF0ZSgpO1xuICAgIHRoaXMudGhyb3R0bGVkTWV0aG9kKG5ld1ZhbHVlKTtcbiAgICByZXR1cm47XG4gIH1cbiAgc3RhdGUubmV3VmFsdWUgPSBuZXdWYWx1ZTtcbiAgaWYgKHN0YXRlLnRpbWVvdXRJZCA9PT0gbnVsbCkge1xuICAgIHN0YXRlLnRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgc3RhdGUudGltZW91dElkID0gbnVsbDtcbiAgICAgIHN0YXRlLmxhc3QgPSArbmV3IERhdGUoKTtcbiAgICAgIF90aGlzLnRocm90dGxlZE1ldGhvZChzdGF0ZS5uZXdWYWx1ZSk7XG4gICAgfSwgc3RhdGUuZGVsYXkgLSBlbGFwc2VkKTtcbiAgfVxufVxuXG52YXIgVGhyb3R0bGVCaW5kaW5nQmVoYXZpb3IgPSBleHBvcnRzLlRocm90dGxlQmluZGluZ0JlaGF2aW9yID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBUaHJvdHRsZUJpbmRpbmdCZWhhdmlvcigpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGhyb3R0bGVCaW5kaW5nQmVoYXZpb3IpO1xuICB9XG5cbiAgVGhyb3R0bGVCaW5kaW5nQmVoYXZpb3IucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiBiaW5kKGJpbmRpbmcsIHNvdXJjZSkge1xuICAgIHZhciBkZWxheSA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMiB8fCBhcmd1bWVudHNbMl0gPT09IHVuZGVmaW5lZCA/IDIwMCA6IGFyZ3VtZW50c1syXTtcblxuICAgIHZhciBtZXRob2RUb1Rocm90dGxlID0gJ3VwZGF0ZVRhcmdldCc7XG4gICAgaWYgKGJpbmRpbmcuY2FsbFNvdXJjZSkge1xuICAgICAgbWV0aG9kVG9UaHJvdHRsZSA9ICdjYWxsU291cmNlJztcbiAgICB9IGVsc2UgaWYgKGJpbmRpbmcudXBkYXRlU291cmNlICYmIGJpbmRpbmcubW9kZSA9PT0gX2F1cmVsaWFCaW5kaW5nLmJpbmRpbmdNb2RlLnR3b1dheSkge1xuICAgICAgICBtZXRob2RUb1Rocm90dGxlID0gJ3VwZGF0ZVNvdXJjZSc7XG4gICAgICB9XG5cbiAgICBiaW5kaW5nLnRocm90dGxlZE1ldGhvZCA9IGJpbmRpbmdbbWV0aG9kVG9UaHJvdHRsZV07XG4gICAgYmluZGluZy50aHJvdHRsZWRNZXRob2Qub3JpZ2luYWxOYW1lID0gbWV0aG9kVG9UaHJvdHRsZTtcblxuICAgIGJpbmRpbmdbbWV0aG9kVG9UaHJvdHRsZV0gPSB0aHJvdHRsZTtcblxuICAgIGJpbmRpbmcudGhyb3R0bGVTdGF0ZSA9IHtcbiAgICAgIGRlbGF5OiBkZWxheSxcbiAgICAgIGxhc3Q6IDAsXG4gICAgICB0aW1lb3V0SWQ6IG51bGxcbiAgICB9O1xuICB9O1xuXG4gIFRocm90dGxlQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiB1bmJpbmQoYmluZGluZywgc291cmNlKSB7XG4gICAgdmFyIG1ldGhvZFRvUmVzdG9yZSA9IGJpbmRpbmcudGhyb3R0bGVkTWV0aG9kLm9yaWdpbmFsTmFtZTtcbiAgICBiaW5kaW5nW21ldGhvZFRvUmVzdG9yZV0gPSBiaW5kaW5nLnRocm90dGxlZE1ldGhvZDtcbiAgICBiaW5kaW5nLnRocm90dGxlZE1ldGhvZCA9IG51bGw7XG4gICAgY2xlYXJUaW1lb3V0KGJpbmRpbmcudGhyb3R0bGVTdGF0ZS50aW1lb3V0SWQpO1xuICAgIGJpbmRpbmcudGhyb3R0bGVTdGF0ZSA9IG51bGw7XG4gIH07XG5cbiAgcmV0dXJuIFRocm90dGxlQmluZGluZ0JlaGF2aW9yO1xufSgpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy90aHJvdHRsZS1iaW5kaW5nLWJlaGF2aW9yLmpzXG4gKiogbW9kdWxlIGlkID0gNjBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuRGVib3VuY2VCaW5kaW5nQmVoYXZpb3IgPSB1bmRlZmluZWQ7XG5cbnZhciBfYXVyZWxpYUJpbmRpbmcgPSByZXF1aXJlKCdhdXJlbGlhLWJpbmRpbmcnKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gZGVib3VuY2UobmV3VmFsdWUpIHtcbiAgdmFyIF90aGlzID0gdGhpcztcblxuICB2YXIgc3RhdGUgPSB0aGlzLmRlYm91bmNlU3RhdGU7XG4gIGlmIChzdGF0ZS5pbW1lZGlhdGUpIHtcbiAgICBzdGF0ZS5pbW1lZGlhdGUgPSBmYWxzZTtcbiAgICB0aGlzLmRlYm91bmNlZE1ldGhvZChuZXdWYWx1ZSk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNsZWFyVGltZW91dChzdGF0ZS50aW1lb3V0SWQpO1xuICBzdGF0ZS50aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gX3RoaXMuZGVib3VuY2VkTWV0aG9kKG5ld1ZhbHVlKTtcbiAgfSwgc3RhdGUuZGVsYXkpO1xufVxuXG52YXIgRGVib3VuY2VCaW5kaW5nQmVoYXZpb3IgPSBleHBvcnRzLkRlYm91bmNlQmluZGluZ0JlaGF2aW9yID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBEZWJvdW5jZUJpbmRpbmdCZWhhdmlvcigpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGVib3VuY2VCaW5kaW5nQmVoYXZpb3IpO1xuICB9XG5cbiAgRGVib3VuY2VCaW5kaW5nQmVoYXZpb3IucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiBiaW5kKGJpbmRpbmcsIHNvdXJjZSkge1xuICAgIHZhciBkZWxheSA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMiB8fCBhcmd1bWVudHNbMl0gPT09IHVuZGVmaW5lZCA/IDIwMCA6IGFyZ3VtZW50c1syXTtcblxuICAgIHZhciBtZXRob2RUb0RlYm91bmNlID0gJ3VwZGF0ZVRhcmdldCc7XG4gICAgaWYgKGJpbmRpbmcuY2FsbFNvdXJjZSkge1xuICAgICAgbWV0aG9kVG9EZWJvdW5jZSA9ICdjYWxsU291cmNlJztcbiAgICB9IGVsc2UgaWYgKGJpbmRpbmcudXBkYXRlU291cmNlICYmIGJpbmRpbmcubW9kZSA9PT0gX2F1cmVsaWFCaW5kaW5nLmJpbmRpbmdNb2RlLnR3b1dheSkge1xuICAgICAgICBtZXRob2RUb0RlYm91bmNlID0gJ3VwZGF0ZVNvdXJjZSc7XG4gICAgICB9XG5cbiAgICBiaW5kaW5nLmRlYm91bmNlZE1ldGhvZCA9IGJpbmRpbmdbbWV0aG9kVG9EZWJvdW5jZV07XG4gICAgYmluZGluZy5kZWJvdW5jZWRNZXRob2Qub3JpZ2luYWxOYW1lID0gbWV0aG9kVG9EZWJvdW5jZTtcblxuICAgIGJpbmRpbmdbbWV0aG9kVG9EZWJvdW5jZV0gPSBkZWJvdW5jZTtcblxuICAgIGJpbmRpbmcuZGVib3VuY2VTdGF0ZSA9IHtcbiAgICAgIGRlbGF5OiBkZWxheSxcbiAgICAgIHRpbWVvdXRJZDogbnVsbCxcbiAgICAgIGltbWVkaWF0ZTogbWV0aG9kVG9EZWJvdW5jZSA9PT0gJ3VwZGF0ZVRhcmdldCcgfTtcbiAgfTtcblxuICBEZWJvdW5jZUJpbmRpbmdCZWhhdmlvci5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gdW5iaW5kKGJpbmRpbmcsIHNvdXJjZSkge1xuICAgIHZhciBtZXRob2RUb1Jlc3RvcmUgPSBiaW5kaW5nLmRlYm91bmNlZE1ldGhvZC5vcmlnaW5hbE5hbWU7XG4gICAgYmluZGluZ1ttZXRob2RUb1Jlc3RvcmVdID0gYmluZGluZy5kZWJvdW5jZWRNZXRob2Q7XG4gICAgYmluZGluZy5kZWJvdW5jZWRNZXRob2QgPSBudWxsO1xuICAgIGNsZWFyVGltZW91dChiaW5kaW5nLmRlYm91bmNlU3RhdGUudGltZW91dElkKTtcbiAgICBiaW5kaW5nLmRlYm91bmNlU3RhdGUgPSBudWxsO1xuICB9O1xuXG4gIHJldHVybiBEZWJvdW5jZUJpbmRpbmdCZWhhdmlvcjtcbn0oKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvZGVib3VuY2UtYmluZGluZy1iZWhhdmlvci5qc1xuICoqIG1vZHVsZSBpZCA9IDYxXG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLlNpZ25hbEJpbmRpbmdCZWhhdmlvciA9IHVuZGVmaW5lZDtcblxudmFyIF9iaW5kaW5nU2lnbmFsZXIgPSByZXF1aXJlKCcuL2JpbmRpbmctc2lnbmFsZXInKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIFNpZ25hbEJpbmRpbmdCZWhhdmlvciA9IGV4cG9ydHMuU2lnbmFsQmluZGluZ0JlaGF2aW9yID0gZnVuY3Rpb24gKCkge1xuICBTaWduYWxCaW5kaW5nQmVoYXZpb3IuaW5qZWN0ID0gZnVuY3Rpb24gaW5qZWN0KCkge1xuICAgIHJldHVybiBbX2JpbmRpbmdTaWduYWxlci5CaW5kaW5nU2lnbmFsZXJdO1xuICB9O1xuXG4gIGZ1bmN0aW9uIFNpZ25hbEJpbmRpbmdCZWhhdmlvcihiaW5kaW5nU2lnbmFsZXIpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2lnbmFsQmluZGluZ0JlaGF2aW9yKTtcblxuICAgIHRoaXMuc2lnbmFscyA9IGJpbmRpbmdTaWduYWxlci5zaWduYWxzO1xuICB9XG5cbiAgU2lnbmFsQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gYmluZChiaW5kaW5nLCBzb3VyY2UpIHtcbiAgICBpZiAoIWJpbmRpbmcudXBkYXRlVGFyZ2V0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ09ubHkgcHJvcGVydHkgYmluZGluZ3MgYW5kIHN0cmluZyBpbnRlcnBvbGF0aW9uIGJpbmRpbmdzIGNhbiBiZSBzaWduYWxlZC4gIFRyaWdnZXIsIGRlbGVnYXRlIGFuZCBjYWxsIGJpbmRpbmdzIGNhbm5vdCBiZSBzaWduYWxlZC4nKTtcbiAgICB9XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDMpIHtcbiAgICAgIHZhciBuYW1lID0gYXJndW1lbnRzWzJdO1xuICAgICAgdmFyIGJpbmRpbmdzID0gdGhpcy5zaWduYWxzW25hbWVdIHx8ICh0aGlzLnNpZ25hbHNbbmFtZV0gPSBbXSk7XG4gICAgICBiaW5kaW5ncy5wdXNoKGJpbmRpbmcpO1xuICAgICAgYmluZGluZy5zaWduYWxOYW1lID0gbmFtZTtcbiAgICB9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAzKSB7XG4gICAgICB2YXIgbmFtZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xuICAgICAgdmFyIGkgPSBuYW1lcy5sZW5ndGg7XG4gICAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIHZhciBfbmFtZSA9IG5hbWVzW2ldO1xuICAgICAgICB2YXIgX2JpbmRpbmdzID0gdGhpcy5zaWduYWxzW19uYW1lXSB8fCAodGhpcy5zaWduYWxzW19uYW1lXSA9IFtdKTtcbiAgICAgICAgX2JpbmRpbmdzLnB1c2goYmluZGluZyk7XG4gICAgICB9XG4gICAgICBiaW5kaW5nLnNpZ25hbE5hbWUgPSBuYW1lcztcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdTaWduYWwgbmFtZSBpcyByZXF1aXJlZC4nKTtcbiAgICB9XG4gIH07XG5cbiAgU2lnbmFsQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiB1bmJpbmQoYmluZGluZywgc291cmNlKSB7XG4gICAgdmFyIG5hbWUgPSBiaW5kaW5nLnNpZ25hbE5hbWU7XG4gICAgYmluZGluZy5zaWduYWxOYW1lID0gbnVsbDtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShuYW1lKSkge1xuICAgICAgdmFyIG5hbWVzID0gbmFtZTtcbiAgICAgIHZhciBpID0gbmFtZXMubGVuZ3RoO1xuICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICB2YXIgbiA9IG5hbWVzW2ldO1xuICAgICAgICB2YXIgYmluZGluZ3MgPSB0aGlzLnNpZ25hbHNbbl07XG4gICAgICAgIGJpbmRpbmdzLnNwbGljZShiaW5kaW5ncy5pbmRleE9mKGJpbmRpbmcpLCAxKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIF9iaW5kaW5nczIgPSB0aGlzLnNpZ25hbHNbbmFtZV07XG4gICAgICBfYmluZGluZ3MyLnNwbGljZShfYmluZGluZ3MyLmluZGV4T2YoYmluZGluZyksIDEpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gU2lnbmFsQmluZGluZ0JlaGF2aW9yO1xufSgpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9zaWduYWwtYmluZGluZy1iZWhhdmlvci5qc1xuICoqIG1vZHVsZSBpZCA9IDYyXG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLkJpbmRpbmdTaWduYWxlciA9IHVuZGVmaW5lZDtcblxudmFyIF9hdXJlbGlhQmluZGluZyA9IHJlcXVpcmUoJ2F1cmVsaWEtYmluZGluZycpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgQmluZGluZ1NpZ25hbGVyID0gZXhwb3J0cy5CaW5kaW5nU2lnbmFsZXIgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEJpbmRpbmdTaWduYWxlcigpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQmluZGluZ1NpZ25hbGVyKTtcblxuICAgIHRoaXMuc2lnbmFscyA9IHt9O1xuICB9XG5cbiAgQmluZGluZ1NpZ25hbGVyLnByb3RvdHlwZS5zaWduYWwgPSBmdW5jdGlvbiBzaWduYWwobmFtZSkge1xuICAgIHZhciBiaW5kaW5ncyA9IHRoaXMuc2lnbmFsc1tuYW1lXTtcbiAgICBpZiAoIWJpbmRpbmdzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBpID0gYmluZGluZ3MubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgIGJpbmRpbmdzW2ldLmNhbGwoX2F1cmVsaWFCaW5kaW5nLnNvdXJjZUNvbnRleHQpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gQmluZGluZ1NpZ25hbGVyO1xufSgpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9iaW5kaW5nLXNpZ25hbGVyLmpzXG4gKiogbW9kdWxlIGlkID0gNjNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuVXBkYXRlVHJpZ2dlckJpbmRpbmdCZWhhdmlvciA9IHVuZGVmaW5lZDtcblxudmFyIF9jbGFzcywgX3RlbXA7XG5cbnZhciBfYXVyZWxpYUJpbmRpbmcgPSByZXF1aXJlKCdhdXJlbGlhLWJpbmRpbmcnKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIGV2ZW50TmFtZXNSZXF1aXJlZCA9ICdUaGUgdXBkYXRlVHJpZ2dlciBiaW5kaW5nIGJlaGF2aW9yIHJlcXVpcmVzIGF0IGxlYXN0IG9uZSBldmVudCBuYW1lIGFyZ3VtZW50OiBlZyA8aW5wdXQgdmFsdWUuYmluZD1cImZpcnN0TmFtZSAmIHVwZGF0ZVRyaWdnZXI6XFwnYmx1clxcJ1wiPic7XG52YXIgbm90QXBwbGljYWJsZU1lc3NhZ2UgPSAnVGhlIHVwZGF0ZVRyaWdnZXIgYmluZGluZyBiZWhhdmlvciBjYW4gb25seSBiZSBhcHBsaWVkIHRvIHR3by13YXkgYmluZGluZ3Mgb24gaW5wdXQvc2VsZWN0IGVsZW1lbnRzLic7XG5cbnZhciBVcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yID0gZXhwb3J0cy5VcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yID0gKF90ZW1wID0gX2NsYXNzID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBVcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yKGV2ZW50TWFuYWdlcikge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBVcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yKTtcblxuICAgIHRoaXMuZXZlbnRNYW5hZ2VyID0gZXZlbnRNYW5hZ2VyO1xuICB9XG5cbiAgVXBkYXRlVHJpZ2dlckJpbmRpbmdCZWhhdmlvci5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIGJpbmQoYmluZGluZywgc291cmNlKSB7XG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGV2ZW50cyA9IEFycmF5KF9sZW4gPiAyID8gX2xlbiAtIDIgOiAwKSwgX2tleSA9IDI7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGV2ZW50c1tfa2V5IC0gMl0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuXG4gICAgaWYgKGV2ZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihldmVudE5hbWVzUmVxdWlyZWQpO1xuICAgIH1cbiAgICBpZiAoYmluZGluZy5tb2RlICE9PSBfYXVyZWxpYUJpbmRpbmcuYmluZGluZ01vZGUudHdvV2F5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3Iobm90QXBwbGljYWJsZU1lc3NhZ2UpO1xuICAgIH1cblxuICAgIHZhciB0YXJnZXRPYnNlcnZlciA9IGJpbmRpbmcub2JzZXJ2ZXJMb2NhdG9yLmdldE9ic2VydmVyKGJpbmRpbmcudGFyZ2V0LCBiaW5kaW5nLnRhcmdldFByb3BlcnR5KTtcbiAgICBpZiAoIXRhcmdldE9ic2VydmVyLmhhbmRsZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihub3RBcHBsaWNhYmxlTWVzc2FnZSk7XG4gICAgfVxuICAgIGJpbmRpbmcudGFyZ2V0T2JzZXJ2ZXIgPSB0YXJnZXRPYnNlcnZlcjtcblxuICAgIHRhcmdldE9ic2VydmVyLm9yaWdpbmFsSGFuZGxlciA9IGJpbmRpbmcudGFyZ2V0T2JzZXJ2ZXIuaGFuZGxlcjtcblxuICAgIHZhciBoYW5kbGVyID0gdGhpcy5ldmVudE1hbmFnZXIuY3JlYXRlRWxlbWVudEhhbmRsZXIoZXZlbnRzKTtcbiAgICB0YXJnZXRPYnNlcnZlci5oYW5kbGVyID0gaGFuZGxlcjtcbiAgfTtcblxuICBVcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiB1bmJpbmQoYmluZGluZywgc291cmNlKSB7XG4gICAgYmluZGluZy50YXJnZXRPYnNlcnZlci5oYW5kbGVyID0gYmluZGluZy50YXJnZXRPYnNlcnZlci5vcmlnaW5hbEhhbmRsZXI7XG4gICAgYmluZGluZy50YXJnZXRPYnNlcnZlci5vcmlnaW5hbEhhbmRsZXIgPSBudWxsO1xuICB9O1xuXG4gIHJldHVybiBVcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yO1xufSgpLCBfY2xhc3MuaW5qZWN0ID0gW19hdXJlbGlhQmluZGluZy5FdmVudE1hbmFnZXJdLCBfdGVtcCk7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy9kaXN0L2NvbW1vbmpzL3VwZGF0ZS10cmlnZ2VyLWJpbmRpbmctYmVoYXZpb3IuanNcbiAqKiBtb2R1bGUgaWQgPSA2NFxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5nZXRFbGVtZW50TmFtZSA9IGdldEVsZW1lbnROYW1lO1xuZXhwb3J0cy5jb25maWd1cmUgPSBjb25maWd1cmU7XG5cbnZhciBfYXVyZWxpYVRlbXBsYXRpbmcgPSByZXF1aXJlKCdhdXJlbGlhLXRlbXBsYXRpbmcnKTtcblxudmFyIF9keW5hbWljRWxlbWVudCA9IHJlcXVpcmUoJy4vZHluYW1pYy1lbGVtZW50Jyk7XG5cbmZ1bmN0aW9uIGdldEVsZW1lbnROYW1lKGFkZHJlc3MpIHtcbiAgcmV0dXJuICgvKFteXFwvXlxcP10rKVxcLmh0bWwvaS5leGVjKGFkZHJlc3MpWzFdLnRvTG93ZXJDYXNlKClcbiAgKTtcbn1cblxuZnVuY3Rpb24gY29uZmlndXJlKGNvbmZpZykge1xuICB2YXIgdmlld0VuZ2luZSA9IGNvbmZpZy5jb250YWluZXIuZ2V0KF9hdXJlbGlhVGVtcGxhdGluZy5WaWV3RW5naW5lKTtcbiAgdmFyIGxvYWRlciA9IGNvbmZpZy5hdXJlbGlhLmxvYWRlcjtcblxuICB2aWV3RW5naW5lLmFkZFJlc291cmNlUGx1Z2luKCcuaHRtbCcsIHtcbiAgICAnZmV0Y2gnOiBmdW5jdGlvbiBmZXRjaChhZGRyZXNzKSB7XG4gICAgICByZXR1cm4gbG9hZGVyLmxvYWRUZW1wbGF0ZShhZGRyZXNzKS50aGVuKGZ1bmN0aW9uIChyZWdpc3RyeUVudHJ5KSB7XG4gICAgICAgIHZhciBfcmVmO1xuXG4gICAgICAgIHZhciBiaW5kYWJsZSA9IHJlZ2lzdHJ5RW50cnkudGVtcGxhdGUuZ2V0QXR0cmlidXRlKCdiaW5kYWJsZScpO1xuICAgICAgICB2YXIgZWxlbWVudE5hbWUgPSBnZXRFbGVtZW50TmFtZShhZGRyZXNzKTtcblxuICAgICAgICBpZiAoYmluZGFibGUpIHtcbiAgICAgICAgICBiaW5kYWJsZSA9IGJpbmRhYmxlLnNwbGl0KCcsJykubWFwKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4geC50cmltKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmVnaXN0cnlFbnRyeS50ZW1wbGF0ZS5yZW1vdmVBdHRyaWJ1dGUoJ2JpbmRhYmxlJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYmluZGFibGUgPSBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBfcmVmID0ge30sIF9yZWZbZWxlbWVudE5hbWVdID0gKDAsIF9keW5hbWljRWxlbWVudC5fY3JlYXRlRHluYW1pY0VsZW1lbnQpKGVsZW1lbnROYW1lLCBhZGRyZXNzLCBiaW5kYWJsZSksIF9yZWY7XG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xufVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMvZGlzdC9jb21tb25qcy9odG1sLXJlc291cmNlLXBsdWdpbi5qc1xuICoqIG1vZHVsZSBpZCA9IDY1XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLl9jcmVhdGVEeW5hbWljRWxlbWVudCA9IF9jcmVhdGVEeW5hbWljRWxlbWVudDtcblxudmFyIF9hdXJlbGlhVGVtcGxhdGluZyA9IHJlcXVpcmUoJ2F1cmVsaWEtdGVtcGxhdGluZycpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfY3JlYXRlRHluYW1pY0VsZW1lbnQobmFtZSwgdmlld1VybCwgYmluZGFibGVOYW1lcykge1xuICB2YXIgX2RlYywgX2RlYzIsIF9jbGFzcztcblxuICB2YXIgRHluYW1pY0VsZW1lbnQgPSAoX2RlYyA9ICgwLCBfYXVyZWxpYVRlbXBsYXRpbmcuY3VzdG9tRWxlbWVudCkobmFtZSksIF9kZWMyID0gKDAsIF9hdXJlbGlhVGVtcGxhdGluZy51c2VWaWV3KSh2aWV3VXJsKSwgX2RlYyhfY2xhc3MgPSBfZGVjMihfY2xhc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRHluYW1pY0VsZW1lbnQoKSB7XG4gICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRHluYW1pY0VsZW1lbnQpO1xuICAgIH1cblxuICAgIER5bmFtaWNFbGVtZW50LnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gYmluZChiaW5kaW5nQ29udGV4dCkge1xuICAgICAgdGhpcy4kcGFyZW50ID0gYmluZGluZ0NvbnRleHQ7XG4gICAgfTtcblxuICAgIHJldHVybiBEeW5hbWljRWxlbWVudDtcbiAgfSgpKSB8fCBfY2xhc3MpIHx8IF9jbGFzcyk7XG5cbiAgZm9yICh2YXIgaSA9IDAsIGlpID0gYmluZGFibGVOYW1lcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XG4gICAgKDAsIF9hdXJlbGlhVGVtcGxhdGluZy5iaW5kYWJsZSkoYmluZGFibGVOYW1lc1tpXSkoRHluYW1pY0VsZW1lbnQpO1xuICB9XG4gIHJldHVybiBEeW5hbWljRWxlbWVudDtcbn1cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvY29tbW9uanMvZHluYW1pYy1lbGVtZW50LmpzXG4gKiogbW9kdWxlIGlkID0gNjZcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuY29uZmlndXJlID0gZXhwb3J0cy5Sb3V0ZUhyZWYgPSBleHBvcnRzLlJvdXRlclZpZXcgPSBleHBvcnRzLlRlbXBsYXRpbmdSb3V0ZUxvYWRlciA9IHVuZGVmaW5lZDtcblxudmFyIF9hdXJlbGlhUm91dGVyID0gcmVxdWlyZSgnYXVyZWxpYS1yb3V0ZXInKTtcblxudmFyIF9yb3V0ZUxvYWRlciA9IHJlcXVpcmUoJy4vcm91dGUtbG9hZGVyJyk7XG5cbnZhciBfcm91dGVyVmlldyA9IHJlcXVpcmUoJy4vcm91dGVyLXZpZXcnKTtcblxudmFyIF9yb3V0ZUhyZWYgPSByZXF1aXJlKCcuL3JvdXRlLWhyZWYnKTtcblxuZnVuY3Rpb24gY29uZmlndXJlKGNvbmZpZykge1xuICBjb25maWcuc2luZ2xldG9uKF9hdXJlbGlhUm91dGVyLlJvdXRlTG9hZGVyLCBfcm91dGVMb2FkZXIuVGVtcGxhdGluZ1JvdXRlTG9hZGVyKS5zaW5nbGV0b24oX2F1cmVsaWFSb3V0ZXIuUm91dGVyLCBfYXVyZWxpYVJvdXRlci5BcHBSb3V0ZXIpLmdsb2JhbFJlc291cmNlcygnLi9yb3V0ZXItdmlldycsICcuL3JvdXRlLWhyZWYnKTtcblxuICBjb25maWcuY29udGFpbmVyLnJlZ2lzdGVyQWxpYXMoX2F1cmVsaWFSb3V0ZXIuUm91dGVyLCBfYXVyZWxpYVJvdXRlci5BcHBSb3V0ZXIpO1xufVxuXG5leHBvcnRzLlRlbXBsYXRpbmdSb3V0ZUxvYWRlciA9IF9yb3V0ZUxvYWRlci5UZW1wbGF0aW5nUm91dGVMb2FkZXI7XG5leHBvcnRzLlJvdXRlclZpZXcgPSBfcm91dGVyVmlldy5Sb3V0ZXJWaWV3O1xuZXhwb3J0cy5Sb3V0ZUhyZWYgPSBfcm91dGVIcmVmLlJvdXRlSHJlZjtcbmV4cG9ydHMuY29uZmlndXJlID0gY29uZmlndXJlO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yb3V0ZXIvZGlzdC9jb21tb25qcy9hdXJlbGlhLXRlbXBsYXRpbmctcm91dGVyLmpzXG4gKiogbW9kdWxlIGlkID0gNjdcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuVGVtcGxhdGluZ1JvdXRlTG9hZGVyID0gdW5kZWZpbmVkO1xuXG52YXIgX2RlYywgX2NsYXNzO1xuXG52YXIgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uID0gcmVxdWlyZSgnYXVyZWxpYS1kZXBlbmRlbmN5LWluamVjdGlvbicpO1xuXG52YXIgX2F1cmVsaWFUZW1wbGF0aW5nID0gcmVxdWlyZSgnYXVyZWxpYS10ZW1wbGF0aW5nJyk7XG5cbnZhciBfYXVyZWxpYVJvdXRlciA9IHJlcXVpcmUoJ2F1cmVsaWEtcm91dGVyJyk7XG5cbnZhciBfYXVyZWxpYVBhdGggPSByZXF1aXJlKCdhdXJlbGlhLXBhdGgnKTtcblxudmFyIF9hdXJlbGlhTWV0YWRhdGEgPSByZXF1aXJlKCdhdXJlbGlhLW1ldGFkYXRhJyk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxudmFyIFRlbXBsYXRpbmdSb3V0ZUxvYWRlciA9IGV4cG9ydHMuVGVtcGxhdGluZ1JvdXRlTG9hZGVyID0gKF9kZWMgPSAoMCwgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uLmluamVjdCkoX2F1cmVsaWFUZW1wbGF0aW5nLkNvbXBvc2l0aW9uRW5naW5lKSwgX2RlYyhfY2xhc3MgPSBmdW5jdGlvbiAoX1JvdXRlTG9hZGVyKSB7XG4gIF9pbmhlcml0cyhUZW1wbGF0aW5nUm91dGVMb2FkZXIsIF9Sb3V0ZUxvYWRlcik7XG5cbiAgZnVuY3Rpb24gVGVtcGxhdGluZ1JvdXRlTG9hZGVyKGNvbXBvc2l0aW9uRW5naW5lKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRlbXBsYXRpbmdSb3V0ZUxvYWRlcik7XG5cbiAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfUm91dGVMb2FkZXIuY2FsbCh0aGlzKSk7XG5cbiAgICBfdGhpcy5jb21wb3NpdGlvbkVuZ2luZSA9IGNvbXBvc2l0aW9uRW5naW5lO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIFRlbXBsYXRpbmdSb3V0ZUxvYWRlci5wcm90b3R5cGUubG9hZFJvdXRlID0gZnVuY3Rpb24gbG9hZFJvdXRlKHJvdXRlciwgY29uZmlnKSB7XG4gICAgdmFyIGNoaWxkQ29udGFpbmVyID0gcm91dGVyLmNvbnRhaW5lci5jcmVhdGVDaGlsZCgpO1xuICAgIHZhciBpbnN0cnVjdGlvbiA9IHtcbiAgICAgIHZpZXdNb2RlbDogKDAsIF9hdXJlbGlhUGF0aC5yZWxhdGl2ZVRvRmlsZSkoY29uZmlnLm1vZHVsZUlkLCBfYXVyZWxpYU1ldGFkYXRhLk9yaWdpbi5nZXQocm91dGVyLmNvbnRhaW5lci52aWV3TW9kZWwuY29uc3RydWN0b3IpLm1vZHVsZUlkKSxcbiAgICAgIGNoaWxkQ29udGFpbmVyOiBjaGlsZENvbnRhaW5lcixcbiAgICAgIHZpZXc6IGNvbmZpZy52aWV3IHx8IGNvbmZpZy52aWV3U3RyYXRlZ3ksXG4gICAgICByb3V0ZXI6IHJvdXRlclxuICAgIH07XG5cbiAgICBjaGlsZENvbnRhaW5lci5nZXRDaGlsZFJvdXRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBjaGlsZFJvdXRlciA9IHZvaWQgMDtcblxuICAgICAgY2hpbGRDb250YWluZXIucmVnaXN0ZXJIYW5kbGVyKF9hdXJlbGlhUm91dGVyLlJvdXRlciwgZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgcmV0dXJuIGNoaWxkUm91dGVyIHx8IChjaGlsZFJvdXRlciA9IHJvdXRlci5jcmVhdGVDaGlsZChjaGlsZENvbnRhaW5lcikpO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBjaGlsZENvbnRhaW5lci5nZXQoX2F1cmVsaWFSb3V0ZXIuUm91dGVyKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHRoaXMuY29tcG9zaXRpb25FbmdpbmUuZW5zdXJlVmlld01vZGVsKGluc3RydWN0aW9uKTtcbiAgfTtcblxuICByZXR1cm4gVGVtcGxhdGluZ1JvdXRlTG9hZGVyO1xufShfYXVyZWxpYVJvdXRlci5Sb3V0ZUxvYWRlcikpIHx8IF9jbGFzcyk7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vYXVyZWxpYS10ZW1wbGF0aW5nLXJvdXRlci9kaXN0L2NvbW1vbmpzL3JvdXRlLWxvYWRlci5qc1xuICoqIG1vZHVsZSBpZCA9IDY4XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLlJvdXRlclZpZXcgPSB1bmRlZmluZWQ7XG5cbnZhciBfZGVjLCBfZGVjMiwgX2NsYXNzLCBfZGVzYywgX3ZhbHVlLCBfY2xhc3MyLCBfZGVzY3JpcHRvcjtcblxudmFyIF9hdXJlbGlhRGVwZW5kZW5jeUluamVjdGlvbiA9IHJlcXVpcmUoJ2F1cmVsaWEtZGVwZW5kZW5jeS1pbmplY3Rpb24nKTtcblxudmFyIF9hdXJlbGlhVGVtcGxhdGluZyA9IHJlcXVpcmUoJ2F1cmVsaWEtdGVtcGxhdGluZycpO1xuXG52YXIgX2F1cmVsaWFSb3V0ZXIgPSByZXF1aXJlKCdhdXJlbGlhLXJvdXRlcicpO1xuXG52YXIgX2F1cmVsaWFNZXRhZGF0YSA9IHJlcXVpcmUoJ2F1cmVsaWEtbWV0YWRhdGEnKTtcblxudmFyIF9hdXJlbGlhUGFsID0gcmVxdWlyZSgnYXVyZWxpYS1wYWwnKTtcblxuZnVuY3Rpb24gX2luaXREZWZpbmVQcm9wKHRhcmdldCwgcHJvcGVydHksIGRlc2NyaXB0b3IsIGNvbnRleHQpIHtcbiAgaWYgKCFkZXNjcmlwdG9yKSByZXR1cm47XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHByb3BlcnR5LCB7XG4gICAgZW51bWVyYWJsZTogZGVzY3JpcHRvci5lbnVtZXJhYmxlLFxuICAgIGNvbmZpZ3VyYWJsZTogZGVzY3JpcHRvci5jb25maWd1cmFibGUsXG4gICAgd3JpdGFibGU6IGRlc2NyaXB0b3Iud3JpdGFibGUsXG4gICAgdmFsdWU6IGRlc2NyaXB0b3IuaW5pdGlhbGl6ZXIgPyBkZXNjcmlwdG9yLmluaXRpYWxpemVyLmNhbGwoY29udGV4dCkgOiB2b2lkIDBcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIF9hcHBseURlY29yYXRlZERlc2NyaXB0b3IodGFyZ2V0LCBwcm9wZXJ0eSwgZGVjb3JhdG9ycywgZGVzY3JpcHRvciwgY29udGV4dCkge1xuICB2YXIgZGVzYyA9IHt9O1xuICBPYmplY3RbJ2tlJyArICd5cyddKGRlc2NyaXB0b3IpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgIGRlc2Nba2V5XSA9IGRlc2NyaXB0b3Jba2V5XTtcbiAgfSk7XG4gIGRlc2MuZW51bWVyYWJsZSA9ICEhZGVzYy5lbnVtZXJhYmxlO1xuICBkZXNjLmNvbmZpZ3VyYWJsZSA9ICEhZGVzYy5jb25maWd1cmFibGU7XG5cbiAgaWYgKCd2YWx1ZScgaW4gZGVzYyB8fCBkZXNjLmluaXRpYWxpemVyKSB7XG4gICAgZGVzYy53cml0YWJsZSA9IHRydWU7XG4gIH1cblxuICBkZXNjID0gZGVjb3JhdG9ycy5zbGljZSgpLnJldmVyc2UoKS5yZWR1Y2UoZnVuY3Rpb24gKGRlc2MsIGRlY29yYXRvcikge1xuICAgIHJldHVybiBkZWNvcmF0b3IodGFyZ2V0LCBwcm9wZXJ0eSwgZGVzYykgfHwgZGVzYztcbiAgfSwgZGVzYyk7XG5cbiAgaWYgKGNvbnRleHQgJiYgZGVzYy5pbml0aWFsaXplciAhPT0gdm9pZCAwKSB7XG4gICAgZGVzYy52YWx1ZSA9IGRlc2MuaW5pdGlhbGl6ZXIgPyBkZXNjLmluaXRpYWxpemVyLmNhbGwoY29udGV4dCkgOiB2b2lkIDA7XG4gICAgZGVzYy5pbml0aWFsaXplciA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGlmIChkZXNjLmluaXRpYWxpemVyID09PSB2b2lkIDApIHtcbiAgICBPYmplY3RbJ2RlZmluZScgKyAnUHJvcGVydHknXSh0YXJnZXQsIHByb3BlcnR5LCBkZXNjKTtcbiAgICBkZXNjID0gbnVsbDtcbiAgfVxuXG4gIHJldHVybiBkZXNjO1xufVxuXG5mdW5jdGlvbiBfaW5pdGlhbGl6ZXJXYXJuaW5nSGVscGVyKGRlc2NyaXB0b3IsIGNvbnRleHQpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdEZWNvcmF0aW5nIGNsYXNzIHByb3BlcnR5IGZhaWxlZC4gUGxlYXNlIGVuc3VyZSB0aGF0IHRyYW5zZm9ybS1jbGFzcy1wcm9wZXJ0aWVzIGlzIGVuYWJsZWQuJyk7XG59XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBTd2FwU3RyYXRlZ2llcyA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gU3dhcFN0cmF0ZWdpZXMoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN3YXBTdHJhdGVnaWVzKTtcbiAgfVxuXG4gIFN3YXBTdHJhdGVnaWVzLnByb3RvdHlwZS5iZWZvcmUgPSBmdW5jdGlvbiBiZWZvcmUodmlld1Nsb3QsIHByZXZpb3VzVmlldywgY2FsbGJhY2spIHtcbiAgICB2YXIgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZShjYWxsYmFjaygpKTtcblxuICAgIGlmIChwcmV2aW91c1ZpZXcgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB2aWV3U2xvdC5yZW1vdmUocHJldmlvdXNWaWV3LCB0cnVlKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBwcm9taXNlO1xuICB9O1xuXG4gIFN3YXBTdHJhdGVnaWVzLnByb3RvdHlwZS53aXRoID0gZnVuY3Rpb24gX3dpdGgodmlld1Nsb3QsIHByZXZpb3VzVmlldywgY2FsbGJhY2spIHtcbiAgICB2YXIgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZShjYWxsYmFjaygpKTtcblxuICAgIGlmIChwcmV2aW91c1ZpZXcgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFt2aWV3U2xvdC5yZW1vdmUocHJldmlvdXNWaWV3LCB0cnVlKSwgcHJvbWlzZV0pO1xuICAgIH1cblxuICAgIHJldHVybiBwcm9taXNlO1xuICB9O1xuXG4gIFN3YXBTdHJhdGVnaWVzLnByb3RvdHlwZS5hZnRlciA9IGZ1bmN0aW9uIGFmdGVyKHZpZXdTbG90LCBwcmV2aW91c1ZpZXcsIGNhbGxiYWNrKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2aWV3U2xvdC5yZW1vdmVBbGwodHJ1ZSkpLnRoZW4oY2FsbGJhY2spO1xuICB9O1xuXG4gIHJldHVybiBTd2FwU3RyYXRlZ2llcztcbn0oKTtcblxudmFyIHN3YXBTdHJhdGVnaWVzID0gbmV3IFN3YXBTdHJhdGVnaWVzKCk7XG5cbnZhciBSb3V0ZXJWaWV3ID0gZXhwb3J0cy5Sb3V0ZXJWaWV3ID0gKF9kZWMgPSAoMCwgX2F1cmVsaWFUZW1wbGF0aW5nLmN1c3RvbUVsZW1lbnQpKCdyb3V0ZXItdmlldycpLCBfZGVjMiA9ICgwLCBfYXVyZWxpYURlcGVuZGVuY3lJbmplY3Rpb24uaW5qZWN0KShfYXVyZWxpYVBhbC5ET00uRWxlbWVudCwgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uLkNvbnRhaW5lciwgX2F1cmVsaWFUZW1wbGF0aW5nLlZpZXdTbG90LCBfYXVyZWxpYVJvdXRlci5Sb3V0ZXIsIF9hdXJlbGlhVGVtcGxhdGluZy5WaWV3TG9jYXRvciwgX2F1cmVsaWFUZW1wbGF0aW5nLkNvbXBvc2l0aW9uVHJhbnNhY3Rpb24pLCBfZGVjKF9jbGFzcyA9ICgwLCBfYXVyZWxpYVRlbXBsYXRpbmcubm9WaWV3KShfY2xhc3MgPSBfZGVjMihfY2xhc3MgPSAoX2NsYXNzMiA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUm91dGVyVmlldyhlbGVtZW50LCBjb250YWluZXIsIHZpZXdTbG90LCByb3V0ZXIsIHZpZXdMb2NhdG9yLCBjb21wb3NpdGlvblRyYW5zYWN0aW9uKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJvdXRlclZpZXcpO1xuXG4gICAgX2luaXREZWZpbmVQcm9wKHRoaXMsICdzd2FwT3JkZXInLCBfZGVzY3JpcHRvciwgdGhpcyk7XG5cbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgIHRoaXMudmlld1Nsb3QgPSB2aWV3U2xvdDtcbiAgICB0aGlzLnJvdXRlciA9IHJvdXRlcjtcbiAgICB0aGlzLnZpZXdMb2NhdG9yID0gdmlld0xvY2F0b3I7XG4gICAgdGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uID0gY29tcG9zaXRpb25UcmFuc2FjdGlvbjtcbiAgICB0aGlzLnJvdXRlci5yZWdpc3RlclZpZXdQb3J0KHRoaXMsIHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ25hbWUnKSk7XG5cbiAgICBpZiAoISgnaW5pdGlhbENvbXBvc2l0aW9uJyBpbiBjb21wb3NpdGlvblRyYW5zYWN0aW9uKSkge1xuICAgICAgY29tcG9zaXRpb25UcmFuc2FjdGlvbi5pbml0aWFsQ29tcG9zaXRpb24gPSB0cnVlO1xuICAgICAgdGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uTm90aWZpZXIgPSBjb21wb3NpdGlvblRyYW5zYWN0aW9uLmVubGlzdCgpO1xuICAgIH1cbiAgfVxuXG4gIFJvdXRlclZpZXcucHJvdG90eXBlLmNyZWF0ZWQgPSBmdW5jdGlvbiBjcmVhdGVkKG93bmluZ1ZpZXcpIHtcbiAgICB0aGlzLm93bmluZ1ZpZXcgPSBvd25pbmdWaWV3O1xuICB9O1xuXG4gIFJvdXRlclZpZXcucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiBiaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcbiAgICB0aGlzLmNvbnRhaW5lci52aWV3TW9kZWwgPSBiaW5kaW5nQ29udGV4dDtcbiAgICB0aGlzLm92ZXJyaWRlQ29udGV4dCA9IG92ZXJyaWRlQ29udGV4dDtcbiAgfTtcblxuICBSb3V0ZXJWaWV3LnByb3RvdHlwZS5wcm9jZXNzID0gZnVuY3Rpb24gcHJvY2Vzcyh2aWV3UG9ydEluc3RydWN0aW9uLCB3YWl0VG9Td2FwKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIHZhciBjb21wb25lbnQgPSB2aWV3UG9ydEluc3RydWN0aW9uLmNvbXBvbmVudDtcbiAgICB2YXIgY2hpbGRDb250YWluZXIgPSBjb21wb25lbnQuY2hpbGRDb250YWluZXI7XG4gICAgdmFyIHZpZXdNb2RlbCA9IGNvbXBvbmVudC52aWV3TW9kZWw7XG4gICAgdmFyIHZpZXdNb2RlbFJlc291cmNlID0gY29tcG9uZW50LnZpZXdNb2RlbFJlc291cmNlO1xuICAgIHZhciBtZXRhZGF0YSA9IHZpZXdNb2RlbFJlc291cmNlLm1ldGFkYXRhO1xuXG4gICAgdmFyIHZpZXdTdHJhdGVneSA9IHRoaXMudmlld0xvY2F0b3IuZ2V0Vmlld1N0cmF0ZWd5KGNvbXBvbmVudC52aWV3IHx8IHZpZXdNb2RlbCk7XG4gICAgaWYgKHZpZXdTdHJhdGVneSkge1xuICAgICAgdmlld1N0cmF0ZWd5Lm1ha2VSZWxhdGl2ZVRvKF9hdXJlbGlhTWV0YWRhdGEuT3JpZ2luLmdldChjb21wb25lbnQucm91dGVyLmNvbnRhaW5lci52aWV3TW9kZWwuY29uc3RydWN0b3IpLm1vZHVsZUlkKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbWV0YWRhdGEubG9hZChjaGlsZENvbnRhaW5lciwgdmlld01vZGVsUmVzb3VyY2UudmFsdWUsIG51bGwsIHZpZXdTdHJhdGVneSwgdHJ1ZSkudGhlbihmdW5jdGlvbiAodmlld0ZhY3RvcnkpIHtcbiAgICAgIGlmICghX3RoaXMuY29tcG9zaXRpb25UcmFuc2FjdGlvbk5vdGlmaWVyKSB7XG4gICAgICAgIF90aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Pd25lcnNoaXBUb2tlbiA9IF90aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb24udHJ5Q2FwdHVyZSgpO1xuICAgICAgfVxuXG4gICAgICB2aWV3UG9ydEluc3RydWN0aW9uLmNvbnRyb2xsZXIgPSBtZXRhZGF0YS5jcmVhdGUoY2hpbGRDb250YWluZXIsIF9hdXJlbGlhVGVtcGxhdGluZy5CZWhhdmlvckluc3RydWN0aW9uLmR5bmFtaWMoX3RoaXMuZWxlbWVudCwgdmlld01vZGVsLCB2aWV3RmFjdG9yeSkpO1xuXG4gICAgICBpZiAod2FpdFRvU3dhcCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIF90aGlzLnN3YXAodmlld1BvcnRJbnN0cnVjdGlvbik7XG4gICAgfSk7XG4gIH07XG5cbiAgUm91dGVyVmlldy5wcm90b3R5cGUuc3dhcCA9IGZ1bmN0aW9uIHN3YXAodmlld1BvcnRJbnN0cnVjdGlvbikge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgdmFyIHdvcmsgPSBmdW5jdGlvbiB3b3JrKCkge1xuICAgICAgdmFyIHByZXZpb3VzVmlldyA9IF90aGlzMi52aWV3O1xuICAgICAgdmFyIHZpZXdTbG90ID0gX3RoaXMyLnZpZXdTbG90O1xuICAgICAgdmFyIHN3YXBTdHJhdGVneSA9IHZvaWQgMDtcblxuICAgICAgc3dhcFN0cmF0ZWd5ID0gX3RoaXMyLnN3YXBPcmRlciBpbiBzd2FwU3RyYXRlZ2llcyA/IHN3YXBTdHJhdGVnaWVzW190aGlzMi5zd2FwT3JkZXJdIDogc3dhcFN0cmF0ZWdpZXMuYWZ0ZXI7XG5cbiAgICAgIHN3YXBTdHJhdGVneSh2aWV3U2xvdCwgcHJldmlvdXNWaWV3LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodmlld1Nsb3QuYWRkKHZpZXdQb3J0SW5zdHJ1Y3Rpb24uY29udHJvbGxlci52aWV3KSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKF90aGlzMi5jb21wb3NpdGlvblRyYW5zYWN0aW9uTm90aWZpZXIpIHtcbiAgICAgICAgICAgIF90aGlzMi5jb21wb3NpdGlvblRyYW5zYWN0aW9uTm90aWZpZXIuZG9uZSgpO1xuICAgICAgICAgICAgX3RoaXMyLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Ob3RpZmllciA9IG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBfdGhpczIudmlldyA9IHZpZXdQb3J0SW5zdHJ1Y3Rpb24uY29udHJvbGxlci52aWV3O1xuICAgIH07XG5cbiAgICB2aWV3UG9ydEluc3RydWN0aW9uLmNvbnRyb2xsZXIuYXV0b21hdGUodGhpcy5vdmVycmlkZUNvbnRleHQsIHRoaXMub3duaW5nVmlldyk7XG5cbiAgICBpZiAodGhpcy5jb21wb3NpdGlvblRyYW5zYWN0aW9uT3duZXJzaGlwVG9rZW4pIHtcbiAgICAgIHJldHVybiB0aGlzLmNvbXBvc2l0aW9uVHJhbnNhY3Rpb25Pd25lcnNoaXBUb2tlbi53YWl0Rm9yQ29tcG9zaXRpb25Db21wbGV0ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpczIuY29tcG9zaXRpb25UcmFuc2FjdGlvbk93bmVyc2hpcFRva2VuID0gbnVsbDtcbiAgICAgICAgd29yaygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgd29yaygpO1xuICB9O1xuXG4gIHJldHVybiBSb3V0ZXJWaWV3O1xufSgpLCAoX2Rlc2NyaXB0b3IgPSBfYXBwbHlEZWNvcmF0ZWREZXNjcmlwdG9yKF9jbGFzczIucHJvdG90eXBlLCAnc3dhcE9yZGVyJywgW19hdXJlbGlhVGVtcGxhdGluZy5iaW5kYWJsZV0sIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgaW5pdGlhbGl6ZXI6IG51bGxcbn0pKSwgX2NsYXNzMikpIHx8IF9jbGFzcykgfHwgX2NsYXNzKSB8fCBfY2xhc3MpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2F1cmVsaWEtdGVtcGxhdGluZy1yb3V0ZXIvZGlzdC9jb21tb25qcy9yb3V0ZXItdmlldy5qc1xuICoqIG1vZHVsZSBpZCA9IDY5XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLlJvdXRlSHJlZiA9IHVuZGVmaW5lZDtcblxudmFyIF9kZWMsIF9kZWMyLCBfZGVjMywgX2RlYzQsIF9kZWM1LCBfY2xhc3M7XG5cbnZhciBfYXVyZWxpYVRlbXBsYXRpbmcgPSByZXF1aXJlKCdhdXJlbGlhLXRlbXBsYXRpbmcnKTtcblxudmFyIF9hdXJlbGlhRGVwZW5kZW5jeUluamVjdGlvbiA9IHJlcXVpcmUoJ2F1cmVsaWEtZGVwZW5kZW5jeS1pbmplY3Rpb24nKTtcblxudmFyIF9hdXJlbGlhUm91dGVyID0gcmVxdWlyZSgnYXVyZWxpYS1yb3V0ZXInKTtcblxudmFyIF9hdXJlbGlhUGFsID0gcmVxdWlyZSgnYXVyZWxpYS1wYWwnKTtcblxudmFyIF9hdXJlbGlhTG9nZ2luZyA9IHJlcXVpcmUoJ2F1cmVsaWEtbG9nZ2luZycpO1xuXG52YXIgTG9nTWFuYWdlciA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9hdXJlbGlhTG9nZ2luZyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBsb2dnZXIgPSBMb2dNYW5hZ2VyLmdldExvZ2dlcigncm91dGUtaHJlZicpO1xuXG52YXIgUm91dGVIcmVmID0gZXhwb3J0cy5Sb3V0ZUhyZWYgPSAoX2RlYyA9ICgwLCBfYXVyZWxpYVRlbXBsYXRpbmcuY3VzdG9tQXR0cmlidXRlKSgncm91dGUtaHJlZicpLCBfZGVjMiA9ICgwLCBfYXVyZWxpYVRlbXBsYXRpbmcuYmluZGFibGUpKHsgbmFtZTogJ3JvdXRlJywgY2hhbmdlSGFuZGxlcjogJ3Byb2Nlc3NDaGFuZ2UnIH0pLCBfZGVjMyA9ICgwLCBfYXVyZWxpYVRlbXBsYXRpbmcuYmluZGFibGUpKHsgbmFtZTogJ3BhcmFtcycsIGNoYW5nZUhhbmRsZXI6ICdwcm9jZXNzQ2hhbmdlJyB9KSwgX2RlYzQgPSAoMCwgX2F1cmVsaWFUZW1wbGF0aW5nLmJpbmRhYmxlKSh7IG5hbWU6ICdhdHRyaWJ1dGUnLCBkZWZhdWx0VmFsdWU6ICdocmVmJyB9KSwgX2RlYzUgPSAoMCwgX2F1cmVsaWFEZXBlbmRlbmN5SW5qZWN0aW9uLmluamVjdCkoX2F1cmVsaWFSb3V0ZXIuUm91dGVyLCBfYXVyZWxpYVBhbC5ET00uRWxlbWVudCksIF9kZWMoX2NsYXNzID0gX2RlYzIoX2NsYXNzID0gX2RlYzMoX2NsYXNzID0gX2RlYzQoX2NsYXNzID0gX2RlYzUoX2NsYXNzID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBSb3V0ZUhyZWYocm91dGVyLCBlbGVtZW50KSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJvdXRlSHJlZik7XG5cbiAgICB0aGlzLnJvdXRlciA9IHJvdXRlcjtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICB9XG5cbiAgUm91dGVIcmVmLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gYmluZCgpIHtcbiAgICB0aGlzLmlzQWN0aXZlID0gdHJ1ZTtcbiAgICB0aGlzLnByb2Nlc3NDaGFuZ2UoKTtcbiAgfTtcblxuICBSb3V0ZUhyZWYucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uIHVuYmluZCgpIHtcbiAgICB0aGlzLmlzQWN0aXZlID0gZmFsc2U7XG4gIH07XG5cbiAgUm91dGVIcmVmLnByb3RvdHlwZS5hdHRyaWJ1dGVDaGFuZ2VkID0gZnVuY3Rpb24gYXR0cmlidXRlQ2hhbmdlZCh2YWx1ZSwgcHJldmlvdXMpIHtcbiAgICBpZiAocHJldmlvdXMpIHtcbiAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUocHJldmlvdXMpO1xuICAgIH1cblxuICAgIHRoaXMucHJvY2Vzc0NoYW5nZSgpO1xuICB9O1xuXG4gIFJvdXRlSHJlZi5wcm90b3R5cGUucHJvY2Vzc0NoYW5nZSA9IGZ1bmN0aW9uIHByb2Nlc3NDaGFuZ2UoKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIHJldHVybiB0aGlzLnJvdXRlci5lbnN1cmVDb25maWd1cmVkKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIV90aGlzLmlzQWN0aXZlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIGhyZWYgPSBfdGhpcy5yb3V0ZXIuZ2VuZXJhdGUoX3RoaXMucm91dGUsIF90aGlzLnBhcmFtcyk7XG4gICAgICBfdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShfdGhpcy5hdHRyaWJ1dGUsIGhyZWYpO1xuICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIGxvZ2dlci5lcnJvcihyZWFzb24pO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiBSb3V0ZUhyZWY7XG59KCkpIHx8IF9jbGFzcykgfHwgX2NsYXNzKSB8fCBfY2xhc3MpIHx8IF9jbGFzcykgfHwgX2NsYXNzKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9hdXJlbGlhLXRlbXBsYXRpbmctcm91dGVyL2Rpc3QvY29tbW9uanMvcm91dGUtaHJlZi5qc1xuICoqIG1vZHVsZSBpZCA9IDcwXG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCJpbXBvcnQge2luamVjdH0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuaW1wb3J0IHtSb3V0ZXJ9IGZyb20gJ2F1cmVsaWEtcm91dGVyJztcbmltcG9ydCB7RXZlbnRBZ2dyZWdhdG9yfSBmcm9tICdhdXJlbGlhLWV2ZW50LWFnZ3JlZ2F0b3InO1xuaW1wb3J0IHtTYWlsc1NvY2tldENsaWVudH0gZnJvbSAnYXVyZWxpYS1zYWlscy1zb2NrZXQtY2xpZW50JztcblxuQGluamVjdChFdmVudEFnZ3JlZ2F0b3IsIFJvdXRlciwgU2FpbHNTb2NrZXRDbGllbnQpXG5leHBvcnQgY2xhc3MgSW5kZXgge1xuXG4gIGVudGl0eSA9IHtpZGVudGlmaWVyOiAnYWRtaW5AZXhhbXBsZS5jb20nLCBwYXNzd29yZDogJ2FkbWluMTIzNCd9O1xuXG4gIGNvbnN0cnVjdG9yKGV2ZW50QWdncmVnYXRvciwgcm91dGVyLCBzYWlscykge1xuICAgIHRoaXMuZWEgPSBldmVudEFnZ3JlZ2F0b3I7XG4gICAgdGhpcy5zYWlscyA9IHNhaWxzO1xuICAgIHRoaXMucm91dGVyID0gcm91dGVyO1xuICB9XG5cbiAgbG9naW4oKSB7XG4gICAgdGhpcy5zYWlscy5wb3N0KCcvYXV0aC9sb2NhbCcsIHRoaXMuZW50aXR5KVxuICAgICAgLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgIHRoaXMuZWEucHVibGlzaCgndWVyQXV0aGVudGljYXRlZCcsIGRhdGEuYm9keSk7XG4gICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKCcvJyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVycm9yID0+Y29uc29sZS5sb2coZXJyb3IpKTtcbiAgfVxufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvYXV0aC9pbmRleC5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGU+XFxuICA8IS0tIDxkaXYgdWktY2FyZCBjbGFzcz1cXFwiY2VudGVyZWRcXFwiPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJpbWFnZVxcXCI+XFxuXFxuICAgIDwvZGl2PlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJjb250ZW50XFxcIj5cXG4gICAgICA8YSBjbGFzcz1cXFwiaGVhZGVyXFxcIj5FbHlzZTwvYT5cXG4gICAgPC9kaXY+XFxuICA8L2Rpdj4gLS0+XFxuXFxuICA8IS0tIDxkaXYgY2xhc3M9XFxcInVpIGljb24gbWVzc2FnZVxcXCI+XFxuICAgIDxpIGNsYXNzPVxcXCJpbmJveCBpY29uXFxcIj48L2k+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbnRlbnRcXFwiPlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcImhlYWRlclxcXCI+XFxuICAgICAgICBIYXZlIHlvdSBoZWFyZCBhYm91dCBvdXIgbWFpbGluZyBsaXN0P1xcbiAgICAgIDwvZGl2PlxcbiAgICAgIDxwPkdldCB0aGUgYmVzdCBuZXdzIGluIHlvdXIgZS1tYWlsIGV2ZXJ5IGRheS48L3A+XFxuICAgIDwvZGl2PlxcbiAgPC9kaXY+XFxuXFxuICA8ZGl2IHVpLW1lc3NhZ2U9XFxcImljb246IGJsdWUgbG9hZGluZyBub3RjaGVkIGNpcmNsZVxcXCI+XFxuICAgIDxkaXYgY2xhc3M9XFxcImNvbnRlbnRcXFwiPlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcImhlYWRlclxcXCI+XFxuICAgICAgICBKdXN0IG9uZSBzZWNvbmRcXG4gICAgICA8L2Rpdj5cXG4gICAgICA8cD5XZSdyZSBmZXRjaGluZyB0aGF0IGNvbnRlbnQgZm9yIHlvdS48L3A+XFxuICAgIDwvZGl2PlxcbiAgPC9kaXY+XFxuXFxuICA8ZGl2IHVpLW1lc3NhZ2U9XFxcImljb24uYmluZDogbWVzc2FnZUljb25cXFwiIGNsYXNzPVxcXCJpY29uXFxcIj5cXG4gICAgPGkgY2xhc3M9XFxcInVpIGljb24gaW5ib3hcXFwiPjwvaT5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29udGVudFxcXCI+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwiaGVhZGVyXFxcIj5cXG4gICAgICAgIEhhdmUgeW91IGhlYXJkIGFib3V0IG91ciBtYWlsaW5nIGxpc3Q/XFxuICAgICAgPC9kaXY+XFxuICAgICAgPHA+R2V0IHRoZSBiZXN0IG5ld3MgaW4geW91ciBlLW1haWwgZXZlcnkgZGF5LjwvcD5cXG4gICAgPC9kaXY+XFxuICA8L2Rpdj5cXG5cXG4gIDxkaXYgdWktZHJvcGRvd249XFxcInNlbGVjdGlvbjogbWVzc2FnZUljb25cXFwiPlxcbiAgICA8aW5wdXQgbmFtZT1cXFwibWVzc2FnZUljb25cXFwiIHR5cGU9XFxcImhpZGRlblxcXCIgdmFsdWUuYmluZD1cXFwibWVzc2FnZUljb25cXFwiPlxcbiAgICA8aSBjbGFzcz1cXFwiZHJvcGRvd24gaWNvblxcXCI+PC9pPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJkZWZhdWx0IHRleHRcXFwiPk1lc3NhZ2UgSWNvbjwvZGl2PlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJtZW51XFxcIj5cXG4gICAgICA8ZGl2IGNsYXNzPVxcXCJpdGVtXFxcIiBkYXRhLXZhbHVlPVxcXCJpbmJveFxcXCI+SW5ib3g8L2Rpdj5cXG4gICAgICA8ZGl2IGNsYXNzPVxcXCJpdGVtXFxcIiBkYXRhLXZhbHVlPVxcXCJ0ZWFsIGxhYlxcXCI+TGFiPC9kaXY+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwiaXRlbVxcXCIgZGF0YS12YWx1ZT1cXFwicGF5bWVudFxcXCI+UGF5bWVudDwvZGl2PlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcIml0ZW1cXFwiIGRhdGEtdmFsdWU9XFxcImNhbGVuZGFyXFxcIj5DYWxlbmRhcjwvZGl2PlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcIml0ZW1cXFwiIGRhdGEtdmFsdWU9XFxcImhvcml6b250YWxseSBmbGlwcGVkIGNvbW1lbnRcXFwiPkNvbW1lbnQ8L2Rpdj5cXG4gICAgPC9kaXY+XFxuICA8L2Rpdj4gLS0+XFxuICA8ZGl2IGNsYXNzPVxcXCJ1aSBtaWRkbGUgYWxpZ25lZCBjZW50ZXIgYWxpZ25lZCBncmlkXFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwic2l4IHdpZGUgY29sdW1uXFxcIj5cXG4gICAgICA8aDIgY2xhc3M9XFxcInVpIHRlYWwgaW1hZ2UgaGVhZGVyXFxcIj5cXG5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcImNvbnRlbnRcXFwiPlxcbiAgICAgICAgICBMb2ctaW4gdG8geW91ciBhY2NvdW50XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2gyPlxcbiAgICAgIDxmb3JtIGNsYXNzPVxcXCJ1aSBsYXJnZSBmb3JtXFxcIiBzdWJtaXQuZGVsZWdhdGU9XFxcImxvZ2luKClcXFwiPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwidWkgc3RhY2tlZCBzZWdtZW50XFxcIj5cXG4gICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZmllbGRcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInVpIGxlZnQgaWNvbiBpbnB1dFxcXCI+XFxuICAgICAgICAgICAgICA8aSBjbGFzcz1cXFwidXNlciBpY29uXFxcIj48L2k+XFxuICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cXFwidGV4dFxcXCIgbmFtZT1cXFwiZW1haWxcXFwiIHZhbHVlLmJpbmQ9XFxcImVudGl0eS5pZGVudGlmaWVyXFxcIiBwbGFjZWhvbGRlcj1cXFwiRS1tYWlsIGFkZHJlc3NcXFwiPlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZmllbGRcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInVpIGxlZnQgaWNvbiBpbnB1dFxcXCI+XFxuICAgICAgICAgICAgICA8aSBjbGFzcz1cXFwibG9jayBpY29uXFxcIj48L2k+XFxuICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cXFwicGFzc3dvcmRcXFwiIG5hbWU9XFxcInBhc3N3b3JkXFxcIiB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkucGFzc3dvcmRcXFwiIHBsYWNlaG9sZGVyPVxcXCJQYXNzd29yZFxcXCI+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICA8YnV0dG9uIHR5cGU9XFxcInN1Ym1pdFxcXCIgY2xhc3M9XFxcInVpIGJ1dHRvbiBncmVlblxcXCI+TG9naW48L2J1dHRvbj5cXG4gICAgICAgIDwvZGl2PlxcblxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwidWkgZXJyb3IgbWVzc2FnZVxcXCI+PC9kaXY+XFxuXFxuICAgICAgPC9mb3JtPlxcblxcbiAgICAgIDxkaXYgY2xhc3M9XFxcInVpIG1lc3NhZ2VcXFwiPlxcbiAgICAgICAgTmV3IHRvIHVzPyA8YT5TaWduIFVwPC9hPlxcbiAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG4gIDwvZGl2PlxcbjwvdGVtcGxhdGU+XFxuXCI7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9hdXRoL2luZGV4Lmh0bWxcbiAqKiBtb2R1bGUgaWQgPSA3MlxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwidmFyIGNvbmZpZ0ZvckRldmVsb3BtZW50ID0ge1xuICBwcm92aWRlcnM6IHtcbiAgICBnb29nbGU6IHtcbiAgICAgIGNsaWVudElkOiAnMjM5NTMxODI2MDIzLWliazEwbWI5cDd1bGw1NGo1NWE2MW9nNWx2bmpyZmY2LmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tJ1xuICAgIH0vKlxuICAgICxcbiAgICBsaW5rZWRpbjp7XG4gICAgICBjbGllbnRJZDonNzc4bWlmOHp5cWJlaTcnXG4gICAgfSxcbiAgICBmYWNlYm9vazp7XG4gICAgICBjbGllbnRJZDonMTQ1Mjc4MjExMTcwODQ5OCdcbiAgICB9Ki9cbiAgfVxufTtcblxudmFyIGNvbmZpZ0ZvclByb2R1Y3Rpb24gPSB7XG4gIHByb3ZpZGVyczoge1xuICAgIGdvb2dsZToge1xuICAgICAgY2xpZW50SWQ6ICcyMzk1MzE4MjYwMjMtM2x1ZHUzOTM0cm1jcmEzb3FzY2MxZ2lkM2w5bzQ5N2kuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20nXG4gICAgfS8qXG4gICAgLFxuICAgIGxpbmtlZGluOntcbiAgICAgIGNsaWVudElkOic3NTYxOTU5dmR1YjR4MSdcbiAgICB9LFxuICAgIGZhY2Vib29rOntcbiAgICAgIGNsaWVudElkOicxNjUzOTA4OTE0ODMyNTA5J1xuICAgIH0qL1xuXG4gIH1cbn07XG52YXIgY29uZmlnIDtcbmlmICh3aW5kb3cubG9jYXRpb24uaG9zdG5hbWU9PT0nbG9jYWxob3N0Jykge1xuICBjb25maWcgPSBjb25maWdGb3JEZXZlbG9wbWVudDtcbn1cbmVsc2V7XG4gIGNvbmZpZyA9IGNvbmZpZ0ZvclByb2R1Y3Rpb247XG59XG5cblxuZXhwb3J0IGRlZmF1bHQgY29uZmlnO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvYXV0aENvbmZpZy5qc1xuICoqLyIsIi8qIC0qLSBqYXZhc2NyaXB0IC0qLSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQnJlYWRjcnVtYiAtIGh0dHA6Ly9zZW1hbnRpYy11aS5jb20vY29sbGVjdGlvbnMvYnJlYWRjcnVtYi5odG1sXG4gKi9cblxuaW1wb3J0IHtjb25zdGFudHN9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQge1VJQXR0cmlidXRlLCBiaW5kYWJsZVRvZ2dsZSwgYmluZGFibGVFbnVtfSBmcm9tICcuLi91aS1hdHRyaWJ1dGUnO1xuaW1wb3J0IHtpbmplY3QsIGN1c3RvbUF0dHJpYnV0ZSwgY2hpbGRyZW4sIGJpbmRhYmxlLCBMb2dNYW5hZ2VyfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9YnJlYWRjcnVtYmAgKVxuZXhwb3J0IGNsYXNzIFVJQnJlYWRjcnVtYkF0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcblxuXHRAYmluZGFibGUgZGl2aWRlcjtcblx0QGJpbmRhYmxlRW51bSgnc21hbGwnLCAnbGFyZ2UnLCAnaHVnZScpIHNpemU7XG5cdEBjaGlsZHJlbiggJ1t1aS1icmVhZGNydW1iLXNlY3Rpb25dJyApIHNlY3Rpb25zO1xuXG5cblx0YmluZCgpIHtcblx0XHRzdXBlci5iaW5kKCk7XG5cblx0XHRpZiAoIHRoaXMuZGl2aWRlciApIHtcblx0XHRcdGxldCBkaXZpZGVyTm9kZSA9IG51bGw7XG5cblx0XHRcdC8vIEljb24gZGl2aWRlciAoPGk+KVxuXHRcdFx0aWYgKCB0aGlzLmRpdmlkZXIubWF0Y2goL1xcYmljb25cXGIvKSApIHtcblx0XHRcdFx0dGhpcy5sb2dnZXIuZGVidWcoIGBJY29uIGRpdmlkZXIgKCR7dGhpcy5kaXZpZGVyfSlgICk7XG5cdFx0XHRcdGRpdmlkZXJOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2knICk7XG5cdFx0XHRcdGRpdmlkZXJOb2RlLmNsYXNzTGlzdC5hZGQoIC4uLnRoaXMuZGl2aWRlci5zcGxpdCgvXFxzKy8pICk7XG5cdFx0XHRcdGRpdmlkZXJOb2RlLmNsYXNzTGlzdC5hZGQoICdkaXZpZGVyJyApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBUZXh0IGRpdmlkZXIgKDxzcGFuPilcblx0XHRcdGVsc2Uge1xuXHRcdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZyggYFRleHQgZGl2aWRlciAoJHt0aGlzLmRpdmlkZXJ9KWAgKTtcblx0XHRcdFx0bGV0IGNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSggdGhpcy5kaXZpZGVyICk7XG5cdFx0XHRcdGRpdmlkZXJOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ3NwYW4nICk7XG5cdFx0XHRcdGRpdmlkZXJOb2RlLmNsYXNzTGlzdC5hZGQoICdkaXZpZGVyJyApO1xuXHRcdFx0XHRkaXZpZGVyTm9kZS5hcHBlbmRDaGlsZCggY29udGVudCApO1xuXHRcdFx0fVxuXG5cdFx0XHRmb3IgKCBsZXQgaSBpbiB0aGlzLnNlY3Rpb25zICkge1xuXHRcdFx0XHRpZiAoIGkgPiAwICkge1xuXHRcdFx0XHRcdGxldCBzZWN0aW9uID0gdGhpcy5zZWN0aW9uc1sgaSBdO1xuXHRcdFx0XHRcdHRoaXMuZWxlbWVudC5pbnNlcnRCZWZvcmUoIGRpdmlkZXJOb2RlLmNsb25lTm9kZSh0cnVlKSwgc2VjdGlvbiApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cbn1cblxuXG4vKipcbiAqIHVpLWJyZWFkY3J1bWItc2VjdGlvblxuICovXG5AY3VzdG9tQXR0cmlidXRlKCBgJHtjb25zdGFudHMuYXR0cmlidXRlUHJlZml4fWJyZWFkY3J1bWItc2VjdGlvbmAgKVxuZXhwb3J0IGNsYXNzIFVJQnJlYWRjcnVtYlNlY3Rpb25BdHRyaWJ1dGUgZXh0ZW5kcyBVSUF0dHJpYnV0ZSB7XG5cblx0QGJpbmRhYmxlVG9nZ2xlIGFjdGl2ZSA9IGZhbHNlO1xuXG5cdGJpbmQoKSB7XG5cdFx0Ly8gTm8gc3VwZXJcblx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCggJ3NlY3Rpb24nICk7XG5cdH1cblxufVxuXG5cbi8qKlxuICogdWktYnJlYWRjcnVtYi1kaXZpZGVyXG4gKi9cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9YnJlYWRjcnVtYi1kaXZpZGVyYCApXG5leHBvcnQgY2xhc3MgVUlCcmVhZGNydW1iRGl2aWRlckF0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcblxuXHRiaW5kKCkge1xuXHRcdC8vIE5vIHN1cGVyXG5cdFx0aWYgKCB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0ICkge1xuXHRcdFx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoICdkaXZpZGVyJyApO1xuXHRcdH1cblx0fVxuXG59XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9jb2xsZWN0aW9ucy91aS1icmVhZGNydW1iLmpzXG4gKiovIiwiLyogLSotIGphdmFzY3JpcHQgLSotICovXG5cInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0IGNvbnN0IGNvbnN0YW50cyA9IHtcblx0YXR0cmlidXRlUHJlZml4OiAndWktJyxcblx0ZWxlbWVudFByZWZpeDogJ3VpLScsXG5cdFZBTElEX1NJWkVTOiBbXG5cdFx0J21pbmknLFxuXHRcdCd0aW55Jyxcblx0XHQnc21hbGwnLFxuXHRcdCdtZWRpdW0nLFxuXHRcdCdsYXJnZScsXG5cdFx0J2JpZycsXG5cdFx0J2h1Z2UnLFxuXHRcdCdtYXNzaXZlJ1xuXHRdLFxuXHRWQUxJRF9DT0xPUlM6IFtcblx0XHQncmVkJyxcblx0XHQnb3JhbmdlJyxcblx0XHQneWVsbG93Jyxcblx0XHQnb2xpdmUnLFxuXHRcdCdncmVlbicsXG5cdFx0J3RlYWwnLFxuXHRcdCdibHVlJyxcblx0XHQndmlvbGV0Jyxcblx0XHQncHVycGxlJyxcblx0XHQncGluaycsXG5cdFx0J2Jyb3duJyxcblx0XHQnZ3JleScsXG5cdFx0J2JsYWNrJ1xuXHRdXG59O1xuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvY29uc3RhbnRzLmpzXG4gKiovIiwiLyogLSotIGphdmFzY3JpcHQgLSotICovXG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBVSUF0dHJpYnV0ZSAtLSBiYXNlIGNsYXNzIGZvciBTZW1hbnRpYyBVSSBhdHRyaWJ1dGVzXG4gKi9cblxuaW1wb3J0IHtpbmplY3QsIGJpbmRhYmxlLCBMb2dNYW5hZ2VyfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5cbmNvbnN0IFVJX0FUVFJJQlVURV9OQU1FID0gL1VJKFxcdyspQXR0cmlidXRlLztcblxuQGluamVjdCggRWxlbWVudCApXG5leHBvcnQgY2xhc3MgVUlBdHRyaWJ1dGUge1xuXG5cdGNvbnN0cnVjdG9yKCBlbGVtZW50ICkge1xuXHRcdHRoaXMubG9nZ2VyID0gTG9nTWFuYWdlci5nZXRMb2dnZXIoIHRoaXMuY29uc3RydWN0b3IubmFtZSApO1xuXHRcdHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG5cdH1cblxuXG5cdGJpbmQoKSB7XG5cdFx0bGV0IG5hbWVNYXRjaCA9IFVJX0FUVFJJQlVURV9OQU1FLmV4ZWMoIHRoaXMuY29uc3RydWN0b3IubmFtZSApO1xuXG5cdFx0aWYgKCBuYW1lTWF0Y2ggKSB7XG5cdFx0XHRsZXQgYXR0ck5hbWUgPSBuYW1lTWF0Y2hbIDEgXS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoICd1aScsIGF0dHJOYW1lICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMubG9nZ2VyLndhcm4oIFwiQXR0cmlidXRlIGNsYXNzIGRvZXNuJ3QgbWF0Y2ggdGhlIG5hbWluZyBjb252ZW50aW9uOyBcIixcblx0XHRcdFx0XCJhc3N1bWluZyBpdCdzIGdvaW5nIHRvIG1hbmFnZSB0aGUgY2xhc3NMaXN0IGl0c2VsZi5cIiApO1xuXHRcdH1cblx0fVxuXG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGJpbmRhYmxlRW51bSggLi4udmFsaWRWYWx1ZXMgKSB7XG5cdC8vIGNvbnNvbGUuZGVidWcoIFwiQmluZGFibGUgZW51bSBkZWNvcmF0b3IgY2FsbGVkIHdpdGg6IFwiLCB2YWxpZFZhbHVlcyApO1xuXHRyZXR1cm4gZnVuY3Rpb24oIHRhcmdldCwgbmFtZSwgZGVzY3JpcHRvciApIHtcblx0XHRsZXQgY2hhbmdlZE1ldGhvZE5hbWUgPSBgJHtuYW1lfUNoYW5nZWRgO1xuXHRcdC8vIGNvbnNvbGUuZGVidWcoIFwiU2V0dGluZyB1cCBhIFwiLCBjaGFuZ2VkTWV0aG9kTmFtZSwgXCIgbWV0aG9kIG9uIFwiLCB0YXJnZXQgKTtcblx0XHR0YXJnZXRbIGNoYW5nZWRNZXRob2ROYW1lIF0gPSBmdW5jdGlvbiggbmV3VmFsdWUsIG9sZFZhbHVlICkge1xuXHRcdFx0dGhpcy5sb2dnZXIuZGVidWcoIGBDaGFuZ2luZyAke25hbWV9IHRvICR7bmV3VmFsdWV9IGZyb20gJHtvbGRWYWx1ZX1gICk7XG5cdFx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSggb2xkVmFsdWUgKTtcblx0XHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCBuZXdWYWx1ZSApO1xuXHRcdH07XG5cblx0XHRsZXQgb3JpZ2luYWxCaW5kID0gdGFyZ2V0LmJpbmQ7XG5cdFx0dGFyZ2V0LmJpbmQgPSBmdW5jdGlvbiggLi4uYXJncyApIHtcblx0XHRcdFJlZmxlY3QuYXBwbHkoIG9yaWdpbmFsQmluZCwgdGhpcywgYXJncyApO1xuXHRcdFx0aWYgKCB0aGlzW25hbWVdICkge1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCggdGhpc1tuYW1lXSApO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHRyZXR1cm4gYmluZGFibGUoIHRhcmdldCwgbmFtZSwgZGVzY3JpcHRvciApO1xuXHR9O1xufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBiaW5kYWJsZVRvZ2dsZSggdGFyZ2V0LCBuYW1lLCBkZXNjcmlwdG9yICkge1xuXHQvLyBjb25zb2xlLmRlYnVnKCBcIkJpbmRhYmxlIHRvZ2dsZSBkZWNvcmF0b3IgY2FsbGVkIHdpdGggYXJnczogXCIsIHRhcmdldCwgbmFtZSwgZGVzY3JpcHRvciApO1xuXHRsZXQgY2hhbmdlZE1ldGhvZE5hbWUgPSBgJHtuYW1lfUNoYW5nZWRgO1xuXHQvLyBjb25zb2xlLmRlYnVnKCBcIlNldHRpbmcgdXAgYSBcIiwgY2hhbmdlZE1ldGhvZE5hbWUsIFwiIG1ldGhvZCBvbiBcIiwgdGFyZ2V0ICk7XG5cdHRhcmdldFsgY2hhbmdlZE1ldGhvZE5hbWUgXSA9IGZ1bmN0aW9uKCBuZXdWYWx1ZSApIHtcblx0XHR0aGlzLmxvZ2dlci5kZWJ1ZyggYFRvZ2dsaW5nICR7bmFtZX0gdG8gJHtuZXdWYWx1ZSA/ICdvbicgOiAnb2ZmJ30uYCApO1xuXHRcdGlmICggbmV3VmFsdWUgKSB7IHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKG5hbWUpOyB9XG5cdFx0ZWxzZSB7IHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKG5hbWUpOyB9XG5cdH07XG5cblx0bGV0IG9yaWdpbmFsQmluZCA9IHRhcmdldC5iaW5kO1xuXHR0YXJnZXQuYmluZCA9IGZ1bmN0aW9uKCAuLi5hcmdzICkge1xuXHRcdFJlZmxlY3QuYXBwbHkoIG9yaWdpbmFsQmluZCwgdGhpcywgYXJncyApO1xuXHRcdGlmICggdGhpc1tuYW1lXSApIHtcblx0XHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCBuYW1lICk7XG5cdFx0fVxuXHR9O1xuXG5cdHJldHVybiBiaW5kYWJsZSggdGFyZ2V0LCBuYW1lLCBkZXNjcmlwdG9yICk7XG59XG5cblxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL3VpLWF0dHJpYnV0ZS5qc1xuICoqLyIsIi8qIC0qLSBqYXZhc2NyaXB0IC0qLSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogRm9ybSAtIGh0dHA6Ly9zZW1hbnRpYy11aS5jb20vY29sbGVjdGlvbnMvZm9ybS5odG1sXG4gKi9cblxuaW1wb3J0IHtjb25zdGFudHN9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQge1VJQXR0cmlidXRlLCBiaW5kYWJsZVRvZ2dsZSwgYmluZGFibGVFbnVtfSBmcm9tICcuLi91aS1hdHRyaWJ1dGUnO1xuaW1wb3J0IHtpbmplY3QsIGN1c3RvbUF0dHJpYnV0ZSwgY2hpbGRyZW4sIGJpbmRhYmxlfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9Zm9ybWAgKVxuZXhwb3J0IGNsYXNzIFVJRm9ybUF0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcblxuXHRAYmluZGFibGVUb2dnbGUgbG9hZGluZyA9IGZhbHNlO1xuXHRAYmluZGFibGVUb2dnbGUgZXJyb3I7XG5cdEBiaW5kYWJsZVRvZ2dsZSBzdWNjZXNzO1xuXHRAYmluZGFibGVUb2dnbGUgd2FybmluZztcblxuXHRAY2hpbGRyZW4oICcuZmllbGQnICkgZmllbGRzO1xuXG59XG5cblxuQGN1c3RvbUF0dHJpYnV0ZSggYCR7Y29uc3RhbnRzLmF0dHJpYnV0ZVByZWZpeH1jaGVja2JveGAgKVxuZXhwb3J0IGNsYXNzIFVJQ2hlY2tib3hBdHRyaWJ1dGUgZXh0ZW5kcyBVSUF0dHJpYnV0ZSB7XG5cblx0YXR0YWNoZWQoKSB7XG5cdFx0dGhpcy5sb2dnZXIuZGVidWcoIFwiQWN0aXZhdGluZyBhIHVpLWNoZWNrYm94XCIgKTtcblx0XHQkKCB0aGlzLmVsZW1lbnQgKS5jaGVja2JveCgpO1xuXHR9XG5cbn1cblxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvY29sbGVjdGlvbnMvdWktZm9ybS5qc1xuICoqLyIsIi8qIC0qLSBqYXZhc2NyaXB0IC0qLSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogR3JpZCAtIGh0dHA6Ly9zZW1hbnRpYy11aS5jb20vY29sbGVjdGlvbnMvZ3JpZC5odG1sXG4gKi9cblxuaW1wb3J0IHtjb25zdGFudHN9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQge1VJQXR0cmlidXRlLCBiaW5kYWJsZVRvZ2dsZSwgYmluZGFibGVFbnVtfSBmcm9tICcuLi91aS1hdHRyaWJ1dGUnO1xuaW1wb3J0IHtpbmplY3QsIGN1c3RvbUF0dHJpYnV0ZSwgY2hpbGRyZW4sIGJpbmRhYmxlfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9Z3JpZGAgKVxuZXhwb3J0IGNsYXNzIFVJR3JpZEF0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcblxuXHRAY2hpbGRyZW4oICcuY29sdW1uJyApIGNvbHVtbnM7XG5cbn1cblxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvY29sbGVjdGlvbnMvdWktZ3JpZC5qc1xuICoqLyIsIi8qIC0qLSBqYXZhc2NyaXB0IC0qLSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogTWVudSAtIGh0dHA6Ly9zZW1hbnRpYy11aS5jb20vY29sbGVjdGlvbnMvbWVudS5odG1sXG4gKi9cblxuaW1wb3J0IHtjb25zdGFudHN9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQge1VJQXR0cmlidXRlLCBiaW5kYWJsZVRvZ2dsZSwgYmluZGFibGVFbnVtfSBmcm9tICcuLi91aS1hdHRyaWJ1dGUnO1xuaW1wb3J0IHtpbmplY3QsIGN1c3RvbUF0dHJpYnV0ZSwgY2hpbGRyZW4sIGJpbmRhYmxlfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9bWVudWAgKVxuZXhwb3J0IGNsYXNzIFVJTWVudUF0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcblxuXHRAYmluZGFibGUgcm91dGVyO1xuXHRAY2hpbGRyZW4oICdbdWktbWVudS1pdGVtXScgKSBpdGVtcztcblxuXG5cdGlzU3VibWVudSgpIHtcblx0XHRsZXQgcGFyZW50ID0gdGhpcy5lbGVtZW50LnBhcmVudEVsZW1lbnQ7XG5cdFx0aWYgKCAhcGFyZW50ICkgeyByZXR1cm4gZmFsc2U7IH1cblxuXHRcdGxldCBjbGFzc2VzID0gcGFyZW50LmNsYXNzTGlzdFxuXHRcdGlmICggIWNsYXNzZXMgKSB7IHJldHVybiBmYWxzZTsgfVxuXG5cdFx0cmV0dXJuIChjbGFzc2VzLmNvbnRhaW5zKCdpdGVtJykgfHwgY2xhc3Nlcy5jb250YWlucygnbWVudScpKVxuXHR9XG5cblxuXHRiaW5kKCkge1xuXHRcdC8vIERvbid0IHN1cGVyIGZvciBzdWItbWVudXMgYmVjYXVzZSB0aGV5IHNob3VsZG4ndCBnZXQgdGhlICd1aSdcblx0XHRpZiAoIHRoaXMuaXNTdWJtZW51KCkgKSB7XG5cdFx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCggJ21lbnUnICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHN1cGVyLmJpbmQoKTtcblx0XHR9XG5cdH1cblxufVxuXG5cbi8qKlxuICogdWktbWVudS1pdGVtXG4gKi9cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9bWVudS1pdGVtYCApXG5leHBvcnQgY2xhc3MgVUlNZW51SXRlbUF0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcblxuXHRAYmluZGFibGVUb2dnbGUgYWN0aXZlID0gZmFsc2U7XG5cblx0YmluZCgpIHtcblx0XHQvLyBubyBzdXBlclxuXHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCAnaXRlbScgKTtcblx0fVxuXG59XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9jb2xsZWN0aW9ucy91aS1tZW51LmpzXG4gKiovIiwiLyogLSotIGphdmFzY3JpcHQgLSotICovXG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBNZXNzYWdlIC0gaHR0cDovL3NlbWFudGljLXVpLmNvbS9jb2xsZWN0aW9ucy9tZXNzYWdlLmh0bWxcbiAqL1xuXG5pbXBvcnQge2NvbnN0YW50c30gZnJvbSAnLi4vY29uc3RhbnRzJztcbmltcG9ydCB7VUlBdHRyaWJ1dGUsIGJpbmRhYmxlVG9nZ2xlLCBiaW5kYWJsZUVudW19IGZyb20gJy4uL3VpLWF0dHJpYnV0ZSc7XG5pbXBvcnQge2luamVjdCwgY2hpbGQsIGN1c3RvbUF0dHJpYnV0ZSwgY2hpbGRyZW4sIGJpbmRhYmxlfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9bWVzc2FnZWAgKVxuZXhwb3J0IGNsYXNzIFVJTWVzc2FnZUF0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcblxuXHRAYmluZGFibGUgaWNvbjtcblx0QGNoaWxkKCAnaS51aS5pY29uJyApIGljb25FbGVtZW50O1xuXG5cblx0YmluZCggLi4uYXJncyApIHtcblx0XHRzdXBlci5iaW5kKCAuLi5hcmdzICk7XG5cdFx0aWYgKCB0aGlzLmljb24gKSB7XG5cdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZyggYEFkZGluZyAnaWNvbicgdG8gdGhlIGxpc3Qgb2YgY2xhc3Nlcy5gICk7XG5cdFx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaWNvbicpO1xuXHRcdH1cblx0fVxuXG5cblx0YXR0YWNoZWQoKSB7XG5cdFx0dGhpcy5sb2dnZXIuZGVidWcoIFwiQXR0YWNoaW5nIGEgdWktbWVzc2FnZS4gSWNvbiBlbGVtZW50IGlzOiBcIiwgdGhpcy5pY29uRWxlbWVudCApO1xuXG5cdFx0Ly8gSW5qZWN0IHRoZSBpY29uIGlmIGl0J3Mgc2V0IGJ1dCBub3QgYWxyZWFkeSB0aGVyZVxuXHRcdGlmICggdGhpcy5pY29uICYmICF0aGlzLmljb25FbGVtZW50ICkge1xuXHRcdFx0dGhpcy5sb2dnZXIuZGVidWcoIGBDcmVhdGluZyBhICR7dGhpcy5pY29ufSBpY29uIGZvciBgLCB0aGlzLmVsZW1lbnQgKTtcblx0XHRcdGxldCBpY29uTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdpJyApO1xuXHRcdFx0aWNvbk5vZGUuY2xhc3NMaXN0LmFkZCggJ3VpJywgJ2ljb24nICk7XG5cdFx0XHRpY29uTm9kZS5jbGFzc0xpc3QuYWRkKCAuLi50aGlzLmljb24uc3BsaXQoJyAnKSApO1xuXHRcdFx0dGhpcy5lbGVtZW50Lmluc2VydEJlZm9yZSggaWNvbk5vZGUsIHRoaXMuZWxlbWVudC5maXJzdENoaWxkICk7XG5cdFx0XHR0aGlzLmljb25FbGVtZW50ID0gaWNvbk5vZGU7XG5cdFx0fVxuXHR9XG5cblxuXHRpY29uQ2hhbmdlZCggbmV3VmFsdWUsIG9sZFZhbHVlICkge1xuXHRcdGlmICggdGhpcy5pY29uRWxlbWVudCApIHtcblx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCBgU3dhcHBpbmcgaWNvbiBvZiAke3RoaXMuaWNvbkVsZW1lbnR9IHRvICR7bmV3VmFsdWV9IGZyb20gJHtvbGRWYWx1ZX1gICk7XG5cdFx0XHRpZiAoIG9sZFZhbHVlICkgeyB0aGlzLmljb25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoLi4ub2xkVmFsdWUuc3BsaXQoJyAnKSk7IH1cblx0XHRcdGlmICggbmV3VmFsdWUgKSB7IHRoaXMuaWNvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCguLi5uZXdWYWx1ZS5zcGxpdCgnICcpKTsgfVxuXHRcdH1cblx0fVxuXG59XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9jb2xsZWN0aW9ucy91aS1tZXNzYWdlLmpzXG4gKiovIiwiLyogLSotIGphdmFzY3JpcHQgLSotICovXG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBUYWJsZSAtIGh0dHA6Ly9zZW1hbnRpYy11aS5jb20vY29sbGVjdGlvbnMvdGFibGUuaHRtbFxuICovXG5cbmltcG9ydCB7Y29uc3RhbnRzfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtVSUF0dHJpYnV0ZSwgYmluZGFibGVUb2dnbGUsIGJpbmRhYmxlRW51bX0gZnJvbSAnLi4vdWktYXR0cmlidXRlJztcbmltcG9ydCB7aW5qZWN0LCBjaGlsZCwgY3VzdG9tQXR0cmlidXRlLCBjaGlsZHJlbiwgYmluZGFibGV9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcblxuQGN1c3RvbUF0dHJpYnV0ZSggYCR7Y29uc3RhbnRzLmF0dHJpYnV0ZVByZWZpeH10YWJsZWAgKVxuZXhwb3J0IGNsYXNzIFVJVGFibGVBdHRyaWJ1dGUgZXh0ZW5kcyBVSUF0dHJpYnV0ZSB7XG59XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9jb2xsZWN0aW9ucy91aS10YWJsZS5qc1xuICoqLyIsIi8qIC0qLSBqYXZhc2NyaXB0IC0qLSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQnV0dG9uIC0gaHR0cDovL3NlbWFudGljLXVpLmNvbS9lbGVtZW50cy9idXR0b24uaHRtbFxuICovXG5cbmltcG9ydCB7Y29uc3RhbnRzfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtVSUF0dHJpYnV0ZSwgYmluZGFibGVUb2dnbGUsIGJpbmRhYmxlRW51bX0gZnJvbSAnLi4vdWktYXR0cmlidXRlJztcbmltcG9ydCB7Y3VzdG9tQXR0cmlidXRlLCBpbmplY3QsIGNoaWxkLCBiaW5kYWJsZX0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuXG5AY3VzdG9tQXR0cmlidXRlKCBgJHtjb25zdGFudHMuYXR0cmlidXRlUHJlZml4fWJ1dHRvbmAgKVxuZXhwb3J0IGNsYXNzIFVJQnV0dG9uQXR0cmlidXRlIGV4dGVuZHMgVUlBdHRyaWJ1dGUge1xuXG5cdEBiaW5kYWJsZSBpY29uO1xuXHRAYmluZGFibGVFbnVtKCAuLi5jb25zdGFudHMuVkFMSURfQ09MT1JTICkgY29sb3I7XG5cdEBiaW5kYWJsZVRvZ2dsZSBkaXNhYmxlZDtcblxuXHRAY2hpbGQoICdpLnVpLmljb24nICkgaWNvbkVsZW1lbnQ7XG5cblxuXHRiaW5kKCAuLi5hcmdzICkge1xuXHRcdHN1cGVyLmJpbmQoIC4uLmFyZ3MgKTtcblx0XHRpZiAoIHRoaXMuaWNvbiApIHtcblx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCBgQWRkaW5nICdpY29uJyB0byB0aGUgbGlzdCBvZiBjbGFzc2VzLmAgKTtcblx0XHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdpY29uJyk7XG5cdFx0fVxuXHR9XG5cblxuXHRhdHRhY2hlZCgpIHtcblx0XHQvLyBJbmplY3QgdGhlIGljb24gaWYgaXQncyBzZXQgYnV0IG5vdCBhbHJlYWR5IHRoZXJlXG5cdFx0aWYgKCB0aGlzLmljb24gJiYgIXRoaXMuaWNvbkVsZW1lbnQgKSB7XG5cdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZyggYENyZWF0aW5nIGEgJHt0aGlzLmljb259IGljb24gZm9yIGAsIHRoaXMuZWxlbWVudCApO1xuXHRcdFx0bGV0IGljb25Ob2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2knICk7XG5cdFx0XHRpY29uTm9kZS5jbGFzc0xpc3QuYWRkKCAndWknLCAnaWNvbicgKTtcblx0XHRcdGljb25Ob2RlLmNsYXNzTGlzdC5hZGQoIC4uLnRoaXMuaWNvbi5zcGxpdCgnICcpICk7XG5cdFx0XHR0aGlzLmVsZW1lbnQuaW5zZXJ0QmVmb3JlKCBpY29uTm9kZSwgdGhpcy5lbGVtZW50LmZpcnN0Q2hpbGQgKTtcblx0XHRcdHRoaXMuaWNvbkVsZW1lbnQgPSBpY29uTm9kZTtcblx0XHR9XG5cdH1cblxuXG5cdGljb25DaGFuZ2VkKCBuZXdWYWx1ZSwgb2xkVmFsdWUgKSB7XG5cdFx0aWYgKCB0aGlzLmljb25FbGVtZW50ICkge1xuXHRcdFx0dGhpcy5sb2dnZXIuZGVidWcoIGBTd2FwcGluZyBpY29uIG9mICR7dGhpcy5pY29uRWxlbWVudH0gdG8gJHtuZXdWYWx1ZX0gZnJvbSAke29sZFZhbHVlfWAgKTtcblx0XHRcdGlmICggb2xkVmFsdWUgKSB7IHRoaXMuaWNvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSguLi5vbGRWYWx1ZS5zcGxpdCgnICcpKTsgfVxuXHRcdFx0aWYgKCBuZXdWYWx1ZSApIHsgdGhpcy5pY29uRWxlbWVudC5jbGFzc0xpc3QuYWRkKC4uLm5ld1ZhbHVlLnNwbGl0KCcgJykpOyB9XG5cdFx0fVxuXHR9XG5cbn1cblxuXG5AY3VzdG9tQXR0cmlidXRlKCBgJHtjb25zdGFudHMuYXR0cmlidXRlUHJlZml4fWJ1dHRvbnNgIClcbmV4cG9ydCBjbGFzcyBVSUJ1dHRvbnNBdHRyaWJ1dGUgZXh0ZW5kcyBVSUF0dHJpYnV0ZSB7XG59XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWJ1dHRvbi5qc1xuICoqLyIsIi8qIC0qLSBqYXZhc2NyaXB0IC0qLSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQ29udGFpbmVyIC0gaHR0cDovL3NlbWFudGljLXVpLmNvbS9lbGVtZW50cy9jb250YWluZXIuaHRtbFxuICovXG5cbmltcG9ydCB7Y29uc3RhbnRzfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtVSUF0dHJpYnV0ZX0gZnJvbSAnLi4vdWktYXR0cmlidXRlJztcbmltcG9ydCB7Y3VzdG9tQXR0cmlidXRlfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9Y29udGFpbmVyYCApXG5leHBvcnQgY2xhc3MgVUlDb250YWluZXJBdHRyaWJ1dGUgZXh0ZW5kcyBVSUF0dHJpYnV0ZSB7XG59XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1jb250YWluZXIuanNcbiAqKi8iLCIvKiAtKi0gamF2YXNjcmlwdCAtKi0gKi9cblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIERpdmlkZXIgLSBodHRwOi8vc2VtYW50aWMtdWkuY29tL2VsZW1lbnRzL2RpdmlkZXIuaHRtbFxuICovXG5cbmltcG9ydCB7Y29uc3RhbnRzfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtVSUF0dHJpYnV0ZX0gZnJvbSAnLi4vdWktYXR0cmlidXRlJztcbmltcG9ydCB7Y3VzdG9tQXR0cmlidXRlfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9ZGl2aWRlcmAgKVxuZXhwb3J0IGNsYXNzIFVJRGl2aWRlckF0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcbn1cblxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWRpdmlkZXIuanNcbiAqKi8iLCIvKiAtKi0gamF2YXNjcmlwdCAtKi0gKi9cblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIEZsYWcgLSBodHRwOi8vc2VtYW50aWMtdWkuY29tL2VsZW1lbnRzL2ZsYWcuaHRtbFxuICovXG5cbmltcG9ydCB7Y29uc3RhbnRzfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtVSUF0dHJpYnV0ZX0gZnJvbSAnLi4vdWktYXR0cmlidXRlJztcbmltcG9ydCB7Y3VzdG9tQXR0cmlidXRlLCBiaW5kYWJsZX0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuXG5AY3VzdG9tQXR0cmlidXRlKCBgJHtjb25zdGFudHMuYXR0cmlidXRlUHJlZml4fWZsYWdgIClcbmV4cG9ydCBjbGFzcyBVSUZsYWdBdHRyaWJ1dGUgZXh0ZW5kcyBVSUF0dHJpYnV0ZSB7XG5cbiAgICBAYmluZGFibGUgY291bnRyeTtcblxuXG4gICAgYmluZCggLi4uYXJncyApIHtcbiAgICAgICAgc3VwZXIuYmluZCggLi4uYXJncyApO1xuICAgICAgICBpZiAoIHRoaXMuY291bnRyeSApIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCAuLi50aGlzLmNvdW50cnkuc3BsaXQoJyAnKSApO1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICBjb3VudHJ5Q2hhbmdlZCggbmV3VmFsdWUsIG9sZFZhbHVlICkge1xuICAgICAgICBpZiAoIG9sZFZhbHVlICkgeyB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSguLi5vbGRWYWx1ZS5zcGxpdCgnICcpKTsgfVxuICAgICAgICBpZiAoIG5ld1ZhbHVlICkgeyB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCguLi5uZXdWYWx1ZS5zcGxpdCgnICcpKTsgfVxuICAgIH1cblxufVxuXG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1mbGFnLmpzXG4gKiovIiwiLyogLSotIGphdmFzY3JpcHQgLSotICovXG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBDb250ZW50IEhlYWRlciAtIGh0dHA6Ly9zZW1hbnRpYy11aS5jb20vZWxlbWVudHMvaGVhZGVyLmh0bWwjY29udGVudC1oZWFkZXJzXG4gKi9cblxuaW1wb3J0IHtjb25zdGFudHN9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQge1VJQXR0cmlidXRlLCBiaW5kYWJsZUVudW19IGZyb20gJy4uL3VpLWF0dHJpYnV0ZSc7XG5pbXBvcnQge2N1c3RvbUF0dHJpYnV0ZX0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuXG5AY3VzdG9tQXR0cmlidXRlKCBgJHtjb25zdGFudHMuYXR0cmlidXRlUHJlZml4fWhlYWRlcmAgKVxuZXhwb3J0IGNsYXNzIFVJSGVhZGVyQXR0cmlidXRlIGV4dGVuZHMgVUlBdHRyaWJ1dGUge1xuXG5cdEBiaW5kYWJsZUVudW0oIC4uLmNvbnN0YW50cy5WQUxJRF9TSVpFUyApIHNpemU7XG5cdEBiaW5kYWJsZUVudW0oIC4uLmNvbnN0YW50cy5WQUxJRF9DT0xPUlMgKSBjb2xvcjtcblxufVxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktaGVhZGVyLmpzXG4gKiovIiwiLyogLSotIGphdmFzY3JpcHQgLSotICovXG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBJY29uIC0gaHR0cDovL3NlbWFudGljLXVpLmNvbS9lbGVtZW50cy9pY29uLmh0bWwjL2RlZmluaXRpb25cbiAqL1xuXG5pbXBvcnQge2NvbnN0YW50c30gZnJvbSAnLi4vY29uc3RhbnRzJztcbmltcG9ydCB7VUlBdHRyaWJ1dGUsIGJpbmRhYmxlVG9nZ2xlLCBiaW5kYWJsZUVudW19IGZyb20gJy4uL3VpLWF0dHJpYnV0ZSc7XG5pbXBvcnQge2N1c3RvbUF0dHJpYnV0ZSwgYmluZGFibGV9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcblxuXG5AY3VzdG9tQXR0cmlidXRlKCBgJHtjb25zdGFudHMuYXR0cmlidXRlUHJlZml4fWljb25gIClcbmV4cG9ydCBjbGFzcyBVSUljb25BdHRyaWJ1dGUgZXh0ZW5kcyBVSUF0dHJpYnV0ZSB7XG5cblx0QGJpbmRhYmxlIG5hbWUgPSBcImhlbHAgY2lyY2xlXCI7XG5cdEBiaW5kYWJsZUVudW0oIC4uLmNvbnN0YW50cy5WQUxJRF9TSVpFUyApIHNpemU7XG5cdEBiaW5kYWJsZUVudW0oIC4uLmNvbnN0YW50cy5WQUxJRF9DT0xPUlMgKSBjb2xvcjtcblx0QGJpbmRhYmxlVG9nZ2xlIGRpc2FibGVkO1xuXHRAYmluZGFibGVUb2dnbGUgbG9hZGluZztcblxuXG5cdGJpbmQoKSB7XG5cdFx0Ly8gTm8gc3VwZXIsIGFzIHRoZSBjbGFzc0xpc3QgZG9lc24ndCBnZXQgdGhlICd1aScgY2xhc3MuXG5cdFx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoIC4uLnRoaXMubmFtZS5zcGxpdCgnICcpICk7XG5cdFx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoICdpY29uJyApO1xuXHR9XG5cblxuXHRuYW1lQ2hhbmdlZCggbmV3VmFsdWUsIG9sZFZhbHVlICkge1xuXHRcdHRoaXMubG9nZ2VyLmRlYnVnKCBgTmFtZSBjaGFuZ2VkIGZyb20gJHtvbGRWYWx1ZX0gdG8gJHtuZXdWYWx1ZX1gICk7XG5cdFx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoIC4uLm9sZFZhbHVlLnNwbGl0KCcgJykgKTtcblx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCggLi4ubmV3VmFsdWUuc3BsaXQoJyAnKSApO1xuXHR9XG5cbn1cblxuXG5AY3VzdG9tQXR0cmlidXRlKCBgJHtjb25zdGFudHMuYXR0cmlidXRlUHJlZml4fWljb25zYCApXG5leHBvcnQgY2xhc3MgVUlJY29uc0F0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcblxuXHRAYmluZGFibGVFbnVtKCAuLi5jb25zdGFudHMuVkFMSURfU0laRVMgKSBzaXplO1xuXG59XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1pY29uLmpzXG4gKiovIiwiLyogLSotIGphdmFzY3JpcHQgLSotICovXG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBJbWFnZSAtIGh0dHA6Ly9zZW1hbnRpYy11aS5jb20vZWxlbWVudHMvaW1hZ2UuaHRtbFxuICovXG5cbmltcG9ydCB7Y29uc3RhbnRzfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtVSUF0dHJpYnV0ZSwgYmluZGFibGVFbnVtLCBiaW5kYWJsZVRvZ2dsZX0gZnJvbSAnLi4vdWktYXR0cmlidXRlJztcbmltcG9ydCB7Y3VzdG9tQXR0cmlidXRlfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9aW1hZ2VgIClcbmV4cG9ydCBjbGFzcyBVSUltYWdlQXR0cmlidXRlIGV4dGVuZHMgVUlBdHRyaWJ1dGUge1xuXG5cdEBiaW5kYWJsZUVudW0oIC4uLmNvbnN0YW50cy5WQUxJRF9TSVpFUyApIHNpemU7XG5cdEBiaW5kYWJsZVRvZ2dsZSBoaWRkZW4gPSBmYWxzZTtcblx0QGJpbmRhYmxlVG9nZ2xlIGRpc2FibGVkID0gZmFsc2U7XG5cbn1cblxuXG5AY3VzdG9tQXR0cmlidXRlKCBgJHtjb25zdGFudHMuYXR0cmlidXRlUHJlZml4fWltYWdlc2AgKVxuZXhwb3J0IGNsYXNzIFVJSW1hZ2VzQXR0cmlidXRlIGV4dGVuZHMgVUlBdHRyaWJ1dGUge1xuXG5cdEBiaW5kYWJsZUVudW0oIC4uLmNvbnN0YW50cy5WQUxJRF9TSVpFUyApIHNpemU7XG5cbn1cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktaW1hZ2UuanNcbiAqKi8iLCIvKiAtKi0gamF2YXNjcmlwdCAtKi0gKi9cblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIElucHV0IC0gaHR0cDovL3NlbWFudGljLXVpLmNvbS9lbGVtZW50cy9pbnB1dC5odG1sXG4gKi9cblxuaW1wb3J0IHtjb25zdGFudHN9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQge1VJQXR0cmlidXRlLCBiaW5kYWJsZUVudW0sIGJpbmRhYmxlVG9nZ2xlfSBmcm9tICcuLi91aS1hdHRyaWJ1dGUnO1xuaW1wb3J0IHtjdXN0b21BdHRyaWJ1dGV9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcblxuQGN1c3RvbUF0dHJpYnV0ZSggYCR7Y29uc3RhbnRzLmF0dHJpYnV0ZVByZWZpeH1pbnB1dGAgKVxuZXhwb3J0IGNsYXNzIFVJSW5wdXRBdHRyaWJ1dGUgZXh0ZW5kcyBVSUF0dHJpYnV0ZSB7XG5cblx0QGJpbmRhYmxlVG9nZ2xlIGZvY3VzID0gZmFsc2U7XG5cdEBiaW5kYWJsZVRvZ2dsZSBsb2FkaW5nID0gZmFsc2U7XG5cdEBiaW5kYWJsZVRvZ2dsZSBkaXNhYmxlZCA9IGZhbHNlO1xuXHRAYmluZGFibGVUb2dnbGUgZXJyb3IgPSBudWxsO1xuXG5cdEBiaW5kYWJsZUVudW0oIC4uLmNvbnN0YW50cy5WQUxJRF9TSVpFUyApIHNpemU7XG5cbn1cblxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvY29tcG9uZW50cy9hdXJlbGlhLXNlbWFudGljLXVpL2VsZW1lbnRzL3VpLWlucHV0LmpzXG4gKiovIiwiLyogLSotIGphdmFzY3JpcHQgLSotICovXG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBMYWJlbCAtIGh0dHA6Ly9zZW1hbnRpYy11aS5jb20vZWxlbWVudHMvbGFiZWwuaHRtbFxuICovXG5cbmltcG9ydCB7Y29uc3RhbnRzfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtVSUF0dHJpYnV0ZSwgYmluZGFibGVFbnVtLCBiaW5kYWJsZVRvZ2dsZX0gZnJvbSAnLi4vdWktYXR0cmlidXRlJztcbmltcG9ydCB7Y3VzdG9tQXR0cmlidXRlfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9bGFiZWxgIClcbmV4cG9ydCBjbGFzcyBVSUxhYmVsQXR0cmlidXRlIGV4dGVuZHMgVUlBdHRyaWJ1dGUge1xuXG5cdEBiaW5kYWJsZUVudW0oIC4uLmNvbnN0YW50cy5WQUxJRF9DT0xPUlMgKSBjb2xvcjtcblx0QGJpbmRhYmxlRW51bSggLi4uY29uc3RhbnRzLlZBTElEX1NJWkVTICkgc2l6ZTtcblxufVxuXG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9bGFiZWxzYCApXG5leHBvcnQgY2xhc3MgVUlMYWJlbHNBdHRyaWJ1dGUgZXh0ZW5kcyBVSUF0dHJpYnV0ZSB7XG5cblx0QGJpbmRhYmxlRW51bSggLi4uY29uc3RhbnRzLlZBTElEX0NPTE9SUyApIGNvbG9yO1xuXHRAYmluZGFibGVFbnVtKCAuLi5jb25zdGFudHMuVkFMSURfU0laRVMgKSBzaXplO1xuXG59XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktbGFiZWwuanNcbiAqKi8iLCIvKiAtKi0gamF2YXNjcmlwdCAtKi0gKi9cblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIExpc3QgLSBodHRwOi8vc2VtYW50aWMtdWkuY29tL2VsZW1lbnRzL2xpc3QuaHRtbFxuICovXG5cbmltcG9ydCB7Y29uc3RhbnRzfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtjdXN0b21BdHRyaWJ1dGUsIGJpbmRhYmxlfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5pbXBvcnQge1VJQXR0cmlidXRlLCBiaW5kYWJsZUVudW19IGZyb20gJy4uL3VpLWF0dHJpYnV0ZSc7XG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9bGlzdGAgKVxuZXhwb3J0IGNsYXNzIFVJTGlzdEF0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcblxuXHRAYmluZGFibGVFbnVtKCAuLi5jb25zdGFudHMuVkFMSURfU0laRVMgKSBzaXplO1xuXG59XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1saXN0LmpzXG4gKiovIiwiLyogLSotIGphdmFzY3JpcHQgLSotICovXG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBMb2FkZXIgLSBodHRwOi8vc2VtYW50aWMtdWkuY29tL2VsZW1lbnRzL2xvYWRlci5odG1sXG4gKi9cblxuaW1wb3J0IHtjb25zdGFudHN9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQge1VJQXR0cmlidXRlfSBmcm9tICcuLi91aS1hdHRyaWJ1dGUnO1xuaW1wb3J0IHtjdXN0b21BdHRyaWJ1dGUsIGJpbmRhYmxlfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9bG9hZGVyYCApXG5leHBvcnQgY2xhc3MgVUlMb2FkZXJBdHRyaWJ1dGUgZXh0ZW5kcyBVSUF0dHJpYnV0ZSB7XG5cblx0QGJpbmRhYmxlIGFjdGl2ZSA9IGZhbHNlO1xuXG5cblx0YmluZCggLi4uYXJncyApIHtcblx0XHRzdXBlci5iaW5kKCAuLi5hcmdzICk7XG5cblx0XHRpZiAoIHRoaXMuYWN0aXZlICkge1xuXHRcdFx0dGhpcy5sb2dnZXIuZGVidWcoIFwiTG9hZGVyIGlzIHN0YXJ0aW5nIG91dCBhY3RpdmUuXCIgKTtcblx0XHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxuXHRcdH07XG5cdH1cblxuXG5cdGFjdGl2ZUNoYW5nZWQoIG5ld1ZhbHVlICkge1xuXHRcdGlmICggbmV3VmFsdWUgKSB7XG5cdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZyggXCJBY3RpdmF0aW5nIGxvYWRlci5cIiApO1xuXHRcdFx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoICdkaXNhYmxlZCcgKTtcblx0XHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCAnYWN0aXZlJyApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZyggXCJEZWFjdGl2YXRpbmcgbG9hZGVyLlwiICk7XG5cdFx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSggJ2FjdGl2ZScgKTtcblx0XHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCAnZGlzYWJsZWQnICk7XG5cdFx0fVxuXHR9XG5cbn1cblxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktbG9hZGVyLmpzXG4gKiovIiwiLyogLSotIGphdmFzY3JpcHQgLSotICovXG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBDb250ZW50IFJhaWwgLSBodHRwOi8vc2VtYW50aWMtdWkuY29tL2VsZW1lbnRzL3JhaWwuaHRtbFxuICovXG5cbmltcG9ydCB7Y29uc3RhbnRzfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtVSUF0dHJpYnV0ZSwgYmluZGFibGVFbnVtfSBmcm9tICcuLi91aS1hdHRyaWJ1dGUnO1xuaW1wb3J0IHtjdXN0b21BdHRyaWJ1dGUsIGJpbmRhYmxlfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9cmFpbGAgKVxuZXhwb3J0IGNsYXNzIFVJUmFpbEF0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcblxuXHRAYmluZGFibGVFbnVtKCAnbGVmdCcsICdyaWdodCcgKSBzaWRlID0gJ2xlZnQnO1xuXG59XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1yYWlsLmpzXG4gKiovIiwiLyogLSotIGphdmFzY3JpcHQgLSotICovXG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBDb250ZW50IFJldmVhbCAtIGh0dHA6Ly9zZW1hbnRpYy11aS5jb20vZWxlbWVudHMvcmV2ZWFsLmh0bWxcbiAqL1xuXG5pbXBvcnQge2NvbnN0YW50c30gZnJvbSAnLi4vY29uc3RhbnRzJztcbmltcG9ydCB7VUlBdHRyaWJ1dGUsIGJpbmRhYmxlVG9nZ2xlfSBmcm9tICcuLi91aS1hdHRyaWJ1dGUnO1xuaW1wb3J0IHtjdXN0b21BdHRyaWJ1dGUsIGJpbmRhYmxlfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9cmV2ZWFsYCApXG5leHBvcnQgY2xhc3MgVUlSZXZlYWxBdHRyaWJ1dGUgZXh0ZW5kcyBVSUF0dHJpYnV0ZSB7XG5cblx0QGJpbmRhYmxlVG9nZ2xlIGFjdGl2ZTtcblxufVxuXG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9cmV2ZWFsLXZpc2libGVgIClcbmV4cG9ydCBjbGFzcyBVSVJldmVhbFZpc2libGVBdHRyaWJ1dGUgZXh0ZW5kcyBVSUF0dHJpYnV0ZSB7XG5cblx0YmluZCgpIHtcblx0XHQvLyBObyBzdXBlclxuXHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCAndmlzaWJsZScsICdjb250ZW50JyApO1xuXHR9XG5cbn1cblxuQGN1c3RvbUF0dHJpYnV0ZSggYCR7Y29uc3RhbnRzLmF0dHJpYnV0ZVByZWZpeH1yZXZlYWwtaGlkZGVuYCApXG5leHBvcnQgY2xhc3MgVUlSZXZlYWxIaWRkZW5BdHRyaWJ1dGUgZXh0ZW5kcyBVSUF0dHJpYnV0ZSB7XG5cblx0YmluZCgpIHtcblx0XHQvLyBObyBzdXBlclxuXHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCAnaGlkZGVuJywgJ2NvbnRlbnQnICk7XG5cdH1cblxufVxuXG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9lbGVtZW50cy91aS1yZXZlYWwuanNcbiAqKi8iLCIvKiAtKi0gamF2YXNjcmlwdCAtKi0gKi9cblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIFNlZ21lbnQgLSBodHRwOi8vc2VtYW50aWMtdWkuY29tL2VsZW1lbnRzL3NlZ21lbnQuaHRtbFxuICovXG5cbmltcG9ydCB7Y29uc3RhbnRzfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtVSUF0dHJpYnV0ZSwgYmluZGFibGVUb2dnbGUsIGJpbmRhYmxlRW51bX0gZnJvbSAnLi4vdWktYXR0cmlidXRlJztcbmltcG9ydCB7Y3VzdG9tQXR0cmlidXRlLCBjb21wdXRlZEZyb20sIGJpbmRhYmxlLCBpbmplY3QsIExvZ01hbmFnZXJ9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcblxuQGN1c3RvbUF0dHJpYnV0ZSggYCR7Y29uc3RhbnRzLmF0dHJpYnV0ZVByZWZpeH1zZWdtZW50YCApXG5leHBvcnQgY2xhc3MgVUlTZWdtZW50QXR0cmlidXRlIGV4dGVuZHMgVUlBdHRyaWJ1dGUge1xuXG5cdEBiaW5kYWJsZVRvZ2dsZSBsb2FkaW5nID0gZmFsc2U7XG5cdEBiaW5kYWJsZVRvZ2dsZSBkaXNhYmxlZCA9IGZhbHNlO1xuXHRAYmluZGFibGVFbnVtKCAuLi5jb25zdGFudHMuVkFMSURfQ09MT1JTICkgY29sb3I7XG5cbn1cblxuXG5AY3VzdG9tQXR0cmlidXRlKCBgJHtjb25zdGFudHMuYXR0cmlidXRlUHJlZml4fXNlZ21lbnRzYCApXG5leHBvcnQgY2xhc3MgVUlTZWdtZW50c0F0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcbn1cblxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktc2VnbWVudC5qc1xuICoqLyIsIi8qIC0qLSBqYXZhc2NyaXB0IC0qLSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogU3RlcCAtIGh0dHA6Ly9zZW1hbnRpYy11aS5jb20vZWxlbWVudHMvc3RlcC5odG1sXG4gKi9cblxuaW1wb3J0IHtjb25zdGFudHN9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQge1VJQXR0cmlidXRlLCBiaW5kYWJsZVRvZ2dsZSwgYmluZGFibGVFbnVtfSBmcm9tICcuLi91aS1hdHRyaWJ1dGUnO1xuaW1wb3J0IHtjdXN0b21BdHRyaWJ1dGUsIGNvbXB1dGVkRnJvbSwgYmluZGFibGUsIGluamVjdCwgTG9nTWFuYWdlcn0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuXG5AY3VzdG9tQXR0cmlidXRlKCBgJHtjb25zdGFudHMuYXR0cmlidXRlUHJlZml4fXN0ZXBgIClcbmV4cG9ydCBjbGFzcyBVSVN0ZXBBdHRyaWJ1dGUgZXh0ZW5kcyBVSUF0dHJpYnV0ZSB7XG5cblx0QGJpbmRhYmxlVG9nZ2xlIGFjdGl2ZSA9IGZhbHNlO1xuXHRAYmluZGFibGVUb2dnbGUgZGlzYWJsZWQgPSBmYWxzZTtcblx0QGJpbmRhYmxlVG9nZ2xlIGNvbXBsZXRlZCA9IGZhbHNlO1xuXHRAYmluZGFibGVFbnVtKCAuLi5jb25zdGFudHMuVkFMSURfQ09MT1JTICkgY29sb3I7XG5cblxuXHRiaW5kKCAuLi5hcmdzICkge1xuXHRcdC8vIE5vIHN1cGVyXG5cdFx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoICdzdGVwJyApO1xuXHR9XG5cbn1cblxuXG5AY3VzdG9tQXR0cmlidXRlKCBgJHtjb25zdGFudHMuYXR0cmlidXRlUHJlZml4fXN0ZXBzYCApXG5leHBvcnQgY2xhc3MgVUlTdGVwc0F0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcbn1cblxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvZWxlbWVudHMvdWktc3RlcC5qc1xuICoqLyIsIi8qKlxuICogQXVyZWxpYS1TZW1hbnRpYy1VSSAtLSBBdXJlbGlhIGNvbXBvbmVudHMgZm9yIFNlbWFudGljLVVJXG4gKiAkSWQkXG4gKlxuICogQXV0aG9yc1xuICogLSBNaWNoYWVsIEdyYW5nZXIgPGdlZEBGYWVyaWVNVUQub3JnPlxuICovXG4vKlxuaW1wb3J0ICdub2RlX21vZHVsZXMvc2VtYW50aWMtdWknO1xuaW1wb3J0ICdub2RlX21vZHVsZXMvc2VtYW50aWMtdWkvc2VtYW50aWMuY3NzISc7Ki9cblxuXG5leHBvcnQgdmFyIFZFUlNJT04gPSAnMC4wLjEtYWxwaGEuNCc7XG5cbi8vIEF1cmVsaWEgcGx1Z2luIGhvb2tcbmV4cG9ydCBmdW5jdGlvbiBjb25maWd1cmUoY29uZmlnKSB7XG5cdGNvbmZpZy5nbG9iYWxSZXNvdXJjZXMoXG5cdFx0Jy4vY29sbGVjdGlvbnMvdWktYnJlYWRjcnVtYicsXG5cdFx0Jy4vY29sbGVjdGlvbnMvdWktZm9ybScsXG5cdFx0Jy4vY29sbGVjdGlvbnMvdWktZ3JpZCcsXG5cdFx0Jy4vY29sbGVjdGlvbnMvdWktbWVudScsXG5cdFx0Jy4vY29sbGVjdGlvbnMvdWktbWVzc2FnZScsXG5cdFx0Jy4vY29sbGVjdGlvbnMvdWktdGFibGUnLFxuXHRcdCcuL2VsZW1lbnRzL3VpLWJ1dHRvbicsXG5cdFx0Jy4vZWxlbWVudHMvdWktY29udGFpbmVyJyxcblx0XHQnLi9lbGVtZW50cy91aS1kaXZpZGVyJyxcblx0XHQnLi9lbGVtZW50cy91aS1mbGFnJyxcblx0XHQnLi9lbGVtZW50cy91aS1oZWFkZXInLFxuXHRcdCcuL2VsZW1lbnRzL3VpLWljb24nLFxuXHRcdCcuL2VsZW1lbnRzL3VpLWltYWdlJyxcblx0XHQnLi9lbGVtZW50cy91aS1pbnB1dCcsXG5cdFx0Jy4vZWxlbWVudHMvdWktbGFiZWwnLFxuXHRcdCcuL2VsZW1lbnRzL3VpLWxpc3QnLFxuXHRcdCcuL2VsZW1lbnRzL3VpLWxvYWRlcicsXG5cdFx0Jy4vZWxlbWVudHMvdWktcmFpbCcsXG5cdFx0Jy4vZWxlbWVudHMvdWktcmV2ZWFsJyxcblx0XHQnLi9lbGVtZW50cy91aS1zZWdtZW50Jyxcblx0XHQnLi9lbGVtZW50cy91aS1zdGVwJyxcblx0XHQnLi9tb2R1bGVzL3VpLWFjY29yZGlvbicsXG5cdFx0Jy4vbW9kdWxlcy91aS1kcm9wZG93bicsXG5cdFx0Jy4vbW9kdWxlcy91aS1tb2RhbCcsXG5cdFx0Jy4vbW9kdWxlcy91aS1zZWFyY2gnLFxuXHRcdCcuL21vZHVsZXMvdWktc2lkZWJhcicsXG5cdFx0Jy4vdmlld3MvdWktY2FyZCcsXG5cdFx0Jy4vdmlld3MvdWktc3RhdGlzdGljJ1xuXHQpO1xufVxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvaW5kZXguanNcbiAqKi8iLCIvKiAtKi0gamF2YXNjcmlwdCAtKi0gKi9cblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIEFjY29yZGlvbiAtIGh0dHA6Ly9zZW1hbnRpYy11aS5jb20vbW9kdWxlcy9hY2NvcmRpb24uaHRtbFxuICovXG5cbmltcG9ydCB7Y29uc3RhbnRzfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtVSUF0dHJpYnV0ZSwgYmluZGFibGVUb2dnbGUsIGJpbmRhYmxlRW51bX0gZnJvbSAnLi4vdWktYXR0cmlidXRlJztcbmltcG9ydCB7aW5qZWN0LCBjdXN0b21BdHRyaWJ1dGUsIGJpbmRhYmxlLCBiaW5kaW5nTW9kZX0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuXG5AY3VzdG9tQXR0cmlidXRlKCBgJHtjb25zdGFudHMuYXR0cmlidXRlUHJlZml4fWFjY29yZGlvbmAgKVxuZXhwb3J0IGNsYXNzIFVJQWNjb3JkaW9uQXR0cmlidXRlIGV4dGVuZHMgVUlBdHRyaWJ1dGUge1xuXG4gICAgYXR0YWNoZWQoKSB7XG5cdFx0dGhpcy5sb2dnZXIuZGVidWcoIFwiQWN0aXZhdGluZyBhY2NvcmRpb24gZm9yIFwiLCB0aGlzLmVsZW1lbnQgKTtcbiAgICAgICAgJCggdGhpcy5lbGVtZW50ICkuYWNjb3JkaW9uKCk7XG4gICAgfVxuXG59XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9tb2R1bGVzL3VpLWFjY29yZGlvbi5qc1xuICoqLyIsIi8qIC0qLSBqYXZhc2NyaXB0IC0qLSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogRHJvcGRvd24gLSBodHRwOi8vc2VtYW50aWMtdWkuY29tL21vZHVsZXMvZHJvcGRvd24uaHRtbFxuICovXG5cbmltcG9ydCB7Y29uc3RhbnRzfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtVSUF0dHJpYnV0ZSwgYmluZGFibGVUb2dnbGUsIGJpbmRhYmxlRW51bX0gZnJvbSAnLi4vdWktYXR0cmlidXRlJztcbmltcG9ydCB7aW5qZWN0LCBjdXN0b21BdHRyaWJ1dGUsIGJpbmRhYmxlLCBiaW5kaW5nTW9kZX0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuXG5AY3VzdG9tQXR0cmlidXRlKCBgJHtjb25zdGFudHMuYXR0cmlidXRlUHJlZml4fWRyb3Bkb3duYCApXG5leHBvcnQgY2xhc3MgVUlEcm9wZG93bkF0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcblxuXHRAYmluZGFibGUoeyBkZWZhdWx0QmluZGluZ01vZGU6IGJpbmRpbmdNb2RlLnR3b1dheSB9KSBzZWxlY3Rpb247XG5cdEBiaW5kYWJsZVRvZ2dsZSBsb2FkaW5nID0gZmFsc2U7XG5cdEBiaW5kYWJsZVRvZ2dsZSBlcnJvciA9IGZhbHNlO1xuXHRAYmluZGFibGVUb2dnbGUgZGlzYWJsZWQgPSBmYWxzZTtcblxuXG5cdGJpbmQoIC4uLmFyZ3MgKSB7XG5cdFx0c3VwZXIuYmluZCggLi4uYXJncyApO1xuXG5cdFx0aWYgKCB0aGlzLnNlbGVjdGlvbiApIHtcblx0XHRcdGxldCBuYW1lID0gdGhpcy5zZWxlY3Rpb247XG5cdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZyggXCJTZWxlY3Rpb24gc2V0IHRvOiBcIiwgbmFtZSApO1xuXHRcdFx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoICdzZWxlY3Rpb24nICk7XG5cblx0XHRcdGlmICggdGhpcy5lbGVtZW50LnRhZ05hbWUgIT09ICdzZWxlY3QnICkge1xuXHRcdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZyggXCJOb24tc2VsZWN0IGRyb3Bkb3duLlwiICk7XG5cblx0XHRcdFx0Ly8gVE9ETzogVGhpcyBkb2Vzbid0IHdvcmsgeWV0OyBpdCBpbmplY3RzIHRoZSBoaWRkZW4gZmllbGQsIGJ1dCB0aGUgYmluZGluZ1xuXHRcdFx0XHQvLyBkb2Vzbid0IHdvcmsuIEl0IGxpa2VseSBuZWVkcyB0byBiZSBob29rZWQgdXAgbWFudWFsbHksIGJ1dCBJIGhhdmUgbm9cblx0XHRcdFx0Ly8gY2x1ZSBob3cgdG8gZG8gdGhhdCBjdXJyZW50bHkuXG5cdFx0XHRcdGxldCBpbnB1dCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCAnaW5wdXRbdHlwZT1oaWRkZW5dJyApO1xuXHRcdFx0XHRpZiAoICFpbnB1dCApIHtcblx0XHRcdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZyggYE5vIGhpZGRlbiBpbnB1dCBmb3IgJHtuYW1lfTsgY3JlYXRpbmcgb25lLmAgKTtcblx0XHRcdFx0XHRpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdpbnB1dCcgKTtcblx0XHRcdFx0XHRpbnB1dC50eXBlID0gJ2hpZGRlbic7XG5cdFx0XHRcdFx0aW5wdXQubmFtZSA9IG5hbWU7XG5cblx0XHRcdFx0XHRsZXQgYmluZGluZyA9IGRvY3VtZW50LmNyZWF0ZUF0dHJpYnV0ZSggXCJ2YWx1ZS5iaW5kXCIgKTtcblx0XHRcdFx0XHRiaW5kaW5nLnZhbHVlID0gbmFtZTtcblx0XHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGVOb2RlKCBiaW5kaW5nICk7XG5cblx0XHRcdFx0XHR0aGlzLmVsZW1lbnQuaW5zZXJ0QmVmb3JlKCBpbnB1dCwgdGhpcy5lbGVtZW50LmZpcnN0Q2hpbGQgKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZyggXCJBbHJlYWR5IGhhcyBhIGhpZGRlbiBlbGVtZW50OiBcIiwgaW5wdXQgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cbiAgICBhdHRhY2hlZCgpIHtcblx0XHR0aGlzLmxvZ2dlci5kZWJ1ZyggXCJBY3RpdmF0aW5nIGRyb3Bkb3duIGZvciBcIiwgdGhpcy5lbGVtZW50ICk7XG4gICAgICAgICQoIHRoaXMuZWxlbWVudCApLmRyb3Bkb3duKCk7XG4gICAgfVxuXG59XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9tb2R1bGVzL3VpLWRyb3Bkb3duLmpzXG4gKiovIiwiLyogLSotIGphdmFzY3JpcHQgLSotICovXG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBNb2RhbCAtIGh0dHA6Ly9zZW1hbnRpYy11aS5jb20vbW9kdWxlcy9tb2RhbC5odG1sXG4gKi9cblxuaW1wb3J0IHtjb25zdGFudHN9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQge2N1c3RvbUF0dHJpYnV0ZX0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuaW1wb3J0IHtVSUF0dHJpYnV0ZSwgYmluZGFibGVUb2dnbGV9IGZyb20gJy4uL3VpLWF0dHJpYnV0ZSc7XG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9bW9kYWxgIClcbmV4cG9ydCBjbGFzcyBVSU1vZGFsQXR0cmlidXRlIGV4dGVuZHMgVUlBdHRyaWJ1dGUge1xuXG5cdEBiaW5kYWJsZVRvZ2dsZSBhY3RpdmUgPSBmYWxzZTtcblxuXG5cblx0YXR0YWNoZWQoKSB7XG5cdFx0JCggdGhpcy5lbGVtZW50ICkubW9kYWwoKTtcblx0fVxuXG5cblx0YWN0aXZlQ2hhbmdlZCggbmV3VmFsdWUgKSB7XG5cdFx0aWYgKCBuZXdWYWx1ZSApIHtcblx0XHRcdCQoIHRoaXMuZWxlbWVudCApLm1vZGFsKCAnc2hvdycgKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0JCggdGhpcy5lbGVtZW50ICkubW9kYWwoICdoaWRlJyApO1xuXHRcdH1cblx0fVxuXG59XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9tb2R1bGVzL3VpLW1vZGFsLmpzXG4gKiovIiwiLyogLSotIGphdmFzY3JpcHQgLSotICovXG5cInVzZSBzdHJpY3RcIjtcblxuLyoqXG4gKiBTZWFyY2ggLSBodHRwOi8vc2VtYW50aWMtdWkuY29tL21vZHVsZXMvc2VhcmNoLmh0bWxcbiAqL1xuXG5pbXBvcnQge2NvbnN0YW50c30gZnJvbSAnLi4vY29uc3RhbnRzJztcbmltcG9ydCB7VUlBdHRyaWJ1dGUsIGJpbmRhYmxlVG9nZ2xlLCBiaW5kYWJsZUVudW19IGZyb20gJy4uL3VpLWF0dHJpYnV0ZSc7XG5pbXBvcnQge2luamVjdCwgY3VzdG9tQXR0cmlidXRlLCBjaGlsZHJlbiwgYmluZGFibGV9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcblxuQGN1c3RvbUF0dHJpYnV0ZSggYCR7Y29uc3RhbnRzLmF0dHJpYnV0ZVByZWZpeH1zZWFyY2hgIClcbmV4cG9ydCBjbGFzcyBVSVNlYXJjaEF0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcblxuXHRhdHRhY2hlZCgpIHtcblx0XHR0aGlzLmxvZ2dlci5kZWJ1ZyggXCJBY3RpdmF0aW5nIHNlYXJjaCBvbiBcIiwgdGhpcy5lbGVtZW50ICk7XG5cdFx0JCggdGhpcy5lbGVtZW50ICkuc2VhcmNoKCk7XG5cdH1cblxufVxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvbW9kdWxlcy91aS1zZWFyY2guanNcbiAqKi8iLCIvKiAtKi0gamF2YXNjcmlwdCAtKi0gKi9cblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIFNpZGViYXIgLSBodHRwOi8vc2VtYW50aWMtdWkuY29tL21vZHVsZXMvc2lkZWJhci5odG1sXG4gKi9cblxuaW1wb3J0IHtjb25zdGFudHN9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQge2N1c3RvbUF0dHJpYnV0ZSwgYmluZGFibGV9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcbmltcG9ydCB7VUlBdHRyaWJ1dGV9IGZyb20gJy4uL3VpLWF0dHJpYnV0ZSc7XG5cblxuQGN1c3RvbUF0dHJpYnV0ZSggYCR7Y29uc3RhbnRzLmF0dHJpYnV0ZVByZWZpeH1zaWRlYmFyYCApXG5leHBvcnQgY2xhc3MgVUlTaWRlYmFyQXR0cmlidXRlIGV4dGVuZHMgVUlBdHRyaWJ1dGUge1xuXG5cdEBiaW5kYWJsZSBjb250ZXh0O1xuXHRAYmluZGFibGUgZXZlbnRzO1xuXG5cblx0YXR0YWNoZWQoKSB7XG5cdFx0dGhpcy5sb2dnZXIuZGVidWcoIFwiU2lkZWJhciBhdHRhY2hlZDogXCIsIHRoaXMuZWxlbWVudCApO1xuXHRcdGlmICggdGhpcy5jb250ZXh0ICkge1xuXHRcdFx0bGV0IGNvbnRleHRFbCA9ICQoIHRoaXMuZWxlbWVudCApLnBhcmVudCggdGhpcy5jb250ZXh0ICkuZmlyc3QoKTtcblx0XHRcdCQoIHRoaXMuZWxlbWVudCApLnNpZGViYXIoeyBjb250ZXh0OiBjb250ZXh0RWwgfSk7XG5cdFx0fVxuXG5cdFx0aWYgKCB0aGlzLmV2ZW50cyApIHtcblx0XHRcdGxldCBjb250ZXh0RWwgPSAkKCB0aGlzLmVsZW1lbnQgKS5wYXJlbnQoIHRoaXMuZXZlbnRzICkuZmlyc3QoKTtcblx0XHRcdCQoIHRoaXMuZWxlbWVudCApLnNpZGViYXIoICdhdHRhY2ggZXZlbnRzJywgY29udGV4dEVsICk7XG5cdFx0fVxuXHR9XG5cblxuXHR0b2dnbGUoKSB7XG5cdFx0JCggdGhpcy5lbGVtZW50ICkuc2lkZWJhciggJ3RvZ2dsZScgKTtcblx0fVxuXG59XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS9tb2R1bGVzL3VpLXNpZGViYXIuanNcbiAqKi8iLCIvKiAtKi0gamF2YXNjcmlwdCAtKi0gKi9cblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIENhcmQgLSBodHRwOi8vc2VtYW50aWMtdWkuY29tL3ZpZXdzL2NhcmQuaHRtbFxuICovXG5cbmltcG9ydCB7Y29uc3RhbnRzfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtVSUF0dHJpYnV0ZX0gZnJvbSAnLi4vdWktYXR0cmlidXRlJztcbmltcG9ydCB7Y3VzdG9tQXR0cmlidXRlfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9Y2FyZGAgKVxuZXhwb3J0IGNsYXNzIFVJQ2FyZEF0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcbn1cblxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb21wb25lbnRzL2F1cmVsaWEtc2VtYW50aWMtdWkvdmlld3MvdWktY2FyZC5qc1xuICoqLyIsIi8qIC0qLSBqYXZhc2NyaXB0IC0qLSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogU3RhdGlzdGljIC0gaHR0cDovL3NlbWFudGljLXVpLmNvbS92aWV3cy9zdGF0aXN0aWMuaHRtbFxuICovXG5cbmltcG9ydCB7Y29uc3RhbnRzfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtVSUF0dHJpYnV0ZSwgYmluZGFibGVFbnVtfSBmcm9tICcuLi91aS1hdHRyaWJ1dGUnO1xuaW1wb3J0IHtjdXN0b21BdHRyaWJ1dGV9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcblxuQGN1c3RvbUF0dHJpYnV0ZSggYCR7Y29uc3RhbnRzLmF0dHJpYnV0ZVByZWZpeH1zdGF0aXN0aWNgIClcbmV4cG9ydCBjbGFzcyBVSVN0YXRpc3RpY0F0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcblx0QGJpbmRhYmxlRW51bSggLi4uY29uc3RhbnRzLlZBTElEX1NJWkVTICkgc2l6ZTtcblx0QGJpbmRhYmxlRW51bSggLi4uY29uc3RhbnRzLlZBTElEX0NPTE9SUyApIGNvbG9yO1xufVxuXG5cbkBjdXN0b21BdHRyaWJ1dGUoIGAke2NvbnN0YW50cy5hdHRyaWJ1dGVQcmVmaXh9c3RhdGlzdGljc2AgKVxuZXhwb3J0IGNsYXNzIFVJU3RhdGlzdGljc0F0dHJpYnV0ZSBleHRlbmRzIFVJQXR0cmlidXRlIHtcblx0QGJpbmRhYmxlRW51bSggLi4uY29uc3RhbnRzLlZBTElEX1NJWkVTICkgc2l6ZTtcblx0QGJpbmRhYmxlRW51bSggLi4uY29uc3RhbnRzLlZBTElEX0NPTE9SUyApIGNvbG9yO1xufVxuXG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvYXVyZWxpYS1zZW1hbnRpYy11aS92aWV3cy91aS1zdGF0aXN0aWMuanNcbiAqKi8iLCJpbXBvcnQge2N1c3RvbUVsZW1lbnQsIGJpbmRhYmxlLCBjb250YWluZXJsZXNzfSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XHJcblxyXG5AY3VzdG9tRWxlbWVudCgnZm9ybS1jb250cm9sJylcclxuQGNvbnRhaW5lcmxlc3MoKVxyXG5AYmluZGFibGUoe1xyXG4gIG5hbWU6J3ZhbHVlJywgLy9uYW1lIG9mIHRoZSBwcm9wZXJ0eSBvbiB0aGUgY2xhc3NcclxuICBhdHRyaWJ1dGU6J3ZhbHVlJywgLy9uYW1lIG9mIHRoZSBhdHRyaWJ1dGUgaW4gSFRNTFxyXG4gIFxyXG4gIGRlZmF1bHRCaW5kaW5nTW9kZTogMiwgLy9kZWZhdWx0IGJpbmRpbmcgbW9kZSB1c2VkIHdpdGggdGhlIC5iaW5kIGNvbW1hbmRcclxuICBkZWZhdWx0VmFsdWU6IHVuZGVmaW5lZCAvL2RlZmF1bHQgdmFsdWUgb2YgdGhlIHByb3BlcnR5LCBpZiBub3QgYm91bmQgb3Igc2V0IGluIEhUTUxcclxufSlcclxuQGJpbmRhYmxlKHtcclxuICBuYW1lOid0eXBlJywgLy9uYW1lIG9mIHRoZSBwcm9wZXJ0eSBvbiB0aGUgY2xhc3NcclxuICBhdHRyaWJ1dGU6J3R5cGUnLCAvL25hbWUgb2YgdGhlIGF0dHJpYnV0ZSBpbiBIVE1MXHJcbiAgZGVmYXVsdFZhbHVlOiAndGV4dCcgLy9kZWZhdWx0IHZhbHVlIG9mIHRoZSBwcm9wZXJ0eSwgaWYgbm90IGJvdW5kIG9yIHNldCBpbiBIVE1MXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBGb3JtQ29udHJvbCB7XHJcbiAgQGJpbmRhYmxlIG5hbWU7XHJcbiAgQGJpbmRhYmxlIGxhYmVsO1xyXG59XHJcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvZm9ybS1jb250cm9sLmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZT5cXG4gIDxkaXYgY2xhc3M9XFxcImZpZWxkXFxcIj5cXG4gICAgPGxhYmVsIGZvci5iaW5kPVxcXCJuYW1lXFxcIj4ke2xhYmVsfTwvbGFiZWw+XFxuICAgIDxpbnB1dCB0eXBlLmJpbmQ9XFxcInR5cGVcXFwiIGlkLmJpbmQ9XFxcIm5hbWVcXFwiIHBsYWNlaG9sZGVyLmJpbmQ9XFxcImxhYmVsXFxcIiB2YWx1ZS5iaW5kPVxcXCJ2YWx1ZVxcXCIgY2xhc3M9XFxcIm1pbmlcXFwiPlxcbiAgPC9kaXY+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL2NvbXBvbmVudHMvZm9ybS1jb250cm9sLmh0bWxcbiAqKiBtb2R1bGUgaWQgPSAxMDZcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsImltcG9ydCB7Y3VzdG9tRWxlbWVudCwgYmluZGFibGUsIGNvbnRhaW5lcmxlc3N9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcclxuXHJcbkBjdXN0b21FbGVtZW50KCdmb3JtLXN1Ym1pdCcpXHJcbkBjb250YWluZXJsZXNzKClcclxuZXhwb3J0IGNsYXNzIEZvcm1TdWJtaXQge1xyXG4gIEBiaW5kYWJsZSBsYWJlbDtcclxufVxyXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb21wb25lbnRzL2Zvcm0tc3VibWl0LmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZT5cXHJcXG5cXHQ8ZGl2IGNsYXNzPVxcXCJmb3JtLWdyb3VwXFxcIj5cXHJcXG5cXHRcXHQ8ZGl2IGNsYXNzPVxcXCJjb2wtc20tb2Zmc2V0LTIgY29sLXNtLTEwXFxcIj5cXHJcXG5cXHRcXHRcXHQ8YnV0dG9uIHR5cGU9XFxcInN1Ym1pdFxcXCIgY2xhc3M9XFxcImJ0biBidG4tcHJpbWFyeVxcXCI+PGkgY2xhc3M9XFxcImZhIGZhLXNlbmRcXFwiPjwvaT4gJHtsYWJlbH08L2J1dHRvbj5cXHJcXG5cXHRcXHQ8L2Rpdj5cXHJcXG5cXHQ8L2Rpdj5cXHJcXG48L3RlbXBsYXRlPlwiO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvY29tcG9uZW50cy9mb3JtLXN1Ym1pdC5odG1sXG4gKiogbW9kdWxlIGlkID0gMTA4XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCJleHBvcnQgZnVuY3Rpb24gY29uZmlndXJlKGF1cmVsaWEpIHtcclxuICBhdXJlbGlhLmdsb2JhbFJlc291cmNlcyhcclxuICAgICAgJy4vZm9ybS1jb250cm9sJ1xyXG4gICAgLCAnLi9mb3JtLXN1Ym1pdCdcclxuLy8gICAgLCAnLi9uYXYtYmFyJ1xyXG4gIClcclxufVxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudHMvaW5kZXguanNcbiAqKi8iLCJleHBvcnQgY2xhc3MgV2VsY29tZSB7fVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvaG9tZS93ZWxjb21lLmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZT5cXG48c2VjdGlvbiBjbGFzcz1cXFwiYXUtYW5pbWF0ZVxcXCI+XFxuPGRpdiBpZD1cXFwiZXhhbXBsZVxcXCIgY2xhc3M9XFxcImluZGV4IGZ1bGwgaGVpZ2h0XFxcIj5cXG4gIDxkaXYgY2xhc3M9XFxcIm1hc3RoZWFkIHNlZ21lbnQgYmc5IGludmVydGVkXFxcIj5cXG4gIDxkaXYgY2xhc3M9XFxcInVpIGNvbnRhaW5lclxcXCI+XFxuICAgIDxkaXYgY2xhc3M9XFxcImludHJvZHVjdGlvblxcXCI+XFxuICAgICAgPHNwYW4gY2xhc3M9XFxcInVpIGJsYWNrIHZlcnNpb24gbGFiZWxcXFwiPlxcbiAgICAgICAgMC4wLjFcXG4gICAgICA8L3NwYW4+XFxuICAgICAgPGgxIGNsYXNzPVxcXCJ1aSBpbnZlcnRlZCBoZWFkZXJcXFwiPlxcbiAgICAgICAgPHNwYW4gY2xhc3M9XFxcImxpYnJhcnlcXFwiPlxcbiAgICAgICAgICBpUSAtIEFkbWluIEFwcFxcbiAgICAgICAgPC9zcGFuPlxcbiAgICAgICAgPHNwYW4gY2xhc3M9XFxcInRhZ2xpbmVcXFwiPlxcbiAgICAgICAgICBidWlsdCB3aXRoIFNlbWFudGljIFVzZXIgSW50ZXJmYWNlXFxuICAgICAgICA8L3NwYW4+XFxuICAgICAgPC9oMT5cXG4gICAgICA8ZGl2IGNsYXNzPVxcXCJ1aSBoaWRkZW4gZGl2aWRlclxcXCI+PC9kaXY+XFxuICAgICAgPGEgaHJlZj1cXFwiIy9RdWVzdGlvbnNcXFwiIGNsYXNzPVxcXCJ1aSBodWdlIGludmVydGVkIGRvd25sb2FkIGJ1dHRvblxcXCI+XFxuICAgICAgICBHZXQgU3RhcnRlZCB3aXRoIFF1ZXN0aW9uc1xcbiAgICAgIDwvYT5cXG4gICAgPC9kaXY+XFxuICA8L2Rpdj5cXG48L2Rpdj5cXG48L2Rpdj5cXG48L3NlY3Rpb24+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL2hvbWUvd2VsY29tZS5odG1sXG4gKiogbW9kdWxlIGlkID0gMTExXG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCJleHBvcnQgY29uc3QgYmFzZUNvbmZpZyA9IHtcbiAgJ2Jhc2VDdHJsVXJsJzogJy9hbnN3ZXJzLycsXG4gICdlbnRpdHlUb1N1YnNjcmliZSc6J2Fuc3dlcidcbn07XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9xdWVzdGlvbi9hbnN3ZXJzL2Jhc2UuanNcbiAqKi8iLCJpbXBvcnQge2luamVjdH0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuaW1wb3J0IHtSb3V0ZXJ9IGZyb20gJ2F1cmVsaWEtcm91dGVyJztcbmltcG9ydCB7RXZlbnRBZ2dyZWdhdG9yfSBmcm9tICdhdXJlbGlhLWV2ZW50LWFnZ3JlZ2F0b3InO1xuaW1wb3J0IHtTYWlsc1NvY2tldENsaWVudH0gZnJvbSAnYXVyZWxpYS1zYWlscy1zb2NrZXQtY2xpZW50JztcbmltcG9ydCB7YmFzZUNvbmZpZ30gZnJvbSAnLi9iYXNlJztcblxuQGluamVjdChTYWlsc1NvY2tldENsaWVudCwgUm91dGVyLCBFdmVudEFnZ3JlZ2F0b3IpXG5leHBvcnQgY2xhc3MgQ3JlYXRlIHtcblxuICBxdWVzdGlvbklkID0gbnVsbDtcblxuICBjb25zdHJ1Y3RvcihzYWlscywgcm91dGVyLCBldmVudEFnZ3JlZ2F0b3IpIHtcbiAgICB0aGlzLnNhaWxzID0gc2FpbHM7XG4gICAgdGhpcy50aGVSb3V0ZXIgPSByb3V0ZXI7XG4gICAgdGhpcy5lYSA9IGV2ZW50QWdncmVnYXRvcjtcbiAgfVxuXG4gIGFjdGl2YXRlKHBhcmFtcykge1xuICAgIHRoaXMucXVlc3Rpb25JZCA9IHBhcmFtcy5pZDtcbiAgfVxuXG4gIHN1Ym1pdCgpIHtcbiAgICB0aGlzLnNhaWxzLnBvc3QoYC9xdWVzdGlvbnMvJHt0aGlzLnF1ZXN0aW9uSWR9L2Fuc3dlcnNgLCB0aGlzLmVudGl0eSlcbiAgICAgIC50aGVuKGRhdGEgPT4gdGhpcy50aGVSb3V0ZXIubmF2aWdhdGUoJycpKTtcbiAgfVxuXG4gIGF0dGFjaGVkKCkge1xuICAgIHRoaXMuZWEucHVibGlzaCgnSW5BZGRBbnN3ZXJWaWV3JywgdHJ1ZSk7XG4gIH1cblxuICBkZXRhY2hlZCgpIHtcbiAgICB0aGlzLmVhLnB1Ymxpc2goJ0luQWRkQW5zd2VyVmlldycsIGZhbHNlKTtcbiAgfVxufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvcXVlc3Rpb24vYW5zd2Vycy9jcmVhdGUuanNcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHRlbXBsYXRlPlxcbiAgPHNlY3Rpb24gY2xhc3M9XFxcImF1LWFuaW1hdGVcXFwiPlxcbiAgICA8Zm9ybSBjbGFzcz1cXFwidWkgZm9ybVxcXCIgc3VibWl0LmRlbGVnYXRlPVxcXCJzdWJtaXQoKVxcXCI+XFxuICAgICAgPGZvcm0tY29udHJvbCBuYW1lPVxcXCJ0ZXh0XFxcIiB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkudGV4dFxcXCIgbGFiZWw9XFxcIlRleHRcXFwiPjwvZm9ybS1jb250cm9sPlxcbiAgICAgIDxmb3JtLWNvbnRyb2wgbmFtZT1cXFwiZGVzY1xcXCIgdmFsdWUuYmluZD1cXFwiZW50aXR5LmRlc2NcXFwiIGxhYmVsPVxcXCJEZXNjcmlwdGlvblxcXCI+PC9mb3JtLWNvbnRyb2w+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwiZmllbGRcXFwiPlxcbiAgICAgICAgPGxhYmVsIGZvcj1cXFwiaXNDb3JyZWN0XFxcIj5JcyBDb3JyZWN0IEFuc3dlcjwvbGFiZWw+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJ1aSB0b2dnbGUgY2hlY2tib3hcXFwiPlxcbiAgICAgICAgICA8aW5wdXQgaWQ9XFxcImlzQ29ycmVjdFxcXCIgdHlwZT1cXFwiY2hlY2tib3hcXFwiIG5hbWU9XFxcInB1YmxpY1xcXCIgY2hlY2tlZC5iaW5kPVxcXCJlbnRpdHkuaXNDb3JyZWN0XFxcIj5cXG4gICAgICAgICAgPGxhYmVsPiA8L2xhYmVsPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgPC9kaXY+XFxuICAgICAgPGJ1dHRvbiB0eXBlPVxcXCJzdWJtaXRcXFwiIGNsYXNzPVxcXCJ1aSBzdWJtaXQgZmx1aWQgYnV0dG9uIGdyZWVuXFxcIj48aSBjbGFzcz1cXFwic2VuZCBpY29uXFxcIj48L2k+QWRkPC9idXR0b24+XFxuICAgIDwvZm9ybT5cXG4gIDwvc2VjdGlvbj5cXG48L3RlbXBsYXRlPlxcblwiO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvcXVlc3Rpb24vYW5zd2Vycy9jcmVhdGUuaHRtbFxuICoqIG1vZHVsZSBpZCA9IDEyN1xuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiaW1wb3J0IHtpbmplY3R9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcbmltcG9ydCB7Um91dGVyfSBmcm9tICdhdXJlbGlhLXJvdXRlcic7XG5pbXBvcnQge0V2ZW50QWdncmVnYXRvcn0gZnJvbSAnYXVyZWxpYS1ldmVudC1hZ2dyZWdhdG9yJztcbmltcG9ydCB7U2FpbHNTb2NrZXRDbGllbnR9IGZyb20gJ2F1cmVsaWEtc2FpbHMtc29ja2V0LWNsaWVudCc7XG4vKmltcG9ydCB7QmFzZUxpc3RWTX0gZnJvbSAnLi4vQmFzZUNydWRPcGVyYXRpb25zL0Jhc2VMaXN0Vk0nO1xuIGltcG9ydCB7YmFzZUNvbmZpZ30gZnJvbSAnLi9iYXNlJzsqL1xuaW1wb3J0ICdqcXVlcnknO1xuXG5AaW5qZWN0KFNhaWxzU29ja2V0Q2xpZW50LCBSb3V0ZXIsIEV2ZW50QWdncmVnYXRvcilcbmV4cG9ydCBjbGFzcyBMaXN0IHtcbiAgY29uc3RydWN0b3Ioc2FpbHMsIHJvdXRlciwgZXZlbnRBZ2dyZWdhdG9yKSB7XG4gICAgdGhpcy5zYWlscyA9IHNhaWxzO1xuICAgIHRoaXMucm91dGVyID0gcm91dGVyO1xuICAgIHRoaXMuZWEgPSBldmVudEFnZ3JlZ2F0b3I7XG4gIH1cblxuICBhdHRhY2hlZCgpIHtcbiAgICB0aGlzLmVhLnB1Ymxpc2goJ0luQW5zd2Vyc1ZpZXcnLCB0cnVlKTtcbiAgfVxuXG4gIGRldGFjaGVkKCkge1xuICAgIHRoaXMuZWEucHVibGlzaCgnSW5BbnN3ZXJzVmlldycsIGZhbHNlKTtcbiAgfVxuXG4gIGFjdGl2YXRlKHBhcmFtcykge1xuICAgIHRoaXMucXVlc3Rpb25JZCA9IHBhcmFtcy5pZDtcbiAgICByZXR1cm4gdGhpcy5zYWlscy5nZXQoYC9hbnN3ZXJzP3F1ZXN0aW9uPSR7cGFyYW1zLmlkfWApLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdGhpcy5lbnRpdGllcyA9IHJlcy5ib2R5O1xuICAgIH0pLmNhdGNoKChyZXMpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgfSk7XG4gIH1cbn1cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3F1ZXN0aW9uL2Fuc3dlcnMvbGlzdC5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGU+XFxuICA8c2VjdGlvbiBjbGFzcz1cXFwiYXUtYW5pbWF0ZVxcXCI+XFxuICAgIDxkaXYgY2xhc3M9XFxcInVpIHRvZ2dsZSBjaGVja2JveFxcXCI+XFxuICAgICAgPGlucHV0IHR5cGU9XFxcImNoZWNrYm94XFxcIiBuYW1lPVxcXCJwdWJsaWNcXFwiIGNoZWNrZWQuYmluZD1cXFwiaXNDZWxsZWRcXFwiPiBcXG4gICAgICA8bGFiZWw+VG9nZ2xlIENlbGxlZCBUYWJsZTwvbGFiZWw+XFxuICAgIDwvZGl2PlxcbiAgICA8YSBjbGFzcz1cXFwidWkgc3VibWl0IGJ1dHRvbiBibHVlXFxcIiByb3V0ZS1ocmVmPVxcXCJyb3V0ZTogYWRkQW5zd2VyOyBwYXJhbXMuYmluZDogeyBpZDogcXVlc3Rpb25JZCB9XFxcIj48aSBjbGFzcz1cXFwicGx1cyBpY29uXFxcIj48L2k+QWRkIEFuc3dlcjwvYT5cXG4gICAgPHRhYmxlIGNsYXNzPVxcXCJzdHJpcGVkICR7aXNDZWxsZWQ/J2NlbGxlZCc6Jyd9IGdyZWVuIGNvbXBhY3RcXFwiICB1aS10YWJsZT1cXFwiXFxcIj5cXG4gICAgICA8dGhlYWQ+XFxuICAgICAgPHRoPlRleHQ8L3RoPlxcbiAgICAgIDx0aD5EZXNjcmlwdGlvbjwvdGg+XFxuICAgICAgPHRoPklzIENvcnJlY3QgQW5zd2VyPC90aD5cXG4gICAgICA8dGg+QWN0aW9uczwvdGg+XFxuICAgICAgPC90aGVhZD5cXG4gICAgICA8dGJvZHk+XFxuICAgICAgPHRyIHJlcGVhdC5mb3I9XFxcIm9iaiBvZiBlbnRpdGllc1xcXCI+XFxuICAgICAgICA8dGQ+JHtvYmoudGV4dH08L3RkPlxcbiAgICAgICAgPHRkPiR7b2JqLmRlc2N9PC90ZD5cXG4gICAgICAgIDx0ZD48aSBjbGFzcz1cXFwiJHtvYmouaXNDb3JyZWN0ICA/J2NoZWNrbWFyayBncmVlbic6J3JlbW92ZSByZWQnfSBpY29uXFxcIj48L2k+PC90ZD5cXG4gICAgICAgIDx0ZD5cXG4gICAgICAgICAgPGEgY2xhc3M9XFxcImJ0biBidG4teHNcXFwiIHJvdXRlLWhyZWY9XFxcInJvdXRlOiB2aWV3QW5zd2VyOyBwYXJhbXMuYmluZDogeyBhbnN3ZXJJZDogb2JqLmlkLCBpZDogcXVlc3Rpb25JZCB9XFxcIj48aSBjbGFzcz1cXFwiZWRpdCBpY29uXFxcIiBkYXRhLWNvbnRlbnQ9XFxcIkVkaXRcXFwiPjwvaT48L2E+XFxuICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLXhzXFxcIiByb3V0ZS1ocmVmPVxcXCJyb3V0ZTogdmlld0Fuc3dlcjsgcGFyYW1zLmJpbmQ6IHsgYW5zd2VySWQ6IG9iai5pZCwgaWQ6IHF1ZXN0aW9uSWQgfVxcXCI+PGkgY2xhc3M9XFxcInRyYXNoIG91dGxpbmUgaWNvbiByZWRcXFwiIGRhdGEtY29udGVudD1cXFwiRGVsZXRlXFxcIj48L2k+PC9hPlxcbiAgICAgICAgPC90ZD5cXG4gICAgICA8L3RyPlxcbiAgICAgIDwvdGJvZHk+XFxuICAgIDwvdGFibGU+XFxuICA8L3NlY3Rpb24+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3F1ZXN0aW9uL2Fuc3dlcnMvbGlzdC5odG1sXG4gKiogbW9kdWxlIGlkID0gMTI5XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCJpbXBvcnQge2luamVjdH0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuaW1wb3J0IHtSb3V0ZXJ9IGZyb20gJ2F1cmVsaWEtcm91dGVyJztcbmltcG9ydCB7RXZlbnRBZ2dyZWdhdG9yfSBmcm9tICdhdXJlbGlhLWV2ZW50LWFnZ3JlZ2F0b3InO1xuaW1wb3J0IHtTYWlsc1NvY2tldENsaWVudH0gZnJvbSAnYXVyZWxpYS1zYWlscy1zb2NrZXQtY2xpZW50JztcbmltcG9ydCB7QmFzZVZpZXdWTX0gZnJvbSAnLi4vLi4vQmFzZUNydWRPcGVyYXRpb25zL0Jhc2VWaWV3Vk0nO1xuaW1wb3J0IHtiYXNlQ29uZmlnfSBmcm9tICcuL2Jhc2UnO1xuXG5AaW5qZWN0KFNhaWxzU29ja2V0Q2xpZW50LCBSb3V0ZXIsIEV2ZW50QWdncmVnYXRvcilcbmV4cG9ydCBjbGFzcyBWaWV3IGV4dGVuZHMgQmFzZVZpZXdWTSB7XG5cbiAgY29uc3RydWN0b3Ioc2FpbHMsIHJvdXRlciwgZXZlbnRBZ2dyZWdhdG9yKSB7XG4gICAgc3VwZXIoc2FpbHMsIHJvdXRlciwgZXZlbnRBZ2dyZWdhdG9yLCBiYXNlQ29uZmlnKVxuICB9XG5cbiAgYXR0YWNoZWQoKSB7XG5cbiAgfVxuXG4gIGRldGFjaGVkKCkge1xuICAgIFxuICB9XG5cbiAgZ2V0SWRQYXJhbShwYXJhbXMpIHtcbiAgICByZXR1cm4gcGFyYW1zLmFuc3dlcklkO1xuICB9XG59XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9xdWVzdGlvbi9hbnN3ZXJzL3ZpZXcuanNcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHRlbXBsYXRlPlxcbiAgPHNlY3Rpb24gY2xhc3M9XFxcImF1LWFuaW1hdGVcXFwiPlxcbiAgICA8Zm9ybSBjbGFzcz1cXFwidWkgZm9ybVxcXCIgc3VibWl0LmRlbGVnYXRlPVxcXCJzdWJtaXQoKVxcXCI+XFxuICAgICAgPGZvcm0tY29udHJvbCBuYW1lPVxcXCJ0ZXh0XFxcIiB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkudGV4dFxcXCIgbGFiZWw9XFxcIlRleHRcXFwiPjwvZm9ybS1jb250cm9sPlxcbiAgICAgIDxmb3JtLWNvbnRyb2wgbmFtZT1cXFwiZGVzY1xcXCIgdmFsdWUuYmluZD1cXFwiZW50aXR5LmRlc2NcXFwiIGxhYmVsPVxcXCJEZXNjcmlwdGlvblxcXCI+PC9mb3JtLWNvbnRyb2w+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwiZmllbGRcXFwiPlxcbiAgICAgICAgPGxhYmVsIGZvcj1cXFwiaXNDb3JyZWN0XFxcIj5JcyBDb3JyZWN0IEFuc3dlcjwvbGFiZWw+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJ1aSB0b2dnbGUgY2hlY2tib3hcXFwiPlxcbiAgICAgICAgICA8aW5wdXQgaWQ9XFxcImlzQ29ycmVjdFxcXCIgdHlwZT1cXFwiY2hlY2tib3hcXFwiIG5hbWU9XFxcInB1YmxpY1xcXCIgY2hlY2tlZC5iaW5kPVxcXCJlbnRpdHkuaXNDb3JyZWN0XFxcIj5cXG4gICAgICAgICAgPGxhYmVsPiA8L2xhYmVsPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgPC9kaXY+XFxuICAgICAgPGJ1dHRvbiB0eXBlPVxcXCJzdWJtaXRcXFwiIGNsYXNzPVxcXCJ1aSBzdWJtaXQgYnV0dG9uIGJsdWVcXFwiPjxpIGNsYXNzPVxcXCJ1cGxvYWQgaWNvblxcXCI+PC9pPlVwZGF0ZTwvYnV0dG9uPlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcInVpIHZlcnRpY2FsIGFuaW1hdGVkIHJlZCBidXR0b25cXFwiIGNsaWNrLmRlbGVnYXRlPVxcXCJkZWxldGVFbnRpdHkoKVxcXCI+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJoaWRkZW4gY29udGVudFxcXCI+RGVsZXRlPC9kaXY+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJ2aXNpYmxlIGNvbnRlbnRcXFwiPlxcbiAgICAgICAgICA8aSBjbGFzcz1cXFwidHJhc2ggb3V0bGluZSBpY29uXFxcIj48L2k+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG4gICAgPC9mb3JtPlxcbiAgPC9zZWN0aW9uPlxcbjwvdGVtcGxhdGU+XFxuXCI7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9xdWVzdGlvbi9hbnN3ZXJzL3ZpZXcuaHRtbFxuICoqIG1vZHVsZSBpZCA9IDEzMVxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiZXhwb3J0IGNvbnN0IGJhc2VDb25maWcgPSB7XG4gICdiYXNlQ3RybFVybCc6ICcvcXVlc3Rpb25zLycsXG4gICdlbnRpdHlUb1N1YnNjcmliZSc6J3F1ZXN0aW9uJ1xufTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3F1ZXN0aW9uL2Jhc2UuanNcbiAqKi8iLCJpbXBvcnQge2luamVjdH0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuaW1wb3J0IHsgRXZlbnRBZ2dyZWdhdG9yIH0gZnJvbSAnYXVyZWxpYS1ldmVudC1hZ2dyZWdhdG9yJztcblxuQGluamVjdChFdmVudEFnZ3JlZ2F0b3IpXG5leHBvcnQgY2xhc3MgQ2hpbGRSb3V0ZXIge1xuICBjb25maWd1cmVSb3V0ZXIoY29uZmlnLCByb3V0ZXIpIHtcbiAgICBjb25maWcubWFwKFtcbiAgICAgIHsgcm91dGU6ICcnLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdsaXN0JywgICAgICAgbW9kdWxlSWQ6ICdxdWVzdGlvbi9saXN0JyxcdCAgICAgICAgICB0aXRsZTogJ0xpc3QnLCAgICBuYXY6IHRydWUsICBzZXR0aW5nczp7aWNvbjonbGlzdCBvdXRsaW5lJ30gfSxcbiAgICAgIHsgcm91dGU6ICdjcmVhdGUnLCAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdjcmVhdGUnLCAgICAgbW9kdWxlSWQ6ICdxdWVzdGlvbi9jcmVhdGUnLFx0ICAgICAgICB0aXRsZTogJ0FkZCBRdWVzdGlvbicsIG5hdjogdHJ1ZSwgIHNldHRpbmdzOntpY29uOidwbHVzJ30gfSxcbiAgICAgIHsgcm91dGU6ICcvOmlkJywgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdkZXRhaWxzJywgICAgbW9kdWxlSWQ6ICdxdWVzdGlvbi92aWV3JywgICAgIFx0ICAgICAgdGl0bGU6ICdEZXRhaWxzJ30sXG4gICAgICB7IHJvdXRlOiAnLzppZC9hbnN3ZXJzJywgICAgICAgICAgICAgICAgICBuYW1lOiAnYW5zd2VycycsICAgIG1vZHVsZUlkOiAncXVlc3Rpb24vYW5zd2Vycy9saXN0JywgICAgdGl0bGU6ICdBbnN3ZXJzJyx9LFxuICAgICAgeyByb3V0ZTogJy86aWQvYW5zd2Vycy9jcmVhdGUnLCAgICAgICAgICAgbmFtZTogJ2FkZEFuc3dlcicsICBtb2R1bGVJZDogJ3F1ZXN0aW9uL2Fuc3dlcnMvY3JlYXRlJyxcdHRpdGxlOiAnQW5zd2VycycsICBzZXR0aW5nczp7aWNvbjonbGlzdC1hbHQnfSB9LFxuICAgICAgeyByb3V0ZTogJy86aWQvYW5zd2Vycy86YW5zd2VySWQnLCAgICAgICAgbmFtZTogJ3ZpZXdBbnN3ZXInLCBtb2R1bGVJZDogJ3F1ZXN0aW9uL2Fuc3dlcnMvdmlldycsXHQgIHRpdGxlOiAnRGV0YWlscyd9XG4gICAgXSk7XG4gICAgdGhpcy5yb3V0ZXIgPSByb3V0ZXI7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihldmVudEFnZ3JlZ2F0b3IpIHtcbiAgICB0aGlzLmVhID0gZXZlbnRBZ2dyZWdhdG9yO1xuICB9XG5cblxuICBhdHRhY2hlZCgpe1xuICAgIHRoaXMuc3Vic2NyaWJlciA9IHRoaXMuZWEuc3Vic2NyaWJlKCdJbkVkaXRNb2RlJywgZGF0YSA9PiB0aGlzLmlzRWRpdCA9IGRhdGEpO1xuICAgIHRoaXMuc3Vic2NyaWJlciA9IHRoaXMuZWEuc3Vic2NyaWJlKCdJbkFuc3dlcnNWaWV3JywgZGF0YSA9PiB0aGlzLmlzQW5zd2Vyc1ZpZXcgPSBkYXRhKTtcbiAgICB0aGlzLnN1YnNjcmliZXIgPSB0aGlzLmVhLnN1YnNjcmliZSgnSW5BZGRBbnN3ZXJWaWV3JywgZGF0YSA9PiB0aGlzLmlzQWRkQW5zd2VyVmlldyA9IGRhdGEpO1xuICB9XG5cbn1cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3F1ZXN0aW9uL2NoaWxkLXJvdXRlci5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGU+XFxuICA8ZGl2IGNsYXNzPVxcXCJ1aSBwb2ludGluZyBtZW51XFxcIj5cXG4gICAgPGEgcmVwZWF0LmZvcj1cXFwicm93IG9mIHJvdXRlci5uYXZpZ2F0aW9uXFxcIiBjbGFzcz1cXFwiJHtyb3cuaXNBY3RpdmUgPyAnYWN0aXZlJyA6ICcnfSBpdGVtXFxcIiBocmVmLmJpbmQ9XFxcInJvdy5ocmVmXFxcIj5cXG4gICAgICA8aSBjbGFzcz1cXFwiJHtyb3cuc2V0dGluZ3MuaWNvbn0gaWNvblxcXCIgZGF0YS1jb250ZW50PVxcXCJWaWV3IEFuc3dlcnNcXFwiPjwvaT4ke3Jvdy50aXRsZX1cXG4gICAgPC9hPlxcbiAgICA8YSBjbGFzcz1cXFwiJHtpc0VkaXQgPyAnYWN0aXZlJyA6ICcnfSBpdGVtXFxcIj5cXG4gICAgICA8aSBjbGFzcz1cXFwidW5oaWRlIGljb25cXFwiPjwvaT5FZGl0L0RlbGV0ZVxcbiAgICA8L2E+XFxuICAgIDxhIGNsYXNzPVxcXCIke2lzQW5zd2Vyc1ZpZXcgPyAnYWN0aXZlJyA6ICcnfSBpdGVtXFxcIj5cXG4gICAgICA8aSBjbGFzcz1cXFwic2l0ZW1hcCBpY29uXFxcIj48L2k+QW5zd2Vyc1xcbiAgICA8L2E+XFxuICAgIDxhIGNsYXNzPVxcXCIke2lzQWRkQW5zd2VyVmlldyA/ICdhY3RpdmUnIDogJyd9IGl0ZW1cXFwiPlxcbiAgICAgIDxpIGNsYXNzPVxcXCJwbHVzIGljb25cXFwiPjwvaT5BZGQgQW5zd2VyXFxuICAgIDwvYT5cXG4gIDwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwidWkgc2VnbWVudFxcXCI+XFxuICAgIDxzZWN0aW9uIGNsYXNzPVxcXCJhdS1hbmltYXRlXFxcIj5cXG4gICAgICA8cm91dGVyLXZpZXc+PC9yb3V0ZXItdmlldz5cXG4gICAgPC9zZWN0aW9uPlxcbiAgPC9kaXY+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3F1ZXN0aW9uL2NoaWxkLXJvdXRlci5odG1sXG4gKiogbW9kdWxlIGlkID0gMTM0XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCJpbXBvcnQge2luamVjdH0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuaW1wb3J0IHtSb3V0ZXJ9IGZyb20gJ2F1cmVsaWEtcm91dGVyJztcbmltcG9ydCB7U2FpbHNTb2NrZXRDbGllbnR9IGZyb20gJ2F1cmVsaWEtc2FpbHMtc29ja2V0LWNsaWVudCc7XG5pbXBvcnQge0Jhc2VDcmVhdGVWTX0gZnJvbSAnLi4vQmFzZUNydWRPcGVyYXRpb25zL0Jhc2VDcmVhdGVWTSc7XG5pbXBvcnQge2Jhc2VDb25maWd9IGZyb20gJy4vYmFzZSc7XG5cbkBpbmplY3QoU2FpbHNTb2NrZXRDbGllbnQsIFJvdXRlciwgYmFzZUNvbmZpZylcbmV4cG9ydCBjbGFzcyBDcmVhdGUgZXh0ZW5kcyBCYXNlQ3JlYXRlVk0ge1xuXG4gIGNvbnN0cnVjdG9yKHNhaWxzLCByb3V0ZXIsIGJhc2VDb25maWcpIHtcbiAgICBzdXBlcihzYWlscywgcm91dGVyLCBiYXNlQ29uZmlnKVxuICB9XG5cbiAgYWN0aXZhdGUocGFyYW1zKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFtcbiAgICAgIHRoaXMuc2FpbHMuZ2V0KFwiL3F1ZXN0aW9uQ2F0ZWdvcmllc1wiKS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgdGhpcy5xdWVzdGlvbkNhdGVnb3JpZXMgPSByZXMuYm9keTtcbiAgICAgIH0pLmNhdGNoKChyZXMpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yJyk7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgICB9KSxcbiAgICAgIHRoaXMuc2FpbHMuZ2V0KFwiL3F1ZXN0aW9uS2luZHNcIikudGhlbigocmVzKSA9PiB7XG4gICAgICAgIHRoaXMucXVlc3Rpb25LaW5kcyA9IHJlcy5ib2R5O1xuICAgICAgfSkuY2F0Y2goKHJlcykgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnZXJyb3InKTtcbiAgICAgICAgY29uc29sZS5sb2cocmVzKTtcbiAgICAgIH0pXSk7XG4gIH1cbn1cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3F1ZXN0aW9uL2NyZWF0ZS5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGU+XFxuICA8c2VjdGlvbiBjbGFzcz1cXFwiYXUtYW5pbWF0ZVxcXCI+XFxuICAgIDxmb3JtIGNsYXNzPVxcXCJ1aSBmb3JtXFxcIiBzdWJtaXQuZGVsZWdhdGU9XFxcInN1Ym1pdCgpXFxcIj5cXG4gICAgICA8ZGl2IGNsYXNzPVxcXCJmaWVsZFxcXCI+XFxuICAgICAgICA8bGFiZWwgZm9yLmJpbmQ9XFxcInR5cGVcXFwiIGNsYXNzPVxcXCJjb2wtc20tMiBjb250cm9sLWxhYmVsXFxcIj5LaW5kPC9sYWJlbD5cXG4gICAgICAgIDxkaXYgdWktZHJvcGRvd249XFxcInNlbGVjdGlvbjogZW50aXR5LmtpbmQuaWRcXFwiPlxcbiAgICAgICAgICA8aW5wdXQgdHlwZT1cXFwiaGlkZGVuXFxcIiB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkua2luZC5pZFxcXCI+XFxuICAgICAgICAgIDxpIGNsYXNzPVxcXCJkcm9wZG93biBpY29uXFxcIj48L2k+XFxuICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImRlZmF1bHQgdGV4dFxcXCI+UGxlYXNlIFNlbGVjdDwvZGl2PlxcbiAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJtZW51XFxcIj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJpdGVtXFxcIiBkYXRhLXZhbHVlLmJpbmQ9XFxcImsuaWRcXFwiIHJlcGVhdC5mb3I9XFxcImsgb2YgcXVlc3Rpb25LaW5kc1xcXCI+JHtrLnRleHR9PC9kaXY+XFxuICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgPC9kaXY+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwiZmllbGRcXFwiPlxcbiAgICAgICAgPGxhYmVsIGZvci5iaW5kPVxcXCJ0eXBlXFxcIiBjbGFzcz1cXFwiY29sLXNtLTIgY29udHJvbC1sYWJlbFxcXCI+Q2F0ZWdvcnk8L2xhYmVsPlxcbiAgICAgICAgPGRpdiB1aS1kcm9wZG93bj1cXFwic2VsZWN0aW9uOiBlbnRpdHkuY2F0ZWdvcnkuaWRcXFwiPlxcbiAgICAgICAgICA8aW5wdXQgdHlwZT1cXFwiaGlkZGVuXFxcIiB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkuY2F0ZWdvcnkuaWRcXFwiPlxcbiAgICAgICAgICA8aSBjbGFzcz1cXFwiZHJvcGRvd24gaWNvblxcXCI+PC9pPlxcbiAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJkZWZhdWx0IHRleHRcXFwiPlBsZWFzZSBTZWxlY3Q8L2Rpdj5cXG4gICAgICAgICAgPGRpdiBjbGFzcz1cXFwibWVudVxcXCI+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiaXRlbVxcXCIgZGF0YS12YWx1ZS5iaW5kPVxcXCJrLmlkXFxcIiByZXBlYXQuZm9yPVxcXCJrIG9mIHF1ZXN0aW9uQ2F0ZWdvcmllc1xcXCI+JHtrLnRleHR9PC9kaXY+XFxuICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgPC9kaXY+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwiZmllbGRcXFwiPlxcbiAgICAgICAgPGxhYmVsIGZvcj1cXFwiUXVlc3Rpb25cXFwiPlF1ZXN0aW9uPC9sYWJlbD5cXG4gICAgICAgIDx0ZXh0YXJlYSBpZD1cXFwiUXVlc3Rpb25cXFwiIG5hbWU9XFxcInRleHRcXFwiIHZhbHVlLmJpbmQ9XFxcImVudGl0eS50ZXh0XFxcIj48L3RleHRhcmVhPlxcbiAgICAgIDwvZGl2PlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcImZpZWxkXFxcIj5cXG4gICAgICAgIDxsYWJlbCBmb3I9XFxcImlzTXVsdGlwbGVDaG9pY2VcXFwiPklzIE11bHRpcGxlIENob2ljZTwvbGFiZWw+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJ1aSB0b2dnbGUgY2hlY2tib3hcXFwiPlxcbiAgICAgICAgICA8aW5wdXQgdHlwZT1cXFwiY2hlY2tib3hcXFwiIGlkPVxcXCJpc011bHRpcGxlQ2hvaWNlXFxcIiBjaGVja2VkLmJpbmQ9XFxcImVudGl0eS5pc011bHRpcGxlQ2hvaWNlXFxcIj5cXG4gICAgICAgICAgPGxhYmVsPiA8L2xhYmVsPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgPC9kaXY+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwiZmllbGRcXFwiPlxcbiAgICAgICAgPGxhYmVsIGZvcj1cXFwiaGFzTWFueUFuc3dlcnNcXFwiPkhhcyBNYW55IEFuc3dlcnM8L2xhYmVsPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwidWkgdG9nZ2xlIGNoZWNrYm94XFxcIj5cXG4gICAgICAgICAgPGlucHV0IHR5cGU9XFxcImNoZWNrYm94XFxcIiBpZD1cXFwiaGFzTWFueUFuc3dlcnNcXFwiIGNoZWNrZWQuYmluZD1cXFwiZW50aXR5Lmhhc01hbnlBbnN3ZXJzXFxcIj5cXG4gICAgICAgICAgPGxhYmVsPiA8L2xhYmVsPlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgPC9kaXY+XFxuICAgICAgPGZvcm0tY29udHJvbCBuYW1lPVxcXCJzY29yZVxcXCIgdmFsdWUuYmluZD1cXFwiZW50aXR5LnNjb3JlXFxcIiBsYWJlbD1cXFwiU2NvcmVcXFwiIHR5cGU9XFxcIm51bWJlclxcXCI+PC9mb3JtLWNvbnRyb2w+XFxuICAgICAgPGJ1dHRvbiB0eXBlPVxcXCJzdWJtaXRcXFwiIGNsYXNzPVxcXCJzdWJtaXQgZmx1aWQgZ3JlZW5cXFwiIHVpLWJ1dHRvbj1cXFwiaWNvbjpzZW5kXFxcIj5BZGQ8L2J1dHRvbj5cXG4gICAgPC9mb3JtPlxcbiAgPC9zZWN0aW9uPlxcbjwvdGVtcGxhdGU+XFxuXCI7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9xdWVzdGlvbi9jcmVhdGUuaHRtbFxuICoqIG1vZHVsZSBpZCA9IDEzNlxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiaW1wb3J0IHtpbmplY3R9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcbmltcG9ydCB7Um91dGVyfSBmcm9tICdhdXJlbGlhLXJvdXRlcic7XG5pbXBvcnQge1NhaWxzU29ja2V0Q2xpZW50fSBmcm9tICdhdXJlbGlhLXNhaWxzLXNvY2tldC1jbGllbnQnO1xuXG5AaW5qZWN0KFNhaWxzU29ja2V0Q2xpZW50LCBSb3V0ZXIpXG5leHBvcnQgY2xhc3MgQWRkQW5zd2VyIHtcbiAgZW50aXR5ID0ge307XG5cbiAgY29uc3RydWN0b3Ioc2FpbHMsIHJvdXRlcikge1xuICAgIHRoaXMuc2FpbHMgPSBzYWlscztcbiAgICB0aGlzLnJvdXRlciA9IHJvdXRlcjtcbiAgfVxuXG4gIHN1Ym1pdCgpIHtcbiAgICB0aGlzLnNhaWxzLnB1dChgJHt0aGlzLmJhc2VDdHJsVXJsfSR7dGhpcy5lbnRpdHkuaWR9YCwgZW50aXR5KVxuICAgICAgLnRoZW4oZGF0YSA9PiB0aGlzLnJvdXRlci5uYXZpZ2F0ZSgnJykpO1xuICB9XG5cbiAgYWN0aXZhdGUocGFyYW1zKSB7XG4gICAgcmV0dXJuIHRoaXMuc2FpbHMuZ2V0KCcvYW5zd2VycycpLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdGhpcy5hbnN3ZXJzID0gcmVzLmJvZHk7XG4gICAgICBjb25zb2xlLmxvZyh0aGlzLmVudGl0eS5raW5kLmlkKTtcbiAgICB9KS5jYXRjaCgocmVzKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhyZXMpO1xuICAgIH0pO1xuICB9XG59XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9xdWVzdGlvbi9kZXRhaWxzL2FkZEFuc3dlci5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGU+XFxuICA8c2VjdGlvbiBjbGFzcz1cXFwiYXUtYW5pbWF0ZVxcXCI+XFxuXFxuICA8L3NlY3Rpb24+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3F1ZXN0aW9uL2RldGFpbHMvYWRkQW5zd2VyLmh0bWxcbiAqKiBtb2R1bGUgaWQgPSAxMzhcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsImltcG9ydCB7aW5qZWN0fSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5pbXBvcnQgeyBFdmVudEFnZ3JlZ2F0b3IgfSBmcm9tICdhdXJlbGlhLWV2ZW50LWFnZ3JlZ2F0b3InO1xuXG5AaW5qZWN0KEV2ZW50QWdncmVnYXRvcilcbmV4cG9ydCBjbGFzcyBDaGlsZFJvdXRlciB7XG4gIGNvbmZpZ3VyZVJvdXRlcihjb25maWcsIHJvdXRlcikge1xuICAgIGNvbmZpZy5tYXAoW1xuICAgICAgeyByb3V0ZTogWycnXSwgICAgICAgICAgICAgIG5hbWU6ICdkZXRhaWxzJywgICAgIG1vZHVsZUlkOiAncXVlc3Rpb24vZGV0YWlscy92aWV3JyxcdCAgICAgICAgdGl0bGU6ICdEZXRhaWxzJywgICAgIG5hdjogdHJ1ZSwgIHNldHRpbmdzOntpY29uOidsaXN0LWFsdCd9IH0sXG4gICAgICB7IHJvdXRlOiBbJy9hZGRBbnN3ZXInXSwgICAgbmFtZTogJ2FkZEFuc3dlcicsICAgbW9kdWxlSWQ6ICdxdWVzdGlvbi9kZXRhaWxzL2FkZEFuc3dlcicsXHQgIHRpdGxlOiAnQWRkIEFuc3dlcicsICBuYXY6IHRydWV9XG4gICAgXSk7XG4gICAgdGhpcy5yb3V0ZXIgPSByb3V0ZXI7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihldmVudEFnZ3JlZ2F0b3IpIHtcbiAgICB0aGlzLmVhID0gZXZlbnRBZ2dyZWdhdG9yO1xuICB9XG5cbiAgYXR0YWNoZWQoKXtcbiAgICB0aGlzLnN1YnNjcmliZXIgPSB0aGlzLmVhLnN1YnNjcmliZSgnSW5FZGl0TW9kZScsIGRhdGEgPT4gdGhpcy5pc0VkaXQgPSBkYXRhKTtcbiAgfVxuXG59XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9xdWVzdGlvbi9kZXRhaWxzL2NoaWxkLXJvdXRlci5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGU+XFxuICA8ZGl2IGNsYXNzPVxcXCJ1aSBwb2ludGluZyBtZW51XFxcIj5cXG4gICAgPGEgcmVwZWF0LmZvcj1cXFwicm93IG9mIHJvdXRlci5uYXZpZ2F0aW9uXFxcIiBjbGFzcz1cXFwiJHtyb3cuaXNBY3RpdmUgPyAnYWN0aXZlJyA6ICcnfSBpdGVtXFxcIiBocmVmLmJpbmQ9XFxcInJvdy5ocmVmXFxcIj5cXG4gICAgICAke3Jvdy50aXRsZX1cXG4gICAgPC9hPlxcbiAgPC9kaXY+XFxuXFxuICAgIDxzZWN0aW9uIGNsYXNzPVxcXCJhdS1hbmltYXRlXFxcIj5cXG4gICAgICA8cm91dGVyLXZpZXc+PC9yb3V0ZXItdmlldz5cXG4gICAgPC9zZWN0aW9uPlxcblxcbjwvdGVtcGxhdGU+XFxuXCI7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9xdWVzdGlvbi9kZXRhaWxzL2NoaWxkLXJvdXRlci5odG1sXG4gKiogbW9kdWxlIGlkID0gMTQwXG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCJpbXBvcnQge2luamVjdH0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuaW1wb3J0IHtSb3V0ZXJ9IGZyb20gJ2F1cmVsaWEtcm91dGVyJztcbmltcG9ydCB7RXZlbnRBZ2dyZWdhdG9yfSBmcm9tICdhdXJlbGlhLWV2ZW50LWFnZ3JlZ2F0b3InO1xuaW1wb3J0IHtTYWlsc1NvY2tldENsaWVudH0gZnJvbSAnYXVyZWxpYS1zYWlscy1zb2NrZXQtY2xpZW50JztcbmltcG9ydCB7QmFzZVZpZXdWTX0gZnJvbSAnLi4vLi4vQmFzZUNydWRPcGVyYXRpb25zL0Jhc2VWaWV3Vk0nO1xuaW1wb3J0IHtiYXNlQ29uZmlnfSBmcm9tICcuLi9iYXNlJztcblxuQGluamVjdChTYWlsc1NvY2tldENsaWVudCwgUm91dGVyLCBFdmVudEFnZ3JlZ2F0b3IpXG5leHBvcnQgY2xhc3MgVmlldyBleHRlbmRzIEJhc2VWaWV3Vk0ge1xuXG4gIGNvbnN0cnVjdG9yKHNhaWxzLCByb3V0ZXIsIGV2ZW50QWdncmVnYXRvcikge1xuICAgIHN1cGVyKHNhaWxzLCByb3V0ZXIsIGV2ZW50QWdncmVnYXRvciwgYmFzZUNvbmZpZylcbiAgfVxuXG4gIHN1Ym1pdCgpIHtcbiAgICAvL1dvcmsgYXJvdW5kIHRvIGh0dHBzOi8vZ2l0aHViLmNvbS9iYWxkZXJkYXNoeS9zYWlscy9pc3N1ZXMvMTU3M1xuICAgIGxldCBlbnRpdHkgPSB7XG4gICAgICBpZDogdGhpcy5lbnRpdHkuaWQsIGNhdGVnb3J5OiB7aWQ6IHRoaXMuZW50aXR5LmNhdGVnb3J5LmlkfSwga2luZDoge2lkOiB0aGlzLmVudGl0eS5raW5kLmlkfSxcbiAgICAgIHRleHQ6IHRoaXMuZW50aXR5LnRleHQsXG4gICAgICBpc011bHRpcGxlQ2hvaWNlOiB0aGlzLmVudGl0eS5pc011bHRpcGxlQ2hvaWNlLFxuICAgICAgaGFzTWFueUFuc3dlcnM6IHRoaXMuZW50aXR5Lmhhc01hbnlBbnN3ZXJzLCBzY29yZTp0aGlzLmVudGl0eS5zY29yZVxuICAgIH07XG4gICAgdGhpcy5zYWlscy5wdXQoYCR7dGhpcy5iYXNlQ3RybFVybH0ke3RoaXMuZW50aXR5LmlkfWAsIGVudGl0eSlcbiAgICAgIC50aGVuKGRhdGEgPT4gdGhpcy5yb3V0ZXIubmF2aWdhdGUoJy9RdWVzdGlvbnMvJykpO1xuICB9XG5cbiAgYWN0aXZhdGUocGFyYW1zKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFtcbiAgICAgIHRoaXMuc2FpbHMuZ2V0KGAke2Jhc2VDb25maWcuYmFzZUN0cmxVcmx9JHtwYXJhbXMuaWR9P3BvcHVsYXRlPWtpbmQsY2F0ZWdvcnksYW5zd2Vyc2ApLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICB0aGlzLmVudGl0eSA9IHJlcy5ib2R5O1xuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmVudGl0eS5raW5kLmlkKTtcbiAgICAgIH0pLmNhdGNoKChyZXMpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2cocmVzKTtcbiAgICAgIH0pLFxuICAgICAgdGhpcy5zYWlscy5nZXQoXCIvcXVlc3Rpb25DYXRlZ29yaWVzXCIpLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICB0aGlzLnF1ZXN0aW9uQ2F0ZWdvcmllcyA9IHJlcy5ib2R5O1xuICAgICAgfSkuY2F0Y2goKHJlcykgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xuICAgICAgfSksXG4gICAgICB0aGlzLnNhaWxzLmdldChcIi9xdWVzdGlvbktpbmRzXCIpLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICB0aGlzLnF1ZXN0aW9uS2luZHMgPSByZXMuYm9keTtcbiAgICAgIH0pLmNhdGNoKChyZXMpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2cocmVzKTtcbiAgICAgIH0pXSk7XG4gIH1cbn1cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3F1ZXN0aW9uL2RldGFpbHMvdmlldy5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGU+XFxuICA8c2VjdGlvbiBjbGFzcz1cXFwiYXUtYW5pbWF0ZVxcXCI+XFxuICAgIDxmb3JtIHN1Ym1pdC5kZWxlZ2F0ZT1cXFwic3VibWl0KClcXFwiIHVpLWZvcm0+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwiZmllbGRcXFwiPlxcbiAgICAgICAgPGxhYmVsIGZvci5iaW5kPVxcXCJ0eXBlXFxcIiBjbGFzcz1cXFwiY29sLXNtLTIgY29udHJvbC1sYWJlbFxcXCI+S2luZDwvbGFiZWw+XFxuICAgICAgICA8ZGl2IHVpLWRyb3Bkb3duPVxcXCJzZWxlY3Rpb246IGVudGl0eS5raW5kLmlkXFxcIj5cXG4gICAgICAgICAgPGlucHV0IHR5cGU9XFxcImhpZGRlblxcXCIgdmFsdWUuYmluZD1cXFwiZW50aXR5LmtpbmQuaWRcXFwiPlxcbiAgICAgICAgICA8aSBjbGFzcz1cXFwiZHJvcGRvd24gaWNvblxcXCI+PC9pPlxcbiAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJkZWZhdWx0IHRleHRcXFwiPlBsZWFzZSBTZWxlY3Q8L2Rpdj5cXG4gICAgICAgICAgPGRpdiBjbGFzcz1cXFwibWVudVxcXCI+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiaXRlbVxcXCIgZGF0YS12YWx1ZS5iaW5kPVxcXCJrLmlkXFxcIiByZXBlYXQuZm9yPVxcXCJrIG9mIHF1ZXN0aW9uS2luZHNcXFwiPiR7ay50ZXh0fTwvZGl2PlxcbiAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgIDwvZGl2PlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcImZpZWxkXFxcIj5cXG4gICAgICAgIDxsYWJlbCBmb3IuYmluZD1cXFwidHlwZVxcXCIgY2xhc3M9XFxcImNvbC1zbS0yIGNvbnRyb2wtbGFiZWxcXFwiPkNhdGVnb3J5PC9sYWJlbD5cXG4gICAgICAgIDxkaXYgdWktZHJvcGRvd249XFxcInNlbGVjdGlvbjogZW50aXR5LmNhdGVnb3J5LmlkXFxcIj5cXG4gICAgICAgICAgPGlucHV0IHR5cGU9XFxcImhpZGRlblxcXCIgdmFsdWUuYmluZD1cXFwiZW50aXR5LmNhdGVnb3J5LmlkXFxcIj5cXG4gICAgICAgICAgPGkgY2xhc3M9XFxcImRyb3Bkb3duIGljb25cXFwiPjwvaT5cXG4gICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZGVmYXVsdCB0ZXh0XFxcIj5QbGVhc2UgU2VsZWN0PC9kaXY+XFxuICAgICAgICAgIDxkaXYgY2xhc3M9XFxcIm1lbnVcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcIml0ZW1cXFwiIGRhdGEtdmFsdWUuYmluZD1cXFwiay5pZFxcXCIgcmVwZWF0LmZvcj1cXFwiayBvZiBxdWVzdGlvbkNhdGVnb3JpZXNcXFwiPiR7ay50ZXh0fTwvZGl2PlxcbiAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgIDwvZGl2PlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcImZpZWxkXFxcIj5cXG4gICAgICAgIDxsYWJlbCBmb3I9XFxcIlF1ZXN0aW9uXFxcIj5RdWVzdGlvbjwvbGFiZWw+XFxuICAgICAgICA8dGV4dGFyZWEgaWQ9XFxcIlF1ZXN0aW9uXFxcIiBuYW1lPVxcXCJ0ZXh0XFxcIiB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkudGV4dFxcXCI+PC90ZXh0YXJlYT5cXG4gICAgICA8L2Rpdj5cXG4gICAgICA8ZGl2IGNsYXNzPVxcXCJmaWVsZFxcXCI+XFxuICAgICAgICA8bGFiZWwgZm9yPVxcXCJpc011bHRpcGxlQ2hvaWNlXFxcIj5JcyBNdWx0aXBsZSBDaG9pY2U8L2xhYmVsPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwidWkgdG9nZ2xlIGNoZWNrYm94XFxcIj5cXG4gICAgICAgICAgPGlucHV0IHR5cGU9XFxcImNoZWNrYm94XFxcIiBpZD1cXFwiaXNNdWx0aXBsZUNob2ljZVxcXCIgY2hlY2tlZC5iaW5kPVxcXCJlbnRpdHkuaXNNdWx0aXBsZUNob2ljZVxcXCI+XFxuICAgICAgICAgIDxsYWJlbD4gPC9sYWJlbD5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgIDwvZGl2PlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcImZpZWxkXFxcIj5cXG4gICAgICAgIDxsYWJlbCBmb3I9XFxcImhhc01hbnlBbnN3ZXJzXFxcIj5IYXMgTWFueSBBbnN3ZXJzPC9sYWJlbD5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInVpIHRvZ2dsZSBjaGVja2JveFxcXCI+XFxuICAgICAgICAgIDxpbnB1dCB0eXBlPVxcXCJjaGVja2JveFxcXCIgaWQ9XFxcImhhc01hbnlBbnN3ZXJzXFxcIiBjaGVja2VkLmJpbmQ9XFxcImVudGl0eS5oYXNNYW55QW5zd2Vyc1xcXCI+XFxuICAgICAgICAgIDxsYWJlbD4gPC9sYWJlbD5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgIDwvZGl2PlxcbiAgICAgIDxmb3JtLWNvbnRyb2wgdmFsdWUuYmluZD1cXFwiZW50aXR5LnNjb3JlXFxcIiBsYWJlbD1cXFwiU2NvcmVcXFwiIHR5cGU9XFxcIm51bWJlclxcXCI+PC9mb3JtLWNvbnRyb2w+XFxuICAgICAgPGJ1dHRvbiB0eXBlPVxcXCJzdWJtaXRcXFwiIGNsYXNzPVxcXCJ1aSBzdWJtaXQgYnV0dG9uIGJsdWVcXFwiPjxpIGNsYXNzPVxcXCJ1cGxvYWQgaWNvblxcXCI+PC9pPlVwZGF0ZTwvYnV0dG9uPlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcInVpIHZlcnRpY2FsIGFuaW1hdGVkIHJlZCBidXR0b25cXFwiIGNsaWNrLmRlbGVnYXRlPVxcXCJkZWxldGVFbnRpdHkoKVxcXCI+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJoaWRkZW4gY29udGVudFxcXCI+RGVsZXRlPC9kaXY+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJ2aXNpYmxlIGNvbnRlbnRcXFwiPlxcbiAgICAgICAgICA8aSBjbGFzcz1cXFwidHJhc2ggb3V0bGluZSBpY29uXFxcIj48L2k+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG4gICAgPC9mb3JtPlxcblxcbiAgICA8ZGl2IGNsYXNzPVxcXCJ1aSB0b2dnbGUgY2hlY2tib3hcXFwiPlxcbiAgICAgIDxpbnB1dCB0eXBlPVxcXCJjaGVja2JveFxcXCIgbmFtZT1cXFwicHVibGljXFxcIiBjaGVja2VkLmJpbmQ9XFxcImlzQ2VsbGVkXFxcIj5cXG4gICAgICA8bGFiZWw+VG9nZ2xlIENlbGxlZCBUYWJsZTwvbGFiZWw+XFxuICAgIDwvZGl2PlxcbiAgICA8dGFibGUgY2xhc3M9XFxcInN0cmlwZWQgJHtpc0NlbGxlZD8nY2VsbGVkJzonJ31cXFwiICB1aS10YWJsZT1cXFwiXFxcIj5cXG4gICAgICA8dGhlYWQ+XFxuICAgICAgPHRoPlRleHQ8L3RoPlxcbiAgICAgIDx0aD5EZXNjcmlwdGlvbjwvdGg+XFxuICAgICAgPHRoPkFjdGlvbnM8L3RoPlxcbiAgICAgIDwvdGhlYWQ+XFxuICAgICAgPHRib2R5PlxcbiAgICAgIDx0ciByZXBlYXQuZm9yPVxcXCJvYmogb2YgZW50aXR5LmFuc3dlcnNcXFwiPlxcbiAgICAgICAgPHRkPiR7b2JqLnRleHR9PC90ZD5cXG4gICAgICAgIDx0ZD4ke29iai5kZXNjfTwvdGQ+XFxuICAgICAgICA8dGQ+XFxuICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLXhzXFxcIiByb3V0ZS1ocmVmPVxcXCJyb3V0ZTogZGV0YWlsczsgcGFyYW1zLmJpbmQ6IHsgaWQ6IG9iai5pZCB9XFxcIj48aSBjbGFzcz1cXFwidHJhc2ggb3V0bGluZSBpY29uIHJlZFxcXCIgZGF0YS1jb250ZW50PVxcXCJEZWxldGVcXFwiPjwvaT48L2E+XFxuICAgICAgICA8L3RkPlxcbiAgICAgIDwvdHI+XFxuICAgICAgPC90Ym9keT5cXG4gICAgPC90YWJsZT5cXG4gIDwvc2VjdGlvbj5cXG48L3RlbXBsYXRlPlxcblwiO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvcXVlc3Rpb24vZGV0YWlscy92aWV3Lmh0bWxcbiAqKiBtb2R1bGUgaWQgPSAxNDJcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsImltcG9ydCB7aW5qZWN0fSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5pbXBvcnQge1JvdXRlcn0gZnJvbSAnYXVyZWxpYS1yb3V0ZXInO1xuaW1wb3J0IHtTYWlsc1NvY2tldENsaWVudH0gZnJvbSAnYXVyZWxpYS1zYWlscy1zb2NrZXQtY2xpZW50JztcbmltcG9ydCB7QmFzZUxpc3RWTX0gZnJvbSAnLi4vQmFzZUNydWRPcGVyYXRpb25zL0Jhc2VMaXN0Vk0nO1xuaW1wb3J0IHtiYXNlQ29uZmlnfSBmcm9tICcuL2Jhc2UnO1xuXG5AaW5qZWN0KFNhaWxzU29ja2V0Q2xpZW50LCBSb3V0ZXIsIGJhc2VDb25maWcpXG5leHBvcnQgY2xhc3MgTGlzdCBleHRlbmRzIEJhc2VMaXN0Vk0ge1xuICBjb25zdHJ1Y3RvcihzYWlscywgcm91dGVyLCBjb25maWcpIHtcbiAgICBzdXBlcihzYWlscywgcm91dGVyLCBjb25maWcpO1xuICB9XG5cbiAgYWN0aXZhdGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuc2FpbHMuZ2V0KGAke3RoaXMuYmFzZUN0cmxVcmx9P3BvcHVsYXRlPWtpbmQsY2F0ZWdvcnlgKS50aGVuKChyZXMpID0+IHtcbiAgICAgIHRoaXMuZW50aXRpZXMgPSByZXMuYm9keTtcbiAgICAgIHN1cGVyLnN1YnNjcmliZSgpO1xuICAgIH0pLmNhdGNoKChyZXMpID0+IHtcbiAgICAgIChyZXMuc3RhdHVzQ29kZSA9PT0gNDAzKSA/IHRoaXMucm91dGVyLm5hdmlnYXRlKCcvbG9naW4nKSA6IHN1cGVyLmxvZ2dlci5lcnJvcihyZXMpO1xuICAgIH0pO1xuICB9XG59XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9xdWVzdGlvbi9saXN0LmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZT5cXG4gIDxzZWN0aW9uIGNsYXNzPVxcXCJhdS1hbmltYXRlXFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwidWkgdG9nZ2xlIGNoZWNrYm94XFxcIj5cXG4gICAgICA8aW5wdXQgdHlwZT1cXFwiY2hlY2tib3hcXFwiIG5hbWU9XFxcInB1YmxpY1xcXCIgY2hlY2tlZC5iaW5kPVxcXCJpc0NlbGxlZFxcXCI+IFxcbiAgICAgIDxsYWJlbD5Ub2dnbGUgQ2VsbGVkIFRhYmxlPC9sYWJlbD5cXG4gICAgPC9kaXY+XFxuICAgIDx0YWJsZSBjbGFzcz1cXFwic3RyaXBlZCAke2lzQ2VsbGVkPydjZWxsZWQnOicnfSBncmVlbiBjb21wYWN0XFxcIiAgdWktdGFibGU9XFxcIlxcXCI+XFxuICAgICAgPHRoZWFkPlxcbiAgICAgIDx0aD5RdWVzdGlvbjwvdGg+XFxuICAgICAgPHRoPktpbmQ8L3RoPlxcbiAgICAgIDx0aD5DYXRlZ29yeTwvdGg+XFxuICAgICAgPHRoPklzIE11bHRpcGxlIENob2ljZTwvdGg+XFxuICAgICAgPHRoPkhhcyBNYW55IEFuc3dlcnM8L3RoPlxcbiAgICAgIDx0aCBjbGFzcz1cXFwicmlnaHQgYWxpZ25lZFxcXCI+U2NvcmU8L3RoPlxcbiAgICAgIDx0aD5BY3Rpb25zPC90aD5cXG4gICAgICA8L3RoZWFkPlxcbiAgICAgIDx0Ym9keT5cXG4gICAgICA8dHIgcmVwZWF0LmZvcj1cXFwib2JqIG9mIGVudGl0aWVzXFxcIj5cXG4gICAgICAgIDx0ZD4ke29iai50ZXh0fTwvdGQ+XFxuICAgICAgICA8dGQ+JHtvYmoua2luZC50ZXh0fTwvdGQ+XFxuICAgICAgICA8dGQ+JHtvYmouY2F0ZWdvcnkudGV4dH08L3RkPlxcbiAgICAgICAgPHRkPjxpIGNsYXNzPVxcXCIke29iai5pc011bHRpcGxlQ2hvaWNlPydjaGVja21hcmsgZ3JlZW4nOidyZW1vdmUgcmVkJ30gaWNvblxcXCI+PC9pPjwvdGQ+XFxuICAgICAgICA8dGQ+PGkgY2xhc3M9XFxcIiR7b2JqLmhhc01hbnlBbnN3ZXJzICA/J2NoZWNrbWFyayBncmVlbic6J3JlbW92ZSByZWQnfSBpY29uXFxcIj48L2k+PC90ZD5cXG4gICAgICAgIDx0ZCBjbGFzcz1cXFwicmlnaHQgYWxpZ25lZFxcXCI+JHtvYmouc2NvcmV9PC90ZD5cXG4gICAgICAgIDx0ZD5cXG4gICAgICAgICAgPGEgY2xhc3M9XFxcImJ0biBidG4teHNcXFwiIHJvdXRlLWhyZWY9XFxcInJvdXRlOiBkZXRhaWxzOyBwYXJhbXMuYmluZDogeyBpZDogb2JqLmlkIH1cXFwiPjxpIGNsYXNzPVxcXCJ1bmhpZGUgaWNvblxcXCIgZGF0YS1jb250ZW50PVxcXCJWaWV3IGFuZCBlZGl0XFxcIj48L2k+PC9hPlxcbiAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi14c1xcXCIgcm91dGUtaHJlZj1cXFwicm91dGU6IGRldGFpbHM7IHBhcmFtcy5iaW5kOiB7IGlkOiBvYmouaWQgfVxcXCI+PGkgY2xhc3M9XFxcInRyYXNoIG91dGxpbmUgaWNvbiByZWRcXFwiIGRhdGEtY29udGVudD1cXFwiRGVsZXRlXFxcIj48L2k+PC9hPlxcbiAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi14c1xcXCIgcm91dGUtaHJlZj1cXFwicm91dGU6IGFuc3dlcnM7IHBhcmFtcy5iaW5kOiB7IGlkOiBvYmouaWQgfVxcXCI+PGkgY2xhc3M9XFxcInNpdGVtYXAgaWNvblxcXCIgZGF0YS1jb250ZW50PVxcXCJWaWV3IEFuc3dlcnNcXFwiPjwvaT48L2E+XFxuICAgICAgICAgIDxhIGNsYXNzPVxcXCJidG4gYnRuLXhzXFxcIiByb3V0ZS1ocmVmPVxcXCJyb3V0ZTogYWRkQW5zd2VyOyBwYXJhbXMuYmluZDogeyBpZDogb2JqLmlkIH1cXFwiPjxpIGNsYXNzPVxcXCIgcGx1cyBpY29uXFxcIiBkYXRhLWNvbnRlbnQ9XFxcIkFkZCBBbnN3ZXJcXFwiPjwvaT48L2E+XFxuICAgICAgICA8L3RkPlxcbiAgICAgIDwvdHI+XFxuICAgICAgPC90Ym9keT5cXG4gICAgPC90YWJsZT5cXG4gICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcbiAgPC9zZWN0aW9uPlxcbjwvdGVtcGxhdGU+XFxuXCI7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9xdWVzdGlvbi9saXN0Lmh0bWxcbiAqKiBtb2R1bGUgaWQgPSAxNDRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsImltcG9ydCB7aW5qZWN0fSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5pbXBvcnQge1JvdXRlcn0gZnJvbSAnYXVyZWxpYS1yb3V0ZXInO1xuaW1wb3J0IHtFdmVudEFnZ3JlZ2F0b3J9IGZyb20gJ2F1cmVsaWEtZXZlbnQtYWdncmVnYXRvcic7XG5pbXBvcnQge1NhaWxzU29ja2V0Q2xpZW50fSBmcm9tICdhdXJlbGlhLXNhaWxzLXNvY2tldC1jbGllbnQnO1xuaW1wb3J0IHtCYXNlVmlld1ZNfSBmcm9tICcuLi9CYXNlQ3J1ZE9wZXJhdGlvbnMvQmFzZVZpZXdWTSc7XG5pbXBvcnQge2Jhc2VDb25maWd9IGZyb20gJy4vYmFzZSc7XG5cbkBpbmplY3QoU2FpbHNTb2NrZXRDbGllbnQsIFJvdXRlciwgRXZlbnRBZ2dyZWdhdG9yKVxuZXhwb3J0IGNsYXNzIFZpZXcgZXh0ZW5kcyBCYXNlVmlld1ZNIHtcblxuICBjb25zdHJ1Y3RvcihzYWlscywgcm91dGVyLCBldmVudEFnZ3JlZ2F0b3IpIHtcbiAgICBzdXBlcihzYWlscywgcm91dGVyLCBldmVudEFnZ3JlZ2F0b3IsIGJhc2VDb25maWcpXG4gIH1cblxuICBzdWJtaXQoKSB7XG4gICAgLy9Xb3JrIGFyb3VuZCB0byBodHRwczovL2dpdGh1Yi5jb20vYmFsZGVyZGFzaHkvc2FpbHMvaXNzdWVzLzE1NzNcbiAgICBsZXQgZW50aXR5ID0ge1xuICAgICAgaWQ6IHRoaXMuZW50aXR5LmlkLCBjYXRlZ29yeToge2lkOiB0aGlzLmVudGl0eS5jYXRlZ29yeS5pZH0sIGtpbmQ6IHtpZDogdGhpcy5lbnRpdHkua2luZC5pZH0sXG4gICAgICB0ZXh0OiB0aGlzLmVudGl0eS50ZXh0LFxuICAgICAgaXNNdWx0aXBsZUNob2ljZTogdGhpcy5lbnRpdHkuaXNNdWx0aXBsZUNob2ljZSxcbiAgICAgIGhhc01hbnlBbnN3ZXJzOiB0aGlzLmVudGl0eS5oYXNNYW55QW5zd2Vycywgc2NvcmU6dGhpcy5lbnRpdHkuc2NvcmVcbiAgICB9O1xuICAgIHRoaXMuc2FpbHMucHV0KGAke3RoaXMuYmFzZUN0cmxVcmx9JHt0aGlzLmVudGl0eS5pZH1gLCBlbnRpdHkpXG4gICAgICAudGhlbihkYXRhID0+IHRoaXMucm91dGVyLm5hdmlnYXRlKCcnKSk7XG4gIH1cblxuICBhY3RpdmF0ZShwYXJhbXMpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW1xuICAgICAgdGhpcy5zYWlscy5nZXQoYCR7YmFzZUNvbmZpZy5iYXNlQ3RybFVybH0ke3BhcmFtcy5pZH0/cG9wdWxhdGU9a2luZCxjYXRlZ29yeSxhbnN3ZXJzYCkudGhlbigocmVzKSA9PiB7XG4gICAgICAgIHRoaXMuZW50aXR5ID0gcmVzLmJvZHk7XG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZW50aXR5LmtpbmQuaWQpO1xuICAgICAgfSkuY2F0Y2goKHJlcykgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xuICAgICAgfSksXG4gICAgICB0aGlzLnNhaWxzLmdldChcIi9xdWVzdGlvbkNhdGVnb3JpZXNcIikudGhlbigocmVzKSA9PiB7XG4gICAgICAgIHRoaXMucXVlc3Rpb25DYXRlZ29yaWVzID0gcmVzLmJvZHk7XG4gICAgICB9KS5jYXRjaCgocmVzKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgICB9KSxcbiAgICAgIHRoaXMuc2FpbHMuZ2V0KFwiL3F1ZXN0aW9uS2luZHNcIikudGhlbigocmVzKSA9PiB7XG4gICAgICAgIHRoaXMucXVlc3Rpb25LaW5kcyA9IHJlcy5ib2R5O1xuICAgICAgfSkuY2F0Y2goKHJlcykgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xuICAgICAgfSldKTtcbiAgfVxufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvcXVlc3Rpb24vdmlldy5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGU+XFxuICA8c2VjdGlvbiBjbGFzcz1cXFwiYXUtYW5pbWF0ZVxcXCI+XFxuICAgIDxhIGNsYXNzPVxcXCJ1aSBzdWJtaXQgYnV0dG9uIGJsdWVcXFwiIHJvdXRlLWhyZWY9XFxcInJvdXRlOiBhbnN3ZXJzOyBwYXJhbXMuYmluZDogeyBpZDogZW50aXR5LmlkIH1cXFwiPjxpIGNsYXNzPVxcXCJ1bm9yZGVyZWQgbGlzdCBpY29uXFxcIj48L2k+QW5zd2VyczwvYT5cXG4gICAgPGEgY2xhc3M9XFxcInVpIHN1Ym1pdCBidXR0b24gYmx1ZVxcXCIgcm91dGUtaHJlZj1cXFwicm91dGU6IGFkZEFuc3dlcjsgcGFyYW1zLmJpbmQ6IHsgaWQ6IGVudGl0eS5pZCB9XFxcIj48aSBjbGFzcz1cXFwicGx1cyBvdXRsaW5lIGljb25cXFwiPjwvaT5BZGQgQW5zd2VyPC9hPlxcbiAgICA8Zm9ybSBzdWJtaXQuZGVsZWdhdGU9XFxcInN1Ym1pdCgpXFxcIiB1aS1mb3JtPlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcInR3byBmaWVsZHNcXFwiPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwiZmllbGRcXFwiPlxcbiAgICAgICAgICA8bGFiZWwgZm9yLmJpbmQ9XFxcInR5cGVcXFwiIGNsYXNzPVxcXCJjb2wtc20tMiBjb250cm9sLWxhYmVsXFxcIj5LaW5kPC9sYWJlbD5cXG4gICAgICAgICAgPGRpdiB1aS1kcm9wZG93bj1cXFwic2VsZWN0aW9uOiBlbnRpdHkua2luZC5pZFxcXCI+XFxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XFxcImhpZGRlblxcXCIgdmFsdWUuYmluZD1cXFwiZW50aXR5LmtpbmQuaWRcXFwiPlxcbiAgICAgICAgICAgIDxpIGNsYXNzPVxcXCJkcm9wZG93biBpY29uXFxcIj48L2k+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiZGVmYXVsdCB0ZXh0XFxcIj5QbGVhc2UgU2VsZWN0PC9kaXY+XFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwibWVudVxcXCI+XFxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJpdGVtXFxcIiBkYXRhLXZhbHVlLmJpbmQ9XFxcImsuaWRcXFwiIHJlcGVhdC5mb3I9XFxcImsgb2YgcXVlc3Rpb25LaW5kc1xcXCI+JHtrLnRleHR9PC9kaXY+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmaWVsZFxcXCI+XFxuICAgICAgICAgIDxsYWJlbCBmb3IuYmluZD1cXFwidHlwZVxcXCIgY2xhc3M9XFxcImNvbC1zbS0yIGNvbnRyb2wtbGFiZWxcXFwiPkNhdGVnb3J5PC9sYWJlbD5cXG4gICAgICAgICAgPGRpdiB1aS1kcm9wZG93bj1cXFwic2VsZWN0aW9uOiBlbnRpdHkuY2F0ZWdvcnkuaWRcXFwiPlxcbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVxcXCJoaWRkZW5cXFwiIHZhbHVlLmJpbmQ9XFxcImVudGl0eS5jYXRlZ29yeS5pZFxcXCI+XFxuICAgICAgICAgICAgPGkgY2xhc3M9XFxcImRyb3Bkb3duIGljb25cXFwiPjwvaT5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJkZWZhdWx0IHRleHRcXFwiPlBsZWFzZSBTZWxlY3Q8L2Rpdj5cXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJtZW51XFxcIj5cXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcIml0ZW1cXFwiIGRhdGEtdmFsdWUuYmluZD1cXFwiay5pZFxcXCIgcmVwZWF0LmZvcj1cXFwiayBvZiBxdWVzdGlvbkNhdGVnb3JpZXNcXFwiPiR7ay50ZXh0fTwvZGl2PlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgIDwvZGl2PlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcImZpZWxkXFxcIj5cXG4gICAgICAgIDxsYWJlbCBmb3I9XFxcIlF1ZXN0aW9uXFxcIj5RdWVzdGlvbjwvbGFiZWw+XFxuICAgICAgICA8dGV4dGFyZWEgaWQ9XFxcIlF1ZXN0aW9uXFxcIiBuYW1lPVxcXCJ0ZXh0XFxcIiB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkudGV4dFxcXCI+PC90ZXh0YXJlYT5cXG4gICAgICA8L2Rpdj5cXG4gICAgICA8ZGl2IGNsYXNzPVxcXCJ0aHJlZSBmaWVsZHNcXFwiPlxcbiAgICAgICAgPGZvcm0tY29udHJvbCB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkuc2NvcmVcXFwiIGxhYmVsPVxcXCJTY29yZVxcXCIgdHlwZT1cXFwibnVtYmVyXFxcIj48L2Zvcm0tY29udHJvbD5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcImZpZWxkXFxcIj5cXG4gICAgICAgICAgPGxhYmVsIGZvcj1cXFwiaXNNdWx0aXBsZUNob2ljZVxcXCI+SXMgTXVsdGlwbGUgQ2hvaWNlPC9sYWJlbD5cXG4gICAgICAgICAgPGRpdiBjbGFzcz1cXFwidWkgdG9nZ2xlIGNoZWNrYm94XFxcIj5cXG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cXFwiY2hlY2tib3hcXFwiIGlkPVxcXCJpc011bHRpcGxlQ2hvaWNlXFxcIiBjaGVja2VkLmJpbmQ9XFxcImVudGl0eS5pc011bHRpcGxlQ2hvaWNlXFxcIj5cXG4gICAgICAgICAgICA8bGFiZWw+IDwvbGFiZWw+XFxuICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgPC9kaXY+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJmaWVsZFxcXCI+XFxuICAgICAgICAgIDxsYWJlbCBmb3I9XFxcImhhc01hbnlBbnN3ZXJzXFxcIj5IYXMgTWFueSBBbnN3ZXJzPC9sYWJlbD5cXG4gICAgICAgICAgPGRpdiBjbGFzcz1cXFwidWkgdG9nZ2xlIGNoZWNrYm94XFxcIj5cXG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cXFwiY2hlY2tib3hcXFwiIGlkPVxcXCJoYXNNYW55QW5zd2Vyc1xcXCIgY2hlY2tlZC5iaW5kPVxcXCJlbnRpdHkuaGFzTWFueUFuc3dlcnNcXFwiPlxcbiAgICAgICAgICAgIDxsYWJlbD4gPC9sYWJlbD5cXG4gICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG5cXG4gICAgICA8YnV0dG9uIHR5cGU9XFxcInN1Ym1pdFxcXCIgY2xhc3M9XFxcInVpIHN1Ym1pdCBidXR0b24gYmx1ZVxcXCI+PGkgY2xhc3M9XFxcInVwbG9hZCBpY29uXFxcIj48L2k+VXBkYXRlPC9idXR0b24+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwidWkgYW5pbWF0ZWQgcmVkIGJ1dHRvblxcXCIgY2xpY2suZGVsZWdhdGU9XFxcImRlbGV0ZUVudGl0eSgpXFxcIj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcImhpZGRlbiBjb250ZW50XFxcIj5EZWxldGU8L2Rpdj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInZpc2libGUgY29udGVudFxcXCI+XFxuICAgICAgICAgIDxpIGNsYXNzPVxcXCJ0cmFzaCBvdXRsaW5lIGljb25cXFwiPjwvaT5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgIDwvZGl2PlxcbiAgICA8L2Zvcm0+XFxuICA8L3NlY3Rpb24+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3F1ZXN0aW9uL3ZpZXcuaHRtbFxuICoqIG1vZHVsZSBpZCA9IDE0NlxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiZXhwb3J0IGNvbnN0IGJhc2VDb25maWcgPSB7XG4gICdiYXNlQ3RybFVybCc6ICcvcXVlc3Rpb25DYXRlZ29yaWVzLycsXG4gICdlbnRpdHlUb1N1YnNjcmliZSc6J3F1ZXN0aW9uY2F0ZWdvcnknXG59O1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvcXVlc3Rpb25DYXRlZ29yeS9iYXNlLmpzXG4gKiovIiwiaW1wb3J0IHtpbmplY3R9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcbmltcG9ydCB7IEV2ZW50QWdncmVnYXRvciB9IGZyb20gJ2F1cmVsaWEtZXZlbnQtYWdncmVnYXRvcic7XG5cbkBpbmplY3QoRXZlbnRBZ2dyZWdhdG9yKVxuZXhwb3J0IGNsYXNzIENoaWxkUm91dGVyIHtcbiAgY29uZmlndXJlUm91dGVyKGNvbmZpZywgcm91dGVyKSB7XG4gICAgY29uZmlnLm1hcChbXG4gICAgICB7IHJvdXRlOiBbJyddLCAgICAgICAgbmFtZTogJ2xpc3QnLCAgICAgbW9kdWxlSWQ6ICdxdWVzdGlvbkNhdGVnb3J5L2xpc3QnLFx0ICBcdHRpdGxlOiAnTGlzdCcsICAgIG5hdjogdHJ1ZSwgIHNldHRpbmdzOntpY29uOidsaXN0IG91dGxpbmUnfSB9LFxuICAgICAgeyByb3V0ZTogWydjcmVhdGUnXSwgIG5hbWU6ICdjcmVhdGUnLCAgIG1vZHVsZUlkOiAncXVlc3Rpb25DYXRlZ29yeS9jcmVhdGUnLFx0XHR0aXRsZTogJ0FkZCBOZXcnLCBuYXY6IHRydWUsICBzZXR0aW5nczp7aWNvbjoncGx1cyd9IH0sXG4gICAgICB7IHJvdXRlOiBbJy86aWQnXSwgICAgbmFtZTogJ2RldGFpbHMnLCAgbW9kdWxlSWQ6ICdxdWVzdGlvbkNhdGVnb3J5L3ZpZXcnLFx0ICBcdHRpdGxlOiAnRGV0YWlscyd9LFxuICAgIF0pO1xuICAgIHRoaXMucm91dGVyID0gcm91dGVyO1xuICB9XG5cbiAgY29uc3RydWN0b3IoZXZlbnRBZ2dyZWdhdG9yKSB7XG4gICAgdGhpcy5lYSA9IGV2ZW50QWdncmVnYXRvcjtcbiAgfVxuXG4gIGF0dGFjaGVkKCl7XG4gICAgdGhpcy5zdWJzY3JpYmVyID0gdGhpcy5lYS5zdWJzY3JpYmUoJ0luRWRpdE1vZGUnLCBkYXRhID0+IHRoaXMuaXNFZGl0ID0gZGF0YSk7XG4gIH1cbn1cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3F1ZXN0aW9uQ2F0ZWdvcnkvY2hpbGQtcm91dGVyLmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZT5cXG4gIDxkaXYgY2xhc3M9XFxcInVpIHBvaW50aW5nIG1lbnVcXFwiPlxcbiAgICA8YSByZXBlYXQuZm9yPVxcXCJyb3cgb2Ygcm91dGVyLm5hdmlnYXRpb25cXFwiIGNsYXNzPVxcXCIke3Jvdy5pc0FjdGl2ZSA/ICdhY3RpdmUnIDogJyd9IGl0ZW1cXFwiIGhyZWYuYmluZD1cXFwicm93LmhyZWZcXFwiPlxcbiAgICAgIDxpIGNsYXNzPVxcXCIke3Jvdy5zZXR0aW5ncy5pY29ufSBpY29uXFxcIiBkYXRhLWNvbnRlbnQ9XFxcIlZpZXcgQW5zd2Vyc1xcXCI+PC9pPiR7cm93LnRpdGxlfVxcbiAgICA8L2E+XFxuICAgIDxhIGNsYXNzPVxcXCIke2lzRWRpdCA/ICdhY3RpdmUnIDogJyd9IGl0ZW1cXFwiPlxcbiAgICAgIDxpIGNsYXNzPVxcXCJ1bmhpZGUgaWNvblxcXCI+PC9pPkVkaXQvRGVsZXRlXFxuICAgIDwvYT5cXG4gIDwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwidWkgc2VnbWVudFxcXCI+XFxuICAgIDxzZWN0aW9uIGNsYXNzPVxcXCJhdS1hbmltYXRlXFxcIj5cXG4gICAgICA8cm91dGVyLXZpZXc+PC9yb3V0ZXItdmlldz5cXG4gICAgPC9zZWN0aW9uPlxcbiAgPC9kaXY+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3F1ZXN0aW9uQ2F0ZWdvcnkvY2hpbGQtcm91dGVyLmh0bWxcbiAqKiBtb2R1bGUgaWQgPSAxNDlcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsImltcG9ydCB7aW5qZWN0fSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5pbXBvcnQge1JvdXRlcn0gZnJvbSAnYXVyZWxpYS1yb3V0ZXInO1xuaW1wb3J0IHtTYWlsc1NvY2tldENsaWVudH0gZnJvbSAnYXVyZWxpYS1zYWlscy1zb2NrZXQtY2xpZW50JztcbmltcG9ydCB7QmFzZUNyZWF0ZVZNfSBmcm9tICcuLi9CYXNlQ3J1ZE9wZXJhdGlvbnMvQmFzZUNyZWF0ZVZNJztcbmltcG9ydCB7YmFzZUNvbmZpZ30gZnJvbSAnLi9iYXNlJztcblxuQGluamVjdChTYWlsc1NvY2tldENsaWVudCwgUm91dGVyLCBiYXNlQ29uZmlnKVxuZXhwb3J0IGNsYXNzIENyZWF0ZSBleHRlbmRzIEJhc2VDcmVhdGVWTSB7XG5cbiAgY29uc3RydWN0b3Ioc2FpbHMsIHJvdXRlciwgYmFzZUNvbmZpZykge1xuICAgIHN1cGVyKHNhaWxzLCByb3V0ZXIsIGJhc2VDb25maWcpXG4gIH1cblxufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvcXVlc3Rpb25DYXRlZ29yeS9jcmVhdGUuanNcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHRlbXBsYXRlPlxcbiAgPHNlY3Rpb24gY2xhc3M9XFxcImF1LWFuaW1hdGVcXFwiPlxcbiAgICA8Zm9ybSBjbGFzcz1cXFwidWkgZm9ybVxcXCIgc3VibWl0LmRlbGVnYXRlPVxcXCJzdWJtaXQoKVxcXCI+XFxuICAgICAgPGZvcm0tY29udHJvbCBuYW1lPVxcXCJ0ZXh0XFxcIiB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkudGV4dFxcXCIgbGFiZWw9XFxcIlRleHRcXFwiPjwvZm9ybS1jb250cm9sPlxcbiAgICAgIDxmb3JtLWNvbnRyb2wgbmFtZT1cXFwiZGVzY1xcXCIgdmFsdWUuYmluZD1cXFwiZW50aXR5LmRlc2NcXFwiIGxhYmVsPVxcXCJEZXNjcmlwdGlvblxcXCI+PC9mb3JtLWNvbnRyb2w+XFxuICAgICAgPGJ1dHRvbiB0eXBlPVxcXCJzdWJtaXRcXFwiIGNsYXNzPVxcXCJ1aSBzdWJtaXQgZmx1aWQgYnV0dG9uIGdyZWVuXFxcIj48aSBjbGFzcz1cXFwic2VuZCBpY29uXFxcIj48L2k+QWRkPC9idXR0b24+XFxuICAgIDwvZm9ybT5cXG4gIDwvc2VjdGlvbj5cXG48L3RlbXBsYXRlPlxcblwiO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvcXVlc3Rpb25DYXRlZ29yeS9jcmVhdGUuaHRtbFxuICoqIG1vZHVsZSBpZCA9IDE1MVxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiaW1wb3J0IHtpbmplY3R9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcbmltcG9ydCB7Um91dGVyfSBmcm9tICdhdXJlbGlhLXJvdXRlcic7XG5pbXBvcnQge1NhaWxzU29ja2V0Q2xpZW50fSBmcm9tICdhdXJlbGlhLXNhaWxzLXNvY2tldC1jbGllbnQnO1xuaW1wb3J0IHtCYXNlTGlzdFZNfSBmcm9tICcuLi9CYXNlQ3J1ZE9wZXJhdGlvbnMvQmFzZUxpc3RWTSc7XG5pbXBvcnQge2Jhc2VDb25maWd9IGZyb20gJy4vYmFzZSc7XG5pbXBvcnQgJ2pxdWVyeSc7XG5cbkBpbmplY3QoU2FpbHNTb2NrZXRDbGllbnQsIFJvdXRlciwgYmFzZUNvbmZpZylcbmV4cG9ydCBjbGFzcyBMaXN0IGV4dGVuZHMgQmFzZUxpc3RWTXtcbiAgY29uc3RydWN0b3Ioc2FpbHMscm91dGVyLCBjb25maWcpIHtcbiAgICBzdXBlcihzYWlscyxyb3V0ZXIsY29uZmlnKTtcbiAgfVxufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvcXVlc3Rpb25DYXRlZ29yeS9saXN0LmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZT5cXG4gIDxzZWN0aW9uIGNsYXNzPVxcXCJhdS1hbmltYXRlXFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwidWkgdG9nZ2xlIGNoZWNrYm94XFxcIj5cXG4gICAgICA8aW5wdXQgdHlwZT1cXFwiY2hlY2tib3hcXFwiIG5hbWU9XFxcInB1YmxpY1xcXCIgY2hlY2tlZC5iaW5kPVxcXCJpc0NlbGxlZFxcXCI+IFxcbiAgICAgIDxsYWJlbD5Ub2dnbGUgQ2VsbGVkIFRhYmxlPC9sYWJlbD5cXG4gICAgPC9kaXY+XFxuICAgIDx0YWJsZSBjbGFzcz1cXFwic3RyaXBlZCAke2lzQ2VsbGVkPydjZWxsZWQnOicnfSBncmVlbiBjb21wYWN0XFxcIiAgdWktdGFibGU9XFxcIlxcXCI+XFxuICAgICAgPHRoZWFkPlxcbiAgICAgIDx0aD5UZXh0PC90aD5cXG4gICAgICA8dGg+RGVzY3JpcHRpb248L3RoPlxcbiAgICAgIDx0aD5BY3Rpb25zPC90aD5cXG4gICAgICA8L3RoZWFkPlxcbiAgICAgIDx0Ym9keT5cXG4gICAgICA8dHIgcmVwZWF0LmZvcj1cXFwib2JqIG9mIGVudGl0aWVzXFxcIj5cXG4gICAgICAgIDx0ZD4ke29iai50ZXh0fTwvdGQ+XFxuICAgICAgICA8dGQ+JHtvYmouZGVzY308L3RkPlxcbiAgICAgICAgPHRkPlxcbiAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi14c1xcXCIgcm91dGUtaHJlZj1cXFwicm91dGU6IGRldGFpbHM7IHBhcmFtcy5iaW5kOiB7IGlkOiBvYmouaWQgfVxcXCI+PGkgY2xhc3M9XFxcImVkaXQgaWNvblxcXCIgZGF0YS1jb250ZW50PVxcXCJFZGl0XFxcIj48L2k+PC9hPlxcbiAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi14c1xcXCIgcm91dGUtaHJlZj1cXFwicm91dGU6IGRldGFpbHM7IHBhcmFtcy5iaW5kOiB7IGlkOiBvYmouaWQgfVxcXCI+PGkgY2xhc3M9XFxcInRyYXNoIG91dGxpbmUgaWNvbiByZWRcXFwiIGRhdGEtY29udGVudD1cXFwiRGVsZXRlXFxcIj48L2k+PC9hPlxcbiAgICAgICAgPC90ZD5cXG4gICAgICA8L3RyPlxcbiAgICAgIDwvdGJvZHk+XFxuICAgIDwvdGFibGU+XFxuICA8L3NlY3Rpb24+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3F1ZXN0aW9uQ2F0ZWdvcnkvbGlzdC5odG1sXG4gKiogbW9kdWxlIGlkID0gMTUzXG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCJpbXBvcnQge2luamVjdH0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuaW1wb3J0IHtSb3V0ZXJ9IGZyb20gJ2F1cmVsaWEtcm91dGVyJztcbmltcG9ydCB7RXZlbnRBZ2dyZWdhdG9yfSBmcm9tICdhdXJlbGlhLWV2ZW50LWFnZ3JlZ2F0b3InO1xuaW1wb3J0IHtTYWlsc1NvY2tldENsaWVudH0gZnJvbSAnYXVyZWxpYS1zYWlscy1zb2NrZXQtY2xpZW50JztcbmltcG9ydCB7QmFzZVZpZXdWTX0gZnJvbSAnLi4vQmFzZUNydWRPcGVyYXRpb25zL0Jhc2VWaWV3Vk0nO1xuaW1wb3J0IHtiYXNlQ29uZmlnfSBmcm9tICcuL2Jhc2UnO1xuXG5AaW5qZWN0KFNhaWxzU29ja2V0Q2xpZW50LCBSb3V0ZXIsIEV2ZW50QWdncmVnYXRvcilcbmV4cG9ydCBjbGFzcyBWaWV3IGV4dGVuZHMgQmFzZVZpZXdWTSB7XG5cbiAgY29uc3RydWN0b3Ioc2FpbHMsIHJvdXRlciwgZXZlbnRBZ2dyZWdhdG9yKSB7XG4gICAgc3VwZXIoc2FpbHMsIHJvdXRlciwgZXZlbnRBZ2dyZWdhdG9yLCBiYXNlQ29uZmlnKVxuICB9XG5cbn1cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3F1ZXN0aW9uQ2F0ZWdvcnkvdmlldy5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGU+XFxuICA8c2VjdGlvbiBjbGFzcz1cXFwiYXUtYW5pbWF0ZVxcXCI+XFxuICAgIDxmb3JtIGNsYXNzPVxcXCJ1aSBmb3JtXFxcIiBzdWJtaXQuZGVsZWdhdGU9XFxcInN1Ym1pdCgpXFxcIj5cXG4gICAgICA8Zm9ybS1jb250cm9sIG5hbWU9XFxcInRleHRcXFwiIHZhbHVlLmJpbmQ9XFxcImVudGl0eS50ZXh0XFxcIiBsYWJlbD1cXFwiVGV4dFxcXCI+PC9mb3JtLWNvbnRyb2w+XFxuICAgICAgPGZvcm0tY29udHJvbCBuYW1lPVxcXCJkZXNjXFxcIiB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkuZGVzY1xcXCIgbGFiZWw9XFxcIkRlc2NyaXB0aW9uXFxcIj48L2Zvcm0tY29udHJvbD5cXG4gICAgICA8YnV0dG9uIHR5cGU9XFxcInN1Ym1pdFxcXCIgY2xhc3M9XFxcInVpIHN1Ym1pdCBidXR0b24gYmx1ZVxcXCI+PGkgY2xhc3M9XFxcInVwbG9hZCBpY29uXFxcIj48L2k+VXBkYXRlPC9idXR0b24+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwidWkgdmVydGljYWwgYW5pbWF0ZWQgcmVkIGJ1dHRvblxcXCIgY2xpY2suZGVsZWdhdGU9XFxcImRlbGV0ZUVudGl0eSgpXFxcIj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcImhpZGRlbiBjb250ZW50XFxcIj5EZWxldGU8L2Rpdj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInZpc2libGUgY29udGVudFxcXCI+XFxuICAgICAgICAgIDxpIGNsYXNzPVxcXCJ0cmFzaCBvdXRsaW5lIGljb25cXFwiPjwvaT5cXG4gICAgICAgIDwvZGl2PlxcbiAgICAgIDwvZGl2PlxcbiAgICA8L2Zvcm0+XFxuICA8L3NlY3Rpb24+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3F1ZXN0aW9uQ2F0ZWdvcnkvdmlldy5odG1sXG4gKiogbW9kdWxlIGlkID0gMTU1XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCJleHBvcnQgY29uc3QgYmFzZUNvbmZpZyA9IHtcbiAgJ2Jhc2VDdHJsVXJsJzogJy9xdWVzdGlvbktpbmRzLycsXG4gICdlbnRpdHlUb1N1YnNjcmliZSc6J3F1ZXN0aW9ua2luZCdcbn07XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9xdWVzdGlvbktpbmQvYmFzZS5qc1xuICoqLyIsImltcG9ydCB7aW5qZWN0fSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5pbXBvcnQgeyBFdmVudEFnZ3JlZ2F0b3IgfSBmcm9tICdhdXJlbGlhLWV2ZW50LWFnZ3JlZ2F0b3InO1xuXG5AaW5qZWN0KEV2ZW50QWdncmVnYXRvcilcbmV4cG9ydCBjbGFzcyBDaGlsZFJvdXRlciB7XG4gIGNvbmZpZ3VyZVJvdXRlcihjb25maWcsIHJvdXRlcikge1xuICAgIGNvbmZpZy5tYXAoW1xuICAgICAgeyByb3V0ZTogWycnXSwgICAgICAgIG5hbWU6ICdsaXN0JywgICAgIG1vZHVsZUlkOiAncXVlc3Rpb25LaW5kL2xpc3QnLFx0ICB0aXRsZTogJ0xpc3QnLCAgICBuYXY6IHRydWUsICBzZXR0aW5nczp7aWNvbjonbGlzdCBvdXRsaW5lJ30gfSxcbiAgICAgIHsgcm91dGU6IFsnY3JlYXRlJ10sICBuYW1lOiAnY3JlYXRlJywgICBtb2R1bGVJZDogJ3F1ZXN0aW9uS2luZC9jcmVhdGUnLFx0dGl0bGU6ICdBZGQgTmV3JywgbmF2OiB0cnVlLCAgc2V0dGluZ3M6e2ljb246J3BsdXMnfSB9LFxuICAgICAgeyByb3V0ZTogWycvOmlkJ10sICAgIG5hbWU6ICdkZXRhaWxzJywgIG1vZHVsZUlkOiAncXVlc3Rpb25LaW5kL3ZpZXcnLFx0ICB0aXRsZTogJ0RldGFpbHMnfSxcbiAgICBdKTtcbiAgICB0aGlzLnJvdXRlciA9IHJvdXRlcjtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKGV2ZW50QWdncmVnYXRvcikge1xuICAgIHRoaXMuZWEgPSBldmVudEFnZ3JlZ2F0b3I7XG4gIH1cblxuICBhdHRhY2hlZCgpe1xuICAgIHRoaXMuc3Vic2NyaWJlciA9IHRoaXMuZWEuc3Vic2NyaWJlKCdJbkVkaXRNb2RlJywgZGF0YSA9PiB0aGlzLmlzRWRpdCA9IGRhdGEpO1xuICB9XG59XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9xdWVzdGlvbktpbmQvY2hpbGQtcm91dGVyLmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZT5cXG4gIDxkaXYgY2xhc3M9XFxcInVpIHBvaW50aW5nIG1lbnVcXFwiPlxcbiAgICA8YSByZXBlYXQuZm9yPVxcXCJyb3cgb2Ygcm91dGVyLm5hdmlnYXRpb25cXFwiIGNsYXNzPVxcXCIke3Jvdy5pc0FjdGl2ZSA/ICdhY3RpdmUnIDogJyd9IGl0ZW1cXFwiIGhyZWYuYmluZD1cXFwicm93LmhyZWZcXFwiPlxcbiAgICAgIDxpIGNsYXNzPVxcXCIke3Jvdy5zZXR0aW5ncy5pY29ufSBpY29uXFxcIiBkYXRhLWNvbnRlbnQ9XFxcIlZpZXcgQW5zd2Vyc1xcXCI+PC9pPiR7cm93LnRpdGxlfVxcbiAgICA8L2E+XFxuICAgIDxhIGNsYXNzPVxcXCIke2lzRWRpdCA/ICdhY3RpdmUnIDogJyd9IGl0ZW1cXFwiPlxcbiAgICAgIDxpIGNsYXNzPVxcXCJ1bmhpZGUgaWNvblxcXCI+PC9pPkVkaXQvRGVsZXRlXFxuICAgIDwvYT5cXG4gIDwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwidWkgc2VnbWVudFxcXCI+XFxuICAgIDxzZWN0aW9uIGNsYXNzPVxcXCJhdS1hbmltYXRlXFxcIj5cXG4gICAgICA8cm91dGVyLXZpZXc+PC9yb3V0ZXItdmlldz5cXG4gICAgPC9zZWN0aW9uPlxcbiAgPC9kaXY+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3F1ZXN0aW9uS2luZC9jaGlsZC1yb3V0ZXIuaHRtbFxuICoqIG1vZHVsZSBpZCA9IDE1OFxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiaW1wb3J0IHtpbmplY3R9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcbmltcG9ydCB7Um91dGVyfSBmcm9tICdhdXJlbGlhLXJvdXRlcic7XG5pbXBvcnQge1NhaWxzU29ja2V0Q2xpZW50fSBmcm9tICdhdXJlbGlhLXNhaWxzLXNvY2tldC1jbGllbnQnO1xuaW1wb3J0IHtiYXNlQ29uZmlnfSBmcm9tICcuL2Jhc2UnO1xuXG5AaW5qZWN0KFNhaWxzU29ja2V0Q2xpZW50LCBSb3V0ZXIpXG5leHBvcnQgY2xhc3MgQ3JlYXRlIHtcbiAgY29uc3RydWN0b3Ioc2FpbHMsIHJvdXRlcikge1xuICAgIHRoaXMuc2FpbHMgPSBzYWlscztcbiAgICB0aGlzLnRoZVJvdXRlciA9IHJvdXRlcjtcbiAgfVxuXG4gIHN1Ym1pdCgpIHtcbiAgICB0aGlzLnNhaWxzLnBvc3QoYmFzZUNvbmZpZy5iYXNlQ3RybFVybCwgdGhpcy5lbnRpdHkpXG4gICAgICAudGhlbihkYXRhID0+IHRoaXMudGhlUm91dGVyLm5hdmlnYXRlKFwiXCIpKTtcbiAgfVxufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvcXVlc3Rpb25LaW5kL2NyZWF0ZS5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGU+XFxuICA8c2VjdGlvbiBjbGFzcz1cXFwiYXUtYW5pbWF0ZVxcXCI+XFxuICAgIDxmb3JtIGNsYXNzPVxcXCJ1aSBmb3JtXFxcIiBzdWJtaXQuZGVsZWdhdGU9XFxcInN1Ym1pdCgpXFxcIj5cXG4gICAgICA8Zm9ybS1jb250cm9sIG5hbWU9XFxcInRleHRcXFwiIHZhbHVlLmJpbmQ9XFxcImVudGl0eS50ZXh0XFxcIiBsYWJlbD1cXFwiVGV4dFxcXCI+PC9mb3JtLWNvbnRyb2w+XFxuICAgICAgPGZvcm0tY29udHJvbCBuYW1lPVxcXCJkZXNjXFxcIiB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkuZGVzY1xcXCIgbGFiZWw9XFxcIkRlc2NyaXB0aW9uXFxcIj48L2Zvcm0tY29udHJvbD5cXG4gICAgICA8YnV0dG9uIHR5cGU9XFxcInN1Ym1pdFxcXCIgY2xhc3M9XFxcInVpIHN1Ym1pdCBmbHVpZCBidXR0b24gZ3JlZW5cXFwiPjxpIGNsYXNzPVxcXCJzZW5kIGljb25cXFwiPjwvaT5BZGQ8L2J1dHRvbj5cXG4gICAgPC9mb3JtPlxcbiAgPC9zZWN0aW9uPlxcbjwvdGVtcGxhdGU+XFxuXCI7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9xdWVzdGlvbktpbmQvY3JlYXRlLmh0bWxcbiAqKiBtb2R1bGUgaWQgPSAxNjBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsImltcG9ydCB7aW5qZWN0fSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5pbXBvcnQge1JvdXRlcn0gZnJvbSAnYXVyZWxpYS1yb3V0ZXInO1xuaW1wb3J0IHtTYWlsc1NvY2tldENsaWVudH0gZnJvbSAnYXVyZWxpYS1zYWlscy1zb2NrZXQtY2xpZW50JztcbmltcG9ydCB7QmFzZUxpc3RWTX0gZnJvbSAnLi4vQmFzZUNydWRPcGVyYXRpb25zL0Jhc2VMaXN0Vk0nO1xuaW1wb3J0IHtiYXNlQ29uZmlnfSBmcm9tICcuL2Jhc2UnO1xuXG5AaW5qZWN0KFNhaWxzU29ja2V0Q2xpZW50LCBSb3V0ZXIsIGJhc2VDb25maWcpXG5leHBvcnQgY2xhc3MgTGlzdCBleHRlbmRzIEJhc2VMaXN0Vk17XG4gIGNvbnN0cnVjdG9yKHNhaWxzLHJvdXRlciwgY29uZmlnKSB7XG4gICAgc3VwZXIoc2FpbHMscm91dGVyLGNvbmZpZyk7XG4gIH1cbn1cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3F1ZXN0aW9uS2luZC9saXN0LmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZT5cXG4gIDxzZWN0aW9uIGNsYXNzPVxcXCJhdS1hbmltYXRlXFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwidWkgdG9nZ2xlIGNoZWNrYm94XFxcIj5cXG4gICAgICA8aW5wdXQgdHlwZT1cXFwiY2hlY2tib3hcXFwiIG5hbWU9XFxcInB1YmxpY1xcXCIgY2hlY2tlZC5iaW5kPVxcXCJpc0NlbGxlZFxcXCI+IFxcbiAgICAgIDxsYWJlbD5Ub2dnbGUgQ2VsbGVkIFRhYmxlPC9sYWJlbD5cXG4gICAgPC9kaXY+XFxuICAgIDx0YWJsZSBjbGFzcz1cXFwic3RyaXBlZCAke2lzQ2VsbGVkPydjZWxsZWQnOicnfSBncmVlbiBjb21wYWN0XFxcIiAgdWktdGFibGU9XFxcIlxcXCI+XFxuICAgICAgPHRoZWFkPlxcbiAgICAgIDx0aD5UZXh0PC90aD5cXG4gICAgICA8dGg+RGVzY3JpcHRpb248L3RoPlxcbiAgICAgIDx0aD5BY3Rpb25zPC90aD5cXG4gICAgICA8L3RoZWFkPlxcbiAgICAgIDx0Ym9keT5cXG4gICAgICA8dHIgcmVwZWF0LmZvcj1cXFwib2JqIG9mIGVudGl0aWVzXFxcIj5cXG4gICAgICAgIDx0ZD4ke29iai50ZXh0fTwvdGQ+XFxuICAgICAgICA8dGQ+JHtvYmouZGVzY308L3RkPlxcbiAgICAgICAgPHRkPlxcbiAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi14c1xcXCIgcm91dGUtaHJlZj1cXFwicm91dGU6IGRldGFpbHM7IHBhcmFtcy5iaW5kOiB7IGlkOiBvYmouaWQgfVxcXCI+PGkgY2xhc3M9XFxcImVkaXQgaWNvblxcXCIgZGF0YS1jb250ZW50PVxcXCJFZGl0XFxcIj48L2k+PC9hPlxcbiAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi14c1xcXCIgcm91dGUtaHJlZj1cXFwicm91dGU6IGRldGFpbHM7IHBhcmFtcy5iaW5kOiB7IGlkOiBvYmouaWQgfVxcXCI+PGkgY2xhc3M9XFxcInRyYXNoIG91dGxpbmUgaWNvbiByZWRcXFwiIGRhdGEtY29udGVudD1cXFwiRGVsZXRlXFxcIj48L2k+PC9hPlxcbiAgICAgICAgPC90ZD5cXG4gICAgICA8L3RyPlxcbiAgICAgIDwvdGJvZHk+XFxuICAgIDwvdGFibGU+XFxuICA8L3NlY3Rpb24+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3F1ZXN0aW9uS2luZC9saXN0Lmh0bWxcbiAqKiBtb2R1bGUgaWQgPSAxNjJcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsImltcG9ydCB7aW5qZWN0fSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5pbXBvcnQge1JvdXRlcn0gZnJvbSAnYXVyZWxpYS1yb3V0ZXInO1xuaW1wb3J0IHtFdmVudEFnZ3JlZ2F0b3J9IGZyb20gJ2F1cmVsaWEtZXZlbnQtYWdncmVnYXRvcic7XG5pbXBvcnQge1NhaWxzU29ja2V0Q2xpZW50fSBmcm9tICdhdXJlbGlhLXNhaWxzLXNvY2tldC1jbGllbnQnO1xuaW1wb3J0IHtCYXNlVmlld1ZNfSBmcm9tICcuLi9CYXNlQ3J1ZE9wZXJhdGlvbnMvQmFzZVZpZXdWTSc7XG5pbXBvcnQge2Jhc2VDb25maWd9IGZyb20gJy4vYmFzZSc7XG5cbkBpbmplY3QoU2FpbHNTb2NrZXRDbGllbnQsIFJvdXRlciwgRXZlbnRBZ2dyZWdhdG9yKVxuZXhwb3J0IGNsYXNzIFZpZXcgZXh0ZW5kcyBCYXNlVmlld1ZNIHtcblxuICBjb25zdHJ1Y3RvcihzYWlscywgcm91dGVyLCBldmVudEFnZ3JlZ2F0b3IpIHtcbiAgICBzdXBlcihzYWlscywgcm91dGVyLCBldmVudEFnZ3JlZ2F0b3IsIGJhc2VDb25maWcpXG4gIH1cblxufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvcXVlc3Rpb25LaW5kL3ZpZXcuanNcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHRlbXBsYXRlPlxcbiAgPHNlY3Rpb24gY2xhc3M9XFxcImF1LWFuaW1hdGVcXFwiPlxcbiAgICA8Zm9ybSBjbGFzcz1cXFwidWkgZm9ybVxcXCIgc3VibWl0LmRlbGVnYXRlPVxcXCJzdWJtaXQoKVxcXCI+XFxuICAgICAgPGZvcm0tY29udHJvbCBuYW1lPVxcXCJ0ZXh0XFxcIiB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkudGV4dFxcXCIgbGFiZWw9XFxcIlRleHRcXFwiPjwvZm9ybS1jb250cm9sPlxcbiAgICAgIDxmb3JtLWNvbnRyb2wgbmFtZT1cXFwiZGVzY1xcXCIgdmFsdWUuYmluZD1cXFwiZW50aXR5LmRlc2NcXFwiIGxhYmVsPVxcXCJEZXNjcmlwdGlvblxcXCI+PC9mb3JtLWNvbnRyb2w+XFxuICAgICAgPGJ1dHRvbiB0eXBlPVxcXCJzdWJtaXRcXFwiIGNsYXNzPVxcXCJ1aSBzdWJtaXQgYnV0dG9uIGJsdWVcXFwiPjxpIGNsYXNzPVxcXCJ1cGxvYWQgaWNvblxcXCI+PC9pPlVwZGF0ZTwvYnV0dG9uPlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcInVpIHZlcnRpY2FsIGFuaW1hdGVkIHJlZCBidXR0b25cXFwiIGNsaWNrLmRlbGVnYXRlPVxcXCJkZWxldGVFbnRpdHkoKVxcXCI+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJoaWRkZW4gY29udGVudFxcXCI+RGVsZXRlPC9kaXY+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJ2aXNpYmxlIGNvbnRlbnRcXFwiPlxcbiAgICAgICAgICA8aSBjbGFzcz1cXFwidHJhc2ggb3V0bGluZSBpY29uXFxcIj48L2k+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG4gICAgPC9mb3JtPlxcbiAgPC9zZWN0aW9uPlxcbjwvdGVtcGxhdGU+XFxuXCI7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9xdWVzdGlvbktpbmQvdmlldy5odG1sXG4gKiogbW9kdWxlIGlkID0gMTY0XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCJleHBvcnQgY29uc3QgYmFzZUNvbmZpZyA9IHtcbiAgJ2Jhc2VDdHJsVXJsJzogJy9xdWVzdGlvblR5cGVzLycsXG4gICdlbnRpdHlUb1N1YnNjcmliZSc6J3F1ZXN0aW9udHlwZSdcbn07XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9xdWVzdGlvblR5cGUvYmFzZS5qc1xuICoqLyIsImltcG9ydCB7aW5qZWN0fSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5pbXBvcnQgeyBFdmVudEFnZ3JlZ2F0b3IgfSBmcm9tICdhdXJlbGlhLWV2ZW50LWFnZ3JlZ2F0b3InO1xuXG5AaW5qZWN0KEV2ZW50QWdncmVnYXRvcilcbmV4cG9ydCBjbGFzcyBDaGlsZFJvdXRlciB7XG4gIGNvbmZpZ3VyZVJvdXRlcihjb25maWcsIHJvdXRlcikge1xuICAgIGNvbmZpZy5tYXAoW1xuICAgICAgeyByb3V0ZTogWycnXSwgICAgICAgIG5hbWU6ICdsaXN0JywgICAgIG1vZHVsZUlkOiAncXVlc3Rpb25UeXBlL2xpc3QnLFx0ICB0aXRsZTogJ0xpc3QnLCAgICBuYXY6IHRydWUsICBzZXR0aW5nczp7aWNvbjonbGlzdCBvdXRsaW5lJ30gfSxcbiAgICAgIHsgcm91dGU6IFsnY3JlYXRlJ10sICBuYW1lOiAnY3JlYXRlJywgICBtb2R1bGVJZDogJ3F1ZXN0aW9uVHlwZS9jcmVhdGUnLFx0dGl0bGU6ICdBZGQgTmV3JywgbmF2OiB0cnVlLCAgc2V0dGluZ3M6e2ljb246J3BsdXMnfSB9LFxuICAgICAgeyByb3V0ZTogWycvOmlkJ10sICAgIG5hbWU6ICdkZXRhaWxzJywgIG1vZHVsZUlkOiAncXVlc3Rpb25UeXBlL3ZpZXcnLFx0ICB0aXRsZTogJ0RldGFpbHMnfSxcbiAgICBdKTtcbiAgICB0aGlzLnJvdXRlciA9IHJvdXRlcjtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKGV2ZW50QWdncmVnYXRvcikge1xuICAgIHRoaXMuZWEgPSBldmVudEFnZ3JlZ2F0b3I7XG4gIH1cblxuICBhdHRhY2hlZCgpe1xuICAgIHRoaXMuc3Vic2NyaWJlciA9IHRoaXMuZWEuc3Vic2NyaWJlKCdJbkVkaXRNb2RlJywgZGF0YSA9PiB0aGlzLmlzRWRpdCA9IGRhdGEpO1xuICB9XG59XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9xdWVzdGlvblR5cGUvY2hpbGQtcm91dGVyLmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZT5cXG4gIDxkaXYgY2xhc3M9XFxcInVpIHBvaW50aW5nIG1lbnVcXFwiPlxcbiAgICA8YSByZXBlYXQuZm9yPVxcXCJyb3cgb2Ygcm91dGVyLm5hdmlnYXRpb25cXFwiIGNsYXNzPVxcXCIke3Jvdy5pc0FjdGl2ZSA/ICdhY3RpdmUnIDogJyd9IGl0ZW1cXFwiIGhyZWYuYmluZD1cXFwicm93LmhyZWZcXFwiPlxcbiAgICAgIDxpIGNsYXNzPVxcXCIke3Jvdy5zZXR0aW5ncy5pY29ufSBpY29uXFxcIiBkYXRhLWNvbnRlbnQ9XFxcIlZpZXcgQW5zd2Vyc1xcXCI+PC9pPiR7cm93LnRpdGxlfVxcbiAgICA8L2E+XFxuICAgIDxhIGNsYXNzPVxcXCIke2lzRWRpdCA/ICdhY3RpdmUnIDogJyd9IGl0ZW1cXFwiPlxcbiAgICAgIDxpIGNsYXNzPVxcXCJ1bmhpZGUgaWNvblxcXCI+PC9pPkVkaXQvRGVsZXRlXFxuICAgIDwvYT5cXG4gIDwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwidWkgc2VnbWVudFxcXCI+XFxuICAgIDxzZWN0aW9uIGNsYXNzPVxcXCJhdS1hbmltYXRlXFxcIj5cXG4gICAgICA8cm91dGVyLXZpZXc+PC9yb3V0ZXItdmlldz5cXG4gICAgPC9zZWN0aW9uPlxcbiAgPC9kaXY+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3F1ZXN0aW9uVHlwZS9jaGlsZC1yb3V0ZXIuaHRtbFxuICoqIG1vZHVsZSBpZCA9IDE2N1xuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiaW1wb3J0IHtpbmplY3R9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcbmltcG9ydCB7Um91dGVyfSBmcm9tICdhdXJlbGlhLXJvdXRlcic7XG5pbXBvcnQge1NhaWxzU29ja2V0Q2xpZW50fSBmcm9tICdhdXJlbGlhLXNhaWxzLXNvY2tldC1jbGllbnQnO1xuaW1wb3J0IHtiYXNlQ29uZmlnfSBmcm9tICcuL2Jhc2UnO1xuXG5AaW5qZWN0KFNhaWxzU29ja2V0Q2xpZW50LCBSb3V0ZXIpXG5leHBvcnQgY2xhc3MgQ3JlYXRlIHtcbiAgY29uc3RydWN0b3Ioc2FpbHMsIHJvdXRlcikge1xuICAgIHRoaXMuc2FpbHMgPSBzYWlscztcbiAgICB0aGlzLnRoZVJvdXRlciA9IHJvdXRlcjtcbiAgfVxuXG4gIHN1Ym1pdCgpIHtcbiAgICB0aGlzLnNhaWxzLnBvc3QoYmFzZUNvbmZpZy5iYXNlQ3RybFVybCwgdGhpcy5lbnRpdHkpXG4gICAgICAudGhlbihkYXRhID0+IHRoaXMudGhlUm91dGVyLm5hdmlnYXRlKFwiXCIpKTtcbiAgfVxufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvcXVlc3Rpb25UeXBlL2NyZWF0ZS5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGU+XFxuICA8c2VjdGlvbiBjbGFzcz1cXFwiYXUtYW5pbWF0ZVxcXCI+XFxuICAgIDxmb3JtIGNsYXNzPVxcXCJ1aSBmb3JtXFxcIiBzdWJtaXQuZGVsZWdhdGU9XFxcInN1Ym1pdCgpXFxcIj5cXG4gICAgICA8Zm9ybS1jb250cm9sIG5hbWU9XFxcInRleHRcXFwiIHZhbHVlLmJpbmQ9XFxcImVudGl0eS50ZXh0XFxcIiBsYWJlbD1cXFwiVGV4dFxcXCI+PC9mb3JtLWNvbnRyb2w+XFxuICAgICAgPGZvcm0tY29udHJvbCBuYW1lPVxcXCJkZXNjXFxcIiB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkuZGVzY1xcXCIgbGFiZWw9XFxcIkRlc2NyaXB0aW9uXFxcIj48L2Zvcm0tY29udHJvbD5cXG4gICAgICA8YnV0dG9uIHR5cGU9XFxcInN1Ym1pdFxcXCIgY2xhc3M9XFxcInVpIHN1Ym1pdCBmbHVpZCBidXR0b24gZ3JlZW5cXFwiPjxpIGNsYXNzPVxcXCJzZW5kIGljb25cXFwiPjwvaT5BZGQ8L2J1dHRvbj5cXG4gICAgPC9mb3JtPlxcbiAgPC9zZWN0aW9uPlxcbjwvdGVtcGxhdGU+XFxuXCI7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9xdWVzdGlvblR5cGUvY3JlYXRlLmh0bWxcbiAqKiBtb2R1bGUgaWQgPSAxNjlcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsImltcG9ydCB7aW5qZWN0fSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5pbXBvcnQge1JvdXRlcn0gZnJvbSAnYXVyZWxpYS1yb3V0ZXInO1xuaW1wb3J0IHtTYWlsc1NvY2tldENsaWVudH0gZnJvbSAnYXVyZWxpYS1zYWlscy1zb2NrZXQtY2xpZW50JztcbmltcG9ydCB7QmFzZUxpc3RWTX0gZnJvbSAnLi4vQmFzZUNydWRPcGVyYXRpb25zL0Jhc2VMaXN0Vk0nO1xuaW1wb3J0IHtiYXNlQ29uZmlnfSBmcm9tICcuL2Jhc2UnO1xuaW1wb3J0ICdqcXVlcnknO1xuXG5AaW5qZWN0KFNhaWxzU29ja2V0Q2xpZW50LCBSb3V0ZXIsIGJhc2VDb25maWcpXG5leHBvcnQgY2xhc3MgTGlzdCBleHRlbmRzIEJhc2VMaXN0Vk17XG4gIGNvbnN0cnVjdG9yKHNhaWxzLHJvdXRlciwgY29uZmlnKSB7XG4gICAgc3VwZXIoc2FpbHMscm91dGVyLGNvbmZpZyk7XG4gIH1cbn1cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3F1ZXN0aW9uVHlwZS9saXN0LmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZT5cXG4gIDxzZWN0aW9uIGNsYXNzPVxcXCJhdS1hbmltYXRlXFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwidWkgdG9nZ2xlIGNoZWNrYm94XFxcIj5cXG4gICAgICA8aW5wdXQgdHlwZT1cXFwiY2hlY2tib3hcXFwiIG5hbWU9XFxcInB1YmxpY1xcXCIgY2hlY2tlZC5iaW5kPVxcXCJpc0NlbGxlZFxcXCI+IFxcbiAgICAgIDxsYWJlbD5Ub2dnbGUgQ2VsbGVkIFRhYmxlPC9sYWJlbD5cXG4gICAgPC9kaXY+XFxuICAgIDx0YWJsZSBjbGFzcz1cXFwic3RyaXBlZCAke2lzQ2VsbGVkPydjZWxsZWQnOicnfSBncmVlbiBjb21wYWN0XFxcIiAgdWktdGFibGU9XFxcIlxcXCI+XFxuICAgICAgPHRoZWFkPlxcbiAgICAgIDx0aD5UZXh0PC90aD5cXG4gICAgICA8dGg+RGVzY3JpcHRpb248L3RoPlxcbiAgICAgIDx0aD5BY3Rpb25zPC90aD5cXG4gICAgICA8L3RoZWFkPlxcbiAgICAgIDx0Ym9keT5cXG4gICAgICA8dHIgcmVwZWF0LmZvcj1cXFwib2JqIG9mIGVudGl0aWVzXFxcIj5cXG4gICAgICAgIDx0ZD4ke29iai50ZXh0fTwvdGQ+XFxuICAgICAgICA8dGQ+JHtvYmouZGVzY308L3RkPlxcbiAgICAgICAgPHRkPlxcbiAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi14c1xcXCIgcm91dGUtaHJlZj1cXFwicm91dGU6IGRldGFpbHM7IHBhcmFtcy5iaW5kOiB7IGlkOiBvYmouaWQgfVxcXCI+PGkgY2xhc3M9XFxcImVkaXQgaWNvblxcXCIgZGF0YS1jb250ZW50PVxcXCJFZGl0XFxcIj48L2k+PC9hPlxcbiAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi14c1xcXCIgcm91dGUtaHJlZj1cXFwicm91dGU6IGRldGFpbHM7IHBhcmFtcy5iaW5kOiB7IGlkOiBvYmouaWQgfVxcXCI+PGkgY2xhc3M9XFxcInRyYXNoIG91dGxpbmUgaWNvbiByZWRcXFwiIGRhdGEtY29udGVudD1cXFwiRGVsZXRlXFxcIj48L2k+PC9hPlxcbiAgICAgICAgPC90ZD5cXG4gICAgICA8L3RyPlxcbiAgICAgIDwvdGJvZHk+XFxuICAgIDwvdGFibGU+XFxuICA8L3NlY3Rpb24+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3F1ZXN0aW9uVHlwZS9saXN0Lmh0bWxcbiAqKiBtb2R1bGUgaWQgPSAxNzFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyIsImltcG9ydCB7aW5qZWN0fSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XG5pbXBvcnQge1JvdXRlcn0gZnJvbSAnYXVyZWxpYS1yb3V0ZXInO1xuaW1wb3J0IHtFdmVudEFnZ3JlZ2F0b3J9IGZyb20gJ2F1cmVsaWEtZXZlbnQtYWdncmVnYXRvcic7XG5pbXBvcnQge1NhaWxzU29ja2V0Q2xpZW50fSBmcm9tICdhdXJlbGlhLXNhaWxzLXNvY2tldC1jbGllbnQnO1xuaW1wb3J0IHtCYXNlVmlld1ZNfSBmcm9tICcuLi9CYXNlQ3J1ZE9wZXJhdGlvbnMvQmFzZVZpZXdWTSc7XG5pbXBvcnQge2Jhc2VDb25maWd9IGZyb20gJy4vYmFzZSc7XG5cbkBpbmplY3QoU2FpbHNTb2NrZXRDbGllbnQsIFJvdXRlciwgRXZlbnRBZ2dyZWdhdG9yKVxuZXhwb3J0IGNsYXNzIFZpZXcgZXh0ZW5kcyBCYXNlVmlld1ZNIHtcblxuICBjb25zdHJ1Y3RvcihzYWlscywgcm91dGVyLCBldmVudEFnZ3JlZ2F0b3IpIHtcbiAgICBzdXBlcihzYWlscywgcm91dGVyLCBldmVudEFnZ3JlZ2F0b3IsIGJhc2VDb25maWcpXG4gIH1cblxufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvcXVlc3Rpb25UeXBlL3ZpZXcuanNcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHRlbXBsYXRlPlxcbiAgPHNlY3Rpb24gY2xhc3M9XFxcImF1LWFuaW1hdGVcXFwiPlxcbiAgICA8Zm9ybSBjbGFzcz1cXFwidWkgZm9ybVxcXCIgc3VibWl0LmRlbGVnYXRlPVxcXCJzdWJtaXQoKVxcXCI+XFxuICAgICAgPGZvcm0tY29udHJvbCBuYW1lPVxcXCJ0ZXh0XFxcIiB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkudGV4dFxcXCIgbGFiZWw9XFxcIlRleHRcXFwiPjwvZm9ybS1jb250cm9sPlxcbiAgICAgIDxmb3JtLWNvbnRyb2wgbmFtZT1cXFwiZGVzY1xcXCIgdmFsdWUuYmluZD1cXFwiZW50aXR5LmRlc2NcXFwiIGxhYmVsPVxcXCJEZXNjcmlwdGlvblxcXCI+PC9mb3JtLWNvbnRyb2w+XFxuICAgICAgPGJ1dHRvbiB0eXBlPVxcXCJzdWJtaXRcXFwiIGNsYXNzPVxcXCJ1aSBzdWJtaXQgYnV0dG9uIGJsdWVcXFwiPjxpIGNsYXNzPVxcXCJ1cGxvYWQgaWNvblxcXCI+PC9pPlVwZGF0ZTwvYnV0dG9uPlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcInVpIHZlcnRpY2FsIGFuaW1hdGVkIHJlZCBidXR0b25cXFwiIGNsaWNrLmRlbGVnYXRlPVxcXCJkZWxldGVFbnRpdHkoKVxcXCI+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJoaWRkZW4gY29udGVudFxcXCI+RGVsZXRlPC9kaXY+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJ2aXNpYmxlIGNvbnRlbnRcXFwiPlxcbiAgICAgICAgICA8aSBjbGFzcz1cXFwidHJhc2ggb3V0bGluZSBpY29uXFxcIj48L2k+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG4gICAgPC9mb3JtPlxcbiAgPC9zZWN0aW9uPlxcbjwvdGVtcGxhdGU+XFxuXCI7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9xdWVzdGlvblR5cGUvdmlldy5odG1sXG4gKiogbW9kdWxlIGlkID0gMTczXG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCJleHBvcnQgY2xhc3MgV2VsY29tZSB7fVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvdGVzdC93ZWxjb21lLmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZT5cXG4gICA8ZGl2IHVpLWNhcmQgY2xhc3M9XFxcImNlbnRlcmVkXFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiaW1hZ2VcXFwiPlxcblxcbiAgICA8L2Rpdj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29udGVudFxcXCI+XFxuICAgICAgPGEgY2xhc3M9XFxcImhlYWRlclxcXCI+RWx5c2U8L2E+XFxuICAgIDwvZGl2PlxcbiAgPC9kaXY+XFxuXFxuICAgPGRpdiBjbGFzcz1cXFwidWkgaWNvbiBtZXNzYWdlXFxcIj5cXG4gICAgPGkgY2xhc3M9XFxcImluYm94IGljb25cXFwiPjwvaT5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29udGVudFxcXCI+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwiaGVhZGVyXFxcIj5cXG4gICAgICAgIEhhdmUgeW91IGhlYXJkIGFib3V0IG91ciBtYWlsaW5nIGxpc3Q/XFxuICAgICAgPC9kaXY+XFxuICAgICAgPHA+R2V0IHRoZSBiZXN0IG5ld3MgaW4geW91ciBlLW1haWwgZXZlcnkgZGF5LjwvcD5cXG4gICAgPC9kaXY+XFxuICA8L2Rpdj5cXG5cXG4gIDxkaXYgdWktbWVzc2FnZT1cXFwiaWNvbjogYmx1ZSBsb2FkaW5nIG5vdGNoZWQgY2lyY2xlXFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiY29udGVudFxcXCI+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwiaGVhZGVyXFxcIj5cXG4gICAgICAgIEp1c3Qgb25lIHNlY29uZFxcbiAgICAgIDwvZGl2PlxcbiAgICAgIDxwPldlJ3JlIGZldGNoaW5nIHRoYXQgY29udGVudCBmb3IgeW91LjwvcD5cXG4gICAgPC9kaXY+XFxuICA8L2Rpdj5cXG5cXG4gIDxkaXYgdWktbWVzc2FnZT1cXFwiaWNvbi5iaW5kOiBtZXNzYWdlSWNvblxcXCIgY2xhc3M9XFxcImljb25cXFwiPlxcbiAgICA8aSBjbGFzcz1cXFwidWkgaWNvbiBpbmJveFxcXCI+PC9pPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJjb250ZW50XFxcIj5cXG4gICAgICA8ZGl2IGNsYXNzPVxcXCJoZWFkZXJcXFwiPlxcbiAgICAgICAgSGF2ZSB5b3UgaGVhcmQgYWJvdXQgb3VyIG1haWxpbmcgbGlzdD9cXG4gICAgICA8L2Rpdj5cXG4gICAgICA8cD5HZXQgdGhlIGJlc3QgbmV3cyBpbiB5b3VyIGUtbWFpbCBldmVyeSBkYXkuPC9wPlxcbiAgICA8L2Rpdj5cXG4gIDwvZGl2PlxcbiAgXFxuICA8ZGl2IHVpLWRyb3Bkb3duPVxcXCJzZWxlY3Rpb246IG1lc3NhZ2VJY29uXFxcIj5cXG4gICAgPGlucHV0IG5hbWU9XFxcIm1lc3NhZ2VJY29uXFxcIiB0eXBlPVxcXCJoaWRkZW5cXFwiIHZhbHVlLmJpbmQ9XFxcIm1lc3NhZ2VJY29uXFxcIj5cXG4gICAgPGkgY2xhc3M9XFxcImRyb3Bkb3duIGljb25cXFwiPjwvaT5cXG4gICAgPGRpdiBjbGFzcz1cXFwiZGVmYXVsdCB0ZXh0XFxcIj5NZXNzYWdlIEljb248L2Rpdj5cXG4gICAgPGRpdiBjbGFzcz1cXFwibWVudVxcXCI+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwiaXRlbVxcXCIgZGF0YS12YWx1ZT1cXFwiaW5ib3hcXFwiPkluYm94PC9kaXY+XFxuICAgICAgPGRpdiBjbGFzcz1cXFwiaXRlbVxcXCIgZGF0YS12YWx1ZT1cXFwidGVhbCBsYWJcXFwiPkxhYjwvZGl2PlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcIml0ZW1cXFwiIGRhdGEtdmFsdWU9XFxcInBheW1lbnRcXFwiPlBheW1lbnQ8L2Rpdj5cXG4gICAgICA8ZGl2IGNsYXNzPVxcXCJpdGVtXFxcIiBkYXRhLXZhbHVlPVxcXCJjYWxlbmRhclxcXCI+Q2FsZW5kYXI8L2Rpdj5cXG4gICAgICA8ZGl2IGNsYXNzPVxcXCJpdGVtXFxcIiBkYXRhLXZhbHVlPVxcXCJob3Jpem9udGFsbHkgZmxpcHBlZCBjb21tZW50XFxcIj5Db21tZW50PC9kaXY+XFxuICAgIDwvZGl2PlxcbiAgPC9kaXY+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3Rlc3Qvd2VsY29tZS5odG1sXG4gKiogbW9kdWxlIGlkID0gMTc1XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCJleHBvcnQgY29uc3QgYmFzZUNvbmZpZyA9IHtcbiAgJ2Jhc2VDdHJsVXJsJzogJy91c2Vycy8nLFxuICAnZW50aXR5VG9TdWJzY3JpYmUnOid1c2VyJ1xufTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3VzZXJzL2Jhc2UuanNcbiAqKi8iLCJpbXBvcnQge2luamVjdH0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuaW1wb3J0IHsgRXZlbnRBZ2dyZWdhdG9yIH0gZnJvbSAnYXVyZWxpYS1ldmVudC1hZ2dyZWdhdG9yJztcblxuQGluamVjdChFdmVudEFnZ3JlZ2F0b3IpXG5leHBvcnQgY2xhc3MgQ2hpbGRSb3V0ZXIge1xuICBjb25maWd1cmVSb3V0ZXIoY29uZmlnLCByb3V0ZXIpIHtcbiAgICBjb25maWcubWFwKFtcbiAgICAgIHsgcm91dGU6IFsnJ10sICAgICAgICBuYW1lOiAnbGlzdCcsICAgICBtb2R1bGVJZDogJ3VzZXJzL2xpc3QnLFx0ICBcdHRpdGxlOiAnTGlzdCcsICAgIG5hdjogdHJ1ZSwgIHNldHRpbmdzOntpY29uOidsaXN0IG91dGxpbmUnfSB9LFxuICAgICAgeyByb3V0ZTogWydjcmVhdGUnXSwgIG5hbWU6ICdjcmVhdGUnLCAgIG1vZHVsZUlkOiAndXNlcnMvY3JlYXRlJyxcdFx0dGl0bGU6ICdBZGQgTmV3JywgbmF2OiB0cnVlLCAgc2V0dGluZ3M6e2ljb246J3BsdXMnfSB9LFxuICAgICAgeyByb3V0ZTogWycvOmlkJ10sICAgIG5hbWU6ICdkZXRhaWxzJywgIG1vZHVsZUlkOiAndXNlcnMvdmlldycsXHQgIFx0dGl0bGU6ICdEZXRhaWxzJ30sXG4gICAgXSk7XG4gICAgdGhpcy5yb3V0ZXIgPSByb3V0ZXI7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihldmVudEFnZ3JlZ2F0b3IpIHtcbiAgICB0aGlzLmVhID0gZXZlbnRBZ2dyZWdhdG9yO1xuICB9XG5cbiAgYXR0YWNoZWQoKXtcbiAgICB0aGlzLnN1YnNjcmliZXIgPSB0aGlzLmVhLnN1YnNjcmliZSgnSW5FZGl0TW9kZScsIGRhdGEgPT4gdGhpcy5pc0VkaXQgPSBkYXRhKTtcbiAgfVxufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvdXNlcnMvY2hpbGQtcm91dGVyLmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZT5cXG4gIDxkaXYgY2xhc3M9XFxcInVpIHBvaW50aW5nIG1lbnVcXFwiPlxcbiAgICA8YSByZXBlYXQuZm9yPVxcXCJyb3cgb2Ygcm91dGVyLm5hdmlnYXRpb25cXFwiIGNsYXNzPVxcXCIke3Jvdy5pc0FjdGl2ZSA/ICdhY3RpdmUnIDogJyd9IGl0ZW1cXFwiIGhyZWYuYmluZD1cXFwicm93LmhyZWZcXFwiPlxcbiAgICAgIDxpIGNsYXNzPVxcXCIke3Jvdy5zZXR0aW5ncy5pY29ufSBpY29uXFxcIiBkYXRhLWNvbnRlbnQ9XFxcIlZpZXcgQW5zd2Vyc1xcXCI+PC9pPiR7cm93LnRpdGxlfVxcbiAgICA8L2E+XFxuICAgIDxhIGNsYXNzPVxcXCIke2lzRWRpdCA/ICdhY3RpdmUnIDogJyd9IGl0ZW1cXFwiPlxcbiAgICAgIDxpIGNsYXNzPVxcXCJ1bmhpZGUgaWNvblxcXCI+PC9pPkVkaXQvRGVsZXRlXFxuICAgIDwvYT5cXG4gIDwvZGl2PlxcbiAgPGRpdiBjbGFzcz1cXFwidWkgc2VnbWVudFxcXCI+XFxuICAgIDxzZWN0aW9uIGNsYXNzPVxcXCJhdS1hbmltYXRlXFxcIj5cXG4gICAgICA8cm91dGVyLXZpZXc+PC9yb3V0ZXItdmlldz5cXG4gICAgPC9zZWN0aW9uPlxcbiAgPC9kaXY+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3VzZXJzL2NoaWxkLXJvdXRlci5odG1sXG4gKiogbW9kdWxlIGlkID0gMTc4XG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCJpbXBvcnQge2luamVjdH0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuaW1wb3J0IHtSb3V0ZXJ9IGZyb20gJ2F1cmVsaWEtcm91dGVyJztcbmltcG9ydCB7U2FpbHNTb2NrZXRDbGllbnR9IGZyb20gJ2F1cmVsaWEtc2FpbHMtc29ja2V0LWNsaWVudCc7XG5pbXBvcnQge0Jhc2VDcmVhdGVWTX0gZnJvbSAnLi4vQmFzZUNydWRPcGVyYXRpb25zL0Jhc2VDcmVhdGVWTSc7XG5pbXBvcnQge2Jhc2VDb25maWd9IGZyb20gJy4vYmFzZSc7XG5cbkBpbmplY3QoU2FpbHNTb2NrZXRDbGllbnQsIFJvdXRlciwgYmFzZUNvbmZpZylcbmV4cG9ydCBjbGFzcyBDcmVhdGUgZXh0ZW5kcyBCYXNlQ3JlYXRlVk0ge1xuXG4gIGNvbnN0cnVjdG9yKHNhaWxzLCByb3V0ZXIsIGJhc2VDb25maWcpIHtcbiAgICBzdXBlcihzYWlscywgcm91dGVyLCBiYXNlQ29uZmlnKVxuICB9XG5cbn1cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3VzZXJzL2NyZWF0ZS5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGU+XFxuICA8c2VjdGlvbiBjbGFzcz1cXFwiYXUtYW5pbWF0ZVxcXCI+XFxuICAgIDxmb3JtIGNsYXNzPVxcXCJ1aSBmb3JtXFxcIiBzdWJtaXQuZGVsZWdhdGU9XFxcInN1Ym1pdCgpXFxcIj5cXG4gICAgICA8Zm9ybS1jb250cm9sIG5hbWU9XFxcInVzZXJuYW1lXFxcIiB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkudXNlcm5hbWVcXFwiIGxhYmVsPVxcXCJVc2VybmFtZVxcXCI+PC9mb3JtLWNvbnRyb2w+XFxuICAgICAgPGZvcm0tY29udHJvbCBuYW1lPVxcXCJlbWFpbFxcXCIgdmFsdWUuYmluZD1cXFwiZW50aXR5LmVtYWlsXFxcIiBsYWJlbD1cXFwiRW1haWxcXFwiPjwvZm9ybS1jb250cm9sPlxcbiAgICAgIDxmb3JtLWNvbnRyb2wgbmFtZT1cXFwiZ3JhdmF0YXJVcmxcXFwiIHZhbHVlLmJpbmQ9XFxcImVudGl0eS5ncmF2YXRhclVybFxcXCIgbGFiZWw9XFxcIkF2YXRhciBVcmxcXFwiPjwvZm9ybS1jb250cm9sPlxcbiAgICAgIDxidXR0b24gdHlwZT1cXFwic3VibWl0XFxcIiBjbGFzcz1cXFwidWkgc3VibWl0IGZsdWlkIGJ1dHRvbiBncmVlblxcXCI+PGkgY2xhc3M9XFxcInNlbmQgaWNvblxcXCI+PC9pPkFkZDwvYnV0dG9uPlxcbiAgICA8L2Zvcm0+XFxuICA8L3NlY3Rpb24+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3VzZXJzL2NyZWF0ZS5odG1sXG4gKiogbW9kdWxlIGlkID0gMTgwXG4gKiogbW9kdWxlIGNodW5rcyA9IDFcbiAqKi8iLCJpbXBvcnQge2luamVjdH0gZnJvbSAnYXVyZWxpYS1mcmFtZXdvcmsnO1xuaW1wb3J0IHtSb3V0ZXJ9IGZyb20gJ2F1cmVsaWEtcm91dGVyJztcbmltcG9ydCB7U2FpbHNTb2NrZXRDbGllbnR9IGZyb20gJ2F1cmVsaWEtc2FpbHMtc29ja2V0LWNsaWVudCc7XG5pbXBvcnQge0Jhc2VMaXN0Vk19IGZyb20gJy4uL0Jhc2VDcnVkT3BlcmF0aW9ucy9CYXNlTGlzdFZNJztcbmltcG9ydCB7YmFzZUNvbmZpZ30gZnJvbSAnLi9iYXNlJztcbmltcG9ydCAnanF1ZXJ5JztcblxuQGluamVjdChTYWlsc1NvY2tldENsaWVudCwgUm91dGVyLCBiYXNlQ29uZmlnKVxuZXhwb3J0IGNsYXNzIExpc3QgZXh0ZW5kcyBCYXNlTGlzdFZNe1xuICBjb25zdHJ1Y3RvcihzYWlscyxyb3V0ZXIsIGNvbmZpZykge1xuICAgIHN1cGVyKHNhaWxzLHJvdXRlcixjb25maWcpO1xuICB9XG4gIGFjdGl2YXRlKCkge1xuICAgIHJldHVybiB0aGlzLnNhaWxzLmdldChgJHt0aGlzLmJhc2VDdHJsVXJsfT9wb3B1bGF0ZT1yb2xlc2ApLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdGhpcy5lbnRpdGllcyA9IHJlcy5ib2R5O1xuICAgICAgdGhpcy5zdWJzY3JpYmUoKTtcbiAgICB9KS5jYXRjaCgocmVzKSA9PiB7XG4gICAgICAocmVzLnN0YXR1c0NvZGUgPT09IDQwMykgPyB0aGlzLnJvdXRlci5uYXZpZ2F0ZSgnL2xvZ2luJykgOiBsb2dnZXIuZXJyb3IocmVzKTtcbiAgICB9KTtcbiAgfVxufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvdXNlcnMvbGlzdC5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCI8dGVtcGxhdGU+XFxuICA8c2VjdGlvbiBjbGFzcz1cXFwiYXUtYW5pbWF0ZVxcXCI+XFxuICAgIDxkaXYgY2xhc3M9XFxcInVpIHRvZ2dsZSBjaGVja2JveFxcXCI+XFxuICAgICAgPGlucHV0IHR5cGU9XFxcImNoZWNrYm94XFxcIiBuYW1lPVxcXCJwdWJsaWNcXFwiIGNoZWNrZWQuYmluZD1cXFwiaXNDZWxsZWRcXFwiPiBcXG4gICAgICA8bGFiZWw+VG9nZ2xlIENlbGxlZCBUYWJsZTwvbGFiZWw+XFxuICAgIDwvZGl2PlxcbiAgICA8dGFibGUgY2xhc3M9XFxcInN0cmlwZWQgJHtpc0NlbGxlZD8nY2VsbGVkJzonJ30gZ3JlZW4gY29tcGFjdFxcXCIgIHVpLXRhYmxlPVxcXCJcXFwiPlxcbiAgICAgIDx0aGVhZD5cXG4gICAgICA8dGg+VXNlcm5hbWU8L3RoPlxcbiAgICAgIDx0aD5FbWFpbCBJZDwvdGg+XFxuICAgICAgPHRoPkF2YXRhciBVUkw8L3RoPlxcbiAgICAgIDx0aD5Sb2xlczwvdGg+XFxuICAgICAgPC90aGVhZD5cXG4gICAgICA8dGJvZHk+XFxuICAgICAgPHRyIHJlcGVhdC5mb3I9XFxcIm9iaiBvZiBlbnRpdGllc1xcXCI+XFxuICAgICAgICA8dGQ+JHtvYmoudXNlcm5hbWV9PC90ZD5cXG4gICAgICAgIDx0ZD4ke29iai5lbWFpbH08L3RkPlxcbiAgICAgICAgPHRkPlxcbiAgICAgICAgICA8c3BhbiByZXBlYXQuZm9yPVxcXCJyIG9mIG9iai5yb2xlc1xcXCI+JHtyLm5hbWV9LCA8L3NwYW4+XFxuICAgICAgICA8L3RkPlxcbiAgICAgICAgPHRkPlxcbiAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi14c1xcXCIgcm91dGUtaHJlZj1cXFwicm91dGU6IGRldGFpbHM7IHBhcmFtcy5iaW5kOiB7IGlkOiBvYmouaWQgfVxcXCI+PGkgY2xhc3M9XFxcImVkaXQgaWNvblxcXCIgZGF0YS1jb250ZW50PVxcXCJFZGl0XFxcIj48L2k+PC9hPlxcbiAgICAgICAgICA8YSBjbGFzcz1cXFwiYnRuIGJ0bi14c1xcXCIgcm91dGUtaHJlZj1cXFwicm91dGU6IGRldGFpbHM7IHBhcmFtcy5iaW5kOiB7IGlkOiBvYmouaWQgfVxcXCI+PGkgY2xhc3M9XFxcInRyYXNoIG91dGxpbmUgaWNvbiByZWRcXFwiIGRhdGEtY29udGVudD1cXFwiRGVsZXRlXFxcIj48L2k+PC9hPlxcbiAgICAgICAgPC90ZD5cXG4gICAgICA8L3RyPlxcbiAgICAgIDwvdGJvZHk+XFxuICAgIDwvdGFibGU+XFxuICA8L3NlY3Rpb24+XFxuPC90ZW1wbGF0ZT5cXG5cIjtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3VzZXJzL2xpc3QuaHRtbFxuICoqIG1vZHVsZSBpZCA9IDE4MlxuICoqIG1vZHVsZSBjaHVua3MgPSAxXG4gKiovIiwiaW1wb3J0IHtpbmplY3R9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcbmltcG9ydCB7Um91dGVyfSBmcm9tICdhdXJlbGlhLXJvdXRlcic7XG5pbXBvcnQge0V2ZW50QWdncmVnYXRvcn0gZnJvbSAnYXVyZWxpYS1ldmVudC1hZ2dyZWdhdG9yJztcbmltcG9ydCB7U2FpbHNTb2NrZXRDbGllbnR9IGZyb20gJ2F1cmVsaWEtc2FpbHMtc29ja2V0LWNsaWVudCc7XG5pbXBvcnQge0Jhc2VWaWV3Vk19IGZyb20gJy4uL0Jhc2VDcnVkT3BlcmF0aW9ucy9CYXNlVmlld1ZNJztcbmltcG9ydCB7YmFzZUNvbmZpZ30gZnJvbSAnLi9iYXNlJztcblxuQGluamVjdChTYWlsc1NvY2tldENsaWVudCwgUm91dGVyLCBFdmVudEFnZ3JlZ2F0b3IpXG5leHBvcnQgY2xhc3MgVmlldyBleHRlbmRzIEJhc2VWaWV3Vk0ge1xuXG4gIGNvbnN0cnVjdG9yKHNhaWxzLCByb3V0ZXIsIGV2ZW50QWdncmVnYXRvcikge1xuICAgIHN1cGVyKHNhaWxzLCByb3V0ZXIsIGV2ZW50QWdncmVnYXRvciwgYmFzZUNvbmZpZylcbiAgfVxuXG59XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy91c2Vycy92aWV3LmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZT5cXG4gIDxzZWN0aW9uIGNsYXNzPVxcXCJhdS1hbmltYXRlXFxcIj5cXG4gICAgPGZvcm0gY2xhc3M9XFxcInVpIGZvcm1cXFwiIHN1Ym1pdC5kZWxlZ2F0ZT1cXFwic3VibWl0KClcXFwiPlxcbiAgICAgIDxmb3JtLWNvbnRyb2wgbmFtZT1cXFwidXNlcm5hbWVcXFwiIHZhbHVlLmJpbmQ9XFxcImVudGl0eS51c2VybmFtZVxcXCIgbGFiZWw9XFxcIlVzZXJuYW1lXFxcIj48L2Zvcm0tY29udHJvbD5cXG4gICAgICA8Zm9ybS1jb250cm9sIG5hbWU9XFxcImVtYWlsXFxcIiB2YWx1ZS5iaW5kPVxcXCJlbnRpdHkuZW1haWxcXFwiIGxhYmVsPVxcXCJFbWFpbFxcXCI+PC9mb3JtLWNvbnRyb2w+XFxuICAgICAgPGZvcm0tY29udHJvbCBuYW1lPVxcXCJncmF2YXRhclVybFxcXCIgdmFsdWUuYmluZD1cXFwiZW50aXR5LmdyYXZhdGFyVXJsXFxcIiBsYWJlbD1cXFwiQXZhdGFyIFVybFxcXCI+PC9mb3JtLWNvbnRyb2w+XFxuICAgICAgPGJ1dHRvbiB0eXBlPVxcXCJzdWJtaXRcXFwiIGNsYXNzPVxcXCJ1aSBzdWJtaXQgYnV0dG9uIGJsdWVcXFwiPjxpIGNsYXNzPVxcXCJ1cGxvYWQgaWNvblxcXCI+PC9pPlVwZGF0ZTwvYnV0dG9uPlxcbiAgICAgIDxkaXYgY2xhc3M9XFxcInVpIHZlcnRpY2FsIGFuaW1hdGVkIHJlZCBidXR0b25cXFwiIGNsaWNrLmRlbGVnYXRlPVxcXCJkZWxldGVFbnRpdHkoKVxcXCI+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJoaWRkZW4gY29udGVudFxcXCI+RGVsZXRlPC9kaXY+XFxuICAgICAgICA8ZGl2IGNsYXNzPVxcXCJ2aXNpYmxlIGNvbnRlbnRcXFwiPlxcbiAgICAgICAgICA8aSBjbGFzcz1cXFwidHJhc2ggb3V0bGluZSBpY29uXFxcIj48L2k+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICA8L2Rpdj5cXG4gICAgPC9mb3JtPlxcbiAgPC9zZWN0aW9uPlxcbjwvdGVtcGxhdGU+XFxuXCI7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy91c2Vycy92aWV3Lmh0bWxcbiAqKiBtb2R1bGUgaWQgPSAxODRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMVxuICoqLyJdLCJzb3VyY2VSb290IjoiIn0=